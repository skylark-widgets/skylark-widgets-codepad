{"version":3,"sources":["addons/general/scriptless.js"],"names":["define","langx","Addon","util","CodeGround","AddonScriptless","_init","super","coder","this","options","listenTo","update","runScriptTypes","e","params","data","type","typeAttr","fragment","document","createElement","$scripts","innerHTML","content","querySelectorAll","let","i","length","getAttribute","indexOf","parentNode","removeChild","categoryName","addonName","register"],"mappings":";;;;;;;AAAAA,OAAO,CACH,sBACA,cACA,aACA,iBACD,SAAUC,EAAMC,EAAMC,EAAKC,GAC1B,mBAEMC,UAAyBH,EAG3BI,QACIC,MAAMD,MAAM,EAEZ,IAAIE,EAAQC,KAAKD,MACHC,KAAKC,QAoBnBD,KAAKE,SAASH,EAAM,UAAUC,KAAKG,MAAM,EACzCH,KAAKI,eAnBgB,CACjB,yBACA,yBACA,2BACA,2BACA,kBACA,kBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,eACA,kBACA,oBACA,oBAIR,CAEAD,OAAOE,GACCC,EAASD,EAAEE,KACf,GAAoB,SAAhBD,EAAOE,KAAX,CAGA,IAEIC,EAFAC,EAAWC,SAASC,cAAc,KAAK,EAGvCC,GAFJH,EAASI,UAAYR,EAAOS,QAEbL,EAASM,iBAAiB,QAAQ,GACjD,IAAKC,IAAIC,EAAI,EAAGA,EAAIL,EAASM,OAAQD,CAAC,IAClCT,EAAWI,EAASK,GAAGE,aAAa,MAAM,IACiB,CAAC,IAA3CpB,KAAKI,eAAeiB,QAAQZ,CAAQ,GACjDI,EAASK,GAAGI,WAAWC,YAAYV,EAASK,EAAE,EAGtDZ,EAAOS,QAAUL,EAASI,SAX1B,CAaJ,CAEAU,0BACI,MAAO,SACX,CAEAC,uBACI,MAAO,YACX,CAEJ,CAIA,OAFA7B,EAAgB8B,SAAS/B,CAAU,EAE5BC,CACX,CAAC","file":"../../../addons/general/scriptless.js","sourcesContent":["define([\r\n    'skylark-langx/langx',\r\n    \"../../addon\",\r\n    '../../util',\r\n    \"../../codepad\"\r\n], function (langx,Addon,util,CodeGround) {\r\n    'use strict';\r\n\r\n    class AddonScriptless  extends Addon{\r\n        //constructor(coder, options) \r\n\r\n        _init() {\r\n            super._init();\r\n\r\n            var coder = this.coder,\r\n                options = this.options;\r\n\r\n            var runScriptTypes = [\r\n                'application/javascript',\r\n                'application/ecmascript',\r\n                'application/x-ecmascript',\r\n                'application/x-javascript',\r\n                'text/ecmascript',\r\n                'text/javascript',\r\n                'text/javascript1.0',\r\n                'text/javascript1.1',\r\n                'text/javascript1.2',\r\n                'text/javascript1.3',\r\n                'text/javascript1.4',\r\n                'text/javascript1.5',\r\n                'text/jscript',\r\n                'text/livescript',\r\n                'text/x-ecmascript',\r\n                'text/x-javascript'\r\n            ];\r\n            this.listenTo(coder,\"changed\",this.update);\r\n            this.runScriptTypes = runScriptTypes;\r\n        }\r\n\r\n        update(e) {\r\n            var params = e.data;\r\n            if (params.type !== 'html') {\r\n                return //callback(null, params);\r\n            }\r\n            var fragment = document.createElement('div');\r\n            fragment.innerHTML = params.content;\r\n            var typeAttr = null;\r\n            var $scripts = fragment.querySelectorAll('script');\r\n            for (let i = 0; i < $scripts.length; i++) {\r\n                typeAttr = $scripts[i].getAttribute('type');\r\n                if (!typeAttr || this.runScriptTypes.indexOf(typeAttr) !== -1) {\r\n                    $scripts[i].parentNode.removeChild($scripts[i]);\r\n                }\r\n            }\r\n            params.content = fragment.innerHTML;\r\n            //callback(null, params);\r\n        }\r\n\r\n        static get categoryName() {\r\n            return \"general\";\r\n        }\r\n\r\n        static get addonName(){\r\n            return \"scriptless\";\r\n        }\r\n\r\n    };\r\n\r\n    AddonScriptless.register(CodeGround);\r\n\r\n    return AddonScriptless;\r\n});"]}