/**
 * skylark-threejs-ex - A version of threejs extentions library that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-ex/
 * @license MIT
 */
(function(factory,globals) {
  var define = globals.define,
      require = globals.require,
      isAmd = (typeof define === 'function' && define.amd),
      isCmd = (!isAmd && typeof exports !== 'undefined');

  if (!isAmd && !define) {
    var map = {};
    function absolute(relative, base) {
        if (relative[0]!==".") {
          return relative;
        }
        var stack = base.split("/"),
            parts = relative.split("/");
        stack.pop(); 
        for (var i=0; i<parts.length; i++) {
            if (parts[i] == ".")
                continue;
            if (parts[i] == "..")
                stack.pop();
            else
                stack.push(parts[i]);
        }
        return stack.join("/");
    }
    define = globals.define = function(id, deps, factory) {
        if (typeof factory == 'function') {
            map[id] = {
                factory: factory,
                deps: deps.map(function(dep){
                  return absolute(dep,id);
                }),
                resolved: false,
                exports: null
            };
            require(id);
        } else {
            map[id] = {
                factory : null,
                resolved : true,
                exports : factory
            };
        }
    };
    require = globals.require = function(id) {
        if (!map.hasOwnProperty(id)) {
            throw new Error('Module ' + id + ' has not been defined');
        }
        var module = map[id];
        if (!module.resolved) {
            var args = [];

            module.deps.forEach(function(dep){
                args.push(require(dep));
            })

            module.exports = module.factory.apply(globals, args) || null;
            module.resolved = true;
        }
        return module.exports;
    };
  }
  
  if (!define) {
     throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");
  }

  factory(define,require);

  if (!isAmd) {
    var skylarkjs = require("skylark-langx-ns");

    if (isCmd) {
      module.exports = skylarkjs;
    } else {
      globals.skylarkjs  = skylarkjs;
    }
  }

})(function(define,require) {

define('skylark-threejs-ex/threex',[
	"skylark-langx-ns"
],function(skylark){
	return skylark.attach("intg.threex",{
		"animation" : {},
		"cameras" : {},
		"controls":{
			"experimental" : {}
		},
		"csm" :{},
		"curves" : {},
		"effects": {},
		"exporters":{},
		"geometries" : {},
		"helpers" : {},
		"interactive" : {},
		"lights" : {},
		"lines":{},
		"loaders" : {},
		"math" : {},
		"misc" : {},
		"modifiers" : {},
		"nodes" : {},
		"objects":{},
		"offscreen" : {},
		"physics" : {},
		"postprocessing" : {},
		"renderers" : {},
		"shaders" : {},
		"textures" : {},
		"utils" : {},
		"webxr" : {}

	});
});
define('skylark-threejs-ex/animation/AnimationClipCreator',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var AnimationClipCreator = function () {
    };
    AnimationClipCreator.CreateRotationAnimation = function (period, axis) {
        var times = [
                0,
                period
            ], values = [
                0,
                360
            ];
        axis = axis || 'x';
        var trackName = '.rotation[' + axis + ']';
        var track = new THREE.NumberKeyframeTrack(trackName, times, values);
        return new THREE.AnimationClip(null, period, [track]);
    };
    AnimationClipCreator.CreateScaleAxisAnimation = function (period, axis) {
        var times = [
                0,
                period
            ], values = [
                0,
                1
            ];
        axis = axis || 'x';
        var trackName = '.scale[' + axis + ']';
        var track = new THREE.NumberKeyframeTrack(trackName, times, values);
        return new THREE.AnimationClip(null, period, [track]);
    };
    AnimationClipCreator.CreateShakeAnimation = function (duration, shakeScale) {
        var times = [], values = [], tmp = new THREE.Vector3();
        for (var i = 0; i < duration * 10; i++) {
            times.push(i / 10);
            tmp.set(Math.random() * 2 - 1, Math.random() * 2 - 1, Math.random() * 2 - 1).multiply(shakeScale).toArray(values, values.length);
        }
        var trackName = '.position';
        var track = new THREE.VectorKeyframeTrack(trackName, times, values);
        return new THREE.AnimationClip(null, duration, [track]);
    };
    AnimationClipCreator.CreatePulsationAnimation = function (duration, pulseScale) {
        var times = [], values = [], tmp = new THREE.Vector3();
        for (var i = 0; i < duration * 10; i++) {
            times.push(i / 10);
            var scaleFactor = Math.random() * pulseScale;
            tmp.set(scaleFactor, scaleFactor, scaleFactor).toArray(values, values.length);
        }
        var trackName = '.scale';
        var track = new THREE.VectorKeyframeTrack(trackName, times, values);
        return new THREE.AnimationClip(null, duration, [track]);
    };
    AnimationClipCreator.CreateVisibilityAnimation = function (duration) {
        var times = [
                0,
                duration / 2,
                duration
            ], values = [
                true,
                false,
                true
            ];
        var trackName = '.visible';
        var track = new THREE.BooleanKeyframeTrack(trackName, times, values);
        return new THREE.AnimationClip(null, duration, [track]);
    };
    AnimationClipCreator.CreateMaterialColorAnimation = function (duration, colors) {
        var times = [], values = [], timeStep = duration / colors.length;
        for (var i = 0; i <= colors.length; i++) {
            times.push(i * timeStep);
            values.push(colors[i % colors.length]);
        }
        var trackName = '.material[0].color';
        var track = new THREE.ColorKeyframeTrack(trackName, times, values);
        return new THREE.AnimationClip(null, duration, [track]);
    };

    return threex.animation.AnimationClipCreator = AnimationClipCreator;
});
define('skylark-threejs-ex/animation/CCDIKSolver',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var CCDIKSolver = function () {
        function CCDIKSolver(mesh, iks) {
            this.mesh = mesh;
            this.iks = iks || [];
            this._valid();
        }
        CCDIKSolver.prototype = {
            constructor: CCDIKSolver,
            update: function () {
                var q = new THREE.Quaternion();
                var targetPos = new THREE.Vector3();
                var targetVec = new THREE.Vector3();
                var effectorPos = new THREE.Vector3();
                var effectorVec = new THREE.Vector3();
                var linkPos = new THREE.Vector3();
                var invLinkQ = new THREE.Quaternion();
                var linkScale = new THREE.Vector3();
                var axis = new THREE.Vector3();
                var vector = new THREE.Vector3();
                return function update() {
                    var bones = this.mesh.skeleton.bones;
                    var iks = this.iks;
                    var math = Math;
                    for (var i = 0, il = iks.length; i < il; i++) {
                        var ik = iks[i];
                        var effector = bones[ik.effector];
                        var target = bones[ik.target];
                        targetPos.setFromMatrixPosition(target.matrixWorld);
                        var links = ik.links;
                        var iteration = ik.iteration !== undefined ? ik.iteration : 1;
                        for (var j = 0; j < iteration; j++) {
                            var rotated = false;
                            for (var k = 0, kl = links.length; k < kl; k++) {
                                var link = bones[links[k].index];
                                if (links[k].enabled === false)
                                    break;
                                var limitation = links[k].limitation;
                                var rotationMin = links[k].rotationMin;
                                var rotationMax = links[k].rotationMax;
                                link.matrixWorld.decompose(linkPos, invLinkQ, linkScale);
                                invLinkQ.inverse();
                                effectorPos.setFromMatrixPosition(effector.matrixWorld);
                                effectorVec.subVectors(effectorPos, linkPos);
                                effectorVec.applyQuaternion(invLinkQ);
                                effectorVec.normalize();
                                targetVec.subVectors(targetPos, linkPos);
                                targetVec.applyQuaternion(invLinkQ);
                                targetVec.normalize();
                                var angle = targetVec.dot(effectorVec);
                                if (angle > 1) {
                                    angle = 1;
                                } else if (angle < -1) {
                                    angle = -1;
                                }
                                angle = math.acos(angle);
                                if (angle < 0.00001)
                                    continue;
                                if (ik.minAngle !== undefined && angle < ik.minAngle) {
                                    angle = ik.minAngle;
                                }
                                if (ik.maxAngle !== undefined && angle > ik.maxAngle) {
                                    angle = ik.maxAngle;
                                }
                                axis.crossVectors(effectorVec, targetVec);
                                axis.normalize();
                                q.setFromAxisAngle(axis, angle);
                                link.quaternion.multiply(q);
                                if (limitation !== undefined) {
                                    var c = link.quaternion.w;
                                    if (c > 1)
                                        c = 1;
                                    var c2 = math.sqrt(1 - c * c);
                                    link.quaternion.set(limitation.x * c2, limitation.y * c2, limitation.z * c2, c);
                                }
                                if (rotationMin !== undefined) {
                                    link.rotation.setFromVector3(link.rotation.toVector3(vector).max(rotationMin));
                                }
                                if (rotationMax !== undefined) {
                                    link.rotation.setFromVector3(link.rotation.toVector3(vector).min(rotationMax));
                                }
                                link.updateMatrixWorld(true);
                                rotated = true;
                            }
                            if (!rotated)
                                break;
                        }
                    }
                    return this;
                };
            }(),
            createHelper: function () {
                return new CCDIKHelper(this.mesh, this.mesh.geometry.userData.MMD.iks);
            },
            _valid: function () {
                var iks = this.iks;
                var bones = this.mesh.skeleton.bones;
                for (var i = 0, il = iks.length; i < il; i++) {
                    var ik = iks[i];
                    var effector = bones[ik.effector];
                    var links = ik.links;
                    var link0, link1;
                    link0 = effector;
                    for (var j = 0, jl = links.length; j < jl; j++) {
                        link1 = bones[links[j].index];
                        if (link0.parent !== link1) {
                            console.warn('THREE.CCDIKSolver: bone ' + link0.name + ' is not the child of bone ' + link1.name);
                        }
                        link0 = link1;
                    }
                }
            }
        };
        function CCDIKHelper(mesh, iks) {
            THREE.Object3D.call(this);
            this.root = mesh;
            this.iks = iks || [];
            this.matrix.copy(mesh.matrixWorld);
            this.matrixAutoUpdate = false;
            this.sphereGeometry = new THREE.SphereBufferGeometry(0.25, 16, 8);
            this.targetSphereMaterial = new THREE.MeshBasicMaterial({
                color: new THREE.Color(16746632),
                depthTest: false,
                depthWrite: false,
                transparent: true
            });
            this.effectorSphereMaterial = new THREE.MeshBasicMaterial({
                color: new THREE.Color(8978312),
                depthTest: false,
                depthWrite: false,
                transparent: true
            });
            this.linkSphereMaterial = new THREE.MeshBasicMaterial({
                color: new THREE.Color(8947967),
                depthTest: false,
                depthWrite: false,
                transparent: true
            });
            this.lineMaterial = new THREE.LineBasicMaterial({
                color: new THREE.Color(16711680),
                depthTest: false,
                depthWrite: false,
                transparent: true
            });
            this._init();
        }
        CCDIKHelper.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
            constructor: CCDIKHelper,
            updateMatrixWorld: function () {
                var matrix = new THREE.Matrix4();
                var vector = new THREE.Vector3();
                function getPosition(bone, matrixWorldInv) {
                    return vector.setFromMatrixPosition(bone.matrixWorld).applyMatrix4(matrixWorldInv);
                }
                function setPositionOfBoneToAttributeArray(array, index, bone, matrixWorldInv) {
                    var v = getPosition(bone, matrixWorldInv);
                    array[index * 3 + 0] = v.x;
                    array[index * 3 + 1] = v.y;
                    array[index * 3 + 2] = v.z;
                }
                return function updateMatrixWorld(force) {
                    var mesh = this.root;
                    if (this.visible) {
                        var offset = 0;
                        var iks = this.iks;
                        var bones = mesh.skeleton.bones;
                        matrix.getInverse(mesh.matrixWorld);
                        for (var i = 0, il = iks.length; i < il; i++) {
                            var ik = iks[i];
                            var targetBone = bones[ik.target];
                            var effectorBone = bones[ik.effector];
                            var targetMesh = this.children[offset++];
                            var effectorMesh = this.children[offset++];
                            targetMesh.position.copy(getPosition(targetBone, matrix));
                            effectorMesh.position.copy(getPosition(effectorBone, matrix));
                            for (var j = 0, jl = ik.links.length; j < jl; j++) {
                                var link = ik.links[j];
                                var linkBone = bones[link.index];
                                var linkMesh = this.children[offset++];
                                linkMesh.position.copy(getPosition(linkBone, matrix));
                            }
                            var line = this.children[offset++];
                            var array = line.geometry.attributes.position.array;
                            setPositionOfBoneToAttributeArray(array, 0, targetBone, matrix);
                            setPositionOfBoneToAttributeArray(array, 1, effectorBone, matrix);
                            for (var j = 0, jl = ik.links.length; j < jl; j++) {
                                var link = ik.links[j];
                                var linkBone = bones[link.index];
                                setPositionOfBoneToAttributeArray(array, j + 2, linkBone, matrix);
                            }
                            line.geometry.attributes.position.needsUpdate = true;
                        }
                    }
                    this.matrix.copy(mesh.matrixWorld);
                    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);
                };
            }(),
            _init: function () {
                var self = this;
                var iks = this.iks;
                function createLineGeometry(ik) {
                    var geometry = new THREE.BufferGeometry();
                    var vertices = new Float32Array((2 + ik.links.length) * 3);
                    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
                    return geometry;
                }
                function createTargetMesh() {
                    return new THREE.Mesh(self.sphereGeometry, self.targetSphereMaterial);
                }
                function createEffectorMesh() {
                    return new THREE.Mesh(self.sphereGeometry, self.effectorSphereMaterial);
                }
                function createLinkMesh() {
                    return new THREE.Mesh(self.sphereGeometry, self.linkSphereMaterial);
                }
                function createLine(ik) {
                    return new THREE.Line(createLineGeometry(ik), self.lineMaterial);
                }
                for (var i = 0, il = iks.length; i < il; i++) {
                    var ik = iks[i];
                    this.add(createTargetMesh());
                    this.add(createEffectorMesh());
                    for (var j = 0, jl = ik.links.length; j < jl; j++) {
                        this.add(createLinkMesh());
                    }
                    this.add(createLine(ik));
                }
            }
        });
        return CCDIKSolver;
    }();

    return threex.animation.CCDIKSolver = CCDIKSolver;
});
define('skylark-threejs-ex/animation/MMDPhysics',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var MMDPhysics = function () {
        function MMDPhysics(mesh, rigidBodyParams, constraintParams, params) {
            if (typeof Ammo === 'undefined') {
                throw new Error('THREE.MMDPhysics: Import ammo.js https://github.com/kripken/ammo');
            }
            constraintParams = constraintParams || [];
            params = params || {};
            this.manager = new ResourceManager();
            this.mesh = mesh;
            this.unitStep = params.unitStep !== undefined ? params.unitStep : 1 / 65;
            this.maxStepNum = params.maxStepNum !== undefined ? params.maxStepNum : 3;
            this.gravity = new THREE.Vector3(0, -9.8 * 10, 0);
            if (params.gravity !== undefined)
                this.gravity.copy(params.gravity);
            this.world = params.world !== undefined ? params.world : null;
            this.bodies = [];
            this.constraints = [];
            this._init(mesh, rigidBodyParams, constraintParams);
        }
        MMDPhysics.prototype = {
            constructor: MMDPhysics,
            update: function (delta) {
                var manager = this.manager;
                var mesh = this.mesh;
                var isNonDefaultScale = false;
                var position = manager.allocThreeVector3();
                var quaternion = manager.allocThreeQuaternion();
                var scale = manager.allocThreeVector3();
                mesh.matrixWorld.decompose(position, quaternion, scale);
                if (scale.x !== 1 || scale.y !== 1 || scale.z !== 1) {
                    isNonDefaultScale = true;
                }
                var parent;
                if (isNonDefaultScale) {
                    parent = mesh.parent;
                    if (parent !== null)
                        mesh.parent = null;
                    scale.copy(this.mesh.scale);
                    mesh.scale.set(1, 1, 1);
                    mesh.updateMatrixWorld(true);
                }
                this._updateRigidBodies();
                this._stepSimulation(delta);
                this._updateBones();
                if (isNonDefaultScale) {
                    if (parent !== null)
                        mesh.parent = parent;
                    mesh.scale.copy(scale);
                }
                manager.freeThreeVector3(scale);
                manager.freeThreeQuaternion(quaternion);
                manager.freeThreeVector3(position);
                return this;
            },
            reset: function () {
                for (var i = 0, il = this.bodies.length; i < il; i++) {
                    this.bodies[i].reset();
                }
                return this;
            },
            warmup: function (cycles) {
                for (var i = 0; i < cycles; i++) {
                    this.update(1 / 60);
                }
                return this;
            },
            setGravity: function (gravity) {
                this.world.setGravity(new Ammo.btVector3(gravity.x, gravity.y, gravity.z));
                this.gravity.copy(gravity);
                return this;
            },
            createHelper: function () {
                return new MMDPhysicsHelper(this.mesh, this);
            },
            _init: function (mesh, rigidBodyParams, constraintParams) {
                var manager = this.manager;
                var parent = mesh.parent;
                if (parent !== null)
                    parent = null;
                var currentPosition = manager.allocThreeVector3();
                var currentQuaternion = manager.allocThreeQuaternion();
                var currentScale = manager.allocThreeVector3();
                currentPosition.copy(mesh.position);
                currentQuaternion.copy(mesh.quaternion);
                currentScale.copy(mesh.scale);
                mesh.position.set(0, 0, 0);
                mesh.quaternion.set(0, 0, 0, 1);
                mesh.scale.set(1, 1, 1);
                mesh.updateMatrixWorld(true);
                if (this.world === null) {
                    this.world = this._createWorld();
                    this.setGravity(this.gravity);
                }
                this._initRigidBodies(rigidBodyParams);
                this._initConstraints(constraintParams);
                if (parent !== null)
                    mesh.parent = parent;
                mesh.position.copy(currentPosition);
                mesh.quaternion.copy(currentQuaternion);
                mesh.scale.copy(currentScale);
                mesh.updateMatrixWorld(true);
                this.reset();
                manager.freeThreeVector3(currentPosition);
                manager.freeThreeQuaternion(currentQuaternion);
                manager.freeThreeVector3(currentScale);
            },
            _createWorld: function () {
                var config = new Ammo.btDefaultCollisionConfiguration();
                var dispatcher = new Ammo.btCollisionDispatcher(config);
                var cache = new Ammo.btDbvtBroadphase();
                var solver = new Ammo.btSequentialImpulseConstraintSolver();
                var world = new Ammo.btDiscreteDynamicsWorld(dispatcher, cache, solver, config);
                return world;
            },
            _initRigidBodies: function (rigidBodies) {
                for (var i = 0, il = rigidBodies.length; i < il; i++) {
                    this.bodies.push(new RigidBody(this.mesh, this.world, rigidBodies[i], this.manager));
                }
            },
            _initConstraints: function (constraints) {
                for (var i = 0, il = constraints.length; i < il; i++) {
                    var params = constraints[i];
                    var bodyA = this.bodies[params.rigidBodyIndex1];
                    var bodyB = this.bodies[params.rigidBodyIndex2];
                    this.constraints.push(new Constraint(this.mesh, this.world, bodyA, bodyB, params, this.manager));
                }
            },
            _stepSimulation: function (delta) {
                var unitStep = this.unitStep;
                var stepTime = delta;
                var maxStepNum = (delta / unitStep | 0) + 1;
                if (stepTime < unitStep) {
                    stepTime = unitStep;
                    maxStepNum = 1;
                }
                if (maxStepNum > this.maxStepNum) {
                    maxStepNum = this.maxStepNum;
                }
                this.world.stepSimulation(stepTime, maxStepNum, unitStep);
            },
            _updateRigidBodies: function () {
                for (var i = 0, il = this.bodies.length; i < il; i++) {
                    this.bodies[i].updateFromBone();
                }
            },
            _updateBones: function () {
                for (var i = 0, il = this.bodies.length; i < il; i++) {
                    this.bodies[i].updateBone();
                }
            }
        };
        function ResourceManager() {
            this.threeVector3s = [];
            this.threeMatrix4s = [];
            this.threeQuaternions = [];
            this.threeEulers = [];
            this.transforms = [];
            this.quaternions = [];
            this.vector3s = [];
        }
        ResourceManager.prototype = {
            constructor: ResourceManager,
            allocThreeVector3: function () {
                return this.threeVector3s.length > 0 ? this.threeVector3s.pop() : new THREE.Vector3();
            },
            freeThreeVector3: function (v) {
                this.threeVector3s.push(v);
            },
            allocThreeMatrix4: function () {
                return this.threeMatrix4s.length > 0 ? this.threeMatrix4s.pop() : new THREE.Matrix4();
            },
            freeThreeMatrix4: function (m) {
                this.threeMatrix4s.push(m);
            },
            allocThreeQuaternion: function () {
                return this.threeQuaternions.length > 0 ? this.threeQuaternions.pop() : new THREE.Quaternion();
            },
            freeThreeQuaternion: function (q) {
                this.threeQuaternions.push(q);
            },
            allocThreeEuler: function () {
                return this.threeEulers.length > 0 ? this.threeEulers.pop() : new THREE.Euler();
            },
            freeThreeEuler: function (e) {
                this.threeEulers.push(e);
            },
            allocTransform: function () {
                return this.transforms.length > 0 ? this.transforms.pop() : new Ammo.btTransform();
            },
            freeTransform: function (t) {
                this.transforms.push(t);
            },
            allocQuaternion: function () {
                return this.quaternions.length > 0 ? this.quaternions.pop() : new Ammo.btQuaternion();
            },
            freeQuaternion: function (q) {
                this.quaternions.push(q);
            },
            allocVector3: function () {
                return this.vector3s.length > 0 ? this.vector3s.pop() : new Ammo.btVector3();
            },
            freeVector3: function (v) {
                this.vector3s.push(v);
            },
            setIdentity: function (t) {
                t.setIdentity();
            },
            getBasis: function (t) {
                var q = this.allocQuaternion();
                t.getBasis().getRotation(q);
                return q;
            },
            getBasisAsMatrix3: function (t) {
                var q = this.getBasis(t);
                var m = this.quaternionToMatrix3(q);
                this.freeQuaternion(q);
                return m;
            },
            getOrigin: function (t) {
                return t.getOrigin();
            },
            setOrigin: function (t, v) {
                t.getOrigin().setValue(v.x(), v.y(), v.z());
            },
            copyOrigin: function (t1, t2) {
                var o = t2.getOrigin();
                this.setOrigin(t1, o);
            },
            setBasis: function (t, q) {
                t.setRotation(q);
            },
            setBasisFromMatrix3: function (t, m) {
                var q = this.matrix3ToQuaternion(m);
                this.setBasis(t, q);
                this.freeQuaternion(q);
            },
            setOriginFromArray3: function (t, a) {
                t.getOrigin().setValue(a[0], a[1], a[2]);
            },
            setOriginFromThreeVector3: function (t, v) {
                t.getOrigin().setValue(v.x, v.y, v.z);
            },
            setBasisFromArray3: function (t, a) {
                var thQ = this.allocThreeQuaternion();
                var thE = this.allocThreeEuler();
                thE.set(a[0], a[1], a[2]);
                this.setBasisFromThreeQuaternion(t, thQ.setFromEuler(thE));
                this.freeThreeEuler(thE);
                this.freeThreeQuaternion(thQ);
            },
            setBasisFromThreeQuaternion: function (t, a) {
                var q = this.allocQuaternion();
                q.setX(a.x);
                q.setY(a.y);
                q.setZ(a.z);
                q.setW(a.w);
                this.setBasis(t, q);
                this.freeQuaternion(q);
            },
            multiplyTransforms: function (t1, t2) {
                var t = this.allocTransform();
                this.setIdentity(t);
                var m1 = this.getBasisAsMatrix3(t1);
                var m2 = this.getBasisAsMatrix3(t2);
                var o1 = this.getOrigin(t1);
                var o2 = this.getOrigin(t2);
                var v1 = this.multiplyMatrix3ByVector3(m1, o2);
                var v2 = this.addVector3(v1, o1);
                this.setOrigin(t, v2);
                var m3 = this.multiplyMatrices3(m1, m2);
                this.setBasisFromMatrix3(t, m3);
                this.freeVector3(v1);
                this.freeVector3(v2);
                return t;
            },
            inverseTransform: function (t) {
                var t2 = this.allocTransform();
                var m1 = this.getBasisAsMatrix3(t);
                var o = this.getOrigin(t);
                var m2 = this.transposeMatrix3(m1);
                var v1 = this.negativeVector3(o);
                var v2 = this.multiplyMatrix3ByVector3(m2, v1);
                this.setOrigin(t2, v2);
                this.setBasisFromMatrix3(t2, m2);
                this.freeVector3(v1);
                this.freeVector3(v2);
                return t2;
            },
            multiplyMatrices3: function (m1, m2) {
                var m3 = [];
                var v10 = this.rowOfMatrix3(m1, 0);
                var v11 = this.rowOfMatrix3(m1, 1);
                var v12 = this.rowOfMatrix3(m1, 2);
                var v20 = this.columnOfMatrix3(m2, 0);
                var v21 = this.columnOfMatrix3(m2, 1);
                var v22 = this.columnOfMatrix3(m2, 2);
                m3[0] = this.dotVectors3(v10, v20);
                m3[1] = this.dotVectors3(v10, v21);
                m3[2] = this.dotVectors3(v10, v22);
                m3[3] = this.dotVectors3(v11, v20);
                m3[4] = this.dotVectors3(v11, v21);
                m3[5] = this.dotVectors3(v11, v22);
                m3[6] = this.dotVectors3(v12, v20);
                m3[7] = this.dotVectors3(v12, v21);
                m3[8] = this.dotVectors3(v12, v22);
                this.freeVector3(v10);
                this.freeVector3(v11);
                this.freeVector3(v12);
                this.freeVector3(v20);
                this.freeVector3(v21);
                this.freeVector3(v22);
                return m3;
            },
            addVector3: function (v1, v2) {
                var v = this.allocVector3();
                v.setValue(v1.x() + v2.x(), v1.y() + v2.y(), v1.z() + v2.z());
                return v;
            },
            dotVectors3: function (v1, v2) {
                return v1.x() * v2.x() + v1.y() * v2.y() + v1.z() * v2.z();
            },
            rowOfMatrix3: function (m, i) {
                var v = this.allocVector3();
                v.setValue(m[i * 3 + 0], m[i * 3 + 1], m[i * 3 + 2]);
                return v;
            },
            columnOfMatrix3: function (m, i) {
                var v = this.allocVector3();
                v.setValue(m[i + 0], m[i + 3], m[i + 6]);
                return v;
            },
            negativeVector3: function (v) {
                var v2 = this.allocVector3();
                v2.setValue(-v.x(), -v.y(), -v.z());
                return v2;
            },
            multiplyMatrix3ByVector3: function (m, v) {
                var v4 = this.allocVector3();
                var v0 = this.rowOfMatrix3(m, 0);
                var v1 = this.rowOfMatrix3(m, 1);
                var v2 = this.rowOfMatrix3(m, 2);
                var x = this.dotVectors3(v0, v);
                var y = this.dotVectors3(v1, v);
                var z = this.dotVectors3(v2, v);
                v4.setValue(x, y, z);
                this.freeVector3(v0);
                this.freeVector3(v1);
                this.freeVector3(v2);
                return v4;
            },
            transposeMatrix3: function (m) {
                var m2 = [];
                m2[0] = m[0];
                m2[1] = m[3];
                m2[2] = m[6];
                m2[3] = m[1];
                m2[4] = m[4];
                m2[5] = m[7];
                m2[6] = m[2];
                m2[7] = m[5];
                m2[8] = m[8];
                return m2;
            },
            quaternionToMatrix3: function (q) {
                var m = [];
                var x = q.x();
                var y = q.y();
                var z = q.z();
                var w = q.w();
                var xx = x * x;
                var yy = y * y;
                var zz = z * z;
                var xy = x * y;
                var yz = y * z;
                var zx = z * x;
                var xw = x * w;
                var yw = y * w;
                var zw = z * w;
                m[0] = 1 - 2 * (yy + zz);
                m[1] = 2 * (xy - zw);
                m[2] = 2 * (zx + yw);
                m[3] = 2 * (xy + zw);
                m[4] = 1 - 2 * (zz + xx);
                m[5] = 2 * (yz - xw);
                m[6] = 2 * (zx - yw);
                m[7] = 2 * (yz + xw);
                m[8] = 1 - 2 * (xx + yy);
                return m;
            },
            matrix3ToQuaternion: function (m) {
                var t = m[0] + m[4] + m[8];
                var s, x, y, z, w;
                if (t > 0) {
                    s = Math.sqrt(t + 1) * 2;
                    w = 0.25 * s;
                    x = (m[7] - m[5]) / s;
                    y = (m[2] - m[6]) / s;
                    z = (m[3] - m[1]) / s;
                } else if (m[0] > m[4] && m[0] > m[8]) {
                    s = Math.sqrt(1 + m[0] - m[4] - m[8]) * 2;
                    w = (m[7] - m[5]) / s;
                    x = 0.25 * s;
                    y = (m[1] + m[3]) / s;
                    z = (m[2] + m[6]) / s;
                } else if (m[4] > m[8]) {
                    s = Math.sqrt(1 + m[4] - m[0] - m[8]) * 2;
                    w = (m[2] - m[6]) / s;
                    x = (m[1] + m[3]) / s;
                    y = 0.25 * s;
                    z = (m[5] + m[7]) / s;
                } else {
                    s = Math.sqrt(1 + m[8] - m[0] - m[4]) * 2;
                    w = (m[3] - m[1]) / s;
                    x = (m[2] + m[6]) / s;
                    y = (m[5] + m[7]) / s;
                    z = 0.25 * s;
                }
                var q = this.allocQuaternion();
                q.setX(x);
                q.setY(y);
                q.setZ(z);
                q.setW(w);
                return q;
            }
        };
        function RigidBody(mesh, world, params, manager) {
            this.mesh = mesh;
            this.world = world;
            this.params = params;
            this.manager = manager;
            this.body = null;
            this.bone = null;
            this.boneOffsetForm = null;
            this.boneOffsetFormInverse = null;
            this._init();
        }
        RigidBody.prototype = {
            constructor: MMDPhysics.RigidBody,
            reset: function () {
                this._setTransformFromBone();
                return this;
            },
            updateFromBone: function () {
                if (this.params.boneIndex !== -1 && this.params.type === 0) {
                    this._setTransformFromBone();
                }
                return this;
            },
            updateBone: function () {
                if (this.params.type === 0 || this.params.boneIndex === -1) {
                    return this;
                }
                this._updateBoneRotation();
                if (this.params.type === 1) {
                    this._updateBonePosition();
                }
                this.bone.updateMatrixWorld(true);
                if (this.params.type === 2) {
                    this._setPositionFromBone();
                }
                return this;
            },
            _init: function () {
                function generateShape(p) {
                    switch (p.shapeType) {
                    case 0:
                        return new Ammo.btSphereShape(p.width);
                    case 1:
                        return new Ammo.btBoxShape(new Ammo.btVector3(p.width, p.height, p.depth));
                    case 2:
                        return new Ammo.btCapsuleShape(p.width, p.height);
                    default:
                        throw 'unknown shape type ' + p.shapeType;
                    }
                }
                var manager = this.manager;
                var params = this.params;
                var bones = this.mesh.skeleton.bones;
                var bone = params.boneIndex === -1 ? new THREE.Bone() : bones[params.boneIndex];
                var shape = generateShape(params);
                var weight = params.type === 0 ? 0 : params.weight;
                var localInertia = manager.allocVector3();
                localInertia.setValue(0, 0, 0);
                if (weight !== 0) {
                    shape.calculateLocalInertia(weight, localInertia);
                }
                var boneOffsetForm = manager.allocTransform();
                manager.setIdentity(boneOffsetForm);
                manager.setOriginFromArray3(boneOffsetForm, params.position);
                manager.setBasisFromArray3(boneOffsetForm, params.rotation);
                var vector = manager.allocThreeVector3();
                var boneForm = manager.allocTransform();
                manager.setIdentity(boneForm);
                manager.setOriginFromThreeVector3(boneForm, bone.getWorldPosition(vector));
                var form = manager.multiplyTransforms(boneForm, boneOffsetForm);
                var state = new Ammo.btDefaultMotionState(form);
                var info = new Ammo.btRigidBodyConstructionInfo(weight, state, shape, localInertia);
                info.set_m_friction(params.friction);
                info.set_m_restitution(params.restitution);
                var body = new Ammo.btRigidBody(info);
                if (params.type === 0) {
                    body.setCollisionFlags(body.getCollisionFlags() | 2);
                    body.setActivationState(4);
                }
                body.setDamping(params.positionDamping, params.rotationDamping);
                body.setSleepingThresholds(0, 0);
                this.world.addRigidBody(body, 1 << params.groupIndex, params.groupTarget);
                this.body = body;
                this.bone = bone;
                this.boneOffsetForm = boneOffsetForm;
                this.boneOffsetFormInverse = manager.inverseTransform(boneOffsetForm);
                manager.freeVector3(localInertia);
                manager.freeTransform(form);
                manager.freeTransform(boneForm);
                manager.freeThreeVector3(vector);
            },
            _getBoneTransform: function () {
                var manager = this.manager;
                var p = manager.allocThreeVector3();
                var q = manager.allocThreeQuaternion();
                var s = manager.allocThreeVector3();
                this.bone.matrixWorld.decompose(p, q, s);
                var tr = manager.allocTransform();
                manager.setOriginFromThreeVector3(tr, p);
                manager.setBasisFromThreeQuaternion(tr, q);
                var form = manager.multiplyTransforms(tr, this.boneOffsetForm);
                manager.freeTransform(tr);
                manager.freeThreeVector3(s);
                manager.freeThreeQuaternion(q);
                manager.freeThreeVector3(p);
                return form;
            },
            _getWorldTransformForBone: function () {
                var manager = this.manager;
                var tr = this.body.getCenterOfMassTransform();
                return manager.multiplyTransforms(tr, this.boneOffsetFormInverse);
            },
            _setTransformFromBone: function () {
                var manager = this.manager;
                var form = this._getBoneTransform();
                this.body.setCenterOfMassTransform(form);
                this.body.getMotionState().setWorldTransform(form);
                manager.freeTransform(form);
            },
            _setPositionFromBone: function () {
                var manager = this.manager;
                var form = this._getBoneTransform();
                var tr = manager.allocTransform();
                this.body.getMotionState().getWorldTransform(tr);
                manager.copyOrigin(tr, form);
                this.body.setCenterOfMassTransform(tr);
                this.body.getMotionState().setWorldTransform(tr);
                manager.freeTransform(tr);
                manager.freeTransform(form);
            },
            _updateBoneRotation: function () {
                var manager = this.manager;
                var tr = this._getWorldTransformForBone();
                var q = manager.getBasis(tr);
                var thQ = manager.allocThreeQuaternion();
                var thQ2 = manager.allocThreeQuaternion();
                var thQ3 = manager.allocThreeQuaternion();
                thQ.set(q.x(), q.y(), q.z(), q.w());
                thQ2.setFromRotationMatrix(this.bone.matrixWorld);
                thQ2.conjugate();
                thQ2.multiply(thQ);
                thQ3.setFromRotationMatrix(this.bone.matrix);
                this.bone.quaternion.copy(thQ2.multiply(thQ3).normalize());
                manager.freeThreeQuaternion(thQ);
                manager.freeThreeQuaternion(thQ2);
                manager.freeThreeQuaternion(thQ3);
                manager.freeQuaternion(q);
                manager.freeTransform(tr);
            },
            _updateBonePosition: function () {
                var manager = this.manager;
                var tr = this._getWorldTransformForBone();
                var thV = manager.allocThreeVector3();
                var o = manager.getOrigin(tr);
                thV.set(o.x(), o.y(), o.z());
                if (this.bone.parent) {
                    this.bone.parent.worldToLocal(thV);
                }
                this.bone.position.copy(thV);
                manager.freeThreeVector3(thV);
                manager.freeTransform(tr);
            }
        };
        function Constraint(mesh, world, bodyA, bodyB, params, manager) {
            this.mesh = mesh;
            this.world = world;
            this.bodyA = bodyA;
            this.bodyB = bodyB;
            this.params = params;
            this.manager = manager;
            this.constraint = null;
            this._init();
        }
        Constraint.prototype = {
            constructor: Constraint,
            _init: function () {
                var manager = this.manager;
                var params = this.params;
                var bodyA = this.bodyA;
                var bodyB = this.bodyB;
                var form = manager.allocTransform();
                manager.setIdentity(form);
                manager.setOriginFromArray3(form, params.position);
                manager.setBasisFromArray3(form, params.rotation);
                var formA = manager.allocTransform();
                var formB = manager.allocTransform();
                bodyA.body.getMotionState().getWorldTransform(formA);
                bodyB.body.getMotionState().getWorldTransform(formB);
                var formInverseA = manager.inverseTransform(formA);
                var formInverseB = manager.inverseTransform(formB);
                var formA2 = manager.multiplyTransforms(formInverseA, form);
                var formB2 = manager.multiplyTransforms(formInverseB, form);
                var constraint = new Ammo.btGeneric6DofSpringConstraint(bodyA.body, bodyB.body, formA2, formB2, true);
                var lll = manager.allocVector3();
                var lul = manager.allocVector3();
                var all = manager.allocVector3();
                var aul = manager.allocVector3();
                lll.setValue(params.translationLimitation1[0], params.translationLimitation1[1], params.translationLimitation1[2]);
                lul.setValue(params.translationLimitation2[0], params.translationLimitation2[1], params.translationLimitation2[2]);
                all.setValue(params.rotationLimitation1[0], params.rotationLimitation1[1], params.rotationLimitation1[2]);
                aul.setValue(params.rotationLimitation2[0], params.rotationLimitation2[1], params.rotationLimitation2[2]);
                constraint.setLinearLowerLimit(lll);
                constraint.setLinearUpperLimit(lul);
                constraint.setAngularLowerLimit(all);
                constraint.setAngularUpperLimit(aul);
                for (var i = 0; i < 3; i++) {
                    if (params.springPosition[i] !== 0) {
                        constraint.enableSpring(i, true);
                        constraint.setStiffness(i, params.springPosition[i]);
                    }
                }
                for (var i = 0; i < 3; i++) {
                    if (params.springRotation[i] !== 0) {
                        constraint.enableSpring(i + 3, true);
                        constraint.setStiffness(i + 3, params.springRotation[i]);
                    }
                }
                if (constraint.setParam !== undefined) {
                    for (var i = 0; i < 6; i++) {
                        constraint.setParam(2, 0.475, i);
                    }
                }
                this.world.addConstraint(constraint, true);
                this.constraint = constraint;
                manager.freeTransform(form);
                manager.freeTransform(formA);
                manager.freeTransform(formB);
                manager.freeTransform(formInverseA);
                manager.freeTransform(formInverseB);
                manager.freeTransform(formA2);
                manager.freeTransform(formB2);
                manager.freeVector3(lll);
                manager.freeVector3(lul);
                manager.freeVector3(all);
                manager.freeVector3(aul);
            }
        };
        function MMDPhysicsHelper(mesh, physics) {
            THREE.Object3D.call(this);
            this.root = mesh;
            this.physics = physics;
            this.matrix.copy(mesh.matrixWorld);
            this.matrixAutoUpdate = false;
            this.materials = [];
            this.materials.push(new THREE.MeshBasicMaterial({
                color: new THREE.Color(16746632),
                wireframe: true,
                depthTest: false,
                depthWrite: false,
                opacity: 0.25,
                transparent: true
            }));
            this.materials.push(new THREE.MeshBasicMaterial({
                color: new THREE.Color(8978312),
                wireframe: true,
                depthTest: false,
                depthWrite: false,
                opacity: 0.25,
                transparent: true
            }));
            this.materials.push(new THREE.MeshBasicMaterial({
                color: new THREE.Color(8947967),
                wireframe: true,
                depthTest: false,
                depthWrite: false,
                opacity: 0.25,
                transparent: true
            }));
            this._init();
        }
        MMDPhysicsHelper.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
            constructor: MMDPhysicsHelper,
            updateMatrixWorld: function () {
                var position = new THREE.Vector3();
                var quaternion = new THREE.Quaternion();
                var scale = new THREE.Vector3();
                var matrixWorldInv = new THREE.Matrix4();
                return function updateMatrixWorld(force) {
                    var mesh = this.root;
                    if (this.visible) {
                        var bodies = this.physics.bodies;
                        matrixWorldInv.copy(mesh.matrixWorld).decompose(position, quaternion, scale).compose(position, quaternion, scale.set(1, 1, 1)).getInverse(matrixWorldInv);
                        for (var i = 0, il = bodies.length; i < il; i++) {
                            var body = bodies[i].body;
                            var child = this.children[i];
                            var tr = body.getCenterOfMassTransform();
                            var origin = tr.getOrigin();
                            var rotation = tr.getRotation();
                            child.position.set(origin.x(), origin.y(), origin.z()).applyMatrix4(matrixWorldInv);
                            child.quaternion.setFromRotationMatrix(matrixWorldInv).multiply(quaternion.set(rotation.x(), rotation.y(), rotation.z(), rotation.w()));
                        }
                    }
                    this.matrix.copy(mesh.matrixWorld).decompose(position, quaternion, scale).compose(position, quaternion, scale.set(1, 1, 1));
                    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);
                };
            }(),
            _init: function () {
                var bodies = this.physics.bodies;
                function createGeometry(param) {
                    switch (param.shapeType) {
                    case 0:
                        return new THREE.SphereBufferGeometry(param.width, 16, 8);
                    case 1:
                        return new THREE.BoxBufferGeometry(param.width * 2, param.height * 2, param.depth * 2, 8, 8, 8);
                    case 2:
                        return new createCapsuleGeometry(param.width, param.height, 16, 8);
                    default:
                        return null;
                    }
                }
                function createCapsuleGeometry(radius, cylinderHeight, segmentsRadius, segmentsHeight) {
                    var geometry = new THREE.CylinderBufferGeometry(radius, radius, cylinderHeight, segmentsRadius, segmentsHeight, true);
                    var upperSphere = new THREE.Mesh(new THREE.SphereBufferGeometry(radius, segmentsRadius, segmentsHeight, 0, Math.PI * 2, 0, Math.PI / 2));
                    var lowerSphere = new THREE.Mesh(new THREE.SphereBufferGeometry(radius, segmentsRadius, segmentsHeight, 0, Math.PI * 2, Math.PI / 2, Math.PI / 2));
                    upperSphere.position.set(0, cylinderHeight / 2, 0);
                    lowerSphere.position.set(0, -cylinderHeight / 2, 0);
                    upperSphere.updateMatrix();
                    lowerSphere.updateMatrix();
                    geometry.merge(upperSphere.geometry, upperSphere.matrix);
                    geometry.merge(lowerSphere.geometry, lowerSphere.matrix);
                    return geometry;
                }
                for (var i = 0, il = bodies.length; i < il; i++) {
                    var param = bodies[i].params;
                    this.add(new THREE.Mesh(createGeometry(param), this.materials[param.type]));
                }
            }
        });
        return MMDPhysics;
    }();

    return  threex.animation.MMDPhysics = MMDPhysics;
});
define('skylark-threejs-ex/animation/MMDAnimationHelper',[
    "skylark-threejs",
    "../threex",
    './CCDIKSolver',
    './MMDPhysics'
], function (
    THREE, 
    threex,
    CCDIKSolver, 
    MMDPhysics
) {
    'use strict';
    var MMDAnimationHelper = function () {
        function MMDAnimationHelper(params) {
            params = params || {};
            this.meshes = [];
            this.camera = null;
            this.cameraTarget = new THREE.Object3D();
            this.cameraTarget.name = 'target';
            this.audio = null;
            this.audioManager = null;
            this.objects = new WeakMap();
            this.configuration = {
                sync: params.sync !== undefined ? params.sync : true,
                afterglow: params.afterglow !== undefined ? params.afterglow : 0,
                resetPhysicsOnLoop: params.resetPhysicsOnLoop !== undefined ? params.resetPhysicsOnLoop : true
            };
            this.enabled = {
                animation: true,
                ik: true,
                grant: true,
                physics: true,
                cameraAnimation: true
            };
            this.onBeforePhysics = function () {
            };
            this.sharedPhysics = false;
            this.masterPhysics = null;
        }
        MMDAnimationHelper.prototype = {
            constructor: MMDAnimationHelper,
            add: function (object, params) {
                params = params || {};
                if (object.isSkinnedMesh) {
                    this._addMesh(object, params);
                } else if (object.isCamera) {
                    this._setupCamera(object, params);
                } else if (object.type === 'Audio') {
                    this._setupAudio(object, params);
                } else {
                    throw new Error('THREE.MMDAnimationHelper.add: ' + 'accepts only ' + 'THREE.SkinnedMesh or ' + 'THREE.Camera or ' + 'THREE.Audio instance.');
                }
                if (this.configuration.sync)
                    this._syncDuration();
                return this;
            },
            remove: function (object) {
                if (object.isSkinnedMesh) {
                    this._removeMesh(object);
                } else if (object.isCamera) {
                    this._clearCamera(object);
                } else if (object.type === 'Audio') {
                    this._clearAudio(object);
                } else {
                    throw new Error('THREE.MMDAnimationHelper.remove: ' + 'accepts only ' + 'THREE.SkinnedMesh or ' + 'THREE.Camera or ' + 'THREE.Audio instance.');
                }
                if (this.configuration.sync)
                    this._syncDuration();
                return this;
            },
            update: function (delta) {
                if (this.audioManager !== null)
                    this.audioManager.control(delta);
                for (var i = 0; i < this.meshes.length; i++) {
                    this._animateMesh(this.meshes[i], delta);
                }
                if (this.sharedPhysics)
                    this._updateSharedPhysics(delta);
                if (this.camera !== null)
                    this._animateCamera(this.camera, delta);
                return this;
            },
            pose: function (mesh, vpd, params) {
                params = params || {};
                if (params.resetPose !== false)
                    mesh.pose();
                var bones = mesh.skeleton.bones;
                var boneParams = vpd.bones;
                var boneNameDictionary = {};
                for (var i = 0, il = bones.length; i < il; i++) {
                    boneNameDictionary[bones[i].name] = i;
                }
                var vector = new THREE.Vector3();
                var quaternion = new THREE.Quaternion();
                for (var i = 0, il = boneParams.length; i < il; i++) {
                    var boneParam = boneParams[i];
                    var boneIndex = boneNameDictionary[boneParam.name];
                    if (boneIndex === undefined)
                        continue;
                    var bone = bones[boneIndex];
                    bone.position.add(vector.fromArray(boneParam.translation));
                    bone.quaternion.multiply(quaternion.fromArray(boneParam.quaternion));
                }
                mesh.updateMatrixWorld(true);
                if (params.ik !== false) {
                    this._createCCDIKSolver(mesh).update(params.saveOriginalBonesBeforeIK);
                }
                if (params.grant !== false) {
                    this.createGrantSolver(mesh).update();
                }
                return this;
            },
            enable: function (key, enabled) {
                if (this.enabled[key] === undefined) {
                    throw new Error('THREE.MMDAnimationHelper.enable: ' + 'unknown key ' + key);
                }
                this.enabled[key] = enabled;
                if (key === 'physics') {
                    for (var i = 0, il = this.meshes.length; i < il; i++) {
                        this._optimizeIK(this.meshes[i], enabled);
                    }
                }
                return this;
            },
            createGrantSolver: function (mesh) {
                return new GrantSolver(mesh, mesh.geometry.userData.MMD.grants);
            },
            _addMesh: function (mesh, params) {
                if (this.meshes.indexOf(mesh) >= 0) {
                    throw new Error('THREE.MMDAnimationHelper._addMesh: ' + "SkinnedMesh '" + mesh.name + "' has already been added.");
                }
                this.meshes.push(mesh);
                this.objects.set(mesh, { looped: false });
                this._setupMeshAnimation(mesh, params.animation);
                if (params.physics !== false) {
                    this._setupMeshPhysics(mesh, params);
                }
                return this;
            },
            _setupCamera: function (camera, params) {
                if (this.camera === camera) {
                    throw new Error('THREE.MMDAnimationHelper._setupCamera: ' + "Camera '" + camera.name + "' has already been set.");
                }
                if (this.camera)
                    this.clearCamera(this.camera);
                this.camera = camera;
                camera.add(this.cameraTarget);
                this.objects.set(camera, {});
                if (params.animation !== undefined) {
                    this._setupCameraAnimation(camera, params.animation);
                }
                return this;
            },
            _setupAudio: function (audio, params) {
                if (this.audio === audio) {
                    throw new Error('THREE.MMDAnimationHelper._setupAudio: ' + "Audio '" + audio.name + "' has already been set.");
                }
                if (this.audio)
                    this.clearAudio(this.audio);
                this.audio = audio;
                this.audioManager = new AudioManager(audio, params);
                this.objects.set(this.audioManager, { duration: this.audioManager.duration });
                return this;
            },
            _removeMesh: function (mesh) {
                var found = false;
                var writeIndex = 0;
                for (var i = 0, il = this.meshes.length; i < il; i++) {
                    if (this.meshes[i] === mesh) {
                        this.objects.delete(mesh);
                        found = true;
                        continue;
                    }
                    this.meshes[writeIndex++] = this.meshes[i];
                }
                if (!found) {
                    throw new Error('THREE.MMDAnimationHelper._removeMesh: ' + "SkinnedMesh '" + mesh.name + "' has not been added yet.");
                }
                this.meshes.length = writeIndex;
                return this;
            },
            _clearCamera: function (camera) {
                if (camera !== this.camera) {
                    throw new Error('THREE.MMDAnimationHelper._clearCamera: ' + "Camera '" + camera.name + "' has not been set yet.");
                }
                this.camera.remove(this.cameraTarget);
                this.objects.delete(this.camera);
                this.camera = null;
                return this;
            },
            _clearAudio: function (audio) {
                if (audio !== this.audio) {
                    throw new Error('THREE.MMDAnimationHelper._clearAudio: ' + "Audio '" + audio.name + "' has not been set yet.");
                }
                this.objects.delete(this.audioManager);
                this.audio = null;
                this.audioManager = null;
                return this;
            },
            _setupMeshAnimation: function (mesh, animation) {
                var objects = this.objects.get(mesh);
                if (animation !== undefined) {
                    var animations = Array.isArray(animation) ? animation : [animation];
                    objects.mixer = new THREE.AnimationMixer(mesh);
                    for (var i = 0, il = animations.length; i < il; i++) {
                        objects.mixer.clipAction(animations[i]).play();
                    }
                    objects.mixer.addEventListener('loop', function (event) {
                        var tracks = event.action._clip.tracks;
                        if (tracks.length > 0 && tracks[0].name.slice(0, 6) !== '.bones')
                            return;
                        objects.looped = true;
                    });
                }
                objects.ikSolver = this._createCCDIKSolver(mesh);
                objects.grantSolver = this.createGrantSolver(mesh);
                return this;
            },
            _setupCameraAnimation: function (camera, animation) {
                var animations = Array.isArray(animation) ? animation : [animation];
                var objects = this.objects.get(camera);
                objects.mixer = new THREE.AnimationMixer(camera);
                for (var i = 0, il = animations.length; i < il; i++) {
                    objects.mixer.clipAction(animations[i]).play();
                }
            },
            _setupMeshPhysics: function (mesh, params) {
                var objects = this.objects.get(mesh);
                if (params.world === undefined && this.sharedPhysics) {
                    var masterPhysics = this._getMasterPhysics();
                    if (masterPhysics !== null)
                        world = masterPhysics.world;
                }
                objects.physics = this._createMMDPhysics(mesh, params);
                if (objects.mixer && params.animationWarmup !== false) {
                    this._animateMesh(mesh, 0);
                    objects.physics.reset();
                }
                objects.physics.warmup(params.warmup !== undefined ? params.warmup : 60);
                this._optimizeIK(mesh, true);
            },
            _animateMesh: function (mesh, delta) {
                var objects = this.objects.get(mesh);
                var mixer = objects.mixer;
                var ikSolver = objects.ikSolver;
                var grantSolver = objects.grantSolver;
                var physics = objects.physics;
                var looped = objects.looped;
                if (mixer && this.enabled.animation) {
                    this._restoreBones(mesh);
                    mixer.update(delta);
                    this._saveBones(mesh);
                    if (ikSolver && this.enabled.ik) {
                        mesh.updateMatrixWorld(true);
                        ikSolver.update();
                    }
                    if (grantSolver && this.enabled.grant) {
                        grantSolver.update();
                    }
                }
                if (looped === true && this.enabled.physics) {
                    if (physics && this.configuration.resetPhysicsOnLoop)
                        physics.reset();
                    objects.looped = false;
                }
                if (physics && this.enabled.physics && !this.sharedPhysics) {
                    this.onBeforePhysics(mesh);
                    physics.update(delta);
                }
            },
            _animateCamera: function (camera, delta) {
                var mixer = this.objects.get(camera).mixer;
                if (mixer && this.enabled.cameraAnimation) {
                    mixer.update(delta);
                    camera.updateProjectionMatrix();
                    camera.up.set(0, 1, 0);
                    camera.up.applyQuaternion(camera.quaternion);
                    camera.lookAt(this.cameraTarget.position);
                }
            },
            _optimizeIK: function (mesh, physicsEnabled) {
                var iks = mesh.geometry.userData.MMD.iks;
                var bones = mesh.geometry.userData.MMD.bones;
                for (var i = 0, il = iks.length; i < il; i++) {
                    var ik = iks[i];
                    var links = ik.links;
                    for (var j = 0, jl = links.length; j < jl; j++) {
                        var link = links[j];
                        if (physicsEnabled === true) {
                            link.enabled = bones[link.index].rigidBodyType > 0 ? false : true;
                        } else {
                            link.enabled = true;
                        }
                    }
                }
            },
            _createCCDIKSolver: function (mesh) {
                if (CCDIKSolver === undefined) {
                    throw new Error('THREE.MMDAnimationHelper: Import CCDIKSolver.');
                }
                return new CCDIKSolver(mesh, mesh.geometry.userData.MMD.iks);
            },
            _createMMDPhysics: function (mesh, params) {
                if (MMDPhysics === undefined) {
                    throw new Error('THREE.MMDPhysics: Import MMDPhysics.');
                }
                return new MMDPhysics(mesh, mesh.geometry.userData.MMD.rigidBodies, mesh.geometry.userData.MMD.constraints, params);
            },
            _syncDuration: function () {
                var max = 0;
                var objects = this.objects;
                var meshes = this.meshes;
                var camera = this.camera;
                var audioManager = this.audioManager;
                for (var i = 0, il = meshes.length; i < il; i++) {
                    var mixer = this.objects.get(meshes[i]).mixer;
                    if (mixer === undefined)
                        continue;
                    for (var j = 0; j < mixer._actions.length; j++) {
                        var clip = mixer._actions[j]._clip;
                        if (!objects.has(clip)) {
                            objects.set(clip, { duration: clip.duration });
                        }
                        max = Math.max(max, objects.get(clip).duration);
                    }
                }
                if (camera !== null) {
                    var mixer = this.objects.get(camera).mixer;
                    if (mixer !== undefined) {
                        for (var i = 0, il = mixer._actions.length; i < il; i++) {
                            var clip = mixer._actions[i]._clip;
                            if (!objects.has(clip)) {
                                objects.set(clip, { duration: clip.duration });
                            }
                            max = Math.max(max, objects.get(clip).duration);
                        }
                    }
                }
                if (audioManager !== null) {
                    max = Math.max(max, objects.get(audioManager).duration);
                }
                max += this.configuration.afterglow;
                for (var i = 0, il = this.meshes.length; i < il; i++) {
                    var mixer = this.objects.get(this.meshes[i]).mixer;
                    if (mixer === undefined)
                        continue;
                    for (var j = 0, jl = mixer._actions.length; j < jl; j++) {
                        mixer._actions[j]._clip.duration = max;
                    }
                }
                if (camera !== null) {
                    var mixer = this.objects.get(camera).mixer;
                    if (mixer !== undefined) {
                        for (var i = 0, il = mixer._actions.length; i < il; i++) {
                            mixer._actions[i]._clip.duration = max;
                        }
                    }
                }
                if (audioManager !== null) {
                    audioManager.duration = max;
                }
            },
            _updatePropertyMixersBuffer: function (mesh) {
                var mixer = this.objects.get(mesh).mixer;
                var propertyMixers = mixer._bindings;
                var accuIndex = mixer._accuIndex;
                for (var i = 0, il = propertyMixers.length; i < il; i++) {
                    var propertyMixer = propertyMixers[i];
                    var buffer = propertyMixer.buffer;
                    var stride = propertyMixer.valueSize;
                    var offset = (accuIndex + 1) * stride;
                    propertyMixer.binding.getValue(buffer, offset);
                }
            },
            _saveBones: function (mesh) {
                var objects = this.objects.get(mesh);
                var bones = mesh.skeleton.bones;
                var backupBones = objects.backupBones;
                if (backupBones === undefined) {
                    backupBones = new Float32Array(bones.length * 7);
                    objects.backupBones = backupBones;
                }
                for (var i = 0, il = bones.length; i < il; i++) {
                    var bone = bones[i];
                    bone.position.toArray(backupBones, i * 7);
                    bone.quaternion.toArray(backupBones, i * 7 + 3);
                }
            },
            _restoreBones: function (mesh) {
                var objects = this.objects.get(mesh);
                var backupBones = objects.backupBones;
                if (backupBones === undefined)
                    return;
                var bones = mesh.skeleton.bones;
                for (var i = 0, il = bones.length; i < il; i++) {
                    var bone = bones[i];
                    bone.position.fromArray(backupBones, i * 7);
                    bone.quaternion.fromArray(backupBones, i * 7 + 3);
                }
            },
            _getMasterPhysics: function () {
                if (this.masterPhysics !== null)
                    return this.masterPhysics;
                for (var i = 0, il = this.meshes.length; i < il; i++) {
                    var physics = this.meshes[i].physics;
                    if (physics !== undefined && physics !== null) {
                        this.masterPhysics = physics;
                        return this.masterPhysics;
                    }
                }
                return null;
            },
            _updateSharedPhysics: function (delta) {
                if (this.meshes.length === 0 || !this.enabled.physics || !this.sharedPhysics)
                    return;
                var physics = this._getMasterPhysics();
                if (physics === null)
                    return;
                for (var i = 0, il = this.meshes.length; i < il; i++) {
                    var p = this.meshes[i].physics;
                    if (p !== null && p !== undefined) {
                        p.updateRigidBodies();
                    }
                }
                physics.stepSimulation(delta);
                for (var i = 0, il = this.meshes.length; i < il; i++) {
                    var p = this.meshes[i].physics;
                    if (p !== null && p !== undefined) {
                        p.updateBones();
                    }
                }
            }
        };
        function AudioManager(audio, params) {
            params = params || {};
            this.audio = audio;
            this.elapsedTime = 0;
            this.currentTime = 0;
            this.delayTime = params.delayTime !== undefined ? params.delayTime : 0;
            this.audioDuration = this.audio.buffer.duration;
            this.duration = this.audioDuration + this.delayTime;
        }
        AudioManager.prototype = {
            constructor: AudioManager,
            control: function (delta) {
                this.elapsed += delta;
                this.currentTime += delta;
                if (this._shouldStopAudio())
                    this.audio.stop();
                if (this._shouldStartAudio())
                    this.audio.play();
                return this;
            },
            _shouldStartAudio: function () {
                if (this.audio.isPlaying)
                    return false;
                while (this.currentTime >= this.duration) {
                    this.currentTime -= this.duration;
                }
                if (this.currentTime < this.delayTime)
                    return false;
                if (this.currentTime - this.delayTime > this.audioDuration)
                    return false;
                this.audio.startTime = this.currentTime - this.delayTime;
                return true;
            },
            _shouldStopAudio: function () {
                return this.audio.isPlaying && this.currentTime >= this.duration;
            }
        };
        function GrantSolver(mesh, grants) {
            this.mesh = mesh;
            this.grants = grants || [];
        }
        GrantSolver.prototype = {
            constructor: GrantSolver,
            update: function () {
                var quaternion = new THREE.Quaternion();
                return function () {
                    var bones = this.mesh.skeleton.bones;
                    var grants = this.grants;
                    for (var i = 0, il = grants.length; i < il; i++) {
                        var grant = grants[i];
                        var bone = bones[grant.index];
                        var parentBone = bones[grant.parentIndex];
                        if (grant.isLocal) {
                            if (grant.affectPosition) {
                            }
                            if (grant.affectRotation) {
                            }
                        } else {
                            if (grant.affectPosition) {
                            }
                            if (grant.affectRotation) {
                                quaternion.set(0, 0, 0, 1);
                                quaternion.slerp(parentBone.quaternion, grant.ratio);
                                bone.quaternion.multiply(quaternion);
                            }
                        }
                    }
                    return this;
                };
            }()
        };
        return MMDAnimationHelper;
    }();

    return threex.animation.MMDAnimationHelper = MMDAnimationHelper;
});
define('skylark-threejs-ex/animation/TimelinerController',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var TimelinerController = function TimelinerController(scene, trackInfo, onUpdate) {
        this._scene = scene;
        this._trackInfo = trackInfo;
        this._onUpdate = onUpdate;
        this._mixer = new THREE.AnimationMixer(scene);
        this._clip = null;
        this._action = null;
        this._tracks = {};
        this._propRefs = {};
        this._channelNames = [];
    };
    TimelinerController.prototype = {
        constructor: TimelinerController,
        init: function () {
            var tracks = [], trackInfo = this._trackInfo;
            for (var i = 0, n = trackInfo.length; i !== n; ++i) {
                var spec = trackInfo[i];
                tracks.push(this._addTrack(spec.type, spec.propertyPath, spec.initialValue, spec.interpolation));
            }
            this._clip = new THREE.AnimationClip('editclip', 0, tracks);
            this._action = this._mixer.clipAction(this._clip).play();
        },
        setDisplayTime: function (time) {
            this._action.time = time;
            this._mixer.update(0);
            this._onUpdate();
        },
        setDuration: function (duration) {
            this._clip.duration = duration;
        },
        getChannelNames: function () {
            return this._channelNames;
        },
        getChannelKeyTimes: function (channelName) {
            return this._tracks[channelName].times;
        },
        setKeyframe: function (channelName, time) {
            var track = this._tracks[channelName], times = track.times, index = Timeliner.binarySearch(times, time), values = track.values, stride = track.getValueSize(), offset = index * stride;
            if (index < 0) {
                index = ~index;
                offset = index * stride;
                var nTimes = times.length + 1, nValues = values.length + stride;
                for (var i = nTimes - 1; i !== index; --i) {
                    times[i] = times[i - 1];
                }
                for (var i = nValues - 1, e = offset + stride - 1; i !== e; --i) {
                    values[i] = values[i - stride];
                }
            }
            times[index] = time;
            this._propRefs[channelName].getValue(values, offset);
        },
        delKeyframe: function (channelName, time) {
            var track = this._tracks[channelName], times = track.times, index = Timeliner.binarySearch(times, time);
            if (times.length > 1 && index >= 0) {
                var nTimes = times.length - 1, values = track.values, stride = track.getValueSize(), nValues = values.length - stride;
                for (var i = index; i !== nTimes; ++i) {
                    times[i] = times[i + 1];
                }
                times.pop();
                for (var offset = index * stride; offset !== nValues; ++offset) {
                    values[offset] = values[offset + stride];
                }
                values.length = nValues;
            }
        },
        moveKeyframe: function (channelName, time, delta, moveRemaining) {
            var track = this._tracks[channelName], times = track.times, index = Timeliner.binarySearch(times, time);
            if (index >= 0) {
                var endAt = moveRemaining ? times.length : index + 1, needsSort = times[index - 1] <= time || !moveRemaining && time >= times[index + 1];
                while (index !== endAt)
                    times[index++] += delta;
                if (needsSort)
                    this._sort(track);
            }
        },
        serialize: function () {
            var result = {
                    duration: this._clip.duration,
                    channels: {}
                }, names = this._channelNames, tracks = this._tracks, channels = result.channels;
            for (var i = 0, n = names.length; i !== n; ++i) {
                var name = names[i], track = tracks[name];
                channels[name] = {
                    times: track.times,
                    values: track.values
                };
            }
            return result;
        },
        deserialize: function (structs) {
            var names = this._channelNames, tracks = this._tracks, channels = structs.channels;
            this.setDuration(structs.duration);
            for (var i = 0, n = names.length; i !== n; ++i) {
                var name = names[i], track = tracks[name], data = channels[name];
                this._setArray(track.times, data.times);
                this._setArray(track.values, data.values);
            }
            this.setDisplayTime(this._mixer.time);
        },
        _sort: function (track) {
            var times = track.times, order = THREE.AnimationUtils.getKeyframeOrder(times);
            this._setArray(times, THREE.AnimationUtils.sortedArray(times, 1, order));
            var values = track.values, stride = track.getValueSize();
            this._setArray(values, THREE.AnimationUtils.sortedArray(values, stride, order));
        },
        _setArray: function (dst, src) {
            dst.length = 0;
            dst.push.apply(dst, src);
        },
        _addTrack: function (type, prop, initialValue, interpolation) {
            var track = new type(prop, [0], initialValue, interpolation);
            track.times = Array.prototype.slice.call(track.times);
            track.values = Array.prototype.slice.call(track.values);
            this._channelNames.push(prop);
            this._tracks[prop] = track;
            this._propRefs[prop] = new THREE.PropertyBinding(this._scene, prop);
            return track;
        }
    };

    return threex.animation.TimelinerController = TimelinerController;
});
define('skylark-threejs-ex/shaders/BokehShader2',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var BokehShader = {
        uniforms: {
            'textureWidth': { value: 1 },
            'textureHeight': { value: 1 },
            'focalDepth': { value: 1 },
            'focalLength': { value: 24 },
            'fstop': { value: 0.9 },
            'tColor': { value: null },
            'tDepth': { value: null },
            'maxblur': { value: 1 },
            'showFocus': { value: 0 },
            'manualdof': { value: 0 },
            'vignetting': { value: 0 },
            'depthblur': { value: 0 },
            'threshold': { value: 0.5 },
            'gain': { value: 2 },
            'bias': { value: 0.5 },
            'fringe': { value: 0.7 },
            'znear': { value: 0.1 },
            'zfar': { value: 100 },
            'noise': { value: 1 },
            'dithering': { value: 0.0001 },
            'pentagon': { value: 0 },
            'shaderFocus': { value: 1 },
            'focusCoords': { value: new THREE.Vector2() }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#include <common>',
            'varying vec2 vUv;',
            'uniform sampler2D tColor;',
            'uniform sampler2D tDepth;',
            'uniform float textureWidth;',
            'uniform float textureHeight;',
            'uniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below',
            'uniform float focalLength; //focal length in mm',
            'uniform float fstop; //f-stop value',
            'uniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)',
            '/*',
            'make sure that these two values are the same for your camera, otherwise distances will be wrong.',
            '*/',
            'uniform float znear; // camera clipping start',
            'uniform float zfar; // camera clipping end',
            '//------------------------------------------',
            '//user variables',
            'const int samples = SAMPLES; //samples on the first ring',
            'const int rings = RINGS; //ring count',
            'const int maxringsamples = rings * samples;',
            'uniform bool manualdof; // manual dof calculation',
            'float ndofstart = 1.0; // near dof blur start',
            'float ndofdist = 2.0; // near dof blur falloff distance',
            'float fdofstart = 1.0; // far dof blur start',
            'float fdofdist = 3.0; // far dof blur falloff distance',
            'float CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)',
            'uniform bool vignetting; // use optical lens vignetting',
            'float vignout = 1.3; // vignetting outer border',
            'float vignin = 0.0; // vignetting inner border',
            'float vignfade = 22.0; // f-stops till vignete fades',
            'uniform bool shaderFocus;',
            '// disable if you use external focalDepth value',
            'uniform vec2 focusCoords;',
            '// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)',
            '// if center of screen use vec2(0.5, 0.5);',
            'uniform float maxblur;',
            '//clamp value of max blur (0.0 = no blur, 1.0 default)',
            'uniform float threshold; // highlight threshold;',
            'uniform float gain; // highlight gain;',
            'uniform float bias; // bokeh edge bias',
            'uniform float fringe; // bokeh chromatic aberration / fringing',
            'uniform bool noise; //use noise instead of pattern for sample dithering',
            'uniform float dithering;',
            'uniform bool depthblur; // blur the depth buffer',
            'float dbsize = 1.25; // depth blur size',
            '/*',
            'next part is experimental',
            'not looking good with small sample and ring count',
            'looks okay starting from samples = 4, rings = 4',
            '*/',
            'uniform bool pentagon; //use pentagon as bokeh shape?',
            'float feather = 0.4; //pentagon shape feather',
            '//------------------------------------------',
            'float penta(vec2 coords) {',
            '\t//pentagonal shape',
            '\tfloat scale = float(rings) - 1.3;',
            '\tvec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);',
            '\tvec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);',
            '\tvec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);',
            '\tvec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);',
            '\tvec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);',
            '\tvec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);',
            '\tvec4  one = vec4( 1.0 );',
            '\tvec4 P = vec4((coords),vec2(scale, scale));',
            '\tvec4 dist = vec4(0.0);',
            '\tfloat inorout = -4.0;',
            '\tdist.x = dot( P, HS0 );',
            '\tdist.y = dot( P, HS1 );',
            '\tdist.z = dot( P, HS2 );',
            '\tdist.w = dot( P, HS3 );',
            '\tdist = smoothstep( -feather, feather, dist );',
            '\tinorout += dot( dist, one );',
            '\tdist.x = dot( P, HS4 );',
            '\tdist.y = HS5.w - abs( P.z );',
            '\tdist = smoothstep( -feather, feather, dist );',
            '\tinorout += dist.x;',
            '\treturn clamp( inorout, 0.0, 1.0 );',
            '}',
            'float bdepth(vec2 coords) {',
            '\t// Depth buffer blur',
            '\tfloat d = 0.0;',
            '\tfloat kernel[9];',
            '\tvec2 offset[9];',
            '\tvec2 wh = vec2(1.0/textureWidth,1.0/textureHeight) * dbsize;',
            '\toffset[0] = vec2(-wh.x,-wh.y);',
            '\toffset[1] = vec2( 0.0, -wh.y);',
            '\toffset[2] = vec2( wh.x -wh.y);',
            '\toffset[3] = vec2(-wh.x,  0.0);',
            '\toffset[4] = vec2( 0.0,   0.0);',
            '\toffset[5] = vec2( wh.x,  0.0);',
            '\toffset[6] = vec2(-wh.x, wh.y);',
            '\toffset[7] = vec2( 0.0,  wh.y);',
            '\toffset[8] = vec2( wh.x, wh.y);',
            '\tkernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;',
            '\tkernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;',
            '\tkernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;',
            '\tfor( int i=0; i<9; i++ ) {',
            '\t\tfloat tmp = texture2D(tDepth, coords + offset[i]).r;',
            '\t\td += tmp * kernel[i];',
            '\t}',
            '\treturn d;',
            '}',
            'vec3 color(vec2 coords,float blur) {',
            '\t//processing the sample',
            '\tvec3 col = vec3(0.0);',
            '\tvec2 texel = vec2(1.0/textureWidth,1.0/textureHeight);',
            '\tcol.r = texture2D(tColor,coords + vec2(0.0,1.0)*texel*fringe*blur).r;',
            '\tcol.g = texture2D(tColor,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;',
            '\tcol.b = texture2D(tColor,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;',
            '\tvec3 lumcoeff = vec3(0.299,0.587,0.114);',
            '\tfloat lum = dot(col.rgb, lumcoeff);',
            '\tfloat thresh = max((lum-threshold)*gain, 0.0);',
            '\treturn col+mix(vec3(0.0),col,thresh*blur);',
            '}',
            'vec3 debugFocus(vec3 col, float blur, float depth) {',
            '\tfloat edge = 0.002*depth; //distance based edge smoothing',
            '\tfloat m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);',
            '\tfloat e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);',
            '\tcol = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);',
            '\tcol = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);',
            '\treturn col;',
            '}',
            'float linearize(float depth) {',
            '\treturn -zfar * znear / (depth * (zfar - znear) - zfar);',
            '}',
            'float vignette() {',
            '\tfloat dist = distance(vUv.xy, vec2(0.5,0.5));',
            '\tdist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);',
            '\treturn clamp(dist,0.0,1.0);',
            '}',
            'float gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {',
            '\tfloat rings2 = float(rings);',
            '\tfloat step = PI*2.0 / float(ringsamples);',
            '\tfloat pw = cos(j*step)*i;',
            '\tfloat ph = sin(j*step)*i;',
            '\tfloat p = 1.0;',
            '\tif (pentagon) {',
            '\t\tp = penta(vec2(pw,ph));',
            '\t}',
            '\tcol += color(vUv.xy + vec2(pw*w,ph*h), blur) * mix(1.0, i/rings2, bias) * p;',
            '\treturn 1.0 * mix(1.0, i /rings2, bias) * p;',
            '}',
            'void main() {',
            '\t//scene depth calculation',
            '\tfloat depth = linearize(texture2D(tDepth,vUv.xy).x);',
            '\t// Blur depth?',
            '\tif ( depthblur ) {',
            '\t\tdepth = linearize(bdepth(vUv.xy));',
            '\t}',
            '\t//focal plane calculation',
            '\tfloat fDepth = focalDepth;',
            '\tif (shaderFocus) {',
            '\t\tfDepth = linearize(texture2D(tDepth,focusCoords).x);',
            '\t}',
            '\t// dof blur factor calculation',
            '\tfloat blur = 0.0;',
            '\tif (manualdof) {',
            '\t\tfloat a = depth-fDepth; // Focal plane',
            '\t\tfloat b = (a-fdofstart)/fdofdist; // Far DoF',
            '\t\tfloat c = (-a-ndofstart)/ndofdist; // Near Dof',
            '\t\tblur = (a>0.0) ? b : c;',
            '\t} else {',
            '\t\tfloat f = focalLength; // focal length in mm',
            '\t\tfloat d = fDepth*1000.0; // focal plane in mm',
            '\t\tfloat o = depth*1000.0; // depth in mm',
            '\t\tfloat a = (o*f)/(o-f);',
            '\t\tfloat b = (d*f)/(d-f);',
            '\t\tfloat c = (d-f)/(d*fstop*CoC);',
            '\t\tblur = abs(a-b)*c;',
            '\t}',
            '\tblur = clamp(blur,0.0,1.0);',
            '\t// calculation of pattern for dithering',
            '\tvec2 noise = vec2(rand(vUv.xy), rand( vUv.xy + vec2( 0.4, 0.6 ) ) )*dithering*blur;',
            '\t// getting blur x and y step factor',
            '\tfloat w = (1.0/textureWidth)*blur*maxblur+noise.x;',
            '\tfloat h = (1.0/textureHeight)*blur*maxblur+noise.y;',
            '\t// calculation of final color',
            '\tvec3 col = vec3(0.0);',
            '\tif(blur < 0.05) {',
            '\t\t//some optimization thingy',
            '\t\tcol = texture2D(tColor, vUv.xy).rgb;',
            '\t} else {',
            '\t\tcol = texture2D(tColor, vUv.xy).rgb;',
            '\t\tfloat s = 1.0;',
            '\t\tint ringsamples;',
            '\t\tfor (int i = 1; i <= rings; i++) {',
            '\t\t\t/*unboxstart*/',
            '\t\t\tringsamples = i * samples;',
            '\t\t\tfor (int j = 0 ; j < maxringsamples ; j++) {',
            '\t\t\t\tif (j >= ringsamples) break;',
            '\t\t\t\ts += gather(float(i), float(j), ringsamples, col, w, h, blur);',
            '\t\t\t}',
            '\t\t\t/*unboxend*/',
            '\t\t}',
            '\t\tcol /= s; //divide by sample count',
            '\t}',
            '\tif (showFocus) {',
            '\t\tcol = debugFocus(col, blur, depth);',
            '\t}',
            '\tif (vignetting) {',
            '\t\tcol *= vignette();',
            '\t}',
            '\tgl_FragColor.rgb = col;',
            '\tgl_FragColor.a = 1.0;',
            '} '
        ].join('\n')
    };
    var BokehDepthShader = BokehShader.BokehDepthShader =  {
        uniforms: {
            'mNear': { value: 1 },
            'mFar': { value: 1000 }
        },
        vertexShader: [
            'varying float vViewZDepth;',
            'void main() {',
            '\t#include <begin_vertex>',
            '\t#include <project_vertex>',
            '\tvViewZDepth = - mvPosition.z;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float mNear;',
            'uniform float mFar;',
            'varying float vViewZDepth;',
            'void main() {',
            '\tfloat color = 1.0 - smoothstep( mNear, mFar, vViewZDepth );',
            '\tgl_FragColor = vec4( vec3( color ), 1.0 );',
            '} '
        ].join('\n')
    };

    return  threex.shaders.BokehShader2 = BokehShader;
});
define('skylark-threejs-ex/cameras/CinematicCamera',[
    "skylark-threejs",
    "../threex",
    '../shaders/BokehShader2'
], function (
    THREE,
    threex,
    BokehShader
) {
    'use strict';
    var CinematicCamera = function (fov, aspect, near, far) {
        THREE.PerspectiveCamera.call(this, fov, aspect, near, far);
        this.type = 'CinematicCamera';
        this.postprocessing = { enabled: true };
        this.shaderSettings = {
            rings: 3,
            samples: 4
        };
        var depthShader = BokehDepthShader;
        this.materialDepth = new THREE.ShaderMaterial({
            uniforms: depthShader.uniforms,
            vertexShader: depthShader.vertexShader,
            fragmentShader: depthShader.fragmentShader
        });
        this.materialDepth.uniforms['mNear'].value = near;
        this.materialDepth.uniforms['mFar'].value = far;
        this.setLens();
        this.initPostProcessing();
    };
    CinematicCamera.prototype = Object.create(THREE.PerspectiveCamera.prototype);
    CinematicCamera.prototype.constructor = CinematicCamera;
    CinematicCamera.prototype.setLens = function (focalLength, filmGauge, fNumber, coc) {
        if (focalLength === undefined)
            focalLength = 35;
        if (filmGauge !== undefined)
            this.filmGauge = filmGauge;
        this.setFocalLength(focalLength);
        if (fNumber === undefined)
            fNumber = 8;
        if (coc === undefined)
            coc = 0.019;
        this.fNumber = fNumber;
        this.coc = coc;
        this.aperture = focalLength / this.fNumber;
        this.hyperFocal = focalLength * focalLength / (this.aperture * this.coc);
    };
    CinematicCamera.prototype.linearize = function (depth) {
        var zfar = this.far;
        var znear = this.near;
        return -zfar * znear / (depth * (zfar - znear) - zfar);
    };
    CinematicCamera.prototype.smoothstep = function (near, far, depth) {
        var x = this.saturate((depth - near) / (far - near));
        return x * x * (3 - 2 * x);
    };
    CinematicCamera.prototype.saturate = function (x) {
        return Math.max(0, Math.min(1, x));
    };
    CinematicCamera.prototype.focusAt = function (focusDistance) {
        if (focusDistance === undefined)
            focusDistance = 20;
        var focalLength = this.getFocalLength();
        this.focus = focusDistance;
        this.nearPoint = this.hyperFocal * this.focus / (this.hyperFocal + (this.focus - focalLength));
        this.farPoint = this.hyperFocal * this.focus / (this.hyperFocal - (this.focus - focalLength));
        this.depthOfField = this.farPoint - this.nearPoint;
        if (this.depthOfField < 0)
            this.depthOfField = 0;
        this.sdistance = this.smoothstep(this.near, this.far, this.focus);
        this.ldistance = this.linearize(1 - this.sdistance);
        this.postprocessing.bokeh_uniforms['focalDepth'].value = this.ldistance;
    };
    CinematicCamera.prototype.initPostProcessing = function () {
        if (this.postprocessing.enabled) {
            this.postprocessing.scene = new THREE.Scene();
            this.postprocessing.camera = new THREE.OrthographicCamera(window.innerWidth / -2, window.innerWidth / 2, window.innerHeight / 2, window.innerHeight / -2, -10000, 10000);
            this.postprocessing.scene.add(this.postprocessing.camera);
            var pars = {
                minFilter: THREE.LinearFilter,
                magFilter: THREE.LinearFilter,
                format: THREE.RGBFormat
            };
            this.postprocessing.rtTextureDepth = new THREE.WebGLRenderTarget(window.innerWidth, window.innerHeight, pars);
            this.postprocessing.rtTextureColor = new THREE.WebGLRenderTarget(window.innerWidth, window.innerHeight, pars);
            var bokeh_shader = BokehShader;
            this.postprocessing.bokeh_uniforms = THREE.UniformsUtils.clone(bokeh_shader.uniforms);
            this.postprocessing.bokeh_uniforms['tColor'].value = this.postprocessing.rtTextureColor.texture;
            this.postprocessing.bokeh_uniforms['tDepth'].value = this.postprocessing.rtTextureDepth.texture;
            this.postprocessing.bokeh_uniforms['manualdof'].value = 0;
            this.postprocessing.bokeh_uniforms['shaderFocus'].value = 0;
            this.postprocessing.bokeh_uniforms['fstop'].value = 2.8;
            this.postprocessing.bokeh_uniforms['showFocus'].value = 1;
            this.postprocessing.bokeh_uniforms['focalDepth'].value = 0.1;
            this.postprocessing.bokeh_uniforms['znear'].value = this.near;
            this.postprocessing.bokeh_uniforms['zfar'].value = this.near;
            this.postprocessing.bokeh_uniforms['textureWidth'].value = window.innerWidth;
            this.postprocessing.bokeh_uniforms['textureHeight'].value = window.innerHeight;
            this.postprocessing.materialBokeh = new THREE.ShaderMaterial({
                uniforms: this.postprocessing.bokeh_uniforms,
                vertexShader: bokeh_shader.vertexShader,
                fragmentShader: bokeh_shader.fragmentShader,
                defines: {
                    RINGS: this.shaderSettings.rings,
                    SAMPLES: this.shaderSettings.samples,
                    DEPTH_PACKING: 1
                }
            });
            this.postprocessing.quad = new THREE.Mesh(new THREE.PlaneBufferGeometry(window.innerWidth, window.innerHeight), this.postprocessing.materialBokeh);
            this.postprocessing.quad.position.z = -500;
            this.postprocessing.scene.add(this.postprocessing.quad);
        }
    };
    CinematicCamera.prototype.renderCinematic = function (scene, renderer) {
        if (this.postprocessing.enabled) {
            var currentRenderTarget = renderer.getRenderTarget();
            renderer.clear();
            scene.overrideMaterial = null;
            renderer.setRenderTarget(this.postprocessing.rtTextureColor);
            renderer.clear();
            renderer.render(scene, this);
            scene.overrideMaterial = this.materialDepth;
            renderer.setRenderTarget(this.postprocessing.rtTextureDepth);
            renderer.clear();
            renderer.render(scene, this);
            renderer.setRenderTarget(null);
            renderer.render(this.postprocessing.scene, this.postprocessing.camera);
            renderer.setRenderTarget(currentRenderTarget);
        }
    };
    return threex.cameras.CinematicCamera = CinematicCamera;
});
define('skylark-threejs-ex/controls/DeviceOrientationControls',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var DeviceOrientationControls = function (object) {
        var scope = this;
        this.object = object;
        this.object.rotation.reorder('YXZ');
        this.enabled = true;
        this.deviceOrientation = {};
        this.screenOrientation = 0;
        this.alphaOffset = 0;
        var onDeviceOrientationChangeEvent = function (event) {
            scope.deviceOrientation = event;
        };
        var onScreenOrientationChangeEvent = function () {
            scope.screenOrientation = window.orientation || 0;
        };
        var setObjectQuaternion = function () {
            var zee = new THREE.Vector3(0, 0, 1);
            var euler = new THREE.Euler();
            var q0 = new THREE.Quaternion();
            var q1 = new THREE.Quaternion(-Math.sqrt(0.5), 0, 0, Math.sqrt(0.5));
            return function (quaternion, alpha, beta, gamma, orient) {
                euler.set(beta, alpha, -gamma, 'YXZ');
                quaternion.setFromEuler(euler);
                quaternion.multiply(q1);
                quaternion.multiply(q0.setFromAxisAngle(zee, -orient));
            };
        }();
        this.connect = function () {
            onScreenOrientationChangeEvent();
            if (window.DeviceOrientationEvent !== undefined && typeof window.DeviceOrientationEvent.requestPermission === 'function') {
                window.DeviceOrientationEvent.requestPermission().then(function (response) {
                    if (response == 'granted') {
                        window.addEventListener('orientationchange', onScreenOrientationChangeEvent, false);
                        window.addEventListener('deviceorientation', onDeviceOrientationChangeEvent, false);
                    }
                }).catch(function (error) {
                    console.error('THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:', error);
                });
            } else {
                window.addEventListener('orientationchange', onScreenOrientationChangeEvent, false);
                window.addEventListener('deviceorientation', onDeviceOrientationChangeEvent, false);
            }
            scope.enabled = true;
        };
        this.disconnect = function () {
            window.removeEventListener('orientationchange', onScreenOrientationChangeEvent, false);
            window.removeEventListener('deviceorientation', onDeviceOrientationChangeEvent, false);
            scope.enabled = false;
        };
        this.update = function () {
            if (scope.enabled === false)
                return;
            var device = scope.deviceOrientation;
            if (device) {
                var alpha = device.alpha ? THREE.MathUtils.degToRad(device.alpha) + scope.alphaOffset : 0;
                var beta = device.beta ? THREE.MathUtils.degToRad(device.beta) : 0;
                var gamma = device.gamma ? THREE.MathUtils.degToRad(device.gamma) : 0;
                var orient = scope.screenOrientation ? THREE.MathUtils.degToRad(scope.screenOrientation) : 0;
                setObjectQuaternion(scope.object.quaternion, alpha, beta, gamma, orient);
            }
        };
        this.dispose = function () {
            scope.disconnect();
        };
        this.connect();
    };
    return threex.controls.DeviceOrientationControls = DeviceOrientationControls;
});
define('skylark-threejs-ex/controls/DragControls',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var DragControls = function (_objects, _camera, _domElement) {
        var _plane = new THREE.Plane();
        var _raycaster = new THREE.Raycaster();
        var _mouse = new THREE.Vector2();
        var _offset = new THREE.Vector3();
        var _intersection = new THREE.Vector3();
        var _worldPosition = new THREE.Vector3();
        var _inverseMatrix = new THREE.Matrix4();
        var _intersections = [];
        var _selected = null, _hovered = null;
        var scope = this;
        function activate() {
            _domElement.addEventListener('mousemove', onDocumentMouseMove, false);
            _domElement.addEventListener('mousedown', onDocumentMouseDown, false);
            _domElement.addEventListener('mouseup', onDocumentMouseCancel, false);
            _domElement.addEventListener('mouseleave', onDocumentMouseCancel, false);
            _domElement.addEventListener('touchmove', onDocumentTouchMove, false);
            _domElement.addEventListener('touchstart', onDocumentTouchStart, false);
            _domElement.addEventListener('touchend', onDocumentTouchEnd, false);
        }
        function deactivate() {
            _domElement.removeEventListener('mousemove', onDocumentMouseMove, false);
            _domElement.removeEventListener('mousedown', onDocumentMouseDown, false);
            _domElement.removeEventListener('mouseup', onDocumentMouseCancel, false);
            _domElement.removeEventListener('mouseleave', onDocumentMouseCancel, false);
            _domElement.removeEventListener('touchmove', onDocumentTouchMove, false);
            _domElement.removeEventListener('touchstart', onDocumentTouchStart, false);
            _domElement.removeEventListener('touchend', onDocumentTouchEnd, false);
        }
        function dispose() {
            deactivate();
        }
        function getObjects() {
            return _objects;
        }
        function onDocumentMouseMove(event) {
            event.preventDefault();
            var rect = _domElement.getBoundingClientRect();
            _mouse.x = (event.clientX - rect.left) / rect.width * 2 - 1;
            _mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
            _raycaster.setFromCamera(_mouse, _camera);
            if (_selected && scope.enabled) {
                if (_raycaster.ray.intersectPlane(_plane, _intersection)) {
                    _selected.position.copy(_intersection.sub(_offset).applyMatrix4(_inverseMatrix));
                }
                scope.dispatchEvent({
                    type: 'drag',
                    object: _selected
                });
                return;
            }
            _intersections.length = 0;
            _raycaster.setFromCamera(_mouse, _camera);
            _raycaster.intersectObjects(_objects, true, _intersections);
            if (_intersections.length > 0) {
                var object = _intersections[0].object;
                _plane.setFromNormalAndCoplanarPoint(_camera.getWorldDirection(_plane.normal), _worldPosition.setFromMatrixPosition(object.matrixWorld));
                if (_hovered !== object) {
                    scope.dispatchEvent({
                        type: 'hoveron',
                        object: object
                    });
                    _domElement.style.cursor = 'pointer';
                    _hovered = object;
                }
            } else {
                if (_hovered !== null) {
                    scope.dispatchEvent({
                        type: 'hoveroff',
                        object: _hovered
                    });
                    _domElement.style.cursor = 'auto';
                    _hovered = null;
                }
            }
        }
        function onDocumentMouseDown(event) {
            event.preventDefault();
            _intersections.length = 0;
            _raycaster.setFromCamera(_mouse, _camera);
            _raycaster.intersectObjects(_objects, true, _intersections);
            if (_intersections.length > 0) {
                _selected = scope.transformGroup === true ? _objects[0] : _intersections[0].object;
                if (_raycaster.ray.intersectPlane(_plane, _intersection)) {
                    _inverseMatrix.getInverse(_selected.parent.matrixWorld);
                    _offset.copy(_intersection).sub(_worldPosition.setFromMatrixPosition(_selected.matrixWorld));
                }
                _domElement.style.cursor = 'move';
                scope.dispatchEvent({
                    type: 'dragstart',
                    object: _selected
                });
            }
        }
        function onDocumentMouseCancel(event) {
            event.preventDefault();
            if (_selected) {
                scope.dispatchEvent({
                    type: 'dragend',
                    object: _selected
                });
                _selected = null;
            }
            _domElement.style.cursor = _hovered ? 'pointer' : 'auto';
        }
        function onDocumentTouchMove(event) {
            event.preventDefault();
            event = event.changedTouches[0];
            var rect = _domElement.getBoundingClientRect();
            _mouse.x = (event.clientX - rect.left) / rect.width * 2 - 1;
            _mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
            _raycaster.setFromCamera(_mouse, _camera);
            if (_selected && scope.enabled) {
                if (_raycaster.ray.intersectPlane(_plane, _intersection)) {
                    _selected.position.copy(_intersection.sub(_offset).applyMatrix4(_inverseMatrix));
                }
                scope.dispatchEvent({
                    type: 'drag',
                    object: _selected
                });
                return;
            }
        }
        function onDocumentTouchStart(event) {
            event.preventDefault();
            event = event.changedTouches[0];
            var rect = _domElement.getBoundingClientRect();
            _mouse.x = (event.clientX - rect.left) / rect.width * 2 - 1;
            _mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
            _intersections.length = 0;
            _raycaster.setFromCamera(_mouse, _camera);
            _raycaster.intersectObjects(_objects, true, _intersections);
            if (_intersections.length > 0) {
                _selected = scope.transformGroup === true ? _objects[0] : _intersections[0].object;
                _plane.setFromNormalAndCoplanarPoint(_camera.getWorldDirection(_plane.normal), _worldPosition.setFromMatrixPosition(_selected.matrixWorld));
                if (_raycaster.ray.intersectPlane(_plane, _intersection)) {
                    _inverseMatrix.getInverse(_selected.parent.matrixWorld);
                    _offset.copy(_intersection).sub(_worldPosition.setFromMatrixPosition(_selected.matrixWorld));
                }
                _domElement.style.cursor = 'move';
                scope.dispatchEvent({
                    type: 'dragstart',
                    object: _selected
                });
            }
        }
        function onDocumentTouchEnd(event) {
            event.preventDefault();
            if (_selected) {
                scope.dispatchEvent({
                    type: 'dragend',
                    object: _selected
                });
                _selected = null;
            }
            _domElement.style.cursor = 'auto';
        }
        activate();
        this.enabled = true;
        this.transformGroup = false;
        this.activate = activate;
        this.deactivate = deactivate;
        this.dispose = dispose;
        this.getObjects = getObjects;
    };
    DragControls.prototype = Object.create(THREE.EventDispatcher.prototype);
    DragControls.prototype.constructor = DragControls;

    return threex.controls.DragControls = DragControls;
});
define('skylark-threejs-ex/controls/FirstPersonControls',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var FirstPersonControls = function (object, domElement) {
        if (domElement === undefined) {
            console.warn('THREE.FirstPersonControls: The second parameter "domElement" is now mandatory.');
            domElement = document;
        }
        this.object = object;
        this.domElement = domElement;
        this.enabled = true;
        this.movementSpeed = 1;
        this.lookSpeed = 0.005;
        this.lookVertical = true;
        this.autoForward = false;
        this.activeLook = true;
        this.heightSpeed = false;
        this.heightCoef = 1;
        this.heightMin = 0;
        this.heightMax = 1;
        this.constrainVertical = false;
        this.verticalMin = 0;
        this.verticalMax = Math.PI;
        this.mouseDragOn = false;
        this.autoSpeedFactor = 0;
        this.mouseX = 0;
        this.mouseY = 0;
        this.moveForward = false;
        this.moveBackward = false;
        this.moveLeft = false;
        this.moveRight = false;
        this.viewHalfX = 0;
        this.viewHalfY = 0;
        var lat = 0;
        var lon = 0;
        var lookDirection = new THREE.Vector3();
        var spherical = new THREE.Spherical();
        var target = new THREE.Vector3();
        if (this.domElement !== document) {
            this.domElement.setAttribute('tabindex', -1);
        }
        this.handleResize = function () {
            if (this.domElement === document) {
                this.viewHalfX = window.innerWidth / 2;
                this.viewHalfY = window.innerHeight / 2;
            } else {
                this.viewHalfX = this.domElement.offsetWidth / 2;
                this.viewHalfY = this.domElement.offsetHeight / 2;
            }
        };
        this.onMouseDown = function (event) {
            if (this.domElement !== document) {
                this.domElement.focus();
            }
            event.preventDefault();
            event.stopPropagation();
            if (this.activeLook) {
                switch (event.button) {
                case 0:
                    this.moveForward = true;
                    break;
                case 2:
                    this.moveBackward = true;
                    break;
                }
            }
            this.mouseDragOn = true;
        };
        this.onMouseUp = function (event) {
            event.preventDefault();
            event.stopPropagation();
            if (this.activeLook) {
                switch (event.button) {
                case 0:
                    this.moveForward = false;
                    break;
                case 2:
                    this.moveBackward = false;
                    break;
                }
            }
            this.mouseDragOn = false;
        };
        this.onMouseMove = function (event) {
            if (this.domElement === document) {
                this.mouseX = event.pageX - this.viewHalfX;
                this.mouseY = event.pageY - this.viewHalfY;
            } else {
                this.mouseX = event.pageX - this.domElement.offsetLeft - this.viewHalfX;
                this.mouseY = event.pageY - this.domElement.offsetTop - this.viewHalfY;
            }
        };
        this.onKeyDown = function (event) {
            switch (event.keyCode) {
            case 38:
            case 87:
                this.moveForward = true;
                break;
            case 37:
            case 65:
                this.moveLeft = true;
                break;
            case 40:
            case 83:
                this.moveBackward = true;
                break;
            case 39:
            case 68:
                this.moveRight = true;
                break;
            case 82:
                this.moveUp = true;
                break;
            case 70:
                this.moveDown = true;
                break;
            }
        };
        this.onKeyUp = function (event) {
            switch (event.keyCode) {
            case 38:
            case 87:
                this.moveForward = false;
                break;
            case 37:
            case 65:
                this.moveLeft = false;
                break;
            case 40:
            case 83:
                this.moveBackward = false;
                break;
            case 39:
            case 68:
                this.moveRight = false;
                break;
            case 82:
                this.moveUp = false;
                break;
            case 70:
                this.moveDown = false;
                break;
            }
        };
        this.lookAt = function (x, y, z) {
            if (x.isVector3) {
                target.copy(x);
            } else {
                target.set(x, y, z);
            }
            this.object.lookAt(target);
            setOrientation(this);
            return this;
        };
        this.update = function () {
            var targetPosition = new THREE.Vector3();
            return function update(delta) {
                if (this.enabled === false)
                    return;
                if (this.heightSpeed) {
                    var y = THREE.MathUtils.clamp(this.object.position.y, this.heightMin, this.heightMax);
                    var heightDelta = y - this.heightMin;
                    this.autoSpeedFactor = delta * (heightDelta * this.heightCoef);
                } else {
                    this.autoSpeedFactor = 0;
                }
                var actualMoveSpeed = delta * this.movementSpeed;
                if (this.moveForward || this.autoForward && !this.moveBackward)
                    this.object.translateZ(-(actualMoveSpeed + this.autoSpeedFactor));
                if (this.moveBackward)
                    this.object.translateZ(actualMoveSpeed);
                if (this.moveLeft)
                    this.object.translateX(-actualMoveSpeed);
                if (this.moveRight)
                    this.object.translateX(actualMoveSpeed);
                if (this.moveUp)
                    this.object.translateY(actualMoveSpeed);
                if (this.moveDown)
                    this.object.translateY(-actualMoveSpeed);
                var actualLookSpeed = delta * this.lookSpeed;
                if (!this.activeLook) {
                    actualLookSpeed = 0;
                }
                var verticalLookRatio = 1;
                if (this.constrainVertical) {
                    verticalLookRatio = Math.PI / (this.verticalMax - this.verticalMin);
                }
                lon -= this.mouseX * actualLookSpeed;
                if (this.lookVertical)
                    lat -= this.mouseY * actualLookSpeed * verticalLookRatio;
                lat = Math.max(-85, Math.min(85, lat));
                var phi = THREE.MathUtils.degToRad(90 - lat);
                var theta = THREE.MathUtils.degToRad(lon);
                if (this.constrainVertical) {
                    phi = THREE.MathUtils.mapLinear(phi, 0, Math.PI, this.verticalMin, this.verticalMax);
                }
                var position = this.object.position;
                targetPosition.setFromSphericalCoords(1, phi, theta).add(position);
                this.object.lookAt(targetPosition);
            };
        }();
        function contextmenu(event) {
            event.preventDefault();
        }
        this.dispose = function () {
            this.domElement.removeEventListener('contextmenu', contextmenu, false);
            this.domElement.removeEventListener('mousedown', _onMouseDown, false);
            this.domElement.removeEventListener('mousemove', _onMouseMove, false);
            this.domElement.removeEventListener('mouseup', _onMouseUp, false);
            window.removeEventListener('keydown', _onKeyDown, false);
            window.removeEventListener('keyup', _onKeyUp, false);
        };
        var _onMouseMove = bind(this, this.onMouseMove);
        var _onMouseDown = bind(this, this.onMouseDown);
        var _onMouseUp = bind(this, this.onMouseUp);
        var _onKeyDown = bind(this, this.onKeyDown);
        var _onKeyUp = bind(this, this.onKeyUp);
        this.domElement.addEventListener('contextmenu', contextmenu, false);
        this.domElement.addEventListener('mousemove', _onMouseMove, false);
        this.domElement.addEventListener('mousedown', _onMouseDown, false);
        this.domElement.addEventListener('mouseup', _onMouseUp, false);
        window.addEventListener('keydown', _onKeyDown, false);
        window.addEventListener('keyup', _onKeyUp, false);
        function bind(scope, fn) {
            return function () {
                fn.apply(scope, arguments);
            };
        }
        function setOrientation(controls) {
            var quaternion = controls.object.quaternion;
            lookDirection.set(0, 0, -1).applyQuaternion(quaternion);
            spherical.setFromVector3(lookDirection);
            lat = 90 - THREE.MathUtils.radToDeg(spherical.phi);
            lon = THREE.MathUtils.radToDeg(spherical.theta);
        }
        this.handleResize();
        setOrientation(this);
    };
    
    return threex.controls.FirstPersonControls = FirstPersonControls;
});
define('skylark-threejs-ex/controls/FlyControls',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var FlyControls = function (object, domElement) {
        if (domElement === undefined) {
            console.warn('THREE.FlyControls: The second parameter "domElement" is now mandatory.');
            domElement = document;
        }
        this.object = object;
        this.domElement = domElement;
        if (domElement)
            this.domElement.setAttribute('tabindex', -1);
        this.movementSpeed = 1;
        this.rollSpeed = 0.005;
        this.dragToLook = false;
        this.autoForward = false;
        this.tmpQuaternion = new THREE.Quaternion();
        this.mouseStatus = 0;
        this.moveState = {
            up: 0,
            down: 0,
            left: 0,
            right: 0,
            forward: 0,
            back: 0,
            pitchUp: 0,
            pitchDown: 0,
            yawLeft: 0,
            yawRight: 0,
            rollLeft: 0,
            rollRight: 0
        };
        this.moveVector = new THREE.Vector3(0, 0, 0);
        this.rotationVector = new THREE.Vector3(0, 0, 0);
        this.keydown = function (event) {
            if (event.altKey) {
                return;
            }
            switch (event.keyCode) {
            case 16:
                this.movementSpeedMultiplier = 0.1;
                break;
            case 87:
                this.moveState.forward = 1;
                break;
            case 83:
                this.moveState.back = 1;
                break;
            case 65:
                this.moveState.left = 1;
                break;
            case 68:
                this.moveState.right = 1;
                break;
            case 82:
                this.moveState.up = 1;
                break;
            case 70:
                this.moveState.down = 1;
                break;
            case 38:
                this.moveState.pitchUp = 1;
                break;
            case 40:
                this.moveState.pitchDown = 1;
                break;
            case 37:
                this.moveState.yawLeft = 1;
                break;
            case 39:
                this.moveState.yawRight = 1;
                break;
            case 81:
                this.moveState.rollLeft = 1;
                break;
            case 69:
                this.moveState.rollRight = 1;
                break;
            }
            this.updateMovementVector();
            this.updateRotationVector();
        };
        this.keyup = function (event) {
            switch (event.keyCode) {
            case 16:
                this.movementSpeedMultiplier = 1;
                break;
            case 87:
                this.moveState.forward = 0;
                break;
            case 83:
                this.moveState.back = 0;
                break;
            case 65:
                this.moveState.left = 0;
                break;
            case 68:
                this.moveState.right = 0;
                break;
            case 82:
                this.moveState.up = 0;
                break;
            case 70:
                this.moveState.down = 0;
                break;
            case 38:
                this.moveState.pitchUp = 0;
                break;
            case 40:
                this.moveState.pitchDown = 0;
                break;
            case 37:
                this.moveState.yawLeft = 0;
                break;
            case 39:
                this.moveState.yawRight = 0;
                break;
            case 81:
                this.moveState.rollLeft = 0;
                break;
            case 69:
                this.moveState.rollRight = 0;
                break;
            }
            this.updateMovementVector();
            this.updateRotationVector();
        };
        this.mousedown = function (event) {
            if (this.domElement !== document) {
                this.domElement.focus();
            }
            event.preventDefault();
            event.stopPropagation();
            if (this.dragToLook) {
                this.mouseStatus++;
            } else {
                switch (event.button) {
                case 0:
                    this.moveState.forward = 1;
                    break;
                case 2:
                    this.moveState.back = 1;
                    break;
                }
                this.updateMovementVector();
            }
        };
        this.mousemove = function (event) {
            if (!this.dragToLook || this.mouseStatus > 0) {
                var container = this.getContainerDimensions();
                var halfWidth = container.size[0] / 2;
                var halfHeight = container.size[1] / 2;
                this.moveState.yawLeft = -(event.pageX - container.offset[0] - halfWidth) / halfWidth;
                this.moveState.pitchDown = (event.pageY - container.offset[1] - halfHeight) / halfHeight;
                this.updateRotationVector();
            }
        };
        this.mouseup = function (event) {
            event.preventDefault();
            event.stopPropagation();
            if (this.dragToLook) {
                this.mouseStatus--;
                this.moveState.yawLeft = this.moveState.pitchDown = 0;
            } else {
                switch (event.button) {
                case 0:
                    this.moveState.forward = 0;
                    break;
                case 2:
                    this.moveState.back = 0;
                    break;
                }
                this.updateMovementVector();
            }
            this.updateRotationVector();
        };
        this.update = function (delta) {
            var moveMult = delta * this.movementSpeed;
            var rotMult = delta * this.rollSpeed;
            this.object.translateX(this.moveVector.x * moveMult);
            this.object.translateY(this.moveVector.y * moveMult);
            this.object.translateZ(this.moveVector.z * moveMult);
            this.tmpQuaternion.set(this.rotationVector.x * rotMult, this.rotationVector.y * rotMult, this.rotationVector.z * rotMult, 1).normalize();
            this.object.quaternion.multiply(this.tmpQuaternion);
            this.object.rotation.setFromQuaternion(this.object.quaternion, this.object.rotation.order);
        };
        this.updateMovementVector = function () {
            var forward = this.moveState.forward || this.autoForward && !this.moveState.back ? 1 : 0;
            this.moveVector.x = -this.moveState.left + this.moveState.right;
            this.moveVector.y = -this.moveState.down + this.moveState.up;
            this.moveVector.z = -forward + this.moveState.back;
        };
        this.updateRotationVector = function () {
            this.rotationVector.x = -this.moveState.pitchDown + this.moveState.pitchUp;
            this.rotationVector.y = -this.moveState.yawRight + this.moveState.yawLeft;
            this.rotationVector.z = -this.moveState.rollRight + this.moveState.rollLeft;
        };
        this.getContainerDimensions = function () {
            if (this.domElement != document) {
                return {
                    size: [
                        this.domElement.offsetWidth,
                        this.domElement.offsetHeight
                    ],
                    offset: [
                        this.domElement.offsetLeft,
                        this.domElement.offsetTop
                    ]
                };
            } else {
                return {
                    size: [
                        window.innerWidth,
                        window.innerHeight
                    ],
                    offset: [
                        0,
                        0
                    ]
                };
            }
        };
        function bind(scope, fn) {
            return function () {
                fn.apply(scope, arguments);
            };
        }
        function contextmenu(event) {
            event.preventDefault();
        }
        this.dispose = function () {
            this.domElement.removeEventListener('contextmenu', contextmenu, false);
            this.domElement.removeEventListener('mousedown', _mousedown, false);
            this.domElement.removeEventListener('mousemove', _mousemove, false);
            this.domElement.removeEventListener('mouseup', _mouseup, false);
            window.removeEventListener('keydown', _keydown, false);
            window.removeEventListener('keyup', _keyup, false);
        };
        var _mousemove = bind(this, this.mousemove);
        var _mousedown = bind(this, this.mousedown);
        var _mouseup = bind(this, this.mouseup);
        var _keydown = bind(this, this.keydown);
        var _keyup = bind(this, this.keyup);
        this.domElement.addEventListener('contextmenu', contextmenu, false);
        this.domElement.addEventListener('mousemove', _mousemove, false);
        this.domElement.addEventListener('mousedown', _mousedown, false);
        this.domElement.addEventListener('mouseup', _mouseup, false);
        window.addEventListener('keydown', _keydown, false);
        window.addEventListener('keyup', _keyup, false);
        this.updateMovementVector();
        this.updateRotationVector();
    };
    return threex.controls.FlyControls = FlyControls;
});
define('skylark-threejs-ex/controls/MapControls',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var MapControls = function (object, domElement) {
        OrbitControls.call(this, object, domElement);
        this.mouseButtons.LEFT = THREE.MOUSE.PAN;
        this.mouseButtons.RIGHT = THREE.MOUSE.ROTATE;
        this.touches.ONE = THREE.TOUCH.PAN;
        this.touches.TWO = THREE.TOUCH.DOLLY_ROTATE;
    };
    MapControls.prototype = Object.create(THREE.EventDispatcher.prototype);
    MapControls.prototype.constructor = MapControls;

	return threex.controls.MapControls = MapControls;
});    
define('skylark-threejs-ex/controls/OrbitControls',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var OrbitControls = function (object, domElement) {
        if (domElement === undefined)
            console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.');
        if (domElement === document)
            console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');
        this.object = object;
        this.domElement = domElement;
        this.enabled = true;
        this.target = new THREE.Vector3();
        this.minDistance = 0;
        this.maxDistance = Infinity;
        this.minZoom = 0;
        this.maxZoom = Infinity;
        this.minPolarAngle = 0;
        this.maxPolarAngle = Math.PI;
        this.minAzimuthAngle = -Infinity;
        this.maxAzimuthAngle = Infinity;
        this.enableDamping = false;
        this.dampingFactor = 0.05;
        this.enableZoom = true;
        this.zoomSpeed = 1;
        this.enableRotate = true;
        this.rotateSpeed = 1;
        this.enablePan = true;
        this.panSpeed = 1;
        this.screenSpacePanning = false;
        this.keyPanSpeed = 7;
        this.autoRotate = false;
        this.autoRotateSpeed = 2;
        this.enableKeys = true;
        this.keys = {
            LEFT: 37,
            UP: 38,
            RIGHT: 39,
            BOTTOM: 40
        };
        this.mouseButtons = {
            LEFT: THREE.MOUSE.ROTATE,
            MIDDLE: THREE.MOUSE.DOLLY,
            RIGHT: THREE.MOUSE.PAN
        };
        this.touches = {
            ONE: THREE.TOUCH.ROTATE,
            TWO: THREE.TOUCH.DOLLY_PAN
        };
        this.target0 = this.target.clone();
        this.position0 = this.object.position.clone();
        this.zoom0 = this.object.zoom;
        this.getPolarAngle = function () {
            return spherical.phi;
        };
        this.getAzimuthalAngle = function () {
            return spherical.theta;
        };
        this.saveState = function () {
            scope.target0.copy(scope.target);
            scope.position0.copy(scope.object.position);
            scope.zoom0 = scope.object.zoom;
        };
        this.reset = function () {
            scope.target.copy(scope.target0);
            scope.object.position.copy(scope.position0);
            scope.object.zoom = scope.zoom0;
            scope.object.updateProjectionMatrix();
            scope.dispatchEvent(changeEvent);
            scope.update();
            state = STATE.NONE;
        };
        this.update = function () {
            var offset = new THREE.Vector3();
            var quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));
            var quatInverse = quat.clone().inverse();
            var lastPosition = new THREE.Vector3();
            var lastQuaternion = new THREE.Quaternion();
            return function update() {
                var position = scope.object.position;
                offset.copy(position).sub(scope.target);
                offset.applyQuaternion(quat);
                spherical.setFromVector3(offset);
                if (scope.autoRotate && state === STATE.NONE) {
                    rotateLeft(getAutoRotationAngle());
                }
                if (scope.enableDamping) {
                    spherical.theta += sphericalDelta.theta * scope.dampingFactor;
                    spherical.phi += sphericalDelta.phi * scope.dampingFactor;
                } else {
                    spherical.theta += sphericalDelta.theta;
                    spherical.phi += sphericalDelta.phi;
                }
                spherical.theta = Math.max(scope.minAzimuthAngle, Math.min(scope.maxAzimuthAngle, spherical.theta));
                spherical.phi = Math.max(scope.minPolarAngle, Math.min(scope.maxPolarAngle, spherical.phi));
                spherical.makeSafe();
                spherical.radius *= scale;
                spherical.radius = Math.max(scope.minDistance, Math.min(scope.maxDistance, spherical.radius));
                if (scope.enableDamping === true) {
                    scope.target.addScaledVector(panOffset, scope.dampingFactor);
                } else {
                    scope.target.add(panOffset);
                }
                offset.setFromSpherical(spherical);
                offset.applyQuaternion(quatInverse);
                position.copy(scope.target).add(offset);
                scope.object.lookAt(scope.target);
                if (scope.enableDamping === true) {
                    sphericalDelta.theta *= 1 - scope.dampingFactor;
                    sphericalDelta.phi *= 1 - scope.dampingFactor;
                    panOffset.multiplyScalar(1 - scope.dampingFactor);
                } else {
                    sphericalDelta.set(0, 0, 0);
                    panOffset.set(0, 0, 0);
                }
                scale = 1;
                if (zoomChanged || lastPosition.distanceToSquared(scope.object.position) > EPS || 8 * (1 - lastQuaternion.dot(scope.object.quaternion)) > EPS) {
                    scope.dispatchEvent(changeEvent);
                    lastPosition.copy(scope.object.position);
                    lastQuaternion.copy(scope.object.quaternion);
                    zoomChanged = false;
                    return true;
                }
                return false;
            };
        }();
        this.dispose = function () {
            scope.domElement.removeEventListener('contextmenu', onContextMenu, false);
            scope.domElement.removeEventListener('mousedown', onMouseDown, false);
            scope.domElement.removeEventListener('wheel', onMouseWheel, false);
            scope.domElement.removeEventListener('touchstart', onTouchStart, false);
            scope.domElement.removeEventListener('touchend', onTouchEnd, false);
            scope.domElement.removeEventListener('touchmove', onTouchMove, false);
            document.removeEventListener('mousemove', onMouseMove, false);
            document.removeEventListener('mouseup', onMouseUp, false);
            scope.domElement.removeEventListener('keydown', onKeyDown, false);
        };
        var scope = this;
        var changeEvent = { type: 'change' };
        var startEvent = { type: 'start' };
        var endEvent = { type: 'end' };
        var STATE = {
            NONE: -1,
            ROTATE: 0,
            DOLLY: 1,
            PAN: 2,
            TOUCH_ROTATE: 3,
            TOUCH_PAN: 4,
            TOUCH_DOLLY_PAN: 5,
            TOUCH_DOLLY_ROTATE: 6
        };
        var state = STATE.NONE;
        var EPS = 0.000001;
        var spherical = new THREE.Spherical();
        var sphericalDelta = new THREE.Spherical();
        var scale = 1;
        var panOffset = new THREE.Vector3();
        var zoomChanged = false;
        var rotateStart = new THREE.Vector2();
        var rotateEnd = new THREE.Vector2();
        var rotateDelta = new THREE.Vector2();
        var panStart = new THREE.Vector2();
        var panEnd = new THREE.Vector2();
        var panDelta = new THREE.Vector2();
        var dollyStart = new THREE.Vector2();
        var dollyEnd = new THREE.Vector2();
        var dollyDelta = new THREE.Vector2();
        function getAutoRotationAngle() {
            return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;
        }
        function getZoomScale() {
            return Math.pow(0.95, scope.zoomSpeed);
        }
        function rotateLeft(angle) {
            sphericalDelta.theta -= angle;
        }
        function rotateUp(angle) {
            sphericalDelta.phi -= angle;
        }
        var panLeft = function () {
            var v = new THREE.Vector3();
            return function panLeft(distance, objectMatrix) {
                v.setFromMatrixColumn(objectMatrix, 0);
                v.multiplyScalar(-distance);
                panOffset.add(v);
            };
        }();
        var panUp = function () {
            var v = new THREE.Vector3();
            return function panUp(distance, objectMatrix) {
                if (scope.screenSpacePanning === true) {
                    v.setFromMatrixColumn(objectMatrix, 1);
                } else {
                    v.setFromMatrixColumn(objectMatrix, 0);
                    v.crossVectors(scope.object.up, v);
                }
                v.multiplyScalar(distance);
                panOffset.add(v);
            };
        }();
        var pan = function () {
            var offset = new THREE.Vector3();
            return function pan(deltaX, deltaY) {
                var element = scope.domElement;
                if (scope.object.isPerspectiveCamera) {
                    var position = scope.object.position;
                    offset.copy(position).sub(scope.target);
                    var targetDistance = offset.length();
                    targetDistance *= Math.tan(scope.object.fov / 2 * Math.PI / 180);
                    panLeft(2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix);
                    panUp(2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix);
                } else if (scope.object.isOrthographicCamera) {
                    panLeft(deltaX * (scope.object.right - scope.object.left) / scope.object.zoom / element.clientWidth, scope.object.matrix);
                    panUp(deltaY * (scope.object.top - scope.object.bottom) / scope.object.zoom / element.clientHeight, scope.object.matrix);
                } else {
                    console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.');
                    scope.enablePan = false;
                }
            };
        }();
        function dollyOut(dollyScale) {
            if (scope.object.isPerspectiveCamera) {
                scale /= dollyScale;
            } else if (scope.object.isOrthographicCamera) {
                scope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom * dollyScale));
                scope.object.updateProjectionMatrix();
                zoomChanged = true;
            } else {
                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');
                scope.enableZoom = false;
            }
        }
        function dollyIn(dollyScale) {
            if (scope.object.isPerspectiveCamera) {
                scale *= dollyScale;
            } else if (scope.object.isOrthographicCamera) {
                scope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom / dollyScale));
                scope.object.updateProjectionMatrix();
                zoomChanged = true;
            } else {
                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');
                scope.enableZoom = false;
            }
        }
        function handleMouseDownRotate(event) {
            rotateStart.set(event.clientX, event.clientY);
        }
        function handleMouseDownDolly(event) {
            dollyStart.set(event.clientX, event.clientY);
        }
        function handleMouseDownPan(event) {
            panStart.set(event.clientX, event.clientY);
        }
        function handleMouseMoveRotate(event) {
            rotateEnd.set(event.clientX, event.clientY);
            rotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed);
            var element = scope.domElement;
            rotateLeft(2 * Math.PI * rotateDelta.x / element.clientHeight);
            rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight);
            rotateStart.copy(rotateEnd);
            scope.update();
        }
        function handleMouseMoveDolly(event) {
            dollyEnd.set(event.clientX, event.clientY);
            dollyDelta.subVectors(dollyEnd, dollyStart);
            if (dollyDelta.y > 0) {
                dollyOut(getZoomScale());
            } else if (dollyDelta.y < 0) {
                dollyIn(getZoomScale());
            }
            dollyStart.copy(dollyEnd);
            scope.update();
        }
        function handleMouseMovePan(event) {
            panEnd.set(event.clientX, event.clientY);
            panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);
            pan(panDelta.x, panDelta.y);
            panStart.copy(panEnd);
            scope.update();
        }
        function handleMouseUp() {
        }
        function handleMouseWheel(event) {
            if (event.deltaY < 0) {
                dollyIn(getZoomScale());
            } else if (event.deltaY > 0) {
                dollyOut(getZoomScale());
            }
            scope.update();
        }
        function handleKeyDown(event) {
            var needsUpdate = false;
            switch (event.keyCode) {
            case scope.keys.UP:
                pan(0, scope.keyPanSpeed);
                needsUpdate = true;
                break;
            case scope.keys.BOTTOM:
                pan(0, -scope.keyPanSpeed);
                needsUpdate = true;
                break;
            case scope.keys.LEFT:
                pan(scope.keyPanSpeed, 0);
                needsUpdate = true;
                break;
            case scope.keys.RIGHT:
                pan(-scope.keyPanSpeed, 0);
                needsUpdate = true;
                break;
            }
            if (needsUpdate) {
                event.preventDefault();
                scope.update();
            }
        }
        function handleTouchStartRotate(event) {
            if (event.touches.length == 1) {
                rotateStart.set(event.touches[0].pageX, event.touches[0].pageY);
            } else {
                var x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);
                var y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);
                rotateStart.set(x, y);
            }
        }
        function handleTouchStartPan(event) {
            if (event.touches.length == 1) {
                panStart.set(event.touches[0].pageX, event.touches[0].pageY);
            } else {
                var x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);
                var y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);
                panStart.set(x, y);
            }
        }
        function handleTouchStartDolly(event) {
            var dx = event.touches[0].pageX - event.touches[1].pageX;
            var dy = event.touches[0].pageY - event.touches[1].pageY;
            var distance = Math.sqrt(dx * dx + dy * dy);
            dollyStart.set(0, distance);
        }
        function handleTouchStartDollyPan(event) {
            if (scope.enableZoom)
                handleTouchStartDolly(event);
            if (scope.enablePan)
                handleTouchStartPan(event);
        }
        function handleTouchStartDollyRotate(event) {
            if (scope.enableZoom)
                handleTouchStartDolly(event);
            if (scope.enableRotate)
                handleTouchStartRotate(event);
        }
        function handleTouchMoveRotate(event) {
            if (event.touches.length == 1) {
                rotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);
            } else {
                var x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);
                var y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);
                rotateEnd.set(x, y);
            }
            rotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed);
            var element = scope.domElement;
            rotateLeft(2 * Math.PI * rotateDelta.x / element.clientHeight);
            rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight);
            rotateStart.copy(rotateEnd);
        }
        function handleTouchMovePan(event) {
            if (event.touches.length == 1) {
                panEnd.set(event.touches[0].pageX, event.touches[0].pageY);
            } else {
                var x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);
                var y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);
                panEnd.set(x, y);
            }
            panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);
            pan(panDelta.x, panDelta.y);
            panStart.copy(panEnd);
        }
        function handleTouchMoveDolly(event) {
            var dx = event.touches[0].pageX - event.touches[1].pageX;
            var dy = event.touches[0].pageY - event.touches[1].pageY;
            var distance = Math.sqrt(dx * dx + dy * dy);
            dollyEnd.set(0, distance);
            dollyDelta.set(0, Math.pow(dollyEnd.y / dollyStart.y, scope.zoomSpeed));
            dollyOut(dollyDelta.y);
            dollyStart.copy(dollyEnd);
        }
        function handleTouchMoveDollyPan(event) {
            if (scope.enableZoom)
                handleTouchMoveDolly(event);
            if (scope.enablePan)
                handleTouchMovePan(event);
        }
        function handleTouchMoveDollyRotate(event) {
            if (scope.enableZoom)
                handleTouchMoveDolly(event);
            if (scope.enableRotate)
                handleTouchMoveRotate(event);
        }
        function handleTouchEnd() {
        }
        function onMouseDown(event) {
            if (scope.enabled === false)
                return;
            event.preventDefault();
            scope.domElement.focus ? scope.domElement.focus() : window.focus();
            var mouseAction;
            switch (event.button) {
            case 0:
                mouseAction = scope.mouseButtons.LEFT;
                break;
            case 1:
                mouseAction = scope.mouseButtons.MIDDLE;
                break;
            case 2:
                mouseAction = scope.mouseButtons.RIGHT;
                break;
            default:
                mouseAction = -1;
            }
            switch (mouseAction) {
            case THREE.MOUSE.DOLLY:
                if (scope.enableZoom === false)
                    return;
                handleMouseDownDolly(event);
                state = STATE.DOLLY;
                break;
            case THREE.MOUSE.ROTATE:
                if (event.ctrlKey || event.metaKey || event.shiftKey) {
                    if (scope.enablePan === false)
                        return;
                    handleMouseDownPan(event);
                    state = STATE.PAN;
                } else {
                    if (scope.enableRotate === false)
                        return;
                    handleMouseDownRotate(event);
                    state = STATE.ROTATE;
                }
                break;
            case THREE.MOUSE.PAN:
                if (event.ctrlKey || event.metaKey || event.shiftKey) {
                    if (scope.enableRotate === false)
                        return;
                    handleMouseDownRotate(event);
                    state = STATE.ROTATE;
                } else {
                    if (scope.enablePan === false)
                        return;
                    handleMouseDownPan(event);
                    state = STATE.PAN;
                }
                break;
            default:
                state = STATE.NONE;
            }
            if (state !== STATE.NONE) {
                document.addEventListener('mousemove', onMouseMove, false);
                document.addEventListener('mouseup', onMouseUp, false);
                scope.dispatchEvent(startEvent);
            }
        }
        function onMouseMove(event) {
            if (scope.enabled === false)
                return;
            event.preventDefault();
            switch (state) {
            case STATE.ROTATE:
                if (scope.enableRotate === false)
                    return;
                handleMouseMoveRotate(event);
                break;
            case STATE.DOLLY:
                if (scope.enableZoom === false)
                    return;
                handleMouseMoveDolly(event);
                break;
            case STATE.PAN:
                if (scope.enablePan === false)
                    return;
                handleMouseMovePan(event);
                break;
            }
        }
        function onMouseUp(event) {
            if (scope.enabled === false)
                return;
            handleMouseUp(event);
            document.removeEventListener('mousemove', onMouseMove, false);
            document.removeEventListener('mouseup', onMouseUp, false);
            scope.dispatchEvent(endEvent);
            state = STATE.NONE;
        }
        function onMouseWheel(event) {
            if (scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE && state !== STATE.ROTATE)
                return;
            event.preventDefault();
            event.stopPropagation();
            scope.dispatchEvent(startEvent);
            handleMouseWheel(event);
            scope.dispatchEvent(endEvent);
        }
        function onKeyDown(event) {
            if (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false)
                return;
            handleKeyDown(event);
        }
        function onTouchStart(event) {
            if (scope.enabled === false)
                return;
            event.preventDefault();
            switch (event.touches.length) {
            case 1:
                switch (scope.touches.ONE) {
                case THREE.TOUCH.ROTATE:
                    if (scope.enableRotate === false)
                        return;
                    handleTouchStartRotate(event);
                    state = STATE.TOUCH_ROTATE;
                    break;
                case THREE.TOUCH.PAN:
                    if (scope.enablePan === false)
                        return;
                    handleTouchStartPan(event);
                    state = STATE.TOUCH_PAN;
                    break;
                default:
                    state = STATE.NONE;
                }
                break;
            case 2:
                switch (scope.touches.TWO) {
                case THREE.TOUCH.DOLLY_PAN:
                    if (scope.enableZoom === false && scope.enablePan === false)
                        return;
                    handleTouchStartDollyPan(event);
                    state = STATE.TOUCH_DOLLY_PAN;
                    break;
                case THREE.TOUCH.DOLLY_ROTATE:
                    if (scope.enableZoom === false && scope.enableRotate === false)
                        return;
                    handleTouchStartDollyRotate(event);
                    state = STATE.TOUCH_DOLLY_ROTATE;
                    break;
                default:
                    state = STATE.NONE;
                }
                break;
            default:
                state = STATE.NONE;
            }
            if (state !== STATE.NONE) {
                scope.dispatchEvent(startEvent);
            }
        }
        function onTouchMove(event) {
            if (scope.enabled === false)
                return;
            event.preventDefault();
            event.stopPropagation();
            switch (state) {
            case STATE.TOUCH_ROTATE:
                if (scope.enableRotate === false)
                    return;
                handleTouchMoveRotate(event);
                scope.update();
                break;
            case STATE.TOUCH_PAN:
                if (scope.enablePan === false)
                    return;
                handleTouchMovePan(event);
                scope.update();
                break;
            case STATE.TOUCH_DOLLY_PAN:
                if (scope.enableZoom === false && scope.enablePan === false)
                    return;
                handleTouchMoveDollyPan(event);
                scope.update();
                break;
            case STATE.TOUCH_DOLLY_ROTATE:
                if (scope.enableZoom === false && scope.enableRotate === false)
                    return;
                handleTouchMoveDollyRotate(event);
                scope.update();
                break;
            default:
                state = STATE.NONE;
            }
        }
        function onTouchEnd(event) {
            if (scope.enabled === false)
                return;
            handleTouchEnd(event);
            scope.dispatchEvent(endEvent);
            state = STATE.NONE;
        }
        function onContextMenu(event) {
            if (scope.enabled === false)
                return;
            event.preventDefault();
        }
        scope.domElement.addEventListener('contextmenu', onContextMenu, false);
        scope.domElement.addEventListener('mousedown', onMouseDown, false);
        scope.domElement.addEventListener('wheel', onMouseWheel, false);
        scope.domElement.addEventListener('touchstart', onTouchStart, false);
        scope.domElement.addEventListener('touchend', onTouchEnd, false);
        scope.domElement.addEventListener('touchmove', onTouchMove, false);
        scope.domElement.addEventListener('keydown', onKeyDown, false);
        if (scope.domElement.tabIndex === -1) {
            scope.domElement.tabIndex = 0;
        }
        this.update();
    };
    OrbitControls.prototype = Object.create(THREE.EventDispatcher.prototype);
    OrbitControls.prototype.constructor = OrbitControls;

    
    return   threex.controls.OrbitControls = OrbitControls;
});
define('skylark-threejs-ex/controls/PointerLockControls',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var PointerLockControls = function (camera, domElement) {
        if (domElement === undefined) {
            console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.');
            domElement = document.body;
        }
        this.domElement = domElement;
        this.isLocked = false;
        var scope = this;
        var changeEvent = { type: 'change' };
        var lockEvent = { type: 'lock' };
        var unlockEvent = { type: 'unlock' };
        var euler = new THREE.Euler(0, 0, 0, 'YXZ');
        var PI_2 = Math.PI / 2;
        var vec = new THREE.Vector3();
        function onMouseMove(event) {
            if (scope.isLocked === false)
                return;
            var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;
            var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;
            euler.setFromQuaternion(camera.quaternion);
            euler.y -= movementX * 0.002;
            euler.x -= movementY * 0.002;
            euler.x = Math.max(-PI_2, Math.min(PI_2, euler.x));
            camera.quaternion.setFromEuler(euler);
            scope.dispatchEvent(changeEvent);
        }
        function onPointerlockChange() {
            if (document.pointerLockElement === scope.domElement) {
                scope.dispatchEvent(lockEvent);
                scope.isLocked = true;
            } else {
                scope.dispatchEvent(unlockEvent);
                scope.isLocked = false;
            }
        }
        function onPointerlockError() {
            console.error('THREE.PointerLockControls: Unable to use Pointer Lock API');
        }
        this.connect = function () {
            document.addEventListener('mousemove', onMouseMove, false);
            document.addEventListener('pointerlockchange', onPointerlockChange, false);
            document.addEventListener('pointerlockerror', onPointerlockError, false);
        };
        this.disconnect = function () {
            document.removeEventListener('mousemove', onMouseMove, false);
            document.removeEventListener('pointerlockchange', onPointerlockChange, false);
            document.removeEventListener('pointerlockerror', onPointerlockError, false);
        };
        this.dispose = function () {
            this.disconnect();
        };
        this.getObject = function () {
            return camera;
        };
        this.getDirection = function () {
            var direction = new THREE.Vector3(0, 0, -1);
            return function (v) {
                return v.copy(direction).applyQuaternion(camera.quaternion);
            };
        }();
        this.moveForward = function (distance) {
            vec.setFromMatrixColumn(camera.matrix, 0);
            vec.crossVectors(camera.up, vec);
            camera.position.addScaledVector(vec, distance);
        };
        this.moveRight = function (distance) {
            vec.setFromMatrixColumn(camera.matrix, 0);
            camera.position.addScaledVector(vec, distance);
        };
        this.lock = function () {
            this.domElement.requestPointerLock();
        };
        this.unlock = function () {
            document.exitPointerLock();
        };
        this.connect();
    };
    
    PointerLockControls.prototype = Object.create(THREE.EventDispatcher.prototype);
    PointerLockControls.prototype.constructor = PointerLockControls;

    return threex.controls.PointerLockControls = PointerLockControls;
});
define('skylark-threejs-ex/controls/TrackballControls',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var TrackballControls = function (object, domElement) {
        if (domElement === undefined)
            console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.');
        if (domElement === document)
            console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');
        var _this = this;
        var STATE = {
            NONE: -1,
            ROTATE: 0,
            ZOOM: 1,
            PAN: 2,
            TOUCH_ROTATE: 3,
            TOUCH_ZOOM_PAN: 4
        };
        this.object = object;
        this.domElement = domElement;
        this.enabled = true;
        this.screen = {
            left: 0,
            top: 0,
            width: 0,
            height: 0
        };
        this.rotateSpeed = 1;
        this.zoomSpeed = 1.2;
        this.panSpeed = 0.3;
        this.noRotate = false;
        this.noZoom = false;
        this.noPan = false;
        this.staticMoving = false;
        this.dynamicDampingFactor = 0.2;
        this.minDistance = 0;
        this.maxDistance = Infinity;
        this.keys = [
            65,
            83,
            68
        ];
        this.mouseButtons = {
            LEFT: THREE.MOUSE.ROTATE,
            MIDDLE: THREE.MOUSE.ZOOM,
            RIGHT: THREE.MOUSE.PAN
        };
        this.target = new THREE.Vector3();
        var EPS = 0.000001;
        var lastPosition = new THREE.Vector3();
        var lastZoom = 1;
        var _state = STATE.NONE, _keyState = STATE.NONE, _eye = new THREE.Vector3(), _movePrev = new THREE.Vector2(), _moveCurr = new THREE.Vector2(), _lastAxis = new THREE.Vector3(), _lastAngle = 0, _zoomStart = new THREE.Vector2(), _zoomEnd = new THREE.Vector2(), _touchZoomDistanceStart = 0, _touchZoomDistanceEnd = 0, _panStart = new THREE.Vector2(), _panEnd = new THREE.Vector2();
        this.target0 = this.target.clone();
        this.position0 = this.object.position.clone();
        this.up0 = this.object.up.clone();
        this.zoom0 = this.object.zoom;
        var changeEvent = { type: 'change' };
        var startEvent = { type: 'start' };
        var endEvent = { type: 'end' };
        this.handleResize = function () {
            var box = this.domElement.getBoundingClientRect();
            var d = this.domElement.ownerDocument.documentElement;
            this.screen.left = box.left + window.pageXOffset - d.clientLeft;
            this.screen.top = box.top + window.pageYOffset - d.clientTop;
            this.screen.width = box.width;
            this.screen.height = box.height;
        };
        var getMouseOnScreen = function () {
            var vector = new THREE.Vector2();
            return function getMouseOnScreen(pageX, pageY) {
                vector.set((pageX - _this.screen.left) / _this.screen.width, (pageY - _this.screen.top) / _this.screen.height);
                return vector;
            };
        }();
        var getMouseOnCircle = function () {
            var vector = new THREE.Vector2();
            return function getMouseOnCircle(pageX, pageY) {
                vector.set((pageX - _this.screen.width * 0.5 - _this.screen.left) / (_this.screen.width * 0.5), (_this.screen.height + 2 * (_this.screen.top - pageY)) / _this.screen.width);
                return vector;
            };
        }();
        this.rotateCamera = function () {
            var axis = new THREE.Vector3(), quaternion = new THREE.Quaternion(), eyeDirection = new THREE.Vector3(), objectUpDirection = new THREE.Vector3(), objectSidewaysDirection = new THREE.Vector3(), moveDirection = new THREE.Vector3(), angle;
            return function rotateCamera() {
                moveDirection.set(_moveCurr.x - _movePrev.x, _moveCurr.y - _movePrev.y, 0);
                angle = moveDirection.length();
                if (angle) {
                    _eye.copy(_this.object.position).sub(_this.target);
                    eyeDirection.copy(_eye).normalize();
                    objectUpDirection.copy(_this.object.up).normalize();
                    objectSidewaysDirection.crossVectors(objectUpDirection, eyeDirection).normalize();
                    objectUpDirection.setLength(_moveCurr.y - _movePrev.y);
                    objectSidewaysDirection.setLength(_moveCurr.x - _movePrev.x);
                    moveDirection.copy(objectUpDirection.add(objectSidewaysDirection));
                    axis.crossVectors(moveDirection, _eye).normalize();
                    angle *= _this.rotateSpeed;
                    quaternion.setFromAxisAngle(axis, angle);
                    _eye.applyQuaternion(quaternion);
                    _this.object.up.applyQuaternion(quaternion);
                    _lastAxis.copy(axis);
                    _lastAngle = angle;
                } else if (!_this.staticMoving && _lastAngle) {
                    _lastAngle *= Math.sqrt(1 - _this.dynamicDampingFactor);
                    _eye.copy(_this.object.position).sub(_this.target);
                    quaternion.setFromAxisAngle(_lastAxis, _lastAngle);
                    _eye.applyQuaternion(quaternion);
                    _this.object.up.applyQuaternion(quaternion);
                }
                _movePrev.copy(_moveCurr);
            };
        }();
        this.zoomCamera = function () {
            var factor;
            if (_state === STATE.TOUCH_ZOOM_PAN) {
                factor = _touchZoomDistanceStart / _touchZoomDistanceEnd;
                _touchZoomDistanceStart = _touchZoomDistanceEnd;
                if (_this.object.isPerspectiveCamera) {
                    _eye.multiplyScalar(factor);
                } else if (_this.object.isOrthographicCamera) {
                    _this.object.zoom *= factor;
                    _this.object.updateProjectionMatrix();
                } else {
                    console.warn('THREE.TrackballControls: Unsupported camera type');
                }
            } else {
                factor = 1 + (_zoomEnd.y - _zoomStart.y) * _this.zoomSpeed;
                if (factor !== 1 && factor > 0) {
                    if (_this.object.isPerspectiveCamera) {
                        _eye.multiplyScalar(factor);
                    } else if (_this.object.isOrthographicCamera) {
                        _this.object.zoom /= factor;
                        _this.object.updateProjectionMatrix();
                    } else {
                        console.warn('THREE.TrackballControls: Unsupported camera type');
                    }
                }
                if (_this.staticMoving) {
                    _zoomStart.copy(_zoomEnd);
                } else {
                    _zoomStart.y += (_zoomEnd.y - _zoomStart.y) * this.dynamicDampingFactor;
                }
            }
        };
        this.panCamera = function () {
            var mouseChange = new THREE.Vector2(), objectUp = new THREE.Vector3(), pan = new THREE.Vector3();
            return function panCamera() {
                mouseChange.copy(_panEnd).sub(_panStart);
                if (mouseChange.lengthSq()) {
                    if (_this.object.isOrthographicCamera) {
                        var scale_x = (_this.object.right - _this.object.left) / _this.object.zoom / _this.domElement.clientWidth;
                        var scale_y = (_this.object.top - _this.object.bottom) / _this.object.zoom / _this.domElement.clientWidth;
                        mouseChange.x *= scale_x;
                        mouseChange.y *= scale_y;
                    }
                    mouseChange.multiplyScalar(_eye.length() * _this.panSpeed);
                    pan.copy(_eye).cross(_this.object.up).setLength(mouseChange.x);
                    pan.add(objectUp.copy(_this.object.up).setLength(mouseChange.y));
                    _this.object.position.add(pan);
                    _this.target.add(pan);
                    if (_this.staticMoving) {
                        _panStart.copy(_panEnd);
                    } else {
                        _panStart.add(mouseChange.subVectors(_panEnd, _panStart).multiplyScalar(_this.dynamicDampingFactor));
                    }
                }
            };
        }();
        this.checkDistances = function () {
            if (!_this.noZoom || !_this.noPan) {
                if (_eye.lengthSq() > _this.maxDistance * _this.maxDistance) {
                    _this.object.position.addVectors(_this.target, _eye.setLength(_this.maxDistance));
                    _zoomStart.copy(_zoomEnd);
                }
                if (_eye.lengthSq() < _this.minDistance * _this.minDistance) {
                    _this.object.position.addVectors(_this.target, _eye.setLength(_this.minDistance));
                    _zoomStart.copy(_zoomEnd);
                }
            }
        };
        this.update = function () {
            _eye.subVectors(_this.object.position, _this.target);
            if (!_this.noRotate) {
                _this.rotateCamera();
            }
            if (!_this.noZoom) {
                _this.zoomCamera();
            }
            if (!_this.noPan) {
                _this.panCamera();
            }
            _this.object.position.addVectors(_this.target, _eye);
            if (_this.object.isPerspectiveCamera) {
                _this.checkDistances();
                _this.object.lookAt(_this.target);
                if (lastPosition.distanceToSquared(_this.object.position) > EPS) {
                    _this.dispatchEvent(changeEvent);
                    lastPosition.copy(_this.object.position);
                }
            } else if (_this.object.isOrthographicCamera) {
                _this.object.lookAt(_this.target);
                if (lastPosition.distanceToSquared(_this.object.position) > EPS || lastZoom !== _this.object.zoom) {
                    _this.dispatchEvent(changeEvent);
                    lastPosition.copy(_this.object.position);
                    lastZoom = _this.object.zoom;
                }
            } else {
                console.warn('THREE.TrackballControls: Unsupported camera type');
            }
        };
        this.reset = function () {
            _state = STATE.NONE;
            _keyState = STATE.NONE;
            _this.target.copy(_this.target0);
            _this.object.position.copy(_this.position0);
            _this.object.up.copy(_this.up0);
            _this.object.zoom = _this.zoom0;
            _this.object.updateProjectionMatrix();
            _eye.subVectors(_this.object.position, _this.target);
            _this.object.lookAt(_this.target);
            _this.dispatchEvent(changeEvent);
            lastPosition.copy(_this.object.position);
            lastZoom = _this.object.zoom;
        };
        function keydown(event) {
            if (_this.enabled === false)
                return;
            window.removeEventListener('keydown', keydown);
            if (_keyState !== STATE.NONE) {
                return;
            } else if (event.keyCode === _this.keys[STATE.ROTATE] && !_this.noRotate) {
                _keyState = STATE.ROTATE;
            } else if (event.keyCode === _this.keys[STATE.ZOOM] && !_this.noZoom) {
                _keyState = STATE.ZOOM;
            } else if (event.keyCode === _this.keys[STATE.PAN] && !_this.noPan) {
                _keyState = STATE.PAN;
            }
        }
        function keyup() {
            if (_this.enabled === false)
                return;
            _keyState = STATE.NONE;
            window.addEventListener('keydown', keydown, false);
        }
        function mousedown(event) {
            if (_this.enabled === false)
                return;
            event.preventDefault();
            event.stopPropagation();
            if (_state === STATE.NONE) {
                switch (event.button) {
                case _this.mouseButtons.LEFT:
                    _state = STATE.ROTATE;
                    break;
                case _this.mouseButtons.MIDDLE:
                    _state = STATE.ZOOM;
                    break;
                case _this.mouseButtons.RIGHT:
                    _state = STATE.PAN;
                    break;
                default:
                    _state = STATE.NONE;
                }
            }
            var state = _keyState !== STATE.NONE ? _keyState : _state;
            if (state === STATE.ROTATE && !_this.noRotate) {
                _moveCurr.copy(getMouseOnCircle(event.pageX, event.pageY));
                _movePrev.copy(_moveCurr);
            } else if (state === STATE.ZOOM && !_this.noZoom) {
                _zoomStart.copy(getMouseOnScreen(event.pageX, event.pageY));
                _zoomEnd.copy(_zoomStart);
            } else if (state === STATE.PAN && !_this.noPan) {
                _panStart.copy(getMouseOnScreen(event.pageX, event.pageY));
                _panEnd.copy(_panStart);
            }
            document.addEventListener('mousemove', mousemove, false);
            document.addEventListener('mouseup', mouseup, false);
            _this.dispatchEvent(startEvent);
        }
        function mousemove(event) {
            if (_this.enabled === false)
                return;
            event.preventDefault();
            event.stopPropagation();
            var state = _keyState !== STATE.NONE ? _keyState : _state;
            if (state === STATE.ROTATE && !_this.noRotate) {
                _movePrev.copy(_moveCurr);
                _moveCurr.copy(getMouseOnCircle(event.pageX, event.pageY));
            } else if (state === STATE.ZOOM && !_this.noZoom) {
                _zoomEnd.copy(getMouseOnScreen(event.pageX, event.pageY));
            } else if (state === STATE.PAN && !_this.noPan) {
                _panEnd.copy(getMouseOnScreen(event.pageX, event.pageY));
            }
        }
        function mouseup(event) {
            if (_this.enabled === false)
                return;
            event.preventDefault();
            event.stopPropagation();
            _state = STATE.NONE;
            document.removeEventListener('mousemove', mousemove);
            document.removeEventListener('mouseup', mouseup);
            _this.dispatchEvent(endEvent);
        }
        function mousewheel(event) {
            if (_this.enabled === false)
                return;
            if (_this.noZoom === true)
                return;
            event.preventDefault();
            event.stopPropagation();
            switch (event.deltaMode) {
            case 2:
                _zoomStart.y -= event.deltaY * 0.025;
                break;
            case 1:
                _zoomStart.y -= event.deltaY * 0.01;
                break;
            default:
                _zoomStart.y -= event.deltaY * 0.00025;
                break;
            }
            _this.dispatchEvent(startEvent);
            _this.dispatchEvent(endEvent);
        }
        function touchstart(event) {
            if (_this.enabled === false)
                return;
            event.preventDefault();
            switch (event.touches.length) {
            case 1:
                _state = STATE.TOUCH_ROTATE;
                _moveCurr.copy(getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));
                _movePrev.copy(_moveCurr);
                break;
            default:
                _state = STATE.TOUCH_ZOOM_PAN;
                var dx = event.touches[0].pageX - event.touches[1].pageX;
                var dy = event.touches[0].pageY - event.touches[1].pageY;
                _touchZoomDistanceEnd = _touchZoomDistanceStart = Math.sqrt(dx * dx + dy * dy);
                var x = (event.touches[0].pageX + event.touches[1].pageX) / 2;
                var y = (event.touches[0].pageY + event.touches[1].pageY) / 2;
                _panStart.copy(getMouseOnScreen(x, y));
                _panEnd.copy(_panStart);
                break;
            }
            _this.dispatchEvent(startEvent);
        }
        function touchmove(event) {
            if (_this.enabled === false)
                return;
            event.preventDefault();
            event.stopPropagation();
            switch (event.touches.length) {
            case 1:
                _movePrev.copy(_moveCurr);
                _moveCurr.copy(getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));
                break;
            default:
                var dx = event.touches[0].pageX - event.touches[1].pageX;
                var dy = event.touches[0].pageY - event.touches[1].pageY;
                _touchZoomDistanceEnd = Math.sqrt(dx * dx + dy * dy);
                var x = (event.touches[0].pageX + event.touches[1].pageX) / 2;
                var y = (event.touches[0].pageY + event.touches[1].pageY) / 2;
                _panEnd.copy(getMouseOnScreen(x, y));
                break;
            }
        }
        function touchend(event) {
            if (_this.enabled === false)
                return;
            switch (event.touches.length) {
            case 0:
                _state = STATE.NONE;
                break;
            case 1:
                _state = STATE.TOUCH_ROTATE;
                _moveCurr.copy(getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));
                _movePrev.copy(_moveCurr);
                break;
            }
            _this.dispatchEvent(endEvent);
        }
        function contextmenu(event) {
            if (_this.enabled === false)
                return;
            event.preventDefault();
        }
        this.dispose = function () {
            this.domElement.removeEventListener('contextmenu', contextmenu, false);
            this.domElement.removeEventListener('mousedown', mousedown, false);
            this.domElement.removeEventListener('wheel', mousewheel, false);
            this.domElement.removeEventListener('touchstart', touchstart, false);
            this.domElement.removeEventListener('touchend', touchend, false);
            this.domElement.removeEventListener('touchmove', touchmove, false);
            document.removeEventListener('mousemove', mousemove, false);
            document.removeEventListener('mouseup', mouseup, false);
            window.removeEventListener('keydown', keydown, false);
            window.removeEventListener('keyup', keyup, false);
        };
        this.domElement.addEventListener('contextmenu', contextmenu, false);
        this.domElement.addEventListener('mousedown', mousedown, false);
        this.domElement.addEventListener('wheel', mousewheel, false);
        this.domElement.addEventListener('touchstart', touchstart, false);
        this.domElement.addEventListener('touchend', touchend, false);
        this.domElement.addEventListener('touchmove', touchmove, false);
        window.addEventListener('keydown', keydown, false);
        window.addEventListener('keyup', keyup, false);
        this.handleResize();
        this.update();
    };
    TrackballControls.prototype = Object.create(THREE.EventDispatcher.prototype);
    TrackballControls.prototype.constructor = TrackballControls;

    return threex.controls.TrackballControls = TrackballControls;
});
define('skylark-threejs-ex/controls/TransformControls',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var TransformControls = function (camera, domElement) {
        if (domElement === undefined) {
            console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.');
            domElement = document;
        }
        THREE.Object3D.call(this);
        this.visible = false;
        this.domElement = domElement;
        var _gizmo = new TransformControlsGizmo();
        this.add(_gizmo);
        var _plane = new TransformControlsPlane();
        this.add(_plane);
        var scope = this;
        defineProperty('camera', camera);
        defineProperty('object', undefined);
        defineProperty('enabled', true);
        defineProperty('axis', null);
        defineProperty('mode', 'translate');
        defineProperty('translationSnap', null);
        defineProperty('rotationSnap', null);
        defineProperty('scaleSnap', null);
        defineProperty('space', 'world');
        defineProperty('size', 1);
        defineProperty('dragging', false);
        defineProperty('showX', true);
        defineProperty('showY', true);
        defineProperty('showZ', true);
        var changeEvent = { type: 'change' };
        var mouseDownEvent = { type: 'mouseDown' };
        var mouseUpEvent = {
            type: 'mouseUp',
            mode: scope.mode
        };
        var objectChangeEvent = { type: 'objectChange' };
        var ray = new THREE.Raycaster();
        var _tempVector = new THREE.Vector3();
        var _tempVector2 = new THREE.Vector3();
        var _tempQuaternion = new THREE.Quaternion();
        var _unit = {
            X: new THREE.Vector3(1, 0, 0),
            Y: new THREE.Vector3(0, 1, 0),
            Z: new THREE.Vector3(0, 0, 1)
        };
        var pointStart = new THREE.Vector3();
        var pointEnd = new THREE.Vector3();
        var offset = new THREE.Vector3();
        var rotationAxis = new THREE.Vector3();
        var startNorm = new THREE.Vector3();
        var endNorm = new THREE.Vector3();
        var rotationAngle = 0;
        var cameraPosition = new THREE.Vector3();
        var cameraQuaternion = new THREE.Quaternion();
        var cameraScale = new THREE.Vector3();
        var parentPosition = new THREE.Vector3();
        var parentQuaternion = new THREE.Quaternion();
        var parentQuaternionInv = new THREE.Quaternion();
        var parentScale = new THREE.Vector3();
        var worldPositionStart = new THREE.Vector3();
        var worldQuaternionStart = new THREE.Quaternion();
        var worldScaleStart = new THREE.Vector3();
        var worldPosition = new THREE.Vector3();
        var worldQuaternion = new THREE.Quaternion();
        var worldQuaternionInv = new THREE.Quaternion();
        var worldScale = new THREE.Vector3();
        var eye = new THREE.Vector3();
        var positionStart = new THREE.Vector3();
        var quaternionStart = new THREE.Quaternion();
        var scaleStart = new THREE.Vector3();
        defineProperty('worldPosition', worldPosition);
        defineProperty('worldPositionStart', worldPositionStart);
        defineProperty('worldQuaternion', worldQuaternion);
        defineProperty('worldQuaternionStart', worldQuaternionStart);
        defineProperty('cameraPosition', cameraPosition);
        defineProperty('cameraQuaternion', cameraQuaternion);
        defineProperty('pointStart', pointStart);
        defineProperty('pointEnd', pointEnd);
        defineProperty('rotationAxis', rotationAxis);
        defineProperty('rotationAngle', rotationAngle);
        defineProperty('eye', eye);
        {
            domElement.addEventListener('mousedown', onPointerDown, false);
            domElement.addEventListener('touchstart', onPointerDown, false);
            domElement.addEventListener('mousemove', onPointerHover, false);
            domElement.addEventListener('touchmove', onPointerHover, false);
            domElement.addEventListener('touchmove', onPointerMove, false);
            document.addEventListener('mouseup', onPointerUp, false);
            domElement.addEventListener('touchend', onPointerUp, false);
            domElement.addEventListener('touchcancel', onPointerUp, false);
            domElement.addEventListener('touchleave', onPointerUp, false);
        }
        this.dispose = function () {
            domElement.removeEventListener('mousedown', onPointerDown);
            domElement.removeEventListener('touchstart', onPointerDown);
            domElement.removeEventListener('mousemove', onPointerHover);
            document.removeEventListener('mousemove', onPointerMove);
            domElement.removeEventListener('touchmove', onPointerHover);
            domElement.removeEventListener('touchmove', onPointerMove);
            document.removeEventListener('mouseup', onPointerUp);
            domElement.removeEventListener('touchend', onPointerUp);
            domElement.removeEventListener('touchcancel', onPointerUp);
            domElement.removeEventListener('touchleave', onPointerUp);
            this.traverse(function (child) {
                if (child.geometry)
                    child.geometry.dispose();
                if (child.material)
                    child.material.dispose();
            });
        };
        this.attach = function (object) {
            this.object = object;
            this.visible = true;
            return this;
        };
        this.detach = function () {
            this.object = undefined;
            this.visible = false;
            this.axis = null;
            return this;
        };
        function defineProperty(propName, defaultValue) {
            var propValue = defaultValue;
            Object.defineProperty(scope, propName, {
                get: function () {
                    return propValue !== undefined ? propValue : defaultValue;
                },
                set: function (value) {
                    if (propValue !== value) {
                        propValue = value;
                        _plane[propName] = value;
                        _gizmo[propName] = value;
                        scope.dispatchEvent({
                            type: propName + '-changed',
                            value: value
                        });
                        scope.dispatchEvent(changeEvent);
                    }
                }
            });
            scope[propName] = defaultValue;
            _plane[propName] = defaultValue;
            _gizmo[propName] = defaultValue;
        }
        this.updateMatrixWorld = function () {
            if (this.object !== undefined) {
                this.object.updateMatrixWorld();
                if (this.object.parent === null) {
                    console.error('TransformControls: The attached 3D object must be THREE part of the scene graph.');
                } else {
                    this.object.parent.matrixWorld.decompose(parentPosition, parentQuaternion, parentScale);
                }
                this.object.matrixWorld.decompose(worldPosition, worldQuaternion, worldScale);
                parentQuaternionInv.copy(parentQuaternion).inverse();
                worldQuaternionInv.copy(worldQuaternion).inverse();
            }
            this.camera.updateMatrixWorld();
            this.camera.matrixWorld.decompose(cameraPosition, cameraQuaternion, cameraScale);
            eye.copy(cameraPosition).sub(worldPosition).normalize();
            THREE.Object3D.prototype.updateMatrixWorld.call(this);
        };
        this.pointerHover = function (pointer) {
            if (this.object === undefined || this.dragging === true || pointer.button !== undefined && pointer.button !== 0)
                return;
            ray.setFromCamera(pointer, this.camera);
            var intersect = ray.intersectObjects(_gizmo.picker[this.mode].children, true)[0] || false;
            if (intersect) {
                this.axis = intersect.object.name;
            } else {
                this.axis = null;
            }
        };
        this.pointerDown = function (pointer) {
            if (this.object === undefined || this.dragging === true || pointer.button !== undefined && pointer.button !== 0)
                return;
            if ((pointer.button === 0 || pointer.button === undefined) && this.axis !== null) {
                ray.setFromCamera(pointer, this.camera);
                var planeIntersect = ray.intersectObjects([_plane], true)[0] || false;
                if (planeIntersect) {
                    var space = this.space;
                    if (this.mode === 'scale') {
                        space = 'local';
                    } else if (this.axis === 'E' || this.axis === 'XYZE' || this.axis === 'XYZ') {
                        space = 'world';
                    }
                    if (space === 'local' && this.mode === 'rotate') {
                        var snap = this.rotationSnap;
                        if (this.axis === 'X' && snap)
                            this.object.rotation.x = Math.round(this.object.rotation.x / snap) * snap;
                        if (this.axis === 'Y' && snap)
                            this.object.rotation.y = Math.round(this.object.rotation.y / snap) * snap;
                        if (this.axis === 'Z' && snap)
                            this.object.rotation.z = Math.round(this.object.rotation.z / snap) * snap;
                    }
                    this.object.updateMatrixWorld();
                    this.object.parent.updateMatrixWorld();
                    positionStart.copy(this.object.position);
                    quaternionStart.copy(this.object.quaternion);
                    scaleStart.copy(this.object.scale);
                    this.object.matrixWorld.decompose(worldPositionStart, worldQuaternionStart, worldScaleStart);
                    pointStart.copy(planeIntersect.point).sub(worldPositionStart);
                }
                this.dragging = true;
                mouseDownEvent.mode = this.mode;
                this.dispatchEvent(mouseDownEvent);
            }
        };
        this.pointerMove = function (pointer) {
            var axis = this.axis;
            var mode = this.mode;
            var object = this.object;
            var space = this.space;
            if (mode === 'scale') {
                space = 'local';
            } else if (axis === 'E' || axis === 'XYZE' || axis === 'XYZ') {
                space = 'world';
            }
            if (object === undefined || axis === null || this.dragging === false || pointer.button !== undefined && pointer.button !== 0)
                return;
            ray.setFromCamera(pointer, this.camera);
            var planeIntersect = ray.intersectObjects([_plane], true)[0] || false;
            if (planeIntersect === false)
                return;
            pointEnd.copy(planeIntersect.point).sub(worldPositionStart);
            if (mode === 'translate') {
                offset.copy(pointEnd).sub(pointStart);
                if (space === 'local' && axis !== 'XYZ') {
                    offset.applyQuaternion(worldQuaternionInv);
                }
                if (axis.indexOf('X') === -1)
                    offset.x = 0;
                if (axis.indexOf('Y') === -1)
                    offset.y = 0;
                if (axis.indexOf('Z') === -1)
                    offset.z = 0;
                if (space === 'local' && axis !== 'XYZ') {
                    offset.applyQuaternion(quaternionStart).divide(parentScale);
                } else {
                    offset.applyQuaternion(parentQuaternionInv).divide(parentScale);
                }
                object.position.copy(offset).add(positionStart);
                if (this.translationSnap) {
                    if (space === 'local') {
                        object.position.applyQuaternion(_tempQuaternion.copy(quaternionStart).inverse());
                        if (axis.search('X') !== -1) {
                            object.position.x = Math.round(object.position.x / this.translationSnap) * this.translationSnap;
                        }
                        if (axis.search('Y') !== -1) {
                            object.position.y = Math.round(object.position.y / this.translationSnap) * this.translationSnap;
                        }
                        if (axis.search('Z') !== -1) {
                            object.position.z = Math.round(object.position.z / this.translationSnap) * this.translationSnap;
                        }
                        object.position.applyQuaternion(quaternionStart);
                    }
                    if (space === 'world') {
                        if (object.parent) {
                            object.position.add(_tempVector.setFromMatrixPosition(object.parent.matrixWorld));
                        }
                        if (axis.search('X') !== -1) {
                            object.position.x = Math.round(object.position.x / this.translationSnap) * this.translationSnap;
                        }
                        if (axis.search('Y') !== -1) {
                            object.position.y = Math.round(object.position.y / this.translationSnap) * this.translationSnap;
                        }
                        if (axis.search('Z') !== -1) {
                            object.position.z = Math.round(object.position.z / this.translationSnap) * this.translationSnap;
                        }
                        if (object.parent) {
                            object.position.sub(_tempVector.setFromMatrixPosition(object.parent.matrixWorld));
                        }
                    }
                }
            } else if (mode === 'scale') {
                if (axis.search('XYZ') !== -1) {
                    var d = pointEnd.length() / pointStart.length();
                    if (pointEnd.dot(pointStart) < 0)
                        d *= -1;
                    _tempVector2.set(d, d, d);
                } else {
                    _tempVector.copy(pointStart);
                    _tempVector2.copy(pointEnd);
                    _tempVector.applyQuaternion(worldQuaternionInv);
                    _tempVector2.applyQuaternion(worldQuaternionInv);
                    _tempVector2.divide(_tempVector);
                    if (axis.search('X') === -1) {
                        _tempVector2.x = 1;
                    }
                    if (axis.search('Y') === -1) {
                        _tempVector2.y = 1;
                    }
                    if (axis.search('Z') === -1) {
                        _tempVector2.z = 1;
                    }
                }
                object.scale.copy(scaleStart).multiply(_tempVector2);
                if (this.scaleSnap) {
                    if (axis.search('X') !== -1) {
                        object.scale.x = Math.round(object.scale.x / this.scaleSnap) * this.scaleSnap || this.scaleSnap;
                    }
                    if (axis.search('Y') !== -1) {
                        object.scale.y = Math.round(object.scale.y / this.scaleSnap) * this.scaleSnap || this.scaleSnap;
                    }
                    if (axis.search('Z') !== -1) {
                        object.scale.z = Math.round(object.scale.z / this.scaleSnap) * this.scaleSnap || this.scaleSnap;
                    }
                }
            } else if (mode === 'rotate') {
                offset.copy(pointEnd).sub(pointStart);
                var ROTATION_SPEED = 20 / worldPosition.distanceTo(_tempVector.setFromMatrixPosition(this.camera.matrixWorld));
                if (axis === 'E') {
                    rotationAxis.copy(eye);
                    rotationAngle = pointEnd.angleTo(pointStart);
                    startNorm.copy(pointStart).normalize();
                    endNorm.copy(pointEnd).normalize();
                    rotationAngle *= endNorm.cross(startNorm).dot(eye) < 0 ? 1 : -1;
                } else if (axis === 'XYZE') {
                    rotationAxis.copy(offset).cross(eye).normalize();
                    rotationAngle = offset.dot(_tempVector.copy(rotationAxis).cross(this.eye)) * ROTATION_SPEED;
                } else if (axis === 'X' || axis === 'Y' || axis === 'Z') {
                    rotationAxis.copy(_unit[axis]);
                    _tempVector.copy(_unit[axis]);
                    if (space === 'local') {
                        _tempVector.applyQuaternion(worldQuaternion);
                    }
                    rotationAngle = offset.dot(_tempVector.cross(eye).normalize()) * ROTATION_SPEED;
                }
                if (this.rotationSnap)
                    rotationAngle = Math.round(rotationAngle / this.rotationSnap) * this.rotationSnap;
                this.rotationAngle = rotationAngle;
                if (space === 'local' && axis !== 'E' && axis !== 'XYZE') {
                    object.quaternion.copy(quaternionStart);
                    object.quaternion.multiply(_tempQuaternion.setFromAxisAngle(rotationAxis, rotationAngle)).normalize();
                } else {
                    rotationAxis.applyQuaternion(parentQuaternionInv);
                    object.quaternion.copy(_tempQuaternion.setFromAxisAngle(rotationAxis, rotationAngle));
                    object.quaternion.multiply(quaternionStart).normalize();
                }
            }
            this.dispatchEvent(changeEvent);
            this.dispatchEvent(objectChangeEvent);
        };
        this.pointerUp = function (pointer) {
            if (pointer.button !== undefined && pointer.button !== 0)
                return;
            if (this.dragging && this.axis !== null) {
                mouseUpEvent.mode = this.mode;
                this.dispatchEvent(mouseUpEvent);
            }
            this.dragging = false;
            if (pointer.button === undefined)
                this.axis = null;
        };
        function getPointer(event) {
            if (document.pointerLockElement) {
                return {
                    x: 0,
                    y: 0,
                    button: event.button
                };
            } else {
                var pointer = event.changedTouches ? event.changedTouches[0] : event;
                var rect = domElement.getBoundingClientRect();
                return {
                    x: (pointer.clientX - rect.left) / rect.width * 2 - 1,
                    y: -(pointer.clientY - rect.top) / rect.height * 2 + 1,
                    button: event.button
                };
            }
        }
        function onPointerHover(event) {
            if (!scope.enabled)
                return;
            scope.pointerHover(getPointer(event));
        }
        function onPointerDown(event) {
            if (!scope.enabled)
                return;
            document.addEventListener('mousemove', onPointerMove, false);
            scope.pointerHover(getPointer(event));
            scope.pointerDown(getPointer(event));
        }
        function onPointerMove(event) {
            if (!scope.enabled)
                return;
            scope.pointerMove(getPointer(event));
        }
        function onPointerUp(event) {
            if (!scope.enabled)
                return;
            document.removeEventListener('mousemove', onPointerMove, false);
            scope.pointerUp(getPointer(event));
        }
        this.getMode = function () {
            return scope.mode;
        };
        this.setMode = function (mode) {
            scope.mode = mode;
        };
        this.setTranslationSnap = function (translationSnap) {
            scope.translationSnap = translationSnap;
        };
        this.setRotationSnap = function (rotationSnap) {
            scope.rotationSnap = rotationSnap;
        };
        this.setScaleSnap = function (scaleSnap) {
            scope.scaleSnap = scaleSnap;
        };
        this.setSize = function (size) {
            scope.size = size;
        };
        this.setSpace = function (space) {
            scope.space = space;
        };
        this.update = function () {
            console.warn('THREE.TransformControls: update function has no more functionality and therefore has been deprecated.');
        };
    };
    TransformControls.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
        constructor: TransformControls,
        isTransformControls: true
    });

    return threex.controls.TransformControls = TransformControls;
});
define('skylark-threejs-ex/controls/TransformControlsGizmo',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var TransformControlsGizmo = function () {
        'use strict';
        THREE.Object3D.call(this);
        this.type = 'TransformControlsGizmo';
        var gizmoMaterial = new THREE.MeshBasicMaterial({
            depthTest: false,
            depthWrite: false,
            transparent: true,
            side: THREE.DoubleSide,
            fog: false
        });
        var gizmoLineMaterial = new THREE.LineBasicMaterial({
            depthTest: false,
            depthWrite: false,
            transparent: true,
            linewidth: 1,
            fog: false
        });
        var matInvisible = gizmoMaterial.clone();
        matInvisible.opacity = 0.15;
        var matHelper = gizmoMaterial.clone();
        matHelper.opacity = 0.33;
        var matRed = gizmoMaterial.clone();
        matRed.color.set(16711680);
        var matGreen = gizmoMaterial.clone();
        matGreen.color.set(65280);
        var matBlue = gizmoMaterial.clone();
        matBlue.color.set(255);
        var matWhiteTransparent = gizmoMaterial.clone();
        matWhiteTransparent.opacity = 0.25;
        var matYellowTransparent = matWhiteTransparent.clone();
        matYellowTransparent.color.set(16776960);
        var matCyanTransparent = matWhiteTransparent.clone();
        matCyanTransparent.color.set(65535);
        var matMagentaTransparent = matWhiteTransparent.clone();
        matMagentaTransparent.color.set(16711935);
        var matYellow = gizmoMaterial.clone();
        matYellow.color.set(16776960);
        var matLineRed = gizmoLineMaterial.clone();
        matLineRed.color.set(16711680);
        var matLineGreen = gizmoLineMaterial.clone();
        matLineGreen.color.set(65280);
        var matLineBlue = gizmoLineMaterial.clone();
        matLineBlue.color.set(255);
        var matLineCyan = gizmoLineMaterial.clone();
        matLineCyan.color.set(65535);
        var matLineMagenta = gizmoLineMaterial.clone();
        matLineMagenta.color.set(16711935);
        var matLineYellow = gizmoLineMaterial.clone();
        matLineYellow.color.set(16776960);
        var matLineGray = gizmoLineMaterial.clone();
        matLineGray.color.set(7895160);
        var matLineYellowTransparent = matLineYellow.clone();
        matLineYellowTransparent.opacity = 0.25;
        var arrowGeometry = new THREE.CylinderBufferGeometry(0, 0.05, 0.2, 12, 1, false);
        var scaleHandleGeometry = new THREE.BoxBufferGeometry(0.125, 0.125, 0.125);
        var lineGeometry = new THREE.BufferGeometry();
        lineGeometry.setAttribute('position', new THREE.Float32BufferAttribute([
            0,
            0,
            0,
            1,
            0,
            0
        ], 3));
        var CircleGeometry = function (radius, arc) {
            var geometry = new THREE.BufferGeometry();
            var vertices = [];
            for (var i = 0; i <= 64 * arc; ++i) {
                vertices.push(0, Math.cos(i / 32 * Math.PI) * radius, Math.sin(i / 32 * Math.PI) * radius);
            }
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
            return geometry;
        };
        var TranslateHelperGeometry = function () {
            var geometry = new THREE.BufferGeometry();
            geometry.setAttribute('position', new THREE.Float32BufferAttribute([
                0,
                0,
                0,
                1,
                1,
                1
            ], 3));
            return geometry;
        };
        var gizmoTranslate = {
            X: [
                [
                    new THREE.Mesh(arrowGeometry, matRed),
                    [
                        1,
                        0,
                        0
                    ],
                    [
                        0,
                        0,
                        -Math.PI / 2
                    ],
                    null,
                    'fwd'
                ],
                [
                    new THREE.Mesh(arrowGeometry, matRed),
                    [
                        1,
                        0,
                        0
                    ],
                    [
                        0,
                        0,
                        Math.PI / 2
                    ],
                    null,
                    'bwd'
                ],
                [new THREE.Line(lineGeometry, matLineRed)]
            ],
            Y: [
                [
                    new THREE.Mesh(arrowGeometry, matGreen),
                    [
                        0,
                        1,
                        0
                    ],
                    null,
                    null,
                    'fwd'
                ],
                [
                    new THREE.Mesh(arrowGeometry, matGreen),
                    [
                        0,
                        1,
                        0
                    ],
                    [
                        Math.PI,
                        0,
                        0
                    ],
                    null,
                    'bwd'
                ],
                [
                    new THREE.Line(lineGeometry, matLineGreen),
                    null,
                    [
                        0,
                        0,
                        Math.PI / 2
                    ]
                ]
            ],
            Z: [
                [
                    new THREE.Mesh(arrowGeometry, matBlue),
                    [
                        0,
                        0,
                        1
                    ],
                    [
                        Math.PI / 2,
                        0,
                        0
                    ],
                    null,
                    'fwd'
                ],
                [
                    new THREE.Mesh(arrowGeometry, matBlue),
                    [
                        0,
                        0,
                        1
                    ],
                    [
                        -Math.PI / 2,
                        0,
                        0
                    ],
                    null,
                    'bwd'
                ],
                [
                    new THREE.Line(lineGeometry, matLineBlue),
                    null,
                    [
                        0,
                        -Math.PI / 2,
                        0
                    ]
                ]
            ],
            XYZ: [[
                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.1, 0), matWhiteTransparent.clone()),
                    [
                        0,
                        0,
                        0
                    ],
                    [
                        0,
                        0,
                        0
                    ]
                ]],
            XY: [
                [
                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.295, 0.295), matYellowTransparent.clone()),
                    [
                        0.15,
                        0.15,
                        0
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineYellow),
                    [
                        0.18,
                        0.3,
                        0
                    ],
                    null,
                    [
                        0.125,
                        1,
                        1
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineYellow),
                    [
                        0.3,
                        0.18,
                        0
                    ],
                    [
                        0,
                        0,
                        Math.PI / 2
                    ],
                    [
                        0.125,
                        1,
                        1
                    ]
                ]
            ],
            YZ: [
                [
                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.295, 0.295), matCyanTransparent.clone()),
                    [
                        0,
                        0.15,
                        0.15
                    ],
                    [
                        0,
                        Math.PI / 2,
                        0
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineCyan),
                    [
                        0,
                        0.18,
                        0.3
                    ],
                    [
                        0,
                        0,
                        Math.PI / 2
                    ],
                    [
                        0.125,
                        1,
                        1
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineCyan),
                    [
                        0,
                        0.3,
                        0.18
                    ],
                    [
                        0,
                        -Math.PI / 2,
                        0
                    ],
                    [
                        0.125,
                        1,
                        1
                    ]
                ]
            ],
            XZ: [
                [
                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.295, 0.295), matMagentaTransparent.clone()),
                    [
                        0.15,
                        0,
                        0.15
                    ],
                    [
                        -Math.PI / 2,
                        0,
                        0
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineMagenta),
                    [
                        0.18,
                        0,
                        0.3
                    ],
                    null,
                    [
                        0.125,
                        1,
                        1
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineMagenta),
                    [
                        0.3,
                        0,
                        0.18
                    ],
                    [
                        0,
                        -Math.PI / 2,
                        0
                    ],
                    [
                        0.125,
                        1,
                        1
                    ]
                ]
            ]
        };
        var pickerTranslate = {
            X: [[
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 1, 4, 1, false), matInvisible),
                    [
                        0.6,
                        0,
                        0
                    ],
                    [
                        0,
                        0,
                        -Math.PI / 2
                    ]
                ]],
            Y: [[
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 1, 4, 1, false), matInvisible),
                    [
                        0,
                        0.6,
                        0
                    ]
                ]],
            Z: [[
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 1, 4, 1, false), matInvisible),
                    [
                        0,
                        0,
                        0.6
                    ],
                    [
                        Math.PI / 2,
                        0,
                        0
                    ]
                ]],
            XYZ: [[new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.2, 0), matInvisible)]],
            XY: [[
                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.4, 0.4), matInvisible),
                    [
                        0.2,
                        0.2,
                        0
                    ]
                ]],
            YZ: [[
                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.4, 0.4), matInvisible),
                    [
                        0,
                        0.2,
                        0.2
                    ],
                    [
                        0,
                        Math.PI / 2,
                        0
                    ]
                ]],
            XZ: [[
                    new THREE.Mesh(new THREE.PlaneBufferGeometry(0.4, 0.4), matInvisible),
                    [
                        0.2,
                        0,
                        0.2
                    ],
                    [
                        -Math.PI / 2,
                        0,
                        0
                    ]
                ]]
        };
        var helperTranslate = {
            START: [[
                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.01, 2), matHelper),
                    null,
                    null,
                    null,
                    'helper'
                ]],
            END: [[
                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.01, 2), matHelper),
                    null,
                    null,
                    null,
                    'helper'
                ]],
            DELTA: [[
                    new THREE.Line(TranslateHelperGeometry(), matHelper),
                    null,
                    null,
                    null,
                    'helper'
                ]],
            X: [[
                    new THREE.Line(lineGeometry, matHelper.clone()),
                    [
                        -1000,
                        0,
                        0
                    ],
                    null,
                    [
                        1000000,
                        1,
                        1
                    ],
                    'helper'
                ]],
            Y: [[
                    new THREE.Line(lineGeometry, matHelper.clone()),
                    [
                        0,
                        -1000,
                        0
                    ],
                    [
                        0,
                        0,
                        Math.PI / 2
                    ],
                    [
                        1000000,
                        1,
                        1
                    ],
                    'helper'
                ]],
            Z: [[
                    new THREE.Line(lineGeometry, matHelper.clone()),
                    [
                        0,
                        0,
                        -1000
                    ],
                    [
                        0,
                        -Math.PI / 2,
                        0
                    ],
                    [
                        1000000,
                        1,
                        1
                    ],
                    'helper'
                ]]
        };
        var gizmoRotate = {
            X: [
                [new THREE.Line(CircleGeometry(1, 0.5), matLineRed)],
                [
                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.04, 0), matRed),
                    [
                        0,
                        0,
                        0.99
                    ],
                    null,
                    [
                        1,
                        3,
                        1
                    ]
                ]
            ],
            Y: [
                [
                    new THREE.Line(CircleGeometry(1, 0.5), matLineGreen),
                    null,
                    [
                        0,
                        0,
                        -Math.PI / 2
                    ]
                ],
                [
                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.04, 0), matGreen),
                    [
                        0,
                        0,
                        0.99
                    ],
                    null,
                    [
                        3,
                        1,
                        1
                    ]
                ]
            ],
            Z: [
                [
                    new THREE.Line(CircleGeometry(1, 0.5), matLineBlue),
                    null,
                    [
                        0,
                        Math.PI / 2,
                        0
                    ]
                ],
                [
                    new THREE.Mesh(new THREE.OctahedronBufferGeometry(0.04, 0), matBlue),
                    [
                        0.99,
                        0,
                        0
                    ],
                    null,
                    [
                        1,
                        3,
                        1
                    ]
                ]
            ],
            E: [
                [
                    new THREE.Line(CircleGeometry(1.25, 1), matLineYellowTransparent),
                    null,
                    [
                        0,
                        Math.PI / 2,
                        0
                    ]
                ],
                [
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),
                    [
                        1.17,
                        0,
                        0
                    ],
                    [
                        0,
                        0,
                        -Math.PI / 2
                    ],
                    [
                        1,
                        1,
                        0.001
                    ]
                ],
                [
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),
                    [
                        -1.17,
                        0,
                        0
                    ],
                    [
                        0,
                        0,
                        Math.PI / 2
                    ],
                    [
                        1,
                        1,
                        0.001
                    ]
                ],
                [
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),
                    [
                        0,
                        -1.17,
                        0
                    ],
                    [
                        Math.PI,
                        0,
                        0
                    ],
                    [
                        1,
                        1,
                        0.001
                    ]
                ],
                [
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent),
                    [
                        0,
                        1.17,
                        0
                    ],
                    [
                        0,
                        0,
                        0
                    ],
                    [
                        1,
                        1,
                        0.001
                    ]
                ]
            ],
            XYZE: [[
                    new THREE.Line(CircleGeometry(1, 1), matLineGray),
                    null,
                    [
                        0,
                        Math.PI / 2,
                        0
                    ]
                ]]
        };
        var helperRotate = {
            AXIS: [[
                    new THREE.Line(lineGeometry, matHelper.clone()),
                    [
                        -1000,
                        0,
                        0
                    ],
                    null,
                    [
                        1000000,
                        1,
                        1
                    ],
                    'helper'
                ]]
        };
        var pickerRotate = {
            X: [[
                    new THREE.Mesh(new THREE.TorusBufferGeometry(1, 0.1, 4, 24), matInvisible),
                    [
                        0,
                        0,
                        0
                    ],
                    [
                        0,
                        -Math.PI / 2,
                        -Math.PI / 2
                    ]
                ]],
            Y: [[
                    new THREE.Mesh(new THREE.TorusBufferGeometry(1, 0.1, 4, 24), matInvisible),
                    [
                        0,
                        0,
                        0
                    ],
                    [
                        Math.PI / 2,
                        0,
                        0
                    ]
                ]],
            Z: [[
                    new THREE.Mesh(new THREE.TorusBufferGeometry(1, 0.1, 4, 24), matInvisible),
                    [
                        0,
                        0,
                        0
                    ],
                    [
                        0,
                        0,
                        -Math.PI / 2
                    ]
                ]],
            E: [[new THREE.Mesh(new THREE.TorusBufferGeometry(1.25, 0.1, 2, 24), matInvisible)]],
            XYZE: [[new THREE.Mesh(new THREE.SphereBufferGeometry(0.7, 10, 8), matInvisible)]]
        };
        var gizmoScale = {
            X: [
                [
                    new THREE.Mesh(scaleHandleGeometry, matRed),
                    [
                        0.8,
                        0,
                        0
                    ],
                    [
                        0,
                        0,
                        -Math.PI / 2
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineRed),
                    null,
                    null,
                    [
                        0.8,
                        1,
                        1
                    ]
                ]
            ],
            Y: [
                [
                    new THREE.Mesh(scaleHandleGeometry, matGreen),
                    [
                        0,
                        0.8,
                        0
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineGreen),
                    null,
                    [
                        0,
                        0,
                        Math.PI / 2
                    ],
                    [
                        0.8,
                        1,
                        1
                    ]
                ]
            ],
            Z: [
                [
                    new THREE.Mesh(scaleHandleGeometry, matBlue),
                    [
                        0,
                        0,
                        0.8
                    ],
                    [
                        Math.PI / 2,
                        0,
                        0
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineBlue),
                    null,
                    [
                        0,
                        -Math.PI / 2,
                        0
                    ],
                    [
                        0.8,
                        1,
                        1
                    ]
                ]
            ],
            XY: [
                [
                    new THREE.Mesh(scaleHandleGeometry, matYellowTransparent),
                    [
                        0.85,
                        0.85,
                        0
                    ],
                    null,
                    [
                        2,
                        2,
                        0.2
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineYellow),
                    [
                        0.855,
                        0.98,
                        0
                    ],
                    null,
                    [
                        0.125,
                        1,
                        1
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineYellow),
                    [
                        0.98,
                        0.855,
                        0
                    ],
                    [
                        0,
                        0,
                        Math.PI / 2
                    ],
                    [
                        0.125,
                        1,
                        1
                    ]
                ]
            ],
            YZ: [
                [
                    new THREE.Mesh(scaleHandleGeometry, matCyanTransparent),
                    [
                        0,
                        0.85,
                        0.85
                    ],
                    null,
                    [
                        0.2,
                        2,
                        2
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineCyan),
                    [
                        0,
                        0.855,
                        0.98
                    ],
                    [
                        0,
                        0,
                        Math.PI / 2
                    ],
                    [
                        0.125,
                        1,
                        1
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineCyan),
                    [
                        0,
                        0.98,
                        0.855
                    ],
                    [
                        0,
                        -Math.PI / 2,
                        0
                    ],
                    [
                        0.125,
                        1,
                        1
                    ]
                ]
            ],
            XZ: [
                [
                    new THREE.Mesh(scaleHandleGeometry, matMagentaTransparent),
                    [
                        0.85,
                        0,
                        0.85
                    ],
                    null,
                    [
                        2,
                        0.2,
                        2
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineMagenta),
                    [
                        0.855,
                        0,
                        0.98
                    ],
                    null,
                    [
                        0.125,
                        1,
                        1
                    ]
                ],
                [
                    new THREE.Line(lineGeometry, matLineMagenta),
                    [
                        0.98,
                        0,
                        0.855
                    ],
                    [
                        0,
                        -Math.PI / 2,
                        0
                    ],
                    [
                        0.125,
                        1,
                        1
                    ]
                ]
            ],
            XYZX: [[
                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()),
                    [
                        1.1,
                        0,
                        0
                    ]
                ]],
            XYZY: [[
                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()),
                    [
                        0,
                        1.1,
                        0
                    ]
                ]],
            XYZZ: [[
                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()),
                    [
                        0,
                        0,
                        1.1
                    ]
                ]]
        };
        var pickerScale = {
            X: [[
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible),
                    [
                        0.5,
                        0,
                        0
                    ],
                    [
                        0,
                        0,
                        -Math.PI / 2
                    ]
                ]],
            Y: [[
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible),
                    [
                        0,
                        0.5,
                        0
                    ]
                ]],
            Z: [[
                    new THREE.Mesh(new THREE.CylinderBufferGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible),
                    [
                        0,
                        0,
                        0.5
                    ],
                    [
                        Math.PI / 2,
                        0,
                        0
                    ]
                ]],
            XY: [[
                    new THREE.Mesh(scaleHandleGeometry, matInvisible),
                    [
                        0.85,
                        0.85,
                        0
                    ],
                    null,
                    [
                        3,
                        3,
                        0.2
                    ]
                ]],
            YZ: [[
                    new THREE.Mesh(scaleHandleGeometry, matInvisible),
                    [
                        0,
                        0.85,
                        0.85
                    ],
                    null,
                    [
                        0.2,
                        3,
                        3
                    ]
                ]],
            XZ: [[
                    new THREE.Mesh(scaleHandleGeometry, matInvisible),
                    [
                        0.85,
                        0,
                        0.85
                    ],
                    null,
                    [
                        3,
                        0.2,
                        3
                    ]
                ]],
            XYZX: [[
                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.2, 0.2, 0.2), matInvisible),
                    [
                        1.1,
                        0,
                        0
                    ]
                ]],
            XYZY: [[
                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.2, 0.2, 0.2), matInvisible),
                    [
                        0,
                        1.1,
                        0
                    ]
                ]],
            XYZZ: [[
                    new THREE.Mesh(new THREE.BoxBufferGeometry(0.2, 0.2, 0.2), matInvisible),
                    [
                        0,
                        0,
                        1.1
                    ]
                ]]
        };
        var helperScale = {
            X: [[
                    new THREE.Line(lineGeometry, matHelper.clone()),
                    [
                        -1000,
                        0,
                        0
                    ],
                    null,
                    [
                        1000000,
                        1,
                        1
                    ],
                    'helper'
                ]],
            Y: [[
                    new THREE.Line(lineGeometry, matHelper.clone()),
                    [
                        0,
                        -1000,
                        0
                    ],
                    [
                        0,
                        0,
                        Math.PI / 2
                    ],
                    [
                        1000000,
                        1,
                        1
                    ],
                    'helper'
                ]],
            Z: [[
                    new THREE.Line(lineGeometry, matHelper.clone()),
                    [
                        0,
                        0,
                        -1000
                    ],
                    [
                        0,
                        -Math.PI / 2,
                        0
                    ],
                    [
                        1000000,
                        1,
                        1
                    ],
                    'helper'
                ]]
        };
        var setupGizmo = function (gizmoMap) {
            var gizmo = new THREE.Object3D();
            for (var name in gizmoMap) {
                for (var i = gizmoMap[name].length; i--;) {
                    var object = gizmoMap[name][i][0].clone();
                    var position = gizmoMap[name][i][1];
                    var rotation = gizmoMap[name][i][2];
                    var scale = gizmoMap[name][i][3];
                    var tag = gizmoMap[name][i][4];
                    object.name = name;
                    object.tag = tag;
                    if (position) {
                        object.position.set(position[0], position[1], position[2]);
                    }
                    if (rotation) {
                        object.rotation.set(rotation[0], rotation[1], rotation[2]);
                    }
                    if (scale) {
                        object.scale.set(scale[0], scale[1], scale[2]);
                    }
                    object.updateMatrix();
                    var tempGeometry = object.geometry.clone();
                    tempGeometry.applyMatrix4(object.matrix);
                    object.geometry = tempGeometry;
                    object.renderOrder = Infinity;
                    object.position.set(0, 0, 0);
                    object.rotation.set(0, 0, 0);
                    object.scale.set(1, 1, 1);
                    gizmo.add(object);
                }
            }
            return gizmo;
        };
        var tempVector = new THREE.Vector3(0, 0, 0);
        var tempEuler = new THREE.Euler();
        var alignVector = new THREE.Vector3(0, 1, 0);
        var zeroVector = new THREE.Vector3(0, 0, 0);
        var lookAtMatrix = new THREE.Matrix4();
        var tempQuaternion = new THREE.Quaternion();
        var tempQuaternion2 = new THREE.Quaternion();
        var identityQuaternion = new THREE.Quaternion();
        var unitX = new THREE.Vector3(1, 0, 0);
        var unitY = new THREE.Vector3(0, 1, 0);
        var unitZ = new THREE.Vector3(0, 0, 1);
        this.gizmo = {};
        this.picker = {};
        this.helper = {};
        this.add(this.gizmo['translate'] = setupGizmo(gizmoTranslate));
        this.add(this.gizmo['rotate'] = setupGizmo(gizmoRotate));
        this.add(this.gizmo['scale'] = setupGizmo(gizmoScale));
        this.add(this.picker['translate'] = setupGizmo(pickerTranslate));
        this.add(this.picker['rotate'] = setupGizmo(pickerRotate));
        this.add(this.picker['scale'] = setupGizmo(pickerScale));
        this.add(this.helper['translate'] = setupGizmo(helperTranslate));
        this.add(this.helper['rotate'] = setupGizmo(helperRotate));
        this.add(this.helper['scale'] = setupGizmo(helperScale));
        this.picker['translate'].visible = false;
        this.picker['rotate'].visible = false;
        this.picker['scale'].visible = false;
        this.updateMatrixWorld = function () {
            var space = this.space;
            if (this.mode === 'scale')
                space = 'local';
            var quaternion = space === 'local' ? this.worldQuaternion : identityQuaternion;
            this.gizmo['translate'].visible = this.mode === 'translate';
            this.gizmo['rotate'].visible = this.mode === 'rotate';
            this.gizmo['scale'].visible = this.mode === 'scale';
            this.helper['translate'].visible = this.mode === 'translate';
            this.helper['rotate'].visible = this.mode === 'rotate';
            this.helper['scale'].visible = this.mode === 'scale';
            var handles = [];
            handles = handles.concat(this.picker[this.mode].children);
            handles = handles.concat(this.gizmo[this.mode].children);
            handles = handles.concat(this.helper[this.mode].children);
            for (var i = 0; i < handles.length; i++) {
                var handle = handles[i];
                handle.visible = true;
                handle.rotation.set(0, 0, 0);
                handle.position.copy(this.worldPosition);
                var eyeDistance = this.worldPosition.distanceTo(this.cameraPosition);
                handle.scale.set(1, 1, 1).multiplyScalar(eyeDistance * this.size / 7);
                if (handle.tag === 'helper') {
                    handle.visible = false;
                    if (handle.name === 'AXIS') {
                        handle.position.copy(this.worldPositionStart);
                        handle.visible = !!this.axis;
                        if (this.axis === 'X') {
                            tempQuaternion.setFromEuler(tempEuler.set(0, 0, 0));
                            handle.quaternion.copy(quaternion).multiply(tempQuaternion);
                            if (Math.abs(alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {
                                handle.visible = false;
                            }
                        }
                        if (this.axis === 'Y') {
                            tempQuaternion.setFromEuler(tempEuler.set(0, 0, Math.PI / 2));
                            handle.quaternion.copy(quaternion).multiply(tempQuaternion);
                            if (Math.abs(alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {
                                handle.visible = false;
                            }
                        }
                        if (this.axis === 'Z') {
                            tempQuaternion.setFromEuler(tempEuler.set(0, Math.PI / 2, 0));
                            handle.quaternion.copy(quaternion).multiply(tempQuaternion);
                            if (Math.abs(alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {
                                handle.visible = false;
                            }
                        }
                        if (this.axis === 'XYZE') {
                            tempQuaternion.setFromEuler(tempEuler.set(0, Math.PI / 2, 0));
                            alignVector.copy(this.rotationAxis);
                            handle.quaternion.setFromRotationMatrix(lookAtMatrix.lookAt(zeroVector, alignVector, unitY));
                            handle.quaternion.multiply(tempQuaternion);
                            handle.visible = this.dragging;
                        }
                        if (this.axis === 'E') {
                            handle.visible = false;
                        }
                    } else if (handle.name === 'START') {
                        handle.position.copy(this.worldPositionStart);
                        handle.visible = this.dragging;
                    } else if (handle.name === 'END') {
                        handle.position.copy(this.worldPosition);
                        handle.visible = this.dragging;
                    } else if (handle.name === 'DELTA') {
                        handle.position.copy(this.worldPositionStart);
                        handle.quaternion.copy(this.worldQuaternionStart);
                        tempVector.set(1e-10, 1e-10, 1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1);
                        tempVector.applyQuaternion(this.worldQuaternionStart.clone().inverse());
                        handle.scale.copy(tempVector);
                        handle.visible = this.dragging;
                    } else {
                        handle.quaternion.copy(quaternion);
                        if (this.dragging) {
                            handle.position.copy(this.worldPositionStart);
                        } else {
                            handle.position.copy(this.worldPosition);
                        }
                        if (this.axis) {
                            handle.visible = this.axis.search(handle.name) !== -1;
                        }
                    }
                    continue;
                }
                handle.quaternion.copy(quaternion);
                if (this.mode === 'translate' || this.mode === 'scale') {
                    var AXIS_HIDE_TRESHOLD = 0.99;
                    var PLANE_HIDE_TRESHOLD = 0.2;
                    var AXIS_FLIP_TRESHOLD = 0;
                    if (handle.name === 'X' || handle.name === 'XYZX') {
                        if (Math.abs(alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {
                            handle.scale.set(1e-10, 1e-10, 1e-10);
                            handle.visible = false;
                        }
                    }
                    if (handle.name === 'Y' || handle.name === 'XYZY') {
                        if (Math.abs(alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {
                            handle.scale.set(1e-10, 1e-10, 1e-10);
                            handle.visible = false;
                        }
                    }
                    if (handle.name === 'Z' || handle.name === 'XYZZ') {
                        if (Math.abs(alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {
                            handle.scale.set(1e-10, 1e-10, 1e-10);
                            handle.visible = false;
                        }
                    }
                    if (handle.name === 'XY') {
                        if (Math.abs(alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {
                            handle.scale.set(1e-10, 1e-10, 1e-10);
                            handle.visible = false;
                        }
                    }
                    if (handle.name === 'YZ') {
                        if (Math.abs(alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {
                            handle.scale.set(1e-10, 1e-10, 1e-10);
                            handle.visible = false;
                        }
                    }
                    if (handle.name === 'XZ') {
                        if (Math.abs(alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {
                            handle.scale.set(1e-10, 1e-10, 1e-10);
                            handle.visible = false;
                        }
                    }
                    if (handle.name.search('X') !== -1) {
                        if (alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {
                            if (handle.tag === 'fwd') {
                                handle.visible = false;
                            } else {
                                handle.scale.x *= -1;
                            }
                        } else if (handle.tag === 'bwd') {
                            handle.visible = false;
                        }
                    }
                    if (handle.name.search('Y') !== -1) {
                        if (alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {
                            if (handle.tag === 'fwd') {
                                handle.visible = false;
                            } else {
                                handle.scale.y *= -1;
                            }
                        } else if (handle.tag === 'bwd') {
                            handle.visible = false;
                        }
                    }
                    if (handle.name.search('Z') !== -1) {
                        if (alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {
                            if (handle.tag === 'fwd') {
                                handle.visible = false;
                            } else {
                                handle.scale.z *= -1;
                            }
                        } else if (handle.tag === 'bwd') {
                            handle.visible = false;
                        }
                    }
                } else if (this.mode === 'rotate') {
                    tempQuaternion2.copy(quaternion);
                    alignVector.copy(this.eye).applyQuaternion(tempQuaternion.copy(quaternion).inverse());
                    if (handle.name.search('E') !== -1) {
                        handle.quaternion.setFromRotationMatrix(lookAtMatrix.lookAt(this.eye, zeroVector, unitY));
                    }
                    if (handle.name === 'X') {
                        tempQuaternion.setFromAxisAngle(unitX, Math.atan2(-alignVector.y, alignVector.z));
                        tempQuaternion.multiplyQuaternions(tempQuaternion2, tempQuaternion);
                        handle.quaternion.copy(tempQuaternion);
                    }
                    if (handle.name === 'Y') {
                        tempQuaternion.setFromAxisAngle(unitY, Math.atan2(alignVector.x, alignVector.z));
                        tempQuaternion.multiplyQuaternions(tempQuaternion2, tempQuaternion);
                        handle.quaternion.copy(tempQuaternion);
                    }
                    if (handle.name === 'Z') {
                        tempQuaternion.setFromAxisAngle(unitZ, Math.atan2(alignVector.y, alignVector.x));
                        tempQuaternion.multiplyQuaternions(tempQuaternion2, tempQuaternion);
                        handle.quaternion.copy(tempQuaternion);
                    }
                }
                handle.visible = handle.visible && (handle.name.indexOf('X') === -1 || this.showX);
                handle.visible = handle.visible && (handle.name.indexOf('Y') === -1 || this.showY);
                handle.visible = handle.visible && (handle.name.indexOf('Z') === -1 || this.showZ);
                handle.visible = handle.visible && (handle.name.indexOf('E') === -1 || this.showX && this.showY && this.showZ);
                handle.material._opacity = handle.material._opacity || handle.material.opacity;
                handle.material._color = handle.material._color || handle.material.color.clone();
                handle.material.color.copy(handle.material._color);
                handle.material.opacity = handle.material._opacity;
                if (!this.enabled) {
                    handle.material.opacity *= 0.5;
                    handle.material.color.lerp(new THREE.Color(1, 1, 1), 0.5);
                } else if (this.axis) {
                    if (handle.name === this.axis) {
                        handle.material.opacity = 1;
                        handle.material.color.lerp(new THREE.Color(1, 1, 1), 0.5);
                    } else if (this.axis.split('').some(function (THREE) {
                            return handle.name === THREE;
                        })) {
                        handle.material.opacity = 1;
                        handle.material.color.lerp(new THREE.Color(1, 1, 1), 0.5);
                    } else {
                        handle.material.opacity *= 0.25;
                        handle.material.color.lerp(new THREE.Color(1, 1, 1), 0.5);
                    }
                }
            }
            THREE.Object3D.prototype.updateMatrixWorld.call(this);
        };
    };
    TransformControlsGizmo.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
        constructor: TransformControlsGizmo,
        isTransformControlsGizmo: true
    });
 
    return  threex.controls.TransformControlsGizmo = TransformControlsGizmo;
});
define('skylark-threejs-ex/controls/TransformControlsPlane',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';

    var TransformControlsPlane = function () {
        'use strict';
        THREE.Mesh.call(this, new THREE.PlaneBufferGeometry(100000, 100000, 2, 2), new THREE.MeshBasicMaterial({
            visible: false,
            wireframe: true,
            side: THREE.DoubleSide,
            transparent: true,
            opacity: 0.1
        }));
        this.type = 'TransformControlsPlane';
        var unitX = new THREE.Vector3(1, 0, 0);
        var unitY = new THREE.Vector3(0, 1, 0);
        var unitZ = new THREE.Vector3(0, 0, 1);
        var tempVector = new THREE.Vector3();
        var dirVector = new THREE.Vector3();
        var alignVector = new THREE.Vector3();
        var tempMatrix = new THREE.Matrix4();
        var identityQuaternion = new THREE.Quaternion();
        this.updateMatrixWorld = function () {
            var space = this.space;
            this.position.copy(this.worldPosition);
            if (this.mode === 'scale')
                space = 'local';
            unitX.set(1, 0, 0).applyQuaternion(space === 'local' ? this.worldQuaternion : identityQuaternion);
            unitY.set(0, 1, 0).applyQuaternion(space === 'local' ? this.worldQuaternion : identityQuaternion);
            unitZ.set(0, 0, 1).applyQuaternion(space === 'local' ? this.worldQuaternion : identityQuaternion);
            alignVector.copy(unitY);
            switch (this.mode) {
            case 'translate':
            case 'scale':
                switch (this.axis) {
                case 'X':
                    alignVector.copy(this.eye).cross(unitX);
                    dirVector.copy(unitX).cross(alignVector);
                    break;
                case 'Y':
                    alignVector.copy(this.eye).cross(unitY);
                    dirVector.copy(unitY).cross(alignVector);
                    break;
                case 'Z':
                    alignVector.copy(this.eye).cross(unitZ);
                    dirVector.copy(unitZ).cross(alignVector);
                    break;
                case 'XY':
                    dirVector.copy(unitZ);
                    break;
                case 'YZ':
                    dirVector.copy(unitX);
                    break;
                case 'XZ':
                    alignVector.copy(unitZ);
                    dirVector.copy(unitY);
                    break;
                case 'XYZ':
                case 'E':
                    dirVector.set(0, 0, 0);
                    break;
                }
                break;
            case 'rotate':
            default:
                dirVector.set(0, 0, 0);
            }
            if (dirVector.length() === 0) {
                this.quaternion.copy(this.cameraQuaternion);
            } else {
                tempMatrix.lookAt(tempVector.set(0, 0, 0), dirVector, alignVector);
                this.quaternion.setFromRotationMatrix(tempMatrix);
            }
            THREE.Object3D.prototype.updateMatrixWorld.call(this);
        };
    };
    TransformControlsPlane.prototype = Object.assign(Object.create(THREE.Mesh.prototype), {
        constructor: TransformControlsPlane,
        isTransformControlsPlane: true
    });
    
    return  threex.controls.TransformControlsPlane = TransformControlsPlane;
});
define('skylark-threejs-ex/csm/Frustum',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    const inverseProjectionMatrix = new THREE.Matrix4();
    class Frustum {
        constructor(data) {
            data = data || {};
            this.vertices = {
                near: [
                    new THREE.Vector3(),
                    new THREE.Vector3(),
                    new THREE.Vector3(),
                    new THREE.Vector3()
                ],
                far: [
                    new THREE.Vector3(),
                    new THREE.Vector3(),
                    new THREE.Vector3(),
                    new THREE.Vector3()
                ]
            };
            if (data.projectionMatrix !== undefined) {
                this.setFromProjectionMatrix(data.projectionMatrix, data.maxFar || 10000);
            }
        }
        setFromProjectionMatrix(projectionMatrix, maxFar) {
            const isOrthographic = projectionMatrix.elements[2 * 4 + 3] === 0;
            inverseProjectionMatrix.getInverse(projectionMatrix);
            this.vertices.near[0].set(1, 1, -1);
            this.vertices.near[1].set(1, -1, -1);
            this.vertices.near[2].set(-1, -1, -1);
            this.vertices.near[3].set(-1, 1, -1);
            this.vertices.near.forEach(function (v) {
                v.applyMatrix4(inverseProjectionMatrix);
            });
            this.vertices.far[0].set(1, 1, 1);
            this.vertices.far[1].set(1, -1, 1);
            this.vertices.far[2].set(-1, -1, 1);
            this.vertices.far[3].set(-1, 1, 1);
            this.vertices.far.forEach(function (v) {
                v.applyMatrix4(inverseProjectionMatrix);
                const absZ = Math.abs(v.z);
                if (isOrthographic) {
                    v.z *= Math.min(maxFar / absZ, 1);
                } else {
                    v.multiplyScalar(Math.min(maxFar / absZ, 1));
                }
            });
            return this.vertices;
        }
        split(breaks, target) {
            while (breaks.length > target.length) {
                target.push(new Frustum());
            }
            target.length = breaks.length;
            for (let i = 0; i < breaks.length; i++) {
                const cascade = target[i];
                if (i === 0) {
                    for (let j = 0; j < 4; j++) {
                        cascade.vertices.near[j].copy(this.vertices.near[j]);
                    }
                } else {
                    for (let j = 0; j < 4; j++) {
                        cascade.vertices.near[j].lerpVectors(this.vertices.near[j], this.vertices.far[j], breaks[i - 1]);
                    }
                }
                if (i === breaks - 1) {
                    for (let j = 0; j < 4; j++) {
                        cascade.vertices.far[j].copy(this.vertices.far[j]);
                    }
                } else {
                    for (let j = 0; j < 4; j++) {
                        cascade.vertices.far[j].lerpVectors(this.vertices.near[j], this.vertices.far[j], breaks[i]);
                    }
                }
            }
        }
        toSpace(cameraMatrix, target) {
            for (var i = 0; i < 4; i++) {
                target.vertices.near[i].copy(this.vertices.near[i]).applyMatrix4(cameraMatrix);
                target.vertices.far[i].copy(this.vertices.far[i]).applyMatrix4(cameraMatrix);
            }
        }
    };

    return threex.csm.Frustum = Frustum;
});
define('skylark-threejs-ex/csm/Shader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    return threex.csm.Shader = {
        lights_fragment_begin: `
GeometricContext geometry;

geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

#ifdef CLEARCOAT

	geometry.clearcoatNormal = clearcoatNormal;

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointDirectLightIrradiance( pointLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotDirectLightIrradiance( spotLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0) && defined( RE_Direct ) && defined( USE_CSM ) && defined( CSM_CASCADES )

	DirectionalLight directionalLight;
	float linearDepth = (vViewPosition.z) / (shadowFar - cameraNear);
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#if defined( USE_SHADOWMAP ) && defined( CSM_FADE )
	vec2 cascade;
	float cascadeCenter;
	float closestEdge;
	float margin;
	float csmx;
	float csmy;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );

		// NOTE: Depth gets larger away from the camera.
		// cascade.x is closer, cascade.y is further
		cascade = CSM_cascades[ i ];
		cascadeCenter = ( cascade.x + cascade.y ) / 2.0;
		closestEdge = linearDepth < cascadeCenter ? cascade.x : cascade.y;
		margin = 0.25 * pow( closestEdge, 2.0 );
		csmx = cascade.x - margin / 2.0;
		csmy = cascade.y + margin / 2.0;
		if( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS && linearDepth >= csmx && ( linearDepth < csmy || UNROLLED_LOOP_INDEX == CSM_CASCADES - 1 ) ) {

			float dist = min( linearDepth - csmx, csmy - linearDepth );
			float ratio = clamp( dist / margin, 0.0, 1.0 );
			if( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS ) {

				vec3 prevColor = directLight.color;
				directionalLightShadow = directionalLightShadows[ i ];
				directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

				bool shouldFadeLastCascade = UNROLLED_LOOP_INDEX == CSM_CASCADES - 1 && linearDepth > cascadeCenter;
				directLight.color = mix( prevColor, directLight.color, shouldFadeLastCascade ? ratio : 1.0 );

			}

			ReflectedLight prevLight = reflectedLight;
			RE_Direct( directLight, geometry, material, reflectedLight );

			bool shouldBlend = UNROLLED_LOOP_INDEX != CSM_CASCADES - 1 || UNROLLED_LOOP_INDEX == CSM_CASCADES - 1 && linearDepth < cascadeCenter;
			float blendRatio = shouldBlend ? ratio : 1.0;

			reflectedLight.directDiffuse = mix( prevLight.directDiffuse, reflectedLight.directDiffuse, blendRatio );
			reflectedLight.directSpecular = mix( prevLight.directSpecular, reflectedLight.directSpecular, blendRatio );
			reflectedLight.indirectDiffuse = mix( prevLight.indirectDiffuse, reflectedLight.indirectDiffuse, blendRatio );
			reflectedLight.indirectSpecular = mix( prevLight.indirectSpecular, reflectedLight.indirectSpecular, blendRatio );

		}

	}
	#pragma unroll_loop_end
	#else

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )

		directionalLightShadow = directionalLightShadows[ i ];
		if(linearDepth >= CSM_cascades[UNROLLED_LOOP_INDEX].x && linearDepth < CSM_cascades[UNROLLED_LOOP_INDEX].y) directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

		#endif

		if(linearDepth >= CSM_cascades[UNROLLED_LOOP_INDEX].x && (linearDepth < CSM_cascades[UNROLLED_LOOP_INDEX].y || UNROLLED_LOOP_INDEX == CSM_CASCADES - 1)) RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

	#endif

#endif


#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct ) && !defined( USE_CSM ) && !defined( CSM_CASCADES )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	irradiance += getLightProbeIrradiance( lightProbe, geometry );

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`,
        lights_pars_begin: `
#if defined( USE_CSM ) && defined( CSM_CASCADES )
uniform vec2 CSM_cascades[CSM_CASCADES];
uniform float cameraNear;
uniform float shadowFar;
#endif
	` + THREE.ShaderChunk.lights_pars_begin
    };
});
define('skylark-threejs-ex/csm/CSM',[
    "skylark-threejs",
    "../threex",
    './Frustum',
    './Shader'
], function (
    THREE,
    threex,
    Frustum, 
    Shader
) {
    'use strict';
    const _cameraToLightMatrix = new THREE.Matrix4();
    const _lightSpaceFrustum = new Frustum();
    const _center = new THREE.Vector3();
    const _bbox = new THREE.Box3();
    const _uniformArray = [];
    const _logArray = [];
    class CSM {
        constructor(data) {
            data = data || {};
            this.camera = data.camera;
            this.parent = data.parent;
            this.cascades = data.cascades || 3;
            this.maxFar = data.maxFar || 100000;
            this.mode = data.mode || 'practical';
            this.shadowMapSize = data.shadowMapSize || 2048;
            this.shadowBias = data.shadowBias || 0.000001;
            this.lightDirection = data.lightDirection || new THREE.Vector3(1, -1, 1).normalize();
            this.lightIntensity = data.lightIntensity || 1;
            this.lightNear = data.lightNear || 1;
            this.lightFar = data.lightFar || 2000;
            this.lightMargin = data.lightMargin || 200;
            this.customSplitsCallback = data.customSplitsCallback;
            this.fade = false;
            this.mainFrustum = new Frustum();
            this.frustums = [];
            this.breaks = [];
            this.lights = [];
            this.shaders = new Map();
            this.createLights();
            this.updateFrustums();
            this.injectInclude();
        }
        createLights() {
            for (let i = 0; i < this.cascades; i++) {
                const light = new THREE.DirectionalLight(16777215, this.lightIntensity);
                light.castShadow = true;
                light.shadow.mapSize.width = this.shadowMapSize;
                light.shadow.mapSize.height = this.shadowMapSize;
                light.shadow.camera.near = this.lightNear;
                light.shadow.camera.far = this.lightFar;
                light.shadow.bias = this.shadowBias;
                this.parent.add(light);
                this.parent.add(light.target);
                this.lights.push(light);
            }
        }
        initCascades() {
            const camera = this.camera;
            camera.updateProjectionMatrix();
            this.mainFrustum.setFromProjectionMatrix(camera.projectionMatrix, this.maxFar);
            this.mainFrustum.split(this.breaks, this.frustums);
        }
        updateShadowBounds() {
            const frustums = this.frustums;
            for (let i = 0; i < frustums.length; i++) {
                const light = this.lights[i];
                const shadowCam = light.shadow.camera;
                const frustum = this.frustums[i];
                const nearVerts = frustum.vertices.near;
                const farVerts = frustum.vertices.far;
                const point1 = farVerts[0];
                let point2;
                if (point1.distanceTo(farVerts[2]) > point1.distanceTo(nearVerts[2])) {
                    point2 = farVerts[2];
                } else {
                    point2 = nearVerts[2];
                }
                let squaredBBWidth = point1.distanceTo(point2);
                if (this.fade) {
                    const camera = this.camera;
                    const far = Math.max(camera.far, this.maxFar);
                    const linearDepth = frustum.vertices.far[0].z / (far - camera.near);
                    const margin = 0.25 * Math.pow(linearDepth, 2) * (far - camera.near);
                    squaredBBWidth += margin;
                }
                shadowCam.left = -squaredBBWidth / 2;
                shadowCam.right = squaredBBWidth / 2;
                shadowCam.top = squaredBBWidth / 2;
                shadowCam.bottom = -squaredBBWidth / 2;
                shadowCam.updateProjectionMatrix();
            }
        }
        getBreaks() {
            const camera = this.camera;
            const far = Math.min(camera.far, this.maxFar);
            this.breaks.length = 0;
            switch (this.mode) {
            case 'uniform':
                uniformSplit(this.cascades, camera.near, far, this.breaks);
                break;
            case 'logarithmic':
                logarithmicSplit(this.cascades, camera.near, far, this.breaks);
                break;
            case 'practical':
                practicalSplit(this.cascades, camera.near, far, 0.5, this.breaks);
                break;
            case 'custom':
                if (this.customSplitsCallback === undefined)
                    console.error('CSM: Custom split scheme callback not defined.');
                this.customSplitsCallback(this.cascades, camera.near, far, this.breaks);
                break;
            }
            function uniformSplit(amount, near, far, target) {
                for (let i = 1; i < amount; i++) {
                    target.push((near + (far - near) * i / amount) / far);
                }
                target.push(1);
            }
            function logarithmicSplit(amount, near, far, target) {
                for (let i = 1; i < amount; i++) {
                    target.push(near * (far / near) ** (i / amount) / far);
                }
                target.push(1);
            }
            function practicalSplit(amount, near, far, lambda, target) {
                _uniformArray.length = 0;
                _logArray.length = 0;
                logarithmicSplit(amount, near, far, _logArray);
                uniformSplit(amount, near, far, _uniformArray);
                for (let i = 1; i < amount; i++) {
                    target.push(THREE.MathUtils.lerp(_uniformArray[i - 1], _logArray[i - 1], lambda));
                }
                target.push(1);
            }
        }
        update() {
            const camera = this.camera;
            const frustums = this.frustums;
            for (let i = 0; i < frustums.length; i++) {
                const light = this.lights[i];
                const shadowCam = light.shadow.camera;
                const texelWidth = (shadowCam.right - shadowCam.left) / this.shadowMapSize;
                const texelHeight = (shadowCam.top - shadowCam.bottom) / this.shadowMapSize;
                light.shadow.camera.updateMatrixWorld(true);
                _cameraToLightMatrix.multiplyMatrices(light.shadow.camera.matrixWorldInverse, camera.matrixWorld);
                frustums[i].toSpace(_cameraToLightMatrix, _lightSpaceFrustum);
                const nearVerts = _lightSpaceFrustum.vertices.near;
                const farVerts = _lightSpaceFrustum.vertices.far;
                _bbox.makeEmpty();
                for (let j = 0; j < 4; j++) {
                    _bbox.expandByPoint(nearVerts[j]);
                    _bbox.expandByPoint(farVerts[j]);
                }
                _bbox.getCenter(_center);
                _center.z = _bbox.max.z + this.lightMargin;
                _center.x = Math.floor(_center.x / texelWidth) * texelWidth;
                _center.y = Math.floor(_center.y / texelHeight) * texelHeight;
                _center.applyMatrix4(light.shadow.camera.matrixWorld);
                light.position.copy(_center);
                light.target.position.copy(_center);
                light.target.position.x += this.lightDirection.x;
                light.target.position.y += this.lightDirection.y;
                light.target.position.z += this.lightDirection.z;
            }
        }
        injectInclude() {
            THREE.ShaderChunk.lights_fragment_begin = Shader.lights_fragment_begin;
            THREE.ShaderChunk.lights_pars_begin = Shader.lights_pars_begin;
        }
        setupMaterial(material) {
            material.defines = material.defines || {};
            material.defines.USE_CSM = 1;
            material.defines.CSM_CASCADES = this.cascades;
            if (this.fade) {
                material.defines.CSM_FADE = '';
            }
            const breaksVec2 = [];
            const self = this;
            const shaders = this.shaders;
            material.onBeforeCompile = function (shader) {
                const far = Math.min(self.camera.far, self.maxFar);
                self.getExtendedBreaks(breaksVec2);
                shader.uniforms.CSM_cascades = { value: breaksVec2 };
                shader.uniforms.cameraNear = { value: self.camera.near };
                shader.uniforms.shadowFar = { value: far };
                shaders.set(material, shader);
            };
            shaders.set(material, null);
        }
        updateUniforms() {
            const far = Math.min(this.camera.far, this.maxFar);
            const shaders = this.shaders;
            shaders.forEach(function (shader, material) {
                if (shader !== null) {
                    const uniforms = shader.uniforms;
                    this.getExtendedBreaks(uniforms.CSM_cascades.value);
                    uniforms.cameraNear.value = this.camera.near;
                    uniforms.shadowFar.value = far;
                }
                if (!this.fade && 'CSM_FADE' in material.defines) {
                    delete material.defines.CSM_FADE;
                    material.needsUpdate = true;
                } else if (this.fade && !('CSM_FADE' in material.defines)) {
                    material.defines.CSM_FADE = '';
                    material.needsUpdate = true;
                }
            }, this);
        }
        getExtendedBreaks(target) {
            while (target.length < this.breaks.length) {
                target.push(new THREE.Vector2());
            }
            target.length = this.breaks.length;
            for (let i = 0; i < this.cascades; i++) {
                let amount = this.breaks[i];
                let prev = this.breaks[i - 1] || 0;
                target[i].x = prev;
                target[i].y = amount;
            }
        }
        updateFrustums() {
            this.getBreaks();
            this.initCascades();
            this.updateShadowBounds();
            this.updateUniforms();
        }
        remove() {
            for (let i = 0; i < this.lights.length; i++) {
                this.parent.remove(this.lights[i]);
            }
        }
        dispose() {
            const shaders = this.shaders;
            shaders.forEach(function (shader, material) {
                delete material.onBeforeCompile;
                delete material.defines.USE_CSM;
                delete material.defines.CSM_CASCADES;
                delete material.defines.CSM_FADE;
                if (shader !== null) {
                    delete shader.uniforms.CSM_cascades;
                    delete shader.uniforms.cameraNear;
                    delete shader.uniforms.shadowFar;
                }
                material.needsUpdate = true;
            });
            shaders.clear();
        }
    }
    return threex.csm.CSM = CSM;
});
define('skylark-threejs-ex/csm/CSMHelper',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    class CSMHelper extends THREE.Group {
        constructor(csm) {
            super();
            this.csm = csm;
            this.displayFrustum = true;
            this.displayPlanes = true;
            this.displayShadowBounds = true;
            const indices = new Uint16Array([
                0,
                1,
                1,
                2,
                2,
                3,
                3,
                0,
                4,
                5,
                5,
                6,
                6,
                7,
                7,
                4,
                0,
                4,
                1,
                5,
                2,
                6,
                3,
                7
            ]);
            const positions = new Float32Array(24);
            const frustumGeometry = new THREE.BufferGeometry();
            frustumGeometry.setIndex(new THREE.BufferAttribute(indices, 1));
            frustumGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3, false));
            const frustumLines = new THREE.LineSegments(frustumGeometry, new THREE.LineBasicMaterial());
            this.add(frustumLines);
            this.frustumLines = frustumLines;
            this.cascadeLines = [];
            this.cascadePlanes = [];
            this.shadowLines = [];
        }
        updateVisibility() {
            const displayFrustum = this.displayFrustum;
            const displayPlanes = this.displayPlanes;
            const displayShadowBounds = this.displayShadowBounds;
            const frustumLines = this.frustumLines;
            const cascadeLines = this.cascadeLines;
            const cascadePlanes = this.cascadePlanes;
            const shadowLines = this.shadowLines;
            for (let i = 0, l = cascadeLines.length; i < l; i++) {
                const cascadeLine = cascadeLines[i];
                const cascadePlane = cascadePlanes[i];
                const shadowLineGroup = shadowLines[i];
                cascadeLine.visible = displayFrustum;
                cascadePlane.visible = displayFrustum && displayPlanes;
                shadowLineGroup.visible = displayShadowBounds;
            }
            frustumLines.visible = displayFrustum;
        }
        update() {
            const csm = this.csm;
            const camera = csm.camera;
            const cascades = csm.cascades;
            const mainFrustum = csm.mainFrustum;
            const frustums = csm.frustums;
            const lights = csm.lights;
            const frustumLines = this.frustumLines;
            const frustumLinePositions = frustumLines.geometry.getAttribute('position');
            const cascadeLines = this.cascadeLines;
            const cascadePlanes = this.cascadePlanes;
            const shadowLines = this.shadowLines;
            this.position.copy(camera.position);
            this.quaternion.copy(camera.quaternion);
            this.scale.copy(camera.scale);
            this.updateMatrixWorld(true);
            while (cascadeLines.length > cascades) {
                this.remove(cascadeLines.pop());
                this.remove(cascadePlanes.pop());
                this.remove(shadowLines.pop());
            }
            while (cascadeLines.length < cascades) {
                const cascadeLine = new THREE.Box3Helper(new THREE.Box3(), 16777215);
                const planeMat = new THREE.MeshBasicMaterial({
                    transparent: true,
                    opacity: 0.1,
                    depthWrite: false,
                    side: THREE.DoubleSide
                });
                const cascadePlane = new THREE.Mesh(new THREE.PlaneBufferGeometry(), planeMat);
                const shadowLineGroup = new THREE.Group();
                const shadowLine = new THREE.Box3Helper(new THREE.Box3(), 16776960);
                shadowLineGroup.add(shadowLine);
                this.add(cascadeLine);
                this.add(cascadePlane);
                this.add(shadowLineGroup);
                cascadeLines.push(cascadeLine);
                cascadePlanes.push(cascadePlane);
                shadowLines.push(shadowLineGroup);
            }
            for (let i = 0; i < cascades; i++) {
                const frustum = frustums[i];
                const light = lights[i];
                const shadowCam = light.shadow.camera;
                const farVerts = frustum.vertices.far;
                const cascadeLine = cascadeLines[i];
                const cascadePlane = cascadePlanes[i];
                const shadowLineGroup = shadowLines[i];
                const shadowLine = shadowLineGroup.children[0];
                cascadeLine.box.min.copy(farVerts[2]);
                cascadeLine.box.max.copy(farVerts[0]);
                cascadeLine.box.max.z += 0.0001;
                cascadePlane.position.addVectors(farVerts[0], farVerts[2]);
                cascadePlane.position.multiplyScalar(0.5);
                cascadePlane.scale.subVectors(farVerts[0], farVerts[2]);
                cascadePlane.scale.z = 0.0001;
                this.remove(shadowLineGroup);
                shadowLineGroup.position.copy(shadowCam.position);
                shadowLineGroup.quaternion.copy(shadowCam.quaternion);
                shadowLineGroup.scale.copy(shadowCam.scale);
                shadowLineGroup.updateMatrixWorld(true);
                this.attach(shadowLineGroup);
                shadowLine.box.min.set(shadowCam.bottom, shadowCam.left, -shadowCam.far);
                shadowLine.box.max.set(shadowCam.top, shadowCam.right, -shadowCam.near);
            }
            const nearVerts = mainFrustum.vertices.near;
            const farVerts = mainFrustum.vertices.far;
            frustumLinePositions.setXYZ(0, farVerts[0].x, farVerts[0].y, farVerts[0].z);
            frustumLinePositions.setXYZ(1, farVerts[3].x, farVerts[3].y, farVerts[3].z);
            frustumLinePositions.setXYZ(2, farVerts[2].x, farVerts[2].y, farVerts[2].z);
            frustumLinePositions.setXYZ(3, farVerts[1].x, farVerts[1].y, farVerts[1].z);
            frustumLinePositions.setXYZ(4, nearVerts[0].x, nearVerts[0].y, nearVerts[0].z);
            frustumLinePositions.setXYZ(5, nearVerts[3].x, nearVerts[3].y, nearVerts[3].z);
            frustumLinePositions.setXYZ(6, nearVerts[2].x, nearVerts[2].y, nearVerts[2].z);
            frustumLinePositions.setXYZ(7, nearVerts[1].x, nearVerts[1].y, nearVerts[1].z);
            frustumLinePositions.needsUpdate = true;
        }
    }

    return threex.csm.CSMHelper = CSMHelper;
});
define('skylark-threejs-ex/curves/CurveExtras',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var Curves = function () {
        function GrannyKnot() {
            THREE.Curve.call(this);
        }
        GrannyKnot.prototype = Object.create(THREE.Curve.prototype);
        GrannyKnot.prototype.constructor = GrannyKnot;
        GrannyKnot.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            t = 2 * Math.PI * t;
            var x = -0.22 * Math.cos(t) - 1.28 * Math.sin(t) - 0.44 * Math.cos(3 * t) - 0.78 * Math.sin(3 * t);
            var y = -0.1 * Math.cos(2 * t) - 0.27 * Math.sin(2 * t) + 0.38 * Math.cos(4 * t) + 0.46 * Math.sin(4 * t);
            var z = 0.7 * Math.cos(3 * t) - 0.4 * Math.sin(3 * t);
            return point.set(x, y, z).multiplyScalar(20);
        };
        function HeartCurve(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 5 : scale;
        }
        HeartCurve.prototype = Object.create(THREE.Curve.prototype);
        HeartCurve.prototype.constructor = HeartCurve;
        HeartCurve.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            t *= 2 * Math.PI;
            var x = 16 * Math.pow(Math.sin(t), 3);
            var y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
            var z = 0;
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        function VivianiCurve(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 70 : scale;
        }
        VivianiCurve.prototype = Object.create(THREE.Curve.prototype);
        VivianiCurve.prototype.constructor = VivianiCurve;
        VivianiCurve.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            t = t * 4 * Math.PI;
            var a = this.scale / 2;
            var x = a * (1 + Math.cos(t));
            var y = a * Math.sin(t);
            var z = 2 * a * Math.sin(t / 2);
            return point.set(x, y, z);
        };
        function KnotCurve() {
            THREE.Curve.call(this);
        }
        KnotCurve.prototype = Object.create(THREE.Curve.prototype);
        KnotCurve.prototype.constructor = KnotCurve;
        KnotCurve.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            t *= 2 * Math.PI;
            var R = 10;
            var s = 50;
            var x = s * Math.sin(t);
            var y = Math.cos(t) * (R + s * Math.cos(t));
            var z = Math.sin(t) * (R + s * Math.cos(t));
            return point.set(x, y, z);
        };
        function HelixCurve() {
            THREE.Curve.call(this);
        }
        HelixCurve.prototype = Object.create(THREE.Curve.prototype);
        HelixCurve.prototype.constructor = HelixCurve;
        HelixCurve.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            var a = 30;
            var b = 150;
            var t2 = 2 * Math.PI * t * b / 30;
            var x = Math.cos(t2) * a;
            var y = Math.sin(t2) * a;
            var z = b * t;
            return point.set(x, y, z);
        };
        function TrefoilKnot(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 10 : scale;
        }
        TrefoilKnot.prototype = Object.create(THREE.Curve.prototype);
        TrefoilKnot.prototype.constructor = TrefoilKnot;
        TrefoilKnot.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            t *= Math.PI * 2;
            var x = (2 + Math.cos(3 * t)) * Math.cos(2 * t);
            var y = (2 + Math.cos(3 * t)) * Math.sin(2 * t);
            var z = Math.sin(3 * t);
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        function TorusKnot(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 10 : scale;
        }
        TorusKnot.prototype = Object.create(THREE.Curve.prototype);
        TorusKnot.prototype.constructor = TorusKnot;
        TorusKnot.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            var p = 3;
            var q = 4;
            t *= Math.PI * 2;
            var x = (2 + Math.cos(q * t)) * Math.cos(p * t);
            var y = (2 + Math.cos(q * t)) * Math.sin(p * t);
            var z = Math.sin(q * t);
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        function CinquefoilKnot(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 10 : scale;
        }
        CinquefoilKnot.prototype = Object.create(THREE.Curve.prototype);
        CinquefoilKnot.prototype.constructor = CinquefoilKnot;
        CinquefoilKnot.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            var p = 2;
            var q = 5;
            t *= Math.PI * 2;
            var x = (2 + Math.cos(q * t)) * Math.cos(p * t);
            var y = (2 + Math.cos(q * t)) * Math.sin(p * t);
            var z = Math.sin(q * t);
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        function TrefoilPolynomialKnot(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 10 : scale;
        }
        TrefoilPolynomialKnot.prototype = Object.create(THREE.Curve.prototype);
        TrefoilPolynomialKnot.prototype.constructor = TrefoilPolynomialKnot;
        TrefoilPolynomialKnot.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            t = t * 4 - 2;
            var x = Math.pow(t, 3) - 3 * t;
            var y = Math.pow(t, 4) - 4 * t * t;
            var z = 1 / 5 * Math.pow(t, 5) - 2 * t;
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        var scaleTo = function (x, y, t) {
            var r = y - x;
            return t * r + x;
        };
        function FigureEightPolynomialKnot(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 1 : scale;
        }
        FigureEightPolynomialKnot.prototype = Object.create(THREE.Curve.prototype);
        FigureEightPolynomialKnot.prototype.constructor = FigureEightPolynomialKnot;
        FigureEightPolynomialKnot.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            t = scaleTo(-4, 4, t);
            var x = 2 / 5 * t * (t * t - 7) * (t * t - 10);
            var y = Math.pow(t, 4) - 13 * t * t;
            var z = 1 / 10 * t * (t * t - 4) * (t * t - 9) * (t * t - 12);
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        function DecoratedTorusKnot4a(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 40 : scale;
        }
        DecoratedTorusKnot4a.prototype = Object.create(THREE.Curve.prototype);
        DecoratedTorusKnot4a.prototype.constructor = DecoratedTorusKnot4a;
        DecoratedTorusKnot4a.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            t *= Math.PI * 2;
            var x = Math.cos(2 * t) * (1 + 0.6 * (Math.cos(5 * t) + 0.75 * Math.cos(10 * t)));
            var y = Math.sin(2 * t) * (1 + 0.6 * (Math.cos(5 * t) + 0.75 * Math.cos(10 * t)));
            var z = 0.35 * Math.sin(5 * t);
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        function DecoratedTorusKnot4b(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 40 : scale;
        }
        DecoratedTorusKnot4b.prototype = Object.create(THREE.Curve.prototype);
        DecoratedTorusKnot4b.prototype.constructor = DecoratedTorusKnot4b;
        DecoratedTorusKnot4b.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            var fi = t * Math.PI * 2;
            var x = Math.cos(2 * fi) * (1 + 0.45 * Math.cos(3 * fi) + 0.4 * Math.cos(9 * fi));
            var y = Math.sin(2 * fi) * (1 + 0.45 * Math.cos(3 * fi) + 0.4 * Math.cos(9 * fi));
            var z = 0.2 * Math.sin(9 * fi);
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        function DecoratedTorusKnot5a(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 40 : scale;
        }
        DecoratedTorusKnot5a.prototype = Object.create(THREE.Curve.prototype);
        DecoratedTorusKnot5a.prototype.constructor = DecoratedTorusKnot5a;
        DecoratedTorusKnot5a.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            var fi = t * Math.PI * 2;
            var x = Math.cos(3 * fi) * (1 + 0.3 * Math.cos(5 * fi) + 0.5 * Math.cos(10 * fi));
            var y = Math.sin(3 * fi) * (1 + 0.3 * Math.cos(5 * fi) + 0.5 * Math.cos(10 * fi));
            var z = 0.2 * Math.sin(20 * fi);
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        function DecoratedTorusKnot5c(scale) {
            THREE.Curve.call(this);
            this.scale = scale === undefined ? 40 : scale;
        }
        DecoratedTorusKnot5c.prototype = Object.create(THREE.Curve.prototype);
        DecoratedTorusKnot5c.prototype.constructor = DecoratedTorusKnot5c;
        DecoratedTorusKnot5c.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            var fi = t * Math.PI * 2;
            var x = Math.cos(4 * fi) * (1 + 0.5 * (Math.cos(5 * fi) + 0.4 * Math.cos(20 * fi)));
            var y = Math.sin(4 * fi) * (1 + 0.5 * (Math.cos(5 * fi) + 0.4 * Math.cos(20 * fi)));
            var z = 0.35 * Math.sin(15 * fi);
            return point.set(x, y, z).multiplyScalar(this.scale);
        };
        return {
            GrannyKnot: GrannyKnot,
            HeartCurve: HeartCurve,
            VivianiCurve: VivianiCurve,
            KnotCurve: KnotCurve,
            HelixCurve: HelixCurve,
            TrefoilKnot: TrefoilKnot,
            TorusKnot: TorusKnot,
            CinquefoilKnot: CinquefoilKnot,
            TrefoilPolynomialKnot: TrefoilPolynomialKnot,
            FigureEightPolynomialKnot: FigureEightPolynomialKnot,
            DecoratedTorusKnot4a: DecoratedTorusKnot4a,
            DecoratedTorusKnot4b: DecoratedTorusKnot4b,
            DecoratedTorusKnot5a: DecoratedTorusKnot5a,
            DecoratedTorusKnot5c: DecoratedTorusKnot5c
        };
    }();

    return threex.curves.Curves = Curves;
});
define('skylark-threejs-ex/curves/NURBSUtils',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var NURBSUtils = {
        findSpan: function (p, u, U) {
            var n = U.length - p - 1;
            if (u >= U[n]) {
                return n - 1;
            }
            if (u <= U[p]) {
                return p;
            }
            var low = p;
            var high = n;
            var mid = Math.floor((low + high) / 2);
            while (u < U[mid] || u >= U[mid + 1]) {
                if (u < U[mid]) {
                    high = mid;
                } else {
                    low = mid;
                }
                mid = Math.floor((low + high) / 2);
            }
            return mid;
        },
        calcBasisFunctions: function (span, u, p, U) {
            var N = [];
            var left = [];
            var right = [];
            N[0] = 1;
            for (var j = 1; j <= p; ++j) {
                left[j] = u - U[span + 1 - j];
                right[j] = U[span + j] - u;
                var saved = 0;
                for (var r = 0; r < j; ++r) {
                    var rv = right[r + 1];
                    var lv = left[j - r];
                    var temp = N[r] / (rv + lv);
                    N[r] = saved + rv * temp;
                    saved = lv * temp;
                }
                N[j] = saved;
            }
            return N;
        },
        calcBSplinePoint: function (p, U, P, u) {
            var span = this.findSpan(p, u, U);
            var N = this.calcBasisFunctions(span, u, p, U);
            var C = new THREE.Vector4(0, 0, 0, 0);
            for (var j = 0; j <= p; ++j) {
                var point = P[span - p + j];
                var Nj = N[j];
                var wNj = point.w * Nj;
                C.x += point.x * wNj;
                C.y += point.y * wNj;
                C.z += point.z * wNj;
                C.w += point.w * Nj;
            }
            return C;
        },
        calcBasisFunctionDerivatives: function (span, u, p, n, U) {
            var zeroArr = [];
            for (var i = 0; i <= p; ++i)
                zeroArr[i] = 0;
            var ders = [];
            for (var i = 0; i <= n; ++i)
                ders[i] = zeroArr.slice(0);
            var ndu = [];
            for (var i = 0; i <= p; ++i)
                ndu[i] = zeroArr.slice(0);
            ndu[0][0] = 1;
            var left = zeroArr.slice(0);
            var right = zeroArr.slice(0);
            for (var j = 1; j <= p; ++j) {
                left[j] = u - U[span + 1 - j];
                right[j] = U[span + j] - u;
                var saved = 0;
                for (var r = 0; r < j; ++r) {
                    var rv = right[r + 1];
                    var lv = left[j - r];
                    ndu[j][r] = rv + lv;
                    var temp = ndu[r][j - 1] / ndu[j][r];
                    ndu[r][j] = saved + rv * temp;
                    saved = lv * temp;
                }
                ndu[j][j] = saved;
            }
            for (var j = 0; j <= p; ++j) {
                ders[0][j] = ndu[j][p];
            }
            for (var r = 0; r <= p; ++r) {
                var s1 = 0;
                var s2 = 1;
                var a = [];
                for (var i = 0; i <= p; ++i) {
                    a[i] = zeroArr.slice(0);
                }
                a[0][0] = 1;
                for (var k = 1; k <= n; ++k) {
                    var d = 0;
                    var rk = r - k;
                    var pk = p - k;
                    if (r >= k) {
                        a[s2][0] = a[s1][0] / ndu[pk + 1][rk];
                        d = a[s2][0] * ndu[rk][pk];
                    }
                    var j1 = rk >= -1 ? 1 : -rk;
                    var j2 = r - 1 <= pk ? k - 1 : p - r;
                    for (var j = j1; j <= j2; ++j) {
                        a[s2][j] = (a[s1][j] - a[s1][j - 1]) / ndu[pk + 1][rk + j];
                        d += a[s2][j] * ndu[rk + j][pk];
                    }
                    if (r <= pk) {
                        a[s2][k] = -a[s1][k - 1] / ndu[pk + 1][r];
                        d += a[s2][k] * ndu[r][pk];
                    }
                    ders[k][r] = d;
                    var j = s1;
                    s1 = s2;
                    s2 = j;
                }
            }
            var r = p;
            for (var k = 1; k <= n; ++k) {
                for (var j = 0; j <= p; ++j) {
                    ders[k][j] *= r;
                }
                r *= p - k;
            }
            return ders;
        },
        calcBSplineDerivatives: function (p, U, P, u, nd) {
            var du = nd < p ? nd : p;
            var CK = [];
            var span = this.findSpan(p, u, U);
            var nders = this.calcBasisFunctionDerivatives(span, u, p, du, U);
            var Pw = [];
            for (var i = 0; i < P.length; ++i) {
                var point = P[i].clone();
                var w = point.w;
                point.x *= w;
                point.y *= w;
                point.z *= w;
                Pw[i] = point;
            }
            for (var k = 0; k <= du; ++k) {
                var point = Pw[span - p].clone().multiplyScalar(nders[k][0]);
                for (var j = 1; j <= p; ++j) {
                    point.add(Pw[span - p + j].clone().multiplyScalar(nders[k][j]));
                }
                CK[k] = point;
            }
            for (var k = du + 1; k <= nd + 1; ++k) {
                CK[k] = new THREE.Vector4(0, 0, 0);
            }
            return CK;
        },
        calcKoverI: function (k, i) {
            var nom = 1;
            for (var j = 2; j <= k; ++j) {
                nom *= j;
            }
            var denom = 1;
            for (var j = 2; j <= i; ++j) {
                denom *= j;
            }
            for (var j = 2; j <= k - i; ++j) {
                denom *= j;
            }
            return nom / denom;
        },
        calcRationalCurveDerivatives: function (Pders) {
            var nd = Pders.length;
            var Aders = [];
            var wders = [];
            for (var i = 0; i < nd; ++i) {
                var point = Pders[i];
                Aders[i] = new THREE.Vector3(point.x, point.y, point.z);
                wders[i] = point.w;
            }
            var CK = [];
            for (var k = 0; k < nd; ++k) {
                var v = Aders[k].clone();
                for (var i = 1; i <= k; ++i) {
                    v.sub(CK[k - i].clone().multiplyScalar(this.calcKoverI(k, i) * wders[i]));
                }
                CK[k] = v.divideScalar(wders[0]);
            }
            return CK;
        },
        calcNURBSDerivatives: function (p, U, P, u, nd) {
            var Pders = this.calcBSplineDerivatives(p, U, P, u, nd);
            return this.calcRationalCurveDerivatives(Pders);
        },
        calcSurfacePoint: function (p, q, U, V, P, u, v, target) {
            var uspan = this.findSpan(p, u, U);
            var vspan = this.findSpan(q, v, V);
            var Nu = this.calcBasisFunctions(uspan, u, p, U);
            var Nv = this.calcBasisFunctions(vspan, v, q, V);
            var temp = [];
            for (var l = 0; l <= q; ++l) {
                temp[l] = new THREE.Vector4(0, 0, 0, 0);
                for (var k = 0; k <= p; ++k) {
                    var point = P[uspan - p + k][vspan - q + l].clone();
                    var w = point.w;
                    point.x *= w;
                    point.y *= w;
                    point.z *= w;
                    temp[l].add(point.multiplyScalar(Nu[k]));
                }
            }
            var Sw = new THREE.Vector4(0, 0, 0, 0);
            for (var l = 0; l <= q; ++l) {
                Sw.add(temp[l].multiplyScalar(Nv[l]));
            }
            Sw.divideScalar(Sw.w);
            target.set(Sw.x, Sw.y, Sw.z);
        }
    };
    
    return threex.curves.NURBSUtils = NURBSUtils;
});
define('skylark-threejs-ex/curves/NURBSCurve',[
    "skylark-threejs",
    "../threex",
    './NURBSUtils'
], function (
    THREE,
    threex,
    NURBSUtils
) {
    'use strict';
    var NURBSCurve = function (degree, knots, controlPoints, startKnot, endKnot) {
        THREE.Curve.call(this);
        this.degree = degree;
        this.knots = knots;
        this.controlPoints = [];
        this.startKnot = startKnot || 0;
        this.endKnot = endKnot || this.knots.length - 1;
        for (var i = 0; i < controlPoints.length; ++i) {
            var point = controlPoints[i];
            this.controlPoints[i] = new THREE.Vector4(point.x, point.y, point.z, point.w);
        }
    };
    NURBSCurve.prototype = Object.create(THREE.Curve.prototype);
    NURBSCurve.prototype.constructor = NURBSCurve;
    NURBSCurve.prototype.getPoint = function (t) {
        var u = this.knots[this.startKnot] + t * (this.knots[this.endKnot] - this.knots[this.startKnot]);
        var hpoint = NURBSUtils.calcBSplinePoint(this.degree, this.knots, this.controlPoints, u);
        if (hpoint.w != 1) {
            hpoint.divideScalar(hpoint.w);
        }
        return new THREE.Vector3(hpoint.x, hpoint.y, hpoint.z);
    };
    NURBSCurve.prototype.getTangent = function (t) {
        var u = this.knots[0] + t * (this.knots[this.knots.length - 1] - this.knots[0]);
        var ders = NURBSUtils.calcNURBSDerivatives(this.degree, this.knots, this.controlPoints, u, 1);
        var tangent = ders[1].clone();
        tangent.normalize();
        return tangent;
    };
    
    return threex.curves.NURBSCurve = NURBSCurve;
});
define('skylark-threejs-ex/curves/NURBSSurface',[
    "skylark-threejs",
    "../threex",
    './NURBSUtils'
], function (
    THREE,
    threex,
    NURBSUtils
) {
    'use strict';
    var NURBSSurface = function (degree1, degree2, knots1, knots2, controlPoints) {
        this.degree1 = degree1;
        this.degree2 = degree2;
        this.knots1 = knots1;
        this.knots2 = knots2;
        this.controlPoints = [];
        var len1 = knots1.length - degree1 - 1;
        var len2 = knots2.length - degree2 - 1;
        for (var i = 0; i < len1; ++i) {
            this.controlPoints[i] = [];
            for (var j = 0; j < len2; ++j) {
                var point = controlPoints[i][j];
                this.controlPoints[i][j] = new THREE.Vector4(point.x, point.y, point.z, point.w);
            }
        }
    };
    NURBSSurface.prototype = {
        constructor: NURBSSurface,
        getPoint: function (t1, t2, target) {
            var u = this.knots1[0] + t1 * (this.knots1[this.knots1.length - 1] - this.knots1[0]);
            var v = this.knots2[0] + t2 * (this.knots2[this.knots2.length - 1] - this.knots2[0]);
            NURBSUtils.calcSurfacePoint(this.degree1, this.degree2, this.knots1, this.knots2, this.controlPoints, u, v, target);
        }
    };
    return threex.curves.NURBSSurface = NURBSSurface;
});
define('skylark-threejs-ex/effects/AnaglyphEffect',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var AnaglyphEffect = function (renderer, width, height) {
        this.colorMatrixLeft = new THREE.Matrix3().fromArray([
            1.0671679973602295,
            -0.0016435992438346148,
            0.0001777536963345483,
            -0.028107794001698494,
            -0.00019593400065787137,
            -0.0002875397040043026,
            -0.04279090091586113,
            0.000015809757314855233,
            -0.00024287120322696865
        ]);
        this.colorMatrixRight = new THREE.Matrix3().fromArray([
            -0.0355340838432312,
            -0.06440307199954987,
            0.018319187685847282,
            -0.10269022732973099,
            0.8079727292060852,
            -0.04835830628871918,
            0.0001224992738571018,
            -0.009558862075209618,
            0.567823588848114
        ]);
        var _camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);
        var _scene = new THREE.Scene();
        var _stereo = new THREE.StereoCamera();
        var _params = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.NearestFilter,
            format: THREE.RGBAFormat
        };
        if (width === undefined)
            width = 512;
        if (height === undefined)
            height = 512;
        var _renderTargetL = new THREE.WebGLRenderTarget(width, height, _params);
        var _renderTargetR = new THREE.WebGLRenderTarget(width, height, _params);
        var _material = new THREE.ShaderMaterial({
            uniforms: {
                'mapLeft': { value: _renderTargetL.texture },
                'mapRight': { value: _renderTargetR.texture },
                'colorMatrixLeft': { value: this.colorMatrixLeft },
                'colorMatrixRight': { value: this.colorMatrixRight }
            },
            vertexShader: [
                'varying vec2 vUv;',
                'void main() {',
                '\tvUv = vec2( uv.x, uv.y );',
                '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
                '}'
            ].join('\n'),
            fragmentShader: [
                'uniform sampler2D mapLeft;',
                'uniform sampler2D mapRight;',
                'varying vec2 vUv;',
                'uniform mat3 colorMatrixLeft;',
                'uniform mat3 colorMatrixRight;',
                'float lin( float c ) {',
                '\treturn c <= 0.04045 ? c * 0.0773993808 :',
                '\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );',
                '}',
                'vec4 lin( vec4 c ) {',
                '\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );',
                '}',
                'float dev( float c ) {',
                '\treturn c <= 0.0031308 ? c * 12.92',
                '\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;',
                '}',
                'void main() {',
                '\tvec2 uv = vUv;',
                '\tvec4 colorL = lin( texture2D( mapLeft, uv ) );',
                '\tvec4 colorR = lin( texture2D( mapRight, uv ) );',
                '\tvec3 color = clamp(',
                '\t\t\tcolorMatrixLeft * colorL.rgb +',
                '\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );',
                '\tgl_FragColor = vec4(',
                '\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),',
                '\t\t\tmax( colorL.a, colorR.a ) );',
                '}'
            ].join('\n')
        });
        var _mesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), _material);
        _scene.add(_mesh);
        this.setSize = function (width, height) {
            renderer.setSize(width, height);
            var pixelRatio = renderer.getPixelRatio();
            _renderTargetL.setSize(width * pixelRatio, height * pixelRatio);
            _renderTargetR.setSize(width * pixelRatio, height * pixelRatio);
        };
        this.render = function (scene, camera) {
            var currentRenderTarget = renderer.getRenderTarget();
            scene.updateMatrixWorld();
            if (camera.parent === null)
                camera.updateMatrixWorld();
            _stereo.update(camera);
            renderer.setRenderTarget(_renderTargetL);
            renderer.clear();
            renderer.render(scene, _stereo.cameraL);
            renderer.setRenderTarget(_renderTargetR);
            renderer.clear();
            renderer.render(scene, _stereo.cameraR);
            renderer.setRenderTarget(null);
            renderer.render(_scene, _camera);
            renderer.setRenderTarget(currentRenderTarget);
        };
        this.dispose = function () {
            if (_renderTargetL)
                _renderTargetL.dispose();
            if (_renderTargetR)
                _renderTargetR.dispose();
            if (_mesh)
                _mesh.geometry.dispose();
            if (_material)
                _material.dispose();
        };
    };

    return threex.effects.AnaglyphEffect = AnaglyphEffect;
});
define('skylark-threejs-ex/effects/AsciiEffect',[
    "../threex",
], function (threex) {
    'use strict';
    var AsciiEffect = function (renderer, charSet, options) {
        charSet = charSet === undefined ? ' .:-=+*#%@' : charSet;
        if (!options)
            options = {};
        var bResolution = !options['resolution'] ? 0.15 : options['resolution'];
        var iScale = !options['scale'] ? 1 : options['scale'];
        var bColor = !options['color'] ? false : options['color'];
        var bAlpha = !options['alpha'] ? false : options['alpha'];
        var bBlock = !options['block'] ? false : options['block'];
        var bInvert = !options['invert'] ? false : options['invert'];
        var strResolution = 'low';
        var width, height;
        var domElement = document.createElement('div');
        domElement.style.cursor = 'default';
        var oAscii = document.createElement('table');
        domElement.appendChild(oAscii);
        var iWidth, iHeight;
        var oImg;
        this.setSize = function (w, h) {
            width = w;
            height = h;
            renderer.setSize(w, h);
            initAsciiSize();
        };
        this.render = function (scene, camera) {
            renderer.render(scene, camera);
            asciifyImage(renderer, oAscii);
        };
        this.domElement = domElement;
        function initAsciiSize() {
            iWidth = Math.round(width * fResolution);
            iHeight = Math.round(height * fResolution);
            oCanvas.width = iWidth;
            oCanvas.height = iHeight;
            oImg = renderer.domElement;
            if (oImg.style.backgroundColor) {
                oAscii.rows[0].cells[0].style.backgroundColor = oImg.style.backgroundColor;
                oAscii.rows[0].cells[0].style.color = oImg.style.color;
            }
            oAscii.cellSpacing = 0;
            oAscii.cellPadding = 0;
            var oStyle = oAscii.style;
            oStyle.display = 'inline';
            oStyle.width = Math.round(iWidth / fResolution * iScale) + 'px';
            oStyle.height = Math.round(iHeight / fResolution * iScale) + 'px';
            oStyle.whiteSpace = 'pre';
            oStyle.margin = '0px';
            oStyle.padding = '0px';
            oStyle.letterSpacing = fLetterSpacing + 'px';
            oStyle.fontFamily = strFont;
            oStyle.fontSize = fFontSize + 'px';
            oStyle.lineHeight = fLineHeight + 'px';
            oStyle.textAlign = 'left';
            oStyle.textDecoration = 'none';
        }
        var aDefaultCharList = ' .,:;i1tfLCG08@'.split('');
        var aDefaultColorCharList = ' CGO08@'.split('');
        var strFont = 'courier new, monospace';
        var oCanvasImg = renderer.domElement;
        var oCanvas = document.createElement('canvas');
        if (!oCanvas.getContext) {
            return;
        }
        var oCtx = oCanvas.getContext('2d');
        if (!oCtx.getImageData) {
            return;
        }
        var aCharList = bColor ? aDefaultColorCharList : aDefaultCharList;
        if (charSet)
            aCharList = charSet;
        var fResolution = 0.5;
        switch (strResolution) {
        case 'low':
            fResolution = 0.25;
            break;
        case 'medium':
            fResolution = 0.5;
            break;
        case 'high':
            fResolution = 1;
            break;
        }
        if (bResolution)
            fResolution = bResolution;
        var fFontSize = 2 / fResolution * iScale;
        var fLineHeight = 2 / fResolution * iScale;
        var fLetterSpacing = 0;
        if (strResolution == 'low') {
            switch (iScale) {
            case 1:
                fLetterSpacing = -1;
                break;
            case 2:
            case 3:
                fLetterSpacing = -2.1;
                break;
            case 4:
                fLetterSpacing = -3.1;
                break;
            case 5:
                fLetterSpacing = -4.15;
                break;
            }
        }
        if (strResolution == 'medium') {
            switch (iScale) {
            case 1:
                fLetterSpacing = 0;
                break;
            case 2:
                fLetterSpacing = -1;
                break;
            case 3:
                fLetterSpacing = -1.04;
                break;
            case 4:
            case 5:
                fLetterSpacing = -2.1;
                break;
            }
        }
        if (strResolution == 'high') {
            switch (iScale) {
            case 1:
            case 2:
                fLetterSpacing = 0;
                break;
            case 3:
            case 4:
            case 5:
                fLetterSpacing = -1;
                break;
            }
        }
        function asciifyImage(canvasRenderer, oAscii) {
            oCtx.clearRect(0, 0, iWidth, iHeight);
            oCtx.drawImage(oCanvasImg, 0, 0, iWidth, iHeight);
            var oImgData = oCtx.getImageData(0, 0, iWidth, iHeight).data;
            var strChars = '';
            for (var y = 0; y < iHeight; y += 2) {
                for (var x = 0; x < iWidth; x++) {
                    var iOffset = (y * iWidth + x) * 4;
                    var iRed = oImgData[iOffset];
                    var iGreen = oImgData[iOffset + 1];
                    var iBlue = oImgData[iOffset + 2];
                    var iAlpha = oImgData[iOffset + 3];
                    var iCharIdx;
                    var fBrightness;
                    fBrightness = (0.3 * iRed + 0.59 * iGreen + 0.11 * iBlue) / 255;
                    if (iAlpha == 0) {
                        fBrightness = 1;
                    }
                    iCharIdx = Math.floor((1 - fBrightness) * (aCharList.length - 1));
                    if (bInvert) {
                        iCharIdx = aCharList.length - iCharIdx - 1;
                    }
                    var strThisChar = aCharList[iCharIdx];
                    if (strThisChar === undefined || strThisChar == ' ')
                        strThisChar = '&nbsp;';
                    if (bColor) {
                        strChars += "<span style='" + 'color:rgb(' + iRed + ',' + iGreen + ',' + iBlue + ');' + (bBlock ? 'background-color:rgb(' + iRed + ',' + iGreen + ',' + iBlue + ');' : '') + (bAlpha ? 'opacity:' + iAlpha / 255 + ';' : '') + "'>" + strThisChar + '</span>';
                    } else {
                        strChars += strThisChar;
                    }
                }
                strChars += '<br/>';
            }
            oAscii.innerHTML = '<tr><td>' + strChars + '</td></tr>';
        }
    };

    return threex.effects.AsciiEffect = AsciiEffect;
});
define('skylark-threejs-ex/effects/OutlineEffect',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var OutlineEffect = function (renderer, parameters) {
        parameters = parameters || {};
        this.enabled = true;
        var defaultThickness = parameters.defaultThickness !== undefined ? parameters.defaultThickness : 0.003;
        var defaultColor = new THREE.Color().fromArray(parameters.defaultColor !== undefined ? parameters.defaultColor : [
            0,
            0,
            0
        ]);
        var defaultAlpha = parameters.defaultAlpha !== undefined ? parameters.defaultAlpha : 1;
        var defaultKeepAlive = parameters.defaultKeepAlive !== undefined ? parameters.defaultKeepAlive : false;
        var cache = {};
        var removeThresholdCount = 60;
        var originalMaterials = {};
        var originalOnBeforeRenders = {};
        var uniformsOutline = {
            outlineThickness: { value: defaultThickness },
            outlineColor: { value: defaultColor },
            outlineAlpha: { value: defaultAlpha }
        };
        var vertexShader = [
            '#include <common>',
            '#include <uv_pars_vertex>',
            '#include <displacementmap_pars_vertex>',
            '#include <fog_pars_vertex>',
            '#include <morphtarget_pars_vertex>',
            '#include <skinning_pars_vertex>',
            '#include <logdepthbuf_pars_vertex>',
            '#include <clipping_planes_pars_vertex>',
            'uniform float outlineThickness;',
            'vec4 calculateOutline( vec4 pos, vec3 normal, vec4 skinned ) {',
            '\tfloat thickness = outlineThickness;',
            '\tconst float ratio = 1.0;',
            '\tvec4 pos2 = projectionMatrix * modelViewMatrix * vec4( skinned.xyz + normal, 1.0 );',
            '\tvec4 norm = normalize( pos - pos2 );',
            '\treturn pos + norm * thickness * pos.w * ratio;',
            '}',
            'void main() {',
            '\t#include <uv_vertex>',
            '\t#include <beginnormal_vertex>',
            '\t#include <morphnormal_vertex>',
            '\t#include <skinbase_vertex>',
            '\t#include <skinnormal_vertex>',
            '\t#include <begin_vertex>',
            '\t#include <morphtarget_vertex>',
            '\t#include <skinning_vertex>',
            '\t#include <displacementmap_vertex>',
            '\t#include <project_vertex>',
            '\tvec3 outlineNormal = - objectNormal;',
            '\tgl_Position = calculateOutline( gl_Position, outlineNormal, vec4( transformed, 1.0 ) );',
            '\t#include <logdepthbuf_vertex>',
            '\t#include <clipping_planes_vertex>',
            '\t#include <fog_vertex>',
            '}'
        ].join('\n');
        var fragmentShader = [
            '#include <common>',
            '#include <fog_pars_fragment>',
            '#include <logdepthbuf_pars_fragment>',
            '#include <clipping_planes_pars_fragment>',
            'uniform vec3 outlineColor;',
            'uniform float outlineAlpha;',
            'void main() {',
            '\t#include <clipping_planes_fragment>',
            '\t#include <logdepthbuf_fragment>',
            '\tgl_FragColor = vec4( outlineColor, outlineAlpha );',
            '\t#include <tonemapping_fragment>',
            '\t#include <encodings_fragment>',
            '\t#include <fog_fragment>',
            '\t#include <premultiplied_alpha_fragment>',
            '}'
        ].join('\n');
        function createMaterial() {
            return new THREE.ShaderMaterial({
                type: 'OutlineEffect',
                uniforms: THREE.UniformsUtils.merge([
                    THREE.UniformsLib['fog'],
                    THREE.UniformsLib['displacementmap'],
                    uniformsOutline
                ]),
                vertexShader: vertexShader,
                fragmentShader: fragmentShader,
                side: THREE.BackSide
            });
        }
        function getOutlineMaterialFromCache(originalMaterial) {
            var data = cache[originalMaterial.uuid];
            if (data === undefined) {
                data = {
                    material: createMaterial(),
                    used: true,
                    keepAlive: defaultKeepAlive,
                    count: 0
                };
                cache[originalMaterial.uuid] = data;
            }
            data.used = true;
            return data.material;
        }
        function getOutlineMaterial(originalMaterial) {
            var outlineMaterial = getOutlineMaterialFromCache(originalMaterial);
            originalMaterials[outlineMaterial.uuid] = originalMaterial;
            updateOutlineMaterial(outlineMaterial, originalMaterial);
            return outlineMaterial;
        }
        function isCompatible(object) {
            var geometry = object.geometry;
            var hasNormals = false;
            if (object.geometry !== undefined) {
                if (geometry.isBufferGeometry) {
                    hasNormals = geometry.attributes.normal !== undefined;
                } else {
                    hasNormals = true;
                }
            }
            return object.isMesh === true && object.material !== undefined && hasNormals === true;
        }
        function setOutlineMaterial(object) {
            if (isCompatible(object) === false)
                return;
            if (Array.isArray(object.material)) {
                for (var i = 0, il = object.material.length; i < il; i++) {
                    object.material[i] = getOutlineMaterial(object.material[i]);
                }
            } else {
                object.material = getOutlineMaterial(object.material);
            }
            originalOnBeforeRenders[object.uuid] = object.onBeforeRender;
            object.onBeforeRender = onBeforeRender;
        }
        function restoreOriginalMaterial(object) {
            if (isCompatible(object) === false)
                return;
            if (Array.isArray(object.material)) {
                for (var i = 0, il = object.material.length; i < il; i++) {
                    object.material[i] = originalMaterials[object.material[i].uuid];
                }
            } else {
                object.material = originalMaterials[object.material.uuid];
            }
            object.onBeforeRender = originalOnBeforeRenders[object.uuid];
        }
        function onBeforeRender(renderer, scene, camera, geometry, material) {
            var originalMaterial = originalMaterials[material.uuid];
            if (originalMaterial === undefined)
                return;
            updateUniforms(material, originalMaterial);
        }
        function updateUniforms(material, originalMaterial) {
            var outlineParameters = originalMaterial.userData.outlineParameters;
            material.uniforms.outlineAlpha.value = originalMaterial.opacity;
            if (outlineParameters !== undefined) {
                if (outlineParameters.thickness !== undefined)
                    material.uniforms.outlineThickness.value = outlineParameters.thickness;
                if (outlineParameters.color !== undefined)
                    material.uniforms.outlineColor.value.fromArray(outlineParameters.color);
                if (outlineParameters.alpha !== undefined)
                    material.uniforms.outlineAlpha.value = outlineParameters.alpha;
            }
            if (originalMaterial.displacementMap) {
                material.uniforms.displacementMap.value = originalMaterial.displacementMap;
                material.uniforms.displacementScale.value = originalMaterial.displacementScale;
                material.uniforms.displacementBias.value = originalMaterial.displacementBias;
            }
        }
        function updateOutlineMaterial(material, originalMaterial) {
            if (material.name === 'invisible')
                return;
            var outlineParameters = originalMaterial.userData.outlineParameters;
            material.skinning = originalMaterial.skinning;
            material.morphTargets = originalMaterial.morphTargets;
            material.morphNormals = originalMaterial.morphNormals;
            material.fog = originalMaterial.fog;
            material.toneMapped = originalMaterial.toneMapped;
            material.premultipliedAlpha = originalMaterial.premultipliedAlpha;
            material.displacementMap = originalMaterial.displacementMap;
            if (outlineParameters !== undefined) {
                if (originalMaterial.visible === false) {
                    material.visible = false;
                } else {
                    material.visible = outlineParameters.visible !== undefined ? outlineParameters.visible : true;
                }
                material.transparent = outlineParameters.alpha !== undefined && outlineParameters.alpha < 1 ? true : originalMaterial.transparent;
                if (outlineParameters.keepAlive !== undefined)
                    cache[originalMaterial.uuid].keepAlive = outlineParameters.keepAlive;
            } else {
                material.transparent = originalMaterial.transparent;
                material.visible = originalMaterial.visible;
            }
            if (originalMaterial.wireframe === true || originalMaterial.depthTest === false)
                material.visible = false;
            if (originalMaterial.clippingPlanes) {
                material.clipping = true;
                material.clippingPlanes = originalMaterial.clippingPlanes;
                material.clipIntersection = originalMaterial.clipIntersection;
                material.clipShadows = originalMaterial.clipShadows;
            }
            material.version = originalMaterial.version;
        }
        function cleanupCache() {
            var keys;
            keys = Object.keys(originalMaterials);
            for (var i = 0, il = keys.length; i < il; i++) {
                originalMaterials[keys[i]] = undefined;
            }
            keys = Object.keys(originalOnBeforeRenders);
            for (var i = 0, il = keys.length; i < il; i++) {
                originalOnBeforeRenders[keys[i]] = undefined;
            }
            keys = Object.keys(cache);
            for (var i = 0, il = keys.length; i < il; i++) {
                var key = keys[i];
                if (cache[key].used === false) {
                    cache[key].count++;
                    if (cache[key].keepAlive === false && cache[key].count > removeThresholdCount) {
                        delete cache[key];
                    }
                } else {
                    cache[key].used = false;
                    cache[key].count = 0;
                }
            }
        }
        this.render = function (scene, camera) {
            var renderTarget;
            var forceClear = false;
            if (arguments[2] !== undefined) {
                console.warn('THREE.OutlineEffect.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.');
                renderTarget = arguments[2];
            }
            if (arguments[3] !== undefined) {
                console.warn('THREE.OutlineEffect.render(): the forceClear argument has been removed. Use .clear() instead.');
                forceClear = arguments[3];
            }
            if (renderTarget !== undefined)
                renderer.setRenderTarget(renderTarget);
            if (forceClear)
                renderer.clear();
            if (this.enabled === false) {
                renderer.render(scene, camera);
                return;
            }
            var currentAutoClear = renderer.autoClear;
            renderer.autoClear = this.autoClear;
            renderer.render(scene, camera);
            renderer.autoClear = currentAutoClear;
            this.renderOutline(scene, camera);
        };
        this.renderOutline = function (scene, camera) {
            var currentAutoClear = renderer.autoClear;
            var currentSceneAutoUpdate = scene.autoUpdate;
            var currentSceneBackground = scene.background;
            var currentShadowMapEnabled = renderer.shadowMap.enabled;
            scene.autoUpdate = false;
            scene.background = null;
            renderer.autoClear = false;
            renderer.shadowMap.enabled = false;
            scene.traverse(setOutlineMaterial);
            renderer.render(scene, camera);
            scene.traverse(restoreOriginalMaterial);
            cleanupCache();
            scene.autoUpdate = currentSceneAutoUpdate;
            scene.background = currentSceneBackground;
            renderer.autoClear = currentAutoClear;
            renderer.shadowMap.enabled = currentShadowMapEnabled;
        };
        this.autoClear = renderer.autoClear;
        this.domElement = renderer.domElement;
        this.shadowMap = renderer.shadowMap;
        this.clear = function (color, depth, stencil) {
            renderer.clear(color, depth, stencil);
        };
        this.getPixelRatio = function () {
            return renderer.getPixelRatio();
        };
        this.setPixelRatio = function (value) {
            renderer.setPixelRatio(value);
        };
        this.getSize = function (target) {
            return renderer.getSize(target);
        };
        this.setSize = function (width, height, updateStyle) {
            renderer.setSize(width, height, updateStyle);
        };
        this.setViewport = function (x, y, width, height) {
            renderer.setViewport(x, y, width, height);
        };
        this.setScissor = function (x, y, width, height) {
            renderer.setScissor(x, y, width, height);
        };
        this.setScissorTest = function (boolean) {
            renderer.setScissorTest(boolean);
        };
        this.setRenderTarget = function (renderTarget) {
            renderer.setRenderTarget(renderTarget);
        };
    };

    return threex.effects.OutlineEffect = OutlineEffect;
});
define('skylark-threejs-ex/effects/ParallaxBarrierEffect',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ParallaxBarrierEffect = function (renderer) {
        var _camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);
        var _scene = new THREE.Scene();
        var _stereo = new THREE.StereoCamera();
        var _params = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.NearestFilter,
            format: THREE.RGBAFormat
        };
        var _renderTargetL = new THREE.WebGLRenderTarget(512, 512, _params);
        var _renderTargetR = new THREE.WebGLRenderTarget(512, 512, _params);
        var _material = new THREE.ShaderMaterial({
            uniforms: {
                'mapLeft': { value: _renderTargetL.texture },
                'mapRight': { value: _renderTargetR.texture }
            },
            vertexShader: [
                'varying vec2 vUv;',
                'void main() {',
                '\tvUv = vec2( uv.x, uv.y );',
                '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
                '}'
            ].join('\n'),
            fragmentShader: [
                'uniform sampler2D mapLeft;',
                'uniform sampler2D mapRight;',
                'varying vec2 vUv;',
                'void main() {',
                '\tvec2 uv = vUv;',
                '\tif ( ( mod( gl_FragCoord.y, 2.0 ) ) > 1.00 ) {',
                '\t\tgl_FragColor = texture2D( mapLeft, uv );',
                '\t} else {',
                '\t\tgl_FragColor = texture2D( mapRight, uv );',
                '\t}',
                '}'
            ].join('\n')
        });
        var mesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), _material);
        _scene.add(mesh);
        this.setSize = function (width, height) {
            renderer.setSize(width, height);
            var pixelRatio = renderer.getPixelRatio();
            _renderTargetL.setSize(width * pixelRatio, height * pixelRatio);
            _renderTargetR.setSize(width * pixelRatio, height * pixelRatio);
        };
        this.render = function (scene, camera) {
            scene.updateMatrixWorld();
            if (camera.parent === null)
                camera.updateMatrixWorld();
            _stereo.update(camera);
            renderer.setRenderTarget(_renderTargetL);
            renderer.clear();
            renderer.render(scene, _stereo.cameraL);
            renderer.setRenderTarget(_renderTargetR);
            renderer.clear();
            renderer.render(scene, _stereo.cameraR);
            renderer.setRenderTarget(null);
            renderer.render(_scene, _camera);
        };
    };
    
    return threex.effects.ParallaxBarrierEffect = ParallaxBarrierEffect;
});
define('skylark-threejs-ex/effects/PeppersGhostEffect',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {

    'use strict';
    var PeppersGhostEffect = function (renderer) {
        var scope = this;
        scope.cameraDistance = 15;
        scope.reflectFromAbove = false;
        var _halfWidth, _width, _height;
        var _cameraF = new THREE.PerspectiveCamera();
        var _cameraB = new THREE.PerspectiveCamera();
        var _cameraL = new THREE.PerspectiveCamera();
        var _cameraR = new THREE.PerspectiveCamera();
        var _position = new THREE.Vector3();
        var _quaternion = new THREE.Quaternion();
        var _scale = new THREE.Vector3();
        renderer.autoClear = false;
        this.setSize = function (width, height) {
            _halfWidth = width / 2;
            if (width < height) {
                _width = width / 3;
                _height = width / 3;
            } else {
                _width = height / 3;
                _height = height / 3;
            }
            renderer.setSize(width, height);
        };
        this.render = function (scene, camera) {
            scene.updateMatrixWorld();
            if (camera.parent === null)
                camera.updateMatrixWorld();
            camera.matrixWorld.decompose(_position, _quaternion, _scale);
            _cameraF.position.copy(_position);
            _cameraF.quaternion.copy(_quaternion);
            _cameraF.translateZ(scope.cameraDistance);
            _cameraF.lookAt(scene.position);
            _cameraB.position.copy(_position);
            _cameraB.quaternion.copy(_quaternion);
            _cameraB.translateZ(-scope.cameraDistance);
            _cameraB.lookAt(scene.position);
            _cameraB.rotation.z += 180 * (Math.PI / 180);
            _cameraL.position.copy(_position);
            _cameraL.quaternion.copy(_quaternion);
            _cameraL.translateX(-scope.cameraDistance);
            _cameraL.lookAt(scene.position);
            _cameraL.rotation.x += 90 * (Math.PI / 180);
            _cameraR.position.copy(_position);
            _cameraR.quaternion.copy(_quaternion);
            _cameraR.translateX(scope.cameraDistance);
            _cameraR.lookAt(scene.position);
            _cameraR.rotation.x += 90 * (Math.PI / 180);
            renderer.clear();
            renderer.setScissorTest(true);
            renderer.setScissor(_halfWidth - _width / 2, _height * 2, _width, _height);
            renderer.setViewport(_halfWidth - _width / 2, _height * 2, _width, _height);
            if (scope.reflectFromAbove) {
                renderer.render(scene, _cameraB);
            } else {
                renderer.render(scene, _cameraF);
            }
            renderer.setScissor(_halfWidth - _width / 2, 0, _width, _height);
            renderer.setViewport(_halfWidth - _width / 2, 0, _width, _height);
            if (scope.reflectFromAbove) {
                renderer.render(scene, _cameraF);
            } else {
                renderer.render(scene, _cameraB);
            }
            renderer.setScissor(_halfWidth - _width / 2 - _width, _height, _width, _height);
            renderer.setViewport(_halfWidth - _width / 2 - _width, _height, _width, _height);
            if (scope.reflectFromAbove) {
                renderer.render(scene, _cameraR);
            } else {
                renderer.render(scene, _cameraL);
            }
            renderer.setScissor(_halfWidth + _width / 2, _height, _width, _height);
            renderer.setViewport(_halfWidth + _width / 2, _height, _width, _height);
            if (scope.reflectFromAbove) {
                renderer.render(scene, _cameraL);
            } else {
                renderer.render(scene, _cameraR);
            }
            renderer.setScissorTest(false);
        };
    };

    return threex.effects.PeppersGhostEffect = PeppersGhostEffect;
});
define('skylark-threejs-ex/effects/StereoEffect',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var StereoEffect = function (renderer) {
        var _stereo = new THREE.StereoCamera();
        _stereo.aspect = 0.5;
        var size = new THREE.Vector2();
        this.setEyeSeparation = function (eyeSep) {
            _stereo.eyeSep = eyeSep;
        };
        this.setSize = function (width, height) {
            renderer.setSize(width, height);
        };
        this.render = function (scene, camera) {
            scene.updateMatrixWorld();
            if (camera.parent === null)
                camera.updateMatrixWorld();
            _stereo.update(camera);
            renderer.getSize(size);
            if (renderer.autoClear)
                renderer.clear();
            renderer.setScissorTest(true);
            renderer.setScissor(0, 0, size.width / 2, size.height);
            renderer.setViewport(0, 0, size.width / 2, size.height);
            renderer.render(scene, _stereo.cameraL);
            renderer.setScissor(size.width / 2, 0, size.width / 2, size.height);
            renderer.setViewport(size.width / 2, 0, size.width / 2, size.height);
            renderer.render(scene, _stereo.cameraR);
            renderer.setScissorTest(false);
        };
    };

    return threex.effects.StereoEffect = StereoEffect;
});
define('skylark-threejs-ex/exporters/ColladaExporter',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ColladaExporter = function () {
    };
    ColladaExporter.prototype = {
        constructor: ColladaExporter,
        parse: function (object, onDone, options) {
            options = options || {};
            options = Object.assign({
                version: '1.4.1',
                author: null,
                textureDirectory: ''
            }, options);
            if (options.textureDirectory !== '') {
                options.textureDirectory = `${ options.textureDirectory }/`.replace(/\\/g, '/').replace(/\/+/g, '/');
            }
            var version = options.version;
            if (version !== '1.4.1' && version !== '1.5.0') {
                console.warn(`ColladaExporter : Version ${ version } not supported for export. Only 1.4.1 and 1.5.0.`);
                return null;
            }
            function format(urdf) {
                var IS_END_TAG = /^<\//;
                var IS_SELF_CLOSING = /(\?>$)|(\/>$)/;
                var HAS_TEXT = /<[^>]+>[^<]*<\/[^<]+>/;
                var pad = (ch, num) => num > 0 ? ch + pad(ch, num - 1) : '';
                var tagnum = 0;
                return urdf.match(/(<[^>]+>[^<]+<\/[^<]+>)|(<[^>]+>)/g).map(tag => {
                    if (!HAS_TEXT.test(tag) && !IS_SELF_CLOSING.test(tag) && IS_END_TAG.test(tag)) {
                        tagnum--;
                    }
                    var res = `${ pad('  ', tagnum) }${ tag }`;
                    if (!HAS_TEXT.test(tag) && !IS_SELF_CLOSING.test(tag) && !IS_END_TAG.test(tag)) {
                        tagnum++;
                    }
                    return res;
                }).join('\n');
            }
            function base64ToBuffer(str) {
                var b = atob(str);
                var buf = new Uint8Array(b.length);
                for (var i = 0, l = buf.length; i < l; i++) {
                    buf[i] = b.charCodeAt(i);
                }
                return buf;
            }
            var canvas, ctx;
            function imageToData(image, ext) {
                canvas = canvas || document.createElement('canvas');
                ctx = ctx || canvas.getContext('2d');
                canvas.width = image.naturalWidth;
                canvas.height = image.naturalHeight;
                ctx.drawImage(image, 0, 0);
                var base64data = canvas.toDataURL(`image/${ ext }`, 1).replace(/^data:image\/(png|jpg);base64,/, '');
                return base64ToBuffer(base64data);
            }
            var getFuncs = [
                'getX',
                'getY',
                'getZ',
                'getW'
            ];
            function attrBufferToArray(attr) {
                if (attr.isInterleavedBufferAttribute) {
                    var arr = new attr.array.constructor(attr.count * attr.itemSize);
                    var size = attr.itemSize;
                    for (var i = 0, l = attr.count; i < l; i++) {
                        for (var j = 0; j < size; j++) {
                            arr[i * size + j] = attr[getFuncs[j]](i);
                        }
                    }
                    return arr;
                } else {
                    return attr.array;
                }
            }
            function subArray(arr, st, ct) {
                if (Array.isArray(arr))
                    return arr.slice(st, st + ct);
                else
                    return new arr.constructor(arr.buffer, st * arr.BYTES_PER_ELEMENT, ct);
            }
            function getAttribute(attr, name, params, type) {
                var array = attrBufferToArray(attr);
                var res = `<source id="${ name }">` + `<float_array id="${ name }-array" count="${ array.length }">` + array.join(' ') + '</float_array>' + '<technique_common>' + `<accessor source="#${ name }-array" count="${ Math.floor(array.length / attr.itemSize) }" stride="${ attr.itemSize }">` + params.map(n => `<param name="${ n }" type="${ type }" />`).join('') + '</accessor>' + '</technique_common>' + '</source>';
                return res;
            }
            var transMat;
            function getTransform(o) {
                o.updateMatrix();
                transMat = transMat || new THREE.Matrix4();
                transMat.copy(o.matrix);
                transMat.transpose();
                return `<matrix>${ transMat.toArray().join(' ') }</matrix>`;
            }
            function processGeometry(g) {
                var info = geometryInfo.get(g);
                if (!info) {
                    var bufferGeometry = g;
                    if (bufferGeometry instanceof THREE.Geometry) {
                        bufferGeometry = new THREE.BufferGeometry().fromGeometry(bufferGeometry);
                    }
                    var meshid = `Mesh${ libraryGeometries.length + 1 }`;
                    var indexCount = bufferGeometry.index ? bufferGeometry.index.count * bufferGeometry.index.itemSize : bufferGeometry.attributes.position.count;
                    var groups = bufferGeometry.groups != null && bufferGeometry.groups.length !== 0 ? bufferGeometry.groups : [{
                            start: 0,
                            count: indexCount,
                            materialIndex: 0
                        }];
                    var gname = g.name ? ` name="${ g.name }"` : '';
                    var gnode = `<geometry id="${ meshid }"${ gname }><mesh>`;
                    var posName = `${ meshid }-position`;
                    var vertName = `${ meshid }-vertices`;
                    gnode += getAttribute(bufferGeometry.attributes.position, posName, [
                        'X',
                        'Y',
                        'Z'
                    ], 'float');
                    gnode += `<vertices id="${ vertName }"><input semantic="POSITION" source="#${ posName }" /></vertices>`;
                    var triangleInputs = `<input semantic="VERTEX" source="#${ vertName }" offset="0" />`;
                    if ('normal' in bufferGeometry.attributes) {
                        var normName = `${ meshid }-normal`;
                        gnode += getAttribute(bufferGeometry.attributes.normal, normName, [
                            'X',
                            'Y',
                            'Z'
                        ], 'float');
                        triangleInputs += `<input semantic="NORMAL" source="#${ normName }" offset="0" />`;
                    }
                    if ('uv' in bufferGeometry.attributes) {
                        var uvName = `${ meshid }-texcoord`;
                        gnode += getAttribute(bufferGeometry.attributes.uv, uvName, [
                            'S',
                            'T'
                        ], 'float');
                        triangleInputs += `<input semantic="TEXCOORD" source="#${ uvName }" offset="0" set="0" />`;
                    }
                    if ('color' in bufferGeometry.attributes) {
                        var colName = `${ meshid }-color`;
                        gnode += getAttribute(bufferGeometry.attributes.color, colName, [
                            'X',
                            'Y',
                            'Z'
                        ], 'uint8');
                        triangleInputs += `<input semantic="COLOR" source="#${ colName }" offset="0" />`;
                    }
                    var indexArray = null;
                    if (bufferGeometry.index) {
                        indexArray = attrBufferToArray(bufferGeometry.index);
                    } else {
                        indexArray = new Array(indexCount);
                        for (var i = 0, l = indexArray.length; i < l; i++)
                            indexArray[i] = i;
                    }
                    for (var i = 0, l = groups.length; i < l; i++) {
                        var group = groups[i];
                        var subarr = subArray(indexArray, group.start, group.count);
                        var polycount = subarr.length / 3;
                        gnode += `<triangles material="MESH_MATERIAL_${ group.materialIndex }" count="${ polycount }">`;
                        gnode += triangleInputs;
                        gnode += `<p>${ subarr.join(' ') }</p>`;
                        gnode += '</triangles>';
                    }
                    gnode += `</mesh></geometry>`;
                    libraryGeometries.push(gnode);
                    info = {
                        meshid: meshid,
                        bufferGeometry: bufferGeometry
                    };
                    geometryInfo.set(g, info);
                }
                return info;
            }
            function processTexture(tex) {
                var texid = imageMap.get(tex);
                if (texid == null) {
                    texid = `image-${ libraryImages.length + 1 }`;
                    var ext = 'png';
                    var name = tex.name || texid;
                    var imageNode = `<image id="${ texid }" name="${ name }">`;
                    if (version === '1.5.0') {
                        imageNode += `<init_from><ref>${ options.textureDirectory }${ name }.${ ext }</ref></init_from>`;
                    } else {
                        imageNode += `<init_from>${ options.textureDirectory }${ name }.${ ext }</init_from>`;
                    }
                    imageNode += '</image>';
                    libraryImages.push(imageNode);
                    imageMap.set(tex, texid);
                    textures.push({
                        directory: options.textureDirectory,
                        name,
                        ext,
                        data: imageToData(tex.image, ext),
                        original: tex
                    });
                }
                return texid;
            }
            function processMaterial(m) {
                var matid = materialMap.get(m);
                if (matid == null) {
                    matid = `Mat${ libraryEffects.length + 1 }`;
                    var type = 'phong';
                    if (m instanceof THREE.MeshLambertMaterial) {
                        type = 'lambert';
                    } else if (m instanceof THREE.MeshBasicMaterial) {
                        type = 'constant';
                        if (m.map !== null) {
                            console.warn('ColladaExporter: Texture maps not supported with MeshBasicMaterial.');
                        }
                    }
                    var emissive = m.emissive ? m.emissive : new THREE.Color(0, 0, 0);
                    var diffuse = m.color ? m.color : new THREE.Color(0, 0, 0);
                    var specular = m.specular ? m.specular : new THREE.Color(1, 1, 1);
                    var shininess = m.shininess || 0;
                    var reflectivity = m.reflectivity || 0;
                    var transparencyNode = '';
                    if (m.transparent === true) {
                        transparencyNode += `<transparent>` + (m.map ? `<texture texture="diffuse-sampler"></texture>` : '<float>1</float>') + '</transparent>';
                        if (m.opacity < 1) {
                            transparencyNode += `<transparency><float>${ m.opacity }</float></transparency>`;
                        }
                    }
                    var techniqueNode = `<technique sid="common"><${ type }>` + '<emission>' + (m.emissiveMap ? '<texture texture="emissive-sampler" texcoord="TEXCOORD" />' : `<color sid="emission">${ emissive.r } ${ emissive.g } ${ emissive.b } 1</color>`) + '</emission>' + (type !== 'constant' ? '<diffuse>' + (m.map ? '<texture texture="diffuse-sampler" texcoord="TEXCOORD" />' : `<color sid="diffuse">${ diffuse.r } ${ diffuse.g } ${ diffuse.b } 1</color>`) + '</diffuse>' : '') + (type !== 'constant' ? '<bump>' + (m.normalMap ? '<texture texture="bump-sampler" texcoord="TEXCOORD" />' : '') + '</bump>' : '') + (type === 'phong' ? `<specular><color sid="specular">${ specular.r } ${ specular.g } ${ specular.b } 1</color></specular>` + '<shininess>' + (m.specularMap ? '<texture texture="specular-sampler" texcoord="TEXCOORD" />' : `<float sid="shininess">${ shininess }</float>`) + '</shininess>' : '') + `<reflective><color>${ diffuse.r } ${ diffuse.g } ${ diffuse.b } 1</color></reflective>` + `<reflectivity><float>${ reflectivity }</float></reflectivity>` + transparencyNode + `</${ type }></technique>`;
                    var effectnode = `<effect id="${ matid }-effect">` + '<profile_COMMON>' + (m.map ? '<newparam sid="diffuse-surface"><surface type="2D">' + `<init_from>${ processTexture(m.map) }</init_from>` + '</surface></newparam>' + '<newparam sid="diffuse-sampler"><sampler2D><source>diffuse-surface</source></sampler2D></newparam>' : '') + (m.specularMap ? '<newparam sid="specular-surface"><surface type="2D">' + `<init_from>${ processTexture(m.specularMap) }</init_from>` + '</surface></newparam>' + '<newparam sid="specular-sampler"><sampler2D><source>specular-surface</source></sampler2D></newparam>' : '') + (m.emissiveMap ? '<newparam sid="emissive-surface"><surface type="2D">' + `<init_from>${ processTexture(m.emissiveMap) }</init_from>` + '</surface></newparam>' + '<newparam sid="emissive-sampler"><sampler2D><source>emissive-surface</source></sampler2D></newparam>' : '') + (m.normalMap ? '<newparam sid="bump-surface"><surface type="2D">' + `<init_from>${ processTexture(m.normalMap) }</init_from>` + '</surface></newparam>' + '<newparam sid="bump-sampler"><sampler2D><source>bump-surface</source></sampler2D></newparam>' : '') + techniqueNode + (m.side === THREE.DoubleSide ? `<extra><technique profile="THREEJS"><double_sided sid="double_sided" type="int">1</double_sided></technique></extra>` : '') + '</profile_COMMON>' + '</effect>';
                    var materialName = m.name ? ` name="${ m.name }"` : '';
                    var materialNode = `<material id="${ matid }"${ materialName }><instance_effect url="#${ matid }-effect" /></material>`;
                    libraryMaterials.push(materialNode);
                    libraryEffects.push(effectnode);
                    materialMap.set(m, matid);
                }
                return matid;
            }
            function processObject(o) {
                var node = `<node name="${ o.name }">`;
                node += getTransform(o);
                if (o instanceof THREE.Mesh && o.geometry != null) {
                    var geomInfo = processGeometry(o.geometry);
                    var meshid = geomInfo.meshid;
                    var geometry = geomInfo.bufferGeometry;
                    var matids = null;
                    var matidsArray = [];
                    var mat = o.material || new THREE.MeshBasicMaterial();
                    var materials = Array.isArray(mat) ? mat : [mat];
                    if (geometry.groups.length > materials.length) {
                        matidsArray = new Array(geometry.groups.length);
                    } else {
                        matidsArray = new Array(materials.length);
                    }
                    matids = matidsArray.fill().map((v, i) => processMaterial(materials[i % materials.length]));
                    node += `<instance_geometry url="#${ meshid }">` + (matids != null ? '<bind_material><technique_common>' + matids.map((id, i) => `<instance_material symbol="MESH_MATERIAL_${ i }" target="#${ id }" >` + '<bind_vertex_input semantic="TEXCOORD" input_semantic="TEXCOORD" input_set="0" />' + '</instance_material>').join('') + '</technique_common></bind_material>' : '') + '</instance_geometry>';
                }
                o.children.forEach(c => node += processObject(c));
                node += '</node>';
                return node;
            }
            var geometryInfo = new WeakMap();
            var materialMap = new WeakMap();
            var imageMap = new WeakMap();
            var textures = [];
            var libraryImages = [];
            var libraryGeometries = [];
            var libraryEffects = [];
            var libraryMaterials = [];
            var libraryVisualScenes = processObject(object);
            var specLink = version === '1.4.1' ? 'http://www.collada.org/2005/11/COLLADASchema' : 'https://www.khronos.org/collada/';
            var dae = '<?xml version="1.0" encoding="UTF-8" standalone="no" ?>' + `<COLLADA xmlns="${ specLink }" version="${ version }">` + '<asset>' + ('<contributor>' + '<authoring_tool>three.js Collada Exporter</authoring_tool>' + (options.author !== null ? `<author>${ options.author }</author>` : '') + '</contributor>' + `<created>${ new Date().toISOString() }</created>` + `<modified>${ new Date().toISOString() }</modified>` + '<up_axis>Y_UP</up_axis>') + '</asset>';
            dae += `<library_images>${ libraryImages.join('') }</library_images>`;
            dae += `<library_effects>${ libraryEffects.join('') }</library_effects>`;
            dae += `<library_materials>${ libraryMaterials.join('') }</library_materials>`;
            dae += `<library_geometries>${ libraryGeometries.join('') }</library_geometries>`;
            dae += `<library_visual_scenes><visual_scene id="Scene" name="scene">${ libraryVisualScenes }</visual_scene></library_visual_scenes>`;
            dae += '<scene><instance_visual_scene url="#Scene"/></scene>';
            dae += '</COLLADA>';
            var res = {
                data: format(dae),
                textures
            };
            if (typeof onDone === 'function') {
                requestAnimationFrame(() => onDone(res));
            }
            return res;
        }
    };

    return threex.exporters.ColladaExporter = ColladaExporter;
});
define('skylark-threejs-ex/exporters/DRACOExporter',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var DRACOExporter = function () {
    };
    DRACOExporter.prototype = {
        constructor: DRACOExporter,
        parse: function (geometry, options) {
            if (DracoEncoderModule === undefined) {
                throw new Error('THREE.DRACOExporter: required the draco_decoder to work.');
            }
            if (options === undefined) {
                options = {
                    decodeSpeed: 5,
                    encodeSpeed: 5,
                    encoderMethod: DRACOExporter.MESH_EDGEBREAKER_ENCODING,
                    quantization: [
                        16,
                        8,
                        8,
                        8,
                        8
                    ],
                    exportUvs: true,
                    exportNormals: true,
                    exportColor: false
                };
            }
            var dracoEncoder = DracoEncoderModule();
            var encoder = new dracoEncoder.Encoder();
            var builder = new dracoEncoder.MeshBuilder();
            var mesh = new dracoEncoder.Mesh();
            if (geometry.isGeometry === true) {
                var bufferGeometry = new THREE.BufferGeometry();
                bufferGeometry.fromGeometry(geometry);
                geometry = bufferGeometry;
            }
            if (geometry.isBufferGeometry !== true) {
                throw new Error('THREE.DRACOExporter.parse(geometry, options): geometry is not a THREE.Geometry or BufferGeometry instance.');
            }
            var vertices = geometry.getAttribute('position');
            builder.AddFloatAttributeToMesh(mesh, dracoEncoder.POSITION, vertices.count, vertices.itemSize, vertices.array);
            var faces = geometry.getIndex();
            if (faces !== null) {
                builder.AddFacesToMesh(mesh, faces.count, faces.array);
            } else {
                var faces = new (vertices.count > 65535 ? Uint32Array : Uint16Array)(vertices.count);
                for (var i = 0; i < faces.length; i++) {
                    faces[i] = i;
                }
                builder.AddFacesToMesh(mesh, vertices.count, faces);
            }
            if (options.exportNormals === true) {
                var normals = geometry.getAttribute('normal');
                if (normals !== undefined) {
                    builder.AddFloatAttributeToMesh(mesh, dracoEncoder.NORMAL, normals.count, normals.itemSize, normals.array);
                }
            }
            if (options.exportUvs === true) {
                var uvs = geometry.getAttribute('uv');
                if (uvs !== undefined) {
                    builder.AddFloatAttributeToMesh(mesh, dracoEncoder.TEX_COORD, uvs.count, uvs.itemSize, uvs.array);
                }
            }
            if (options.exportColor === true) {
                var colors = geometry.getAttribute('color');
                if (colors !== undefined) {
                    builder.AddFloatAttributeToMesh(mesh, dracoEncoder.COLOR, colors.count, colors.itemSize, colors.array);
                }
            }
            var encodedData = new dracoEncoder.DracoInt8Array();
            encoder.SetSpeedOptions(options.encodeSpeed || 5, options.decodeSpeed || 5);
            if (options.encoderMethod !== undefined) {
                encoder.SetEncodingMethod(options.encoderMethod);
            }
            if (options.quantization !== undefined) {
                for (var i = 0; i < 5; i++) {
                    if (options.quantization[i] !== undefined) {
                        encoder.SetAttributeQuantization(i, options.quantization[i]);
                    }
                }
            }
            var length = encoder.EncodeMeshToDracoBuffer(mesh, encodedData);
            dracoEncoder.destroy(mesh);
            if (length === 0) {
                throw new Error('THREE.DRACOExporter: Draco encoding failed.');
            }
            var outputData = new Int8Array(new ArrayBuffer(length));
            for (var i = 0; i < length; i++) {
                outputData[i] = encodedData.GetValue(i);
            }
            dracoEncoder.destroy(encodedData);
            dracoEncoder.destroy(encoder);
            dracoEncoder.destroy(builder);
            return outputData;
        }
    };
    DRACOExporter.MESH_EDGEBREAKER_ENCODING = 1;
    DRACOExporter.MESH_SEQUENTIAL_ENCODING = 0;
    DRACOExporter.POINT_CLOUD = 0;
    DRACOExporter.TRIANGULAR_MESH = 1;
    DRACOExporter.INVALID = -1;
    DRACOExporter.POSITION = 0;
    DRACOExporter.NORMAL = 1;
    DRACOExporter.COLOR = 2;
    DRACOExporter.TEX_COORD = 3;
    DRACOExporter.GENERIC = 4;

    return threex.exporters.DRACOExporter = DRACOExporter;
});
define('skylark-threejs-ex/exporters/GLTFExporter',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var WEBGL_CONSTANTS = {
        POINTS: 0,
        LINES: 1,
        LINE_LOOP: 2,
        LINE_STRIP: 3,
        TRIANGLES: 4,
        TRIANGLE_STRIP: 5,
        TRIANGLE_FAN: 6,
        UNSIGNED_BYTE: 5121,
        UNSIGNED_SHORT: 5123,
        FLOAT: 5126,
        UNSIGNED_INT: 5125,
        ARRAY_BUFFER: 34962,
        ELEMENT_ARRAY_BUFFER: 34963,
        NEAREST: 9728,
        LINEAR: 9729,
        NEAREST_MIPMAP_NEAREST: 9984,
        LINEAR_MIPMAP_NEAREST: 9985,
        NEAREST_MIPMAP_LINEAR: 9986,
        LINEAR_MIPMAP_LINEAR: 9987,
        CLAMP_TO_EDGE: 33071,
        MIRRORED_REPEAT: 33648,
        REPEAT: 10497
    };
    var THREE_TO_WEBGL = {};
    THREE_TO_WEBGL[THREE.NearestFilter] = WEBGL_CONSTANTS.NEAREST;
    THREE_TO_WEBGL[THREE.NearestMipmapNearestFilter] = WEBGL_CONSTANTS.NEAREST_MIPMAP_NEAREST;
    THREE_TO_WEBGL[THREE.NearestMipmapLinearFilter] = WEBGL_CONSTANTS.NEAREST_MIPMAP_LINEAR;
    THREE_TO_WEBGL[THREE.LinearFilter] = WEBGL_CONSTANTS.LINEAR;
    THREE_TO_WEBGL[THREE.LinearMipmapNearestFilter] = WEBGL_CONSTANTS.LINEAR_MIPMAP_NEAREST;
    THREE_TO_WEBGL[THREE.LinearMipmapLinearFilter] = WEBGL_CONSTANTS.LINEAR_MIPMAP_LINEAR;
    THREE_TO_WEBGL[THREE.ClampToEdgeWrapping] = WEBGL_CONSTANTS.CLAMP_TO_EDGE;
    THREE_TO_WEBGL[THREE.RepeatWrapping] = WEBGL_CONSTANTS.REPEAT;
    THREE_TO_WEBGL[THREE.MirroredRepeatWrapping] = WEBGL_CONSTANTS.MIRRORED_REPEAT;
    var PATH_PROPERTIES = {
        scale: 'scale',
        position: 'translation',
        quaternion: 'rotation',
        morphTargetInfluences: 'weights'
    };
    var GLTFExporter = function () {
    };
    GLTFExporter.prototype = {
        constructor: GLTFExporter,
        parse: function (input, onDone, options) {
            var DEFAULT_OPTIONS = {
                binary: false,
                trs: false,
                onlyVisible: true,
                truncateDrawRange: true,
                embedImages: true,
                maxTextureSize: Infinity,
                animations: [],
                forceIndices: false,
                forcePowerOfTwoTextures: false,
                includeCustomExtensions: false
            };
            options = Object.assign({}, DEFAULT_OPTIONS, options);
            if (options.animations.length > 0) {
                options.trs = true;
            }
            var outputJSON = {
                asset: {
                    version: '2.0',
                    generator: 'GLTFExporter'
                }
            };
            var byteOffset = 0;
            var buffers = [];
            var pending = [];
            var nodeMap = new Map();
            var skins = [];
            var extensionsUsed = {};
            var cachedData = {
                meshes: new Map(),
                attributes: new Map(),
                attributesNormalized: new Map(),
                materials: new Map(),
                textures: new Map(),
                images: new Map()
            };
            var cachedCanvas;
            var uids = new Map();
            var uid = 0;
            function getUID(object) {
                if (!uids.has(object))
                    uids.set(object, uid++);
                return uids.get(object);
            }
            function equalArray(array1, array2) {
                return array1.length === array2.length && array1.every(function (element, index) {
                    return element === array2[index];
                });
            }
            function stringToArrayBuffer(text) {
                if (window.TextEncoder !== undefined) {
                    return new TextEncoder().encode(text).buffer;
                }
                var array = new Uint8Array(new ArrayBuffer(text.length));
                for (var i = 0, il = text.length; i < il; i++) {
                    var value = text.charCodeAt(i);
                    array[i] = value > 255 ? 32 : value;
                }
                return array.buffer;
            }
            function getMinMax(attribute, start, count) {
                var output = {
                    min: new Array(attribute.itemSize).fill(Number.POSITIVE_INFINITY),
                    max: new Array(attribute.itemSize).fill(Number.NEGATIVE_INFINITY)
                };
                for (var i = start; i < start + count; i++) {
                    for (var a = 0; a < attribute.itemSize; a++) {
                        var value = attribute.array[i * attribute.itemSize + a];
                        output.min[a] = Math.min(output.min[a], value);
                        output.max[a] = Math.max(output.max[a], value);
                    }
                }
                return output;
            }
            function isPowerOfTwo(image) {
                return THREE.MathUtils.isPowerOfTwo(image.width) && THREE.MathUtils.isPowerOfTwo(image.height);
            }
            function isNormalizedNormalAttribute(normal) {
                if (cachedData.attributesNormalized.has(normal)) {
                    return false;
                }
                var v = new THREE.Vector3();
                for (var i = 0, il = normal.count; i < il; i++) {
                    if (Math.abs(v.fromArray(normal.array, i * 3).length() - 1) > 0.0005)
                        return false;
                }
                return true;
            }
            function createNormalizedNormalAttribute(normal) {
                if (cachedData.attributesNormalized.has(normal)) {
                    return cachedData.attributesNormalized.get(normal);
                }
                var attribute = normal.clone();
                var v = new THREE.Vector3();
                for (var i = 0, il = attribute.count; i < il; i++) {
                    v.fromArray(attribute.array, i * 3);
                    if (v.x === 0 && v.y === 0 && v.z === 0) {
                        v.setX(1);
                    } else {
                        v.normalize();
                    }
                    v.toArray(attribute.array, i * 3);
                }
                cachedData.attributesNormalized.set(normal, attribute);
                return attribute;
            }
            function getPaddedBufferSize(bufferSize) {
                return Math.ceil(bufferSize / 4) * 4;
            }
            function getPaddedArrayBuffer(arrayBuffer, paddingByte) {
                paddingByte = paddingByte || 0;
                var paddedLength = getPaddedBufferSize(arrayBuffer.byteLength);
                if (paddedLength !== arrayBuffer.byteLength) {
                    var array = new Uint8Array(paddedLength);
                    array.set(new Uint8Array(arrayBuffer));
                    if (paddingByte !== 0) {
                        for (var i = arrayBuffer.byteLength; i < paddedLength; i++) {
                            array[i] = paddingByte;
                        }
                    }
                    return array.buffer;
                }
                return arrayBuffer;
            }
            function serializeUserData(object, gltfProperty) {
                if (Object.keys(object.userData).length === 0) {
                    return;
                }
                try {
                    var json = JSON.parse(JSON.stringify(object.userData));
                    if (options.includeCustomExtensions && json.gltfExtensions) {
                        if (gltfProperty.extensions === undefined) {
                            gltfProperty.extensions = {};
                        }
                        for (var extensionName in json.gltfExtensions) {
                            gltfProperty.extensions[extensionName] = json.gltfExtensions[extensionName];
                            extensionsUsed[extensionName] = true;
                        }
                        delete json.gltfExtensions;
                    }
                    if (Object.keys(json).length > 0) {
                        gltfProperty.extras = json;
                    }
                } catch (error) {
                    console.warn("THREE.GLTFExporter: userData of '" + object.name + "' " + "won't be serialized because of JSON.stringify error - " + error.message);
                }
            }
            function applyTextureTransform(mapDef, texture) {
                var didTransform = false;
                var transformDef = {};
                if (texture.offset.x !== 0 || texture.offset.y !== 0) {
                    transformDef.offset = texture.offset.toArray();
                    didTransform = true;
                }
                if (texture.rotation !== 0) {
                    transformDef.rotation = texture.rotation;
                    didTransform = true;
                }
                if (texture.repeat.x !== 1 || texture.repeat.y !== 1) {
                    transformDef.scale = texture.repeat.toArray();
                    didTransform = true;
                }
                if (didTransform) {
                    mapDef.extensions = mapDef.extensions || {};
                    mapDef.extensions['KHR_texture_transform'] = transformDef;
                    extensionsUsed['KHR_texture_transform'] = true;
                }
            }
            function processBuffer(buffer) {
                if (!outputJSON.buffers) {
                    outputJSON.buffers = [{ byteLength: 0 }];
                }
                buffers.push(buffer);
                return 0;
            }
            function processBufferView(attribute, componentType, start, count, target) {
                if (!outputJSON.bufferViews) {
                    outputJSON.bufferViews = [];
                }
                var componentSize;
                if (componentType === WEBGL_CONSTANTS.UNSIGNED_BYTE) {
                    componentSize = 1;
                } else if (componentType === WEBGL_CONSTANTS.UNSIGNED_SHORT) {
                    componentSize = 2;
                } else {
                    componentSize = 4;
                }
                var byteLength = getPaddedBufferSize(count * attribute.itemSize * componentSize);
                var dataView = new DataView(new ArrayBuffer(byteLength));
                var offset = 0;
                for (var i = start; i < start + count; i++) {
                    for (var a = 0; a < attribute.itemSize; a++) {
                        var value = attribute.array[i * attribute.itemSize + a];
                        if (componentType === WEBGL_CONSTANTS.FLOAT) {
                            dataView.setFloat32(offset, value, true);
                        } else if (componentType === WEBGL_CONSTANTS.UNSIGNED_INT) {
                            dataView.setUint32(offset, value, true);
                        } else if (componentType === WEBGL_CONSTANTS.UNSIGNED_SHORT) {
                            dataView.setUint16(offset, value, true);
                        } else if (componentType === WEBGL_CONSTANTS.UNSIGNED_BYTE) {
                            dataView.setUint8(offset, value);
                        }
                        offset += componentSize;
                    }
                }
                var gltfBufferView = {
                    buffer: processBuffer(dataView.buffer),
                    byteOffset: byteOffset,
                    byteLength: byteLength
                };
                if (target !== undefined)
                    gltfBufferView.target = target;
                if (target === WEBGL_CONSTANTS.ARRAY_BUFFER) {
                    gltfBufferView.byteStride = attribute.itemSize * componentSize;
                }
                byteOffset += byteLength;
                outputJSON.bufferViews.push(gltfBufferView);
                var output = {
                    id: outputJSON.bufferViews.length - 1,
                    byteLength: 0
                };
                return output;
            }
            function processBufferViewImage(blob) {
                if (!outputJSON.bufferViews) {
                    outputJSON.bufferViews = [];
                }
                return new Promise(function (resolve) {
                    var reader = new window.FileReader();
                    reader.readAsArrayBuffer(blob);
                    reader.onloadend = function () {
                        var buffer = getPaddedArrayBuffer(reader.result);
                        var bufferView = {
                            buffer: processBuffer(buffer),
                            byteOffset: byteOffset,
                            byteLength: buffer.byteLength
                        };
                        byteOffset += buffer.byteLength;
                        outputJSON.bufferViews.push(bufferView);
                        resolve(outputJSON.bufferViews.length - 1);
                    };
                });
            }
            function processAccessor(attribute, geometry, start, count) {
                var types = {
                    1: 'SCALAR',
                    2: 'VEC2',
                    3: 'VEC3',
                    4: 'VEC4',
                    16: 'MAT4'
                };
                var componentType;
                if (attribute.array.constructor === Float32Array) {
                    componentType = WEBGL_CONSTANTS.FLOAT;
                } else if (attribute.array.constructor === Uint32Array) {
                    componentType = WEBGL_CONSTANTS.UNSIGNED_INT;
                } else if (attribute.array.constructor === Uint16Array) {
                    componentType = WEBGL_CONSTANTS.UNSIGNED_SHORT;
                } else if (attribute.array.constructor === Uint8Array) {
                    componentType = WEBGL_CONSTANTS.UNSIGNED_BYTE;
                } else {
                    throw new Error('THREE.GLTFExporter: Unsupported bufferAttribute component type.');
                }
                if (start === undefined)
                    start = 0;
                if (count === undefined)
                    count = attribute.count;
                if (options.truncateDrawRange && geometry !== undefined && geometry.index === null) {
                    var end = start + count;
                    var end2 = geometry.drawRange.count === Infinity ? attribute.count : geometry.drawRange.start + geometry.drawRange.count;
                    start = Math.max(start, geometry.drawRange.start);
                    count = Math.min(end, end2) - start;
                    if (count < 0)
                        count = 0;
                }
                if (count === 0) {
                    return null;
                }
                var minMax = getMinMax(attribute, start, count);
                var bufferViewTarget;
                if (geometry !== undefined) {
                    bufferViewTarget = attribute === geometry.index ? WEBGL_CONSTANTS.ELEMENT_ARRAY_BUFFER : WEBGL_CONSTANTS.ARRAY_BUFFER;
                }
                var bufferView = processBufferView(attribute, componentType, start, count, bufferViewTarget);
                var gltfAccessor = {
                    bufferView: bufferView.id,
                    byteOffset: bufferView.byteOffset,
                    componentType: componentType,
                    count: count,
                    max: minMax.max,
                    min: minMax.min,
                    type: types[attribute.itemSize]
                };
                if (!outputJSON.accessors) {
                    outputJSON.accessors = [];
                }
                outputJSON.accessors.push(gltfAccessor);
                return outputJSON.accessors.length - 1;
            }
            function processImage(image, format, flipY) {
                if (!cachedData.images.has(image)) {
                    cachedData.images.set(image, {});
                }
                var cachedImages = cachedData.images.get(image);
                var mimeType = format === THREE.RGBAFormat ? 'image/png' : 'image/jpeg';
                var key = mimeType + ':flipY/' + flipY.toString();
                if (cachedImages[key] !== undefined) {
                    return cachedImages[key];
                }
                if (!outputJSON.images) {
                    outputJSON.images = [];
                }
                var gltfImage = { mimeType: mimeType };
                if (options.embedImages) {
                    var canvas = cachedCanvas = cachedCanvas || document.createElement('canvas');
                    canvas.width = Math.min(image.width, options.maxTextureSize);
                    canvas.height = Math.min(image.height, options.maxTextureSize);
                    if (options.forcePowerOfTwoTextures && !isPowerOfTwo(canvas)) {
                        console.warn('GLTFExporter: Resized non-power-of-two image.', image);
                        canvas.width = THREE.MathUtils.floorPowerOfTwo(canvas.width);
                        canvas.height = THREE.MathUtils.floorPowerOfTwo(canvas.height);
                    }
                    var ctx = canvas.getContext('2d');
                    if (flipY === true) {
                        ctx.translate(0, canvas.height);
                        ctx.scale(1, -1);
                    }
                    ctx.drawImage(image, 0, 0, canvas.width, canvas.height);
                    if (options.binary === true) {
                        pending.push(new Promise(function (resolve) {
                            canvas.toBlob(function (blob) {
                                processBufferViewImage(blob).then(function (bufferViewIndex) {
                                    gltfImage.bufferView = bufferViewIndex;
                                    resolve();
                                });
                            }, mimeType);
                        }));
                    } else {
                        gltfImage.uri = canvas.toDataURL(mimeType);
                    }
                } else {
                    gltfImage.uri = image.src;
                }
                outputJSON.images.push(gltfImage);
                var index = outputJSON.images.length - 1;
                cachedImages[key] = index;
                return index;
            }
            function processSampler(map) {
                if (!outputJSON.samplers) {
                    outputJSON.samplers = [];
                }
                var gltfSampler = {
                    magFilter: THREE_TO_WEBGL[map.magFilter],
                    minFilter: THREE_TO_WEBGL[map.minFilter],
                    wrapS: THREE_TO_WEBGL[map.wrapS],
                    wrapT: THREE_TO_WEBGL[map.wrapT]
                };
                outputJSON.samplers.push(gltfSampler);
                return outputJSON.samplers.length - 1;
            }
            function processTexture(map) {
                if (cachedData.textures.has(map)) {
                    return cachedData.textures.get(map);
                }
                if (!outputJSON.textures) {
                    outputJSON.textures = [];
                }
                var gltfTexture = {
                    sampler: processSampler(map),
                    source: processImage(map.image, map.format, map.flipY)
                };
                if (map.name) {
                    gltfTexture.name = map.name;
                }
                outputJSON.textures.push(gltfTexture);
                var index = outputJSON.textures.length - 1;
                cachedData.textures.set(map, index);
                return index;
            }
            function processMaterial(material) {
                if (cachedData.materials.has(material)) {
                    return cachedData.materials.get(material);
                }
                if (material.isShaderMaterial) {
                    console.warn('GLTFExporter: THREE.ShaderMaterial not supported.');
                    return null;
                }
                if (!outputJSON.materials) {
                    outputJSON.materials = [];
                }
                var gltfMaterial = { pbrMetallicRoughness: {} };
                if (material.isMeshBasicMaterial) {
                    gltfMaterial.extensions = { KHR_materials_unlit: {} };
                    extensionsUsed['KHR_materials_unlit'] = true;
                } else if (material.isGLTFSpecularGlossinessMaterial) {
                    gltfMaterial.extensions = { KHR_materials_pbrSpecularGlossiness: {} };
                    extensionsUsed['KHR_materials_pbrSpecularGlossiness'] = true;
                } else if (!material.isMeshStandardMaterial) {
                    console.warn('GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.');
                }
                var color = material.color.toArray().concat([material.opacity]);
                if (!equalArray(color, [
                        1,
                        1,
                        1,
                        1
                    ])) {
                    gltfMaterial.pbrMetallicRoughness.baseColorFactor = color;
                }
                if (material.isMeshStandardMaterial) {
                    gltfMaterial.pbrMetallicRoughness.metallicFactor = material.metalness;
                    gltfMaterial.pbrMetallicRoughness.roughnessFactor = material.roughness;
                } else if (material.isMeshBasicMaterial) {
                    gltfMaterial.pbrMetallicRoughness.metallicFactor = 0;
                    gltfMaterial.pbrMetallicRoughness.roughnessFactor = 0.9;
                } else {
                    gltfMaterial.pbrMetallicRoughness.metallicFactor = 0.5;
                    gltfMaterial.pbrMetallicRoughness.roughnessFactor = 0.5;
                }
                if (material.isGLTFSpecularGlossinessMaterial) {
                    if (gltfMaterial.pbrMetallicRoughness.baseColorFactor) {
                        gltfMaterial.extensions.KHR_materials_pbrSpecularGlossiness.diffuseFactor = gltfMaterial.pbrMetallicRoughness.baseColorFactor;
                    }
                    var specularFactor = [
                        1,
                        1,
                        1
                    ];
                    material.specular.toArray(specularFactor, 0);
                    gltfMaterial.extensions.KHR_materials_pbrSpecularGlossiness.specularFactor = specularFactor;
                    gltfMaterial.extensions.KHR_materials_pbrSpecularGlossiness.glossinessFactor = material.glossiness;
                }
                if (material.metalnessMap || material.roughnessMap) {
                    if (material.metalnessMap === material.roughnessMap) {
                        var metalRoughMapDef = { index: processTexture(material.metalnessMap) };
                        applyTextureTransform(metalRoughMapDef, material.metalnessMap);
                        gltfMaterial.pbrMetallicRoughness.metallicRoughnessTexture = metalRoughMapDef;
                    } else {
                        console.warn('THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.');
                    }
                }
                if (material.map) {
                    var baseColorMapDef = { index: processTexture(material.map) };
                    applyTextureTransform(baseColorMapDef, material.map);
                    if (material.isGLTFSpecularGlossinessMaterial) {
                        gltfMaterial.extensions.KHR_materials_pbrSpecularGlossiness.diffuseTexture = baseColorMapDef;
                    }
                    gltfMaterial.pbrMetallicRoughness.baseColorTexture = baseColorMapDef;
                }
                if (material.isGLTFSpecularGlossinessMaterial && material.specularMap) {
                    var specularMapDef = { index: processTexture(material.specularMap) };
                    applyTextureTransform(specularMapDef, material.specularMap);
                    gltfMaterial.extensions.KHR_materials_pbrSpecularGlossiness.specularGlossinessTexture = specularMapDef;
                }
                if (material.emissive) {
                    var emissive = material.emissive.clone().multiplyScalar(material.emissiveIntensity).toArray();
                    if (!equalArray(emissive, [
                            0,
                            0,
                            0
                        ])) {
                        gltfMaterial.emissiveFactor = emissive;
                    }
                    if (material.emissiveMap) {
                        var emissiveMapDef = { index: processTexture(material.emissiveMap) };
                        applyTextureTransform(emissiveMapDef, material.emissiveMap);
                        gltfMaterial.emissiveTexture = emissiveMapDef;
                    }
                }
                if (material.normalMap) {
                    var normalMapDef = { index: processTexture(material.normalMap) };
                    if (material.normalScale && material.normalScale.x !== -1) {
                        if (material.normalScale.x !== material.normalScale.y) {
                            console.warn('THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X.');
                        }
                        normalMapDef.scale = material.normalScale.x;
                    }
                    applyTextureTransform(normalMapDef, material.normalMap);
                    gltfMaterial.normalTexture = normalMapDef;
                }
                if (material.aoMap) {
                    var occlusionMapDef = {
                        index: processTexture(material.aoMap),
                        texCoord: 1
                    };
                    if (material.aoMapIntensity !== 1) {
                        occlusionMapDef.strength = material.aoMapIntensity;
                    }
                    applyTextureTransform(occlusionMapDef, material.aoMap);
                    gltfMaterial.occlusionTexture = occlusionMapDef;
                }
                if (material.transparent) {
                    gltfMaterial.alphaMode = 'BLEND';
                } else {
                    if (material.alphaTest > 0) {
                        gltfMaterial.alphaMode = 'MASK';
                        gltfMaterial.alphaCutoff = material.alphaTest;
                    }
                }
                if (material.side === THREE.DoubleSide) {
                    gltfMaterial.doubleSided = true;
                }
                if (material.name !== '') {
                    gltfMaterial.name = material.name;
                }
                serializeUserData(material, gltfMaterial);
                outputJSON.materials.push(gltfMaterial);
                var index = outputJSON.materials.length - 1;
                cachedData.materials.set(material, index);
                return index;
            }
            function processMesh(mesh) {
                var meshCacheKeyParts = [mesh.geometry.uuid];
                if (Array.isArray(mesh.material)) {
                    for (var i = 0, l = mesh.material.length; i < l; i++) {
                        meshCacheKeyParts.push(mesh.material[i].uuid);
                    }
                } else {
                    meshCacheKeyParts.push(mesh.material.uuid);
                }
                var meshCacheKey = meshCacheKeyParts.join(':');
                if (cachedData.meshes.has(meshCacheKey)) {
                    return cachedData.meshes.get(meshCacheKey);
                }
                var geometry = mesh.geometry;
                var mode;
                if (mesh.isLineSegments) {
                    mode = WEBGL_CONSTANTS.LINES;
                } else if (mesh.isLineLoop) {
                    mode = WEBGL_CONSTANTS.LINE_LOOP;
                } else if (mesh.isLine) {
                    mode = WEBGL_CONSTANTS.LINE_STRIP;
                } else if (mesh.isPoints) {
                    mode = WEBGL_CONSTANTS.POINTS;
                } else {
                    mode = mesh.material.wireframe ? WEBGL_CONSTANTS.LINES : WEBGL_CONSTANTS.TRIANGLES;
                }
                if (!geometry.isBufferGeometry) {
                    console.warn('GLTFExporter: Exporting THREE.Geometry will increase file size. Use BufferGeometry instead.');
                    geometry = new THREE.BufferGeometry().setFromObject(mesh);
                }
                var gltfMesh = {};
                var attributes = {};
                var primitives = [];
                var targets = [];
                var nameConversion = {
                    uv: 'TEXCOORD_0',
                    uv2: 'TEXCOORD_1',
                    color: 'COLOR_0',
                    skinWeight: 'WEIGHTS_0',
                    skinIndex: 'JOINTS_0'
                };
                var originalNormal = geometry.getAttribute('normal');
                if (originalNormal !== undefined && !isNormalizedNormalAttribute(originalNormal)) {
                    console.warn('THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one.');
                    geometry.setAttribute('normal', createNormalizedNormalAttribute(originalNormal));
                }
                var modifiedAttribute = null;
                for (var attributeName in geometry.attributes) {
                    if (attributeName.substr(0, 5) === 'morph')
                        continue;
                    var attribute = geometry.attributes[attributeName];
                    attributeName = nameConversion[attributeName] || attributeName.toUpperCase();
                    var validVertexAttributes = /^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/;
                    if (!validVertexAttributes.test(attributeName)) {
                        attributeName = '_' + attributeName;
                    }
                    if (cachedData.attributes.has(getUID(attribute))) {
                        attributes[attributeName] = cachedData.attributes.get(getUID(attribute));
                        continue;
                    }
                    modifiedAttribute = null;
                    var array = attribute.array;
                    if (attributeName === 'JOINTS_0' && !(array instanceof Uint16Array) && !(array instanceof Uint8Array)) {
                        console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.');
                        modifiedAttribute = new THREE.BufferAttribute(new Uint16Array(array), attribute.itemSize, attribute.normalized);
                    }
                    var accessor = processAccessor(modifiedAttribute || attribute, geometry);
                    if (accessor !== null) {
                        attributes[attributeName] = accessor;
                        cachedData.attributes.set(getUID(attribute), accessor);
                    }
                }
                if (originalNormal !== undefined)
                    geometry.setAttribute('normal', originalNormal);
                if (Object.keys(attributes).length === 0) {
                    return null;
                }
                if (mesh.morphTargetInfluences !== undefined && mesh.morphTargetInfluences.length > 0) {
                    var weights = [];
                    var targetNames = [];
                    var reverseDictionary = {};
                    if (mesh.morphTargetDictionary !== undefined) {
                        for (var key in mesh.morphTargetDictionary) {
                            reverseDictionary[mesh.morphTargetDictionary[key]] = key;
                        }
                    }
                    for (var i = 0; i < mesh.morphTargetInfluences.length; ++i) {
                        var target = {};
                        var warned = false;
                        for (var attributeName in geometry.morphAttributes) {
                            if (attributeName !== 'position' && attributeName !== 'normal') {
                                if (!warned) {
                                    console.warn('GLTFExporter: Only POSITION and NORMAL morph are supported.');
                                    warned = true;
                                }
                                continue;
                            }
                            var attribute = geometry.morphAttributes[attributeName][i];
                            var gltfAttributeName = attributeName.toUpperCase();
                            var baseAttribute = geometry.attributes[attributeName];
                            if (cachedData.attributes.has(getUID(attribute))) {
                                target[gltfAttributeName] = cachedData.attributes.get(getUID(attribute));
                                continue;
                            }
                            var relativeAttribute = attribute.clone();
                            if (!geometry.morphTargetsRelative) {
                                for (var j = 0, jl = attribute.count; j < jl; j++) {
                                    relativeAttribute.setXYZ(j, attribute.getX(j) - baseAttribute.getX(j), attribute.getY(j) - baseAttribute.getY(j), attribute.getZ(j) - baseAttribute.getZ(j));
                                }
                            }
                            target[gltfAttributeName] = processAccessor(relativeAttribute, geometry);
                            cachedData.attributes.set(getUID(baseAttribute), target[gltfAttributeName]);
                        }
                        targets.push(target);
                        weights.push(mesh.morphTargetInfluences[i]);
                        if (mesh.morphTargetDictionary !== undefined)
                            targetNames.push(reverseDictionary[i]);
                    }
                    gltfMesh.weights = weights;
                    if (targetNames.length > 0) {
                        gltfMesh.extras = {};
                        gltfMesh.extras.targetNames = targetNames;
                    }
                }
                var forceIndices = options.forceIndices;
                var isMultiMaterial = Array.isArray(mesh.material);
                if (isMultiMaterial && geometry.groups.length === 0)
                    return null;
                if (!forceIndices && geometry.index === null && isMultiMaterial) {
                    console.warn('THREE.GLTFExporter: Creating index for non-indexed multi-material mesh.');
                    forceIndices = true;
                }
                var didForceIndices = false;
                if (geometry.index === null && forceIndices) {
                    var indices = [];
                    for (var i = 0, il = geometry.attributes.position.count; i < il; i++) {
                        indices[i] = i;
                    }
                    geometry.setIndex(indices);
                    didForceIndices = true;
                }
                var materials = isMultiMaterial ? mesh.material : [mesh.material];
                var groups = isMultiMaterial ? geometry.groups : [{
                        materialIndex: 0,
                        start: undefined,
                        count: undefined
                    }];
                for (var i = 0, il = groups.length; i < il; i++) {
                    var primitive = {
                        mode: mode,
                        attributes: attributes
                    };
                    serializeUserData(geometry, primitive);
                    if (targets.length > 0)
                        primitive.targets = targets;
                    if (geometry.index !== null) {
                        var cacheKey = getUID(geometry.index);
                        if (groups[i].start !== undefined || groups[i].count !== undefined) {
                            cacheKey += ':' + groups[i].start + ':' + groups[i].count;
                        }
                        if (cachedData.attributes.has(cacheKey)) {
                            primitive.indices = cachedData.attributes.get(cacheKey);
                        } else {
                            primitive.indices = processAccessor(geometry.index, geometry, groups[i].start, groups[i].count);
                            cachedData.attributes.set(cacheKey, primitive.indices);
                        }
                        if (primitive.indices === null)
                            delete primitive.indices;
                    }
                    var material = processMaterial(materials[groups[i].materialIndex]);
                    if (material !== null) {
                        primitive.material = material;
                    }
                    primitives.push(primitive);
                }
                if (didForceIndices) {
                    geometry.setIndex(null);
                }
                gltfMesh.primitives = primitives;
                if (!outputJSON.meshes) {
                    outputJSON.meshes = [];
                }
                outputJSON.meshes.push(gltfMesh);
                var index = outputJSON.meshes.length - 1;
                cachedData.meshes.set(meshCacheKey, index);
                return index;
            }
            function processCamera(camera) {
                if (!outputJSON.cameras) {
                    outputJSON.cameras = [];
                }
                var isOrtho = camera.isOrthographicCamera;
                var gltfCamera = { type: isOrtho ? 'orthographic' : 'perspective' };
                if (isOrtho) {
                    gltfCamera.orthographic = {
                        xmag: camera.right * 2,
                        ymag: camera.top * 2,
                        zfar: camera.far <= 0 ? 0.001 : camera.far,
                        znear: camera.near < 0 ? 0 : camera.near
                    };
                } else {
                    gltfCamera.perspective = {
                        aspectRatio: camera.aspect,
                        yfov: THREE.MathUtils.degToRad(camera.fov),
                        zfar: camera.far <= 0 ? 0.001 : camera.far,
                        znear: camera.near < 0 ? 0 : camera.near
                    };
                }
                if (camera.name !== '') {
                    gltfCamera.name = camera.type;
                }
                outputJSON.cameras.push(gltfCamera);
                return outputJSON.cameras.length - 1;
            }
            function processAnimation(clip, root) {
                if (!outputJSON.animations) {
                    outputJSON.animations = [];
                }
                clip = GLTFExporter.Utils.mergeMorphTargetTracks(clip.clone(), root);
                var tracks = clip.tracks;
                var channels = [];
                var samplers = [];
                for (var i = 0; i < tracks.length; ++i) {
                    var track = tracks[i];
                    var trackBinding = THREE.PropertyBinding.parseTrackName(track.name);
                    var trackNode = THREE.PropertyBinding.findNode(root, trackBinding.nodeName);
                    var trackProperty = PATH_PROPERTIES[trackBinding.propertyName];
                    if (trackBinding.objectName === 'bones') {
                        if (trackNode.isSkinnedMesh === true) {
                            trackNode = trackNode.skeleton.getBoneByName(trackBinding.objectIndex);
                        } else {
                            trackNode = undefined;
                        }
                    }
                    if (!trackNode || !trackProperty) {
                        console.warn('THREE.GLTFExporter: Could not export animation track "%s".', track.name);
                        return null;
                    }
                    var inputItemSize = 1;
                    var outputItemSize = track.values.length / track.times.length;
                    if (trackProperty === PATH_PROPERTIES.morphTargetInfluences) {
                        outputItemSize /= trackNode.morphTargetInfluences.length;
                    }
                    var interpolation;
                    if (track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline === true) {
                        interpolation = 'CUBICSPLINE';
                        outputItemSize /= 3;
                    } else if (track.getInterpolation() === THREE.InterpolateDiscrete) {
                        interpolation = 'STEP';
                    } else {
                        interpolation = 'LINEAR';
                    }
                    samplers.push({
                        input: processAccessor(new THREE.BufferAttribute(track.times, inputItemSize)),
                        output: processAccessor(new THREE.BufferAttribute(track.values, outputItemSize)),
                        interpolation: interpolation
                    });
                    channels.push({
                        sampler: samplers.length - 1,
                        target: {
                            node: nodeMap.get(trackNode),
                            path: trackProperty
                        }
                    });
                }
                outputJSON.animations.push({
                    name: clip.name || 'clip_' + outputJSON.animations.length,
                    samplers: samplers,
                    channels: channels
                });
                return outputJSON.animations.length - 1;
            }
            function processSkin(object) {
                var node = outputJSON.nodes[nodeMap.get(object)];
                var skeleton = object.skeleton;
                if (skeleton === undefined)
                    return null;
                var rootJoint = object.skeleton.bones[0];
                if (rootJoint === undefined)
                    return null;
                var joints = [];
                var inverseBindMatrices = new Float32Array(skeleton.bones.length * 16);
                for (var i = 0; i < skeleton.bones.length; ++i) {
                    joints.push(nodeMap.get(skeleton.bones[i]));
                    skeleton.boneInverses[i].toArray(inverseBindMatrices, i * 16);
                }
                if (outputJSON.skins === undefined) {
                    outputJSON.skins = [];
                }
                outputJSON.skins.push({
                    inverseBindMatrices: processAccessor(new THREE.BufferAttribute(inverseBindMatrices, 16)),
                    joints: joints,
                    skeleton: nodeMap.get(rootJoint)
                });
                var skinIndex = node.skin = outputJSON.skins.length - 1;
                return skinIndex;
            }
            function processLight(light) {
                var lightDef = {};
                if (light.name)
                    lightDef.name = light.name;
                lightDef.color = light.color.toArray();
                lightDef.intensity = light.intensity;
                if (light.isDirectionalLight) {
                    lightDef.type = 'directional';
                } else if (light.isPointLight) {
                    lightDef.type = 'point';
                    if (light.distance > 0)
                        lightDef.range = light.distance;
                } else if (light.isSpotLight) {
                    lightDef.type = 'spot';
                    if (light.distance > 0)
                        lightDef.range = light.distance;
                    lightDef.spot = {};
                    lightDef.spot.innerConeAngle = (light.penumbra - 1) * light.angle * -1;
                    lightDef.spot.outerConeAngle = light.angle;
                }
                if (light.decay !== undefined && light.decay !== 2) {
                    console.warn('THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, ' + 'and expects light.decay=2.');
                }
                if (light.target && (light.target.parent !== light || light.target.position.x !== 0 || light.target.position.y !== 0 || light.target.position.z !== -1)) {
                    console.warn('THREE.GLTFExporter: Light direction may be lost. For best results, ' + 'make light.target a child of the light with position 0,0,-1.');
                }
                var lights = outputJSON.extensions['KHR_lights_punctual'].lights;
                lights.push(lightDef);
                return lights.length - 1;
            }
            function processNode(object) {
                if (!outputJSON.nodes) {
                    outputJSON.nodes = [];
                }
                var gltfNode = {};
                if (options.trs) {
                    var rotation = object.quaternion.toArray();
                    var position = object.position.toArray();
                    var scale = object.scale.toArray();
                    if (!equalArray(rotation, [
                            0,
                            0,
                            0,
                            1
                        ])) {
                        gltfNode.rotation = rotation;
                    }
                    if (!equalArray(position, [
                            0,
                            0,
                            0
                        ])) {
                        gltfNode.translation = position;
                    }
                    if (!equalArray(scale, [
                            1,
                            1,
                            1
                        ])) {
                        gltfNode.scale = scale;
                    }
                } else {
                    if (object.matrixAutoUpdate) {
                        object.updateMatrix();
                    }
                    if (!equalArray(object.matrix.elements, [
                            1,
                            0,
                            0,
                            0,
                            0,
                            1,
                            0,
                            0,
                            0,
                            0,
                            1,
                            0,
                            0,
                            0,
                            0,
                            1
                        ])) {
                        gltfNode.matrix = object.matrix.elements;
                    }
                }
                if (object.name !== '') {
                    gltfNode.name = String(object.name);
                }
                serializeUserData(object, gltfNode);
                if (object.isMesh || object.isLine || object.isPoints) {
                    var mesh = processMesh(object);
                    if (mesh !== null) {
                        gltfNode.mesh = mesh;
                    }
                } else if (object.isCamera) {
                    gltfNode.camera = processCamera(object);
                } else if (object.isDirectionalLight || object.isPointLight || object.isSpotLight) {
                    if (!extensionsUsed['KHR_lights_punctual']) {
                        outputJSON.extensions = outputJSON.extensions || {};
                        outputJSON.extensions['KHR_lights_punctual'] = { lights: [] };
                        extensionsUsed['KHR_lights_punctual'] = true;
                    }
                    gltfNode.extensions = gltfNode.extensions || {};
                    gltfNode.extensions['KHR_lights_punctual'] = { light: processLight(object) };
                } else if (object.isLight) {
                    console.warn('THREE.GLTFExporter: Only directional, point, and spot lights are supported.', object);
                    return null;
                }
                if (object.isSkinnedMesh) {
                    skins.push(object);
                }
                if (object.children.length > 0) {
                    var children = [];
                    for (var i = 0, l = object.children.length; i < l; i++) {
                        var child = object.children[i];
                        if (child.visible || options.onlyVisible === false) {
                            var node = processNode(child);
                            if (node !== null) {
                                children.push(node);
                            }
                        }
                    }
                    if (children.length > 0) {
                        gltfNode.children = children;
                    }
                }
                outputJSON.nodes.push(gltfNode);
                var nodeIndex = outputJSON.nodes.length - 1;
                nodeMap.set(object, nodeIndex);
                return nodeIndex;
            }
            function processScene(scene) {
                if (!outputJSON.scenes) {
                    outputJSON.scenes = [];
                    outputJSON.scene = 0;
                }
                var gltfScene = {};
                if (scene.name !== '') {
                    gltfScene.name = scene.name;
                }
                outputJSON.scenes.push(gltfScene);
                var nodes = [];
                for (var i = 0, l = scene.children.length; i < l; i++) {
                    var child = scene.children[i];
                    if (child.visible || options.onlyVisible === false) {
                        var node = processNode(child);
                        if (node !== null) {
                            nodes.push(node);
                        }
                    }
                }
                if (nodes.length > 0) {
                    gltfScene.nodes = nodes;
                }
                serializeUserData(scene, gltfScene);
            }
            function processObjects(objects) {
                var scene = new THREE.Scene();
                scene.name = 'AuxScene';
                for (var i = 0; i < objects.length; i++) {
                    scene.children.push(objects[i]);
                }
                processScene(scene);
            }
            function processInput(input) {
                input = input instanceof Array ? input : [input];
                var objectsWithoutScene = [];
                for (var i = 0; i < input.length; i++) {
                    if (input[i] instanceof THREE.Scene) {
                        processScene(input[i]);
                    } else {
                        objectsWithoutScene.push(input[i]);
                    }
                }
                if (objectsWithoutScene.length > 0) {
                    processObjects(objectsWithoutScene);
                }
                for (var i = 0; i < skins.length; ++i) {
                    processSkin(skins[i]);
                }
                for (var i = 0; i < options.animations.length; ++i) {
                    processAnimation(options.animations[i], input[0]);
                }
            }
            processInput(input);
            Promise.all(pending).then(function () {
                var blob = new Blob(buffers, { type: 'application/octet-stream' });
                var extensionsUsedList = Object.keys(extensionsUsed);
                if (extensionsUsedList.length > 0)
                    outputJSON.extensionsUsed = extensionsUsedList;
                if (outputJSON.buffers && outputJSON.buffers.length > 0)
                    outputJSON.buffers[0].byteLength = blob.size;
                if (options.binary === true) {
                    var GLB_HEADER_BYTES = 12;
                    var GLB_HEADER_MAGIC = 1179937895;
                    var GLB_VERSION = 2;
                    var GLB_CHUNK_PREFIX_BYTES = 8;
                    var GLB_CHUNK_TYPE_JSON = 1313821514;
                    var GLB_CHUNK_TYPE_BIN = 5130562;
                    var reader = new window.FileReader();
                    reader.readAsArrayBuffer(blob);
                    reader.onloadend = function () {
                        var binaryChunk = getPaddedArrayBuffer(reader.result);
                        var binaryChunkPrefix = new DataView(new ArrayBuffer(GLB_CHUNK_PREFIX_BYTES));
                        binaryChunkPrefix.setUint32(0, binaryChunk.byteLength, true);
                        binaryChunkPrefix.setUint32(4, GLB_CHUNK_TYPE_BIN, true);
                        var jsonChunk = getPaddedArrayBuffer(stringToArrayBuffer(JSON.stringify(outputJSON)), 32);
                        var jsonChunkPrefix = new DataView(new ArrayBuffer(GLB_CHUNK_PREFIX_BYTES));
                        jsonChunkPrefix.setUint32(0, jsonChunk.byteLength, true);
                        jsonChunkPrefix.setUint32(4, GLB_CHUNK_TYPE_JSON, true);
                        var header = new ArrayBuffer(GLB_HEADER_BYTES);
                        var headerView = new DataView(header);
                        headerView.setUint32(0, GLB_HEADER_MAGIC, true);
                        headerView.setUint32(4, GLB_VERSION, true);
                        var totalByteLength = GLB_HEADER_BYTES + jsonChunkPrefix.byteLength + jsonChunk.byteLength + binaryChunkPrefix.byteLength + binaryChunk.byteLength;
                        headerView.setUint32(8, totalByteLength, true);
                        var glbBlob = new Blob([
                            header,
                            jsonChunkPrefix,
                            jsonChunk,
                            binaryChunkPrefix,
                            binaryChunk
                        ], { type: 'application/octet-stream' });
                        var glbReader = new window.FileReader();
                        glbReader.readAsArrayBuffer(glbBlob);
                        glbReader.onloadend = function () {
                            onDone(glbReader.result);
                        };
                    };
                } else {
                    if (outputJSON.buffers && outputJSON.buffers.length > 0) {
                        var reader = new window.FileReader();
                        reader.readAsDataURL(blob);
                        reader.onloadend = function () {
                            var base64data = reader.result;
                            outputJSON.buffers[0].uri = base64data;
                            onDone(outputJSON);
                        };
                    } else {
                        onDone(outputJSON);
                    }
                }
            });
        }
    };
    GLTFExporter.Utils = {
        insertKeyframe: function (track, time) {
            var tolerance = 0.001;
            var valueSize = track.getValueSize();
            var times = new track.TimeBufferType(track.times.length + 1);
            var values = new track.ValueBufferType(track.values.length + valueSize);
            var interpolant = track.createInterpolant(new track.ValueBufferType(valueSize));
            var index;
            if (track.times.length === 0) {
                times[0] = time;
                for (var i = 0; i < valueSize; i++) {
                    values[i] = 0;
                }
                index = 0;
            } else if (time < track.times[0]) {
                if (Math.abs(track.times[0] - time) < tolerance)
                    return 0;
                times[0] = time;
                times.set(track.times, 1);
                values.set(interpolant.evaluate(time), 0);
                values.set(track.values, valueSize);
                index = 0;
            } else if (time > track.times[track.times.length - 1]) {
                if (Math.abs(track.times[track.times.length - 1] - time) < tolerance) {
                    return track.times.length - 1;
                }
                times[times.length - 1] = time;
                times.set(track.times, 0);
                values.set(track.values, 0);
                values.set(interpolant.evaluate(time), track.values.length);
                index = times.length - 1;
            } else {
                for (var i = 0; i < track.times.length; i++) {
                    if (Math.abs(track.times[i] - time) < tolerance)
                        return i;
                    if (track.times[i] < time && track.times[i + 1] > time) {
                        times.set(track.times.slice(0, i + 1), 0);
                        times[i + 1] = time;
                        times.set(track.times.slice(i + 1), i + 2);
                        values.set(track.values.slice(0, (i + 1) * valueSize), 0);
                        values.set(interpolant.evaluate(time), (i + 1) * valueSize);
                        values.set(track.values.slice((i + 1) * valueSize), (i + 2) * valueSize);
                        index = i + 1;
                        break;
                    }
                }
            }
            track.times = times;
            track.values = values;
            return index;
        },
        mergeMorphTargetTracks: function (clip, root) {
            var tracks = [];
            var mergedTracks = {};
            var sourceTracks = clip.tracks;
            for (var i = 0; i < sourceTracks.length; ++i) {
                var sourceTrack = sourceTracks[i];
                var sourceTrackBinding = THREE.PropertyBinding.parseTrackName(sourceTrack.name);
                var sourceTrackNode = THREE.PropertyBinding.findNode(root, sourceTrackBinding.nodeName);
                if (sourceTrackBinding.propertyName !== 'morphTargetInfluences' || sourceTrackBinding.propertyIndex === undefined) {
                    tracks.push(sourceTrack);
                    continue;
                }
                if (sourceTrack.createInterpolant !== sourceTrack.InterpolantFactoryMethodDiscrete && sourceTrack.createInterpolant !== sourceTrack.InterpolantFactoryMethodLinear) {
                    if (sourceTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline) {
                        throw new Error('THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.');
                    }
                    console.warn('THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead.');
                    sourceTrack = sourceTrack.clone();
                    sourceTrack.setInterpolation(THREE.InterpolateLinear);
                }
                var targetCount = sourceTrackNode.morphTargetInfluences.length;
                var targetIndex = sourceTrackNode.morphTargetDictionary[sourceTrackBinding.propertyIndex];
                if (targetIndex === undefined) {
                    throw new Error('THREE.GLTFExporter: Morph target name not found: ' + sourceTrackBinding.propertyIndex);
                }
                var mergedTrack;
                if (mergedTracks[sourceTrackNode.uuid] === undefined) {
                    mergedTrack = sourceTrack.clone();
                    var values = new mergedTrack.ValueBufferType(targetCount * mergedTrack.times.length);
                    for (var j = 0; j < mergedTrack.times.length; j++) {
                        values[j * targetCount + targetIndex] = mergedTrack.values[j];
                    }
                    mergedTrack.name = '.morphTargetInfluences';
                    mergedTrack.values = values;
                    mergedTracks[sourceTrackNode.uuid] = mergedTrack;
                    tracks.push(mergedTrack);
                    continue;
                }
                var sourceInterpolant = sourceTrack.createInterpolant(new sourceTrack.ValueBufferType(1));
                mergedTrack = mergedTracks[sourceTrackNode.uuid];
                for (var j = 0; j < mergedTrack.times.length; j++) {
                    mergedTrack.values[j * targetCount + targetIndex] = sourceInterpolant.evaluate(mergedTrack.times[j]);
                }
                for (var j = 0; j < sourceTrack.times.length; j++) {
                    var keyframeIndex = this.insertKeyframe(mergedTrack, sourceTrack.times[j]);
                    mergedTrack.values[keyframeIndex * targetCount + targetIndex] = sourceTrack.values[j];
                }
            }
            clip.tracks = tracks;
            return clip;
        }
    };
    return threex.exporters.GLTFExporter = GLTFExporter;
});
define('skylark-threejs-ex/utils/mmdparser',[],function(){


	/**
	 * @author Takahiro / https://github.com/takahirox
	 *
	 * Simple CharsetEncoder.
	 */

	function CharsetEncoder() {
	}

	/*
	 * Converts from Shift_JIS Uint8Array data to Unicode strings.
	 */
	CharsetEncoder.prototype.s2u = function ( uint8Array ) {

		var t = this.s2uTable;
		var str = '';
		var p = 0;

		while ( p < uint8Array.length ) {

			var key = uint8Array[ p ++ ];

			if ( ! ( ( key >= 0x00 && key <= 0x7e ) ||
	          ( key >= 0xa1 && key <= 0xdf ) ) &&
	       p < uint8Array.length ) {

				key = ( key << 8 ) | uint8Array[ p ++ ];

			}

			if ( t[ key ] === undefined ) {

				throw 'unknown char code ' + key + '.';

			}

			str += String.fromCharCode( t[ key ] );

		}

		return str;

	};

	CharsetEncoder.prototype.s2uTable = {
		0: 0,
		1: 1,
		2: 2,
		3: 3,
		4: 4,
		5: 5,
		6: 6,
		7: 7,
		8: 8,
		9: 9,
		10: 10,
		11: 11,
		12: 12,
		13: 13,
		14: 14,
		15: 15,
		16: 16,
		17: 17,
		18: 18,
		19: 19,
		20: 20,
		21: 21,
		22: 22,
		23: 23,
		24: 24,
		25: 25,
		26: 26,
		27: 27,
		28: 28,
		29: 29,
		30: 30,
		31: 31,
		32: 32,
		33: 33,
		34: 34,
		35: 35,
		36: 36,
		37: 37,
		38: 38,
		39: 39,
		40: 40,
		41: 41,
		42: 42,
		43: 43,
		44: 44,
		45: 45,
		46: 46,
		47: 47,
		48: 48,
		49: 49,
		50: 50,
		51: 51,
		52: 52,
		53: 53,
		54: 54,
		55: 55,
		56: 56,
		57: 57,
		58: 58,
		59: 59,
		60: 60,
		61: 61,
		62: 62,
		63: 63,
		64: 64,
		65: 65,
		66: 66,
		67: 67,
		68: 68,
		69: 69,
		70: 70,
		71: 71,
		72: 72,
		73: 73,
		74: 74,
		75: 75,
		76: 76,
		77: 77,
		78: 78,
		79: 79,
		80: 80,
		81: 81,
		82: 82,
		83: 83,
		84: 84,
		85: 85,
		86: 86,
		87: 87,
		88: 88,
		89: 89,
		90: 90,
		91: 91,
		92: 92,
		93: 93,
		94: 94,
		95: 95,
		96: 96,
		97: 97,
		98: 98,
		99: 99,
		100: 100,
		101: 101,
		102: 102,
		103: 103,
		104: 104,
		105: 105,
		106: 106,
		107: 107,
		108: 108,
		109: 109,
		110: 110,
		111: 111,
		112: 112,
		113: 113,
		114: 114,
		115: 115,
		116: 116,
		117: 117,
		118: 118,
		119: 119,
		120: 120,
		121: 121,
		122: 122,
		123: 123,
		124: 124,
		125: 125,
		126: 126,
		161: 65377,
		162: 65378,
		163: 65379,
		164: 65380,
		165: 65381,
		166: 65382,
		167: 65383,
		168: 65384,
		169: 65385,
		170: 65386,
		171: 65387,
		172: 65388,
		173: 65389,
		174: 65390,
		175: 65391,
		176: 65392,
		177: 65393,
		178: 65394,
		179: 65395,
		180: 65396,
		181: 65397,
		182: 65398,
		183: 65399,
		184: 65400,
		185: 65401,
		186: 65402,
		187: 65403,
		188: 65404,
		189: 65405,
		190: 65406,
		191: 65407,
		192: 65408,
		193: 65409,
		194: 65410,
		195: 65411,
		196: 65412,
		197: 65413,
		198: 65414,
		199: 65415,
		200: 65416,
		201: 65417,
		202: 65418,
		203: 65419,
		204: 65420,
		205: 65421,
		206: 65422,
		207: 65423,
		208: 65424,
		209: 65425,
		210: 65426,
		211: 65427,
		212: 65428,
		213: 65429,
		214: 65430,
		215: 65431,
		216: 65432,
		217: 65433,
		218: 65434,
		219: 65435,
		220: 65436,
		221: 65437,
		222: 65438,
		223: 65439,
		33088: 12288,
		33089: 12289,
		33090: 12290,
		33091: 65292,
		33092: 65294,
		33093: 12539,
		33094: 65306,
		33095: 65307,
		33096: 65311,
		33097: 65281,
		33098: 12443,
		33099: 12444,
		33100: 180,
		33101: 65344,
		33102: 168,
		33103: 65342,
		33104: 65507,
		33105: 65343,
		33106: 12541,
		33107: 12542,
		33108: 12445,
		33109: 12446,
		33110: 12291,
		33111: 20189,
		33112: 12293,
		33113: 12294,
		33114: 12295,
		33115: 12540,
		33116: 8213,
		33117: 8208,
		33118: 65295,
		33119: 65340,
		33120: 65374,
		33121: 8741,
		33122: 65372,
		33123: 8230,
		33124: 8229,
		33125: 8216,
		33126: 8217,
		33127: 8220,
		33128: 8221,
		33129: 65288,
		33130: 65289,
		33131: 12308,
		33132: 12309,
		33133: 65339,
		33134: 65341,
		33135: 65371,
		33136: 65373,
		33137: 12296,
		33138: 12297,
		33139: 12298,
		33140: 12299,
		33141: 12300,
		33142: 12301,
		33143: 12302,
		33144: 12303,
		33145: 12304,
		33146: 12305,
		33147: 65291,
		33148: 65293,
		33149: 177,
		33150: 215,
		33152: 247,
		33153: 65309,
		33154: 8800,
		33155: 65308,
		33156: 65310,
		33157: 8806,
		33158: 8807,
		33159: 8734,
		33160: 8756,
		33161: 9794,
		33162: 9792,
		33163: 176,
		33164: 8242,
		33165: 8243,
		33166: 8451,
		33167: 65509,
		33168: 65284,
		33169: 65504,
		33170: 65505,
		33171: 65285,
		33172: 65283,
		33173: 65286,
		33174: 65290,
		33175: 65312,
		33176: 167,
		33177: 9734,
		33178: 9733,
		33179: 9675,
		33180: 9679,
		33181: 9678,
		33182: 9671,
		33183: 9670,
		33184: 9633,
		33185: 9632,
		33186: 9651,
		33187: 9650,
		33188: 9661,
		33189: 9660,
		33190: 8251,
		33191: 12306,
		33192: 8594,
		33193: 8592,
		33194: 8593,
		33195: 8595,
		33196: 12307,
		33208: 8712,
		33209: 8715,
		33210: 8838,
		33211: 8839,
		33212: 8834,
		33213: 8835,
		33214: 8746,
		33215: 8745,
		33224: 8743,
		33225: 8744,
		33226: 65506,
		33227: 8658,
		33228: 8660,
		33229: 8704,
		33230: 8707,
		33242: 8736,
		33243: 8869,
		33244: 8978,
		33245: 8706,
		33246: 8711,
		33247: 8801,
		33248: 8786,
		33249: 8810,
		33250: 8811,
		33251: 8730,
		33252: 8765,
		33253: 8733,
		33254: 8757,
		33255: 8747,
		33256: 8748,
		33264: 8491,
		33265: 8240,
		33266: 9839,
		33267: 9837,
		33268: 9834,
		33269: 8224,
		33270: 8225,
		33271: 182,
		33276: 9711,
		33359: 65296,
		33360: 65297,
		33361: 65298,
		33362: 65299,
		33363: 65300,
		33364: 65301,
		33365: 65302,
		33366: 65303,
		33367: 65304,
		33368: 65305,
		33376: 65313,
		33377: 65314,
		33378: 65315,
		33379: 65316,
		33380: 65317,
		33381: 65318,
		33382: 65319,
		33383: 65320,
		33384: 65321,
		33385: 65322,
		33386: 65323,
		33387: 65324,
		33388: 65325,
		33389: 65326,
		33390: 65327,
		33391: 65328,
		33392: 65329,
		33393: 65330,
		33394: 65331,
		33395: 65332,
		33396: 65333,
		33397: 65334,
		33398: 65335,
		33399: 65336,
		33400: 65337,
		33401: 65338,
		33409: 65345,
		33410: 65346,
		33411: 65347,
		33412: 65348,
		33413: 65349,
		33414: 65350,
		33415: 65351,
		33416: 65352,
		33417: 65353,
		33418: 65354,
		33419: 65355,
		33420: 65356,
		33421: 65357,
		33422: 65358,
		33423: 65359,
		33424: 65360,
		33425: 65361,
		33426: 65362,
		33427: 65363,
		33428: 65364,
		33429: 65365,
		33430: 65366,
		33431: 65367,
		33432: 65368,
		33433: 65369,
		33434: 65370,
		33439: 12353,
		33440: 12354,
		33441: 12355,
		33442: 12356,
		33443: 12357,
		33444: 12358,
		33445: 12359,
		33446: 12360,
		33447: 12361,
		33448: 12362,
		33449: 12363,
		33450: 12364,
		33451: 12365,
		33452: 12366,
		33453: 12367,
		33454: 12368,
		33455: 12369,
		33456: 12370,
		33457: 12371,
		33458: 12372,
		33459: 12373,
		33460: 12374,
		33461: 12375,
		33462: 12376,
		33463: 12377,
		33464: 12378,
		33465: 12379,
		33466: 12380,
		33467: 12381,
		33468: 12382,
		33469: 12383,
		33470: 12384,
		33471: 12385,
		33472: 12386,
		33473: 12387,
		33474: 12388,
		33475: 12389,
		33476: 12390,
		33477: 12391,
		33478: 12392,
		33479: 12393,
		33480: 12394,
		33481: 12395,
		33482: 12396,
		33483: 12397,
		33484: 12398,
		33485: 12399,
		33486: 12400,
		33487: 12401,
		33488: 12402,
		33489: 12403,
		33490: 12404,
		33491: 12405,
		33492: 12406,
		33493: 12407,
		33494: 12408,
		33495: 12409,
		33496: 12410,
		33497: 12411,
		33498: 12412,
		33499: 12413,
		33500: 12414,
		33501: 12415,
		33502: 12416,
		33503: 12417,
		33504: 12418,
		33505: 12419,
		33506: 12420,
		33507: 12421,
		33508: 12422,
		33509: 12423,
		33510: 12424,
		33511: 12425,
		33512: 12426,
		33513: 12427,
		33514: 12428,
		33515: 12429,
		33516: 12430,
		33517: 12431,
		33518: 12432,
		33519: 12433,
		33520: 12434,
		33521: 12435,
		33600: 12449,
		33601: 12450,
		33602: 12451,
		33603: 12452,
		33604: 12453,
		33605: 12454,
		33606: 12455,
		33607: 12456,
		33608: 12457,
		33609: 12458,
		33610: 12459,
		33611: 12460,
		33612: 12461,
		33613: 12462,
		33614: 12463,
		33615: 12464,
		33616: 12465,
		33617: 12466,
		33618: 12467,
		33619: 12468,
		33620: 12469,
		33621: 12470,
		33622: 12471,
		33623: 12472,
		33624: 12473,
		33625: 12474,
		33626: 12475,
		33627: 12476,
		33628: 12477,
		33629: 12478,
		33630: 12479,
		33631: 12480,
		33632: 12481,
		33633: 12482,
		33634: 12483,
		33635: 12484,
		33636: 12485,
		33637: 12486,
		33638: 12487,
		33639: 12488,
		33640: 12489,
		33641: 12490,
		33642: 12491,
		33643: 12492,
		33644: 12493,
		33645: 12494,
		33646: 12495,
		33647: 12496,
		33648: 12497,
		33649: 12498,
		33650: 12499,
		33651: 12500,
		33652: 12501,
		33653: 12502,
		33654: 12503,
		33655: 12504,
		33656: 12505,
		33657: 12506,
		33658: 12507,
		33659: 12508,
		33660: 12509,
		33661: 12510,
		33662: 12511,
		33664: 12512,
		33665: 12513,
		33666: 12514,
		33667: 12515,
		33668: 12516,
		33669: 12517,
		33670: 12518,
		33671: 12519,
		33672: 12520,
		33673: 12521,
		33674: 12522,
		33675: 12523,
		33676: 12524,
		33677: 12525,
		33678: 12526,
		33679: 12527,
		33680: 12528,
		33681: 12529,
		33682: 12530,
		33683: 12531,
		33684: 12532,
		33685: 12533,
		33686: 12534,
		33695: 913,
		33696: 914,
		33697: 915,
		33698: 916,
		33699: 917,
		33700: 918,
		33701: 919,
		33702: 920,
		33703: 921,
		33704: 922,
		33705: 923,
		33706: 924,
		33707: 925,
		33708: 926,
		33709: 927,
		33710: 928,
		33711: 929,
		33712: 931,
		33713: 932,
		33714: 933,
		33715: 934,
		33716: 935,
		33717: 936,
		33718: 937,
		33727: 945,
		33728: 946,
		33729: 947,
		33730: 948,
		33731: 949,
		33732: 950,
		33733: 951,
		33734: 952,
		33735: 953,
		33736: 954,
		33737: 955,
		33738: 956,
		33739: 957,
		33740: 958,
		33741: 959,
		33742: 960,
		33743: 961,
		33744: 963,
		33745: 964,
		33746: 965,
		33747: 966,
		33748: 967,
		33749: 968,
		33750: 969,
		33856: 1040,
		33857: 1041,
		33858: 1042,
		33859: 1043,
		33860: 1044,
		33861: 1045,
		33862: 1025,
		33863: 1046,
		33864: 1047,
		33865: 1048,
		33866: 1049,
		33867: 1050,
		33868: 1051,
		33869: 1052,
		33870: 1053,
		33871: 1054,
		33872: 1055,
		33873: 1056,
		33874: 1057,
		33875: 1058,
		33876: 1059,
		33877: 1060,
		33878: 1061,
		33879: 1062,
		33880: 1063,
		33881: 1064,
		33882: 1065,
		33883: 1066,
		33884: 1067,
		33885: 1068,
		33886: 1069,
		33887: 1070,
		33888: 1071,
		33904: 1072,
		33905: 1073,
		33906: 1074,
		33907: 1075,
		33908: 1076,
		33909: 1077,
		33910: 1105,
		33911: 1078,
		33912: 1079,
		33913: 1080,
		33914: 1081,
		33915: 1082,
		33916: 1083,
		33917: 1084,
		33918: 1085,
		33920: 1086,
		33921: 1087,
		33922: 1088,
		33923: 1089,
		33924: 1090,
		33925: 1091,
		33926: 1092,
		33927: 1093,
		33928: 1094,
		33929: 1095,
		33930: 1096,
		33931: 1097,
		33932: 1098,
		33933: 1099,
		33934: 1100,
		33935: 1101,
		33936: 1102,
		33937: 1103,
		33951: 9472,
		33952: 9474,
		33953: 9484,
		33954: 9488,
		33955: 9496,
		33956: 9492,
		33957: 9500,
		33958: 9516,
		33959: 9508,
		33960: 9524,
		33961: 9532,
		33962: 9473,
		33963: 9475,
		33964: 9487,
		33965: 9491,
		33966: 9499,
		33967: 9495,
		33968: 9507,
		33969: 9523,
		33970: 9515,
		33971: 9531,
		33972: 9547,
		33973: 9504,
		33974: 9519,
		33975: 9512,
		33976: 9527,
		33977: 9535,
		33978: 9501,
		33979: 9520,
		33980: 9509,
		33981: 9528,
		33982: 9538,
		34624: 9312,
		34625: 9313,
		34626: 9314,
		34627: 9315,
		34628: 9316,
		34629: 9317,
		34630: 9318,
		34631: 9319,
		34632: 9320,
		34633: 9321,
		34634: 9322,
		34635: 9323,
		34636: 9324,
		34637: 9325,
		34638: 9326,
		34639: 9327,
		34640: 9328,
		34641: 9329,
		34642: 9330,
		34643: 9331,
		34644: 8544,
		34645: 8545,
		34646: 8546,
		34647: 8547,
		34648: 8548,
		34649: 8549,
		34650: 8550,
		34651: 8551,
		34652: 8552,
		34653: 8553,
		34655: 13129,
		34656: 13076,
		34657: 13090,
		34658: 13133,
		34659: 13080,
		34660: 13095,
		34661: 13059,
		34662: 13110,
		34663: 13137,
		34664: 13143,
		34665: 13069,
		34666: 13094,
		34667: 13091,
		34668: 13099,
		34669: 13130,
		34670: 13115,
		34671: 13212,
		34672: 13213,
		34673: 13214,
		34674: 13198,
		34675: 13199,
		34676: 13252,
		34677: 13217,
		34686: 13179,
		34688: 12317,
		34689: 12319,
		34690: 8470,
		34691: 13261,
		34692: 8481,
		34693: 12964,
		34694: 12965,
		34695: 12966,
		34696: 12967,
		34697: 12968,
		34698: 12849,
		34699: 12850,
		34700: 12857,
		34701: 13182,
		34702: 13181,
		34703: 13180,
		34704: 8786,
		34705: 8801,
		34706: 8747,
		34707: 8750,
		34708: 8721,
		34709: 8730,
		34710: 8869,
		34711: 8736,
		34712: 8735,
		34713: 8895,
		34714: 8757,
		34715: 8745,
		34716: 8746,
		34975: 20124,
		34976: 21782,
		34977: 23043,
		34978: 38463,
		34979: 21696,
		34980: 24859,
		34981: 25384,
		34982: 23030,
		34983: 36898,
		34984: 33909,
		34985: 33564,
		34986: 31312,
		34987: 24746,
		34988: 25569,
		34989: 28197,
		34990: 26093,
		34991: 33894,
		34992: 33446,
		34993: 39925,
		34994: 26771,
		34995: 22311,
		34996: 26017,
		34997: 25201,
		34998: 23451,
		34999: 22992,
		35000: 34427,
		35001: 39156,
		35002: 32098,
		35003: 32190,
		35004: 39822,
		35005: 25110,
		35006: 31903,
		35007: 34999,
		35008: 23433,
		35009: 24245,
		35010: 25353,
		35011: 26263,
		35012: 26696,
		35013: 38343,
		35014: 38797,
		35015: 26447,
		35016: 20197,
		35017: 20234,
		35018: 20301,
		35019: 20381,
		35020: 20553,
		35021: 22258,
		35022: 22839,
		35023: 22996,
		35024: 23041,
		35025: 23561,
		35026: 24799,
		35027: 24847,
		35028: 24944,
		35029: 26131,
		35030: 26885,
		35031: 28858,
		35032: 30031,
		35033: 30064,
		35034: 31227,
		35035: 32173,
		35036: 32239,
		35037: 32963,
		35038: 33806,
		35039: 34915,
		35040: 35586,
		35041: 36949,
		35042: 36986,
		35043: 21307,
		35044: 20117,
		35045: 20133,
		35046: 22495,
		35047: 32946,
		35048: 37057,
		35049: 30959,
		35050: 19968,
		35051: 22769,
		35052: 28322,
		35053: 36920,
		35054: 31282,
		35055: 33576,
		35056: 33419,
		35057: 39983,
		35058: 20801,
		35059: 21360,
		35060: 21693,
		35061: 21729,
		35062: 22240,
		35063: 23035,
		35064: 24341,
		35065: 39154,
		35066: 28139,
		35067: 32996,
		35068: 34093,
		35136: 38498,
		35137: 38512,
		35138: 38560,
		35139: 38907,
		35140: 21515,
		35141: 21491,
		35142: 23431,
		35143: 28879,
		35144: 32701,
		35145: 36802,
		35146: 38632,
		35147: 21359,
		35148: 40284,
		35149: 31418,
		35150: 19985,
		35151: 30867,
		35152: 33276,
		35153: 28198,
		35154: 22040,
		35155: 21764,
		35156: 27421,
		35157: 34074,
		35158: 39995,
		35159: 23013,
		35160: 21417,
		35161: 28006,
		35162: 29916,
		35163: 38287,
		35164: 22082,
		35165: 20113,
		35166: 36939,
		35167: 38642,
		35168: 33615,
		35169: 39180,
		35170: 21473,
		35171: 21942,
		35172: 23344,
		35173: 24433,
		35174: 26144,
		35175: 26355,
		35176: 26628,
		35177: 27704,
		35178: 27891,
		35179: 27945,
		35180: 29787,
		35181: 30408,
		35182: 31310,
		35183: 38964,
		35184: 33521,
		35185: 34907,
		35186: 35424,
		35187: 37613,
		35188: 28082,
		35189: 30123,
		35190: 30410,
		35191: 39365,
		35192: 24742,
		35193: 35585,
		35194: 36234,
		35195: 38322,
		35196: 27022,
		35197: 21421,
		35198: 20870,
		35200: 22290,
		35201: 22576,
		35202: 22852,
		35203: 23476,
		35204: 24310,
		35205: 24616,
		35206: 25513,
		35207: 25588,
		35208: 27839,
		35209: 28436,
		35210: 28814,
		35211: 28948,
		35212: 29017,
		35213: 29141,
		35214: 29503,
		35215: 32257,
		35216: 33398,
		35217: 33489,
		35218: 34199,
		35219: 36960,
		35220: 37467,
		35221: 40219,
		35222: 22633,
		35223: 26044,
		35224: 27738,
		35225: 29989,
		35226: 20985,
		35227: 22830,
		35228: 22885,
		35229: 24448,
		35230: 24540,
		35231: 25276,
		35232: 26106,
		35233: 27178,
		35234: 27431,
		35235: 27572,
		35236: 29579,
		35237: 32705,
		35238: 35158,
		35239: 40236,
		35240: 40206,
		35241: 40644,
		35242: 23713,
		35243: 27798,
		35244: 33659,
		35245: 20740,
		35246: 23627,
		35247: 25014,
		35248: 33222,
		35249: 26742,
		35250: 29281,
		35251: 20057,
		35252: 20474,
		35253: 21368,
		35254: 24681,
		35255: 28201,
		35256: 31311,
		35257: 38899,
		35258: 19979,
		35259: 21270,
		35260: 20206,
		35261: 20309,
		35262: 20285,
		35263: 20385,
		35264: 20339,
		35265: 21152,
		35266: 21487,
		35267: 22025,
		35268: 22799,
		35269: 23233,
		35270: 23478,
		35271: 23521,
		35272: 31185,
		35273: 26247,
		35274: 26524,
		35275: 26550,
		35276: 27468,
		35277: 27827,
		35278: 28779,
		35279: 29634,
		35280: 31117,
		35281: 31166,
		35282: 31292,
		35283: 31623,
		35284: 33457,
		35285: 33499,
		35286: 33540,
		35287: 33655,
		35288: 33775,
		35289: 33747,
		35290: 34662,
		35291: 35506,
		35292: 22057,
		35293: 36008,
		35294: 36838,
		35295: 36942,
		35296: 38686,
		35297: 34442,
		35298: 20420,
		35299: 23784,
		35300: 25105,
		35301: 29273,
		35302: 30011,
		35303: 33253,
		35304: 33469,
		35305: 34558,
		35306: 36032,
		35307: 38597,
		35308: 39187,
		35309: 39381,
		35310: 20171,
		35311: 20250,
		35312: 35299,
		35313: 22238,
		35314: 22602,
		35315: 22730,
		35316: 24315,
		35317: 24555,
		35318: 24618,
		35319: 24724,
		35320: 24674,
		35321: 25040,
		35322: 25106,
		35323: 25296,
		35324: 25913,
		35392: 39745,
		35393: 26214,
		35394: 26800,
		35395: 28023,
		35396: 28784,
		35397: 30028,
		35398: 30342,
		35399: 32117,
		35400: 33445,
		35401: 34809,
		35402: 38283,
		35403: 38542,
		35404: 35997,
		35405: 20977,
		35406: 21182,
		35407: 22806,
		35408: 21683,
		35409: 23475,
		35410: 23830,
		35411: 24936,
		35412: 27010,
		35413: 28079,
		35414: 30861,
		35415: 33995,
		35416: 34903,
		35417: 35442,
		35418: 37799,
		35419: 39608,
		35420: 28012,
		35421: 39336,
		35422: 34521,
		35423: 22435,
		35424: 26623,
		35425: 34510,
		35426: 37390,
		35427: 21123,
		35428: 22151,
		35429: 21508,
		35430: 24275,
		35431: 25313,
		35432: 25785,
		35433: 26684,
		35434: 26680,
		35435: 27579,
		35436: 29554,
		35437: 30906,
		35438: 31339,
		35439: 35226,
		35440: 35282,
		35441: 36203,
		35442: 36611,
		35443: 37101,
		35444: 38307,
		35445: 38548,
		35446: 38761,
		35447: 23398,
		35448: 23731,
		35449: 27005,
		35450: 38989,
		35451: 38990,
		35452: 25499,
		35453: 31520,
		35454: 27179,
		35456: 27263,
		35457: 26806,
		35458: 39949,
		35459: 28511,
		35460: 21106,
		35461: 21917,
		35462: 24688,
		35463: 25324,
		35464: 27963,
		35465: 28167,
		35466: 28369,
		35467: 33883,
		35468: 35088,
		35469: 36676,
		35470: 19988,
		35471: 39993,
		35472: 21494,
		35473: 26907,
		35474: 27194,
		35475: 38788,
		35476: 26666,
		35477: 20828,
		35478: 31427,
		35479: 33970,
		35480: 37340,
		35481: 37772,
		35482: 22107,
		35483: 40232,
		35484: 26658,
		35485: 33541,
		35486: 33841,
		35487: 31909,
		35488: 21000,
		35489: 33477,
		35490: 29926,
		35491: 20094,
		35492: 20355,
		35493: 20896,
		35494: 23506,
		35495: 21002,
		35496: 21208,
		35497: 21223,
		35498: 24059,
		35499: 21914,
		35500: 22570,
		35501: 23014,
		35502: 23436,
		35503: 23448,
		35504: 23515,
		35505: 24178,
		35506: 24185,
		35507: 24739,
		35508: 24863,
		35509: 24931,
		35510: 25022,
		35511: 25563,
		35512: 25954,
		35513: 26577,
		35514: 26707,
		35515: 26874,
		35516: 27454,
		35517: 27475,
		35518: 27735,
		35519: 28450,
		35520: 28567,
		35521: 28485,
		35522: 29872,
		35523: 29976,
		35524: 30435,
		35525: 30475,
		35526: 31487,
		35527: 31649,
		35528: 31777,
		35529: 32233,
		35530: 32566,
		35531: 32752,
		35532: 32925,
		35533: 33382,
		35534: 33694,
		35535: 35251,
		35536: 35532,
		35537: 36011,
		35538: 36996,
		35539: 37969,
		35540: 38291,
		35541: 38289,
		35542: 38306,
		35543: 38501,
		35544: 38867,
		35545: 39208,
		35546: 33304,
		35547: 20024,
		35548: 21547,
		35549: 23736,
		35550: 24012,
		35551: 29609,
		35552: 30284,
		35553: 30524,
		35554: 23721,
		35555: 32747,
		35556: 36107,
		35557: 38593,
		35558: 38929,
		35559: 38996,
		35560: 39000,
		35561: 20225,
		35562: 20238,
		35563: 21361,
		35564: 21916,
		35565: 22120,
		35566: 22522,
		35567: 22855,
		35568: 23305,
		35569: 23492,
		35570: 23696,
		35571: 24076,
		35572: 24190,
		35573: 24524,
		35574: 25582,
		35575: 26426,
		35576: 26071,
		35577: 26082,
		35578: 26399,
		35579: 26827,
		35580: 26820,
		35648: 27231,
		35649: 24112,
		35650: 27589,
		35651: 27671,
		35652: 27773,
		35653: 30079,
		35654: 31048,
		35655: 23395,
		35656: 31232,
		35657: 32000,
		35658: 24509,
		35659: 35215,
		35660: 35352,
		35661: 36020,
		35662: 36215,
		35663: 36556,
		35664: 36637,
		35665: 39138,
		35666: 39438,
		35667: 39740,
		35668: 20096,
		35669: 20605,
		35670: 20736,
		35671: 22931,
		35672: 23452,
		35673: 25135,
		35674: 25216,
		35675: 25836,
		35676: 27450,
		35677: 29344,
		35678: 30097,
		35679: 31047,
		35680: 32681,
		35681: 34811,
		35682: 35516,
		35683: 35696,
		35684: 25516,
		35685: 33738,
		35686: 38816,
		35687: 21513,
		35688: 21507,
		35689: 21931,
		35690: 26708,
		35691: 27224,
		35692: 35440,
		35693: 30759,
		35694: 26485,
		35695: 40653,
		35696: 21364,
		35697: 23458,
		35698: 33050,
		35699: 34384,
		35700: 36870,
		35701: 19992,
		35702: 20037,
		35703: 20167,
		35704: 20241,
		35705: 21450,
		35706: 21560,
		35707: 23470,
		35708: 24339,
		35709: 24613,
		35710: 25937,
		35712: 26429,
		35713: 27714,
		35714: 27762,
		35715: 27875,
		35716: 28792,
		35717: 29699,
		35718: 31350,
		35719: 31406,
		35720: 31496,
		35721: 32026,
		35722: 31998,
		35723: 32102,
		35724: 26087,
		35725: 29275,
		35726: 21435,
		35727: 23621,
		35728: 24040,
		35729: 25298,
		35730: 25312,
		35731: 25369,
		35732: 28192,
		35733: 34394,
		35734: 35377,
		35735: 36317,
		35736: 37624,
		35737: 28417,
		35738: 31142,
		35739: 39770,
		35740: 20136,
		35741: 20139,
		35742: 20140,
		35743: 20379,
		35744: 20384,
		35745: 20689,
		35746: 20807,
		35747: 31478,
		35748: 20849,
		35749: 20982,
		35750: 21332,
		35751: 21281,
		35752: 21375,
		35753: 21483,
		35754: 21932,
		35755: 22659,
		35756: 23777,
		35757: 24375,
		35758: 24394,
		35759: 24623,
		35760: 24656,
		35761: 24685,
		35762: 25375,
		35763: 25945,
		35764: 27211,
		35765: 27841,
		35766: 29378,
		35767: 29421,
		35768: 30703,
		35769: 33016,
		35770: 33029,
		35771: 33288,
		35772: 34126,
		35773: 37111,
		35774: 37857,
		35775: 38911,
		35776: 39255,
		35777: 39514,
		35778: 20208,
		35779: 20957,
		35780: 23597,
		35781: 26241,
		35782: 26989,
		35783: 23616,
		35784: 26354,
		35785: 26997,
		35786: 29577,
		35787: 26704,
		35788: 31873,
		35789: 20677,
		35790: 21220,
		35791: 22343,
		35792: 24062,
		35793: 37670,
		35794: 26020,
		35795: 27427,
		35796: 27453,
		35797: 29748,
		35798: 31105,
		35799: 31165,
		35800: 31563,
		35801: 32202,
		35802: 33465,
		35803: 33740,
		35804: 34943,
		35805: 35167,
		35806: 35641,
		35807: 36817,
		35808: 37329,
		35809: 21535,
		35810: 37504,
		35811: 20061,
		35812: 20534,
		35813: 21477,
		35814: 21306,
		35815: 29399,
		35816: 29590,
		35817: 30697,
		35818: 33510,
		35819: 36527,
		35820: 39366,
		35821: 39368,
		35822: 39378,
		35823: 20855,
		35824: 24858,
		35825: 34398,
		35826: 21936,
		35827: 31354,
		35828: 20598,
		35829: 23507,
		35830: 36935,
		35831: 38533,
		35832: 20018,
		35833: 27355,
		35834: 37351,
		35835: 23633,
		35836: 23624,
		35904: 25496,
		35905: 31391,
		35906: 27795,
		35907: 38772,
		35908: 36705,
		35909: 31402,
		35910: 29066,
		35911: 38536,
		35912: 31874,
		35913: 26647,
		35914: 32368,
		35915: 26705,
		35916: 37740,
		35917: 21234,
		35918: 21531,
		35919: 34219,
		35920: 35347,
		35921: 32676,
		35922: 36557,
		35923: 37089,
		35924: 21350,
		35925: 34952,
		35926: 31041,
		35927: 20418,
		35928: 20670,
		35929: 21009,
		35930: 20804,
		35931: 21843,
		35932: 22317,
		35933: 29674,
		35934: 22411,
		35935: 22865,
		35936: 24418,
		35937: 24452,
		35938: 24693,
		35939: 24950,
		35940: 24935,
		35941: 25001,
		35942: 25522,
		35943: 25658,
		35944: 25964,
		35945: 26223,
		35946: 26690,
		35947: 28179,
		35948: 30054,
		35949: 31293,
		35950: 31995,
		35951: 32076,
		35952: 32153,
		35953: 32331,
		35954: 32619,
		35955: 33550,
		35956: 33610,
		35957: 34509,
		35958: 35336,
		35959: 35427,
		35960: 35686,
		35961: 36605,
		35962: 38938,
		35963: 40335,
		35964: 33464,
		35965: 36814,
		35966: 39912,
		35968: 21127,
		35969: 25119,
		35970: 25731,
		35971: 28608,
		35972: 38553,
		35973: 26689,
		35974: 20625,
		35975: 27424,
		35976: 27770,
		35977: 28500,
		35978: 31348,
		35979: 32080,
		35980: 34880,
		35981: 35363,
		35982: 26376,
		35983: 20214,
		35984: 20537,
		35985: 20518,
		35986: 20581,
		35987: 20860,
		35988: 21048,
		35989: 21091,
		35990: 21927,
		35991: 22287,
		35992: 22533,
		35993: 23244,
		35994: 24314,
		35995: 25010,
		35996: 25080,
		35997: 25331,
		35998: 25458,
		35999: 26908,
		36000: 27177,
		36001: 29309,
		36002: 29356,
		36003: 29486,
		36004: 30740,
		36005: 30831,
		36006: 32121,
		36007: 30476,
		36008: 32937,
		36009: 35211,
		36010: 35609,
		36011: 36066,
		36012: 36562,
		36013: 36963,
		36014: 37749,
		36015: 38522,
		36016: 38997,
		36017: 39443,
		36018: 40568,
		36019: 20803,
		36020: 21407,
		36021: 21427,
		36022: 24187,
		36023: 24358,
		36024: 28187,
		36025: 28304,
		36026: 29572,
		36027: 29694,
		36028: 32067,
		36029: 33335,
		36030: 35328,
		36031: 35578,
		36032: 38480,
		36033: 20046,
		36034: 20491,
		36035: 21476,
		36036: 21628,
		36037: 22266,
		36038: 22993,
		36039: 23396,
		36040: 24049,
		36041: 24235,
		36042: 24359,
		36043: 25144,
		36044: 25925,
		36045: 26543,
		36046: 28246,
		36047: 29392,
		36048: 31946,
		36049: 34996,
		36050: 32929,
		36051: 32993,
		36052: 33776,
		36053: 34382,
		36054: 35463,
		36055: 36328,
		36056: 37431,
		36057: 38599,
		36058: 39015,
		36059: 40723,
		36060: 20116,
		36061: 20114,
		36062: 20237,
		36063: 21320,
		36064: 21577,
		36065: 21566,
		36066: 23087,
		36067: 24460,
		36068: 24481,
		36069: 24735,
		36070: 26791,
		36071: 27278,
		36072: 29786,
		36073: 30849,
		36074: 35486,
		36075: 35492,
		36076: 35703,
		36077: 37264,
		36078: 20062,
		36079: 39881,
		36080: 20132,
		36081: 20348,
		36082: 20399,
		36083: 20505,
		36084: 20502,
		36085: 20809,
		36086: 20844,
		36087: 21151,
		36088: 21177,
		36089: 21246,
		36090: 21402,
		36091: 21475,
		36092: 21521,
		36160: 21518,
		36161: 21897,
		36162: 22353,
		36163: 22434,
		36164: 22909,
		36165: 23380,
		36166: 23389,
		36167: 23439,
		36168: 24037,
		36169: 24039,
		36170: 24055,
		36171: 24184,
		36172: 24195,
		36173: 24218,
		36174: 24247,
		36175: 24344,
		36176: 24658,
		36177: 24908,
		36178: 25239,
		36179: 25304,
		36180: 25511,
		36181: 25915,
		36182: 26114,
		36183: 26179,
		36184: 26356,
		36185: 26477,
		36186: 26657,
		36187: 26775,
		36188: 27083,
		36189: 27743,
		36190: 27946,
		36191: 28009,
		36192: 28207,
		36193: 28317,
		36194: 30002,
		36195: 30343,
		36196: 30828,
		36197: 31295,
		36198: 31968,
		36199: 32005,
		36200: 32024,
		36201: 32094,
		36202: 32177,
		36203: 32789,
		36204: 32771,
		36205: 32943,
		36206: 32945,
		36207: 33108,
		36208: 33167,
		36209: 33322,
		36210: 33618,
		36211: 34892,
		36212: 34913,
		36213: 35611,
		36214: 36002,
		36215: 36092,
		36216: 37066,
		36217: 37237,
		36218: 37489,
		36219: 30783,
		36220: 37628,
		36221: 38308,
		36222: 38477,
		36224: 38917,
		36225: 39321,
		36226: 39640,
		36227: 40251,
		36228: 21083,
		36229: 21163,
		36230: 21495,
		36231: 21512,
		36232: 22741,
		36233: 25335,
		36234: 28640,
		36235: 35946,
		36236: 36703,
		36237: 40633,
		36238: 20811,
		36239: 21051,
		36240: 21578,
		36241: 22269,
		36242: 31296,
		36243: 37239,
		36244: 40288,
		36245: 40658,
		36246: 29508,
		36247: 28425,
		36248: 33136,
		36249: 29969,
		36250: 24573,
		36251: 24794,
		36252: 39592,
		36253: 29403,
		36254: 36796,
		36255: 27492,
		36256: 38915,
		36257: 20170,
		36258: 22256,
		36259: 22372,
		36260: 22718,
		36261: 23130,
		36262: 24680,
		36263: 25031,
		36264: 26127,
		36265: 26118,
		36266: 26681,
		36267: 26801,
		36268: 28151,
		36269: 30165,
		36270: 32058,
		36271: 33390,
		36272: 39746,
		36273: 20123,
		36274: 20304,
		36275: 21449,
		36276: 21766,
		36277: 23919,
		36278: 24038,
		36279: 24046,
		36280: 26619,
		36281: 27801,
		36282: 29811,
		36283: 30722,
		36284: 35408,
		36285: 37782,
		36286: 35039,
		36287: 22352,
		36288: 24231,
		36289: 25387,
		36290: 20661,
		36291: 20652,
		36292: 20877,
		36293: 26368,
		36294: 21705,
		36295: 22622,
		36296: 22971,
		36297: 23472,
		36298: 24425,
		36299: 25165,
		36300: 25505,
		36301: 26685,
		36302: 27507,
		36303: 28168,
		36304: 28797,
		36305: 37319,
		36306: 29312,
		36307: 30741,
		36308: 30758,
		36309: 31085,
		36310: 25998,
		36311: 32048,
		36312: 33756,
		36313: 35009,
		36314: 36617,
		36315: 38555,
		36316: 21092,
		36317: 22312,
		36318: 26448,
		36319: 32618,
		36320: 36001,
		36321: 20916,
		36322: 22338,
		36323: 38442,
		36324: 22586,
		36325: 27018,
		36326: 32948,
		36327: 21682,
		36328: 23822,
		36329: 22524,
		36330: 30869,
		36331: 40442,
		36332: 20316,
		36333: 21066,
		36334: 21643,
		36335: 25662,
		36336: 26152,
		36337: 26388,
		36338: 26613,
		36339: 31364,
		36340: 31574,
		36341: 32034,
		36342: 37679,
		36343: 26716,
		36344: 39853,
		36345: 31545,
		36346: 21273,
		36347: 20874,
		36348: 21047,
		36416: 23519,
		36417: 25334,
		36418: 25774,
		36419: 25830,
		36420: 26413,
		36421: 27578,
		36422: 34217,
		36423: 38609,
		36424: 30352,
		36425: 39894,
		36426: 25420,
		36427: 37638,
		36428: 39851,
		36429: 30399,
		36430: 26194,
		36431: 19977,
		36432: 20632,
		36433: 21442,
		36434: 23665,
		36435: 24808,
		36436: 25746,
		36437: 25955,
		36438: 26719,
		36439: 29158,
		36440: 29642,
		36441: 29987,
		36442: 31639,
		36443: 32386,
		36444: 34453,
		36445: 35715,
		36446: 36059,
		36447: 37240,
		36448: 39184,
		36449: 26028,
		36450: 26283,
		36451: 27531,
		36452: 20181,
		36453: 20180,
		36454: 20282,
		36455: 20351,
		36456: 21050,
		36457: 21496,
		36458: 21490,
		36459: 21987,
		36460: 22235,
		36461: 22763,
		36462: 22987,
		36463: 22985,
		36464: 23039,
		36465: 23376,
		36466: 23629,
		36467: 24066,
		36468: 24107,
		36469: 24535,
		36470: 24605,
		36471: 25351,
		36472: 25903,
		36473: 23388,
		36474: 26031,
		36475: 26045,
		36476: 26088,
		36477: 26525,
		36478: 27490,
		36480: 27515,
		36481: 27663,
		36482: 29509,
		36483: 31049,
		36484: 31169,
		36485: 31992,
		36486: 32025,
		36487: 32043,
		36488: 32930,
		36489: 33026,
		36490: 33267,
		36491: 35222,
		36492: 35422,
		36493: 35433,
		36494: 35430,
		36495: 35468,
		36496: 35566,
		36497: 36039,
		36498: 36060,
		36499: 38604,
		36500: 39164,
		36501: 27503,
		36502: 20107,
		36503: 20284,
		36504: 20365,
		36505: 20816,
		36506: 23383,
		36507: 23546,
		36508: 24904,
		36509: 25345,
		36510: 26178,
		36511: 27425,
		36512: 28363,
		36513: 27835,
		36514: 29246,
		36515: 29885,
		36516: 30164,
		36517: 30913,
		36518: 31034,
		36519: 32780,
		36520: 32819,
		36521: 33258,
		36522: 33940,
		36523: 36766,
		36524: 27728,
		36525: 40575,
		36526: 24335,
		36527: 35672,
		36528: 40235,
		36529: 31482,
		36530: 36600,
		36531: 23437,
		36532: 38635,
		36533: 19971,
		36534: 21489,
		36535: 22519,
		36536: 22833,
		36537: 23241,
		36538: 23460,
		36539: 24713,
		36540: 28287,
		36541: 28422,
		36542: 30142,
		36543: 36074,
		36544: 23455,
		36545: 34048,
		36546: 31712,
		36547: 20594,
		36548: 26612,
		36549: 33437,
		36550: 23649,
		36551: 34122,
		36552: 32286,
		36553: 33294,
		36554: 20889,
		36555: 23556,
		36556: 25448,
		36557: 36198,
		36558: 26012,
		36559: 29038,
		36560: 31038,
		36561: 32023,
		36562: 32773,
		36563: 35613,
		36564: 36554,
		36565: 36974,
		36566: 34503,
		36567: 37034,
		36568: 20511,
		36569: 21242,
		36570: 23610,
		36571: 26451,
		36572: 28796,
		36573: 29237,
		36574: 37196,
		36575: 37320,
		36576: 37675,
		36577: 33509,
		36578: 23490,
		36579: 24369,
		36580: 24825,
		36581: 20027,
		36582: 21462,
		36583: 23432,
		36584: 25163,
		36585: 26417,
		36586: 27530,
		36587: 29417,
		36588: 29664,
		36589: 31278,
		36590: 33131,
		36591: 36259,
		36592: 37202,
		36593: 39318,
		36594: 20754,
		36595: 21463,
		36596: 21610,
		36597: 23551,
		36598: 25480,
		36599: 27193,
		36600: 32172,
		36601: 38656,
		36602: 22234,
		36603: 21454,
		36604: 21608,
		36672: 23447,
		36673: 23601,
		36674: 24030,
		36675: 20462,
		36676: 24833,
		36677: 25342,
		36678: 27954,
		36679: 31168,
		36680: 31179,
		36681: 32066,
		36682: 32333,
		36683: 32722,
		36684: 33261,
		36685: 33311,
		36686: 33936,
		36687: 34886,
		36688: 35186,
		36689: 35728,
		36690: 36468,
		36691: 36655,
		36692: 36913,
		36693: 37195,
		36694: 37228,
		36695: 38598,
		36696: 37276,
		36697: 20160,
		36698: 20303,
		36699: 20805,
		36700: 21313,
		36701: 24467,
		36702: 25102,
		36703: 26580,
		36704: 27713,
		36705: 28171,
		36706: 29539,
		36707: 32294,
		36708: 37325,
		36709: 37507,
		36710: 21460,
		36711: 22809,
		36712: 23487,
		36713: 28113,
		36714: 31069,
		36715: 32302,
		36716: 31899,
		36717: 22654,
		36718: 29087,
		36719: 20986,
		36720: 34899,
		36721: 36848,
		36722: 20426,
		36723: 23803,
		36724: 26149,
		36725: 30636,
		36726: 31459,
		36727: 33308,
		36728: 39423,
		36729: 20934,
		36730: 24490,
		36731: 26092,
		36732: 26991,
		36733: 27529,
		36734: 28147,
		36736: 28310,
		36737: 28516,
		36738: 30462,
		36739: 32020,
		36740: 24033,
		36741: 36981,
		36742: 37255,
		36743: 38918,
		36744: 20966,
		36745: 21021,
		36746: 25152,
		36747: 26257,
		36748: 26329,
		36749: 28186,
		36750: 24246,
		36751: 32210,
		36752: 32626,
		36753: 26360,
		36754: 34223,
		36755: 34295,
		36756: 35576,
		36757: 21161,
		36758: 21465,
		36759: 22899,
		36760: 24207,
		36761: 24464,
		36762: 24661,
		36763: 37604,
		36764: 38500,
		36765: 20663,
		36766: 20767,
		36767: 21213,
		36768: 21280,
		36769: 21319,
		36770: 21484,
		36771: 21736,
		36772: 21830,
		36773: 21809,
		36774: 22039,
		36775: 22888,
		36776: 22974,
		36777: 23100,
		36778: 23477,
		36779: 23558,
		36780: 23567,
		36781: 23569,
		36782: 23578,
		36783: 24196,
		36784: 24202,
		36785: 24288,
		36786: 24432,
		36787: 25215,
		36788: 25220,
		36789: 25307,
		36790: 25484,
		36791: 25463,
		36792: 26119,
		36793: 26124,
		36794: 26157,
		36795: 26230,
		36796: 26494,
		36797: 26786,
		36798: 27167,
		36799: 27189,
		36800: 27836,
		36801: 28040,
		36802: 28169,
		36803: 28248,
		36804: 28988,
		36805: 28966,
		36806: 29031,
		36807: 30151,
		36808: 30465,
		36809: 30813,
		36810: 30977,
		36811: 31077,
		36812: 31216,
		36813: 31456,
		36814: 31505,
		36815: 31911,
		36816: 32057,
		36817: 32918,
		36818: 33750,
		36819: 33931,
		36820: 34121,
		36821: 34909,
		36822: 35059,
		36823: 35359,
		36824: 35388,
		36825: 35412,
		36826: 35443,
		36827: 35937,
		36828: 36062,
		36829: 37284,
		36830: 37478,
		36831: 37758,
		36832: 37912,
		36833: 38556,
		36834: 38808,
		36835: 19978,
		36836: 19976,
		36837: 19998,
		36838: 20055,
		36839: 20887,
		36840: 21104,
		36841: 22478,
		36842: 22580,
		36843: 22732,
		36844: 23330,
		36845: 24120,
		36846: 24773,
		36847: 25854,
		36848: 26465,
		36849: 26454,
		36850: 27972,
		36851: 29366,
		36852: 30067,
		36853: 31331,
		36854: 33976,
		36855: 35698,
		36856: 37304,
		36857: 37664,
		36858: 22065,
		36859: 22516,
		36860: 39166,
		36928: 25325,
		36929: 26893,
		36930: 27542,
		36931: 29165,
		36932: 32340,
		36933: 32887,
		36934: 33394,
		36935: 35302,
		36936: 39135,
		36937: 34645,
		36938: 36785,
		36939: 23611,
		36940: 20280,
		36941: 20449,
		36942: 20405,
		36943: 21767,
		36944: 23072,
		36945: 23517,
		36946: 23529,
		36947: 24515,
		36948: 24910,
		36949: 25391,
		36950: 26032,
		36951: 26187,
		36952: 26862,
		36953: 27035,
		36954: 28024,
		36955: 28145,
		36956: 30003,
		36957: 30137,
		36958: 30495,
		36959: 31070,
		36960: 31206,
		36961: 32051,
		36962: 33251,
		36963: 33455,
		36964: 34218,
		36965: 35242,
		36966: 35386,
		36967: 36523,
		36968: 36763,
		36969: 36914,
		36970: 37341,
		36971: 38663,
		36972: 20154,
		36973: 20161,
		36974: 20995,
		36975: 22645,
		36976: 22764,
		36977: 23563,
		36978: 29978,
		36979: 23613,
		36980: 33102,
		36981: 35338,
		36982: 36805,
		36983: 38499,
		36984: 38765,
		36985: 31525,
		36986: 35535,
		36987: 38920,
		36988: 37218,
		36989: 22259,
		36990: 21416,
		36992: 36887,
		36993: 21561,
		36994: 22402,
		36995: 24101,
		36996: 25512,
		36997: 27700,
		36998: 28810,
		36999: 30561,
		37000: 31883,
		37001: 32736,
		37002: 34928,
		37003: 36930,
		37004: 37204,
		37005: 37648,
		37006: 37656,
		37007: 38543,
		37008: 29790,
		37009: 39620,
		37010: 23815,
		37011: 23913,
		37012: 25968,
		37013: 26530,
		37014: 36264,
		37015: 38619,
		37016: 25454,
		37017: 26441,
		37018: 26905,
		37019: 33733,
		37020: 38935,
		37021: 38592,
		37022: 35070,
		37023: 28548,
		37024: 25722,
		37025: 23544,
		37026: 19990,
		37027: 28716,
		37028: 30045,
		37029: 26159,
		37030: 20932,
		37031: 21046,
		37032: 21218,
		37033: 22995,
		37034: 24449,
		37035: 24615,
		37036: 25104,
		37037: 25919,
		37038: 25972,
		37039: 26143,
		37040: 26228,
		37041: 26866,
		37042: 26646,
		37043: 27491,
		37044: 28165,
		37045: 29298,
		37046: 29983,
		37047: 30427,
		37048: 31934,
		37049: 32854,
		37050: 22768,
		37051: 35069,
		37052: 35199,
		37053: 35488,
		37054: 35475,
		37055: 35531,
		37056: 36893,
		37057: 37266,
		37058: 38738,
		37059: 38745,
		37060: 25993,
		37061: 31246,
		37062: 33030,
		37063: 38587,
		37064: 24109,
		37065: 24796,
		37066: 25114,
		37067: 26021,
		37068: 26132,
		37069: 26512,
		37070: 30707,
		37071: 31309,
		37072: 31821,
		37073: 32318,
		37074: 33034,
		37075: 36012,
		37076: 36196,
		37077: 36321,
		37078: 36447,
		37079: 30889,
		37080: 20999,
		37081: 25305,
		37082: 25509,
		37083: 25666,
		37084: 25240,
		37085: 35373,
		37086: 31363,
		37087: 31680,
		37088: 35500,
		37089: 38634,
		37090: 32118,
		37091: 33292,
		37092: 34633,
		37093: 20185,
		37094: 20808,
		37095: 21315,
		37096: 21344,
		37097: 23459,
		37098: 23554,
		37099: 23574,
		37100: 24029,
		37101: 25126,
		37102: 25159,
		37103: 25776,
		37104: 26643,
		37105: 26676,
		37106: 27849,
		37107: 27973,
		37108: 27927,
		37109: 26579,
		37110: 28508,
		37111: 29006,
		37112: 29053,
		37113: 26059,
		37114: 31359,
		37115: 31661,
		37116: 32218,
		37184: 32330,
		37185: 32680,
		37186: 33146,
		37187: 33307,
		37188: 33337,
		37189: 34214,
		37190: 35438,
		37191: 36046,
		37192: 36341,
		37193: 36984,
		37194: 36983,
		37195: 37549,
		37196: 37521,
		37197: 38275,
		37198: 39854,
		37199: 21069,
		37200: 21892,
		37201: 28472,
		37202: 28982,
		37203: 20840,
		37204: 31109,
		37205: 32341,
		37206: 33203,
		37207: 31950,
		37208: 22092,
		37209: 22609,
		37210: 23720,
		37211: 25514,
		37212: 26366,
		37213: 26365,
		37214: 26970,
		37215: 29401,
		37216: 30095,
		37217: 30094,
		37218: 30990,
		37219: 31062,
		37220: 31199,
		37221: 31895,
		37222: 32032,
		37223: 32068,
		37224: 34311,
		37225: 35380,
		37226: 38459,
		37227: 36961,
		37228: 40736,
		37229: 20711,
		37230: 21109,
		37231: 21452,
		37232: 21474,
		37233: 20489,
		37234: 21930,
		37235: 22766,
		37236: 22863,
		37237: 29245,
		37238: 23435,
		37239: 23652,
		37240: 21277,
		37241: 24803,
		37242: 24819,
		37243: 25436,
		37244: 25475,
		37245: 25407,
		37246: 25531,
		37248: 25805,
		37249: 26089,
		37250: 26361,
		37251: 24035,
		37252: 27085,
		37253: 27133,
		37254: 28437,
		37255: 29157,
		37256: 20105,
		37257: 30185,
		37258: 30456,
		37259: 31379,
		37260: 31967,
		37261: 32207,
		37262: 32156,
		37263: 32865,
		37264: 33609,
		37265: 33624,
		37266: 33900,
		37267: 33980,
		37268: 34299,
		37269: 35013,
		37270: 36208,
		37271: 36865,
		37272: 36973,
		37273: 37783,
		37274: 38684,
		37275: 39442,
		37276: 20687,
		37277: 22679,
		37278: 24974,
		37279: 33235,
		37280: 34101,
		37281: 36104,
		37282: 36896,
		37283: 20419,
		37284: 20596,
		37285: 21063,
		37286: 21363,
		37287: 24687,
		37288: 25417,
		37289: 26463,
		37290: 28204,
		37291: 36275,
		37292: 36895,
		37293: 20439,
		37294: 23646,
		37295: 36042,
		37296: 26063,
		37297: 32154,
		37298: 21330,
		37299: 34966,
		37300: 20854,
		37301: 25539,
		37302: 23384,
		37303: 23403,
		37304: 23562,
		37305: 25613,
		37306: 26449,
		37307: 36956,
		37308: 20182,
		37309: 22810,
		37310: 22826,
		37311: 27760,
		37312: 35409,
		37313: 21822,
		37314: 22549,
		37315: 22949,
		37316: 24816,
		37317: 25171,
		37318: 26561,
		37319: 33333,
		37320: 26965,
		37321: 38464,
		37322: 39364,
		37323: 39464,
		37324: 20307,
		37325: 22534,
		37326: 23550,
		37327: 32784,
		37328: 23729,
		37329: 24111,
		37330: 24453,
		37331: 24608,
		37332: 24907,
		37333: 25140,
		37334: 26367,
		37335: 27888,
		37336: 28382,
		37337: 32974,
		37338: 33151,
		37339: 33492,
		37340: 34955,
		37341: 36024,
		37342: 36864,
		37343: 36910,
		37344: 38538,
		37345: 40667,
		37346: 39899,
		37347: 20195,
		37348: 21488,
		37349: 22823,
		37350: 31532,
		37351: 37261,
		37352: 38988,
		37353: 40441,
		37354: 28381,
		37355: 28711,
		37356: 21331,
		37357: 21828,
		37358: 23429,
		37359: 25176,
		37360: 25246,
		37361: 25299,
		37362: 27810,
		37363: 28655,
		37364: 29730,
		37365: 35351,
		37366: 37944,
		37367: 28609,
		37368: 35582,
		37369: 33592,
		37370: 20967,
		37371: 34552,
		37372: 21482,
		37440: 21481,
		37441: 20294,
		37442: 36948,
		37443: 36784,
		37444: 22890,
		37445: 33073,
		37446: 24061,
		37447: 31466,
		37448: 36799,
		37449: 26842,
		37450: 35895,
		37451: 29432,
		37452: 40008,
		37453: 27197,
		37454: 35504,
		37455: 20025,
		37456: 21336,
		37457: 22022,
		37458: 22374,
		37459: 25285,
		37460: 25506,
		37461: 26086,
		37462: 27470,
		37463: 28129,
		37464: 28251,
		37465: 28845,
		37466: 30701,
		37467: 31471,
		37468: 31658,
		37469: 32187,
		37470: 32829,
		37471: 32966,
		37472: 34507,
		37473: 35477,
		37474: 37723,
		37475: 22243,
		37476: 22727,
		37477: 24382,
		37478: 26029,
		37479: 26262,
		37480: 27264,
		37481: 27573,
		37482: 30007,
		37483: 35527,
		37484: 20516,
		37485: 30693,
		37486: 22320,
		37487: 24347,
		37488: 24677,
		37489: 26234,
		37490: 27744,
		37491: 30196,
		37492: 31258,
		37493: 32622,
		37494: 33268,
		37495: 34584,
		37496: 36933,
		37497: 39347,
		37498: 31689,
		37499: 30044,
		37500: 31481,
		37501: 31569,
		37502: 33988,
		37504: 36880,
		37505: 31209,
		37506: 31378,
		37507: 33590,
		37508: 23265,
		37509: 30528,
		37510: 20013,
		37511: 20210,
		37512: 23449,
		37513: 24544,
		37514: 25277,
		37515: 26172,
		37516: 26609,
		37517: 27880,
		37518: 34411,
		37519: 34935,
		37520: 35387,
		37521: 37198,
		37522: 37619,
		37523: 39376,
		37524: 27159,
		37525: 28710,
		37526: 29482,
		37527: 33511,
		37528: 33879,
		37529: 36015,
		37530: 19969,
		37531: 20806,
		37532: 20939,
		37533: 21899,
		37534: 23541,
		37535: 24086,
		37536: 24115,
		37537: 24193,
		37538: 24340,
		37539: 24373,
		37540: 24427,
		37541: 24500,
		37542: 25074,
		37543: 25361,
		37544: 26274,
		37545: 26397,
		37546: 28526,
		37547: 29266,
		37548: 30010,
		37549: 30522,
		37550: 32884,
		37551: 33081,
		37552: 33144,
		37553: 34678,
		37554: 35519,
		37555: 35548,
		37556: 36229,
		37557: 36339,
		37558: 37530,
		37559: 38263,
		37560: 38914,
		37561: 40165,
		37562: 21189,
		37563: 25431,
		37564: 30452,
		37565: 26389,
		37566: 27784,
		37567: 29645,
		37568: 36035,
		37569: 37806,
		37570: 38515,
		37571: 27941,
		37572: 22684,
		37573: 26894,
		37574: 27084,
		37575: 36861,
		37576: 37786,
		37577: 30171,
		37578: 36890,
		37579: 22618,
		37580: 26626,
		37581: 25524,
		37582: 27131,
		37583: 20291,
		37584: 28460,
		37585: 26584,
		37586: 36795,
		37587: 34086,
		37588: 32180,
		37589: 37716,
		37590: 26943,
		37591: 28528,
		37592: 22378,
		37593: 22775,
		37594: 23340,
		37595: 32044,
		37596: 29226,
		37597: 21514,
		37598: 37347,
		37599: 40372,
		37600: 20141,
		37601: 20302,
		37602: 20572,
		37603: 20597,
		37604: 21059,
		37605: 35998,
		37606: 21576,
		37607: 22564,
		37608: 23450,
		37609: 24093,
		37610: 24213,
		37611: 24237,
		37612: 24311,
		37613: 24351,
		37614: 24716,
		37615: 25269,
		37616: 25402,
		37617: 25552,
		37618: 26799,
		37619: 27712,
		37620: 30855,
		37621: 31118,
		37622: 31243,
		37623: 32224,
		37624: 33351,
		37625: 35330,
		37626: 35558,
		37627: 36420,
		37628: 36883,
		37696: 37048,
		37697: 37165,
		37698: 37336,
		37699: 40718,
		37700: 27877,
		37701: 25688,
		37702: 25826,
		37703: 25973,
		37704: 28404,
		37705: 30340,
		37706: 31515,
		37707: 36969,
		37708: 37841,
		37709: 28346,
		37710: 21746,
		37711: 24505,
		37712: 25764,
		37713: 36685,
		37714: 36845,
		37715: 37444,
		37716: 20856,
		37717: 22635,
		37718: 22825,
		37719: 23637,
		37720: 24215,
		37721: 28155,
		37722: 32399,
		37723: 29980,
		37724: 36028,
		37725: 36578,
		37726: 39003,
		37727: 28857,
		37728: 20253,
		37729: 27583,
		37730: 28593,
		37731: 30000,
		37732: 38651,
		37733: 20814,
		37734: 21520,
		37735: 22581,
		37736: 22615,
		37737: 22956,
		37738: 23648,
		37739: 24466,
		37740: 26007,
		37741: 26460,
		37742: 28193,
		37743: 30331,
		37744: 33759,
		37745: 36077,
		37746: 36884,
		37747: 37117,
		37748: 37709,
		37749: 30757,
		37750: 30778,
		37751: 21162,
		37752: 24230,
		37753: 22303,
		37754: 22900,
		37755: 24594,
		37756: 20498,
		37757: 20826,
		37758: 20908,
		37760: 20941,
		37761: 20992,
		37762: 21776,
		37763: 22612,
		37764: 22616,
		37765: 22871,
		37766: 23445,
		37767: 23798,
		37768: 23947,
		37769: 24764,
		37770: 25237,
		37771: 25645,
		37772: 26481,
		37773: 26691,
		37774: 26812,
		37775: 26847,
		37776: 30423,
		37777: 28120,
		37778: 28271,
		37779: 28059,
		37780: 28783,
		37781: 29128,
		37782: 24403,
		37783: 30168,
		37784: 31095,
		37785: 31561,
		37786: 31572,
		37787: 31570,
		37788: 31958,
		37789: 32113,
		37790: 21040,
		37791: 33891,
		37792: 34153,
		37793: 34276,
		37794: 35342,
		37795: 35588,
		37796: 35910,
		37797: 36367,
		37798: 36867,
		37799: 36879,
		37800: 37913,
		37801: 38518,
		37802: 38957,
		37803: 39472,
		37804: 38360,
		37805: 20685,
		37806: 21205,
		37807: 21516,
		37808: 22530,
		37809: 23566,
		37810: 24999,
		37811: 25758,
		37812: 27934,
		37813: 30643,
		37814: 31461,
		37815: 33012,
		37816: 33796,
		37817: 36947,
		37818: 37509,
		37819: 23776,
		37820: 40199,
		37821: 21311,
		37822: 24471,
		37823: 24499,
		37824: 28060,
		37825: 29305,
		37826: 30563,
		37827: 31167,
		37828: 31716,
		37829: 27602,
		37830: 29420,
		37831: 35501,
		37832: 26627,
		37833: 27233,
		37834: 20984,
		37835: 31361,
		37836: 26932,
		37837: 23626,
		37838: 40182,
		37839: 33515,
		37840: 23493,
		37841: 37193,
		37842: 28702,
		37843: 22136,
		37844: 23663,
		37845: 24775,
		37846: 25958,
		37847: 27788,
		37848: 35930,
		37849: 36929,
		37850: 38931,
		37851: 21585,
		37852: 26311,
		37853: 37389,
		37854: 22856,
		37855: 37027,
		37856: 20869,
		37857: 20045,
		37858: 20970,
		37859: 34201,
		37860: 35598,
		37861: 28760,
		37862: 25466,
		37863: 37707,
		37864: 26978,
		37865: 39348,
		37866: 32260,
		37867: 30071,
		37868: 21335,
		37869: 26976,
		37870: 36575,
		37871: 38627,
		37872: 27741,
		37873: 20108,
		37874: 23612,
		37875: 24336,
		37876: 36841,
		37877: 21250,
		37878: 36049,
		37879: 32905,
		37880: 34425,
		37881: 24319,
		37882: 26085,
		37883: 20083,
		37884: 20837,
		37952: 22914,
		37953: 23615,
		37954: 38894,
		37955: 20219,
		37956: 22922,
		37957: 24525,
		37958: 35469,
		37959: 28641,
		37960: 31152,
		37961: 31074,
		37962: 23527,
		37963: 33905,
		37964: 29483,
		37965: 29105,
		37966: 24180,
		37967: 24565,
		37968: 25467,
		37969: 25754,
		37970: 29123,
		37971: 31896,
		37972: 20035,
		37973: 24316,
		37974: 20043,
		37975: 22492,
		37976: 22178,
		37977: 24745,
		37978: 28611,
		37979: 32013,
		37980: 33021,
		37981: 33075,
		37982: 33215,
		37983: 36786,
		37984: 35223,
		37985: 34468,
		37986: 24052,
		37987: 25226,
		37988: 25773,
		37989: 35207,
		37990: 26487,
		37991: 27874,
		37992: 27966,
		37993: 29750,
		37994: 30772,
		37995: 23110,
		37996: 32629,
		37997: 33453,
		37998: 39340,
		37999: 20467,
		38000: 24259,
		38001: 25309,
		38002: 25490,
		38003: 25943,
		38004: 26479,
		38005: 30403,
		38006: 29260,
		38007: 32972,
		38008: 32954,
		38009: 36649,
		38010: 37197,
		38011: 20493,
		38012: 22521,
		38013: 23186,
		38014: 26757,
		38016: 26995,
		38017: 29028,
		38018: 29437,
		38019: 36023,
		38020: 22770,
		38021: 36064,
		38022: 38506,
		38023: 36889,
		38024: 34687,
		38025: 31204,
		38026: 30695,
		38027: 33833,
		38028: 20271,
		38029: 21093,
		38030: 21338,
		38031: 25293,
		38032: 26575,
		38033: 27850,
		38034: 30333,
		38035: 31636,
		38036: 31893,
		38037: 33334,
		38038: 34180,
		38039: 36843,
		38040: 26333,
		38041: 28448,
		38042: 29190,
		38043: 32283,
		38044: 33707,
		38045: 39361,
		38046: 40614,
		38047: 20989,
		38048: 31665,
		38049: 30834,
		38050: 31672,
		38051: 32903,
		38052: 31560,
		38053: 27368,
		38054: 24161,
		38055: 32908,
		38056: 30033,
		38057: 30048,
		38058: 20843,
		38059: 37474,
		38060: 28300,
		38061: 30330,
		38062: 37271,
		38063: 39658,
		38064: 20240,
		38065: 32624,
		38066: 25244,
		38067: 31567,
		38068: 38309,
		38069: 40169,
		38070: 22138,
		38071: 22617,
		38072: 34532,
		38073: 38588,
		38074: 20276,
		38075: 21028,
		38076: 21322,
		38077: 21453,
		38078: 21467,
		38079: 24070,
		38080: 25644,
		38081: 26001,
		38082: 26495,
		38083: 27710,
		38084: 27726,
		38085: 29256,
		38086: 29359,
		38087: 29677,
		38088: 30036,
		38089: 32321,
		38090: 33324,
		38091: 34281,
		38092: 36009,
		38093: 31684,
		38094: 37318,
		38095: 29033,
		38096: 38930,
		38097: 39151,
		38098: 25405,
		38099: 26217,
		38100: 30058,
		38101: 30436,
		38102: 30928,
		38103: 34115,
		38104: 34542,
		38105: 21290,
		38106: 21329,
		38107: 21542,
		38108: 22915,
		38109: 24199,
		38110: 24444,
		38111: 24754,
		38112: 25161,
		38113: 25209,
		38114: 25259,
		38115: 26000,
		38116: 27604,
		38117: 27852,
		38118: 30130,
		38119: 30382,
		38120: 30865,
		38121: 31192,
		38122: 32203,
		38123: 32631,
		38124: 32933,
		38125: 34987,
		38126: 35513,
		38127: 36027,
		38128: 36991,
		38129: 38750,
		38130: 39131,
		38131: 27147,
		38132: 31800,
		38133: 20633,
		38134: 23614,
		38135: 24494,
		38136: 26503,
		38137: 27608,
		38138: 29749,
		38139: 30473,
		38140: 32654,
		38208: 40763,
		38209: 26570,
		38210: 31255,
		38211: 21305,
		38212: 30091,
		38213: 39661,
		38214: 24422,
		38215: 33181,
		38216: 33777,
		38217: 32920,
		38218: 24380,
		38219: 24517,
		38220: 30050,
		38221: 31558,
		38222: 36924,
		38223: 26727,
		38224: 23019,
		38225: 23195,
		38226: 32016,
		38227: 30334,
		38228: 35628,
		38229: 20469,
		38230: 24426,
		38231: 27161,
		38232: 27703,
		38233: 28418,
		38234: 29922,
		38235: 31080,
		38236: 34920,
		38237: 35413,
		38238: 35961,
		38239: 24287,
		38240: 25551,
		38241: 30149,
		38242: 31186,
		38243: 33495,
		38244: 37672,
		38245: 37618,
		38246: 33948,
		38247: 34541,
		38248: 39981,
		38249: 21697,
		38250: 24428,
		38251: 25996,
		38252: 27996,
		38253: 28693,
		38254: 36007,
		38255: 36051,
		38256: 38971,
		38257: 25935,
		38258: 29942,
		38259: 19981,
		38260: 20184,
		38261: 22496,
		38262: 22827,
		38263: 23142,
		38264: 23500,
		38265: 20904,
		38266: 24067,
		38267: 24220,
		38268: 24598,
		38269: 25206,
		38270: 25975,
		38272: 26023,
		38273: 26222,
		38274: 28014,
		38275: 29238,
		38276: 31526,
		38277: 33104,
		38278: 33178,
		38279: 33433,
		38280: 35676,
		38281: 36000,
		38282: 36070,
		38283: 36212,
		38284: 38428,
		38285: 38468,
		38286: 20398,
		38287: 25771,
		38288: 27494,
		38289: 33310,
		38290: 33889,
		38291: 34154,
		38292: 37096,
		38293: 23553,
		38294: 26963,
		38295: 39080,
		38296: 33914,
		38297: 34135,
		38298: 20239,
		38299: 21103,
		38300: 24489,
		38301: 24133,
		38302: 26381,
		38303: 31119,
		38304: 33145,
		38305: 35079,
		38306: 35206,
		38307: 28149,
		38308: 24343,
		38309: 25173,
		38310: 27832,
		38311: 20175,
		38312: 29289,
		38313: 39826,
		38314: 20998,
		38315: 21563,
		38316: 22132,
		38317: 22707,
		38318: 24996,
		38319: 25198,
		38320: 28954,
		38321: 22894,
		38322: 31881,
		38323: 31966,
		38324: 32027,
		38325: 38640,
		38326: 25991,
		38327: 32862,
		38328: 19993,
		38329: 20341,
		38330: 20853,
		38331: 22592,
		38332: 24163,
		38333: 24179,
		38334: 24330,
		38335: 26564,
		38336: 20006,
		38337: 34109,
		38338: 38281,
		38339: 38491,
		38340: 31859,
		38341: 38913,
		38342: 20731,
		38343: 22721,
		38344: 30294,
		38345: 30887,
		38346: 21029,
		38347: 30629,
		38348: 34065,
		38349: 31622,
		38350: 20559,
		38351: 22793,
		38352: 29255,
		38353: 31687,
		38354: 32232,
		38355: 36794,
		38356: 36820,
		38357: 36941,
		38358: 20415,
		38359: 21193,
		38360: 23081,
		38361: 24321,
		38362: 38829,
		38363: 20445,
		38364: 33303,
		38365: 37610,
		38366: 22275,
		38367: 25429,
		38368: 27497,
		38369: 29995,
		38370: 35036,
		38371: 36628,
		38372: 31298,
		38373: 21215,
		38374: 22675,
		38375: 24917,
		38376: 25098,
		38377: 26286,
		38378: 27597,
		38379: 31807,
		38380: 33769,
		38381: 20515,
		38382: 20472,
		38383: 21253,
		38384: 21574,
		38385: 22577,
		38386: 22857,
		38387: 23453,
		38388: 23792,
		38389: 23791,
		38390: 23849,
		38391: 24214,
		38392: 25265,
		38393: 25447,
		38394: 25918,
		38395: 26041,
		38396: 26379,
		38464: 27861,
		38465: 27873,
		38466: 28921,
		38467: 30770,
		38468: 32299,
		38469: 32990,
		38470: 33459,
		38471: 33804,
		38472: 34028,
		38473: 34562,
		38474: 35090,
		38475: 35370,
		38476: 35914,
		38477: 37030,
		38478: 37586,
		38479: 39165,
		38480: 40179,
		38481: 40300,
		38482: 20047,
		38483: 20129,
		38484: 20621,
		38485: 21078,
		38486: 22346,
		38487: 22952,
		38488: 24125,
		38489: 24536,
		38490: 24537,
		38491: 25151,
		38492: 26292,
		38493: 26395,
		38494: 26576,
		38495: 26834,
		38496: 20882,
		38497: 32033,
		38498: 32938,
		38499: 33192,
		38500: 35584,
		38501: 35980,
		38502: 36031,
		38503: 37502,
		38504: 38450,
		38505: 21536,
		38506: 38956,
		38507: 21271,
		38508: 20693,
		38509: 21340,
		38510: 22696,
		38511: 25778,
		38512: 26420,
		38513: 29287,
		38514: 30566,
		38515: 31302,
		38516: 37350,
		38517: 21187,
		38518: 27809,
		38519: 27526,
		38520: 22528,
		38521: 24140,
		38522: 22868,
		38523: 26412,
		38524: 32763,
		38525: 20961,
		38526: 30406,
		38528: 25705,
		38529: 30952,
		38530: 39764,
		38531: 40635,
		38532: 22475,
		38533: 22969,
		38534: 26151,
		38535: 26522,
		38536: 27598,
		38537: 21737,
		38538: 27097,
		38539: 24149,
		38540: 33180,
		38541: 26517,
		38542: 39850,
		38543: 26622,
		38544: 40018,
		38545: 26717,
		38546: 20134,
		38547: 20451,
		38548: 21448,
		38549: 25273,
		38550: 26411,
		38551: 27819,
		38552: 36804,
		38553: 20397,
		38554: 32365,
		38555: 40639,
		38556: 19975,
		38557: 24930,
		38558: 28288,
		38559: 28459,
		38560: 34067,
		38561: 21619,
		38562: 26410,
		38563: 39749,
		38564: 24051,
		38565: 31637,
		38566: 23724,
		38567: 23494,
		38568: 34588,
		38569: 28234,
		38570: 34001,
		38571: 31252,
		38572: 33032,
		38573: 22937,
		38574: 31885,
		38575: 27665,
		38576: 30496,
		38577: 21209,
		38578: 22818,
		38579: 28961,
		38580: 29279,
		38581: 30683,
		38582: 38695,
		38583: 40289,
		38584: 26891,
		38585: 23167,
		38586: 23064,
		38587: 20901,
		38588: 21517,
		38589: 21629,
		38590: 26126,
		38591: 30431,
		38592: 36855,
		38593: 37528,
		38594: 40180,
		38595: 23018,
		38596: 29277,
		38597: 28357,
		38598: 20813,
		38599: 26825,
		38600: 32191,
		38601: 32236,
		38602: 38754,
		38603: 40634,
		38604: 25720,
		38605: 27169,
		38606: 33538,
		38607: 22916,
		38608: 23391,
		38609: 27611,
		38610: 29467,
		38611: 30450,
		38612: 32178,
		38613: 32791,
		38614: 33945,
		38615: 20786,
		38616: 26408,
		38617: 40665,
		38618: 30446,
		38619: 26466,
		38620: 21247,
		38621: 39173,
		38622: 23588,
		38623: 25147,
		38624: 31870,
		38625: 36016,
		38626: 21839,
		38627: 24758,
		38628: 32011,
		38629: 38272,
		38630: 21249,
		38631: 20063,
		38632: 20918,
		38633: 22812,
		38634: 29242,
		38635: 32822,
		38636: 37326,
		38637: 24357,
		38638: 30690,
		38639: 21380,
		38640: 24441,
		38641: 32004,
		38642: 34220,
		38643: 35379,
		38644: 36493,
		38645: 38742,
		38646: 26611,
		38647: 34222,
		38648: 37971,
		38649: 24841,
		38650: 24840,
		38651: 27833,
		38652: 30290,
		38720: 35565,
		38721: 36664,
		38722: 21807,
		38723: 20305,
		38724: 20778,
		38725: 21191,
		38726: 21451,
		38727: 23461,
		38728: 24189,
		38729: 24736,
		38730: 24962,
		38731: 25558,
		38732: 26377,
		38733: 26586,
		38734: 28263,
		38735: 28044,
		38736: 29494,
		38737: 29495,
		38738: 30001,
		38739: 31056,
		38740: 35029,
		38741: 35480,
		38742: 36938,
		38743: 37009,
		38744: 37109,
		38745: 38596,
		38746: 34701,
		38747: 22805,
		38748: 20104,
		38749: 20313,
		38750: 19982,
		38751: 35465,
		38752: 36671,
		38753: 38928,
		38754: 20653,
		38755: 24188,
		38756: 22934,
		38757: 23481,
		38758: 24248,
		38759: 25562,
		38760: 25594,
		38761: 25793,
		38762: 26332,
		38763: 26954,
		38764: 27096,
		38765: 27915,
		38766: 28342,
		38767: 29076,
		38768: 29992,
		38769: 31407,
		38770: 32650,
		38771: 32768,
		38772: 33865,
		38773: 33993,
		38774: 35201,
		38775: 35617,
		38776: 36362,
		38777: 36965,
		38778: 38525,
		38779: 39178,
		38780: 24958,
		38781: 25233,
		38782: 27442,
		38784: 27779,
		38785: 28020,
		38786: 32716,
		38787: 32764,
		38788: 28096,
		38789: 32645,
		38790: 34746,
		38791: 35064,
		38792: 26469,
		38793: 33713,
		38794: 38972,
		38795: 38647,
		38796: 27931,
		38797: 32097,
		38798: 33853,
		38799: 37226,
		38800: 20081,
		38801: 21365,
		38802: 23888,
		38803: 27396,
		38804: 28651,
		38805: 34253,
		38806: 34349,
		38807: 35239,
		38808: 21033,
		38809: 21519,
		38810: 23653,
		38811: 26446,
		38812: 26792,
		38813: 29702,
		38814: 29827,
		38815: 30178,
		38816: 35023,
		38817: 35041,
		38818: 37324,
		38819: 38626,
		38820: 38520,
		38821: 24459,
		38822: 29575,
		38823: 31435,
		38824: 33870,
		38825: 25504,
		38826: 30053,
		38827: 21129,
		38828: 27969,
		38829: 28316,
		38830: 29705,
		38831: 30041,
		38832: 30827,
		38833: 31890,
		38834: 38534,
		38835: 31452,
		38836: 40845,
		38837: 20406,
		38838: 24942,
		38839: 26053,
		38840: 34396,
		38841: 20102,
		38842: 20142,
		38843: 20698,
		38844: 20001,
		38845: 20940,
		38846: 23534,
		38847: 26009,
		38848: 26753,
		38849: 28092,
		38850: 29471,
		38851: 30274,
		38852: 30637,
		38853: 31260,
		38854: 31975,
		38855: 33391,
		38856: 35538,
		38857: 36988,
		38858: 37327,
		38859: 38517,
		38860: 38936,
		38861: 21147,
		38862: 32209,
		38863: 20523,
		38864: 21400,
		38865: 26519,
		38866: 28107,
		38867: 29136,
		38868: 29747,
		38869: 33256,
		38870: 36650,
		38871: 38563,
		38872: 40023,
		38873: 40607,
		38874: 29792,
		38875: 22593,
		38876: 28057,
		38877: 32047,
		38878: 39006,
		38879: 20196,
		38880: 20278,
		38881: 20363,
		38882: 20919,
		38883: 21169,
		38884: 23994,
		38885: 24604,
		38886: 29618,
		38887: 31036,
		38888: 33491,
		38889: 37428,
		38890: 38583,
		38891: 38646,
		38892: 38666,
		38893: 40599,
		38894: 40802,
		38895: 26278,
		38896: 27508,
		38897: 21015,
		38898: 21155,
		38899: 28872,
		38900: 35010,
		38901: 24265,
		38902: 24651,
		38903: 24976,
		38904: 28451,
		38905: 29001,
		38906: 31806,
		38907: 32244,
		38908: 32879,
		38976: 34030,
		38977: 36899,
		38978: 37676,
		38979: 21570,
		38980: 39791,
		38981: 27347,
		38982: 28809,
		38983: 36034,
		38984: 36335,
		38985: 38706,
		38986: 21172,
		38987: 23105,
		38988: 24266,
		38989: 24324,
		38990: 26391,
		38991: 27004,
		38992: 27028,
		38993: 28010,
		38994: 28431,
		38995: 29282,
		38996: 29436,
		38997: 31725,
		38998: 32769,
		38999: 32894,
		39000: 34635,
		39001: 37070,
		39002: 20845,
		39003: 40595,
		39004: 31108,
		39005: 32907,
		39006: 37682,
		39007: 35542,
		39008: 20525,
		39009: 21644,
		39010: 35441,
		39011: 27498,
		39012: 36036,
		39013: 33031,
		39014: 24785,
		39015: 26528,
		39016: 40434,
		39017: 20121,
		39018: 20120,
		39019: 39952,
		39020: 35435,
		39021: 34241,
		39022: 34152,
		39023: 26880,
		39024: 28286,
		39025: 30871,
		39026: 33109,
		39071: 24332,
		39072: 19984,
		39073: 19989,
		39074: 20010,
		39075: 20017,
		39076: 20022,
		39077: 20028,
		39078: 20031,
		39079: 20034,
		39080: 20054,
		39081: 20056,
		39082: 20098,
		39083: 20101,
		39084: 35947,
		39085: 20106,
		39086: 33298,
		39087: 24333,
		39088: 20110,
		39089: 20126,
		39090: 20127,
		39091: 20128,
		39092: 20130,
		39093: 20144,
		39094: 20147,
		39095: 20150,
		39096: 20174,
		39097: 20173,
		39098: 20164,
		39099: 20166,
		39100: 20162,
		39101: 20183,
		39102: 20190,
		39103: 20205,
		39104: 20191,
		39105: 20215,
		39106: 20233,
		39107: 20314,
		39108: 20272,
		39109: 20315,
		39110: 20317,
		39111: 20311,
		39112: 20295,
		39113: 20342,
		39114: 20360,
		39115: 20367,
		39116: 20376,
		39117: 20347,
		39118: 20329,
		39119: 20336,
		39120: 20369,
		39121: 20335,
		39122: 20358,
		39123: 20374,
		39124: 20760,
		39125: 20436,
		39126: 20447,
		39127: 20430,
		39128: 20440,
		39129: 20443,
		39130: 20433,
		39131: 20442,
		39132: 20432,
		39133: 20452,
		39134: 20453,
		39135: 20506,
		39136: 20520,
		39137: 20500,
		39138: 20522,
		39139: 20517,
		39140: 20485,
		39141: 20252,
		39142: 20470,
		39143: 20513,
		39144: 20521,
		39145: 20524,
		39146: 20478,
		39147: 20463,
		39148: 20497,
		39149: 20486,
		39150: 20547,
		39151: 20551,
		39152: 26371,
		39153: 20565,
		39154: 20560,
		39155: 20552,
		39156: 20570,
		39157: 20566,
		39158: 20588,
		39159: 20600,
		39160: 20608,
		39161: 20634,
		39162: 20613,
		39163: 20660,
		39164: 20658,
		39232: 20681,
		39233: 20682,
		39234: 20659,
		39235: 20674,
		39236: 20694,
		39237: 20702,
		39238: 20709,
		39239: 20717,
		39240: 20707,
		39241: 20718,
		39242: 20729,
		39243: 20725,
		39244: 20745,
		39245: 20737,
		39246: 20738,
		39247: 20758,
		39248: 20757,
		39249: 20756,
		39250: 20762,
		39251: 20769,
		39252: 20794,
		39253: 20791,
		39254: 20796,
		39255: 20795,
		39256: 20799,
		39257: 20800,
		39258: 20818,
		39259: 20812,
		39260: 20820,
		39261: 20834,
		39262: 31480,
		39263: 20841,
		39264: 20842,
		39265: 20846,
		39266: 20864,
		39267: 20866,
		39268: 22232,
		39269: 20876,
		39270: 20873,
		39271: 20879,
		39272: 20881,
		39273: 20883,
		39274: 20885,
		39275: 20886,
		39276: 20900,
		39277: 20902,
		39278: 20898,
		39279: 20905,
		39280: 20906,
		39281: 20907,
		39282: 20915,
		39283: 20913,
		39284: 20914,
		39285: 20912,
		39286: 20917,
		39287: 20925,
		39288: 20933,
		39289: 20937,
		39290: 20955,
		39291: 20960,
		39292: 34389,
		39293: 20969,
		39294: 20973,
		39296: 20976,
		39297: 20981,
		39298: 20990,
		39299: 20996,
		39300: 21003,
		39301: 21012,
		39302: 21006,
		39303: 21031,
		39304: 21034,
		39305: 21038,
		39306: 21043,
		39307: 21049,
		39308: 21071,
		39309: 21060,
		39310: 21067,
		39311: 21068,
		39312: 21086,
		39313: 21076,
		39314: 21098,
		39315: 21108,
		39316: 21097,
		39317: 21107,
		39318: 21119,
		39319: 21117,
		39320: 21133,
		39321: 21140,
		39322: 21138,
		39323: 21105,
		39324: 21128,
		39325: 21137,
		39326: 36776,
		39327: 36775,
		39328: 21164,
		39329: 21165,
		39330: 21180,
		39331: 21173,
		39332: 21185,
		39333: 21197,
		39334: 21207,
		39335: 21214,
		39336: 21219,
		39337: 21222,
		39338: 39149,
		39339: 21216,
		39340: 21235,
		39341: 21237,
		39342: 21240,
		39343: 21241,
		39344: 21254,
		39345: 21256,
		39346: 30008,
		39347: 21261,
		39348: 21264,
		39349: 21263,
		39350: 21269,
		39351: 21274,
		39352: 21283,
		39353: 21295,
		39354: 21297,
		39355: 21299,
		39356: 21304,
		39357: 21312,
		39358: 21318,
		39359: 21317,
		39360: 19991,
		39361: 21321,
		39362: 21325,
		39363: 20950,
		39364: 21342,
		39365: 21353,
		39366: 21358,
		39367: 22808,
		39368: 21371,
		39369: 21367,
		39370: 21378,
		39371: 21398,
		39372: 21408,
		39373: 21414,
		39374: 21413,
		39375: 21422,
		39376: 21424,
		39377: 21430,
		39378: 21443,
		39379: 31762,
		39380: 38617,
		39381: 21471,
		39382: 26364,
		39383: 29166,
		39384: 21486,
		39385: 21480,
		39386: 21485,
		39387: 21498,
		39388: 21505,
		39389: 21565,
		39390: 21568,
		39391: 21548,
		39392: 21549,
		39393: 21564,
		39394: 21550,
		39395: 21558,
		39396: 21545,
		39397: 21533,
		39398: 21582,
		39399: 21647,
		39400: 21621,
		39401: 21646,
		39402: 21599,
		39403: 21617,
		39404: 21623,
		39405: 21616,
		39406: 21650,
		39407: 21627,
		39408: 21632,
		39409: 21622,
		39410: 21636,
		39411: 21648,
		39412: 21638,
		39413: 21703,
		39414: 21666,
		39415: 21688,
		39416: 21669,
		39417: 21676,
		39418: 21700,
		39419: 21704,
		39420: 21672,
		39488: 21675,
		39489: 21698,
		39490: 21668,
		39491: 21694,
		39492: 21692,
		39493: 21720,
		39494: 21733,
		39495: 21734,
		39496: 21775,
		39497: 21780,
		39498: 21757,
		39499: 21742,
		39500: 21741,
		39501: 21754,
		39502: 21730,
		39503: 21817,
		39504: 21824,
		39505: 21859,
		39506: 21836,
		39507: 21806,
		39508: 21852,
		39509: 21829,
		39510: 21846,
		39511: 21847,
		39512: 21816,
		39513: 21811,
		39514: 21853,
		39515: 21913,
		39516: 21888,
		39517: 21679,
		39518: 21898,
		39519: 21919,
		39520: 21883,
		39521: 21886,
		39522: 21912,
		39523: 21918,
		39524: 21934,
		39525: 21884,
		39526: 21891,
		39527: 21929,
		39528: 21895,
		39529: 21928,
		39530: 21978,
		39531: 21957,
		39532: 21983,
		39533: 21956,
		39534: 21980,
		39535: 21988,
		39536: 21972,
		39537: 22036,
		39538: 22007,
		39539: 22038,
		39540: 22014,
		39541: 22013,
		39542: 22043,
		39543: 22009,
		39544: 22094,
		39545: 22096,
		39546: 29151,
		39547: 22068,
		39548: 22070,
		39549: 22066,
		39550: 22072,
		39552: 22123,
		39553: 22116,
		39554: 22063,
		39555: 22124,
		39556: 22122,
		39557: 22150,
		39558: 22144,
		39559: 22154,
		39560: 22176,
		39561: 22164,
		39562: 22159,
		39563: 22181,
		39564: 22190,
		39565: 22198,
		39566: 22196,
		39567: 22210,
		39568: 22204,
		39569: 22209,
		39570: 22211,
		39571: 22208,
		39572: 22216,
		39573: 22222,
		39574: 22225,
		39575: 22227,
		39576: 22231,
		39577: 22254,
		39578: 22265,
		39579: 22272,
		39580: 22271,
		39581: 22276,
		39582: 22281,
		39583: 22280,
		39584: 22283,
		39585: 22285,
		39586: 22291,
		39587: 22296,
		39588: 22294,
		39589: 21959,
		39590: 22300,
		39591: 22310,
		39592: 22327,
		39593: 22328,
		39594: 22350,
		39595: 22331,
		39596: 22336,
		39597: 22351,
		39598: 22377,
		39599: 22464,
		39600: 22408,
		39601: 22369,
		39602: 22399,
		39603: 22409,
		39604: 22419,
		39605: 22432,
		39606: 22451,
		39607: 22436,
		39608: 22442,
		39609: 22448,
		39610: 22467,
		39611: 22470,
		39612: 22484,
		39613: 22482,
		39614: 22483,
		39615: 22538,
		39616: 22486,
		39617: 22499,
		39618: 22539,
		39619: 22553,
		39620: 22557,
		39621: 22642,
		39622: 22561,
		39623: 22626,
		39624: 22603,
		39625: 22640,
		39626: 27584,
		39627: 22610,
		39628: 22589,
		39629: 22649,
		39630: 22661,
		39631: 22713,
		39632: 22687,
		39633: 22699,
		39634: 22714,
		39635: 22750,
		39636: 22715,
		39637: 22712,
		39638: 22702,
		39639: 22725,
		39640: 22739,
		39641: 22737,
		39642: 22743,
		39643: 22745,
		39644: 22744,
		39645: 22757,
		39646: 22748,
		39647: 22756,
		39648: 22751,
		39649: 22767,
		39650: 22778,
		39651: 22777,
		39652: 22779,
		39653: 22780,
		39654: 22781,
		39655: 22786,
		39656: 22794,
		39657: 22800,
		39658: 22811,
		39659: 26790,
		39660: 22821,
		39661: 22828,
		39662: 22829,
		39663: 22834,
		39664: 22840,
		39665: 22846,
		39666: 31442,
		39667: 22869,
		39668: 22864,
		39669: 22862,
		39670: 22874,
		39671: 22872,
		39672: 22882,
		39673: 22880,
		39674: 22887,
		39675: 22892,
		39676: 22889,
		39744: 22904,
		39745: 22913,
		39746: 22941,
		39747: 20318,
		39748: 20395,
		39749: 22947,
		39750: 22962,
		39751: 22982,
		39752: 23016,
		39753: 23004,
		39754: 22925,
		39755: 23001,
		39756: 23002,
		39757: 23077,
		39758: 23071,
		39759: 23057,
		39760: 23068,
		39761: 23049,
		39762: 23066,
		39763: 23104,
		39764: 23148,
		39765: 23113,
		39766: 23093,
		39767: 23094,
		39768: 23138,
		39769: 23146,
		39770: 23194,
		39771: 23228,
		39772: 23230,
		39773: 23243,
		39774: 23234,
		39775: 23229,
		39776: 23267,
		39777: 23255,
		39778: 23270,
		39779: 23273,
		39780: 23254,
		39781: 23290,
		39782: 23291,
		39783: 23308,
		39784: 23307,
		39785: 23318,
		39786: 23346,
		39787: 23248,
		39788: 23338,
		39789: 23350,
		39790: 23358,
		39791: 23363,
		39792: 23365,
		39793: 23360,
		39794: 23377,
		39795: 23381,
		39796: 23386,
		39797: 23387,
		39798: 23397,
		39799: 23401,
		39800: 23408,
		39801: 23411,
		39802: 23413,
		39803: 23416,
		39804: 25992,
		39805: 23418,
		39806: 23424,
		39808: 23427,
		39809: 23462,
		39810: 23480,
		39811: 23491,
		39812: 23495,
		39813: 23497,
		39814: 23508,
		39815: 23504,
		39816: 23524,
		39817: 23526,
		39818: 23522,
		39819: 23518,
		39820: 23525,
		39821: 23531,
		39822: 23536,
		39823: 23542,
		39824: 23539,
		39825: 23557,
		39826: 23559,
		39827: 23560,
		39828: 23565,
		39829: 23571,
		39830: 23584,
		39831: 23586,
		39832: 23592,
		39833: 23608,
		39834: 23609,
		39835: 23617,
		39836: 23622,
		39837: 23630,
		39838: 23635,
		39839: 23632,
		39840: 23631,
		39841: 23409,
		39842: 23660,
		39843: 23662,
		39844: 20066,
		39845: 23670,
		39846: 23673,
		39847: 23692,
		39848: 23697,
		39849: 23700,
		39850: 22939,
		39851: 23723,
		39852: 23739,
		39853: 23734,
		39854: 23740,
		39855: 23735,
		39856: 23749,
		39857: 23742,
		39858: 23751,
		39859: 23769,
		39860: 23785,
		39861: 23805,
		39862: 23802,
		39863: 23789,
		39864: 23948,
		39865: 23786,
		39866: 23819,
		39867: 23829,
		39868: 23831,
		39869: 23900,
		39870: 23839,
		39871: 23835,
		39872: 23825,
		39873: 23828,
		39874: 23842,
		39875: 23834,
		39876: 23833,
		39877: 23832,
		39878: 23884,
		39879: 23890,
		39880: 23886,
		39881: 23883,
		39882: 23916,
		39883: 23923,
		39884: 23926,
		39885: 23943,
		39886: 23940,
		39887: 23938,
		39888: 23970,
		39889: 23965,
		39890: 23980,
		39891: 23982,
		39892: 23997,
		39893: 23952,
		39894: 23991,
		39895: 23996,
		39896: 24009,
		39897: 24013,
		39898: 24019,
		39899: 24018,
		39900: 24022,
		39901: 24027,
		39902: 24043,
		39903: 24050,
		39904: 24053,
		39905: 24075,
		39906: 24090,
		39907: 24089,
		39908: 24081,
		39909: 24091,
		39910: 24118,
		39911: 24119,
		39912: 24132,
		39913: 24131,
		39914: 24128,
		39915: 24142,
		39916: 24151,
		39917: 24148,
		39918: 24159,
		39919: 24162,
		39920: 24164,
		39921: 24135,
		39922: 24181,
		39923: 24182,
		39924: 24186,
		39925: 40636,
		39926: 24191,
		39927: 24224,
		39928: 24257,
		39929: 24258,
		39930: 24264,
		39931: 24272,
		39932: 24271,
		40000: 24278,
		40001: 24291,
		40002: 24285,
		40003: 24282,
		40004: 24283,
		40005: 24290,
		40006: 24289,
		40007: 24296,
		40008: 24297,
		40009: 24300,
		40010: 24305,
		40011: 24307,
		40012: 24304,
		40013: 24308,
		40014: 24312,
		40015: 24318,
		40016: 24323,
		40017: 24329,
		40018: 24413,
		40019: 24412,
		40020: 24331,
		40021: 24337,
		40022: 24342,
		40023: 24361,
		40024: 24365,
		40025: 24376,
		40026: 24385,
		40027: 24392,
		40028: 24396,
		40029: 24398,
		40030: 24367,
		40031: 24401,
		40032: 24406,
		40033: 24407,
		40034: 24409,
		40035: 24417,
		40036: 24429,
		40037: 24435,
		40038: 24439,
		40039: 24451,
		40040: 24450,
		40041: 24447,
		40042: 24458,
		40043: 24456,
		40044: 24465,
		40045: 24455,
		40046: 24478,
		40047: 24473,
		40048: 24472,
		40049: 24480,
		40050: 24488,
		40051: 24493,
		40052: 24508,
		40053: 24534,
		40054: 24571,
		40055: 24548,
		40056: 24568,
		40057: 24561,
		40058: 24541,
		40059: 24755,
		40060: 24575,
		40061: 24609,
		40062: 24672,
		40064: 24601,
		40065: 24592,
		40066: 24617,
		40067: 24590,
		40068: 24625,
		40069: 24603,
		40070: 24597,
		40071: 24619,
		40072: 24614,
		40073: 24591,
		40074: 24634,
		40075: 24666,
		40076: 24641,
		40077: 24682,
		40078: 24695,
		40079: 24671,
		40080: 24650,
		40081: 24646,
		40082: 24653,
		40083: 24675,
		40084: 24643,
		40085: 24676,
		40086: 24642,
		40087: 24684,
		40088: 24683,
		40089: 24665,
		40090: 24705,
		40091: 24717,
		40092: 24807,
		40093: 24707,
		40094: 24730,
		40095: 24708,
		40096: 24731,
		40097: 24726,
		40098: 24727,
		40099: 24722,
		40100: 24743,
		40101: 24715,
		40102: 24801,
		40103: 24760,
		40104: 24800,
		40105: 24787,
		40106: 24756,
		40107: 24560,
		40108: 24765,
		40109: 24774,
		40110: 24757,
		40111: 24792,
		40112: 24909,
		40113: 24853,
		40114: 24838,
		40115: 24822,
		40116: 24823,
		40117: 24832,
		40118: 24820,
		40119: 24826,
		40120: 24835,
		40121: 24865,
		40122: 24827,
		40123: 24817,
		40124: 24845,
		40125: 24846,
		40126: 24903,
		40127: 24894,
		40128: 24872,
		40129: 24871,
		40130: 24906,
		40131: 24895,
		40132: 24892,
		40133: 24876,
		40134: 24884,
		40135: 24893,
		40136: 24898,
		40137: 24900,
		40138: 24947,
		40139: 24951,
		40140: 24920,
		40141: 24921,
		40142: 24922,
		40143: 24939,
		40144: 24948,
		40145: 24943,
		40146: 24933,
		40147: 24945,
		40148: 24927,
		40149: 24925,
		40150: 24915,
		40151: 24949,
		40152: 24985,
		40153: 24982,
		40154: 24967,
		40155: 25004,
		40156: 24980,
		40157: 24986,
		40158: 24970,
		40159: 24977,
		40160: 25003,
		40161: 25006,
		40162: 25036,
		40163: 25034,
		40164: 25033,
		40165: 25079,
		40166: 25032,
		40167: 25027,
		40168: 25030,
		40169: 25018,
		40170: 25035,
		40171: 32633,
		40172: 25037,
		40173: 25062,
		40174: 25059,
		40175: 25078,
		40176: 25082,
		40177: 25076,
		40178: 25087,
		40179: 25085,
		40180: 25084,
		40181: 25086,
		40182: 25088,
		40183: 25096,
		40184: 25097,
		40185: 25101,
		40186: 25100,
		40187: 25108,
		40188: 25115,
		40256: 25118,
		40257: 25121,
		40258: 25130,
		40259: 25134,
		40260: 25136,
		40261: 25138,
		40262: 25139,
		40263: 25153,
		40264: 25166,
		40265: 25182,
		40266: 25187,
		40267: 25179,
		40268: 25184,
		40269: 25192,
		40270: 25212,
		40271: 25218,
		40272: 25225,
		40273: 25214,
		40274: 25234,
		40275: 25235,
		40276: 25238,
		40277: 25300,
		40278: 25219,
		40279: 25236,
		40280: 25303,
		40281: 25297,
		40282: 25275,
		40283: 25295,
		40284: 25343,
		40285: 25286,
		40286: 25812,
		40287: 25288,
		40288: 25308,
		40289: 25292,
		40290: 25290,
		40291: 25282,
		40292: 25287,
		40293: 25243,
		40294: 25289,
		40295: 25356,
		40296: 25326,
		40297: 25329,
		40298: 25383,
		40299: 25346,
		40300: 25352,
		40301: 25327,
		40302: 25333,
		40303: 25424,
		40304: 25406,
		40305: 25421,
		40306: 25628,
		40307: 25423,
		40308: 25494,
		40309: 25486,
		40310: 25472,
		40311: 25515,
		40312: 25462,
		40313: 25507,
		40314: 25487,
		40315: 25481,
		40316: 25503,
		40317: 25525,
		40318: 25451,
		40320: 25449,
		40321: 25534,
		40322: 25577,
		40323: 25536,
		40324: 25542,
		40325: 25571,
		40326: 25545,
		40327: 25554,
		40328: 25590,
		40329: 25540,
		40330: 25622,
		40331: 25652,
		40332: 25606,
		40333: 25619,
		40334: 25638,
		40335: 25654,
		40336: 25885,
		40337: 25623,
		40338: 25640,
		40339: 25615,
		40340: 25703,
		40341: 25711,
		40342: 25718,
		40343: 25678,
		40344: 25898,
		40345: 25749,
		40346: 25747,
		40347: 25765,
		40348: 25769,
		40349: 25736,
		40350: 25788,
		40351: 25818,
		40352: 25810,
		40353: 25797,
		40354: 25799,
		40355: 25787,
		40356: 25816,
		40357: 25794,
		40358: 25841,
		40359: 25831,
		40360: 33289,
		40361: 25824,
		40362: 25825,
		40363: 25260,
		40364: 25827,
		40365: 25839,
		40366: 25900,
		40367: 25846,
		40368: 25844,
		40369: 25842,
		40370: 25850,
		40371: 25856,
		40372: 25853,
		40373: 25880,
		40374: 25884,
		40375: 25861,
		40376: 25892,
		40377: 25891,
		40378: 25899,
		40379: 25908,
		40380: 25909,
		40381: 25911,
		40382: 25910,
		40383: 25912,
		40384: 30027,
		40385: 25928,
		40386: 25942,
		40387: 25941,
		40388: 25933,
		40389: 25944,
		40390: 25950,
		40391: 25949,
		40392: 25970,
		40393: 25976,
		40394: 25986,
		40395: 25987,
		40396: 35722,
		40397: 26011,
		40398: 26015,
		40399: 26027,
		40400: 26039,
		40401: 26051,
		40402: 26054,
		40403: 26049,
		40404: 26052,
		40405: 26060,
		40406: 26066,
		40407: 26075,
		40408: 26073,
		40409: 26080,
		40410: 26081,
		40411: 26097,
		40412: 26482,
		40413: 26122,
		40414: 26115,
		40415: 26107,
		40416: 26483,
		40417: 26165,
		40418: 26166,
		40419: 26164,
		40420: 26140,
		40421: 26191,
		40422: 26180,
		40423: 26185,
		40424: 26177,
		40425: 26206,
		40426: 26205,
		40427: 26212,
		40428: 26215,
		40429: 26216,
		40430: 26207,
		40431: 26210,
		40432: 26224,
		40433: 26243,
		40434: 26248,
		40435: 26254,
		40436: 26249,
		40437: 26244,
		40438: 26264,
		40439: 26269,
		40440: 26305,
		40441: 26297,
		40442: 26313,
		40443: 26302,
		40444: 26300,
		40512: 26308,
		40513: 26296,
		40514: 26326,
		40515: 26330,
		40516: 26336,
		40517: 26175,
		40518: 26342,
		40519: 26345,
		40520: 26352,
		40521: 26357,
		40522: 26359,
		40523: 26383,
		40524: 26390,
		40525: 26398,
		40526: 26406,
		40527: 26407,
		40528: 38712,
		40529: 26414,
		40530: 26431,
		40531: 26422,
		40532: 26433,
		40533: 26424,
		40534: 26423,
		40535: 26438,
		40536: 26462,
		40537: 26464,
		40538: 26457,
		40539: 26467,
		40540: 26468,
		40541: 26505,
		40542: 26480,
		40543: 26537,
		40544: 26492,
		40545: 26474,
		40546: 26508,
		40547: 26507,
		40548: 26534,
		40549: 26529,
		40550: 26501,
		40551: 26551,
		40552: 26607,
		40553: 26548,
		40554: 26604,
		40555: 26547,
		40556: 26601,
		40557: 26552,
		40558: 26596,
		40559: 26590,
		40560: 26589,
		40561: 26594,
		40562: 26606,
		40563: 26553,
		40564: 26574,
		40565: 26566,
		40566: 26599,
		40567: 27292,
		40568: 26654,
		40569: 26694,
		40570: 26665,
		40571: 26688,
		40572: 26701,
		40573: 26674,
		40574: 26702,
		40576: 26803,
		40577: 26667,
		40578: 26713,
		40579: 26723,
		40580: 26743,
		40581: 26751,
		40582: 26783,
		40583: 26767,
		40584: 26797,
		40585: 26772,
		40586: 26781,
		40587: 26779,
		40588: 26755,
		40589: 27310,
		40590: 26809,
		40591: 26740,
		40592: 26805,
		40593: 26784,
		40594: 26810,
		40595: 26895,
		40596: 26765,
		40597: 26750,
		40598: 26881,
		40599: 26826,
		40600: 26888,
		40601: 26840,
		40602: 26914,
		40603: 26918,
		40604: 26849,
		40605: 26892,
		40606: 26829,
		40607: 26836,
		40608: 26855,
		40609: 26837,
		40610: 26934,
		40611: 26898,
		40612: 26884,
		40613: 26839,
		40614: 26851,
		40615: 26917,
		40616: 26873,
		40617: 26848,
		40618: 26863,
		40619: 26920,
		40620: 26922,
		40621: 26906,
		40622: 26915,
		40623: 26913,
		40624: 26822,
		40625: 27001,
		40626: 26999,
		40627: 26972,
		40628: 27000,
		40629: 26987,
		40630: 26964,
		40631: 27006,
		40632: 26990,
		40633: 26937,
		40634: 26996,
		40635: 26941,
		40636: 26969,
		40637: 26928,
		40638: 26977,
		40639: 26974,
		40640: 26973,
		40641: 27009,
		40642: 26986,
		40643: 27058,
		40644: 27054,
		40645: 27088,
		40646: 27071,
		40647: 27073,
		40648: 27091,
		40649: 27070,
		40650: 27086,
		40651: 23528,
		40652: 27082,
		40653: 27101,
		40654: 27067,
		40655: 27075,
		40656: 27047,
		40657: 27182,
		40658: 27025,
		40659: 27040,
		40660: 27036,
		40661: 27029,
		40662: 27060,
		40663: 27102,
		40664: 27112,
		40665: 27138,
		40666: 27163,
		40667: 27135,
		40668: 27402,
		40669: 27129,
		40670: 27122,
		40671: 27111,
		40672: 27141,
		40673: 27057,
		40674: 27166,
		40675: 27117,
		40676: 27156,
		40677: 27115,
		40678: 27146,
		40679: 27154,
		40680: 27329,
		40681: 27171,
		40682: 27155,
		40683: 27204,
		40684: 27148,
		40685: 27250,
		40686: 27190,
		40687: 27256,
		40688: 27207,
		40689: 27234,
		40690: 27225,
		40691: 27238,
		40692: 27208,
		40693: 27192,
		40694: 27170,
		40695: 27280,
		40696: 27277,
		40697: 27296,
		40698: 27268,
		40699: 27298,
		40700: 27299,
		40768: 27287,
		40769: 34327,
		40770: 27323,
		40771: 27331,
		40772: 27330,
		40773: 27320,
		40774: 27315,
		40775: 27308,
		40776: 27358,
		40777: 27345,
		40778: 27359,
		40779: 27306,
		40780: 27354,
		40781: 27370,
		40782: 27387,
		40783: 27397,
		40784: 34326,
		40785: 27386,
		40786: 27410,
		40787: 27414,
		40788: 39729,
		40789: 27423,
		40790: 27448,
		40791: 27447,
		40792: 30428,
		40793: 27449,
		40794: 39150,
		40795: 27463,
		40796: 27459,
		40797: 27465,
		40798: 27472,
		40799: 27481,
		40800: 27476,
		40801: 27483,
		40802: 27487,
		40803: 27489,
		40804: 27512,
		40805: 27513,
		40806: 27519,
		40807: 27520,
		40808: 27524,
		40809: 27523,
		40810: 27533,
		40811: 27544,
		40812: 27541,
		40813: 27550,
		40814: 27556,
		40815: 27562,
		40816: 27563,
		40817: 27567,
		40818: 27570,
		40819: 27569,
		40820: 27571,
		40821: 27575,
		40822: 27580,
		40823: 27590,
		40824: 27595,
		40825: 27603,
		40826: 27615,
		40827: 27628,
		40828: 27627,
		40829: 27635,
		40830: 27631,
		40832: 40638,
		40833: 27656,
		40834: 27667,
		40835: 27668,
		40836: 27675,
		40837: 27684,
		40838: 27683,
		40839: 27742,
		40840: 27733,
		40841: 27746,
		40842: 27754,
		40843: 27778,
		40844: 27789,
		40845: 27802,
		40846: 27777,
		40847: 27803,
		40848: 27774,
		40849: 27752,
		40850: 27763,
		40851: 27794,
		40852: 27792,
		40853: 27844,
		40854: 27889,
		40855: 27859,
		40856: 27837,
		40857: 27863,
		40858: 27845,
		40859: 27869,
		40860: 27822,
		40861: 27825,
		40862: 27838,
		40863: 27834,
		40864: 27867,
		40865: 27887,
		40866: 27865,
		40867: 27882,
		40868: 27935,
		40869: 34893,
		40870: 27958,
		40871: 27947,
		40872: 27965,
		40873: 27960,
		40874: 27929,
		40875: 27957,
		40876: 27955,
		40877: 27922,
		40878: 27916,
		40879: 28003,
		40880: 28051,
		40881: 28004,
		40882: 27994,
		40883: 28025,
		40884: 27993,
		40885: 28046,
		40886: 28053,
		40887: 28644,
		40888: 28037,
		40889: 28153,
		40890: 28181,
		40891: 28170,
		40892: 28085,
		40893: 28103,
		40894: 28134,
		40895: 28088,
		40896: 28102,
		40897: 28140,
		40898: 28126,
		40899: 28108,
		40900: 28136,
		40901: 28114,
		40902: 28101,
		40903: 28154,
		40904: 28121,
		40905: 28132,
		40906: 28117,
		40907: 28138,
		40908: 28142,
		40909: 28205,
		40910: 28270,
		40911: 28206,
		40912: 28185,
		40913: 28274,
		40914: 28255,
		40915: 28222,
		40916: 28195,
		40917: 28267,
		40918: 28203,
		40919: 28278,
		40920: 28237,
		40921: 28191,
		40922: 28227,
		40923: 28218,
		40924: 28238,
		40925: 28196,
		40926: 28415,
		40927: 28189,
		40928: 28216,
		40929: 28290,
		40930: 28330,
		40931: 28312,
		40932: 28361,
		40933: 28343,
		40934: 28371,
		40935: 28349,
		40936: 28335,
		40937: 28356,
		40938: 28338,
		40939: 28372,
		40940: 28373,
		40941: 28303,
		40942: 28325,
		40943: 28354,
		40944: 28319,
		40945: 28481,
		40946: 28433,
		40947: 28748,
		40948: 28396,
		40949: 28408,
		40950: 28414,
		40951: 28479,
		40952: 28402,
		40953: 28465,
		40954: 28399,
		40955: 28466,
		40956: 28364,
		57408: 28478,
		57409: 28435,
		57410: 28407,
		57411: 28550,
		57412: 28538,
		57413: 28536,
		57414: 28545,
		57415: 28544,
		57416: 28527,
		57417: 28507,
		57418: 28659,
		57419: 28525,
		57420: 28546,
		57421: 28540,
		57422: 28504,
		57423: 28558,
		57424: 28561,
		57425: 28610,
		57426: 28518,
		57427: 28595,
		57428: 28579,
		57429: 28577,
		57430: 28580,
		57431: 28601,
		57432: 28614,
		57433: 28586,
		57434: 28639,
		57435: 28629,
		57436: 28652,
		57437: 28628,
		57438: 28632,
		57439: 28657,
		57440: 28654,
		57441: 28635,
		57442: 28681,
		57443: 28683,
		57444: 28666,
		57445: 28689,
		57446: 28673,
		57447: 28687,
		57448: 28670,
		57449: 28699,
		57450: 28698,
		57451: 28532,
		57452: 28701,
		57453: 28696,
		57454: 28703,
		57455: 28720,
		57456: 28734,
		57457: 28722,
		57458: 28753,
		57459: 28771,
		57460: 28825,
		57461: 28818,
		57462: 28847,
		57463: 28913,
		57464: 28844,
		57465: 28856,
		57466: 28851,
		57467: 28846,
		57468: 28895,
		57469: 28875,
		57470: 28893,
		57472: 28889,
		57473: 28937,
		57474: 28925,
		57475: 28956,
		57476: 28953,
		57477: 29029,
		57478: 29013,
		57479: 29064,
		57480: 29030,
		57481: 29026,
		57482: 29004,
		57483: 29014,
		57484: 29036,
		57485: 29071,
		57486: 29179,
		57487: 29060,
		57488: 29077,
		57489: 29096,
		57490: 29100,
		57491: 29143,
		57492: 29113,
		57493: 29118,
		57494: 29138,
		57495: 29129,
		57496: 29140,
		57497: 29134,
		57498: 29152,
		57499: 29164,
		57500: 29159,
		57501: 29173,
		57502: 29180,
		57503: 29177,
		57504: 29183,
		57505: 29197,
		57506: 29200,
		57507: 29211,
		57508: 29224,
		57509: 29229,
		57510: 29228,
		57511: 29232,
		57512: 29234,
		57513: 29243,
		57514: 29244,
		57515: 29247,
		57516: 29248,
		57517: 29254,
		57518: 29259,
		57519: 29272,
		57520: 29300,
		57521: 29310,
		57522: 29314,
		57523: 29313,
		57524: 29319,
		57525: 29330,
		57526: 29334,
		57527: 29346,
		57528: 29351,
		57529: 29369,
		57530: 29362,
		57531: 29379,
		57532: 29382,
		57533: 29380,
		57534: 29390,
		57535: 29394,
		57536: 29410,
		57537: 29408,
		57538: 29409,
		57539: 29433,
		57540: 29431,
		57541: 20495,
		57542: 29463,
		57543: 29450,
		57544: 29468,
		57545: 29462,
		57546: 29469,
		57547: 29492,
		57548: 29487,
		57549: 29481,
		57550: 29477,
		57551: 29502,
		57552: 29518,
		57553: 29519,
		57554: 40664,
		57555: 29527,
		57556: 29546,
		57557: 29544,
		57558: 29552,
		57559: 29560,
		57560: 29557,
		57561: 29563,
		57562: 29562,
		57563: 29640,
		57564: 29619,
		57565: 29646,
		57566: 29627,
		57567: 29632,
		57568: 29669,
		57569: 29678,
		57570: 29662,
		57571: 29858,
		57572: 29701,
		57573: 29807,
		57574: 29733,
		57575: 29688,
		57576: 29746,
		57577: 29754,
		57578: 29781,
		57579: 29759,
		57580: 29791,
		57581: 29785,
		57582: 29761,
		57583: 29788,
		57584: 29801,
		57585: 29808,
		57586: 29795,
		57587: 29802,
		57588: 29814,
		57589: 29822,
		57590: 29835,
		57591: 29854,
		57592: 29863,
		57593: 29898,
		57594: 29903,
		57595: 29908,
		57596: 29681,
		57664: 29920,
		57665: 29923,
		57666: 29927,
		57667: 29929,
		57668: 29934,
		57669: 29938,
		57670: 29936,
		57671: 29937,
		57672: 29944,
		57673: 29943,
		57674: 29956,
		57675: 29955,
		57676: 29957,
		57677: 29964,
		57678: 29966,
		57679: 29965,
		57680: 29973,
		57681: 29971,
		57682: 29982,
		57683: 29990,
		57684: 29996,
		57685: 30012,
		57686: 30020,
		57687: 30029,
		57688: 30026,
		57689: 30025,
		57690: 30043,
		57691: 30022,
		57692: 30042,
		57693: 30057,
		57694: 30052,
		57695: 30055,
		57696: 30059,
		57697: 30061,
		57698: 30072,
		57699: 30070,
		57700: 30086,
		57701: 30087,
		57702: 30068,
		57703: 30090,
		57704: 30089,
		57705: 30082,
		57706: 30100,
		57707: 30106,
		57708: 30109,
		57709: 30117,
		57710: 30115,
		57711: 30146,
		57712: 30131,
		57713: 30147,
		57714: 30133,
		57715: 30141,
		57716: 30136,
		57717: 30140,
		57718: 30129,
		57719: 30157,
		57720: 30154,
		57721: 30162,
		57722: 30169,
		57723: 30179,
		57724: 30174,
		57725: 30206,
		57726: 30207,
		57728: 30204,
		57729: 30209,
		57730: 30192,
		57731: 30202,
		57732: 30194,
		57733: 30195,
		57734: 30219,
		57735: 30221,
		57736: 30217,
		57737: 30239,
		57738: 30247,
		57739: 30240,
		57740: 30241,
		57741: 30242,
		57742: 30244,
		57743: 30260,
		57744: 30256,
		57745: 30267,
		57746: 30279,
		57747: 30280,
		57748: 30278,
		57749: 30300,
		57750: 30296,
		57751: 30305,
		57752: 30306,
		57753: 30312,
		57754: 30313,
		57755: 30314,
		57756: 30311,
		57757: 30316,
		57758: 30320,
		57759: 30322,
		57760: 30326,
		57761: 30328,
		57762: 30332,
		57763: 30336,
		57764: 30339,
		57765: 30344,
		57766: 30347,
		57767: 30350,
		57768: 30358,
		57769: 30355,
		57770: 30361,
		57771: 30362,
		57772: 30384,
		57773: 30388,
		57774: 30392,
		57775: 30393,
		57776: 30394,
		57777: 30402,
		57778: 30413,
		57779: 30422,
		57780: 30418,
		57781: 30430,
		57782: 30433,
		57783: 30437,
		57784: 30439,
		57785: 30442,
		57786: 34351,
		57787: 30459,
		57788: 30472,
		57789: 30471,
		57790: 30468,
		57791: 30505,
		57792: 30500,
		57793: 30494,
		57794: 30501,
		57795: 30502,
		57796: 30491,
		57797: 30519,
		57798: 30520,
		57799: 30535,
		57800: 30554,
		57801: 30568,
		57802: 30571,
		57803: 30555,
		57804: 30565,
		57805: 30591,
		57806: 30590,
		57807: 30585,
		57808: 30606,
		57809: 30603,
		57810: 30609,
		57811: 30624,
		57812: 30622,
		57813: 30640,
		57814: 30646,
		57815: 30649,
		57816: 30655,
		57817: 30652,
		57818: 30653,
		57819: 30651,
		57820: 30663,
		57821: 30669,
		57822: 30679,
		57823: 30682,
		57824: 30684,
		57825: 30691,
		57826: 30702,
		57827: 30716,
		57828: 30732,
		57829: 30738,
		57830: 31014,
		57831: 30752,
		57832: 31018,
		57833: 30789,
		57834: 30862,
		57835: 30836,
		57836: 30854,
		57837: 30844,
		57838: 30874,
		57839: 30860,
		57840: 30883,
		57841: 30901,
		57842: 30890,
		57843: 30895,
		57844: 30929,
		57845: 30918,
		57846: 30923,
		57847: 30932,
		57848: 30910,
		57849: 30908,
		57850: 30917,
		57851: 30922,
		57852: 30956,
		57920: 30951,
		57921: 30938,
		57922: 30973,
		57923: 30964,
		57924: 30983,
		57925: 30994,
		57926: 30993,
		57927: 31001,
		57928: 31020,
		57929: 31019,
		57930: 31040,
		57931: 31072,
		57932: 31063,
		57933: 31071,
		57934: 31066,
		57935: 31061,
		57936: 31059,
		57937: 31098,
		57938: 31103,
		57939: 31114,
		57940: 31133,
		57941: 31143,
		57942: 40779,
		57943: 31146,
		57944: 31150,
		57945: 31155,
		57946: 31161,
		57947: 31162,
		57948: 31177,
		57949: 31189,
		57950: 31207,
		57951: 31212,
		57952: 31201,
		57953: 31203,
		57954: 31240,
		57955: 31245,
		57956: 31256,
		57957: 31257,
		57958: 31264,
		57959: 31263,
		57960: 31104,
		57961: 31281,
		57962: 31291,
		57963: 31294,
		57964: 31287,
		57965: 31299,
		57966: 31319,
		57967: 31305,
		57968: 31329,
		57969: 31330,
		57970: 31337,
		57971: 40861,
		57972: 31344,
		57973: 31353,
		57974: 31357,
		57975: 31368,
		57976: 31383,
		57977: 31381,
		57978: 31384,
		57979: 31382,
		57980: 31401,
		57981: 31432,
		57982: 31408,
		57984: 31414,
		57985: 31429,
		57986: 31428,
		57987: 31423,
		57988: 36995,
		57989: 31431,
		57990: 31434,
		57991: 31437,
		57992: 31439,
		57993: 31445,
		57994: 31443,
		57995: 31449,
		57996: 31450,
		57997: 31453,
		57998: 31457,
		57999: 31458,
		58000: 31462,
		58001: 31469,
		58002: 31472,
		58003: 31490,
		58004: 31503,
		58005: 31498,
		58006: 31494,
		58007: 31539,
		58008: 31512,
		58009: 31513,
		58010: 31518,
		58011: 31541,
		58012: 31528,
		58013: 31542,
		58014: 31568,
		58015: 31610,
		58016: 31492,
		58017: 31565,
		58018: 31499,
		58019: 31564,
		58020: 31557,
		58021: 31605,
		58022: 31589,
		58023: 31604,
		58024: 31591,
		58025: 31600,
		58026: 31601,
		58027: 31596,
		58028: 31598,
		58029: 31645,
		58030: 31640,
		58031: 31647,
		58032: 31629,
		58033: 31644,
		58034: 31642,
		58035: 31627,
		58036: 31634,
		58037: 31631,
		58038: 31581,
		58039: 31641,
		58040: 31691,
		58041: 31681,
		58042: 31692,
		58043: 31695,
		58044: 31668,
		58045: 31686,
		58046: 31709,
		58047: 31721,
		58048: 31761,
		58049: 31764,
		58050: 31718,
		58051: 31717,
		58052: 31840,
		58053: 31744,
		58054: 31751,
		58055: 31763,
		58056: 31731,
		58057: 31735,
		58058: 31767,
		58059: 31757,
		58060: 31734,
		58061: 31779,
		58062: 31783,
		58063: 31786,
		58064: 31775,
		58065: 31799,
		58066: 31787,
		58067: 31805,
		58068: 31820,
		58069: 31811,
		58070: 31828,
		58071: 31823,
		58072: 31808,
		58073: 31824,
		58074: 31832,
		58075: 31839,
		58076: 31844,
		58077: 31830,
		58078: 31845,
		58079: 31852,
		58080: 31861,
		58081: 31875,
		58082: 31888,
		58083: 31908,
		58084: 31917,
		58085: 31906,
		58086: 31915,
		58087: 31905,
		58088: 31912,
		58089: 31923,
		58090: 31922,
		58091: 31921,
		58092: 31918,
		58093: 31929,
		58094: 31933,
		58095: 31936,
		58096: 31941,
		58097: 31938,
		58098: 31960,
		58099: 31954,
		58100: 31964,
		58101: 31970,
		58102: 39739,
		58103: 31983,
		58104: 31986,
		58105: 31988,
		58106: 31990,
		58107: 31994,
		58108: 32006,
		58176: 32002,
		58177: 32028,
		58178: 32021,
		58179: 32010,
		58180: 32069,
		58181: 32075,
		58182: 32046,
		58183: 32050,
		58184: 32063,
		58185: 32053,
		58186: 32070,
		58187: 32115,
		58188: 32086,
		58189: 32078,
		58190: 32114,
		58191: 32104,
		58192: 32110,
		58193: 32079,
		58194: 32099,
		58195: 32147,
		58196: 32137,
		58197: 32091,
		58198: 32143,
		58199: 32125,
		58200: 32155,
		58201: 32186,
		58202: 32174,
		58203: 32163,
		58204: 32181,
		58205: 32199,
		58206: 32189,
		58207: 32171,
		58208: 32317,
		58209: 32162,
		58210: 32175,
		58211: 32220,
		58212: 32184,
		58213: 32159,
		58214: 32176,
		58215: 32216,
		58216: 32221,
		58217: 32228,
		58218: 32222,
		58219: 32251,
		58220: 32242,
		58221: 32225,
		58222: 32261,
		58223: 32266,
		58224: 32291,
		58225: 32289,
		58226: 32274,
		58227: 32305,
		58228: 32287,
		58229: 32265,
		58230: 32267,
		58231: 32290,
		58232: 32326,
		58233: 32358,
		58234: 32315,
		58235: 32309,
		58236: 32313,
		58237: 32323,
		58238: 32311,
		58240: 32306,
		58241: 32314,
		58242: 32359,
		58243: 32349,
		58244: 32342,
		58245: 32350,
		58246: 32345,
		58247: 32346,
		58248: 32377,
		58249: 32362,
		58250: 32361,
		58251: 32380,
		58252: 32379,
		58253: 32387,
		58254: 32213,
		58255: 32381,
		58256: 36782,
		58257: 32383,
		58258: 32392,
		58259: 32393,
		58260: 32396,
		58261: 32402,
		58262: 32400,
		58263: 32403,
		58264: 32404,
		58265: 32406,
		58266: 32398,
		58267: 32411,
		58268: 32412,
		58269: 32568,
		58270: 32570,
		58271: 32581,
		58272: 32588,
		58273: 32589,
		58274: 32590,
		58275: 32592,
		58276: 32593,
		58277: 32597,
		58278: 32596,
		58279: 32600,
		58280: 32607,
		58281: 32608,
		58282: 32616,
		58283: 32617,
		58284: 32615,
		58285: 32632,
		58286: 32642,
		58287: 32646,
		58288: 32643,
		58289: 32648,
		58290: 32647,
		58291: 32652,
		58292: 32660,
		58293: 32670,
		58294: 32669,
		58295: 32666,
		58296: 32675,
		58297: 32687,
		58298: 32690,
		58299: 32697,
		58300: 32686,
		58301: 32694,
		58302: 32696,
		58303: 35697,
		58304: 32709,
		58305: 32710,
		58306: 32714,
		58307: 32725,
		58308: 32724,
		58309: 32737,
		58310: 32742,
		58311: 32745,
		58312: 32755,
		58313: 32761,
		58314: 39132,
		58315: 32774,
		58316: 32772,
		58317: 32779,
		58318: 32786,
		58319: 32792,
		58320: 32793,
		58321: 32796,
		58322: 32801,
		58323: 32808,
		58324: 32831,
		58325: 32827,
		58326: 32842,
		58327: 32838,
		58328: 32850,
		58329: 32856,
		58330: 32858,
		58331: 32863,
		58332: 32866,
		58333: 32872,
		58334: 32883,
		58335: 32882,
		58336: 32880,
		58337: 32886,
		58338: 32889,
		58339: 32893,
		58340: 32895,
		58341: 32900,
		58342: 32902,
		58343: 32901,
		58344: 32923,
		58345: 32915,
		58346: 32922,
		58347: 32941,
		58348: 20880,
		58349: 32940,
		58350: 32987,
		58351: 32997,
		58352: 32985,
		58353: 32989,
		58354: 32964,
		58355: 32986,
		58356: 32982,
		58357: 33033,
		58358: 33007,
		58359: 33009,
		58360: 33051,
		58361: 33065,
		58362: 33059,
		58363: 33071,
		58364: 33099,
		58432: 38539,
		58433: 33094,
		58434: 33086,
		58435: 33107,
		58436: 33105,
		58437: 33020,
		58438: 33137,
		58439: 33134,
		58440: 33125,
		58441: 33126,
		58442: 33140,
		58443: 33155,
		58444: 33160,
		58445: 33162,
		58446: 33152,
		58447: 33154,
		58448: 33184,
		58449: 33173,
		58450: 33188,
		58451: 33187,
		58452: 33119,
		58453: 33171,
		58454: 33193,
		58455: 33200,
		58456: 33205,
		58457: 33214,
		58458: 33208,
		58459: 33213,
		58460: 33216,
		58461: 33218,
		58462: 33210,
		58463: 33225,
		58464: 33229,
		58465: 33233,
		58466: 33241,
		58467: 33240,
		58468: 33224,
		58469: 33242,
		58470: 33247,
		58471: 33248,
		58472: 33255,
		58473: 33274,
		58474: 33275,
		58475: 33278,
		58476: 33281,
		58477: 33282,
		58478: 33285,
		58479: 33287,
		58480: 33290,
		58481: 33293,
		58482: 33296,
		58483: 33302,
		58484: 33321,
		58485: 33323,
		58486: 33336,
		58487: 33331,
		58488: 33344,
		58489: 33369,
		58490: 33368,
		58491: 33373,
		58492: 33370,
		58493: 33375,
		58494: 33380,
		58496: 33378,
		58497: 33384,
		58498: 33386,
		58499: 33387,
		58500: 33326,
		58501: 33393,
		58502: 33399,
		58503: 33400,
		58504: 33406,
		58505: 33421,
		58506: 33426,
		58507: 33451,
		58508: 33439,
		58509: 33467,
		58510: 33452,
		58511: 33505,
		58512: 33507,
		58513: 33503,
		58514: 33490,
		58515: 33524,
		58516: 33523,
		58517: 33530,
		58518: 33683,
		58519: 33539,
		58520: 33531,
		58521: 33529,
		58522: 33502,
		58523: 33542,
		58524: 33500,
		58525: 33545,
		58526: 33497,
		58527: 33589,
		58528: 33588,
		58529: 33558,
		58530: 33586,
		58531: 33585,
		58532: 33600,
		58533: 33593,
		58534: 33616,
		58535: 33605,
		58536: 33583,
		58537: 33579,
		58538: 33559,
		58539: 33560,
		58540: 33669,
		58541: 33690,
		58542: 33706,
		58543: 33695,
		58544: 33698,
		58545: 33686,
		58546: 33571,
		58547: 33678,
		58548: 33671,
		58549: 33674,
		58550: 33660,
		58551: 33717,
		58552: 33651,
		58553: 33653,
		58554: 33696,
		58555: 33673,
		58556: 33704,
		58557: 33780,
		58558: 33811,
		58559: 33771,
		58560: 33742,
		58561: 33789,
		58562: 33795,
		58563: 33752,
		58564: 33803,
		58565: 33729,
		58566: 33783,
		58567: 33799,
		58568: 33760,
		58569: 33778,
		58570: 33805,
		58571: 33826,
		58572: 33824,
		58573: 33725,
		58574: 33848,
		58575: 34054,
		58576: 33787,
		58577: 33901,
		58578: 33834,
		58579: 33852,
		58580: 34138,
		58581: 33924,
		58582: 33911,
		58583: 33899,
		58584: 33965,
		58585: 33902,
		58586: 33922,
		58587: 33897,
		58588: 33862,
		58589: 33836,
		58590: 33903,
		58591: 33913,
		58592: 33845,
		58593: 33994,
		58594: 33890,
		58595: 33977,
		58596: 33983,
		58597: 33951,
		58598: 34009,
		58599: 33997,
		58600: 33979,
		58601: 34010,
		58602: 34000,
		58603: 33985,
		58604: 33990,
		58605: 34006,
		58606: 33953,
		58607: 34081,
		58608: 34047,
		58609: 34036,
		58610: 34071,
		58611: 34072,
		58612: 34092,
		58613: 34079,
		58614: 34069,
		58615: 34068,
		58616: 34044,
		58617: 34112,
		58618: 34147,
		58619: 34136,
		58620: 34120,
		58688: 34113,
		58689: 34306,
		58690: 34123,
		58691: 34133,
		58692: 34176,
		58693: 34212,
		58694: 34184,
		58695: 34193,
		58696: 34186,
		58697: 34216,
		58698: 34157,
		58699: 34196,
		58700: 34203,
		58701: 34282,
		58702: 34183,
		58703: 34204,
		58704: 34167,
		58705: 34174,
		58706: 34192,
		58707: 34249,
		58708: 34234,
		58709: 34255,
		58710: 34233,
		58711: 34256,
		58712: 34261,
		58713: 34269,
		58714: 34277,
		58715: 34268,
		58716: 34297,
		58717: 34314,
		58718: 34323,
		58719: 34315,
		58720: 34302,
		58721: 34298,
		58722: 34310,
		58723: 34338,
		58724: 34330,
		58725: 34352,
		58726: 34367,
		58727: 34381,
		58728: 20053,
		58729: 34388,
		58730: 34399,
		58731: 34407,
		58732: 34417,
		58733: 34451,
		58734: 34467,
		58735: 34473,
		58736: 34474,
		58737: 34443,
		58738: 34444,
		58739: 34486,
		58740: 34479,
		58741: 34500,
		58742: 34502,
		58743: 34480,
		58744: 34505,
		58745: 34851,
		58746: 34475,
		58747: 34516,
		58748: 34526,
		58749: 34537,
		58750: 34540,
		58752: 34527,
		58753: 34523,
		58754: 34543,
		58755: 34578,
		58756: 34566,
		58757: 34568,
		58758: 34560,
		58759: 34563,
		58760: 34555,
		58761: 34577,
		58762: 34569,
		58763: 34573,
		58764: 34553,
		58765: 34570,
		58766: 34612,
		58767: 34623,
		58768: 34615,
		58769: 34619,
		58770: 34597,
		58771: 34601,
		58772: 34586,
		58773: 34656,
		58774: 34655,
		58775: 34680,
		58776: 34636,
		58777: 34638,
		58778: 34676,
		58779: 34647,
		58780: 34664,
		58781: 34670,
		58782: 34649,
		58783: 34643,
		58784: 34659,
		58785: 34666,
		58786: 34821,
		58787: 34722,
		58788: 34719,
		58789: 34690,
		58790: 34735,
		58791: 34763,
		58792: 34749,
		58793: 34752,
		58794: 34768,
		58795: 38614,
		58796: 34731,
		58797: 34756,
		58798: 34739,
		58799: 34759,
		58800: 34758,
		58801: 34747,
		58802: 34799,
		58803: 34802,
		58804: 34784,
		58805: 34831,
		58806: 34829,
		58807: 34814,
		58808: 34806,
		58809: 34807,
		58810: 34830,
		58811: 34770,
		58812: 34833,
		58813: 34838,
		58814: 34837,
		58815: 34850,
		58816: 34849,
		58817: 34865,
		58818: 34870,
		58819: 34873,
		58820: 34855,
		58821: 34875,
		58822: 34884,
		58823: 34882,
		58824: 34898,
		58825: 34905,
		58826: 34910,
		58827: 34914,
		58828: 34923,
		58829: 34945,
		58830: 34942,
		58831: 34974,
		58832: 34933,
		58833: 34941,
		58834: 34997,
		58835: 34930,
		58836: 34946,
		58837: 34967,
		58838: 34962,
		58839: 34990,
		58840: 34969,
		58841: 34978,
		58842: 34957,
		58843: 34980,
		58844: 34992,
		58845: 35007,
		58846: 34993,
		58847: 35011,
		58848: 35012,
		58849: 35028,
		58850: 35032,
		58851: 35033,
		58852: 35037,
		58853: 35065,
		58854: 35074,
		58855: 35068,
		58856: 35060,
		58857: 35048,
		58858: 35058,
		58859: 35076,
		58860: 35084,
		58861: 35082,
		58862: 35091,
		58863: 35139,
		58864: 35102,
		58865: 35109,
		58866: 35114,
		58867: 35115,
		58868: 35137,
		58869: 35140,
		58870: 35131,
		58871: 35126,
		58872: 35128,
		58873: 35148,
		58874: 35101,
		58875: 35168,
		58876: 35166,
		58944: 35174,
		58945: 35172,
		58946: 35181,
		58947: 35178,
		58948: 35183,
		58949: 35188,
		58950: 35191,
		58951: 35198,
		58952: 35203,
		58953: 35208,
		58954: 35210,
		58955: 35219,
		58956: 35224,
		58957: 35233,
		58958: 35241,
		58959: 35238,
		58960: 35244,
		58961: 35247,
		58962: 35250,
		58963: 35258,
		58964: 35261,
		58965: 35263,
		58966: 35264,
		58967: 35290,
		58968: 35292,
		58969: 35293,
		58970: 35303,
		58971: 35316,
		58972: 35320,
		58973: 35331,
		58974: 35350,
		58975: 35344,
		58976: 35340,
		58977: 35355,
		58978: 35357,
		58979: 35365,
		58980: 35382,
		58981: 35393,
		58982: 35419,
		58983: 35410,
		58984: 35398,
		58985: 35400,
		58986: 35452,
		58987: 35437,
		58988: 35436,
		58989: 35426,
		58990: 35461,
		58991: 35458,
		58992: 35460,
		58993: 35496,
		58994: 35489,
		58995: 35473,
		58996: 35493,
		58997: 35494,
		58998: 35482,
		58999: 35491,
		59000: 35524,
		59001: 35533,
		59002: 35522,
		59003: 35546,
		59004: 35563,
		59005: 35571,
		59006: 35559,
		59008: 35556,
		59009: 35569,
		59010: 35604,
		59011: 35552,
		59012: 35554,
		59013: 35575,
		59014: 35550,
		59015: 35547,
		59016: 35596,
		59017: 35591,
		59018: 35610,
		59019: 35553,
		59020: 35606,
		59021: 35600,
		59022: 35607,
		59023: 35616,
		59024: 35635,
		59025: 38827,
		59026: 35622,
		59027: 35627,
		59028: 35646,
		59029: 35624,
		59030: 35649,
		59031: 35660,
		59032: 35663,
		59033: 35662,
		59034: 35657,
		59035: 35670,
		59036: 35675,
		59037: 35674,
		59038: 35691,
		59039: 35679,
		59040: 35692,
		59041: 35695,
		59042: 35700,
		59043: 35709,
		59044: 35712,
		59045: 35724,
		59046: 35726,
		59047: 35730,
		59048: 35731,
		59049: 35734,
		59050: 35737,
		59051: 35738,
		59052: 35898,
		59053: 35905,
		59054: 35903,
		59055: 35912,
		59056: 35916,
		59057: 35918,
		59058: 35920,
		59059: 35925,
		59060: 35938,
		59061: 35948,
		59062: 35960,
		59063: 35962,
		59064: 35970,
		59065: 35977,
		59066: 35973,
		59067: 35978,
		59068: 35981,
		59069: 35982,
		59070: 35988,
		59071: 35964,
		59072: 35992,
		59073: 25117,
		59074: 36013,
		59075: 36010,
		59076: 36029,
		59077: 36018,
		59078: 36019,
		59079: 36014,
		59080: 36022,
		59081: 36040,
		59082: 36033,
		59083: 36068,
		59084: 36067,
		59085: 36058,
		59086: 36093,
		59087: 36090,
		59088: 36091,
		59089: 36100,
		59090: 36101,
		59091: 36106,
		59092: 36103,
		59093: 36111,
		59094: 36109,
		59095: 36112,
		59096: 40782,
		59097: 36115,
		59098: 36045,
		59099: 36116,
		59100: 36118,
		59101: 36199,
		59102: 36205,
		59103: 36209,
		59104: 36211,
		59105: 36225,
		59106: 36249,
		59107: 36290,
		59108: 36286,
		59109: 36282,
		59110: 36303,
		59111: 36314,
		59112: 36310,
		59113: 36300,
		59114: 36315,
		59115: 36299,
		59116: 36330,
		59117: 36331,
		59118: 36319,
		59119: 36323,
		59120: 36348,
		59121: 36360,
		59122: 36361,
		59123: 36351,
		59124: 36381,
		59125: 36382,
		59126: 36368,
		59127: 36383,
		59128: 36418,
		59129: 36405,
		59130: 36400,
		59131: 36404,
		59132: 36426,
		59200: 36423,
		59201: 36425,
		59202: 36428,
		59203: 36432,
		59204: 36424,
		59205: 36441,
		59206: 36452,
		59207: 36448,
		59208: 36394,
		59209: 36451,
		59210: 36437,
		59211: 36470,
		59212: 36466,
		59213: 36476,
		59214: 36481,
		59215: 36487,
		59216: 36485,
		59217: 36484,
		59218: 36491,
		59219: 36490,
		59220: 36499,
		59221: 36497,
		59222: 36500,
		59223: 36505,
		59224: 36522,
		59225: 36513,
		59226: 36524,
		59227: 36528,
		59228: 36550,
		59229: 36529,
		59230: 36542,
		59231: 36549,
		59232: 36552,
		59233: 36555,
		59234: 36571,
		59235: 36579,
		59236: 36604,
		59237: 36603,
		59238: 36587,
		59239: 36606,
		59240: 36618,
		59241: 36613,
		59242: 36629,
		59243: 36626,
		59244: 36633,
		59245: 36627,
		59246: 36636,
		59247: 36639,
		59248: 36635,
		59249: 36620,
		59250: 36646,
		59251: 36659,
		59252: 36667,
		59253: 36665,
		59254: 36677,
		59255: 36674,
		59256: 36670,
		59257: 36684,
		59258: 36681,
		59259: 36678,
		59260: 36686,
		59261: 36695,
		59262: 36700,
		59264: 36706,
		59265: 36707,
		59266: 36708,
		59267: 36764,
		59268: 36767,
		59269: 36771,
		59270: 36781,
		59271: 36783,
		59272: 36791,
		59273: 36826,
		59274: 36837,
		59275: 36834,
		59276: 36842,
		59277: 36847,
		59278: 36999,
		59279: 36852,
		59280: 36869,
		59281: 36857,
		59282: 36858,
		59283: 36881,
		59284: 36885,
		59285: 36897,
		59286: 36877,
		59287: 36894,
		59288: 36886,
		59289: 36875,
		59290: 36903,
		59291: 36918,
		59292: 36917,
		59293: 36921,
		59294: 36856,
		59295: 36943,
		59296: 36944,
		59297: 36945,
		59298: 36946,
		59299: 36878,
		59300: 36937,
		59301: 36926,
		59302: 36950,
		59303: 36952,
		59304: 36958,
		59305: 36968,
		59306: 36975,
		59307: 36982,
		59308: 38568,
		59309: 36978,
		59310: 36994,
		59311: 36989,
		59312: 36993,
		59313: 36992,
		59314: 37002,
		59315: 37001,
		59316: 37007,
		59317: 37032,
		59318: 37039,
		59319: 37041,
		59320: 37045,
		59321: 37090,
		59322: 37092,
		59323: 25160,
		59324: 37083,
		59325: 37122,
		59326: 37138,
		59327: 37145,
		59328: 37170,
		59329: 37168,
		59330: 37194,
		59331: 37206,
		59332: 37208,
		59333: 37219,
		59334: 37221,
		59335: 37225,
		59336: 37235,
		59337: 37234,
		59338: 37259,
		59339: 37257,
		59340: 37250,
		59341: 37282,
		59342: 37291,
		59343: 37295,
		59344: 37290,
		59345: 37301,
		59346: 37300,
		59347: 37306,
		59348: 37312,
		59349: 37313,
		59350: 37321,
		59351: 37323,
		59352: 37328,
		59353: 37334,
		59354: 37343,
		59355: 37345,
		59356: 37339,
		59357: 37372,
		59358: 37365,
		59359: 37366,
		59360: 37406,
		59361: 37375,
		59362: 37396,
		59363: 37420,
		59364: 37397,
		59365: 37393,
		59366: 37470,
		59367: 37463,
		59368: 37445,
		59369: 37449,
		59370: 37476,
		59371: 37448,
		59372: 37525,
		59373: 37439,
		59374: 37451,
		59375: 37456,
		59376: 37532,
		59377: 37526,
		59378: 37523,
		59379: 37531,
		59380: 37466,
		59381: 37583,
		59382: 37561,
		59383: 37559,
		59384: 37609,
		59385: 37647,
		59386: 37626,
		59387: 37700,
		59388: 37678,
		59456: 37657,
		59457: 37666,
		59458: 37658,
		59459: 37667,
		59460: 37690,
		59461: 37685,
		59462: 37691,
		59463: 37724,
		59464: 37728,
		59465: 37756,
		59466: 37742,
		59467: 37718,
		59468: 37808,
		59469: 37804,
		59470: 37805,
		59471: 37780,
		59472: 37817,
		59473: 37846,
		59474: 37847,
		59475: 37864,
		59476: 37861,
		59477: 37848,
		59478: 37827,
		59479: 37853,
		59480: 37840,
		59481: 37832,
		59482: 37860,
		59483: 37914,
		59484: 37908,
		59485: 37907,
		59486: 37891,
		59487: 37895,
		59488: 37904,
		59489: 37942,
		59490: 37931,
		59491: 37941,
		59492: 37921,
		59493: 37946,
		59494: 37953,
		59495: 37970,
		59496: 37956,
		59497: 37979,
		59498: 37984,
		59499: 37986,
		59500: 37982,
		59501: 37994,
		59502: 37417,
		59503: 38000,
		59504: 38005,
		59505: 38007,
		59506: 38013,
		59507: 37978,
		59508: 38012,
		59509: 38014,
		59510: 38017,
		59511: 38015,
		59512: 38274,
		59513: 38279,
		59514: 38282,
		59515: 38292,
		59516: 38294,
		59517: 38296,
		59518: 38297,
		59520: 38304,
		59521: 38312,
		59522: 38311,
		59523: 38317,
		59524: 38332,
		59525: 38331,
		59526: 38329,
		59527: 38334,
		59528: 38346,
		59529: 28662,
		59530: 38339,
		59531: 38349,
		59532: 38348,
		59533: 38357,
		59534: 38356,
		59535: 38358,
		59536: 38364,
		59537: 38369,
		59538: 38373,
		59539: 38370,
		59540: 38433,
		59541: 38440,
		59542: 38446,
		59543: 38447,
		59544: 38466,
		59545: 38476,
		59546: 38479,
		59547: 38475,
		59548: 38519,
		59549: 38492,
		59550: 38494,
		59551: 38493,
		59552: 38495,
		59553: 38502,
		59554: 38514,
		59555: 38508,
		59556: 38541,
		59557: 38552,
		59558: 38549,
		59559: 38551,
		59560: 38570,
		59561: 38567,
		59562: 38577,
		59563: 38578,
		59564: 38576,
		59565: 38580,
		59566: 38582,
		59567: 38584,
		59568: 38585,
		59569: 38606,
		59570: 38603,
		59571: 38601,
		59572: 38605,
		59573: 35149,
		59574: 38620,
		59575: 38669,
		59576: 38613,
		59577: 38649,
		59578: 38660,
		59579: 38662,
		59580: 38664,
		59581: 38675,
		59582: 38670,
		59583: 38673,
		59584: 38671,
		59585: 38678,
		59586: 38681,
		59587: 38692,
		59588: 38698,
		59589: 38704,
		59590: 38713,
		59591: 38717,
		59592: 38718,
		59593: 38724,
		59594: 38726,
		59595: 38728,
		59596: 38722,
		59597: 38729,
		59598: 38748,
		59599: 38752,
		59600: 38756,
		59601: 38758,
		59602: 38760,
		59603: 21202,
		59604: 38763,
		59605: 38769,
		59606: 38777,
		59607: 38789,
		59608: 38780,
		59609: 38785,
		59610: 38778,
		59611: 38790,
		59612: 38795,
		59613: 38799,
		59614: 38800,
		59615: 38812,
		59616: 38824,
		59617: 38822,
		59618: 38819,
		59619: 38835,
		59620: 38836,
		59621: 38851,
		59622: 38854,
		59623: 38856,
		59624: 38859,
		59625: 38876,
		59626: 38893,
		59627: 40783,
		59628: 38898,
		59629: 31455,
		59630: 38902,
		59631: 38901,
		59632: 38927,
		59633: 38924,
		59634: 38968,
		59635: 38948,
		59636: 38945,
		59637: 38967,
		59638: 38973,
		59639: 38982,
		59640: 38991,
		59641: 38987,
		59642: 39019,
		59643: 39023,
		59644: 39024,
		59712: 39025,
		59713: 39028,
		59714: 39027,
		59715: 39082,
		59716: 39087,
		59717: 39089,
		59718: 39094,
		59719: 39108,
		59720: 39107,
		59721: 39110,
		59722: 39145,
		59723: 39147,
		59724: 39171,
		59725: 39177,
		59726: 39186,
		59727: 39188,
		59728: 39192,
		59729: 39201,
		59730: 39197,
		59731: 39198,
		59732: 39204,
		59733: 39200,
		59734: 39212,
		59735: 39214,
		59736: 39229,
		59737: 39230,
		59738: 39234,
		59739: 39241,
		59740: 39237,
		59741: 39248,
		59742: 39243,
		59743: 39249,
		59744: 39250,
		59745: 39244,
		59746: 39253,
		59747: 39319,
		59748: 39320,
		59749: 39333,
		59750: 39341,
		59751: 39342,
		59752: 39356,
		59753: 39391,
		59754: 39387,
		59755: 39389,
		59756: 39384,
		59757: 39377,
		59758: 39405,
		59759: 39406,
		59760: 39409,
		59761: 39410,
		59762: 39419,
		59763: 39416,
		59764: 39425,
		59765: 39439,
		59766: 39429,
		59767: 39394,
		59768: 39449,
		59769: 39467,
		59770: 39479,
		59771: 39493,
		59772: 39490,
		59773: 39488,
		59774: 39491,
		59776: 39486,
		59777: 39509,
		59778: 39501,
		59779: 39515,
		59780: 39511,
		59781: 39519,
		59782: 39522,
		59783: 39525,
		59784: 39524,
		59785: 39529,
		59786: 39531,
		59787: 39530,
		59788: 39597,
		59789: 39600,
		59790: 39612,
		59791: 39616,
		59792: 39631,
		59793: 39633,
		59794: 39635,
		59795: 39636,
		59796: 39646,
		59797: 39647,
		59798: 39650,
		59799: 39651,
		59800: 39654,
		59801: 39663,
		59802: 39659,
		59803: 39662,
		59804: 39668,
		59805: 39665,
		59806: 39671,
		59807: 39675,
		59808: 39686,
		59809: 39704,
		59810: 39706,
		59811: 39711,
		59812: 39714,
		59813: 39715,
		59814: 39717,
		59815: 39719,
		59816: 39720,
		59817: 39721,
		59818: 39722,
		59819: 39726,
		59820: 39727,
		59821: 39730,
		59822: 39748,
		59823: 39747,
		59824: 39759,
		59825: 39757,
		59826: 39758,
		59827: 39761,
		59828: 39768,
		59829: 39796,
		59830: 39827,
		59831: 39811,
		59832: 39825,
		59833: 39830,
		59834: 39831,
		59835: 39839,
		59836: 39840,
		59837: 39848,
		59838: 39860,
		59839: 39872,
		59840: 39882,
		59841: 39865,
		59842: 39878,
		59843: 39887,
		59844: 39889,
		59845: 39890,
		59846: 39907,
		59847: 39906,
		59848: 39908,
		59849: 39892,
		59850: 39905,
		59851: 39994,
		59852: 39922,
		59853: 39921,
		59854: 39920,
		59855: 39957,
		59856: 39956,
		59857: 39945,
		59858: 39955,
		59859: 39948,
		59860: 39942,
		59861: 39944,
		59862: 39954,
		59863: 39946,
		59864: 39940,
		59865: 39982,
		59866: 39963,
		59867: 39973,
		59868: 39972,
		59869: 39969,
		59870: 39984,
		59871: 40007,
		59872: 39986,
		59873: 40006,
		59874: 39998,
		59875: 40026,
		59876: 40032,
		59877: 40039,
		59878: 40054,
		59879: 40056,
		59880: 40167,
		59881: 40172,
		59882: 40176,
		59883: 40201,
		59884: 40200,
		59885: 40171,
		59886: 40195,
		59887: 40198,
		59888: 40234,
		59889: 40230,
		59890: 40367,
		59891: 40227,
		59892: 40223,
		59893: 40260,
		59894: 40213,
		59895: 40210,
		59896: 40257,
		59897: 40255,
		59898: 40254,
		59899: 40262,
		59900: 40264,
		59968: 40285,
		59969: 40286,
		59970: 40292,
		59971: 40273,
		59972: 40272,
		59973: 40281,
		59974: 40306,
		59975: 40329,
		59976: 40327,
		59977: 40363,
		59978: 40303,
		59979: 40314,
		59980: 40346,
		59981: 40356,
		59982: 40361,
		59983: 40370,
		59984: 40388,
		59985: 40385,
		59986: 40379,
		59987: 40376,
		59988: 40378,
		59989: 40390,
		59990: 40399,
		59991: 40386,
		59992: 40409,
		59993: 40403,
		59994: 40440,
		59995: 40422,
		59996: 40429,
		59997: 40431,
		59998: 40445,
		59999: 40474,
		60000: 40475,
		60001: 40478,
		60002: 40565,
		60003: 40569,
		60004: 40573,
		60005: 40577,
		60006: 40584,
		60007: 40587,
		60008: 40588,
		60009: 40594,
		60010: 40597,
		60011: 40593,
		60012: 40605,
		60013: 40613,
		60014: 40617,
		60015: 40632,
		60016: 40618,
		60017: 40621,
		60018: 38753,
		60019: 40652,
		60020: 40654,
		60021: 40655,
		60022: 40656,
		60023: 40660,
		60024: 40668,
		60025: 40670,
		60026: 40669,
		60027: 40672,
		60028: 40677,
		60029: 40680,
		60030: 40687,
		60032: 40692,
		60033: 40694,
		60034: 40695,
		60035: 40697,
		60036: 40699,
		60037: 40700,
		60038: 40701,
		60039: 40711,
		60040: 40712,
		60041: 30391,
		60042: 40725,
		60043: 40737,
		60044: 40748,
		60045: 40766,
		60046: 40778,
		60047: 40786,
		60048: 40788,
		60049: 40803,
		60050: 40799,
		60051: 40800,
		60052: 40801,
		60053: 40806,
		60054: 40807,
		60055: 40812,
		60056: 40810,
		60057: 40823,
		60058: 40818,
		60059: 40822,
		60060: 40853,
		60061: 40860,
		60062: 40864,
		60063: 22575,
		60064: 27079,
		60065: 36953,
		60066: 29796,
		60067: 20956,
		60068: 29081,
		60736: 32394,
		60737: 35100,
		60738: 37704,
		60739: 37512,
		60740: 34012,
		60741: 20425,
		60742: 28859,
		60743: 26161,
		60744: 26824,
		60745: 37625,
		60746: 26363,
		60747: 24389,
		60748: 20008,
		60749: 20193,
		60750: 20220,
		60751: 20224,
		60752: 20227,
		60753: 20281,
		60754: 20310,
		60755: 20370,
		60756: 20362,
		60757: 20378,
		60758: 20372,
		60759: 20429,
		60760: 20544,
		60761: 20514,
		60762: 20479,
		60763: 20510,
		60764: 20550,
		60765: 20592,
		60766: 20546,
		60767: 20628,
		60768: 20724,
		60769: 20696,
		60770: 20810,
		60771: 20836,
		60772: 20893,
		60773: 20926,
		60774: 20972,
		60775: 21013,
		60776: 21148,
		60777: 21158,
		60778: 21184,
		60779: 21211,
		60780: 21248,
		60781: 21255,
		60782: 21284,
		60783: 21362,
		60784: 21395,
		60785: 21426,
		60786: 21469,
		60787: 64014,
		60788: 21660,
		60789: 21642,
		60790: 21673,
		60791: 21759,
		60792: 21894,
		60793: 22361,
		60794: 22373,
		60795: 22444,
		60796: 22472,
		60797: 22471,
		60798: 64015,
		60800: 64016,
		60801: 22686,
		60802: 22706,
		60803: 22795,
		60804: 22867,
		60805: 22875,
		60806: 22877,
		60807: 22883,
		60808: 22948,
		60809: 22970,
		60810: 23382,
		60811: 23488,
		60812: 29999,
		60813: 23512,
		60814: 23532,
		60815: 23582,
		60816: 23718,
		60817: 23738,
		60818: 23797,
		60819: 23847,
		60820: 23891,
		60821: 64017,
		60822: 23874,
		60823: 23917,
		60824: 23992,
		60825: 23993,
		60826: 24016,
		60827: 24353,
		60828: 24372,
		60829: 24423,
		60830: 24503,
		60831: 24542,
		60832: 24669,
		60833: 24709,
		60834: 24714,
		60835: 24798,
		60836: 24789,
		60837: 24864,
		60838: 24818,
		60839: 24849,
		60840: 24887,
		60841: 24880,
		60842: 24984,
		60843: 25107,
		60844: 25254,
		60845: 25589,
		60846: 25696,
		60847: 25757,
		60848: 25806,
		60849: 25934,
		60850: 26112,
		60851: 26133,
		60852: 26171,
		60853: 26121,
		60854: 26158,
		60855: 26142,
		60856: 26148,
		60857: 26213,
		60858: 26199,
		60859: 26201,
		60860: 64018,
		60861: 26227,
		60862: 26265,
		60863: 26272,
		60864: 26290,
		60865: 26303,
		60866: 26362,
		60867: 26382,
		60868: 63785,
		60869: 26470,
		60870: 26555,
		60871: 26706,
		60872: 26560,
		60873: 26625,
		60874: 26692,
		60875: 26831,
		60876: 64019,
		60877: 26984,
		60878: 64020,
		60879: 27032,
		60880: 27106,
		60881: 27184,
		60882: 27243,
		60883: 27206,
		60884: 27251,
		60885: 27262,
		60886: 27362,
		60887: 27364,
		60888: 27606,
		60889: 27711,
		60890: 27740,
		60891: 27782,
		60892: 27759,
		60893: 27866,
		60894: 27908,
		60895: 28039,
		60896: 28015,
		60897: 28054,
		60898: 28076,
		60899: 28111,
		60900: 28152,
		60901: 28146,
		60902: 28156,
		60903: 28217,
		60904: 28252,
		60905: 28199,
		60906: 28220,
		60907: 28351,
		60908: 28552,
		60909: 28597,
		60910: 28661,
		60911: 28677,
		60912: 28679,
		60913: 28712,
		60914: 28805,
		60915: 28843,
		60916: 28943,
		60917: 28932,
		60918: 29020,
		60919: 28998,
		60920: 28999,
		60921: 64021,
		60922: 29121,
		60923: 29182,
		60924: 29361,
		60992: 29374,
		60993: 29476,
		60994: 64022,
		60995: 29559,
		60996: 29629,
		60997: 29641,
		60998: 29654,
		60999: 29667,
		61000: 29650,
		61001: 29703,
		61002: 29685,
		61003: 29734,
		61004: 29738,
		61005: 29737,
		61006: 29742,
		61007: 29794,
		61008: 29833,
		61009: 29855,
		61010: 29953,
		61011: 30063,
		61012: 30338,
		61013: 30364,
		61014: 30366,
		61015: 30363,
		61016: 30374,
		61017: 64023,
		61018: 30534,
		61019: 21167,
		61020: 30753,
		61021: 30798,
		61022: 30820,
		61023: 30842,
		61024: 31024,
		61025: 64024,
		61026: 64025,
		61027: 64026,
		61028: 31124,
		61029: 64027,
		61030: 31131,
		61031: 31441,
		61032: 31463,
		61033: 64028,
		61034: 31467,
		61035: 31646,
		61036: 64029,
		61037: 32072,
		61038: 32092,
		61039: 32183,
		61040: 32160,
		61041: 32214,
		61042: 32338,
		61043: 32583,
		61044: 32673,
		61045: 64030,
		61046: 33537,
		61047: 33634,
		61048: 33663,
		61049: 33735,
		61050: 33782,
		61051: 33864,
		61052: 33972,
		61053: 34131,
		61054: 34137,
		61056: 34155,
		61057: 64031,
		61058: 34224,
		61059: 64032,
		61060: 64033,
		61061: 34823,
		61062: 35061,
		61063: 35346,
		61064: 35383,
		61065: 35449,
		61066: 35495,
		61067: 35518,
		61068: 35551,
		61069: 64034,
		61070: 35574,
		61071: 35667,
		61072: 35711,
		61073: 36080,
		61074: 36084,
		61075: 36114,
		61076: 36214,
		61077: 64035,
		61078: 36559,
		61079: 64036,
		61080: 64037,
		61081: 36967,
		61082: 37086,
		61083: 64038,
		61084: 37141,
		61085: 37159,
		61086: 37338,
		61087: 37335,
		61088: 37342,
		61089: 37357,
		61090: 37358,
		61091: 37348,
		61092: 37349,
		61093: 37382,
		61094: 37392,
		61095: 37386,
		61096: 37434,
		61097: 37440,
		61098: 37436,
		61099: 37454,
		61100: 37465,
		61101: 37457,
		61102: 37433,
		61103: 37479,
		61104: 37543,
		61105: 37495,
		61106: 37496,
		61107: 37607,
		61108: 37591,
		61109: 37593,
		61110: 37584,
		61111: 64039,
		61112: 37589,
		61113: 37600,
		61114: 37587,
		61115: 37669,
		61116: 37665,
		61117: 37627,
		61118: 64040,
		61119: 37662,
		61120: 37631,
		61121: 37661,
		61122: 37634,
		61123: 37744,
		61124: 37719,
		61125: 37796,
		61126: 37830,
		61127: 37854,
		61128: 37880,
		61129: 37937,
		61130: 37957,
		61131: 37960,
		61132: 38290,
		61133: 63964,
		61134: 64041,
		61135: 38557,
		61136: 38575,
		61137: 38707,
		61138: 38715,
		61139: 38723,
		61140: 38733,
		61141: 38735,
		61142: 38737,
		61143: 38741,
		61144: 38999,
		61145: 39013,
		61146: 64042,
		61147: 64043,
		61148: 39207,
		61149: 64044,
		61150: 39326,
		61151: 39502,
		61152: 39641,
		61153: 39644,
		61154: 39797,
		61155: 39794,
		61156: 39823,
		61157: 39857,
		61158: 39867,
		61159: 39936,
		61160: 40304,
		61161: 40299,
		61162: 64045,
		61163: 40473,
		61164: 40657,
		61167: 8560,
		61168: 8561,
		61169: 8562,
		61170: 8563,
		61171: 8564,
		61172: 8565,
		61173: 8566,
		61174: 8567,
		61175: 8568,
		61176: 8569,
		61177: 65506,
		61178: 65508,
		61179: 65287,
		61180: 65282,
		61504: 57344,
		61505: 57345,
		61506: 57346,
		61507: 57347,
		61508: 57348,
		61509: 57349,
		61510: 57350,
		61511: 57351,
		61512: 57352,
		61513: 57353,
		61514: 57354,
		61515: 57355,
		61516: 57356,
		61517: 57357,
		61518: 57358,
		61519: 57359,
		61520: 57360,
		61521: 57361,
		61522: 57362,
		61523: 57363,
		61524: 57364,
		61525: 57365,
		61526: 57366,
		61527: 57367,
		61528: 57368,
		61529: 57369,
		61530: 57370,
		61531: 57371,
		61532: 57372,
		61533: 57373,
		61534: 57374,
		61535: 57375,
		61536: 57376,
		61537: 57377,
		61538: 57378,
		61539: 57379,
		61540: 57380,
		61541: 57381,
		61542: 57382,
		61543: 57383,
		61544: 57384,
		61545: 57385,
		61546: 57386,
		61547: 57387,
		61548: 57388,
		61549: 57389,
		61550: 57390,
		61551: 57391,
		61552: 57392,
		61553: 57393,
		61554: 57394,
		61555: 57395,
		61556: 57396,
		61557: 57397,
		61558: 57398,
		61559: 57399,
		61560: 57400,
		61561: 57401,
		61562: 57402,
		61563: 57403,
		61564: 57404,
		61565: 57405,
		61566: 57406,
		61568: 57407,
		61569: 57408,
		61570: 57409,
		61571: 57410,
		61572: 57411,
		61573: 57412,
		61574: 57413,
		61575: 57414,
		61576: 57415,
		61577: 57416,
		61578: 57417,
		61579: 57418,
		61580: 57419,
		61581: 57420,
		61582: 57421,
		61583: 57422,
		61584: 57423,
		61585: 57424,
		61586: 57425,
		61587: 57426,
		61588: 57427,
		61589: 57428,
		61590: 57429,
		61591: 57430,
		61592: 57431,
		61593: 57432,
		61594: 57433,
		61595: 57434,
		61596: 57435,
		61597: 57436,
		61598: 57437,
		61599: 57438,
		61600: 57439,
		61601: 57440,
		61602: 57441,
		61603: 57442,
		61604: 57443,
		61605: 57444,
		61606: 57445,
		61607: 57446,
		61608: 57447,
		61609: 57448,
		61610: 57449,
		61611: 57450,
		61612: 57451,
		61613: 57452,
		61614: 57453,
		61615: 57454,
		61616: 57455,
		61617: 57456,
		61618: 57457,
		61619: 57458,
		61620: 57459,
		61621: 57460,
		61622: 57461,
		61623: 57462,
		61624: 57463,
		61625: 57464,
		61626: 57465,
		61627: 57466,
		61628: 57467,
		61629: 57468,
		61630: 57469,
		61631: 57470,
		61632: 57471,
		61633: 57472,
		61634: 57473,
		61635: 57474,
		61636: 57475,
		61637: 57476,
		61638: 57477,
		61639: 57478,
		61640: 57479,
		61641: 57480,
		61642: 57481,
		61643: 57482,
		61644: 57483,
		61645: 57484,
		61646: 57485,
		61647: 57486,
		61648: 57487,
		61649: 57488,
		61650: 57489,
		61651: 57490,
		61652: 57491,
		61653: 57492,
		61654: 57493,
		61655: 57494,
		61656: 57495,
		61657: 57496,
		61658: 57497,
		61659: 57498,
		61660: 57499,
		61661: 57500,
		61662: 57501,
		61663: 57502,
		61664: 57503,
		61665: 57504,
		61666: 57505,
		61667: 57506,
		61668: 57507,
		61669: 57508,
		61670: 57509,
		61671: 57510,
		61672: 57511,
		61673: 57512,
		61674: 57513,
		61675: 57514,
		61676: 57515,
		61677: 57516,
		61678: 57517,
		61679: 57518,
		61680: 57519,
		61681: 57520,
		61682: 57521,
		61683: 57522,
		61684: 57523,
		61685: 57524,
		61686: 57525,
		61687: 57526,
		61688: 57527,
		61689: 57528,
		61690: 57529,
		61691: 57530,
		61692: 57531,
		61760: 57532,
		61761: 57533,
		61762: 57534,
		61763: 57535,
		61764: 57536,
		61765: 57537,
		61766: 57538,
		61767: 57539,
		61768: 57540,
		61769: 57541,
		61770: 57542,
		61771: 57543,
		61772: 57544,
		61773: 57545,
		61774: 57546,
		61775: 57547,
		61776: 57548,
		61777: 57549,
		61778: 57550,
		61779: 57551,
		61780: 57552,
		61781: 57553,
		61782: 57554,
		61783: 57555,
		61784: 57556,
		61785: 57557,
		61786: 57558,
		61787: 57559,
		61788: 57560,
		61789: 57561,
		61790: 57562,
		61791: 57563,
		61792: 57564,
		61793: 57565,
		61794: 57566,
		61795: 57567,
		61796: 57568,
		61797: 57569,
		61798: 57570,
		61799: 57571,
		61800: 57572,
		61801: 57573,
		61802: 57574,
		61803: 57575,
		61804: 57576,
		61805: 57577,
		61806: 57578,
		61807: 57579,
		61808: 57580,
		61809: 57581,
		61810: 57582,
		61811: 57583,
		61812: 57584,
		61813: 57585,
		61814: 57586,
		61815: 57587,
		61816: 57588,
		61817: 57589,
		61818: 57590,
		61819: 57591,
		61820: 57592,
		61821: 57593,
		61822: 57594,
		61824: 57595,
		61825: 57596,
		61826: 57597,
		61827: 57598,
		61828: 57599,
		61829: 57600,
		61830: 57601,
		61831: 57602,
		61832: 57603,
		61833: 57604,
		61834: 57605,
		61835: 57606,
		61836: 57607,
		61837: 57608,
		61838: 57609,
		61839: 57610,
		61840: 57611,
		61841: 57612,
		61842: 57613,
		61843: 57614,
		61844: 57615,
		61845: 57616,
		61846: 57617,
		61847: 57618,
		61848: 57619,
		61849: 57620,
		61850: 57621,
		61851: 57622,
		61852: 57623,
		61853: 57624,
		61854: 57625,
		61855: 57626,
		61856: 57627,
		61857: 57628,
		61858: 57629,
		61859: 57630,
		61860: 57631,
		61861: 57632,
		61862: 57633,
		61863: 57634,
		61864: 57635,
		61865: 57636,
		61866: 57637,
		61867: 57638,
		61868: 57639,
		61869: 57640,
		61870: 57641,
		61871: 57642,
		61872: 57643,
		61873: 57644,
		61874: 57645,
		61875: 57646,
		61876: 57647,
		61877: 57648,
		61878: 57649,
		61879: 57650,
		61880: 57651,
		61881: 57652,
		61882: 57653,
		61883: 57654,
		61884: 57655,
		61885: 57656,
		61886: 57657,
		61887: 57658,
		61888: 57659,
		61889: 57660,
		61890: 57661,
		61891: 57662,
		61892: 57663,
		61893: 57664,
		61894: 57665,
		61895: 57666,
		61896: 57667,
		61897: 57668,
		61898: 57669,
		61899: 57670,
		61900: 57671,
		61901: 57672,
		61902: 57673,
		61903: 57674,
		61904: 57675,
		61905: 57676,
		61906: 57677,
		61907: 57678,
		61908: 57679,
		61909: 57680,
		61910: 57681,
		61911: 57682,
		61912: 57683,
		61913: 57684,
		61914: 57685,
		61915: 57686,
		61916: 57687,
		61917: 57688,
		61918: 57689,
		61919: 57690,
		61920: 57691,
		61921: 57692,
		61922: 57693,
		61923: 57694,
		61924: 57695,
		61925: 57696,
		61926: 57697,
		61927: 57698,
		61928: 57699,
		61929: 57700,
		61930: 57701,
		61931: 57702,
		61932: 57703,
		61933: 57704,
		61934: 57705,
		61935: 57706,
		61936: 57707,
		61937: 57708,
		61938: 57709,
		61939: 57710,
		61940: 57711,
		61941: 57712,
		61942: 57713,
		61943: 57714,
		61944: 57715,
		61945: 57716,
		61946: 57717,
		61947: 57718,
		61948: 57719,
		62016: 57720,
		62017: 57721,
		62018: 57722,
		62019: 57723,
		62020: 57724,
		62021: 57725,
		62022: 57726,
		62023: 57727,
		62024: 57728,
		62025: 57729,
		62026: 57730,
		62027: 57731,
		62028: 57732,
		62029: 57733,
		62030: 57734,
		62031: 57735,
		62032: 57736,
		62033: 57737,
		62034: 57738,
		62035: 57739,
		62036: 57740,
		62037: 57741,
		62038: 57742,
		62039: 57743,
		62040: 57744,
		62041: 57745,
		62042: 57746,
		62043: 57747,
		62044: 57748,
		62045: 57749,
		62046: 57750,
		62047: 57751,
		62048: 57752,
		62049: 57753,
		62050: 57754,
		62051: 57755,
		62052: 57756,
		62053: 57757,
		62054: 57758,
		62055: 57759,
		62056: 57760,
		62057: 57761,
		62058: 57762,
		62059: 57763,
		62060: 57764,
		62061: 57765,
		62062: 57766,
		62063: 57767,
		62064: 57768,
		62065: 57769,
		62066: 57770,
		62067: 57771,
		62068: 57772,
		62069: 57773,
		62070: 57774,
		62071: 57775,
		62072: 57776,
		62073: 57777,
		62074: 57778,
		62075: 57779,
		62076: 57780,
		62077: 57781,
		62078: 57782,
		62080: 57783,
		62081: 57784,
		62082: 57785,
		62083: 57786,
		62084: 57787,
		62085: 57788,
		62086: 57789,
		62087: 57790,
		62088: 57791,
		62089: 57792,
		62090: 57793,
		62091: 57794,
		62092: 57795,
		62093: 57796,
		62094: 57797,
		62095: 57798,
		62096: 57799,
		62097: 57800,
		62098: 57801,
		62099: 57802,
		62100: 57803,
		62101: 57804,
		62102: 57805,
		62103: 57806,
		62104: 57807,
		62105: 57808,
		62106: 57809,
		62107: 57810,
		62108: 57811,
		62109: 57812,
		62110: 57813,
		62111: 57814,
		62112: 57815,
		62113: 57816,
		62114: 57817,
		62115: 57818,
		62116: 57819,
		62117: 57820,
		62118: 57821,
		62119: 57822,
		62120: 57823,
		62121: 57824,
		62122: 57825,
		62123: 57826,
		62124: 57827,
		62125: 57828,
		62126: 57829,
		62127: 57830,
		62128: 57831,
		62129: 57832,
		62130: 57833,
		62131: 57834,
		62132: 57835,
		62133: 57836,
		62134: 57837,
		62135: 57838,
		62136: 57839,
		62137: 57840,
		62138: 57841,
		62139: 57842,
		62140: 57843,
		62141: 57844,
		62142: 57845,
		62143: 57846,
		62144: 57847,
		62145: 57848,
		62146: 57849,
		62147: 57850,
		62148: 57851,
		62149: 57852,
		62150: 57853,
		62151: 57854,
		62152: 57855,
		62153: 57856,
		62154: 57857,
		62155: 57858,
		62156: 57859,
		62157: 57860,
		62158: 57861,
		62159: 57862,
		62160: 57863,
		62161: 57864,
		62162: 57865,
		62163: 57866,
		62164: 57867,
		62165: 57868,
		62166: 57869,
		62167: 57870,
		62168: 57871,
		62169: 57872,
		62170: 57873,
		62171: 57874,
		62172: 57875,
		62173: 57876,
		62174: 57877,
		62175: 57878,
		62176: 57879,
		62177: 57880,
		62178: 57881,
		62179: 57882,
		62180: 57883,
		62181: 57884,
		62182: 57885,
		62183: 57886,
		62184: 57887,
		62185: 57888,
		62186: 57889,
		62187: 57890,
		62188: 57891,
		62189: 57892,
		62190: 57893,
		62191: 57894,
		62192: 57895,
		62193: 57896,
		62194: 57897,
		62195: 57898,
		62196: 57899,
		62197: 57900,
		62198: 57901,
		62199: 57902,
		62200: 57903,
		62201: 57904,
		62202: 57905,
		62203: 57906,
		62204: 57907,
		62272: 57908,
		62273: 57909,
		62274: 57910,
		62275: 57911,
		62276: 57912,
		62277: 57913,
		62278: 57914,
		62279: 57915,
		62280: 57916,
		62281: 57917,
		62282: 57918,
		62283: 57919,
		62284: 57920,
		62285: 57921,
		62286: 57922,
		62287: 57923,
		62288: 57924,
		62289: 57925,
		62290: 57926,
		62291: 57927,
		62292: 57928,
		62293: 57929,
		62294: 57930,
		62295: 57931,
		62296: 57932,
		62297: 57933,
		62298: 57934,
		62299: 57935,
		62300: 57936,
		62301: 57937,
		62302: 57938,
		62303: 57939,
		62304: 57940,
		62305: 57941,
		62306: 57942,
		62307: 57943,
		62308: 57944,
		62309: 57945,
		62310: 57946,
		62311: 57947,
		62312: 57948,
		62313: 57949,
		62314: 57950,
		62315: 57951,
		62316: 57952,
		62317: 57953,
		62318: 57954,
		62319: 57955,
		62320: 57956,
		62321: 57957,
		62322: 57958,
		62323: 57959,
		62324: 57960,
		62325: 57961,
		62326: 57962,
		62327: 57963,
		62328: 57964,
		62329: 57965,
		62330: 57966,
		62331: 57967,
		62332: 57968,
		62333: 57969,
		62334: 57970,
		62336: 57971,
		62337: 57972,
		62338: 57973,
		62339: 57974,
		62340: 57975,
		62341: 57976,
		62342: 57977,
		62343: 57978,
		62344: 57979,
		62345: 57980,
		62346: 57981,
		62347: 57982,
		62348: 57983,
		62349: 57984,
		62350: 57985,
		62351: 57986,
		62352: 57987,
		62353: 57988,
		62354: 57989,
		62355: 57990,
		62356: 57991,
		62357: 57992,
		62358: 57993,
		62359: 57994,
		62360: 57995,
		62361: 57996,
		62362: 57997,
		62363: 57998,
		62364: 57999,
		62365: 58000,
		62366: 58001,
		62367: 58002,
		62368: 58003,
		62369: 58004,
		62370: 58005,
		62371: 58006,
		62372: 58007,
		62373: 58008,
		62374: 58009,
		62375: 58010,
		62376: 58011,
		62377: 58012,
		62378: 58013,
		62379: 58014,
		62380: 58015,
		62381: 58016,
		62382: 58017,
		62383: 58018,
		62384: 58019,
		62385: 58020,
		62386: 58021,
		62387: 58022,
		62388: 58023,
		62389: 58024,
		62390: 58025,
		62391: 58026,
		62392: 58027,
		62393: 58028,
		62394: 58029,
		62395: 58030,
		62396: 58031,
		62397: 58032,
		62398: 58033,
		62399: 58034,
		62400: 58035,
		62401: 58036,
		62402: 58037,
		62403: 58038,
		62404: 58039,
		62405: 58040,
		62406: 58041,
		62407: 58042,
		62408: 58043,
		62409: 58044,
		62410: 58045,
		62411: 58046,
		62412: 58047,
		62413: 58048,
		62414: 58049,
		62415: 58050,
		62416: 58051,
		62417: 58052,
		62418: 58053,
		62419: 58054,
		62420: 58055,
		62421: 58056,
		62422: 58057,
		62423: 58058,
		62424: 58059,
		62425: 58060,
		62426: 58061,
		62427: 58062,
		62428: 58063,
		62429: 58064,
		62430: 58065,
		62431: 58066,
		62432: 58067,
		62433: 58068,
		62434: 58069,
		62435: 58070,
		62436: 58071,
		62437: 58072,
		62438: 58073,
		62439: 58074,
		62440: 58075,
		62441: 58076,
		62442: 58077,
		62443: 58078,
		62444: 58079,
		62445: 58080,
		62446: 58081,
		62447: 58082,
		62448: 58083,
		62449: 58084,
		62450: 58085,
		62451: 58086,
		62452: 58087,
		62453: 58088,
		62454: 58089,
		62455: 58090,
		62456: 58091,
		62457: 58092,
		62458: 58093,
		62459: 58094,
		62460: 58095,
		62528: 58096,
		62529: 58097,
		62530: 58098,
		62531: 58099,
		62532: 58100,
		62533: 58101,
		62534: 58102,
		62535: 58103,
		62536: 58104,
		62537: 58105,
		62538: 58106,
		62539: 58107,
		62540: 58108,
		62541: 58109,
		62542: 58110,
		62543: 58111,
		62544: 58112,
		62545: 58113,
		62546: 58114,
		62547: 58115,
		62548: 58116,
		62549: 58117,
		62550: 58118,
		62551: 58119,
		62552: 58120,
		62553: 58121,
		62554: 58122,
		62555: 58123,
		62556: 58124,
		62557: 58125,
		62558: 58126,
		62559: 58127,
		62560: 58128,
		62561: 58129,
		62562: 58130,
		62563: 58131,
		62564: 58132,
		62565: 58133,
		62566: 58134,
		62567: 58135,
		62568: 58136,
		62569: 58137,
		62570: 58138,
		62571: 58139,
		62572: 58140,
		62573: 58141,
		62574: 58142,
		62575: 58143,
		62576: 58144,
		62577: 58145,
		62578: 58146,
		62579: 58147,
		62580: 58148,
		62581: 58149,
		62582: 58150,
		62583: 58151,
		62584: 58152,
		62585: 58153,
		62586: 58154,
		62587: 58155,
		62588: 58156,
		62589: 58157,
		62590: 58158,
		62592: 58159,
		62593: 58160,
		62594: 58161,
		62595: 58162,
		62596: 58163,
		62597: 58164,
		62598: 58165,
		62599: 58166,
		62600: 58167,
		62601: 58168,
		62602: 58169,
		62603: 58170,
		62604: 58171,
		62605: 58172,
		62606: 58173,
		62607: 58174,
		62608: 58175,
		62609: 58176,
		62610: 58177,
		62611: 58178,
		62612: 58179,
		62613: 58180,
		62614: 58181,
		62615: 58182,
		62616: 58183,
		62617: 58184,
		62618: 58185,
		62619: 58186,
		62620: 58187,
		62621: 58188,
		62622: 58189,
		62623: 58190,
		62624: 58191,
		62625: 58192,
		62626: 58193,
		62627: 58194,
		62628: 58195,
		62629: 58196,
		62630: 58197,
		62631: 58198,
		62632: 58199,
		62633: 58200,
		62634: 58201,
		62635: 58202,
		62636: 58203,
		62637: 58204,
		62638: 58205,
		62639: 58206,
		62640: 58207,
		62641: 58208,
		62642: 58209,
		62643: 58210,
		62644: 58211,
		62645: 58212,
		62646: 58213,
		62647: 58214,
		62648: 58215,
		62649: 58216,
		62650: 58217,
		62651: 58218,
		62652: 58219,
		62653: 58220,
		62654: 58221,
		62655: 58222,
		62656: 58223,
		62657: 58224,
		62658: 58225,
		62659: 58226,
		62660: 58227,
		62661: 58228,
		62662: 58229,
		62663: 58230,
		62664: 58231,
		62665: 58232,
		62666: 58233,
		62667: 58234,
		62668: 58235,
		62669: 58236,
		62670: 58237,
		62671: 58238,
		62672: 58239,
		62673: 58240,
		62674: 58241,
		62675: 58242,
		62676: 58243,
		62677: 58244,
		62678: 58245,
		62679: 58246,
		62680: 58247,
		62681: 58248,
		62682: 58249,
		62683: 58250,
		62684: 58251,
		62685: 58252,
		62686: 58253,
		62687: 58254,
		62688: 58255,
		62689: 58256,
		62690: 58257,
		62691: 58258,
		62692: 58259,
		62693: 58260,
		62694: 58261,
		62695: 58262,
		62696: 58263,
		62697: 58264,
		62698: 58265,
		62699: 58266,
		62700: 58267,
		62701: 58268,
		62702: 58269,
		62703: 58270,
		62704: 58271,
		62705: 58272,
		62706: 58273,
		62707: 58274,
		62708: 58275,
		62709: 58276,
		62710: 58277,
		62711: 58278,
		62712: 58279,
		62713: 58280,
		62714: 58281,
		62715: 58282,
		62716: 58283,
		62784: 58284,
		62785: 58285,
		62786: 58286,
		62787: 58287,
		62788: 58288,
		62789: 58289,
		62790: 58290,
		62791: 58291,
		62792: 58292,
		62793: 58293,
		62794: 58294,
		62795: 58295,
		62796: 58296,
		62797: 58297,
		62798: 58298,
		62799: 58299,
		62800: 58300,
		62801: 58301,
		62802: 58302,
		62803: 58303,
		62804: 58304,
		62805: 58305,
		62806: 58306,
		62807: 58307,
		62808: 58308,
		62809: 58309,
		62810: 58310,
		62811: 58311,
		62812: 58312,
		62813: 58313,
		62814: 58314,
		62815: 58315,
		62816: 58316,
		62817: 58317,
		62818: 58318,
		62819: 58319,
		62820: 58320,
		62821: 58321,
		62822: 58322,
		62823: 58323,
		62824: 58324,
		62825: 58325,
		62826: 58326,
		62827: 58327,
		62828: 58328,
		62829: 58329,
		62830: 58330,
		62831: 58331,
		62832: 58332,
		62833: 58333,
		62834: 58334,
		62835: 58335,
		62836: 58336,
		62837: 58337,
		62838: 58338,
		62839: 58339,
		62840: 58340,
		62841: 58341,
		62842: 58342,
		62843: 58343,
		62844: 58344,
		62845: 58345,
		62846: 58346,
		62848: 58347,
		62849: 58348,
		62850: 58349,
		62851: 58350,
		62852: 58351,
		62853: 58352,
		62854: 58353,
		62855: 58354,
		62856: 58355,
		62857: 58356,
		62858: 58357,
		62859: 58358,
		62860: 58359,
		62861: 58360,
		62862: 58361,
		62863: 58362,
		62864: 58363,
		62865: 58364,
		62866: 58365,
		62867: 58366,
		62868: 58367,
		62869: 58368,
		62870: 58369,
		62871: 58370,
		62872: 58371,
		62873: 58372,
		62874: 58373,
		62875: 58374,
		62876: 58375,
		62877: 58376,
		62878: 58377,
		62879: 58378,
		62880: 58379,
		62881: 58380,
		62882: 58381,
		62883: 58382,
		62884: 58383,
		62885: 58384,
		62886: 58385,
		62887: 58386,
		62888: 58387,
		62889: 58388,
		62890: 58389,
		62891: 58390,
		62892: 58391,
		62893: 58392,
		62894: 58393,
		62895: 58394,
		62896: 58395,
		62897: 58396,
		62898: 58397,
		62899: 58398,
		62900: 58399,
		62901: 58400,
		62902: 58401,
		62903: 58402,
		62904: 58403,
		62905: 58404,
		62906: 58405,
		62907: 58406,
		62908: 58407,
		62909: 58408,
		62910: 58409,
		62911: 58410,
		62912: 58411,
		62913: 58412,
		62914: 58413,
		62915: 58414,
		62916: 58415,
		62917: 58416,
		62918: 58417,
		62919: 58418,
		62920: 58419,
		62921: 58420,
		62922: 58421,
		62923: 58422,
		62924: 58423,
		62925: 58424,
		62926: 58425,
		62927: 58426,
		62928: 58427,
		62929: 58428,
		62930: 58429,
		62931: 58430,
		62932: 58431,
		62933: 58432,
		62934: 58433,
		62935: 58434,
		62936: 58435,
		62937: 58436,
		62938: 58437,
		62939: 58438,
		62940: 58439,
		62941: 58440,
		62942: 58441,
		62943: 58442,
		62944: 58443,
		62945: 58444,
		62946: 58445,
		62947: 58446,
		62948: 58447,
		62949: 58448,
		62950: 58449,
		62951: 58450,
		62952: 58451,
		62953: 58452,
		62954: 58453,
		62955: 58454,
		62956: 58455,
		62957: 58456,
		62958: 58457,
		62959: 58458,
		62960: 58459,
		62961: 58460,
		62962: 58461,
		62963: 58462,
		62964: 58463,
		62965: 58464,
		62966: 58465,
		62967: 58466,
		62968: 58467,
		62969: 58468,
		62970: 58469,
		62971: 58470,
		62972: 58471,
		63040: 58472,
		63041: 58473,
		63042: 58474,
		63043: 58475,
		63044: 58476,
		63045: 58477,
		63046: 58478,
		63047: 58479,
		63048: 58480,
		63049: 58481,
		63050: 58482,
		63051: 58483,
		63052: 58484,
		63053: 58485,
		63054: 58486,
		63055: 58487,
		63056: 58488,
		63057: 58489,
		63058: 58490,
		63059: 58491,
		63060: 58492,
		63061: 58493,
		63062: 58494,
		63063: 58495,
		63064: 58496,
		63065: 58497,
		63066: 58498,
		63067: 58499,
		63068: 58500,
		63069: 58501,
		63070: 58502,
		63071: 58503,
		63072: 58504,
		63073: 58505,
		63074: 58506,
		63075: 58507,
		63076: 58508,
		63077: 58509,
		63078: 58510,
		63079: 58511,
		63080: 58512,
		63081: 58513,
		63082: 58514,
		63083: 58515,
		63084: 58516,
		63085: 58517,
		63086: 58518,
		63087: 58519,
		63088: 58520,
		63089: 58521,
		63090: 58522,
		63091: 58523,
		63092: 58524,
		63093: 58525,
		63094: 58526,
		63095: 58527,
		63096: 58528,
		63097: 58529,
		63098: 58530,
		63099: 58531,
		63100: 58532,
		63101: 58533,
		63102: 58534,
		63104: 58535,
		63105: 58536,
		63106: 58537,
		63107: 58538,
		63108: 58539,
		63109: 58540,
		63110: 58541,
		63111: 58542,
		63112: 58543,
		63113: 58544,
		63114: 58545,
		63115: 58546,
		63116: 58547,
		63117: 58548,
		63118: 58549,
		63119: 58550,
		63120: 58551,
		63121: 58552,
		63122: 58553,
		63123: 58554,
		63124: 58555,
		63125: 58556,
		63126: 58557,
		63127: 58558,
		63128: 58559,
		63129: 58560,
		63130: 58561,
		63131: 58562,
		63132: 58563,
		63133: 58564,
		63134: 58565,
		63135: 58566,
		63136: 58567,
		63137: 58568,
		63138: 58569,
		63139: 58570,
		63140: 58571,
		63141: 58572,
		63142: 58573,
		63143: 58574,
		63144: 58575,
		63145: 58576,
		63146: 58577,
		63147: 58578,
		63148: 58579,
		63149: 58580,
		63150: 58581,
		63151: 58582,
		63152: 58583,
		63153: 58584,
		63154: 58585,
		63155: 58586,
		63156: 58587,
		63157: 58588,
		63158: 58589,
		63159: 58590,
		63160: 58591,
		63161: 58592,
		63162: 58593,
		63163: 58594,
		63164: 58595,
		63165: 58596,
		63166: 58597,
		63167: 58598,
		63168: 58599,
		63169: 58600,
		63170: 58601,
		63171: 58602,
		63172: 58603,
		63173: 58604,
		63174: 58605,
		63175: 58606,
		63176: 58607,
		63177: 58608,
		63178: 58609,
		63179: 58610,
		63180: 58611,
		63181: 58612,
		63182: 58613,
		63183: 58614,
		63184: 58615,
		63185: 58616,
		63186: 58617,
		63187: 58618,
		63188: 58619,
		63189: 58620,
		63190: 58621,
		63191: 58622,
		63192: 58623,
		63193: 58624,
		63194: 58625,
		63195: 58626,
		63196: 58627,
		63197: 58628,
		63198: 58629,
		63199: 58630,
		63200: 58631,
		63201: 58632,
		63202: 58633,
		63203: 58634,
		63204: 58635,
		63205: 58636,
		63206: 58637,
		63207: 58638,
		63208: 58639,
		63209: 58640,
		63210: 58641,
		63211: 58642,
		63212: 58643,
		63213: 58644,
		63214: 58645,
		63215: 58646,
		63216: 58647,
		63217: 58648,
		63218: 58649,
		63219: 58650,
		63220: 58651,
		63221: 58652,
		63222: 58653,
		63223: 58654,
		63224: 58655,
		63225: 58656,
		63226: 58657,
		63227: 58658,
		63228: 58659,
		63296: 58660,
		63297: 58661,
		63298: 58662,
		63299: 58663,
		63300: 58664,
		63301: 58665,
		63302: 58666,
		63303: 58667,
		63304: 58668,
		63305: 58669,
		63306: 58670,
		63307: 58671,
		63308: 58672,
		63309: 58673,
		63310: 58674,
		63311: 58675,
		63312: 58676,
		63313: 58677,
		63314: 58678,
		63315: 58679,
		63316: 58680,
		63317: 58681,
		63318: 58682,
		63319: 58683,
		63320: 58684,
		63321: 58685,
		63322: 58686,
		63323: 58687,
		63324: 58688,
		63325: 58689,
		63326: 58690,
		63327: 58691,
		63328: 58692,
		63329: 58693,
		63330: 58694,
		63331: 58695,
		63332: 58696,
		63333: 58697,
		63334: 58698,
		63335: 58699,
		63336: 58700,
		63337: 58701,
		63338: 58702,
		63339: 58703,
		63340: 58704,
		63341: 58705,
		63342: 58706,
		63343: 58707,
		63344: 58708,
		63345: 58709,
		63346: 58710,
		63347: 58711,
		63348: 58712,
		63349: 58713,
		63350: 58714,
		63351: 58715,
		63352: 58716,
		63353: 58717,
		63354: 58718,
		63355: 58719,
		63356: 58720,
		63357: 58721,
		63358: 58722,
		63360: 58723,
		63361: 58724,
		63362: 58725,
		63363: 58726,
		63364: 58727,
		63365: 58728,
		63366: 58729,
		63367: 58730,
		63368: 58731,
		63369: 58732,
		63370: 58733,
		63371: 58734,
		63372: 58735,
		63373: 58736,
		63374: 58737,
		63375: 58738,
		63376: 58739,
		63377: 58740,
		63378: 58741,
		63379: 58742,
		63380: 58743,
		63381: 58744,
		63382: 58745,
		63383: 58746,
		63384: 58747,
		63385: 58748,
		63386: 58749,
		63387: 58750,
		63388: 58751,
		63389: 58752,
		63390: 58753,
		63391: 58754,
		63392: 58755,
		63393: 58756,
		63394: 58757,
		63395: 58758,
		63396: 58759,
		63397: 58760,
		63398: 58761,
		63399: 58762,
		63400: 58763,
		63401: 58764,
		63402: 58765,
		63403: 58766,
		63404: 58767,
		63405: 58768,
		63406: 58769,
		63407: 58770,
		63408: 58771,
		63409: 58772,
		63410: 58773,
		63411: 58774,
		63412: 58775,
		63413: 58776,
		63414: 58777,
		63415: 58778,
		63416: 58779,
		63417: 58780,
		63418: 58781,
		63419: 58782,
		63420: 58783,
		63421: 58784,
		63422: 58785,
		63423: 58786,
		63424: 58787,
		63425: 58788,
		63426: 58789,
		63427: 58790,
		63428: 58791,
		63429: 58792,
		63430: 58793,
		63431: 58794,
		63432: 58795,
		63433: 58796,
		63434: 58797,
		63435: 58798,
		63436: 58799,
		63437: 58800,
		63438: 58801,
		63439: 58802,
		63440: 58803,
		63441: 58804,
		63442: 58805,
		63443: 58806,
		63444: 58807,
		63445: 58808,
		63446: 58809,
		63447: 58810,
		63448: 58811,
		63449: 58812,
		63450: 58813,
		63451: 58814,
		63452: 58815,
		63453: 58816,
		63454: 58817,
		63455: 58818,
		63456: 58819,
		63457: 58820,
		63458: 58821,
		63459: 58822,
		63460: 58823,
		63461: 58824,
		63462: 58825,
		63463: 58826,
		63464: 58827,
		63465: 58828,
		63466: 58829,
		63467: 58830,
		63468: 58831,
		63469: 58832,
		63470: 58833,
		63471: 58834,
		63472: 58835,
		63473: 58836,
		63474: 58837,
		63475: 58838,
		63476: 58839,
		63477: 58840,
		63478: 58841,
		63479: 58842,
		63480: 58843,
		63481: 58844,
		63482: 58845,
		63483: 58846,
		63484: 58847,
		63552: 58848,
		63553: 58849,
		63554: 58850,
		63555: 58851,
		63556: 58852,
		63557: 58853,
		63558: 58854,
		63559: 58855,
		63560: 58856,
		63561: 58857,
		63562: 58858,
		63563: 58859,
		63564: 58860,
		63565: 58861,
		63566: 58862,
		63567: 58863,
		63568: 58864,
		63569: 58865,
		63570: 58866,
		63571: 58867,
		63572: 58868,
		63573: 58869,
		63574: 58870,
		63575: 58871,
		63576: 58872,
		63577: 58873,
		63578: 58874,
		63579: 58875,
		63580: 58876,
		63581: 58877,
		63582: 58878,
		63583: 58879,
		63584: 58880,
		63585: 58881,
		63586: 58882,
		63587: 58883,
		63588: 58884,
		63589: 58885,
		63590: 58886,
		63591: 58887,
		63592: 58888,
		63593: 58889,
		63594: 58890,
		63595: 58891,
		63596: 58892,
		63597: 58893,
		63598: 58894,
		63599: 58895,
		63600: 58896,
		63601: 58897,
		63602: 58898,
		63603: 58899,
		63604: 58900,
		63605: 58901,
		63606: 58902,
		63607: 58903,
		63608: 58904,
		63609: 58905,
		63610: 58906,
		63611: 58907,
		63612: 58908,
		63613: 58909,
		63614: 58910,
		63616: 58911,
		63617: 58912,
		63618: 58913,
		63619: 58914,
		63620: 58915,
		63621: 58916,
		63622: 58917,
		63623: 58918,
		63624: 58919,
		63625: 58920,
		63626: 58921,
		63627: 58922,
		63628: 58923,
		63629: 58924,
		63630: 58925,
		63631: 58926,
		63632: 58927,
		63633: 58928,
		63634: 58929,
		63635: 58930,
		63636: 58931,
		63637: 58932,
		63638: 58933,
		63639: 58934,
		63640: 58935,
		63641: 58936,
		63642: 58937,
		63643: 58938,
		63644: 58939,
		63645: 58940,
		63646: 58941,
		63647: 58942,
		63648: 58943,
		63649: 58944,
		63650: 58945,
		63651: 58946,
		63652: 58947,
		63653: 58948,
		63654: 58949,
		63655: 58950,
		63656: 58951,
		63657: 58952,
		63658: 58953,
		63659: 58954,
		63660: 58955,
		63661: 58956,
		63662: 58957,
		63663: 58958,
		63664: 58959,
		63665: 58960,
		63666: 58961,
		63667: 58962,
		63668: 58963,
		63669: 58964,
		63670: 58965,
		63671: 58966,
		63672: 58967,
		63673: 58968,
		63674: 58969,
		63675: 58970,
		63676: 58971,
		63677: 58972,
		63678: 58973,
		63679: 58974,
		63680: 58975,
		63681: 58976,
		63682: 58977,
		63683: 58978,
		63684: 58979,
		63685: 58980,
		63686: 58981,
		63687: 58982,
		63688: 58983,
		63689: 58984,
		63690: 58985,
		63691: 58986,
		63692: 58987,
		63693: 58988,
		63694: 58989,
		63695: 58990,
		63696: 58991,
		63697: 58992,
		63698: 58993,
		63699: 58994,
		63700: 58995,
		63701: 58996,
		63702: 58997,
		63703: 58998,
		63704: 58999,
		63705: 59000,
		63706: 59001,
		63707: 59002,
		63708: 59003,
		63709: 59004,
		63710: 59005,
		63711: 59006,
		63712: 59007,
		63713: 59008,
		63714: 59009,
		63715: 59010,
		63716: 59011,
		63717: 59012,
		63718: 59013,
		63719: 59014,
		63720: 59015,
		63721: 59016,
		63722: 59017,
		63723: 59018,
		63724: 59019,
		63725: 59020,
		63726: 59021,
		63727: 59022,
		63728: 59023,
		63729: 59024,
		63730: 59025,
		63731: 59026,
		63732: 59027,
		63733: 59028,
		63734: 59029,
		63735: 59030,
		63736: 59031,
		63737: 59032,
		63738: 59033,
		63739: 59034,
		63740: 59035,
		64064: 8560,
		64065: 8561,
		64066: 8562,
		64067: 8563,
		64068: 8564,
		64069: 8565,
		64070: 8566,
		64071: 8567,
		64072: 8568,
		64073: 8569,
		64074: 8544,
		64075: 8545,
		64076: 8546,
		64077: 8547,
		64078: 8548,
		64079: 8549,
		64080: 8550,
		64081: 8551,
		64082: 8552,
		64083: 8553,
		64084: 65506,
		64085: 65508,
		64086: 65287,
		64087: 65282,
		64088: 12849,
		64089: 8470,
		64090: 8481,
		64091: 8757,
		64092: 32394,
		64093: 35100,
		64094: 37704,
		64095: 37512,
		64096: 34012,
		64097: 20425,
		64098: 28859,
		64099: 26161,
		64100: 26824,
		64101: 37625,
		64102: 26363,
		64103: 24389,
		64104: 20008,
		64105: 20193,
		64106: 20220,
		64107: 20224,
		64108: 20227,
		64109: 20281,
		64110: 20310,
		64111: 20370,
		64112: 20362,
		64113: 20378,
		64114: 20372,
		64115: 20429,
		64116: 20544,
		64117: 20514,
		64118: 20479,
		64119: 20510,
		64120: 20550,
		64121: 20592,
		64122: 20546,
		64123: 20628,
		64124: 20724,
		64125: 20696,
		64126: 20810,
		64128: 20836,
		64129: 20893,
		64130: 20926,
		64131: 20972,
		64132: 21013,
		64133: 21148,
		64134: 21158,
		64135: 21184,
		64136: 21211,
		64137: 21248,
		64138: 21255,
		64139: 21284,
		64140: 21362,
		64141: 21395,
		64142: 21426,
		64143: 21469,
		64144: 64014,
		64145: 21660,
		64146: 21642,
		64147: 21673,
		64148: 21759,
		64149: 21894,
		64150: 22361,
		64151: 22373,
		64152: 22444,
		64153: 22472,
		64154: 22471,
		64155: 64015,
		64156: 64016,
		64157: 22686,
		64158: 22706,
		64159: 22795,
		64160: 22867,
		64161: 22875,
		64162: 22877,
		64163: 22883,
		64164: 22948,
		64165: 22970,
		64166: 23382,
		64167: 23488,
		64168: 29999,
		64169: 23512,
		64170: 23532,
		64171: 23582,
		64172: 23718,
		64173: 23738,
		64174: 23797,
		64175: 23847,
		64176: 23891,
		64177: 64017,
		64178: 23874,
		64179: 23917,
		64180: 23992,
		64181: 23993,
		64182: 24016,
		64183: 24353,
		64184: 24372,
		64185: 24423,
		64186: 24503,
		64187: 24542,
		64188: 24669,
		64189: 24709,
		64190: 24714,
		64191: 24798,
		64192: 24789,
		64193: 24864,
		64194: 24818,
		64195: 24849,
		64196: 24887,
		64197: 24880,
		64198: 24984,
		64199: 25107,
		64200: 25254,
		64201: 25589,
		64202: 25696,
		64203: 25757,
		64204: 25806,
		64205: 25934,
		64206: 26112,
		64207: 26133,
		64208: 26171,
		64209: 26121,
		64210: 26158,
		64211: 26142,
		64212: 26148,
		64213: 26213,
		64214: 26199,
		64215: 26201,
		64216: 64018,
		64217: 26227,
		64218: 26265,
		64219: 26272,
		64220: 26290,
		64221: 26303,
		64222: 26362,
		64223: 26382,
		64224: 63785,
		64225: 26470,
		64226: 26555,
		64227: 26706,
		64228: 26560,
		64229: 26625,
		64230: 26692,
		64231: 26831,
		64232: 64019,
		64233: 26984,
		64234: 64020,
		64235: 27032,
		64236: 27106,
		64237: 27184,
		64238: 27243,
		64239: 27206,
		64240: 27251,
		64241: 27262,
		64242: 27362,
		64243: 27364,
		64244: 27606,
		64245: 27711,
		64246: 27740,
		64247: 27782,
		64248: 27759,
		64249: 27866,
		64250: 27908,
		64251: 28039,
		64252: 28015,
		64320: 28054,
		64321: 28076,
		64322: 28111,
		64323: 28152,
		64324: 28146,
		64325: 28156,
		64326: 28217,
		64327: 28252,
		64328: 28199,
		64329: 28220,
		64330: 28351,
		64331: 28552,
		64332: 28597,
		64333: 28661,
		64334: 28677,
		64335: 28679,
		64336: 28712,
		64337: 28805,
		64338: 28843,
		64339: 28943,
		64340: 28932,
		64341: 29020,
		64342: 28998,
		64343: 28999,
		64344: 64021,
		64345: 29121,
		64346: 29182,
		64347: 29361,
		64348: 29374,
		64349: 29476,
		64350: 64022,
		64351: 29559,
		64352: 29629,
		64353: 29641,
		64354: 29654,
		64355: 29667,
		64356: 29650,
		64357: 29703,
		64358: 29685,
		64359: 29734,
		64360: 29738,
		64361: 29737,
		64362: 29742,
		64363: 29794,
		64364: 29833,
		64365: 29855,
		64366: 29953,
		64367: 30063,
		64368: 30338,
		64369: 30364,
		64370: 30366,
		64371: 30363,
		64372: 30374,
		64373: 64023,
		64374: 30534,
		64375: 21167,
		64376: 30753,
		64377: 30798,
		64378: 30820,
		64379: 30842,
		64380: 31024,
		64381: 64024,
		64382: 64025,
		64384: 64026,
		64385: 31124,
		64386: 64027,
		64387: 31131,
		64388: 31441,
		64389: 31463,
		64390: 64028,
		64391: 31467,
		64392: 31646,
		64393: 64029,
		64394: 32072,
		64395: 32092,
		64396: 32183,
		64397: 32160,
		64398: 32214,
		64399: 32338,
		64400: 32583,
		64401: 32673,
		64402: 64030,
		64403: 33537,
		64404: 33634,
		64405: 33663,
		64406: 33735,
		64407: 33782,
		64408: 33864,
		64409: 33972,
		64410: 34131,
		64411: 34137,
		64412: 34155,
		64413: 64031,
		64414: 34224,
		64415: 64032,
		64416: 64033,
		64417: 34823,
		64418: 35061,
		64419: 35346,
		64420: 35383,
		64421: 35449,
		64422: 35495,
		64423: 35518,
		64424: 35551,
		64425: 64034,
		64426: 35574,
		64427: 35667,
		64428: 35711,
		64429: 36080,
		64430: 36084,
		64431: 36114,
		64432: 36214,
		64433: 64035,
		64434: 36559,
		64435: 64036,
		64436: 64037,
		64437: 36967,
		64438: 37086,
		64439: 64038,
		64440: 37141,
		64441: 37159,
		64442: 37338,
		64443: 37335,
		64444: 37342,
		64445: 37357,
		64446: 37358,
		64447: 37348,
		64448: 37349,
		64449: 37382,
		64450: 37392,
		64451: 37386,
		64452: 37434,
		64453: 37440,
		64454: 37436,
		64455: 37454,
		64456: 37465,
		64457: 37457,
		64458: 37433,
		64459: 37479,
		64460: 37543,
		64461: 37495,
		64462: 37496,
		64463: 37607,
		64464: 37591,
		64465: 37593,
		64466: 37584,
		64467: 64039,
		64468: 37589,
		64469: 37600,
		64470: 37587,
		64471: 37669,
		64472: 37665,
		64473: 37627,
		64474: 64040,
		64475: 37662,
		64476: 37631,
		64477: 37661,
		64478: 37634,
		64479: 37744,
		64480: 37719,
		64481: 37796,
		64482: 37830,
		64483: 37854,
		64484: 37880,
		64485: 37937,
		64486: 37957,
		64487: 37960,
		64488: 38290,
		64489: 63964,
		64490: 64041,
		64491: 38557,
		64492: 38575,
		64493: 38707,
		64494: 38715,
		64495: 38723,
		64496: 38733,
		64497: 38735,
		64498: 38737,
		64499: 38741,
		64500: 38999,
		64501: 39013,
		64502: 64042,
		64503: 64043,
		64504: 39207,
		64505: 64044,
		64506: 39326,
		64507: 39502,
		64508: 39641,
		64576: 39644,
		64577: 39797,
		64578: 39794,
		64579: 39823,
		64580: 39857,
		64581: 39867,
		64582: 39936,
		64583: 40304,
		64584: 40299,
		64585: 64045,
		64586: 40473,
		64587: 40657
	};

	/**
	 * @author takahiro / https://github.com/takahirox
	 */

	function DataViewEx( buffer, littleEndian ) {

		this.dv = new DataView( buffer );
		this.offset = 0;
		this.littleEndian = ( littleEndian !== undefined ) ? littleEndian : true;
		this.encoder = new CharsetEncoder();

	}

	DataViewEx.prototype = {

		constructor: DataViewEx,

		getInt8: function () {

			var value = this.dv.getInt8( this.offset );
			this.offset += 1;
			return value;

		},

		getInt8Array: function ( size ) {

			var a = [];

			for ( var i = 0; i < size; i ++ ) {

				a.push( this.getInt8() );

			}

			return a;

		},

		getUint8: function () {

			var value = this.dv.getUint8( this.offset );
			this.offset += 1;
			return value;

		},

		getUint8Array: function ( size ) {

			var a = [];

			for ( var i = 0; i < size; i ++ ) {

				a.push( this.getUint8() );

			}

			return a;

		},


		getInt16: function () {

			var value = this.dv.getInt16( this.offset, this.littleEndian );
			this.offset += 2;
			return value;

		},

		getInt16Array: function ( size ) {

			var a = [];

			for ( var i = 0; i < size; i ++ ) {

				a.push( this.getInt16() );

			}

			return a;

		},

		getUint16: function () {

			var value = this.dv.getUint16( this.offset, this.littleEndian );
			this.offset += 2;
			return value;

		},

		getUint16Array: function ( size ) {

			var a = [];

			for ( var i = 0; i < size; i ++ ) {

				a.push( this.getUint16() );

			}

			return a;

		},

		getInt32: function () {

			var value = this.dv.getInt32( this.offset, this.littleEndian );
			this.offset += 4;
			return value;

		},

		getInt32Array: function ( size ) {

			var a = [];

			for ( var i = 0; i < size; i ++ ) {

				a.push( this.getInt32() );

			}

			return a;

		},

		getUint32: function () {

			var value = this.dv.getUint32( this.offset, this.littleEndian );
			this.offset += 4;
			return value;

		},

		getUint32Array: function ( size ) {

			var a = [];

			for ( var i = 0; i < size; i ++ ) {

				a.push( this.getUint32() );

			}

			return a;

		},

		getFloat32: function () {

			var value = this.dv.getFloat32( this.offset, this.littleEndian );
			this.offset += 4;
			return value;

		},

		getFloat32Array: function ( size ) {

			var a = [];

			for ( var i = 0; i < size; i ++ ) {

				a.push( this.getFloat32() );

			}

			return a;

		},

		getFloat64: function () {

			var value = this.dv.getFloat64( this.offset, this.littleEndian );
			this.offset += 8;
			return value;

		},

		getFloat64Array: function ( size ) {

			var a = [];

			for ( var i = 0; i < size; i ++ ) {

				a.push( this.getFloat64() );

			}

			return a;

		},

		getIndex: function ( type, isUnsigned ) {

			switch ( type ) {

				case 1:
					return ( isUnsigned === true ) ? this.getUint8() : this.getInt8();

				case 2:
					return ( isUnsigned === true ) ? this.getUint16() : this.getInt16();

				case 4:
					return this.getInt32(); // No Uint32

				default:
					throw 'unknown number type ' + type + ' exception.';

			}

		},

		getIndexArray: function ( type, size, isUnsigned ) {

			var a = [];

			for ( var i = 0; i < size; i ++ ) {

				a.push( this.getIndex( type, isUnsigned ) );

			}

			return a;

		},

		getChars: function ( size ) {

			var str = '';

			while ( size > 0 ) {

				var value = this.getUint8();
				size --;

				if ( value === 0 ) {

					break;

				}

				str += String.fromCharCode( value );

			}

			while ( size > 0 ) {

				this.getUint8();
				size --;

			}

			return str;

		},

		getSjisStringsAsUnicode: function ( size ) {

			var a = [];

			while ( size > 0 ) {

				var value = this.getUint8();
				size --;

				if ( value === 0 ) {

					break;

				}

				a.push( value );

			}

			while ( size > 0 ) {

				this.getUint8();
				size --;

			}

			return this.encoder.s2u( new Uint8Array( a ) );

		},

		getUnicodeStrings: function ( size ) {

			var str = '';

			while ( size > 0 ) {

				var value = this.getUint16();
				size -= 2;

				if ( value === 0 ) {

					break;

				}

				str += String.fromCharCode( value );

			}

			while ( size > 0 ) {

				this.getUint8();
				size --;

			}

			return str;

		},

		getTextBuffer: function () {

			var size = this.getUint32();
			return this.getUnicodeStrings( size );

		}

	};

	/**
	 * @author takahiro / https://github.com/takahirox
	 */

	function DataCreationHelper() {
	}

	DataCreationHelper.prototype = {

		constructor: DataCreationHelper,

		leftToRightVector3: function ( v ) {

			v[ 2 ] = - v[ 2 ];

		},

		leftToRightQuaternion: function ( q ) {

			q[ 0 ] = - q[ 0 ];
			q[ 1 ] = - q[ 1 ];

		},

		leftToRightEuler: function ( r ) {

			r[ 0 ] = - r[ 0 ];
			r[ 1 ] = - r[ 1 ];

		},

		leftToRightIndexOrder: function ( p ) {

			var tmp = p[ 2 ];
			p[ 2 ] = p[ 0 ];
			p[ 0 ] = tmp;

		},

		leftToRightVector3Range: function ( v1, v2 ) {

			var tmp = - v2[ 2 ];
			v2[ 2 ] = - v1[ 2 ];
			v1[ 2 ] = tmp;

		},

		leftToRightEulerRange: function ( r1, r2 ) {

			var tmp1 = - r2[ 0 ];
			var tmp2 = - r2[ 1 ];
			r2[ 0 ] = - r1[ 0 ];
			r2[ 1 ] = - r1[ 1 ];
			r1[ 0 ] = tmp1;
			r1[ 1 ] = tmp2;

		}

	};

	/**
	 * @author takahiro / https://github.com/takahirox
	 */

	function Parser() {
	}

	Parser.prototype.parsePmd = function ( buffer, leftToRight ) {

		var pmd = {};
		var dv = new DataViewEx( buffer );

		pmd.metadata = {};
		pmd.metadata.format = 'pmd';
		pmd.metadata.coordinateSystem = 'left';

		var parseHeader = function () {

			var metadata = pmd.metadata;
			metadata.magic = dv.getChars( 3 );

			if ( metadata.magic !== 'Pmd' ) {

				throw 'PMD file magic is not Pmd, but ' + metadata.magic;

			}

			metadata.version = dv.getFloat32();
			metadata.modelName = dv.getSjisStringsAsUnicode( 20 );
			metadata.comment = dv.getSjisStringsAsUnicode( 256 );

		};

		var parseVertices = function () {

			var parseVertex = function () {

				var p = {};
				p.position = dv.getFloat32Array( 3 );
				p.normal = dv.getFloat32Array( 3 );
				p.uv = dv.getFloat32Array( 2 );
				p.skinIndices = dv.getUint16Array( 2 );
				p.skinWeights = [ dv.getUint8() / 100 ];
				p.skinWeights.push( 1.0 - p.skinWeights[ 0 ] );
				p.edgeFlag = dv.getUint8();
				return p;

			};

			var metadata = pmd.metadata;
			metadata.vertexCount = dv.getUint32();

			pmd.vertices = [];

			for ( var i = 0; i < metadata.vertexCount; i ++ ) {

				pmd.vertices.push( parseVertex() );

			}

		};

		var parseFaces = function () {

			var parseFace = function () {

				var p = {};
				p.indices = dv.getUint16Array( 3 );
				return p;

			};

			var metadata = pmd.metadata;
			metadata.faceCount = dv.getUint32() / 3;

			pmd.faces = [];

			for ( var i = 0; i < metadata.faceCount; i ++ ) {

				pmd.faces.push( parseFace() );

			}

		};

		var parseMaterials = function () {

			var parseMaterial = function () {

				var p = {};
				p.diffuse = dv.getFloat32Array( 4 );
				p.shininess = dv.getFloat32();
				p.specular = dv.getFloat32Array( 3 );
				p.ambient = dv.getFloat32Array( 3 );
				p.toonIndex = dv.getInt8();
				p.edgeFlag = dv.getUint8();
				p.faceCount = dv.getUint32() / 3;
				p.fileName = dv.getSjisStringsAsUnicode( 20 );
				return p;

			};

			var metadata = pmd.metadata;
			metadata.materialCount = dv.getUint32();

			pmd.materials = [];

			for ( var i = 0; i < metadata.materialCount; i ++ ) {

				pmd.materials.push( parseMaterial() );

			}

		};

		var parseBones = function () {

			var parseBone = function () {

				var p = {};
				p.name = dv.getSjisStringsAsUnicode( 20 );
				p.parentIndex = dv.getInt16();
				p.tailIndex = dv.getInt16();
				p.type = dv.getUint8();
				p.ikIndex = dv.getInt16();
				p.position = dv.getFloat32Array( 3 );
				return p;

			};

			var metadata = pmd.metadata;
			metadata.boneCount = dv.getUint16();

			pmd.bones = [];

			for ( var i = 0; i < metadata.boneCount; i ++ ) {

				pmd.bones.push( parseBone() );

			}

		};

		var parseIks = function () {

			var parseIk = function () {

				var p = {};
				p.target = dv.getUint16();
				p.effector = dv.getUint16();
				p.linkCount = dv.getUint8();
				p.iteration = dv.getUint16();
				p.maxAngle = dv.getFloat32();

				p.links = [];
				for ( var i = 0; i < p.linkCount; i ++ ) {

					var link = {};
					link.index = dv.getUint16();
					p.links.push( link );

				}

				return p;

			};

			var metadata = pmd.metadata;
			metadata.ikCount = dv.getUint16();

			pmd.iks = [];

			for ( var i = 0; i < metadata.ikCount; i ++ ) {

				pmd.iks.push( parseIk() );

			}

		};

		var parseMorphs = function () {

			var parseMorph = function () {

				var p = {};
				p.name = dv.getSjisStringsAsUnicode( 20 );
				p.elementCount = dv.getUint32();
				p.type = dv.getUint8();

				p.elements = [];
				for ( var i = 0; i < p.elementCount; i ++ ) {

					p.elements.push( {
						index: dv.getUint32(),
						position: dv.getFloat32Array( 3 )
					} );

				}

				return p;

			};

			var metadata = pmd.metadata;
			metadata.morphCount = dv.getUint16();

			pmd.morphs = [];

			for ( var i = 0; i < metadata.morphCount; i ++ ) {

				pmd.morphs.push( parseMorph() );

			}


		};

		var parseMorphFrames = function () {

			var parseMorphFrame = function () {

				var p = {};
				p.index = dv.getUint16();
				return p;

			};

			var metadata = pmd.metadata;
			metadata.morphFrameCount = dv.getUint8();

			pmd.morphFrames = [];

			for ( var i = 0; i < metadata.morphFrameCount; i ++ ) {

				pmd.morphFrames.push( parseMorphFrame() );

			}

		};

		var parseBoneFrameNames = function () {

			var parseBoneFrameName = function () {

				var p = {};
				p.name = dv.getSjisStringsAsUnicode( 50 );
				return p;

			};

			var metadata = pmd.metadata;
			metadata.boneFrameNameCount = dv.getUint8();

			pmd.boneFrameNames = [];

			for ( var i = 0; i < metadata.boneFrameNameCount; i ++ ) {

				pmd.boneFrameNames.push( parseBoneFrameName() );

			}

		};

		var parseBoneFrames = function () {

			var parseBoneFrame = function () {

				var p = {};
				p.boneIndex = dv.getInt16();
				p.frameIndex = dv.getUint8();
				return p;

			};

			var metadata = pmd.metadata;
			metadata.boneFrameCount = dv.getUint32();

			pmd.boneFrames = [];

			for ( var i = 0; i < metadata.boneFrameCount; i ++ ) {

				pmd.boneFrames.push( parseBoneFrame() );

			}

		};

		var parseEnglishHeader = function () {

			var metadata = pmd.metadata;
			metadata.englishCompatibility = dv.getUint8();

			if ( metadata.englishCompatibility > 0 ) {

				metadata.englishModelName = dv.getSjisStringsAsUnicode( 20 );
				metadata.englishComment = dv.getSjisStringsAsUnicode( 256 );

			}

		};

		var parseEnglishBoneNames = function () {

			var parseEnglishBoneName = function () {

				var p = {};
				p.name = dv.getSjisStringsAsUnicode( 20 );
				return p;

			};

			var metadata = pmd.metadata;

			if ( metadata.englishCompatibility === 0 ) {

				return;

			}

			pmd.englishBoneNames = [];

			for ( var i = 0; i < metadata.boneCount; i ++ ) {

				pmd.englishBoneNames.push( parseEnglishBoneName() );

			}

		};

		var parseEnglishMorphNames = function () {

			var parseEnglishMorphName = function () {

				var p = {};
				p.name = dv.getSjisStringsAsUnicode( 20 );
				return p;

			};

			var metadata = pmd.metadata;

			if ( metadata.englishCompatibility === 0 ) {

				return;

			}

			pmd.englishMorphNames = [];

			for ( var i = 0; i < metadata.morphCount - 1; i ++ ) {

				pmd.englishMorphNames.push( parseEnglishMorphName() );

			}

		};

		var parseEnglishBoneFrameNames = function () {

			var parseEnglishBoneFrameName = function () {

				var p = {};
				p.name = dv.getSjisStringsAsUnicode( 50 );
				return p;

			};

			var metadata = pmd.metadata;

			if ( metadata.englishCompatibility === 0 ) {

				return;

			}

			pmd.englishBoneFrameNames = [];

			for ( var i = 0; i < metadata.boneFrameNameCount; i ++ ) {

				pmd.englishBoneFrameNames.push( parseEnglishBoneFrameName() );

			}

		};

		var parseToonTextures = function () {

			var parseToonTexture = function () {

				var p = {};
				p.fileName = dv.getSjisStringsAsUnicode( 100 );
				return p;

			};

			pmd.toonTextures = [];

			for ( var i = 0; i < 10; i ++ ) {

				pmd.toonTextures.push( parseToonTexture() );

			}

		};

		var parseRigidBodies = function () {

			var parseRigidBody = function () {

				var p = {};
				p.name = dv.getSjisStringsAsUnicode( 20 );
				p.boneIndex = dv.getInt16();
				p.groupIndex = dv.getUint8();
				p.groupTarget = dv.getUint16();
				p.shapeType = dv.getUint8();
				p.width = dv.getFloat32();
				p.height = dv.getFloat32();
				p.depth = dv.getFloat32();
				p.position = dv.getFloat32Array( 3 );
				p.rotation = dv.getFloat32Array( 3 );
				p.weight = dv.getFloat32();
				p.positionDamping = dv.getFloat32();
				p.rotationDamping = dv.getFloat32();
				p.restitution = dv.getFloat32();
				p.friction = dv.getFloat32();
				p.type = dv.getUint8();
				return p;

			};

			var metadata = pmd.metadata;
			metadata.rigidBodyCount = dv.getUint32();

			pmd.rigidBodies = [];

			for ( var i = 0; i < metadata.rigidBodyCount; i ++ ) {

				pmd.rigidBodies.push( parseRigidBody() );

			}

		};

		var parseConstraints = function () {

			var parseConstraint = function () {

				var p = {};
				p.name = dv.getSjisStringsAsUnicode( 20 );
				p.rigidBodyIndex1 = dv.getUint32();
				p.rigidBodyIndex2 = dv.getUint32();
				p.position = dv.getFloat32Array( 3 );
				p.rotation = dv.getFloat32Array( 3 );
				p.translationLimitation1 = dv.getFloat32Array( 3 );
				p.translationLimitation2 = dv.getFloat32Array( 3 );
				p.rotationLimitation1 = dv.getFloat32Array( 3 );
				p.rotationLimitation2 = dv.getFloat32Array( 3 );
				p.springPosition = dv.getFloat32Array( 3 );
				p.springRotation = dv.getFloat32Array( 3 );
				return p;

			};

			var metadata = pmd.metadata;
			metadata.constraintCount = dv.getUint32();

			pmd.constraints = [];

			for ( var i = 0; i < metadata.constraintCount; i ++ ) {

				pmd.constraints.push( parseConstraint() );

			}

		};

		parseHeader();
		parseVertices();
		parseFaces();
		parseMaterials();
		parseBones();
		parseIks();
		parseMorphs();
		parseMorphFrames();
		parseBoneFrameNames();
		parseBoneFrames();
		parseEnglishHeader();
		parseEnglishBoneNames();
		parseEnglishMorphNames();
		parseEnglishBoneFrameNames();
		parseToonTextures();
		parseRigidBodies();
		parseConstraints();

		if ( leftToRight === true ) this.leftToRightModel( pmd );

		// console.log( pmd ); // for console debug

		return pmd;

	};

	Parser.prototype.parsePmx = function ( buffer, leftToRight ) {

		var pmx = {};
		var dv = new DataViewEx( buffer );

		pmx.metadata = {};
		pmx.metadata.format = 'pmx';
		pmx.metadata.coordinateSystem = 'left';

		var parseHeader = function () {

			var metadata = pmx.metadata;
			metadata.magic = dv.getChars( 4 );

			// Note: don't remove the last blank space.
			if ( metadata.magic !== 'PMX ' ) {

				throw 'PMX file magic is not PMX , but ' + metadata.magic;

			}

			metadata.version = dv.getFloat32();

			if ( metadata.version !== 2.0 && metadata.version !== 2.1 ) {

				throw 'PMX version ' + metadata.version + ' is not supported.';

			}

			metadata.headerSize = dv.getUint8();
			metadata.encoding = dv.getUint8();
			metadata.additionalUvNum = dv.getUint8();
			metadata.vertexIndexSize = dv.getUint8();
			metadata.textureIndexSize = dv.getUint8();
			metadata.materialIndexSize = dv.getUint8();
			metadata.boneIndexSize = dv.getUint8();
			metadata.morphIndexSize = dv.getUint8();
			metadata.rigidBodyIndexSize = dv.getUint8();
			metadata.modelName = dv.getTextBuffer();
			metadata.englishModelName = dv.getTextBuffer();
			metadata.comment = dv.getTextBuffer();
			metadata.englishComment = dv.getTextBuffer();

		};

		var parseVertices = function () {

			var parseVertex = function () {

				var p = {};
				p.position = dv.getFloat32Array( 3 );
				p.normal = dv.getFloat32Array( 3 );
				p.uv = dv.getFloat32Array( 2 );

				p.auvs = [];

				for ( var i = 0; i < pmx.metadata.additionalUvNum; i ++ ) {

					p.auvs.push( dv.getFloat32Array( 4 ) );

				}

				p.type = dv.getUint8();

				var indexSize = metadata.boneIndexSize;

				if ( p.type === 0 ) { // BDEF1

					p.skinIndices = dv.getIndexArray( indexSize, 1 );
					p.skinWeights = [ 1.0 ];

				} else if ( p.type === 1 ) { // BDEF2

					p.skinIndices = dv.getIndexArray( indexSize, 2 );
					p.skinWeights = dv.getFloat32Array( 1 );
					p.skinWeights.push( 1.0 - p.skinWeights[ 0 ] );

				} else if ( p.type === 2 ) { // BDEF4

					p.skinIndices = dv.getIndexArray( indexSize, 4 );
					p.skinWeights = dv.getFloat32Array( 4 );

				} else if ( p.type === 3 ) { // SDEF

					p.skinIndices = dv.getIndexArray( indexSize, 2 );
					p.skinWeights = dv.getFloat32Array( 1 );
					p.skinWeights.push( 1.0 - p.skinWeights[ 0 ] );

					p.skinC = dv.getFloat32Array( 3 );
					p.skinR0 = dv.getFloat32Array( 3 );
					p.skinR1 = dv.getFloat32Array( 3 );

					// SDEF is not supported yet and is handled as BDEF2 so far.
					// TODO: SDEF support
					p.type = 1;

				} else {

					throw 'unsupport bone type ' + p.type + ' exception.';

				}

				p.edgeRatio = dv.getFloat32();
				return p;

			};

			var metadata = pmx.metadata;
			metadata.vertexCount = dv.getUint32();

			pmx.vertices = [];

			for ( var i = 0; i < metadata.vertexCount; i ++ ) {

				pmx.vertices.push( parseVertex() );

			}

		};

		var parseFaces = function () {

			var parseFace = function () {

				var p = {};
				p.indices = dv.getIndexArray( metadata.vertexIndexSize, 3, true );
				return p;

			};

			var metadata = pmx.metadata;
			metadata.faceCount = dv.getUint32() / 3;

			pmx.faces = [];

			for ( var i = 0; i < metadata.faceCount; i ++ ) {

				pmx.faces.push( parseFace() );

			}

		};

		var parseTextures = function () {

			var parseTexture = function () {

				return dv.getTextBuffer();

			};

			var metadata = pmx.metadata;
			metadata.textureCount = dv.getUint32();

			pmx.textures = [];

			for ( var i = 0; i < metadata.textureCount; i ++ ) {

				pmx.textures.push( parseTexture() );

			}

		};

		var parseMaterials = function () {

			var parseMaterial = function () {

				var p = {};
				p.name = dv.getTextBuffer();
				p.englishName = dv.getTextBuffer();
				p.diffuse = dv.getFloat32Array( 4 );
				p.specular = dv.getFloat32Array( 3 );
				p.shininess = dv.getFloat32();
				p.ambient = dv.getFloat32Array( 3 );
				p.flag = dv.getUint8();
				p.edgeColor = dv.getFloat32Array( 4 );
				p.edgeSize = dv.getFloat32();
				p.textureIndex = dv.getIndex( pmx.metadata.textureIndexSize );
				p.envTextureIndex = dv.getIndex( pmx.metadata.textureIndexSize );
				p.envFlag = dv.getUint8();
				p.toonFlag = dv.getUint8();

				if ( p.toonFlag === 0 ) {

					p.toonIndex = dv.getIndex( pmx.metadata.textureIndexSize );

				} else if ( p.toonFlag === 1 ) {

					p.toonIndex = dv.getInt8();

				} else {

					throw 'unknown toon flag ' + p.toonFlag + ' exception.';

				}

				p.comment = dv.getTextBuffer();
				p.faceCount = dv.getUint32() / 3;
				return p;

			};

			var metadata = pmx.metadata;
			metadata.materialCount = dv.getUint32();

			pmx.materials = [];

			for ( var i = 0; i < metadata.materialCount; i ++ ) {

				pmx.materials.push( parseMaterial() );

			}

		};

		var parseBones = function () {

			var parseBone = function () {

				var p = {};
				p.name = dv.getTextBuffer();
				p.englishName = dv.getTextBuffer();
				p.position = dv.getFloat32Array( 3 );
				p.parentIndex = dv.getIndex( pmx.metadata.boneIndexSize );
				p.transformationClass = dv.getUint32();
				p.flag = dv.getUint16();

				if ( p.flag & 0x1 ) {

					p.connectIndex = dv.getIndex( pmx.metadata.boneIndexSize );

				} else {

					p.offsetPosition = dv.getFloat32Array( 3 );

				}

				if ( p.flag & 0x100 || p.flag & 0x200 ) {

					// Note: I don't think Grant is an appropriate name
					//       but I found that some English translated MMD tools use this term
					//       so I've named it Grant so far.
					//       I'd rename to more appropriate name from Grant later.
					var grant = {};

					grant.isLocal = ( p.flag & 0x80 ) !== 0 ? true : false;
					grant.affectRotation = ( p.flag & 0x100 ) !== 0 ? true : false;
					grant.affectPosition = ( p.flag & 0x200 ) !== 0 ? true : false;
					grant.parentIndex = dv.getIndex( pmx.metadata.boneIndexSize );
					grant.ratio = dv.getFloat32();

					p.grant = grant;

				}

				if ( p.flag & 0x400 ) {

					p.fixAxis = dv.getFloat32Array( 3 );

				}

				if ( p.flag & 0x800 ) {

					p.localXVector = dv.getFloat32Array( 3 );
					p.localZVector = dv.getFloat32Array( 3 );

				}

				if ( p.flag & 0x2000 ) {

					p.key = dv.getUint32();

				}

				if ( p.flag & 0x20 ) {

					var ik = {};

					ik.effector = dv.getIndex( pmx.metadata.boneIndexSize );
					ik.target = null;
					ik.iteration = dv.getUint32();
					ik.maxAngle = dv.getFloat32();
					ik.linkCount = dv.getUint32();
					ik.links = [];

					for ( var i = 0; i < ik.linkCount; i ++ ) {

						var link = {};
						link.index = dv.getIndex( pmx.metadata.boneIndexSize );
						link.angleLimitation = dv.getUint8();

						if ( link.angleLimitation === 1 ) {

							link.lowerLimitationAngle = dv.getFloat32Array( 3 );
							link.upperLimitationAngle = dv.getFloat32Array( 3 );

						}

						ik.links.push( link );

					}

					p.ik = ik;

				}

				return p;

			};

			var metadata = pmx.metadata;
			metadata.boneCount = dv.getUint32();

			pmx.bones = [];

			for ( var i = 0; i < metadata.boneCount; i ++ ) {

				pmx.bones.push( parseBone() );

			}

		};

		var parseMorphs = function () {

			var parseMorph = function () {

				var p = {};
				p.name = dv.getTextBuffer();
				p.englishName = dv.getTextBuffer();
				p.panel = dv.getUint8();
				p.type = dv.getUint8();
				p.elementCount = dv.getUint32();
				p.elements = [];

				for ( var i = 0; i < p.elementCount; i ++ ) {

					if ( p.type === 0 ) { // group morph

						var m = {};
						m.index = dv.getIndex( pmx.metadata.morphIndexSize );
						m.ratio = dv.getFloat32();
						p.elements.push( m );

					} else if ( p.type === 1 ) { // vertex morph

						var m = {};
						m.index = dv.getIndex( pmx.metadata.vertexIndexSize, true );
						m.position = dv.getFloat32Array( 3 );
						p.elements.push( m );

					} else if ( p.type === 2 ) { // bone morph

						var m = {};
						m.index = dv.getIndex( pmx.metadata.boneIndexSize );
						m.position = dv.getFloat32Array( 3 );
						m.rotation = dv.getFloat32Array( 4 );
						p.elements.push( m );

					} else if ( p.type === 3 ) { // uv morph

						var m = {};
						m.index = dv.getIndex( pmx.metadata.vertexIndexSize, true );
						m.uv = dv.getFloat32Array( 4 );
						p.elements.push( m );

					} else if ( p.type === 4 ) { // additional uv1

						// TODO: implement

					} else if ( p.type === 5 ) { // additional uv2

						// TODO: implement

					} else if ( p.type === 6 ) { // additional uv3

						// TODO: implement

					} else if ( p.type === 7 ) { // additional uv4

						// TODO: implement

					} else if ( p.type === 8 ) { // material morph

						var m = {};
						m.index = dv.getIndex( pmx.metadata.materialIndexSize );
						m.type = dv.getUint8();
						m.diffuse = dv.getFloat32Array( 4 );
						m.specular = dv.getFloat32Array( 3 );
						m.shininess = dv.getFloat32();
						m.ambient = dv.getFloat32Array( 3 );
						m.edgeColor = dv.getFloat32Array( 4 );
						m.edgeSize = dv.getFloat32();
						m.textureColor = dv.getFloat32Array( 4 );
						m.sphereTextureColor = dv.getFloat32Array( 4 );
						m.toonColor = dv.getFloat32Array( 4 );
						p.elements.push( m );

					}

				}

				return p;

			};

			var metadata = pmx.metadata;
			metadata.morphCount = dv.getUint32();

			pmx.morphs = [];

			for ( var i = 0; i < metadata.morphCount; i ++ ) {

				pmx.morphs.push( parseMorph() );

			}

		};

		var parseFrames = function () {

			var parseFrame = function () {

				var p = {};
				p.name = dv.getTextBuffer();
				p.englishName = dv.getTextBuffer();
				p.type = dv.getUint8();
				p.elementCount = dv.getUint32();
				p.elements = [];

				for ( var i = 0; i < p.elementCount; i ++ ) {

					var e = {};
					e.target = dv.getUint8();
					e.index = ( e.target === 0 ) ? dv.getIndex( pmx.metadata.boneIndexSize ) : dv.getIndex( pmx.metadata.morphIndexSize );
					p.elements.push( e );

				}

				return p;

			};

			var metadata = pmx.metadata;
			metadata.frameCount = dv.getUint32();

			pmx.frames = [];

			for ( var i = 0; i < metadata.frameCount; i ++ ) {

				pmx.frames.push( parseFrame() );

			}

		};

		var parseRigidBodies = function () {

			var parseRigidBody = function () {

				var p = {};
				p.name = dv.getTextBuffer();
				p.englishName = dv.getTextBuffer();
				p.boneIndex = dv.getIndex( pmx.metadata.boneIndexSize );
				p.groupIndex = dv.getUint8();
				p.groupTarget = dv.getUint16();
				p.shapeType = dv.getUint8();
				p.width = dv.getFloat32();
				p.height = dv.getFloat32();
				p.depth = dv.getFloat32();
				p.position = dv.getFloat32Array( 3 );
				p.rotation = dv.getFloat32Array( 3 );
				p.weight = dv.getFloat32();
				p.positionDamping = dv.getFloat32();
				p.rotationDamping = dv.getFloat32();
				p.restitution = dv.getFloat32();
				p.friction = dv.getFloat32();
				p.type = dv.getUint8();
				return p;

			};

			var metadata = pmx.metadata;
			metadata.rigidBodyCount = dv.getUint32();

			pmx.rigidBodies = [];

			for ( var i = 0; i < metadata.rigidBodyCount; i ++ ) {

				pmx.rigidBodies.push( parseRigidBody() );

			}

		};

		var parseConstraints = function () {

			var parseConstraint = function () {

				var p = {};
				p.name = dv.getTextBuffer();
				p.englishName = dv.getTextBuffer();
				p.type = dv.getUint8();
				p.rigidBodyIndex1 = dv.getIndex( pmx.metadata.rigidBodyIndexSize );
				p.rigidBodyIndex2 = dv.getIndex( pmx.metadata.rigidBodyIndexSize );
				p.position = dv.getFloat32Array( 3 );
				p.rotation = dv.getFloat32Array( 3 );
				p.translationLimitation1 = dv.getFloat32Array( 3 );
				p.translationLimitation2 = dv.getFloat32Array( 3 );
				p.rotationLimitation1 = dv.getFloat32Array( 3 );
				p.rotationLimitation2 = dv.getFloat32Array( 3 );
				p.springPosition = dv.getFloat32Array( 3 );
				p.springRotation = dv.getFloat32Array( 3 );
				return p;

			};

			var metadata = pmx.metadata;
			metadata.constraintCount = dv.getUint32();

			pmx.constraints = [];

			for ( var i = 0; i < metadata.constraintCount; i ++ ) {

				pmx.constraints.push( parseConstraint() );

			}

		};

		parseHeader();
		parseVertices();
		parseFaces();
		parseTextures();
		parseMaterials();
		parseBones();
		parseMorphs();
		parseFrames();
		parseRigidBodies();
		parseConstraints();

		if ( leftToRight === true ) this.leftToRightModel( pmx );

		// console.log( pmx ); // for console debug

		return pmx;

	};

	Parser.prototype.parseVmd = function ( buffer, leftToRight ) {

		var vmd = {};
		var dv = new DataViewEx( buffer );

		vmd.metadata = {};
		vmd.metadata.coordinateSystem = 'left';

		var parseHeader = function () {

			var metadata = vmd.metadata;
			metadata.magic = dv.getChars( 30 );

			if ( metadata.magic !== 'Vocaloid Motion Data 0002' ) {

				throw 'VMD file magic is not Vocaloid Motion Data 0002, but ' + metadata.magic;

			}

			metadata.name = dv.getSjisStringsAsUnicode( 20 );

		};

		var parseMotions = function () {

			var parseMotion = function () {

				var p = {};
				p.boneName = dv.getSjisStringsAsUnicode( 15 );
				p.frameNum = dv.getUint32();
				p.position = dv.getFloat32Array( 3 );
				p.rotation = dv.getFloat32Array( 4 );
				p.interpolation = dv.getUint8Array( 64 );
				return p;

			};

			var metadata = vmd.metadata;
			metadata.motionCount = dv.getUint32();

			vmd.motions = [];
			for ( var i = 0; i < metadata.motionCount; i ++ ) {

				vmd.motions.push( parseMotion() );

			}

		};

		var parseMorphs = function () {

			var parseMorph = function () {

				var p = {};
				p.morphName = dv.getSjisStringsAsUnicode( 15 );
				p.frameNum = dv.getUint32();
				p.weight = dv.getFloat32();
				return p;

			};

			var metadata = vmd.metadata;
			metadata.morphCount = dv.getUint32();

			vmd.morphs = [];
			for ( var i = 0; i < metadata.morphCount; i ++ ) {

				vmd.morphs.push( parseMorph() );

			}

		};

		var parseCameras = function () {

			var parseCamera = function () {

				var p = {};
				p.frameNum = dv.getUint32();
				p.distance = dv.getFloat32();
				p.position = dv.getFloat32Array( 3 );
				p.rotation = dv.getFloat32Array( 3 );
				p.interpolation = dv.getUint8Array( 24 );
				p.fov = dv.getUint32();
				p.perspective = dv.getUint8();
				return p;

			};

			var metadata = vmd.metadata;
			metadata.cameraCount = dv.getUint32();

			vmd.cameras = [];
			for ( var i = 0; i < metadata.cameraCount; i ++ ) {

				vmd.cameras.push( parseCamera() );

			}

		};

		parseHeader();
		parseMotions();
		parseMorphs();
		parseCameras();

		if ( leftToRight === true ) this.leftToRightVmd( vmd );

		// console.log( vmd ); // for console debug

		return vmd;

	};

	Parser.prototype.parseVpd = function ( text, leftToRight ) {

		var vpd = {};

		vpd.metadata = {};
		vpd.metadata.coordinateSystem = 'left';

		vpd.bones = [];

		var commentPatternG = /\/\/\w*(\r|\n|\r\n)/g;
		var newlinePattern = /\r|\n|\r\n/;

		var lines = text.replace( commentPatternG, '' ).split( newlinePattern );

		function throwError() {

			throw 'the file seems not vpd file.';

		}

		function checkMagic() {

			if ( lines[ 0 ] !== 'Vocaloid Pose Data file' ) {

				throwError();

			}

		}

		function parseHeader() {

			if ( lines.length < 4 ) {

				throwError();

			}

			vpd.metadata.parentFile = lines[ 2 ];
			vpd.metadata.boneCount = parseInt( lines[ 3 ] );

		}

		function parseBones() {

			var boneHeaderPattern = /^\s*(Bone[0-9]+)\s*\{\s*(.*)$/;
			var boneVectorPattern = /^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/;
			var boneQuaternionPattern = /^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/;
			var boneFooterPattern = /^\s*}/;

			var bones = vpd.bones;
			var n = null;
			var v = null;
			var q = null;

			for ( var i = 4; i < lines.length; i ++ ) {

				var line = lines[ i ];

				var result;

				result = line.match( boneHeaderPattern );

				if ( result !== null ) {

					if ( n !== null ) {

						throwError();

					}

					n = result[ 2 ];

				}

				result = line.match( boneVectorPattern );

				if ( result !== null ) {

					if ( v !== null ) {

						throwError();

					}

					v = [

						parseFloat( result[ 1 ] ),
						parseFloat( result[ 2 ] ),
						parseFloat( result[ 3 ] )

					];

				}

				result = line.match( boneQuaternionPattern );

				if ( result !== null ) {

					if ( q !== null ) {

						throwError();

					}

					q = [

						parseFloat( result[ 1 ] ),
						parseFloat( result[ 2 ] ),
						parseFloat( result[ 3 ] ),
						parseFloat( result[ 4 ] )

					];


				}

				result = line.match( boneFooterPattern );

				if ( result !== null ) {

					if ( n === null || v === null || q === null ) {

						throwError();

					}

					bones.push( {

						name: n,
						translation: v,
						quaternion: q

					} );

					n = null;
					v = null;
					q = null;

				}

			}

			if ( n !== null || v !== null || q !== null ) {

				throwError();

			}

		}

		checkMagic();
		parseHeader();
		parseBones();

		if ( leftToRight === true ) this.leftToRightVpd( vpd );

		// console.log( vpd );  // for console debug

		return vpd;

	};

	Parser.prototype.mergeVmds = function ( vmds ) {

		var v = {};
		v.metadata = {};
		v.metadata.name = vmds[ 0 ].metadata.name;
		v.metadata.coordinateSystem = vmds[ 0 ].metadata.coordinateSystem;
		v.metadata.motionCount = 0;
		v.metadata.morphCount = 0;
		v.metadata.cameraCount = 0;
		v.motions = [];
		v.morphs = [];
		v.cameras = [];

		for ( var i = 0; i < vmds.length; i ++ ) {

			var v2 = vmds[ i ];

			v.metadata.motionCount += v2.metadata.motionCount;
			v.metadata.morphCount += v2.metadata.morphCount;
			v.metadata.cameraCount += v2.metadata.cameraCount;

			for ( var j = 0; j < v2.metadata.motionCount; j ++ ) {

				v.motions.push( v2.motions[ j ] );

			}

			for ( var j = 0; j < v2.metadata.morphCount; j ++ ) {

				v.morphs.push( v2.morphs[ j ] );

			}

			for ( var j = 0; j < v2.metadata.cameraCount; j ++ ) {

				v.cameras.push( v2.cameras[ j ] );

			}

		}

		return v;

	};

	Parser.prototype.leftToRightModel = function ( model ) {

		if ( model.metadata.coordinateSystem === 'right' ) {

			return;

		}

		model.metadata.coordinateSystem = 'right';

		var helper = new DataCreationHelper();

		for ( var i = 0; i < model.metadata.vertexCount; i ++ ) {

			helper.leftToRightVector3( model.vertices[ i ].position );
			helper.leftToRightVector3( model.vertices[ i ].normal );

		}

		for ( var i = 0; i < model.metadata.faceCount; i ++ ) {

			helper.leftToRightIndexOrder( model.faces[ i ].indices );

		}

		for ( var i = 0; i < model.metadata.boneCount; i ++ ) {

			helper.leftToRightVector3( model.bones[ i ].position );

		}

		// TODO: support other morph for PMX
		for ( var i = 0; i < model.metadata.morphCount; i ++ ) {

			var m = model.morphs[ i ];

			if ( model.metadata.format === 'pmx' && m.type !== 1 ) {

				// TODO: implement
				continue;

			}

			for ( var j = 0; j < m.elements.length; j ++ ) {

				helper.leftToRightVector3( m.elements[ j ].position );

			}

		}

		for ( var i = 0; i < model.metadata.rigidBodyCount; i ++ ) {

			helper.leftToRightVector3( model.rigidBodies[ i ].position );
			helper.leftToRightEuler( model.rigidBodies[ i ].rotation );

		}

		for ( var i = 0; i < model.metadata.constraintCount; i ++ ) {

			helper.leftToRightVector3( model.constraints[ i ].position );
			helper.leftToRightEuler( model.constraints[ i ].rotation );
			helper.leftToRightVector3Range( model.constraints[ i ].translationLimitation1, model.constraints[ i ].translationLimitation2 );
			helper.leftToRightEulerRange( model.constraints[ i ].rotationLimitation1, model.constraints[ i ].rotationLimitation2 );

		}

	};

	Parser.prototype.leftToRightVmd = function ( vmd ) {

		if ( vmd.metadata.coordinateSystem === 'right' ) {

			return;

		}

		vmd.metadata.coordinateSystem = 'right';

		var helper = new DataCreationHelper();

		for ( var i = 0; i < vmd.metadata.motionCount; i ++ ) {

			helper.leftToRightVector3( vmd.motions[ i ].position );
			helper.leftToRightQuaternion( vmd.motions[ i ].rotation );

		}

		for ( var i = 0; i < vmd.metadata.cameraCount; i ++ ) {

			helper.leftToRightVector3( vmd.cameras[ i ].position );
			helper.leftToRightEuler( vmd.cameras[ i ].rotation );

		}

	};

	Parser.prototype.leftToRightVpd = function ( vpd ) {

		if ( vpd.metadata.coordinateSystem === 'right' ) {

			return;

		}

		vpd.metadata.coordinateSystem = 'right';

		var helper = new DataCreationHelper();

		for ( var i = 0; i < vpd.bones.length; i ++ ) {

			helper.leftToRightVector3( vpd.bones[ i ].translation );
			helper.leftToRightQuaternion( vpd.bones[ i ].quaternion );

		}

	};

	var MMDParser = { CharsetEncoder, Parser };

	return MMDParser;

});
define('skylark-threejs-ex/exporters/MMDExporter',[
    "skylark-threejs",
    "../threex",
    '../utils/mmdparser'
], function (
    THREE,
    threex, 
    MMDParser
) {
    'use strict';
    var MMDExporter = function () {
        var u2sTable;
        function unicodeToShiftjis(str) {
            if (u2sTable === undefined) {
                var encoder = new MMDParser.CharsetEncoder();
                var table = encoder.s2uTable;
                u2sTable = {};
                var keys = Object.keys(table);
                for (var i = 0, il = keys.length; i < il; i++) {
                    var key = keys[i];
                    var value = table[key];
                    key = parseInt(key);
                    u2sTable[value] = key;
                }
            }
            var array = [];
            for (var i = 0, il = str.length; i < il; i++) {
                var code = str.charCodeAt(i);
                var value = u2sTable[code];
                if (value === undefined) {
                    throw 'cannot convert charcode 0x' + code.toString(16);
                } else if (value > 255) {
                    array.push(value >> 8 & 255);
                    array.push(value & 255);
                } else {
                    array.push(value & 255);
                }
            }
            return new Uint8Array(array);
        }
        function getBindBones(skin) {
            var poseSkin = skin.clone();
            poseSkin.pose();
            return poseSkin.skeleton.bones;
        }
        this.parseVpd = function (skin, outputShiftJis, useOriginalBones) {
            if (skin.isSkinnedMesh !== true) {
                console.warn('THREE.MMDExporter: parseVpd() requires SkinnedMesh instance.');
                return null;
            }
            function toStringsFromNumber(num) {
                if (Math.abs(num) < 0.000001)
                    num = 0;
                var a = num.toString();
                if (a.indexOf('.') === -1) {
                    a += '.';
                }
                a += '000000';
                var index = a.indexOf('.');
                var d = a.slice(0, index);
                var p = a.slice(index + 1, index + 7);
                return d + '.' + p;
            }
            function toStringsFromArray(array) {
                var a = [];
                for (var i = 0, il = array.length; i < il; i++) {
                    a.push(toStringsFromNumber(array[i]));
                }
                return a.join(',');
            }
            skin.updateMatrixWorld(true);
            var bones = skin.skeleton.bones;
            var bones2 = getBindBones(skin);
            var position = new THREE.Vector3();
            var quaternion = new THREE.Quaternion();
            var quaternion2 = new THREE.Quaternion();
            var matrix = new THREE.Matrix4();
            var array = [];
            array.push('Vocaloid Pose Data file');
            array.push('');
            array.push((skin.name !== '' ? skin.name.replace(/\s/g, '_') : 'skin') + '.osm;');
            array.push(bones.length + ';');
            array.push('');
            for (var i = 0, il = bones.length; i < il; i++) {
                var bone = bones[i];
                var bone2 = bones2[i];
                if (useOriginalBones === true && bone.userData.ik !== undefined && bone.userData.ik.originalMatrix !== undefined) {
                    matrix.fromArray(bone.userData.ik.originalMatrix);
                } else {
                    matrix.copy(bone.matrix);
                }
                position.setFromMatrixPosition(matrix);
                quaternion.setFromRotationMatrix(matrix);
                var pArray = position.sub(bone2.position).toArray();
                var qArray = quaternion2.copy(bone2.quaternion).conjugate().multiply(quaternion).toArray();
                pArray[2] = -pArray[2];
                qArray[0] = -qArray[0];
                qArray[1] = -qArray[1];
                array.push('Bone' + i + '{' + bone.name);
                array.push('  ' + toStringsFromArray(pArray) + ';');
                array.push('  ' + toStringsFromArray(qArray) + ';');
                array.push('}');
                array.push('');
            }
            array.push('');
            var lines = array.join('\n');
            return outputShiftJis === true ? unicodeToShiftjis(lines) : lines;
        };
    };

    return threex.exporters.MMDExporter = MMDExporter;
});
define('skylark-threejs-ex/exporters/OBJExporter',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var OBJExporter = function () {
    };
    OBJExporter.prototype = {
        constructor: OBJExporter,
        parse: function (object) {
            var output = '';
            var indexVertex = 0;
            var indexVertexUvs = 0;
            var indexNormals = 0;
            var vertex = new THREE.Vector3();
            var normal = new THREE.Vector3();
            var uv = new THREE.Vector2();
            var i, j, k, l, m, face = [];
            var parseMesh = function (mesh) {
                var nbVertex = 0;
                var nbNormals = 0;
                var nbVertexUvs = 0;
                var geometry = mesh.geometry;
                var normalMatrixWorld = new THREE.Matrix3();
                if (geometry instanceof THREE.Geometry) {
                    geometry = new THREE.BufferGeometry().setFromObject(mesh);
                }
                if (geometry instanceof THREE.BufferGeometry) {
                    var vertices = geometry.getAttribute('position');
                    var normals = geometry.getAttribute('normal');
                    var uvs = geometry.getAttribute('uv');
                    var indices = geometry.getIndex();
                    output += 'o ' + mesh.name + '\n';
                    if (mesh.material && mesh.material.name) {
                        output += 'usemtl ' + mesh.material.name + '\n';
                    }
                    if (vertices !== undefined) {
                        for (i = 0, l = vertices.count; i < l; i++, nbVertex++) {
                            vertex.x = vertices.getX(i);
                            vertex.y = vertices.getY(i);
                            vertex.z = vertices.getZ(i);
                            vertex.applyMatrix4(mesh.matrixWorld);
                            output += 'v ' + vertex.x + ' ' + vertex.y + ' ' + vertex.z + '\n';
                        }
                    }
                    if (uvs !== undefined) {
                        for (i = 0, l = uvs.count; i < l; i++, nbVertexUvs++) {
                            uv.x = uvs.getX(i);
                            uv.y = uvs.getY(i);
                            output += 'vt ' + uv.x + ' ' + uv.y + '\n';
                        }
                    }
                    if (normals !== undefined) {
                        normalMatrixWorld.getNormalMatrix(mesh.matrixWorld);
                        for (i = 0, l = normals.count; i < l; i++, nbNormals++) {
                            normal.x = normals.getX(i);
                            normal.y = normals.getY(i);
                            normal.z = normals.getZ(i);
                            normal.applyMatrix3(normalMatrixWorld).normalize();
                            output += 'vn ' + normal.x + ' ' + normal.y + ' ' + normal.z + '\n';
                        }
                    }
                    if (indices !== null) {
                        for (i = 0, l = indices.count; i < l; i += 3) {
                            for (m = 0; m < 3; m++) {
                                j = indices.getX(i + m) + 1;
                                face[m] = indexVertex + j + (normals || uvs ? '/' + (uvs ? indexVertexUvs + j : '') + (normals ? '/' + (indexNormals + j) : '') : '');
                            }
                            output += 'f ' + face.join(' ') + '\n';
                        }
                    } else {
                        for (i = 0, l = vertices.count; i < l; i += 3) {
                            for (m = 0; m < 3; m++) {
                                j = i + m + 1;
                                face[m] = indexVertex + j + (normals || uvs ? '/' + (uvs ? indexVertexUvs + j : '') + (normals ? '/' + (indexNormals + j) : '') : '');
                            }
                            output += 'f ' + face.join(' ') + '\n';
                        }
                    }
                } else {
                    console.warn('THREE.OBJExporter.parseMesh(): geometry type unsupported', geometry);
                }
                indexVertex += nbVertex;
                indexVertexUvs += nbVertexUvs;
                indexNormals += nbNormals;
            };
            var parseLine = function (line) {
                var nbVertex = 0;
                var geometry = line.geometry;
                var type = line.type;
                if (geometry instanceof THREE.Geometry) {
                    geometry = new THREE.BufferGeometry().setFromObject(line);
                }
                if (geometry instanceof THREE.BufferGeometry) {
                    var vertices = geometry.getAttribute('position');
                    output += 'o ' + line.name + '\n';
                    if (vertices !== undefined) {
                        for (i = 0, l = vertices.count; i < l; i++, nbVertex++) {
                            vertex.x = vertices.getX(i);
                            vertex.y = vertices.getY(i);
                            vertex.z = vertices.getZ(i);
                            vertex.applyMatrix4(line.matrixWorld);
                            output += 'v ' + vertex.x + ' ' + vertex.y + ' ' + vertex.z + '\n';
                        }
                    }
                    if (type === 'Line') {
                        output += 'l ';
                        for (j = 1, l = vertices.count; j <= l; j++) {
                            output += indexVertex + j + ' ';
                        }
                        output += '\n';
                    }
                    if (type === 'LineSegments') {
                        for (j = 1, k = j + 1, l = vertices.count; j < l; j += 2, k = j + 1) {
                            output += 'l ' + (indexVertex + j) + ' ' + (indexVertex + k) + '\n';
                        }
                    }
                } else {
                    console.warn('THREE.OBJExporter.parseLine(): geometry type unsupported', geometry);
                }
                indexVertex += nbVertex;
            };
            object.traverse(function (child) {
                if (child instanceof THREE.Mesh) {
                    parseMesh(child);
                }
                if (child instanceof THREE.Line) {
                    parseLine(child);
                }
            });
            return output;
        }
    };

    return threex.exporters.OBJExporter = OBJExporter;
});
define('skylark-threejs-ex/exporters/PLYExporter',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var PLYExporter = function () {
    };
    PLYExporter.prototype = {
        constructor: PLYExporter,
        parse: function (object, onDone, options) {
            if (onDone && typeof onDone === 'object') {
                console.warn('THREE.PLYExporter: The options parameter is now the third argument to the "parse" function. See the documentation for the new API.');
                options = onDone;
                onDone = undefined;
            }
            function traverseMeshes(cb) {
                object.traverse(function (child) {
                    if (child.isMesh === true) {
                        var mesh = child;
                        var geometry = mesh.geometry;
                        if (geometry.isGeometry === true) {
                            geometry = geomToBufferGeom.get(geometry);
                        }
                        if (geometry.isBufferGeometry === true) {
                            if (geometry.getAttribute('position') !== undefined) {
                                cb(mesh, geometry);
                            }
                        }
                    }
                });
            }
            var defaultOptions = {
                binary: false,
                excludeAttributes: [],
                littleEndian: false
            };
            options = Object.assign(defaultOptions, options);
            var excludeAttributes = options.excludeAttributes;
            var geomToBufferGeom = new WeakMap();
            var includeNormals = false;
            var includeColors = false;
            var includeUVs = false;
            var vertexCount = 0;
            var faceCount = 0;
            object.traverse(function (child) {
                if (child.isMesh === true) {
                    var mesh = child;
                    var geometry = mesh.geometry;
                    if (geometry.isGeometry === true) {
                        var bufferGeometry = geomToBufferGeom.get(geometry) || new THREE.BufferGeometry().setFromObject(mesh);
                        geomToBufferGeom.set(geometry, bufferGeometry);
                        geometry = bufferGeometry;
                    }
                    if (geometry.isBufferGeometry === true) {
                        var vertices = geometry.getAttribute('position');
                        var normals = geometry.getAttribute('normal');
                        var uvs = geometry.getAttribute('uv');
                        var colors = geometry.getAttribute('color');
                        var indices = geometry.getIndex();
                        if (vertices === undefined) {
                            return;
                        }
                        vertexCount += vertices.count;
                        faceCount += indices ? indices.count / 3 : vertices.count / 3;
                        if (normals !== undefined)
                            includeNormals = true;
                        if (uvs !== undefined)
                            includeUVs = true;
                        if (colors !== undefined)
                            includeColors = true;
                    }
                }
            });
            var includeIndices = excludeAttributes.indexOf('index') === -1;
            includeNormals = includeNormals && excludeAttributes.indexOf('normal') === -1;
            includeColors = includeColors && excludeAttributes.indexOf('color') === -1;
            includeUVs = includeUVs && excludeAttributes.indexOf('uv') === -1;
            if (includeIndices && faceCount !== Math.floor(faceCount)) {
                console.error('PLYExporter: Failed to generate a valid PLY file with triangle indices because the ' + 'number of indices is not divisible by 3.');
                return null;
            }
            var indexByteCount = 4;
            var header = 'ply\n' + `format ${ options.binary ? options.littleEndian ? 'binary_little_endian' : 'binary_big_endian' : 'ascii' } 1.0\n` + `element vertex ${ vertexCount }\n` + 'property float x\n' + 'property float y\n' + 'property float z\n';
            if (includeNormals === true) {
                header += 'property float nx\n' + 'property float ny\n' + 'property float nz\n';
            }
            if (includeUVs === true) {
                header += 'property float s\n' + 'property float t\n';
            }
            if (includeColors === true) {
                header += 'property uchar red\n' + 'property uchar green\n' + 'property uchar blue\n';
            }
            if (includeIndices === true) {
                header += `element face ${ faceCount }\n` + `property list uchar int vertex_index\n`;
            }
            header += 'end_header\n';
            var vertex = new THREE.Vector3();
            var normalMatrixWorld = new THREE.Matrix3();
            var result = null;
            if (options.binary === true) {
                var headerBin = new TextEncoder().encode(header);
                var vertexListLength = vertexCount * (4 * 3 + (includeNormals ? 4 * 3 : 0) + (includeColors ? 3 : 0) + (includeUVs ? 4 * 2 : 0));
                var faceListLength = includeIndices ? faceCount * (indexByteCount * 3 + 1) : 0;
                var output = new DataView(new ArrayBuffer(headerBin.length + vertexListLength + faceListLength));
                new Uint8Array(output.buffer).set(headerBin, 0);
                var vOffset = headerBin.length;
                var fOffset = headerBin.length + vertexListLength;
                var writtenVertices = 0;
                traverseMeshes(function (mesh, geometry) {
                    var vertices = geometry.getAttribute('position');
                    var normals = geometry.getAttribute('normal');
                    var uvs = geometry.getAttribute('uv');
                    var colors = geometry.getAttribute('color');
                    var indices = geometry.getIndex();
                    normalMatrixWorld.getNormalMatrix(mesh.matrixWorld);
                    for (var i = 0, l = vertices.count; i < l; i++) {
                        vertex.x = vertices.getX(i);
                        vertex.y = vertices.getY(i);
                        vertex.z = vertices.getZ(i);
                        vertex.applyMatrix4(mesh.matrixWorld);
                        output.setFloat32(vOffset, vertex.x, options.littleEndian);
                        vOffset += 4;
                        output.setFloat32(vOffset, vertex.y, options.littleEndian);
                        vOffset += 4;
                        output.setFloat32(vOffset, vertex.z, options.littleEndian);
                        vOffset += 4;
                        if (includeNormals === true) {
                            if (normals != null) {
                                vertex.x = normals.getX(i);
                                vertex.y = normals.getY(i);
                                vertex.z = normals.getZ(i);
                                vertex.applyMatrix3(normalMatrixWorld).normalize();
                                output.setFloat32(vOffset, vertex.x, options.littleEndian);
                                vOffset += 4;
                                output.setFloat32(vOffset, vertex.y, options.littleEndian);
                                vOffset += 4;
                                output.setFloat32(vOffset, vertex.z, options.littleEndian);
                                vOffset += 4;
                            } else {
                                output.setFloat32(vOffset, 0, options.littleEndian);
                                vOffset += 4;
                                output.setFloat32(vOffset, 0, options.littleEndian);
                                vOffset += 4;
                                output.setFloat32(vOffset, 0, options.littleEndian);
                                vOffset += 4;
                            }
                        }
                        if (includeUVs === true) {
                            if (uvs != null) {
                                output.setFloat32(vOffset, uvs.getX(i), options.littleEndian);
                                vOffset += 4;
                                output.setFloat32(vOffset, uvs.getY(i), options.littleEndian);
                                vOffset += 4;
                            } else if (includeUVs !== false) {
                                output.setFloat32(vOffset, 0, options.littleEndian);
                                vOffset += 4;
                                output.setFloat32(vOffset, 0, options.littleEndian);
                                vOffset += 4;
                            }
                        }
                        if (includeColors === true) {
                            if (colors != null) {
                                output.setUint8(vOffset, Math.floor(colors.getX(i) * 255));
                                vOffset += 1;
                                output.setUint8(vOffset, Math.floor(colors.getY(i) * 255));
                                vOffset += 1;
                                output.setUint8(vOffset, Math.floor(colors.getZ(i) * 255));
                                vOffset += 1;
                            } else {
                                output.setUint8(vOffset, 255);
                                vOffset += 1;
                                output.setUint8(vOffset, 255);
                                vOffset += 1;
                                output.setUint8(vOffset, 255);
                                vOffset += 1;
                            }
                        }
                    }
                    if (includeIndices === true) {
                        if (indices !== null) {
                            for (var i = 0, l = indices.count; i < l; i += 3) {
                                output.setUint8(fOffset, 3);
                                fOffset += 1;
                                output.setUint32(fOffset, indices.getX(i + 0) + writtenVertices, options.littleEndian);
                                fOffset += indexByteCount;
                                output.setUint32(fOffset, indices.getX(i + 1) + writtenVertices, options.littleEndian);
                                fOffset += indexByteCount;
                                output.setUint32(fOffset, indices.getX(i + 2) + writtenVertices, options.littleEndian);
                                fOffset += indexByteCount;
                            }
                        } else {
                            for (var i = 0, l = vertices.count; i < l; i += 3) {
                                output.setUint8(fOffset, 3);
                                fOffset += 1;
                                output.setUint32(fOffset, writtenVertices + i, options.littleEndian);
                                fOffset += indexByteCount;
                                output.setUint32(fOffset, writtenVertices + i + 1, options.littleEndian);
                                fOffset += indexByteCount;
                                output.setUint32(fOffset, writtenVertices + i + 2, options.littleEndian);
                                fOffset += indexByteCount;
                            }
                        }
                    }
                    writtenVertices += vertices.count;
                });
                result = output.buffer;
            } else {
                var writtenVertices = 0;
                var vertexList = '';
                var faceList = '';
                traverseMeshes(function (mesh, geometry) {
                    var vertices = geometry.getAttribute('position');
                    var normals = geometry.getAttribute('normal');
                    var uvs = geometry.getAttribute('uv');
                    var colors = geometry.getAttribute('color');
                    var indices = geometry.getIndex();
                    normalMatrixWorld.getNormalMatrix(mesh.matrixWorld);
                    for (var i = 0, l = vertices.count; i < l; i++) {
                        vertex.x = vertices.getX(i);
                        vertex.y = vertices.getY(i);
                        vertex.z = vertices.getZ(i);
                        vertex.applyMatrix4(mesh.matrixWorld);
                        var line = vertex.x + ' ' + vertex.y + ' ' + vertex.z;
                        if (includeNormals === true) {
                            if (normals != null) {
                                vertex.x = normals.getX(i);
                                vertex.y = normals.getY(i);
                                vertex.z = normals.getZ(i);
                                vertex.applyMatrix3(normalMatrixWorld).normalize();
                                line += ' ' + vertex.x + ' ' + vertex.y + ' ' + vertex.z;
                            } else {
                                line += ' 0 0 0';
                            }
                        }
                        if (includeUVs === true) {
                            if (uvs != null) {
                                line += ' ' + uvs.getX(i) + ' ' + uvs.getY(i);
                            } else if (includeUVs !== false) {
                                line += ' 0 0';
                            }
                        }
                        if (includeColors === true) {
                            if (colors != null) {
                                line += ' ' + Math.floor(colors.getX(i) * 255) + ' ' + Math.floor(colors.getY(i) * 255) + ' ' + Math.floor(colors.getZ(i) * 255);
                            } else {
                                line += ' 255 255 255';
                            }
                        }
                        vertexList += line + '\n';
                    }
                    if (includeIndices === true) {
                        if (indices !== null) {
                            for (var i = 0, l = indices.count; i < l; i += 3) {
                                faceList += `3 ${ indices.getX(i + 0) + writtenVertices }`;
                                faceList += ` ${ indices.getX(i + 1) + writtenVertices }`;
                                faceList += ` ${ indices.getX(i + 2) + writtenVertices }\n`;
                            }
                        } else {
                            for (var i = 0, l = vertices.count; i < l; i += 3) {
                                faceList += `3 ${ writtenVertices + i } ${ writtenVertices + i + 1 } ${ writtenVertices + i + 2 }\n`;
                            }
                        }
                        faceCount += indices ? indices.count / 3 : vertices.count / 3;
                    }
                    writtenVertices += vertices.count;
                });
                result = `${ header }${ vertexList }${ includeIndices ? `${ faceList }\n` : '\n' }`;
            }
            if (typeof onDone === 'function')
                requestAnimationFrame(() => onDone(result));
            return result;
        }
    };
    
    return threex.exporters.PLYExporter = PLYExporter;
});
define('skylark-threejs-ex/exporters/STLExporter',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var STLExporter = function () {
    };
    STLExporter.prototype = {
        constructor: STLExporter,
        parse: function () {
            var vector = new THREE.Vector3();
            var normalMatrixWorld = new THREE.Matrix3();
            return function parse(scene, options) {
                if (options === undefined)
                    options = {};
                var binary = options.binary !== undefined ? options.binary : false;
                var objects = [];
                var triangles = 0;
                scene.traverse(function (object) {
                    if (object.isMesh) {
                        var geometry = object.geometry;
                        if (geometry.isBufferGeometry) {
                            geometry = new THREE.Geometry().fromBufferGeometry(geometry);
                        }
                        if (geometry.isGeometry) {
                            triangles += geometry.faces.length;
                            objects.push({
                                geometry: geometry,
                                matrixWorld: object.matrixWorld
                            });
                        }
                    }
                });
                if (binary) {
                    var offset = 80;
                    var bufferLength = triangles * 2 + triangles * 3 * 4 * 4 + 80 + 4;
                    var arrayBuffer = new ArrayBuffer(bufferLength);
                    var output = new DataView(arrayBuffer);
                    output.setUint32(offset, triangles, true);
                    offset += 4;
                    for (var i = 0, il = objects.length; i < il; i++) {
                        var object = objects[i];
                        var vertices = object.geometry.vertices;
                        var faces = object.geometry.faces;
                        var matrixWorld = object.matrixWorld;
                        normalMatrixWorld.getNormalMatrix(matrixWorld);
                        for (var j = 0, jl = faces.length; j < jl; j++) {
                            var face = faces[j];
                            vector.copy(face.normal).applyMatrix3(normalMatrixWorld).normalize();
                            output.setFloat32(offset, vector.x, true);
                            offset += 4;
                            output.setFloat32(offset, vector.y, true);
                            offset += 4;
                            output.setFloat32(offset, vector.z, true);
                            offset += 4;
                            var indices = [
                                face.a,
                                face.b,
                                face.c
                            ];
                            for (var k = 0; k < 3; k++) {
                                vector.copy(vertices[indices[k]]).applyMatrix4(matrixWorld);
                                output.setFloat32(offset, vector.x, true);
                                offset += 4;
                                output.setFloat32(offset, vector.y, true);
                                offset += 4;
                                output.setFloat32(offset, vector.z, true);
                                offset += 4;
                            }
                            output.setUint16(offset, 0, true);
                            offset += 2;
                        }
                    }
                    return output;
                } else {
                    var output = '';
                    output += 'solid exported\n';
                    for (var i = 0, il = objects.length; i < il; i++) {
                        var object = objects[i];
                        var vertices = object.geometry.vertices;
                        var faces = object.geometry.faces;
                        var matrixWorld = object.matrixWorld;
                        normalMatrixWorld.getNormalMatrix(matrixWorld);
                        for (var j = 0, jl = faces.length; j < jl; j++) {
                            var face = faces[j];
                            vector.copy(face.normal).applyMatrix3(normalMatrixWorld).normalize();
                            output += '\tfacet normal ' + vector.x + ' ' + vector.y + ' ' + vector.z + '\n';
                            output += '\t\touter loop\n';
                            var indices = [
                                face.a,
                                face.b,
                                face.c
                            ];
                            for (var k = 0; k < 3; k++) {
                                vector.copy(vertices[indices[k]]).applyMatrix4(matrixWorld);
                                output += '\t\t\tvertex ' + vector.x + ' ' + vector.y + ' ' + vector.z + '\n';
                            }
                            output += '\t\tendloop\n';
                            output += '\tendfacet\n';
                        }
                    }
                    output += 'endsolid exported\n';
                    return output;
                }
            };
        }()
    };
    return threex.exporters.STLExporter = STLExporter;
});
define('skylark-threejs-ex/exporters/TypedGeometryExporter',[
   "../threex",
],function (threex) {
    'use strict';
    var TypedGeometryExporter = function () {
    };
    TypedGeometryExporter.prototype = {
        constructor: TypedGeometryExporter,
        parse: function (geometry) {
            var output = {
                metadata: {
                    version: 4,
                    type: 'TypedGeometry',
                    generator: 'TypedGeometryExporter'
                }
            };
            var attributes = [
                'vertices',
                'normals',
                'uvs'
            ];
            for (var key in attributes) {
                var attribute = attributes[key];
                var typedArray = geometry[attribute];
                var array = [];
                for (var i = 0, l = typedArray.length; i < l; i++) {
                    array[i] = typedArray[i];
                }
                output[attribute] = array;
            }
            var boundingSphere = geometry.boundingSphere;
            if (boundingSphere !== null) {
                output.boundingSphere = {
                    center: boundingSphere.center.toArray(),
                    radius: boundingSphere.radius
                };
            }
            return output;
        }
    };
    return threex.exporters.TypedGeometryExporter = TypedGeometryExporter;
});
define('skylark-threejs-ex/geometries/BoxLineGeometry',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var BoxLineGeometry = function (width, height, depth, widthSegments, heightSegments, depthSegments) {
        THREE.BufferGeometry.call(this);
        width = width || 1;
        height = height || 1;
        depth = depth || 1;
        widthSegments = Math.floor(widthSegments) || 1;
        heightSegments = Math.floor(heightSegments) || 1;
        depthSegments = Math.floor(depthSegments) || 1;
        var widthHalf = width / 2;
        var heightHalf = height / 2;
        var depthHalf = depth / 2;
        var segmentWidth = width / widthSegments;
        var segmentHeight = height / heightSegments;
        var segmentDepth = depth / depthSegments;
        var vertices = [];
        var x = -widthHalf, y = -heightHalf, z = -depthHalf;
        for (var i = 0; i <= widthSegments; i++) {
            vertices.push(x, -heightHalf, -depthHalf, x, heightHalf, -depthHalf);
            vertices.push(x, heightHalf, -depthHalf, x, heightHalf, depthHalf);
            vertices.push(x, heightHalf, depthHalf, x, -heightHalf, depthHalf);
            vertices.push(x, -heightHalf, depthHalf, x, -heightHalf, -depthHalf);
            x += segmentWidth;
        }
        for (var i = 0; i <= heightSegments; i++) {
            vertices.push(-widthHalf, y, -depthHalf, widthHalf, y, -depthHalf);
            vertices.push(widthHalf, y, -depthHalf, widthHalf, y, depthHalf);
            vertices.push(widthHalf, y, depthHalf, -widthHalf, y, depthHalf);
            vertices.push(-widthHalf, y, depthHalf, -widthHalf, y, -depthHalf);
            y += segmentHeight;
        }
        for (var i = 0; i <= depthSegments; i++) {
            vertices.push(-widthHalf, -heightHalf, z, -widthHalf, heightHalf, z);
            vertices.push(-widthHalf, heightHalf, z, widthHalf, heightHalf, z);
            vertices.push(widthHalf, heightHalf, z, widthHalf, -heightHalf, z);
            vertices.push(widthHalf, -heightHalf, z, -widthHalf, -heightHalf, z);
            z += segmentDepth;
        }
        this.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
    };
    BoxLineGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);
    BoxLineGeometry.prototype.constructor = BoxLineGeometry;

    return threex.geometries.BoxLineGeometry = BoxLineGeometry;
});
define('skylark-threejs-ex/math/ConvexHull',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ConvexHull = function () {
        var Visible = 0;
        var Deleted = 1;
        var v1 = new THREE.Vector3();
        function ConvexHull() {
            this.tolerance = -1;
            this.faces = [];
            this.newFaces = [];
            this.assigned = new VertexList();
            this.unassigned = new VertexList();
            this.vertices = [];
        }
        Object.assign(ConvexHull.prototype, {
            setFromPoints: function (points) {
                if (Array.isArray(points) !== true) {
                    console.error('THREE.ConvexHull: Points parameter is not an array.');
                }
                if (points.length < 4) {
                    console.error('THREE.ConvexHull: The algorithm needs at least four points.');
                }
                this.makeEmpty();
                for (var i = 0, l = points.length; i < l; i++) {
                    this.vertices.push(new VertexNode(points[i]));
                }
                this.compute();
                return this;
            },
            setFromObject: function (object) {
                var points = [];
                object.updateMatrixWorld(true);
                object.traverse(function (node) {
                    var i, l, point;
                    var geometry = node.geometry;
                    if (geometry !== undefined) {
                        if (geometry.isGeometry) {
                            var vertices = geometry.vertices;
                            for (i = 0, l = vertices.length; i < l; i++) {
                                point = vertices[i].clone();
                                point.applyMatrix4(node.matrixWorld);
                                points.push(point);
                            }
                        } else if (geometry.isBufferGeometry) {
                            var attribute = geometry.attributes.position;
                            if (attribute !== undefined) {
                                for (i = 0, l = attribute.count; i < l; i++) {
                                    point = new THREE.Vector3();
                                    point.fromBufferAttribute(attribute, i).applyMatrix4(node.matrixWorld);
                                    points.push(point);
                                }
                            }
                        }
                    }
                });
                return this.setFromPoints(points);
            },
            containsPoint: function (point) {
                var faces = this.faces;
                for (var i = 0, l = faces.length; i < l; i++) {
                    var face = faces[i];
                    if (face.distanceToPoint(point) > this.tolerance)
                        return false;
                }
                return true;
            },
            intersectRay: function (ray, target) {
                var faces = this.faces;
                var tNear = -Infinity;
                var tFar = Infinity;
                for (var i = 0, l = faces.length; i < l; i++) {
                    var face = faces[i];
                    var vN = face.distanceToPoint(ray.origin);
                    var vD = face.normal.dot(ray.direction);
                    if (vN > 0 && vD >= 0)
                        return null;
                    var t = vD !== 0 ? -vN / vD : 0;
                    if (t <= 0)
                        continue;
                    if (vD > 0) {
                        tFar = Math.min(t, tFar);
                    } else {
                        tNear = Math.max(t, tNear);
                    }
                    if (tNear > tFar) {
                        return null;
                    }
                }
                if (tNear !== -Infinity) {
                    ray.at(tNear, target);
                } else {
                    ray.at(tFar, target);
                }
                return target;
            },
            intersectsRay: function (ray) {
                return this.intersectRay(ray, v1) !== null;
            },
            makeEmpty: function () {
                this.faces = [];
                this.vertices = [];
                return this;
            },
            addVertexToFace: function (vertex, face) {
                vertex.face = face;
                if (face.outside === null) {
                    this.assigned.append(vertex);
                } else {
                    this.assigned.insertBefore(face.outside, vertex);
                }
                face.outside = vertex;
                return this;
            },
            removeVertexFromFace: function (vertex, face) {
                if (vertex === face.outside) {
                    if (vertex.next !== null && vertex.next.face === face) {
                        face.outside = vertex.next;
                    } else {
                        face.outside = null;
                    }
                }
                this.assigned.remove(vertex);
                return this;
            },
            removeAllVerticesFromFace: function (face) {
                if (face.outside !== null) {
                    var start = face.outside;
                    var end = face.outside;
                    while (end.next !== null && end.next.face === face) {
                        end = end.next;
                    }
                    this.assigned.removeSubList(start, end);
                    start.prev = end.next = null;
                    face.outside = null;
                    return start;
                }
            },
            deleteFaceVertices: function (face, absorbingFace) {
                var faceVertices = this.removeAllVerticesFromFace(face);
                if (faceVertices !== undefined) {
                    if (absorbingFace === undefined) {
                        this.unassigned.appendChain(faceVertices);
                    } else {
                        var vertex = faceVertices;
                        do {
                            var nextVertex = vertex.next;
                            var distance = absorbingFace.distanceToPoint(vertex.point);
                            if (distance > this.tolerance) {
                                this.addVertexToFace(vertex, absorbingFace);
                            } else {
                                this.unassigned.append(vertex);
                            }
                            vertex = nextVertex;
                        } while (vertex !== null);
                    }
                }
                return this;
            },
            resolveUnassignedPoints: function (newFaces) {
                if (this.unassigned.isEmpty() === false) {
                    var vertex = this.unassigned.first();
                    do {
                        var nextVertex = vertex.next;
                        var maxDistance = this.tolerance;
                        var maxFace = null;
                        for (var i = 0; i < newFaces.length; i++) {
                            var face = newFaces[i];
                            if (face.mark === Visible) {
                                var distance = face.distanceToPoint(vertex.point);
                                if (distance > maxDistance) {
                                    maxDistance = distance;
                                    maxFace = face;
                                }
                                if (maxDistance > 1000 * this.tolerance)
                                    break;
                            }
                        }
                        if (maxFace !== null) {
                            this.addVertexToFace(vertex, maxFace);
                        }
                        vertex = nextVertex;
                    } while (vertex !== null);
                }
                return this;
            },
            computeExtremes: function () {
                var min = new THREE.Vector3();
                var max = new THREE.Vector3();
                var minVertices = [];
                var maxVertices = [];
                var i, l, j;
                for (i = 0; i < 3; i++) {
                    minVertices[i] = maxVertices[i] = this.vertices[0];
                }
                min.copy(this.vertices[0].point);
                max.copy(this.vertices[0].point);
                for (i = 0, l = this.vertices.length; i < l; i++) {
                    var vertex = this.vertices[i];
                    var point = vertex.point;
                    for (j = 0; j < 3; j++) {
                        if (point.getComponent(j) < min.getComponent(j)) {
                            min.setComponent(j, point.getComponent(j));
                            minVertices[j] = vertex;
                        }
                    }
                    for (j = 0; j < 3; j++) {
                        if (point.getComponent(j) > max.getComponent(j)) {
                            max.setComponent(j, point.getComponent(j));
                            maxVertices[j] = vertex;
                        }
                    }
                }
                this.tolerance = 3 * Number.EPSILON * (Math.max(Math.abs(min.x), Math.abs(max.x)) + Math.max(Math.abs(min.y), Math.abs(max.y)) + Math.max(Math.abs(min.z), Math.abs(max.z)));
                return {
                    min: minVertices,
                    max: maxVertices
                };
            },
            computeInitialHull: function () {
                var line3, plane, closestPoint;
                return function computeInitialHull() {
                    if (line3 === undefined) {
                        line3 = new THREE.Line3();
                        plane = new THREE.Plane();
                        closestPoint = new THREE.Vector3();
                    }
                    var vertex, vertices = this.vertices;
                    var extremes = this.computeExtremes();
                    var min = extremes.min;
                    var max = extremes.max;
                    var v0, v1, v2, v3;
                    var i, l, j;
                    var distance, maxDistance = 0;
                    var index = 0;
                    for (i = 0; i < 3; i++) {
                        distance = max[i].point.getComponent(i) - min[i].point.getComponent(i);
                        if (distance > maxDistance) {
                            maxDistance = distance;
                            index = i;
                        }
                    }
                    v0 = min[index];
                    v1 = max[index];
                    maxDistance = 0;
                    line3.set(v0.point, v1.point);
                    for (i = 0, l = this.vertices.length; i < l; i++) {
                        vertex = vertices[i];
                        if (vertex !== v0 && vertex !== v1) {
                            line3.closestPointToPoint(vertex.point, true, closestPoint);
                            distance = closestPoint.distanceToSquared(vertex.point);
                            if (distance > maxDistance) {
                                maxDistance = distance;
                                v2 = vertex;
                            }
                        }
                    }
                    maxDistance = -1;
                    plane.setFromCoplanarPoints(v0.point, v1.point, v2.point);
                    for (i = 0, l = this.vertices.length; i < l; i++) {
                        vertex = vertices[i];
                        if (vertex !== v0 && vertex !== v1 && vertex !== v2) {
                            distance = Math.abs(plane.distanceToPoint(vertex.point));
                            if (distance > maxDistance) {
                                maxDistance = distance;
                                v3 = vertex;
                            }
                        }
                    }
                    var faces = [];
                    if (plane.distanceToPoint(v3.point) < 0) {
                        faces.push(Face.create(v0, v1, v2), Face.create(v3, v1, v0), Face.create(v3, v2, v1), Face.create(v3, v0, v2));
                        for (i = 0; i < 3; i++) {
                            j = (i + 1) % 3;
                            faces[i + 1].getEdge(2).setTwin(faces[0].getEdge(j));
                            faces[i + 1].getEdge(1).setTwin(faces[j + 1].getEdge(0));
                        }
                    } else {
                        faces.push(Face.create(v0, v2, v1), Face.create(v3, v0, v1), Face.create(v3, v1, v2), Face.create(v3, v2, v0));
                        for (i = 0; i < 3; i++) {
                            j = (i + 1) % 3;
                            faces[i + 1].getEdge(2).setTwin(faces[0].getEdge((3 - i) % 3));
                            faces[i + 1].getEdge(0).setTwin(faces[j + 1].getEdge(1));
                        }
                    }
                    for (i = 0; i < 4; i++) {
                        this.faces.push(faces[i]);
                    }
                    for (i = 0, l = vertices.length; i < l; i++) {
                        vertex = vertices[i];
                        if (vertex !== v0 && vertex !== v1 && vertex !== v2 && vertex !== v3) {
                            maxDistance = this.tolerance;
                            var maxFace = null;
                            for (j = 0; j < 4; j++) {
                                distance = this.faces[j].distanceToPoint(vertex.point);
                                if (distance > maxDistance) {
                                    maxDistance = distance;
                                    maxFace = this.faces[j];
                                }
                            }
                            if (maxFace !== null) {
                                this.addVertexToFace(vertex, maxFace);
                            }
                        }
                    }
                    return this;
                };
            }(),
            reindexFaces: function () {
                var activeFaces = [];
                for (var i = 0; i < this.faces.length; i++) {
                    var face = this.faces[i];
                    if (face.mark === Visible) {
                        activeFaces.push(face);
                    }
                }
                this.faces = activeFaces;
                return this;
            },
            nextVertexToAdd: function () {
                if (this.assigned.isEmpty() === false) {
                    var eyeVertex, maxDistance = 0;
                    var eyeFace = this.assigned.first().face;
                    var vertex = eyeFace.outside;
                    do {
                        var distance = eyeFace.distanceToPoint(vertex.point);
                        if (distance > maxDistance) {
                            maxDistance = distance;
                            eyeVertex = vertex;
                        }
                        vertex = vertex.next;
                    } while (vertex !== null && vertex.face === eyeFace);
                    return eyeVertex;
                }
            },
            computeHorizon: function (eyePoint, crossEdge, face, horizon) {
                this.deleteFaceVertices(face);
                face.mark = Deleted;
                var edge;
                if (crossEdge === null) {
                    edge = crossEdge = face.getEdge(0);
                } else {
                    edge = crossEdge.next;
                }
                do {
                    var twinEdge = edge.twin;
                    var oppositeFace = twinEdge.face;
                    if (oppositeFace.mark === Visible) {
                        if (oppositeFace.distanceToPoint(eyePoint) > this.tolerance) {
                            this.computeHorizon(eyePoint, twinEdge, oppositeFace, horizon);
                        } else {
                            horizon.push(edge);
                        }
                    }
                    edge = edge.next;
                } while (edge !== crossEdge);
                return this;
            },
            addAdjoiningFace: function (eyeVertex, horizonEdge) {
                var face = Face.create(eyeVertex, horizonEdge.tail(), horizonEdge.head());
                this.faces.push(face);
                face.getEdge(-1).setTwin(horizonEdge.twin);
                return face.getEdge(0);
            },
            addNewFaces: function (eyeVertex, horizon) {
                this.newFaces = [];
                var firstSideEdge = null;
                var previousSideEdge = null;
                for (var i = 0; i < horizon.length; i++) {
                    var horizonEdge = horizon[i];
                    var sideEdge = this.addAdjoiningFace(eyeVertex, horizonEdge);
                    if (firstSideEdge === null) {
                        firstSideEdge = sideEdge;
                    } else {
                        sideEdge.next.setTwin(previousSideEdge);
                    }
                    this.newFaces.push(sideEdge.face);
                    previousSideEdge = sideEdge;
                }
                firstSideEdge.next.setTwin(previousSideEdge);
                return this;
            },
            addVertexToHull: function (eyeVertex) {
                var horizon = [];
                this.unassigned.clear();
                this.removeVertexFromFace(eyeVertex, eyeVertex.face);
                this.computeHorizon(eyeVertex.point, null, eyeVertex.face, horizon);
                this.addNewFaces(eyeVertex, horizon);
                this.resolveUnassignedPoints(this.newFaces);
                return this;
            },
            cleanup: function () {
                this.assigned.clear();
                this.unassigned.clear();
                this.newFaces = [];
                return this;
            },
            compute: function () {
                var vertex;
                this.computeInitialHull();
                while ((vertex = this.nextVertexToAdd()) !== undefined) {
                    this.addVertexToHull(vertex);
                }
                this.reindexFaces();
                this.cleanup();
                return this;
            }
        });
        function Face() {
            this.normal = new THREE.Vector3();
            this.midpoint = new THREE.Vector3();
            this.area = 0;
            this.constant = 0;
            this.outside = null;
            this.mark = Visible;
            this.edge = null;
        }
        Object.assign(Face, {
            create: function (a, b, c) {
                var face = new Face();
                var e0 = new HalfEdge(a, face);
                var e1 = new HalfEdge(b, face);
                var e2 = new HalfEdge(c, face);
                e0.next = e2.prev = e1;
                e1.next = e0.prev = e2;
                e2.next = e1.prev = e0;
                face.edge = e0;
                return face.compute();
            }
        });
        Object.assign(Face.prototype, {
            getEdge: function (i) {
                var edge = this.edge;
                while (i > 0) {
                    edge = edge.next;
                    i--;
                }
                while (i < 0) {
                    edge = edge.prev;
                    i++;
                }
                return edge;
            },
            compute: function () {
                var triangle;
                return function compute() {
                    if (triangle === undefined)
                        triangle = new THREE.Triangle();
                    var a = this.edge.tail();
                    var b = this.edge.head();
                    var c = this.edge.next.head();
                    triangle.set(a.point, b.point, c.point);
                    triangle.getNormal(this.normal);
                    triangle.getMidpoint(this.midpoint);
                    this.area = triangle.getArea();
                    this.constant = this.normal.dot(this.midpoint);
                    return this;
                };
            }(),
            distanceToPoint: function (point) {
                return this.normal.dot(point) - this.constant;
            }
        });
        function HalfEdge(vertex, face) {
            this.vertex = vertex;
            this.prev = null;
            this.next = null;
            this.twin = null;
            this.face = face;
        }
        Object.assign(HalfEdge.prototype, {
            head: function () {
                return this.vertex;
            },
            tail: function () {
                return this.prev ? this.prev.vertex : null;
            },
            length: function () {
                var head = this.head();
                var tail = this.tail();
                if (tail !== null) {
                    return tail.point.distanceTo(head.point);
                }
                return -1;
            },
            lengthSquared: function () {
                var head = this.head();
                var tail = this.tail();
                if (tail !== null) {
                    return tail.point.distanceToSquared(head.point);
                }
                return -1;
            },
            setTwin: function (edge) {
                this.twin = edge;
                edge.twin = this;
                return this;
            }
        });
        function VertexNode(point) {
            this.point = point;
            this.prev = null;
            this.next = null;
            this.face = null;
        }
        function VertexList() {
            this.head = null;
            this.tail = null;
        }
        Object.assign(VertexList.prototype, {
            first: function () {
                return this.head;
            },
            last: function () {
                return this.tail;
            },
            clear: function () {
                this.head = this.tail = null;
                return this;
            },
            insertBefore: function (target, vertex) {
                vertex.prev = target.prev;
                vertex.next = target;
                if (vertex.prev === null) {
                    this.head = vertex;
                } else {
                    vertex.prev.next = vertex;
                }
                target.prev = vertex;
                return this;
            },
            insertAfter: function (target, vertex) {
                vertex.prev = target;
                vertex.next = target.next;
                if (vertex.next === null) {
                    this.tail = vertex;
                } else {
                    vertex.next.prev = vertex;
                }
                target.next = vertex;
                return this;
            },
            append: function (vertex) {
                if (this.head === null) {
                    this.head = vertex;
                } else {
                    this.tail.next = vertex;
                }
                vertex.prev = this.tail;
                vertex.next = null;
                this.tail = vertex;
                return this;
            },
            appendChain: function (vertex) {
                if (this.head === null) {
                    this.head = vertex;
                } else {
                    this.tail.next = vertex;
                }
                vertex.prev = this.tail;
                while (vertex.next !== null) {
                    vertex = vertex.next;
                }
                this.tail = vertex;
                return this;
            },
            remove: function (vertex) {
                if (vertex.prev === null) {
                    this.head = vertex.next;
                } else {
                    vertex.prev.next = vertex.next;
                }
                if (vertex.next === null) {
                    this.tail = vertex.prev;
                } else {
                    vertex.next.prev = vertex.prev;
                }
                return this;
            },
            removeSubList: function (a, b) {
                if (a.prev === null) {
                    this.head = b.next;
                } else {
                    a.prev.next = b.next;
                }
                if (b.next === null) {
                    this.tail = a.prev;
                } else {
                    b.next.prev = a.prev;
                }
                return this;
            },
            isEmpty: function () {
                return this.head === null;
            }
        });
        return ConvexHull;
    }();

    return threex.math.ConvexHull = ConvexHull;
});
define('skylark-threejs-ex/geometries/ConvexBufferGeometry',[
    "skylark-threejs",
    "../threex",
    '../math/ConvexHull'
], function (
    THREE, 
    threex,
    ConvexHull
) {
    'use strict';
    var ConvexBufferGeometry = function (points) {
        THREE.BufferGeometry.call(this);
        var vertices = [];
        var normals = [];
        if (ConvexHull === undefined) {
            console.error('THREE.ConvexBufferGeometry: ConvexBufferGeometry relies on ConvexHull');
        }
        var convexHull = new ConvexHull().setFromPoints(points);
        var faces = convexHull.faces;
        for (var i = 0; i < faces.length; i++) {
            var face = faces[i];
            var edge = face.edge;
            do {
                var point = edge.head().point;
                vertices.push(point.x, point.y, point.z);
                normals.push(face.normal.x, face.normal.y, face.normal.z);
                edge = edge.next;
            } while (edge !== face.edge);
        }
        this.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
        this.setAttribute('normal', new THREE.Float32BufferAttribute(normals, 3));
    };
    ConvexBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);
    ConvexBufferGeometry.prototype.constructor = ConvexBufferGeometry;

    return threex.geometries.ConvexBufferGeometry = ConvexBufferGeometry;
});
define('skylark-threejs-ex/geometries/ConvexGeometry',[
    "skylark-threejs",
    "../threex",
    '../math/ConvexHull'
], function (
    THREE,
    threex,
    ConvexHullb
) {
    'use strict';
    var ConvexGeometry = function (points) {
        THREE.Geometry.call(this);
        this.fromBufferGeometry(new ConvexBufferGeometry(points));
        this.mergeVertices();
    };
    ConvexGeometry.prototype = Object.create(THREE.Geometry.prototype);
    ConvexGeometry.prototype.constructor = ConvexGeometry;

    return threex.geometries.ConvexGeometry = ConvexGeometry;
});
define('skylark-threejs-ex/geometries/DecalGeometry',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var DecalGeometry = function (mesh, position, orientation, size) {
        THREE.BufferGeometry.call(this);
        var vertices = [];
        var normals = [];
        var uvs = [];
        var plane = new THREE.Vector3();
        var projectorMatrix = new THREE.Matrix4();
        projectorMatrix.makeRotationFromEuler(orientation);
        projectorMatrix.setPosition(position);
        var projectorMatrixInverse = new THREE.Matrix4().getInverse(projectorMatrix);
        generate();
        this.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
        this.setAttribute('normal', new THREE.Float32BufferAttribute(normals, 3));
        this.setAttribute('uv', new THREE.Float32BufferAttribute(uvs, 2));
        function generate() {
            var i;
            var geometry = new THREE.BufferGeometry();
            var decalVertices = [];
            var vertex = new THREE.Vector3();
            var normal = new THREE.Vector3();
            if (mesh.geometry.isGeometry) {
                geometry.fromGeometry(mesh.geometry);
            } else {
                geometry.copy(mesh.geometry);
            }
            var positionAttribute = geometry.attributes.position;
            var normalAttribute = geometry.attributes.normal;
            if (geometry.index !== null) {
                var index = geometry.index;
                for (i = 0; i < index.count; i++) {
                    vertex.fromBufferAttribute(positionAttribute, index.getX(i));
                    normal.fromBufferAttribute(normalAttribute, index.getX(i));
                    pushDecalVertex(decalVertices, vertex, normal);
                }
            } else {
                for (i = 0; i < positionAttribute.count; i++) {
                    vertex.fromBufferAttribute(positionAttribute, i);
                    normal.fromBufferAttribute(normalAttribute, i);
                    pushDecalVertex(decalVertices, vertex, normal);
                }
            }
            decalVertices = clipGeometry(decalVertices, plane.set(1, 0, 0));
            decalVertices = clipGeometry(decalVertices, plane.set(-1, 0, 0));
            decalVertices = clipGeometry(decalVertices, plane.set(0, 1, 0));
            decalVertices = clipGeometry(decalVertices, plane.set(0, -1, 0));
            decalVertices = clipGeometry(decalVertices, plane.set(0, 0, 1));
            decalVertices = clipGeometry(decalVertices, plane.set(0, 0, -1));
            for (i = 0; i < decalVertices.length; i++) {
                var decalVertex = decalVertices[i];
                uvs.push(0.5 + decalVertex.position.x / size.x, 0.5 + decalVertex.position.y / size.y);
                decalVertex.position.applyMatrix4(projectorMatrix);
                vertices.push(decalVertex.position.x, decalVertex.position.y, decalVertex.position.z);
                normals.push(decalVertex.normal.x, decalVertex.normal.y, decalVertex.normal.z);
            }
        }
        function pushDecalVertex(decalVertices, vertex, normal) {
            vertex.applyMatrix4(mesh.matrixWorld);
            vertex.applyMatrix4(projectorMatrixInverse);
            normal.transformDirection(mesh.matrixWorld);
            decalVertices.push(new DecalVertex(vertex.clone(), normal.clone()));
        }
        function clipGeometry(inVertices, plane) {
            var outVertices = [];
            var s = 0.5 * Math.abs(size.dot(plane));
            for (var i = 0; i < inVertices.length; i += 3) {
                var v1Out, v2Out, v3Out, total = 0;
                var nV1, nV2, nV3, nV4;
                var d1 = inVertices[i + 0].position.dot(plane) - s;
                var d2 = inVertices[i + 1].position.dot(plane) - s;
                var d3 = inVertices[i + 2].position.dot(plane) - s;
                v1Out = d1 > 0;
                v2Out = d2 > 0;
                v3Out = d3 > 0;
                total = (v1Out ? 1 : 0) + (v2Out ? 1 : 0) + (v3Out ? 1 : 0);
                switch (total) {
                case 0: {
                        outVertices.push(inVertices[i]);
                        outVertices.push(inVertices[i + 1]);
                        outVertices.push(inVertices[i + 2]);
                        break;
                    }
                case 1: {
                        if (v1Out) {
                            nV1 = inVertices[i + 1];
                            nV2 = inVertices[i + 2];
                            nV3 = clip(inVertices[i], nV1, plane, s);
                            nV4 = clip(inVertices[i], nV2, plane, s);
                        }
                        if (v2Out) {
                            nV1 = inVertices[i];
                            nV2 = inVertices[i + 2];
                            nV3 = clip(inVertices[i + 1], nV1, plane, s);
                            nV4 = clip(inVertices[i + 1], nV2, plane, s);
                            outVertices.push(nV3);
                            outVertices.push(nV2.clone());
                            outVertices.push(nV1.clone());
                            outVertices.push(nV2.clone());
                            outVertices.push(nV3.clone());
                            outVertices.push(nV4);
                            break;
                        }
                        if (v3Out) {
                            nV1 = inVertices[i];
                            nV2 = inVertices[i + 1];
                            nV3 = clip(inVertices[i + 2], nV1, plane, s);
                            nV4 = clip(inVertices[i + 2], nV2, plane, s);
                        }
                        outVertices.push(nV1.clone());
                        outVertices.push(nV2.clone());
                        outVertices.push(nV3);
                        outVertices.push(nV4);
                        outVertices.push(nV3.clone());
                        outVertices.push(nV2.clone());
                        break;
                    }
                case 2: {
                        if (!v1Out) {
                            nV1 = inVertices[i].clone();
                            nV2 = clip(nV1, inVertices[i + 1], plane, s);
                            nV3 = clip(nV1, inVertices[i + 2], plane, s);
                            outVertices.push(nV1);
                            outVertices.push(nV2);
                            outVertices.push(nV3);
                        }
                        if (!v2Out) {
                            nV1 = inVertices[i + 1].clone();
                            nV2 = clip(nV1, inVertices[i + 2], plane, s);
                            nV3 = clip(nV1, inVertices[i], plane, s);
                            outVertices.push(nV1);
                            outVertices.push(nV2);
                            outVertices.push(nV3);
                        }
                        if (!v3Out) {
                            nV1 = inVertices[i + 2].clone();
                            nV2 = clip(nV1, inVertices[i], plane, s);
                            nV3 = clip(nV1, inVertices[i + 1], plane, s);
                            outVertices.push(nV1);
                            outVertices.push(nV2);
                            outVertices.push(nV3);
                        }
                        break;
                    }
                case 3: {
                        break;
                    }
                }
            }
            return outVertices;
        }
        function clip(v0, v1, p, s) {
            var d0 = v0.position.dot(p) - s;
            var d1 = v1.position.dot(p) - s;
            var s0 = d0 / (d0 - d1);
            var v = new DecalVertex(new THREE.Vector3(v0.position.x + s0 * (v1.position.x - v0.position.x), v0.position.y + s0 * (v1.position.y - v0.position.y), v0.position.z + s0 * (v1.position.z - v0.position.z)), new THREE.Vector3(v0.normal.x + s0 * (v1.normal.x - v0.normal.x), v0.normal.y + s0 * (v1.normal.y - v0.normal.y), v0.normal.z + s0 * (v1.normal.z - v0.normal.z)));
            return v;
        }
    };
    DecalGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);
    DecalGeometry.prototype.constructor = DecalGeometry;

    return threex.geometries.DecalGeometry = DecalGeometry;
});
define('skylark-threejs-ex/geometries/DecalVertex',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var DecalVertex = function (position, normal) {
        this.position = position;
        this.normal = normal;
    };
    DecalVertex.prototype.clone = function () {
        return new this.constructor(this.position.clone(), this.normal.clone());
    };

    return threex.geometries.DecalVertex = DecalVertex;
});
define('skylark-threejs-ex/math/SimplexNoise',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var SimplexNoise = function (r) {
        if (r == undefined)
            r = Math;
        this.grad3 = [
            [
                1,
                1,
                0
            ],
            [
                -1,
                1,
                0
            ],
            [
                1,
                -1,
                0
            ],
            [
                -1,
                -1,
                0
            ],
            [
                1,
                0,
                1
            ],
            [
                -1,
                0,
                1
            ],
            [
                1,
                0,
                -1
            ],
            [
                -1,
                0,
                -1
            ],
            [
                0,
                1,
                1
            ],
            [
                0,
                -1,
                1
            ],
            [
                0,
                1,
                -1
            ],
            [
                0,
                -1,
                -1
            ]
        ];
        this.grad4 = [
            [
                0,
                1,
                1,
                1
            ],
            [
                0,
                1,
                1,
                -1
            ],
            [
                0,
                1,
                -1,
                1
            ],
            [
                0,
                1,
                -1,
                -1
            ],
            [
                0,
                -1,
                1,
                1
            ],
            [
                0,
                -1,
                1,
                -1
            ],
            [
                0,
                -1,
                -1,
                1
            ],
            [
                0,
                -1,
                -1,
                -1
            ],
            [
                1,
                0,
                1,
                1
            ],
            [
                1,
                0,
                1,
                -1
            ],
            [
                1,
                0,
                -1,
                1
            ],
            [
                1,
                0,
                -1,
                -1
            ],
            [
                -1,
                0,
                1,
                1
            ],
            [
                -1,
                0,
                1,
                -1
            ],
            [
                -1,
                0,
                -1,
                1
            ],
            [
                -1,
                0,
                -1,
                -1
            ],
            [
                1,
                1,
                0,
                1
            ],
            [
                1,
                1,
                0,
                -1
            ],
            [
                1,
                -1,
                0,
                1
            ],
            [
                1,
                -1,
                0,
                -1
            ],
            [
                -1,
                1,
                0,
                1
            ],
            [
                -1,
                1,
                0,
                -1
            ],
            [
                -1,
                -1,
                0,
                1
            ],
            [
                -1,
                -1,
                0,
                -1
            ],
            [
                1,
                1,
                1,
                0
            ],
            [
                1,
                1,
                -1,
                0
            ],
            [
                1,
                -1,
                1,
                0
            ],
            [
                1,
                -1,
                -1,
                0
            ],
            [
                -1,
                1,
                1,
                0
            ],
            [
                -1,
                1,
                -1,
                0
            ],
            [
                -1,
                -1,
                1,
                0
            ],
            [
                -1,
                -1,
                -1,
                0
            ]
        ];
        this.p = [];
        for (var i = 0; i < 256; i++) {
            this.p[i] = Math.floor(r.random() * 256);
        }
        this.perm = [];
        for (var i = 0; i < 512; i++) {
            this.perm[i] = this.p[i & 255];
        }
        this.simplex = [
            [
                0,
                1,
                2,
                3
            ],
            [
                0,
                1,
                3,
                2
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                2,
                3,
                1
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                1,
                2,
                3,
                0
            ],
            [
                0,
                2,
                1,
                3
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                3,
                1,
                2
            ],
            [
                0,
                3,
                2,
                1
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                1,
                3,
                2,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                1,
                2,
                0,
                3
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                1,
                3,
                0,
                2
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                2,
                3,
                0,
                1
            ],
            [
                2,
                3,
                1,
                0
            ],
            [
                1,
                0,
                2,
                3
            ],
            [
                1,
                0,
                3,
                2
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                2,
                0,
                3,
                1
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                2,
                1,
                3,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                2,
                0,
                1,
                3
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                3,
                0,
                1,
                2
            ],
            [
                3,
                0,
                2,
                1
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                3,
                1,
                2,
                0
            ],
            [
                2,
                1,
                0,
                3
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                3,
                1,
                0,
                2
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                3,
                2,
                0,
                1
            ],
            [
                3,
                2,
                1,
                0
            ]
        ];
    };
    SimplexNoise.prototype.dot = function (g, x, y) {
        return g[0] * x + g[1] * y;
    };
    SimplexNoise.prototype.dot3 = function (g, x, y, z) {
        return g[0] * x + g[1] * y + g[2] * z;
    };
    SimplexNoise.prototype.dot4 = function (g, x, y, z, w) {
        return g[0] * x + g[1] * y + g[2] * z + g[3] * w;
    };
    SimplexNoise.prototype.noise = function (xin, yin) {
        var n0, n1, n2;
        var F2 = 0.5 * (Math.sqrt(3) - 1);
        var s = (xin + yin) * F2;
        var i = Math.floor(xin + s);
        var j = Math.floor(yin + s);
        var G2 = (3 - Math.sqrt(3)) / 6;
        var t = (i + j) * G2;
        var X0 = i - t;
        var Y0 = j - t;
        var x0 = xin - X0;
        var y0 = yin - Y0;
        var i1, j1;
        if (x0 > y0) {
            i1 = 1;
            j1 = 0;
        } else {
            i1 = 0;
            j1 = 1;
        }
        var x1 = x0 - i1 + G2;
        var y1 = y0 - j1 + G2;
        var x2 = x0 - 1 + 2 * G2;
        var y2 = y0 - 1 + 2 * G2;
        var ii = i & 255;
        var jj = j & 255;
        var gi0 = this.perm[ii + this.perm[jj]] % 12;
        var gi1 = this.perm[ii + i1 + this.perm[jj + j1]] % 12;
        var gi2 = this.perm[ii + 1 + this.perm[jj + 1]] % 12;
        var t0 = 0.5 - x0 * x0 - y0 * y0;
        if (t0 < 0)
            n0 = 0;
        else {
            t0 *= t0;
            n0 = t0 * t0 * this.dot(this.grad3[gi0], x0, y0);
        }
        var t1 = 0.5 - x1 * x1 - y1 * y1;
        if (t1 < 0)
            n1 = 0;
        else {
            t1 *= t1;
            n1 = t1 * t1 * this.dot(this.grad3[gi1], x1, y1);
        }
        var t2 = 0.5 - x2 * x2 - y2 * y2;
        if (t2 < 0)
            n2 = 0;
        else {
            t2 *= t2;
            n2 = t2 * t2 * this.dot(this.grad3[gi2], x2, y2);
        }
        return 70 * (n0 + n1 + n2);
    };
    SimplexNoise.prototype.noise3d = function (xin, yin, zin) {
        var n0, n1, n2, n3;
        var F3 = 1 / 3;
        var s = (xin + yin + zin) * F3;
        var i = Math.floor(xin + s);
        var j = Math.floor(yin + s);
        var k = Math.floor(zin + s);
        var G3 = 1 / 6;
        var t = (i + j + k) * G3;
        var X0 = i - t;
        var Y0 = j - t;
        var Z0 = k - t;
        var x0 = xin - X0;
        var y0 = yin - Y0;
        var z0 = zin - Z0;
        var i1, j1, k1;
        var i2, j2, k2;
        if (x0 >= y0) {
            if (y0 >= z0) {
                i1 = 1;
                j1 = 0;
                k1 = 0;
                i2 = 1;
                j2 = 1;
                k2 = 0;
            } else if (x0 >= z0) {
                i1 = 1;
                j1 = 0;
                k1 = 0;
                i2 = 1;
                j2 = 0;
                k2 = 1;
            } else {
                i1 = 0;
                j1 = 0;
                k1 = 1;
                i2 = 1;
                j2 = 0;
                k2 = 1;
            }
        } else {
            if (y0 < z0) {
                i1 = 0;
                j1 = 0;
                k1 = 1;
                i2 = 0;
                j2 = 1;
                k2 = 1;
            } else if (x0 < z0) {
                i1 = 0;
                j1 = 1;
                k1 = 0;
                i2 = 0;
                j2 = 1;
                k2 = 1;
            } else {
                i1 = 0;
                j1 = 1;
                k1 = 0;
                i2 = 1;
                j2 = 1;
                k2 = 0;
            }
        }
        var x1 = x0 - i1 + G3;
        var y1 = y0 - j1 + G3;
        var z1 = z0 - k1 + G3;
        var x2 = x0 - i2 + 2 * G3;
        var y2 = y0 - j2 + 2 * G3;
        var z2 = z0 - k2 + 2 * G3;
        var x3 = x0 - 1 + 3 * G3;
        var y3 = y0 - 1 + 3 * G3;
        var z3 = z0 - 1 + 3 * G3;
        var ii = i & 255;
        var jj = j & 255;
        var kk = k & 255;
        var gi0 = this.perm[ii + this.perm[jj + this.perm[kk]]] % 12;
        var gi1 = this.perm[ii + i1 + this.perm[jj + j1 + this.perm[kk + k1]]] % 12;
        var gi2 = this.perm[ii + i2 + this.perm[jj + j2 + this.perm[kk + k2]]] % 12;
        var gi3 = this.perm[ii + 1 + this.perm[jj + 1 + this.perm[kk + 1]]] % 12;
        var t0 = 0.6 - x0 * x0 - y0 * y0 - z0 * z0;
        if (t0 < 0)
            n0 = 0;
        else {
            t0 *= t0;
            n0 = t0 * t0 * this.dot3(this.grad3[gi0], x0, y0, z0);
        }
        var t1 = 0.6 - x1 * x1 - y1 * y1 - z1 * z1;
        if (t1 < 0)
            n1 = 0;
        else {
            t1 *= t1;
            n1 = t1 * t1 * this.dot3(this.grad3[gi1], x1, y1, z1);
        }
        var t2 = 0.6 - x2 * x2 - y2 * y2 - z2 * z2;
        if (t2 < 0)
            n2 = 0;
        else {
            t2 *= t2;
            n2 = t2 * t2 * this.dot3(this.grad3[gi2], x2, y2, z2);
        }
        var t3 = 0.6 - x3 * x3 - y3 * y3 - z3 * z3;
        if (t3 < 0)
            n3 = 0;
        else {
            t3 *= t3;
            n3 = t3 * t3 * this.dot3(this.grad3[gi3], x3, y3, z3);
        }
        return 32 * (n0 + n1 + n2 + n3);
    };
    SimplexNoise.prototype.noise4d = function (x, y, z, w) {
        var grad4 = this.grad4;
        var simplex = this.simplex;
        var perm = this.perm;
        var F4 = (Math.sqrt(5) - 1) / 4;
        var G4 = (5 - Math.sqrt(5)) / 20;
        var n0, n1, n2, n3, n4;
        var s = (x + y + z + w) * F4;
        var i = Math.floor(x + s);
        var j = Math.floor(y + s);
        var k = Math.floor(z + s);
        var l = Math.floor(w + s);
        var t = (i + j + k + l) * G4;
        var X0 = i - t;
        var Y0 = j - t;
        var Z0 = k - t;
        var W0 = l - t;
        var x0 = x - X0;
        var y0 = y - Y0;
        var z0 = z - Z0;
        var w0 = w - W0;
        var c1 = x0 > y0 ? 32 : 0;
        var c2 = x0 > z0 ? 16 : 0;
        var c3 = y0 > z0 ? 8 : 0;
        var c4 = x0 > w0 ? 4 : 0;
        var c5 = y0 > w0 ? 2 : 0;
        var c6 = z0 > w0 ? 1 : 0;
        var c = c1 + c2 + c3 + c4 + c5 + c6;
        var i1, j1, k1, l1;
        var i2, j2, k2, l2;
        var i3, j3, k3, l3;
        i1 = simplex[c][0] >= 3 ? 1 : 0;
        j1 = simplex[c][1] >= 3 ? 1 : 0;
        k1 = simplex[c][2] >= 3 ? 1 : 0;
        l1 = simplex[c][3] >= 3 ? 1 : 0;
        i2 = simplex[c][0] >= 2 ? 1 : 0;
        j2 = simplex[c][1] >= 2 ? 1 : 0;
        k2 = simplex[c][2] >= 2 ? 1 : 0;
        l2 = simplex[c][3] >= 2 ? 1 : 0;
        i3 = simplex[c][0] >= 1 ? 1 : 0;
        j3 = simplex[c][1] >= 1 ? 1 : 0;
        k3 = simplex[c][2] >= 1 ? 1 : 0;
        l3 = simplex[c][3] >= 1 ? 1 : 0;
        var x1 = x0 - i1 + G4;
        var y1 = y0 - j1 + G4;
        var z1 = z0 - k1 + G4;
        var w1 = w0 - l1 + G4;
        var x2 = x0 - i2 + 2 * G4;
        var y2 = y0 - j2 + 2 * G4;
        var z2 = z0 - k2 + 2 * G4;
        var w2 = w0 - l2 + 2 * G4;
        var x3 = x0 - i3 + 3 * G4;
        var y3 = y0 - j3 + 3 * G4;
        var z3 = z0 - k3 + 3 * G4;
        var w3 = w0 - l3 + 3 * G4;
        var x4 = x0 - 1 + 4 * G4;
        var y4 = y0 - 1 + 4 * G4;
        var z4 = z0 - 1 + 4 * G4;
        var w4 = w0 - 1 + 4 * G4;
        var ii = i & 255;
        var jj = j & 255;
        var kk = k & 255;
        var ll = l & 255;
        var gi0 = perm[ii + perm[jj + perm[kk + perm[ll]]]] % 32;
        var gi1 = perm[ii + i1 + perm[jj + j1 + perm[kk + k1 + perm[ll + l1]]]] % 32;
        var gi2 = perm[ii + i2 + perm[jj + j2 + perm[kk + k2 + perm[ll + l2]]]] % 32;
        var gi3 = perm[ii + i3 + perm[jj + j3 + perm[kk + k3 + perm[ll + l3]]]] % 32;
        var gi4 = perm[ii + 1 + perm[jj + 1 + perm[kk + 1 + perm[ll + 1]]]] % 32;
        var t0 = 0.6 - x0 * x0 - y0 * y0 - z0 * z0 - w0 * w0;
        if (t0 < 0)
            n0 = 0;
        else {
            t0 *= t0;
            n0 = t0 * t0 * this.dot4(grad4[gi0], x0, y0, z0, w0);
        }
        var t1 = 0.6 - x1 * x1 - y1 * y1 - z1 * z1 - w1 * w1;
        if (t1 < 0)
            n1 = 0;
        else {
            t1 *= t1;
            n1 = t1 * t1 * this.dot4(grad4[gi1], x1, y1, z1, w1);
        }
        var t2 = 0.6 - x2 * x2 - y2 * y2 - z2 * z2 - w2 * w2;
        if (t2 < 0)
            n2 = 0;
        else {
            t2 *= t2;
            n2 = t2 * t2 * this.dot4(grad4[gi2], x2, y2, z2, w2);
        }
        var t3 = 0.6 - x3 * x3 - y3 * y3 - z3 * z3 - w3 * w3;
        if (t3 < 0)
            n3 = 0;
        else {
            t3 *= t3;
            n3 = t3 * t3 * this.dot4(grad4[gi3], x3, y3, z3, w3);
        }
        var t4 = 0.6 - x4 * x4 - y4 * y4 - z4 * z4 - w4 * w4;
        if (t4 < 0)
            n4 = 0;
        else {
            t4 *= t4;
            n4 = t4 * t4 * this.dot4(grad4[gi4], x4, y4, z4, w4);
        }
        return 27 * (n0 + n1 + n2 + n3 + n4);
    };

    return threex.math.SimplexNoise = SimplexNoise;
});
define('skylark-threejs-ex/geometries/LightningStrike',[
    "skylark-threejs",
    "../threex",
    '../math/SimplexNoise'
], function (
    THREE,
    threex, 
    SimplexNoise
) {
    'use strict';
    var LightningStrike = function (rayParameters) {
        THREE.BufferGeometry.call(this);
        this.type = 'LightningStrike';
        rayParameters = rayParameters || {};
        this.init(LightningStrike.copyParameters(rayParameters, rayParameters));
        this.createMesh();
    };
    LightningStrike.prototype = Object.create(THREE.BufferGeometry.prototype);
    LightningStrike.prototype.constructor = LightningStrike;
    LightningStrike.prototype.isLightningStrike = true;
    LightningStrike.RAY_INITIALIZED = 0;
    LightningStrike.RAY_UNBORN = 1;
    LightningStrike.RAY_PROPAGATING = 2;
    LightningStrike.RAY_STEADY = 3;
    LightningStrike.RAY_VANISHING = 4;
    LightningStrike.RAY_EXTINGUISHED = 5;
    LightningStrike.COS30DEG = Math.cos(30 * Math.PI / 180);
    LightningStrike.SIN30DEG = Math.sin(30 * Math.PI / 180);
    LightningStrike.createRandomGenerator = function () {
        var numSeeds = 2053;
        var seeds = [];
        for (var i = 0; i < numSeeds; i++) {
            seeds.push(Math.random());
        }
        var generator = {
            currentSeed: 0,
            random: function () {
                var value = seeds[generator.currentSeed];
                generator.currentSeed = (generator.currentSeed + 1) % numSeeds;
                return value;
            },
            getSeed: function () {
                return generator.currentSeed / numSeeds;
            },
            setSeed: function (seed) {
                generator.currentSeed = Math.floor(seed * numSeeds) % numSeeds;
            }
        };
        return generator;
    };
    LightningStrike.copyParameters = function (dest, source) {
        source = source || {};
        dest = dest || {};
        var vecCopy = function (v) {
            if (source === dest) {
                return v;
            } else {
                return v.clone();
            }
        };
        dest.sourceOffset = source.sourceOffset !== undefined ? vecCopy(source.sourceOffset) : new THREE.Vector3(0, 100, 0), dest.destOffset = source.destOffset !== undefined ? vecCopy(source.destOffset) : new THREE.Vector3(0, 0, 0), dest.timeScale = source.timeScale !== undefined ? source.timeScale : 1, dest.roughness = source.roughness !== undefined ? source.roughness : 0.9, dest.straightness = source.straightness !== undefined ? source.straightness : 0.7, dest.up0 = source.up0 !== undefined ? vecCopy(source.up0) : new THREE.Vector3(0, 0, 1);
        dest.up1 = source.up1 !== undefined ? vecCopy(source.up1) : new THREE.Vector3(0, 0, 1), dest.radius0 = source.radius0 !== undefined ? source.radius0 : 1, dest.radius1 = source.radius1 !== undefined ? source.radius1 : 1, dest.radius0Factor = source.radius0Factor !== undefined ? source.radius0Factor : 0.5, dest.radius1Factor = source.radius1Factor !== undefined ? source.radius1Factor : 0.2, dest.minRadius = source.minRadius !== undefined ? source.minRadius : 0.2, dest.isEternal = source.isEternal !== undefined ? source.isEternal : source.birthTime === undefined || source.deathTime === undefined, dest.birthTime = source.birthTime, dest.deathTime = source.deathTime, dest.propagationTimeFactor = source.propagationTimeFactor !== undefined ? source.propagationTimeFactor : 0.1, dest.vanishingTimeFactor = source.vanishingTimeFactor !== undefined ? source.vanishingTimeFactor : 0.9, dest.subrayPeriod = source.subrayPeriod !== undefined ? source.subrayPeriod : 4, dest.subrayDutyCycle = source.subrayDutyCycle !== undefined ? source.subrayDutyCycle : 0.6;
        dest.maxIterations = source.maxIterations !== undefined ? source.maxIterations : 9;
        dest.isStatic = source.isStatic !== undefined ? source.isStatic : false;
        dest.ramification = source.ramification !== undefined ? source.ramification : 5;
        dest.maxSubrayRecursion = source.maxSubrayRecursion !== undefined ? source.maxSubrayRecursion : 3;
        dest.recursionProbability = source.recursionProbability !== undefined ? source.recursionProbability : 0.6;
        dest.generateUVs = source.generateUVs !== undefined ? source.generateUVs : false;
        dest.randomGenerator = source.randomGenerator, dest.noiseSeed = source.noiseSeed, dest.onDecideSubrayCreation = source.onDecideSubrayCreation, dest.onSubrayCreation = source.onSubrayCreation;
        return dest;
    };
    LightningStrike.prototype.update = function (time) {
        if (this.isStatic)
            return;
        if (this.rayParameters.isEternal || this.rayParameters.birthTime <= time && time <= this.rayParameters.deathTime) {
            this.updateMesh(time);
            if (time < this.subrays[0].endPropagationTime) {
                this.state = LightningStrike.RAY_PROPAGATING;
            } else if (time > this.subrays[0].beginVanishingTime) {
                this.state = LightningStrike.RAY_VANISHING;
            } else {
                this.state = LightningStrike.RAY_STEADY;
            }
            this.visible = true;
        } else {
            this.visible = false;
            if (time < this.rayParameters.birthTime) {
                this.state = LightningStrike.RAY_UNBORN;
            } else {
                this.state = LightningStrike.RAY_EXTINGUISHED;
            }
        }
    };
    LightningStrike.prototype.init = function (rayParameters) {
        this.rayParameters = rayParameters;
        this.maxIterations = rayParameters.maxIterations !== undefined ? Math.floor(rayParameters.maxIterations) : 9;
        rayParameters.maxIterations = this.maxIterations;
        this.isStatic = rayParameters.isStatic !== undefined ? rayParameters.isStatic : false;
        rayParameters.isStatic = this.isStatic;
        this.ramification = rayParameters.ramification !== undefined ? Math.floor(rayParameters.ramification) : 5;
        rayParameters.ramification = this.ramification;
        this.maxSubrayRecursion = rayParameters.maxSubrayRecursion !== undefined ? Math.floor(rayParameters.maxSubrayRecursion) : 3;
        rayParameters.maxSubrayRecursion = this.maxSubrayRecursion;
        this.recursionProbability = rayParameters.recursionProbability !== undefined ? rayParameters.recursionProbability : 0.6;
        rayParameters.recursionProbability = this.recursionProbability;
        this.generateUVs = rayParameters.generateUVs !== undefined ? rayParameters.generateUVs : false;
        rayParameters.generateUVs = this.generateUVs;
        if (rayParameters.randomGenerator !== undefined) {
            this.randomGenerator = rayParameters.randomGenerator;
            this.seedGenerator = rayParameters.randomGenerator;
            if (rayParameters.noiseSeed !== undefined) {
                this.seedGenerator.setSeed(rayParameters.noiseSeed);
            }
        } else {
            this.randomGenerator = LightningStrike.createRandomGenerator();
            this.seedGenerator = Math;
        }
        if (rayParameters.onDecideSubrayCreation !== undefined) {
            this.onDecideSubrayCreation = rayParameters.onDecideSubrayCreation;
        } else {
            this.createDefaultSubrayCreationCallbacks();
            if (rayParameters.onSubrayCreation !== undefined) {
                this.onSubrayCreation = rayParameters.onSubrayCreation;
            }
        }
        this.state = LightningStrike.RAY_INITIALIZED;
        this.maxSubrays = Math.ceil(1 + Math.pow(this.ramification, Math.max(0, this.maxSubrayRecursion - 1)));
        rayParameters.maxSubrays = this.maxSubrays;
        this.maxRaySegments = 2 * (1 << this.maxIterations);
        this.subrays = [];
        for (var i = 0; i < this.maxSubrays; i++) {
            this.subrays.push(this.createSubray());
        }
        this.raySegments = [];
        for (var i = 0; i < this.maxRaySegments; i++) {
            this.raySegments.push(this.createSegment());
        }
        this.time = 0;
        this.timeFraction = 0;
        this.currentSegmentCallback = null;
        this.currentCreateTriangleVertices = this.generateUVs ? this.createTriangleVerticesWithUVs : this.createTriangleVerticesWithoutUVs;
        this.numSubrays = 0;
        this.currentSubray = null;
        this.currentSegmentIndex = 0;
        this.isInitialSegment = false;
        this.subrayProbability = 0;
        this.currentVertex = 0;
        this.currentIndex = 0;
        this.currentCoordinate = 0;
        this.currentUVCoordinate = 0;
        this.vertices = null;
        this.uvs = null;
        this.indices = null;
        this.positionAttribute = null;
        this.uvsAttribute = null;
        this.simplexX = new SimplexNoise(this.seedGenerator);
        this.simplexY = new SimplexNoise(this.seedGenerator);
        this.simplexZ = new SimplexNoise(this.seedGenerator);
        this.forwards = new THREE.Vector3();
        this.forwardsFill = new THREE.Vector3();
        this.side = new THREE.Vector3();
        this.down = new THREE.Vector3();
        this.middlePos = new THREE.Vector3();
        this.middleLinPos = new THREE.Vector3();
        this.newPos = new THREE.Vector3();
        this.vPos = new THREE.Vector3();
        this.cross1 = new THREE.Vector3();
    };
    LightningStrike.prototype.createMesh = function () {
        var maxDrawableSegmentsPerSubRay = 1 << this.maxIterations;
        var maxVerts = 3 * (maxDrawableSegmentsPerSubRay + 1) * this.maxSubrays;
        var maxIndices = 18 * maxDrawableSegmentsPerSubRay * this.maxSubrays;
        this.vertices = new Float32Array(maxVerts * 3);
        this.indices = new Uint32Array(maxIndices);
        if (this.generateUVs) {
            this.uvs = new Float32Array(maxVerts * 2);
        }
        this.fillMesh(0);
        this.setIndex(new THREE.Uint32BufferAttribute(this.indices, 1));
        this.positionAttribute = new THREE.Float32BufferAttribute(this.vertices, 3);
        this.setAttribute('position', this.positionAttribute);
        if (this.generateUVs) {
            this.uvsAttribute = new THREE.Float32BufferAttribute(new Float32Array(this.uvs), 2);
            this.setAttribute('uv', this.uvsAttribute);
        }
        if (!this.isStatic) {
            this.index.usage = THREE.DynamicDrawUsage;
            this.positionAttribute.usage = THREE.DynamicDrawUsage;
            if (this.generateUVs) {
                this.uvsAttribute.usage = THREE.DynamicDrawUsage;
            }
        }
        this.vertices = this.positionAttribute.array;
        this.indices = this.index.array;
        if (this.generateUVs) {
            this.uvs = this.uvsAttribute.array;
        }
    };
    LightningStrike.prototype.updateMesh = function (time) {
        this.fillMesh(time);
        this.drawRange.count = this.currentIndex;
        this.index.needsUpdate = true;
        this.positionAttribute.needsUpdate = true;
        if (this.generateUVs) {
            this.uvsAttribute.needsUpdate = true;
        }
    };
    LightningStrike.prototype.fillMesh = function (time) {
        var scope = this;
        this.currentVertex = 0;
        this.currentIndex = 0;
        this.currentCoordinate = 0;
        this.currentUVCoordinate = 0;
        this.fractalRay(time, function fillVertices(segment) {
            var subray = scope.currentSubray;
            if (time < subray.birthTime) {
                return;
            } else if (this.rayParameters.isEternal && scope.currentSubray.recursion == 0) {
                scope.createPrism(segment);
                scope.onDecideSubrayCreation(segment, scope);
            } else if (time < subray.endPropagationTime) {
                if (scope.timeFraction >= segment.fraction0 * subray.propagationTimeFactor) {
                    scope.createPrism(segment);
                    scope.onDecideSubrayCreation(segment, scope);
                }
            } else if (time < subray.beginVanishingTime) {
                scope.createPrism(segment);
                scope.onDecideSubrayCreation(segment, scope);
            } else {
                if (scope.timeFraction <= subray.vanishingTimeFactor + segment.fraction1 * (1 - subray.vanishingTimeFactor)) {
                    scope.createPrism(segment);
                }
                scope.onDecideSubrayCreation(segment, scope);
            }
        });
    };
    LightningStrike.prototype.addNewSubray = function () {
        return this.subrays[this.numSubrays++];
    };
    LightningStrike.prototype.initSubray = function (subray, rayParameters) {
        subray.pos0.copy(rayParameters.sourceOffset);
        subray.pos1.copy(rayParameters.destOffset);
        subray.up0.copy(rayParameters.up0);
        subray.up1.copy(rayParameters.up1);
        subray.radius0 = rayParameters.radius0;
        subray.radius1 = rayParameters.radius1;
        subray.birthTime = rayParameters.birthTime;
        subray.deathTime = rayParameters.deathTime;
        subray.timeScale = rayParameters.timeScale;
        subray.roughness = rayParameters.roughness;
        subray.straightness = rayParameters.straightness;
        subray.propagationTimeFactor = rayParameters.propagationTimeFactor;
        subray.vanishingTimeFactor = rayParameters.vanishingTimeFactor;
        subray.maxIterations = this.maxIterations;
        subray.seed = rayParameters.noiseSeed !== undefined ? rayParameters.noiseSeed : 0;
        subray.recursion = 0;
    };
    LightningStrike.prototype.fractalRay = function (time, segmentCallback) {
        this.time = time;
        this.currentSegmentCallback = segmentCallback;
        this.numSubrays = 0;
        this.initSubray(this.addNewSubray(), this.rayParameters);
        for (var subrayIndex = 0; subrayIndex < this.numSubrays; subrayIndex++) {
            var subray = this.subrays[subrayIndex];
            this.currentSubray = subray;
            this.randomGenerator.setSeed(subray.seed);
            subray.endPropagationTime = THREE.MathUtils.lerp(subray.birthTime, subray.deathTime, subray.propagationTimeFactor);
            subray.beginVanishingTime = THREE.MathUtils.lerp(subray.deathTime, subray.birthTime, 1 - subray.vanishingTimeFactor);
            var random1 = this.randomGenerator.random;
            subray.linPos0.set(random1(), random1(), random1()).multiplyScalar(1000);
            subray.linPos1.set(random1(), random1(), random1()).multiplyScalar(1000);
            this.timeFraction = (time - subray.birthTime) / (subray.deathTime - subray.birthTime);
            this.currentSegmentIndex = 0;
            this.isInitialSegment = true;
            var segment = this.getNewSegment();
            segment.iteration = 0;
            segment.pos0.copy(subray.pos0);
            segment.pos1.copy(subray.pos1);
            segment.linPos0.copy(subray.linPos0);
            segment.linPos1.copy(subray.linPos1);
            segment.up0.copy(subray.up0);
            segment.up1.copy(subray.up1);
            segment.radius0 = subray.radius0;
            segment.radius1 = subray.radius1;
            segment.fraction0 = 0;
            segment.fraction1 = 1;
            segment.positionVariationFactor = 1 - subray.straightness;
            this.subrayProbability = this.ramification * Math.pow(this.recursionProbability, subray.recursion) / (1 << subray.maxIterations);
            this.fractalRayRecursive(segment);
        }
        this.currentSegmentCallback = null;
        this.currentSubray = null;
    };
    LightningStrike.prototype.fractalRayRecursive = function (segment) {
        if (segment.iteration >= this.currentSubray.maxIterations) {
            this.currentSegmentCallback(segment);
            return;
        }
        this.forwards.subVectors(segment.pos1, segment.pos0);
        var lForwards = this.forwards.length();
        if (lForwards < 0.000001) {
            this.forwards.set(0, 0, 0.01);
            lForwards = this.forwards.length();
        }
        var middleRadius = (segment.radius0 + segment.radius1) * 0.5;
        var middleFraction = (segment.fraction0 + segment.fraction1) * 0.5;
        var timeDimension = this.time * this.currentSubray.timeScale * Math.pow(2, segment.iteration);
        this.middlePos.lerpVectors(segment.pos0, segment.pos1, 0.5);
        this.middleLinPos.lerpVectors(segment.linPos0, segment.linPos1, 0.5);
        var p = this.middleLinPos;
        this.newPos.set(this.simplexX.noise4d(p.x, p.y, p.z, timeDimension), this.simplexY.noise4d(p.x, p.y, p.z, timeDimension), this.simplexZ.noise4d(p.x, p.y, p.z, timeDimension));
        this.newPos.multiplyScalar(segment.positionVariationFactor * lForwards);
        this.newPos.add(this.middlePos);
        var newSegment1 = this.getNewSegment();
        newSegment1.pos0.copy(segment.pos0);
        newSegment1.pos1.copy(this.newPos);
        newSegment1.linPos0.copy(segment.linPos0);
        newSegment1.linPos1.copy(this.middleLinPos);
        newSegment1.up0.copy(segment.up0);
        newSegment1.up1.copy(segment.up1);
        newSegment1.radius0 = segment.radius0;
        newSegment1.radius1 = middleRadius;
        newSegment1.fraction0 = segment.fraction0;
        newSegment1.fraction1 = middleFraction;
        newSegment1.positionVariationFactor = segment.positionVariationFactor * this.currentSubray.roughness;
        newSegment1.iteration = segment.iteration + 1;
        var newSegment2 = this.getNewSegment();
        newSegment2.pos0.copy(this.newPos);
        newSegment2.pos1.copy(segment.pos1);
        newSegment2.linPos0.copy(this.middleLinPos);
        newSegment2.linPos1.copy(segment.linPos1);
        this.cross1.crossVectors(segment.up0, this.forwards.normalize());
        newSegment2.up0.crossVectors(this.forwards, this.cross1).normalize();
        newSegment2.up1.copy(segment.up1);
        newSegment2.radius0 = middleRadius;
        newSegment2.radius1 = segment.radius1;
        newSegment2.fraction0 = middleFraction;
        newSegment2.fraction1 = segment.fraction1;
        newSegment2.positionVariationFactor = segment.positionVariationFactor * this.currentSubray.roughness;
        newSegment2.iteration = segment.iteration + 1;
        this.fractalRayRecursive(newSegment1);
        this.fractalRayRecursive(newSegment2);
    };
    LightningStrike.prototype.createPrism = function (segment) {
        this.forwardsFill.subVectors(segment.pos1, segment.pos0).normalize();
        if (this.isInitialSegment) {
            this.currentCreateTriangleVertices(segment.pos0, segment.up0, this.forwardsFill, segment.radius0, 0);
            this.isInitialSegment = false;
        }
        this.currentCreateTriangleVertices(segment.pos1, segment.up0, this.forwardsFill, segment.radius1, segment.fraction1);
        this.createPrismFaces();
    };
    LightningStrike.prototype.createTriangleVerticesWithoutUVs = function (pos, up, forwards, radius) {
        this.side.crossVectors(up, forwards).multiplyScalar(radius * LightningStrike.COS30DEG);
        this.down.copy(up).multiplyScalar(-radius * LightningStrike.SIN30DEG);
        var p = this.vPos;
        var v = this.vertices;
        p.copy(pos).sub(this.side).add(this.down);
        v[this.currentCoordinate++] = p.x;
        v[this.currentCoordinate++] = p.y;
        v[this.currentCoordinate++] = p.z;
        p.copy(pos).add(this.side).add(this.down);
        v[this.currentCoordinate++] = p.x;
        v[this.currentCoordinate++] = p.y;
        v[this.currentCoordinate++] = p.z;
        p.copy(up).multiplyScalar(radius).add(pos);
        v[this.currentCoordinate++] = p.x;
        v[this.currentCoordinate++] = p.y;
        v[this.currentCoordinate++] = p.z;
        this.currentVertex += 3;
    };
    LightningStrike.prototype.createTriangleVerticesWithUVs = function (pos, up, forwards, radius, u) {
        this.side.crossVectors(up, forwards).multiplyScalar(radius * LightningStrike.COS30DEG);
        this.down.copy(up).multiplyScalar(-radius * LightningStrike.SIN30DEG);
        var p = this.vPos;
        var v = this.vertices;
        var uv = this.uvs;
        p.copy(pos).sub(this.side).add(this.down);
        v[this.currentCoordinate++] = p.x;
        v[this.currentCoordinate++] = p.y;
        v[this.currentCoordinate++] = p.z;
        uv[this.currentUVCoordinate++] = u;
        uv[this.currentUVCoordinate++] = 0;
        p.copy(pos).add(this.side).add(this.down);
        v[this.currentCoordinate++] = p.x;
        v[this.currentCoordinate++] = p.y;
        v[this.currentCoordinate++] = p.z;
        uv[this.currentUVCoordinate++] = u;
        uv[this.currentUVCoordinate++] = 0.5;
        p.copy(up).multiplyScalar(radius).add(pos);
        v[this.currentCoordinate++] = p.x;
        v[this.currentCoordinate++] = p.y;
        v[this.currentCoordinate++] = p.z;
        uv[this.currentUVCoordinate++] = u;
        uv[this.currentUVCoordinate++] = 1;
        this.currentVertex += 3;
    };
    LightningStrike.prototype.createPrismFaces = function (vertex) {
        var indices = this.indices;
        var vertex = this.currentVertex - 6;
        indices[this.currentIndex++] = vertex + 1;
        indices[this.currentIndex++] = vertex + 2;
        indices[this.currentIndex++] = vertex + 5;
        indices[this.currentIndex++] = vertex + 1;
        indices[this.currentIndex++] = vertex + 5;
        indices[this.currentIndex++] = vertex + 4;
        indices[this.currentIndex++] = vertex + 0;
        indices[this.currentIndex++] = vertex + 1;
        indices[this.currentIndex++] = vertex + 4;
        indices[this.currentIndex++] = vertex + 0;
        indices[this.currentIndex++] = vertex + 4;
        indices[this.currentIndex++] = vertex + 3;
        indices[this.currentIndex++] = vertex + 2;
        indices[this.currentIndex++] = vertex + 0;
        indices[this.currentIndex++] = vertex + 3;
        indices[this.currentIndex++] = vertex + 2;
        indices[this.currentIndex++] = vertex + 3;
        indices[this.currentIndex++] = vertex + 5;
    };
    LightningStrike.prototype.createDefaultSubrayCreationCallbacks = function () {
        var random1 = this.randomGenerator.random;
        this.onDecideSubrayCreation = function (segment, lightningStrike) {
            var subray = lightningStrike.currentSubray;
            var period = lightningStrike.rayParameters.subrayPeriod;
            var dutyCycle = lightningStrike.rayParameters.subrayDutyCycle;
            var phase0 = lightningStrike.rayParameters.isEternal && subray.recursion == 0 ? -random1() * period : THREE.MathUtils.lerp(subray.birthTime, subray.endPropagationTime, segment.fraction0) - random1() * period;
            var phase = lightningStrike.time - phase0;
            var currentCycle = Math.floor(phase / period);
            var childSubraySeed = random1() * (currentCycle + 1);
            var isActive = phase % period <= dutyCycle * period;
            var probability = 0;
            if (isActive) {
                probability = lightningStrike.subrayProbability;
            }
            if (subray.recursion < lightningStrike.maxSubrayRecursion && lightningStrike.numSubrays < lightningStrike.maxSubrays && random1() < probability) {
                var childSubray = lightningStrike.addNewSubray();
                var parentSeed = lightningStrike.randomGenerator.getSeed();
                childSubray.seed = childSubraySeed;
                lightningStrike.randomGenerator.setSeed(childSubraySeed);
                childSubray.recursion = subray.recursion + 1;
                childSubray.maxIterations = Math.max(1, subray.maxIterations - 1);
                childSubray.linPos0.set(random1(), random1(), random1()).multiplyScalar(1000);
                childSubray.linPos1.set(random1(), random1(), random1()).multiplyScalar(1000);
                childSubray.up0.copy(subray.up0);
                childSubray.up1.copy(subray.up1);
                childSubray.radius0 = segment.radius0 * lightningStrike.rayParameters.radius0Factor;
                childSubray.radius1 = Math.min(lightningStrike.rayParameters.minRadius, segment.radius1 * lightningStrike.rayParameters.radius1Factor);
                childSubray.birthTime = phase0 + currentCycle * period;
                childSubray.deathTime = childSubray.birthTime + period * dutyCycle;
                if (!lightningStrike.rayParameters.isEternal && subray.recursion == 0) {
                    childSubray.birthTime = Math.max(childSubray.birthTime, subray.birthTime);
                    childSubray.deathTime = Math.min(childSubray.deathTime, subray.deathTime);
                }
                childSubray.timeScale = subray.timeScale * 2;
                childSubray.roughness = subray.roughness;
                childSubray.straightness = subray.straightness;
                childSubray.propagationTimeFactor = subray.propagationTimeFactor;
                childSubray.vanishingTimeFactor = subray.vanishingTimeFactor;
                lightningStrike.onSubrayCreation(segment, subray, childSubray, lightningStrike);
                lightningStrike.randomGenerator.setSeed(parentSeed);
            }
        };
        var vec1Pos = new THREE.Vector3();
        var vec2Forward = new THREE.Vector3();
        var vec3Side = new THREE.Vector3();
        var vec4Up = new THREE.Vector3();
        this.onSubrayCreation = function (segment, parentSubray, childSubray, lightningStrike) {
            lightningStrike.subrayCylinderPosition(segment, parentSubray, childSubray, 0.5, 0.6, 0.2);
        };
        this.subrayConePosition = function (segment, parentSubray, childSubray, heightFactor, sideWidthFactor, minSideWidthFactor) {
            childSubray.pos0.copy(segment.pos0);
            vec1Pos.subVectors(parentSubray.pos1, parentSubray.pos0);
            vec2Forward.copy(vec1Pos).normalize();
            vec1Pos.multiplyScalar(segment.fraction0 + (1 - segment.fraction0) * (random1() * heightFactor));
            var length = vec1Pos.length();
            vec3Side.crossVectors(parentSubray.up0, vec2Forward);
            var angle = 2 * Math.PI * random1();
            vec3Side.multiplyScalar(Math.cos(angle));
            vec4Up.copy(parentSubray.up0).multiplyScalar(Math.sin(angle));
            childSubray.pos1.copy(vec3Side).add(vec4Up).multiplyScalar(length * sideWidthFactor * (minSideWidthFactor + random1() * (1 - minSideWidthFactor))).add(vec1Pos).add(parentSubray.pos0);
        };
        this.subrayCylinderPosition = function (segment, parentSubray, childSubray, heightFactor, sideWidthFactor, minSideWidthFactor) {
            childSubray.pos0.copy(segment.pos0);
            vec1Pos.subVectors(parentSubray.pos1, parentSubray.pos0);
            vec2Forward.copy(vec1Pos).normalize();
            vec1Pos.multiplyScalar(segment.fraction0 + (1 - segment.fraction0) * ((2 * random1() - 1) * heightFactor));
            var length = vec1Pos.length();
            vec3Side.crossVectors(parentSubray.up0, vec2Forward);
            var angle = 2 * Math.PI * random1();
            vec3Side.multiplyScalar(Math.cos(angle));
            vec4Up.copy(parentSubray.up0).multiplyScalar(Math.sin(angle));
            childSubray.pos1.copy(vec3Side).add(vec4Up).multiplyScalar(length * sideWidthFactor * (minSideWidthFactor + random1() * (1 - minSideWidthFactor))).add(vec1Pos).add(parentSubray.pos0);
        };
    };
    LightningStrike.prototype.createSubray = function () {
        return {
            seed: 0,
            maxIterations: 0,
            recursion: 0,
            pos0: new THREE.Vector3(),
            pos1: new THREE.Vector3(),
            linPos0: new THREE.Vector3(),
            linPos1: new THREE.Vector3(),
            up0: new THREE.Vector3(),
            up1: new THREE.Vector3(),
            radius0: 0,
            radius1: 0,
            birthTime: 0,
            deathTime: 0,
            timeScale: 0,
            roughness: 0,
            straightness: 0,
            propagationTimeFactor: 0,
            vanishingTimeFactor: 0,
            endPropagationTime: 0,
            beginVanishingTime: 0
        };
    };
    LightningStrike.prototype.createSegment = function () {
        return {
            iteration: 0,
            pos0: new THREE.Vector3(),
            pos1: new THREE.Vector3(),
            linPos0: new THREE.Vector3(),
            linPos1: new THREE.Vector3(),
            up0: new THREE.Vector3(),
            up1: new THREE.Vector3(),
            radius0: 0,
            radius1: 0,
            fraction0: 0,
            fraction1: 0,
            positionVariationFactor: 0
        };
    };
    LightningStrike.prototype.getNewSegment = function () {
        return this.raySegments[this.currentSegmentIndex++];
    };
    LightningStrike.prototype.copy = function (source) {
        THREE.BufferGeometry.prototype.copy.call(this, source);
        this.init(LightningStrike.copyParameters({}, source.rayParameters));
        return this;
    };
    LightningStrike.prototype.clone = function () {
        return new this.constructor(LightningStrike.copyParameters({}, this.rayParameters));
    };

    return threex.geometries.LightningStrike = LightningStrike;
});
define('skylark-threejs-ex/geometries/ParametricGeometries',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ParametricGeometries = {
        klein: function (v, u, target) {
            u *= Math.PI;
            v *= 2 * Math.PI;
            u = u * 2;
            var x, y, z;
            if (u < Math.PI) {
                x = 3 * Math.cos(u) * (1 + Math.sin(u)) + 2 * (1 - Math.cos(u) / 2) * Math.cos(u) * Math.cos(v);
                z = -8 * Math.sin(u) - 2 * (1 - Math.cos(u) / 2) * Math.sin(u) * Math.cos(v);
            } else {
                x = 3 * Math.cos(u) * (1 + Math.sin(u)) + 2 * (1 - Math.cos(u) / 2) * Math.cos(v + Math.PI);
                z = -8 * Math.sin(u);
            }
            y = -2 * (1 - Math.cos(u) / 2) * Math.sin(v);
            target.set(x, y, z);
        },
        plane: function (width, height) {
            return function (u, v, target) {
                var x = u * width;
                var y = 0;
                var z = v * height;
                target.set(x, y, z);
            };
        },
        mobius: function (u, t, target) {
            u = u - 0.5;
            var v = 2 * Math.PI * t;
            var x, y, z;
            var a = 2;
            x = Math.cos(v) * (a + u * Math.cos(v / 2));
            y = Math.sin(v) * (a + u * Math.cos(v / 2));
            z = u * Math.sin(v / 2);
            target.set(x, y, z);
        },
        mobius3d: function (u, t, target) {
            u *= Math.PI;
            t *= 2 * Math.PI;
            u = u * 2;
            var phi = u / 2;
            var major = 2.25, a = 0.125, b = 0.65;
            var x, y, z;
            x = a * Math.cos(t) * Math.cos(phi) - b * Math.sin(t) * Math.sin(phi);
            z = a * Math.cos(t) * Math.sin(phi) + b * Math.sin(t) * Math.cos(phi);
            y = (major + x) * Math.sin(u);
            x = (major + x) * Math.cos(u);
            target.set(x, y, z);
        }
    };
    ParametricGeometries.TubeGeometry = function (path, segments, radius, segmentsRadius, closed) {
        this.path = path;
        this.segments = segments || 64;
        this.radius = radius || 1;
        this.segmentsRadius = segmentsRadius || 8;
        this.closed = closed || false;
        var scope = this, numpoints = this.segments + 1;
        var frames = path.computeFrenetFrames(segments, closed), tangents = frames.tangents, normals = frames.normals, binormals = frames.binormals;
        this.tangents = tangents;
        this.normals = normals;
        this.binormals = binormals;
        var position = new THREE.Vector3();
        var ParametricTube = function (u, v, target) {
            v *= 2 * Math.PI;
            var i = u * (numpoints - 1);
            i = Math.floor(i);
            path.getPointAt(u, position);
            var normal = normals[i];
            var binormal = binormals[i];
            var cx = -scope.radius * Math.cos(v);
            var cy = scope.radius * Math.sin(v);
            position.x += cx * normal.x + cy * binormal.x;
            position.y += cx * normal.y + cy * binormal.y;
            position.z += cx * normal.z + cy * binormal.z;
            target.copy(position);
        };
        THREE.ParametricGeometry.call(this, ParametricTube, segments, segmentsRadius);
    };
    ParametricGeometries.TubeGeometry.prototype = Object.create(THREE.Geometry.prototype);
    ParametricGeometries.TubeGeometry.prototype.constructor = ParametricGeometries.TubeGeometry;
    ParametricGeometries.TorusKnotGeometry = function (radius, tube, segmentsT, segmentsR, p, q) {
        this.radius = radius || 200;
        this.tube = tube || 40;
        this.segmentsT = segmentsT || 64;
        this.segmentsR = segmentsR || 8;
        this.p = p || 2;
        this.q = q || 3;
        function TorusKnotCurve() {
            THREE.Curve.call(this);
        }
        TorusKnotCurve.prototype = Object.create(THREE.Curve.prototype);
        TorusKnotCurve.prototype.constructor = TorusKnotCurve;
        TorusKnotCurve.prototype.getPoint = function (t, optionalTarget) {
            var point = optionalTarget || new THREE.Vector3();
            t *= Math.PI * 2;
            var r = 0.5;
            var x = (1 + r * Math.cos(q * t)) * Math.cos(p * t);
            var y = (1 + r * Math.cos(q * t)) * Math.sin(p * t);
            var z = r * Math.sin(q * t);
            return point.set(x, y, z).multiplyScalar(radius);
        };
        var segments = segmentsT;
        var radiusSegments = segmentsR;
        var extrudePath = new TorusKnotCurve();
        ParametricGeometries.TubeGeometry.call(this, extrudePath, segments, tube, radiusSegments, true, false);
    };
    ParametricGeometries.TorusKnotGeometry.prototype = Object.create(THREE.Geometry.prototype);
    ParametricGeometries.TorusKnotGeometry.prototype.constructor = ParametricGeometries.TorusKnotGeometry;
    ParametricGeometries.SphereGeometry = function (size, u, v) {
        function sphere(u, v, target) {
            u *= Math.PI;
            v *= 2 * Math.PI;
            var x = size * Math.sin(u) * Math.cos(v);
            var y = size * Math.sin(u) * Math.sin(v);
            var z = size * Math.cos(u);
            target.set(x, y, z);
        }
        THREE.ParametricGeometry.call(this, sphere, u, v);
    };
    ParametricGeometries.SphereGeometry.prototype = Object.create(THREE.Geometry.prototype);
    ParametricGeometries.SphereGeometry.prototype.constructor = ParametricGeometries.SphereGeometry;
    ParametricGeometries.PlaneGeometry = function (width, depth, segmentsWidth, segmentsDepth) {
        function plane(u, v, target) {
            var x = u * width;
            var y = 0;
            var z = v * depth;
            target.set(x, y, z);
        }
        THREE.ParametricGeometry.call(this, plane, segmentsWidth, segmentsDepth);
    };
    ParametricGeometries.PlaneGeometry.prototype = Object.create(THREE.Geometry.prototype);
    ParametricGeometries.PlaneGeometry.prototype.constructor = ParametricGeometries.PlaneGeometry;

    return threex.geometries.ParametricGeometries = ParametricGeometries;
});
define('skylark-threejs-ex/geometries/TeapotBufferGeometry',[
   "skylark-threejs",
    "../threex",   
], function (
   THREE,
   threex
) {
    'use strict';
    var TeapotBufferGeometry = function (size, segments, bottom, lid, body, fitLid, blinn) {
        var teapotPatches = [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            3,
            16,
            17,
            18,
            7,
            19,
            20,
            21,
            11,
            22,
            23,
            24,
            15,
            25,
            26,
            27,
            18,
            28,
            29,
            30,
            21,
            31,
            32,
            33,
            24,
            34,
            35,
            36,
            27,
            37,
            38,
            39,
            30,
            40,
            41,
            0,
            33,
            42,
            43,
            4,
            36,
            44,
            45,
            8,
            39,
            46,
            47,
            12,
            12,
            13,
            14,
            15,
            48,
            49,
            50,
            51,
            52,
            53,
            54,
            55,
            56,
            57,
            58,
            59,
            15,
            25,
            26,
            27,
            51,
            60,
            61,
            62,
            55,
            63,
            64,
            65,
            59,
            66,
            67,
            68,
            27,
            37,
            38,
            39,
            62,
            69,
            70,
            71,
            65,
            72,
            73,
            74,
            68,
            75,
            76,
            77,
            39,
            46,
            47,
            12,
            71,
            78,
            79,
            48,
            74,
            80,
            81,
            52,
            77,
            82,
            83,
            56,
            56,
            57,
            58,
            59,
            84,
            85,
            86,
            87,
            88,
            89,
            90,
            91,
            92,
            93,
            94,
            95,
            59,
            66,
            67,
            68,
            87,
            96,
            97,
            98,
            91,
            99,
            100,
            101,
            95,
            102,
            103,
            104,
            68,
            75,
            76,
            77,
            98,
            105,
            106,
            107,
            101,
            108,
            109,
            110,
            104,
            111,
            112,
            113,
            77,
            82,
            83,
            56,
            107,
            114,
            115,
            84,
            110,
            116,
            117,
            88,
            113,
            118,
            119,
            92,
            120,
            121,
            122,
            123,
            124,
            125,
            126,
            127,
            128,
            129,
            130,
            131,
            132,
            133,
            134,
            135,
            123,
            136,
            137,
            120,
            127,
            138,
            139,
            124,
            131,
            140,
            141,
            128,
            135,
            142,
            143,
            132,
            132,
            133,
            134,
            135,
            144,
            145,
            146,
            147,
            148,
            149,
            150,
            151,
            68,
            152,
            153,
            154,
            135,
            142,
            143,
            132,
            147,
            155,
            156,
            144,
            151,
            157,
            158,
            148,
            154,
            159,
            160,
            68,
            161,
            162,
            163,
            164,
            165,
            166,
            167,
            168,
            169,
            170,
            171,
            172,
            173,
            174,
            175,
            176,
            164,
            177,
            178,
            161,
            168,
            179,
            180,
            165,
            172,
            181,
            182,
            169,
            176,
            183,
            184,
            173,
            173,
            174,
            175,
            176,
            185,
            186,
            187,
            188,
            189,
            190,
            191,
            192,
            193,
            194,
            195,
            196,
            176,
            183,
            184,
            173,
            188,
            197,
            198,
            185,
            192,
            199,
            200,
            189,
            196,
            201,
            202,
            193,
            203,
            203,
            203,
            203,
            204,
            205,
            206,
            207,
            208,
            208,
            208,
            208,
            209,
            210,
            211,
            212,
            203,
            203,
            203,
            203,
            207,
            213,
            214,
            215,
            208,
            208,
            208,
            208,
            212,
            216,
            217,
            218,
            203,
            203,
            203,
            203,
            215,
            219,
            220,
            221,
            208,
            208,
            208,
            208,
            218,
            222,
            223,
            224,
            203,
            203,
            203,
            203,
            221,
            225,
            226,
            204,
            208,
            208,
            208,
            208,
            224,
            227,
            228,
            209,
            209,
            210,
            211,
            212,
            229,
            230,
            231,
            232,
            233,
            234,
            235,
            236,
            237,
            238,
            239,
            240,
            212,
            216,
            217,
            218,
            232,
            241,
            242,
            243,
            236,
            244,
            245,
            246,
            240,
            247,
            248,
            249,
            218,
            222,
            223,
            224,
            243,
            250,
            251,
            252,
            246,
            253,
            254,
            255,
            249,
            256,
            257,
            258,
            224,
            227,
            228,
            209,
            252,
            259,
            260,
            229,
            255,
            261,
            262,
            233,
            258,
            263,
            264,
            237,
            265,
            265,
            265,
            265,
            266,
            267,
            268,
            269,
            270,
            271,
            272,
            273,
            92,
            119,
            118,
            113,
            265,
            265,
            265,
            265,
            269,
            274,
            275,
            276,
            273,
            277,
            278,
            279,
            113,
            112,
            111,
            104,
            265,
            265,
            265,
            265,
            276,
            280,
            281,
            282,
            279,
            283,
            284,
            285,
            104,
            103,
            102,
            95,
            265,
            265,
            265,
            265,
            282,
            286,
            287,
            266,
            285,
            288,
            289,
            270,
            95,
            94,
            93,
            92
        ];
        var teapotVertices = [
            1.4,
            0,
            2.4,
            1.4,
            -0.784,
            2.4,
            0.784,
            -1.4,
            2.4,
            0,
            -1.4,
            2.4,
            1.3375,
            0,
            2.53125,
            1.3375,
            -0.749,
            2.53125,
            0.749,
            -1.3375,
            2.53125,
            0,
            -1.3375,
            2.53125,
            1.4375,
            0,
            2.53125,
            1.4375,
            -0.805,
            2.53125,
            0.805,
            -1.4375,
            2.53125,
            0,
            -1.4375,
            2.53125,
            1.5,
            0,
            2.4,
            1.5,
            -0.84,
            2.4,
            0.84,
            -1.5,
            2.4,
            0,
            -1.5,
            2.4,
            -0.784,
            -1.4,
            2.4,
            -1.4,
            -0.784,
            2.4,
            -1.4,
            0,
            2.4,
            -0.749,
            -1.3375,
            2.53125,
            -1.3375,
            -0.749,
            2.53125,
            -1.3375,
            0,
            2.53125,
            -0.805,
            -1.4375,
            2.53125,
            -1.4375,
            -0.805,
            2.53125,
            -1.4375,
            0,
            2.53125,
            -0.84,
            -1.5,
            2.4,
            -1.5,
            -0.84,
            2.4,
            -1.5,
            0,
            2.4,
            -1.4,
            0.784,
            2.4,
            -0.784,
            1.4,
            2.4,
            0,
            1.4,
            2.4,
            -1.3375,
            0.749,
            2.53125,
            -0.749,
            1.3375,
            2.53125,
            0,
            1.3375,
            2.53125,
            -1.4375,
            0.805,
            2.53125,
            -0.805,
            1.4375,
            2.53125,
            0,
            1.4375,
            2.53125,
            -1.5,
            0.84,
            2.4,
            -0.84,
            1.5,
            2.4,
            0,
            1.5,
            2.4,
            0.784,
            1.4,
            2.4,
            1.4,
            0.784,
            2.4,
            0.749,
            1.3375,
            2.53125,
            1.3375,
            0.749,
            2.53125,
            0.805,
            1.4375,
            2.53125,
            1.4375,
            0.805,
            2.53125,
            0.84,
            1.5,
            2.4,
            1.5,
            0.84,
            2.4,
            1.75,
            0,
            1.875,
            1.75,
            -0.98,
            1.875,
            0.98,
            -1.75,
            1.875,
            0,
            -1.75,
            1.875,
            2,
            0,
            1.35,
            2,
            -1.12,
            1.35,
            1.12,
            -2,
            1.35,
            0,
            -2,
            1.35,
            2,
            0,
            0.9,
            2,
            -1.12,
            0.9,
            1.12,
            -2,
            0.9,
            0,
            -2,
            0.9,
            -0.98,
            -1.75,
            1.875,
            -1.75,
            -0.98,
            1.875,
            -1.75,
            0,
            1.875,
            -1.12,
            -2,
            1.35,
            -2,
            -1.12,
            1.35,
            -2,
            0,
            1.35,
            -1.12,
            -2,
            0.9,
            -2,
            -1.12,
            0.9,
            -2,
            0,
            0.9,
            -1.75,
            0.98,
            1.875,
            -0.98,
            1.75,
            1.875,
            0,
            1.75,
            1.875,
            -2,
            1.12,
            1.35,
            -1.12,
            2,
            1.35,
            0,
            2,
            1.35,
            -2,
            1.12,
            0.9,
            -1.12,
            2,
            0.9,
            0,
            2,
            0.9,
            0.98,
            1.75,
            1.875,
            1.75,
            0.98,
            1.875,
            1.12,
            2,
            1.35,
            2,
            1.12,
            1.35,
            1.12,
            2,
            0.9,
            2,
            1.12,
            0.9,
            2,
            0,
            0.45,
            2,
            -1.12,
            0.45,
            1.12,
            -2,
            0.45,
            0,
            -2,
            0.45,
            1.5,
            0,
            0.225,
            1.5,
            -0.84,
            0.225,
            0.84,
            -1.5,
            0.225,
            0,
            -1.5,
            0.225,
            1.5,
            0,
            0.15,
            1.5,
            -0.84,
            0.15,
            0.84,
            -1.5,
            0.15,
            0,
            -1.5,
            0.15,
            -1.12,
            -2,
            0.45,
            -2,
            -1.12,
            0.45,
            -2,
            0,
            0.45,
            -0.84,
            -1.5,
            0.225,
            -1.5,
            -0.84,
            0.225,
            -1.5,
            0,
            0.225,
            -0.84,
            -1.5,
            0.15,
            -1.5,
            -0.84,
            0.15,
            -1.5,
            0,
            0.15,
            -2,
            1.12,
            0.45,
            -1.12,
            2,
            0.45,
            0,
            2,
            0.45,
            -1.5,
            0.84,
            0.225,
            -0.84,
            1.5,
            0.225,
            0,
            1.5,
            0.225,
            -1.5,
            0.84,
            0.15,
            -0.84,
            1.5,
            0.15,
            0,
            1.5,
            0.15,
            1.12,
            2,
            0.45,
            2,
            1.12,
            0.45,
            0.84,
            1.5,
            0.225,
            1.5,
            0.84,
            0.225,
            0.84,
            1.5,
            0.15,
            1.5,
            0.84,
            0.15,
            -1.6,
            0,
            2.025,
            -1.6,
            -0.3,
            2.025,
            -1.5,
            -0.3,
            2.25,
            -1.5,
            0,
            2.25,
            -2.3,
            0,
            2.025,
            -2.3,
            -0.3,
            2.025,
            -2.5,
            -0.3,
            2.25,
            -2.5,
            0,
            2.25,
            -2.7,
            0,
            2.025,
            -2.7,
            -0.3,
            2.025,
            -3,
            -0.3,
            2.25,
            -3,
            0,
            2.25,
            -2.7,
            0,
            1.8,
            -2.7,
            -0.3,
            1.8,
            -3,
            -0.3,
            1.8,
            -3,
            0,
            1.8,
            -1.5,
            0.3,
            2.25,
            -1.6,
            0.3,
            2.025,
            -2.5,
            0.3,
            2.25,
            -2.3,
            0.3,
            2.025,
            -3,
            0.3,
            2.25,
            -2.7,
            0.3,
            2.025,
            -3,
            0.3,
            1.8,
            -2.7,
            0.3,
            1.8,
            -2.7,
            0,
            1.575,
            -2.7,
            -0.3,
            1.575,
            -3,
            -0.3,
            1.35,
            -3,
            0,
            1.35,
            -2.5,
            0,
            1.125,
            -2.5,
            -0.3,
            1.125,
            -2.65,
            -0.3,
            0.9375,
            -2.65,
            0,
            0.9375,
            -2,
            -0.3,
            0.9,
            -1.9,
            -0.3,
            0.6,
            -1.9,
            0,
            0.6,
            -3,
            0.3,
            1.35,
            -2.7,
            0.3,
            1.575,
            -2.65,
            0.3,
            0.9375,
            -2.5,
            0.3,
            1.125,
            -1.9,
            0.3,
            0.6,
            -2,
            0.3,
            0.9,
            1.7,
            0,
            1.425,
            1.7,
            -0.66,
            1.425,
            1.7,
            -0.66,
            0.6,
            1.7,
            0,
            0.6,
            2.6,
            0,
            1.425,
            2.6,
            -0.66,
            1.425,
            3.1,
            -0.66,
            0.825,
            3.1,
            0,
            0.825,
            2.3,
            0,
            2.1,
            2.3,
            -0.25,
            2.1,
            2.4,
            -0.25,
            2.025,
            2.4,
            0,
            2.025,
            2.7,
            0,
            2.4,
            2.7,
            -0.25,
            2.4,
            3.3,
            -0.25,
            2.4,
            3.3,
            0,
            2.4,
            1.7,
            0.66,
            0.6,
            1.7,
            0.66,
            1.425,
            3.1,
            0.66,
            0.825,
            2.6,
            0.66,
            1.425,
            2.4,
            0.25,
            2.025,
            2.3,
            0.25,
            2.1,
            3.3,
            0.25,
            2.4,
            2.7,
            0.25,
            2.4,
            2.8,
            0,
            2.475,
            2.8,
            -0.25,
            2.475,
            3.525,
            -0.25,
            2.49375,
            3.525,
            0,
            2.49375,
            2.9,
            0,
            2.475,
            2.9,
            -0.15,
            2.475,
            3.45,
            -0.15,
            2.5125,
            3.45,
            0,
            2.5125,
            2.8,
            0,
            2.4,
            2.8,
            -0.15,
            2.4,
            3.2,
            -0.15,
            2.4,
            3.2,
            0,
            2.4,
            3.525,
            0.25,
            2.49375,
            2.8,
            0.25,
            2.475,
            3.45,
            0.15,
            2.5125,
            2.9,
            0.15,
            2.475,
            3.2,
            0.15,
            2.4,
            2.8,
            0.15,
            2.4,
            0,
            0,
            3.15,
            0.8,
            0,
            3.15,
            0.8,
            -0.45,
            3.15,
            0.45,
            -0.8,
            3.15,
            0,
            -0.8,
            3.15,
            0,
            0,
            2.85,
            0.2,
            0,
            2.7,
            0.2,
            -0.112,
            2.7,
            0.112,
            -0.2,
            2.7,
            0,
            -0.2,
            2.7,
            -0.45,
            -0.8,
            3.15,
            -0.8,
            -0.45,
            3.15,
            -0.8,
            0,
            3.15,
            -0.112,
            -0.2,
            2.7,
            -0.2,
            -0.112,
            2.7,
            -0.2,
            0,
            2.7,
            -0.8,
            0.45,
            3.15,
            -0.45,
            0.8,
            3.15,
            0,
            0.8,
            3.15,
            -0.2,
            0.112,
            2.7,
            -0.112,
            0.2,
            2.7,
            0,
            0.2,
            2.7,
            0.45,
            0.8,
            3.15,
            0.8,
            0.45,
            3.15,
            0.112,
            0.2,
            2.7,
            0.2,
            0.112,
            2.7,
            0.4,
            0,
            2.55,
            0.4,
            -0.224,
            2.55,
            0.224,
            -0.4,
            2.55,
            0,
            -0.4,
            2.55,
            1.3,
            0,
            2.55,
            1.3,
            -0.728,
            2.55,
            0.728,
            -1.3,
            2.55,
            0,
            -1.3,
            2.55,
            1.3,
            0,
            2.4,
            1.3,
            -0.728,
            2.4,
            0.728,
            -1.3,
            2.4,
            0,
            -1.3,
            2.4,
            -0.224,
            -0.4,
            2.55,
            -0.4,
            -0.224,
            2.55,
            -0.4,
            0,
            2.55,
            -0.728,
            -1.3,
            2.55,
            -1.3,
            -0.728,
            2.55,
            -1.3,
            0,
            2.55,
            -0.728,
            -1.3,
            2.4,
            -1.3,
            -0.728,
            2.4,
            -1.3,
            0,
            2.4,
            -0.4,
            0.224,
            2.55,
            -0.224,
            0.4,
            2.55,
            0,
            0.4,
            2.55,
            -1.3,
            0.728,
            2.55,
            -0.728,
            1.3,
            2.55,
            0,
            1.3,
            2.55,
            -1.3,
            0.728,
            2.4,
            -0.728,
            1.3,
            2.4,
            0,
            1.3,
            2.4,
            0.224,
            0.4,
            2.55,
            0.4,
            0.224,
            2.55,
            0.728,
            1.3,
            2.55,
            1.3,
            0.728,
            2.55,
            0.728,
            1.3,
            2.4,
            1.3,
            0.728,
            2.4,
            0,
            0,
            0,
            1.425,
            0,
            0,
            1.425,
            0.798,
            0,
            0.798,
            1.425,
            0,
            0,
            1.425,
            0,
            1.5,
            0,
            0.075,
            1.5,
            0.84,
            0.075,
            0.84,
            1.5,
            0.075,
            0,
            1.5,
            0.075,
            -0.798,
            1.425,
            0,
            -1.425,
            0.798,
            0,
            -1.425,
            0,
            0,
            -0.84,
            1.5,
            0.075,
            -1.5,
            0.84,
            0.075,
            -1.5,
            0,
            0.075,
            -1.425,
            -0.798,
            0,
            -0.798,
            -1.425,
            0,
            0,
            -1.425,
            0,
            -1.5,
            -0.84,
            0.075,
            -0.84,
            -1.5,
            0.075,
            0,
            -1.5,
            0.075,
            0.798,
            -1.425,
            0,
            1.425,
            -0.798,
            0,
            0.84,
            -1.5,
            0.075,
            1.5,
            -0.84,
            0.075
        ];
        THREE.BufferGeometry.call(this);
        size = size || 50;
        segments = segments !== undefined ? Math.max(2, Math.floor(segments) || 10) : 10;
        bottom = bottom === undefined ? true : bottom;
        lid = lid === undefined ? true : lid;
        body = body === undefined ? true : body;
        fitLid = fitLid === undefined ? true : fitLid;
        var blinnScale = 1.3;
        blinn = blinn === undefined ? true : blinn;
        var maxHeight = 3.15 * (blinn ? 1 : blinnScale);
        var maxHeight2 = maxHeight / 2;
        var trueSize = size / maxHeight2;
        var numTriangles = bottom ? (8 * segments - 4) * segments : 0;
        numTriangles += lid ? (16 * segments - 4) * segments : 0;
        numTriangles += body ? 40 * segments * segments : 0;
        var indices = new Uint32Array(numTriangles * 3);
        var numVertices = bottom ? 4 : 0;
        numVertices += lid ? 8 : 0;
        numVertices += body ? 20 : 0;
        numVertices *= (segments + 1) * (segments + 1);
        var vertices = new Float32Array(numVertices * 3);
        var normals = new Float32Array(numVertices * 3);
        var uvs = new Float32Array(numVertices * 2);
        var ms = new THREE.Matrix4();
        ms.set(-1, 3, -3, 1, 3, -6, 3, 0, -3, 3, 0, 0, 1, 0, 0, 0);
        var g = [];
        var i, r, c;
        var sp = [];
        var tp = [];
        var dsp = [];
        var dtp = [];
        var mgm = [];
        var vert = [];
        var sdir = [];
        var tdir = [];
        var norm = new THREE.Vector3();
        var tcoord;
        var sstep, tstep;
        var vertPerRow;
        var s, t, sval, tval, p;
        var dsval = 0;
        var dtval = 0;
        var normOut = new THREE.Vector3();
        var v1, v2, v3, v4;
        var gmx = new THREE.Matrix4();
        var tmtx = new THREE.Matrix4();
        var vsp = new THREE.Vector4();
        var vtp = new THREE.Vector4();
        var vdsp = new THREE.Vector4();
        var vdtp = new THREE.Vector4();
        var vsdir = new THREE.Vector3();
        var vtdir = new THREE.Vector3();
        var mst = ms.clone();
        mst.transpose();
        var notDegenerate = function (vtx1, vtx2, vtx3) {
            return !(vertices[vtx1 * 3] === vertices[vtx2 * 3] && vertices[vtx1 * 3 + 1] === vertices[vtx2 * 3 + 1] && vertices[vtx1 * 3 + 2] === vertices[vtx2 * 3 + 2] || vertices[vtx1 * 3] === vertices[vtx3 * 3] && vertices[vtx1 * 3 + 1] === vertices[vtx3 * 3 + 1] && vertices[vtx1 * 3 + 2] === vertices[vtx3 * 3 + 2] || vertices[vtx2 * 3] === vertices[vtx3 * 3] && vertices[vtx2 * 3 + 1] === vertices[vtx3 * 3 + 1] && vertices[vtx2 * 3 + 2] === vertices[vtx3 * 3 + 2]);
        };
        for (i = 0; i < 3; i++) {
            mgm[i] = new THREE.Matrix4();
        }
        var minPatches = body ? 0 : 20;
        var maxPatches = bottom ? 32 : 28;
        vertPerRow = segments + 1;
        var surfCount = 0;
        var vertCount = 0;
        var normCount = 0;
        var uvCount = 0;
        var indexCount = 0;
        for (var surf = minPatches; surf < maxPatches; surf++) {
            if (lid || (surf < 20 || surf >= 28)) {
                for (i = 0; i < 3; i++) {
                    for (r = 0; r < 4; r++) {
                        for (c = 0; c < 4; c++) {
                            g[c * 4 + r] = teapotVertices[teapotPatches[surf * 16 + r * 4 + c] * 3 + i];
                            if (fitLid && (surf >= 20 && surf < 28) && i !== 2) {
                                g[c * 4 + r] *= 1.077;
                            }
                            if (!blinn && i === 2) {
                                g[c * 4 + r] *= blinnScale;
                            }
                        }
                    }
                    gmx.set(g[0], g[1], g[2], g[3], g[4], g[5], g[6], g[7], g[8], g[9], g[10], g[11], g[12], g[13], g[14], g[15]);
                    tmtx.multiplyMatrices(gmx, ms);
                    mgm[i].multiplyMatrices(mst, tmtx);
                }
                for (sstep = 0; sstep <= segments; sstep++) {
                    s = sstep / segments;
                    for (tstep = 0; tstep <= segments; tstep++) {
                        t = tstep / segments;
                        for (p = 4, sval = tval = 1; p--;) {
                            sp[p] = sval;
                            tp[p] = tval;
                            sval *= s;
                            tval *= t;
                            if (p === 3) {
                                dsp[p] = dtp[p] = 0;
                                dsval = dtval = 1;
                            } else {
                                dsp[p] = dsval * (3 - p);
                                dtp[p] = dtval * (3 - p);
                                dsval *= s;
                                dtval *= t;
                            }
                        }
                        vsp.fromArray(sp);
                        vtp.fromArray(tp);
                        vdsp.fromArray(dsp);
                        vdtp.fromArray(dtp);
                        for (i = 0; i < 3; i++) {
                            tcoord = vsp.clone();
                            tcoord.applyMatrix4(mgm[i]);
                            vert[i] = tcoord.dot(vtp);
                            tcoord = vdsp.clone();
                            tcoord.applyMatrix4(mgm[i]);
                            sdir[i] = tcoord.dot(vtp);
                            tcoord = vsp.clone();
                            tcoord.applyMatrix4(mgm[i]);
                            tdir[i] = tcoord.dot(vdtp);
                        }
                        vsdir.fromArray(sdir);
                        vtdir.fromArray(tdir);
                        norm.crossVectors(vtdir, vsdir);
                        norm.normalize();
                        if (vert[0] === 0 && vert[1] === 0) {
                            normOut.set(0, vert[2] > maxHeight2 ? 1 : -1, 0);
                        } else {
                            normOut.set(norm.x, norm.z, -norm.y);
                        }
                        vertices[vertCount++] = trueSize * vert[0];
                        vertices[vertCount++] = trueSize * (vert[2] - maxHeight2);
                        vertices[vertCount++] = -trueSize * vert[1];
                        normals[normCount++] = normOut.x;
                        normals[normCount++] = normOut.y;
                        normals[normCount++] = normOut.z;
                        uvs[uvCount++] = 1 - t;
                        uvs[uvCount++] = 1 - s;
                    }
                }
                for (sstep = 0; sstep < segments; sstep++) {
                    for (tstep = 0; tstep < segments; tstep++) {
                        v1 = surfCount * vertPerRow * vertPerRow + sstep * vertPerRow + tstep;
                        v2 = v1 + 1;
                        v3 = v2 + vertPerRow;
                        v4 = v1 + vertPerRow;
                        if (notDegenerate(v1, v2, v3)) {
                            indices[indexCount++] = v1;
                            indices[indexCount++] = v2;
                            indices[indexCount++] = v3;
                        }
                        if (notDegenerate(v1, v3, v4)) {
                            indices[indexCount++] = v1;
                            indices[indexCount++] = v3;
                            indices[indexCount++] = v4;
                        }
                    }
                }
                surfCount++;
            }
        }
        this.setIndex(new THREE.BufferAttribute(indices, 1));
        this.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
        this.setAttribute('normal', new THREE.BufferAttribute(normals, 3));
        this.setAttribute('uv', new THREE.BufferAttribute(uvs, 2));
        this.computeBoundingSphere();
    };
    TeapotBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);
    TeapotBufferGeometry.prototype.constructor = TeapotBufferGeometry;

    return threex.geometries.TeapotBufferGeometry = TeapotBufferGeometry;
});
define('skylark-threejs-ex/helpers/FaceNormalsHelper',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var _v1 = new THREE.Vector3();
    var _v2 = new THREE.Vector3();
    var _normalMatrix = new THREE.Matrix3();
    function FaceNormalsHelper(object, size, hex, linewidth) {
        this.object = object;
        this.size = size !== undefined ? size : 1;
        var color = hex !== undefined ? hex : 16776960;
        var width = linewidth !== undefined ? linewidth : 1;
        var nNormals = 0;
        var objGeometry = this.object.geometry;
        if (objGeometry && objGeometry.isGeometry) {
            nNormals = objGeometry.faces.length;
        } else {
            console.warn('THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.');
        }
        var geometry = new THREE.BufferGeometry();
        var positions = new THREE.Float32BufferAttribute(nNormals * 2 * 3, 3);
        geometry.setAttribute('position', positions);
        THREE.LineSegments.call(this, geometry, new THREE.LineBasicMaterial({
            color: color,
            linewidth: width
        }));
        this.matrixAutoUpdate = false;
        this.update();
    }
    FaceNormalsHelper.prototype = Object.create(THREE.LineSegments.prototype);
    FaceNormalsHelper.prototype.constructor = FaceNormalsHelper;
    FaceNormalsHelper.prototype.update = function () {
        this.object.updateMatrixWorld(true);
        _normalMatrix.getNormalMatrix(this.object.matrixWorld);
        var matrixWorld = this.object.matrixWorld;
        var position = this.geometry.attributes.position;
        var objGeometry = this.object.geometry;
        var vertices = objGeometry.vertices;
        var faces = objGeometry.faces;
        var idx = 0;
        for (var i = 0, l = faces.length; i < l; i++) {
            var face = faces[i];
            var normal = face.normal;
            _v1.copy(vertices[face.a]).add(vertices[face.b]).add(vertices[face.c]).divideScalar(3).applyMatrix4(matrixWorld);
            _v2.copy(normal).applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1);
            position.setXYZ(idx, _v1.x, _v1.y, _v1.z);
            idx = idx + 1;
            position.setXYZ(idx, _v2.x, _v2.y, _v2.z);
            idx = idx + 1;
        }
        position.needsUpdate = true;
    };

    return threex.helpers.FaceNormalsHelper = FaceNormalsHelper;
});
define('skylark-threejs-ex/helpers/LightProbeHelper',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    function LightProbeHelper(lightProbe, size) {
        this.lightProbe = lightProbe;
        this.size = size;
        var material = new THREE.ShaderMaterial({
            type: 'LightProbeHelperMaterial',
            uniforms: {
                sh: { value: this.lightProbe.sh.coefficients },
                intensity: { value: this.lightProbe.intensity }
            },
            vertexShader: [
                'varying vec3 vNormal;',
                'void main() {',
                '\tvNormal = normalize( normalMatrix * normal );',
                '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
                '}'
            ].join('\n'),
            fragmentShader: [
                '#define RECIPROCAL_PI 0.318309886',
                'vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {',
                '\t// matrix is assumed to be orthogonal',
                '\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );',
                '}',
                '// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf',
                'vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {',
                '\t// normal is assumed to have unit length',
                '\tfloat x = normal.x, y = normal.y, z = normal.z;',
                '\t// band 0',
                '\tvec3 result = shCoefficients[ 0 ] * 0.886227;',
                '\t// band 1',
                '\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;',
                '\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;',
                '\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;',
                '\t// band 2',
                '\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;',
                '\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;',
                '\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );',
                '\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;',
                '\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );',
                '\treturn result;',
                '}',
                'uniform vec3 sh[ 9 ]; // sh coefficients',
                'uniform float intensity; // light probe intensity',
                'varying vec3 vNormal;',
                'void main() {',
                '\tvec3 normal = normalize( vNormal );',
                '\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );',
                '\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );',
                '\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;',
                '\tgl_FragColor = linearToOutputTexel( vec4( outgoingLight, 1.0 ) );',
                '}'
            ].join('\n')
        });
        var geometry = new THREE.SphereBufferGeometry(1, 32, 16);
        THREE.Mesh.call(this, geometry, material);
        this.onBeforeRender();
    }
    LightProbeHelper.prototype = Object.create(THREE.Mesh.prototype);
    LightProbeHelper.prototype.constructor = LightProbeHelper;
    LightProbeHelper.prototype.dispose = function () {
        this.geometry.dispose();
        this.material.dispose();
    };
    LightProbeHelper.prototype.onBeforeRender = function () {
        this.position.copy(this.lightProbe.position);
        this.scale.set(1, 1, 1).multiplyScalar(this.size);
        this.material.uniforms.intensity.value = this.lightProbe.intensity;
    };
    
    return threex.helpers.LightProbeHelper = LightProbeHelper;
});
define('skylark-threejs-ex/helpers/PositionalAudioHelper',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    function PositionalAudioHelper(audio, range, divisionsInnerAngle, divisionsOuterAngle) {
        this.audio = audio;
        this.range = range || 1;
        this.divisionsInnerAngle = divisionsInnerAngle || 16;
        this.divisionsOuterAngle = divisionsOuterAngle || 2;
        var geometry = new THREE.BufferGeometry();
        var divisions = this.divisionsInnerAngle + this.divisionsOuterAngle * 2;
        var positions = new Float32Array((divisions * 3 + 3) * 3);
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        var materialInnerAngle = new THREE.LineBasicMaterial({ color: 65280 });
        var materialOuterAngle = new THREE.LineBasicMaterial({ color: 16776960 });
        THREE.Line.call(this, geometry, [
            materialOuterAngle,
            materialInnerAngle
        ]);
        this.update();
    }
    PositionalAudioHelper.prototype = Object.create(THREE.Line.prototype);
    PositionalAudioHelper.prototype.constructor = PositionalAudioHelper;
    PositionalAudioHelper.prototype.update = function () {
        var audio = this.audio;
        var range = this.range;
        var divisionsInnerAngle = this.divisionsInnerAngle;
        var divisionsOuterAngle = this.divisionsOuterAngle;
        var coneInnerAngle = THREE.MathUtils.degToRad(audio.panner.coneInnerAngle);
        var coneOuterAngle = THREE.MathUtils.degToRad(audio.panner.coneOuterAngle);
        var halfConeInnerAngle = coneInnerAngle / 2;
        var halfConeOuterAngle = coneOuterAngle / 2;
        var start = 0;
        var count = 0;
        var i, stride;
        var geometry = this.geometry;
        var positionAttribute = geometry.attributes.position;
        geometry.clearGroups();
        function generateSegment(from, to, divisions, materialIndex) {
            var step = (to - from) / divisions;
            positionAttribute.setXYZ(start, 0, 0, 0);
            count++;
            for (i = from; i < to; i += step) {
                stride = start + count;
                positionAttribute.setXYZ(stride, Math.sin(i) * range, 0, Math.cos(i) * range);
                positionAttribute.setXYZ(stride + 1, Math.sin(Math.min(i + step, to)) * range, 0, Math.cos(Math.min(i + step, to)) * range);
                positionAttribute.setXYZ(stride + 2, 0, 0, 0);
                count += 3;
            }
            geometry.addGroup(start, count, materialIndex);
            start += count;
            count = 0;
        }
        generateSegment(-halfConeOuterAngle, -halfConeInnerAngle, divisionsOuterAngle, 0);
        generateSegment(-halfConeInnerAngle, halfConeInnerAngle, divisionsInnerAngle, 1);
        generateSegment(halfConeInnerAngle, halfConeOuterAngle, divisionsOuterAngle, 0);
        positionAttribute.needsUpdate = true;
        if (coneInnerAngle === coneOuterAngle)
            this.material[0].visible = false;
    };
    PositionalAudioHelper.prototype.dispose = function () {
        this.geometry.dispose();
        this.material[0].dispose();
        this.material[1].dispose();
    };

    return threex.helpers.PositionalAudioHelper = PositionalAudioHelper;
});
define('skylark-threejs-ex/helpers/RectAreaLightHelper',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    function RectAreaLightHelper(light, color) {
        this.type = 'RectAreaLightHelper';
        this.light = light;
        this.color = color;
        var positions = [
            1,
            1,
            0,
            -1,
            1,
            0,
            -1,
            -1,
            0,
            1,
            -1,
            0,
            1,
            1,
            0
        ];
        var geometry = new THREE.BufferGeometry();
        geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
        geometry.computeBoundingSphere();
        var material = new THREE.LineBasicMaterial({ fog: false });
        THREE.Line.call(this, geometry, material);
        var positions2 = [
            1,
            1,
            0,
            -1,
            1,
            0,
            -1,
            -1,
            0,
            1,
            1,
            0,
            -1,
            -1,
            0,
            1,
            -1,
            0
        ];
        var geometry2 = new THREE.BufferGeometry();
        geometry2.setAttribute('position', new THREE.Float32BufferAttribute(positions2, 3));
        geometry2.computeBoundingSphere();
        this.add(new THREE.Mesh(geometry2, new THREE.MeshBasicMaterial({
            side: THREE.BackSide,
            fog: false
        })));
        this.update();
    }
    RectAreaLightHelper.prototype = Object.create(THREE.Line.prototype);
    RectAreaLightHelper.prototype.constructor = RectAreaLightHelper;
    RectAreaLightHelper.prototype.update = function () {
        this.scale.set(0.5 * this.light.width, 0.5 * this.light.height, 1);
        if (this.color !== undefined) {
            this.material.color.set(this.color);
            this.children[0].material.color.set(this.color);
        } else {
            this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);
            var c = this.material.color;
            var max = Math.max(c.r, c.g, c.b);
            if (max > 1)
                c.multiplyScalar(1 / max);
            this.children[0].material.color.copy(this.material.color);
        }
    };
    RectAreaLightHelper.prototype.dispose = function () {
        this.geometry.dispose();
        this.material.dispose();
        this.children[0].geometry.dispose();
        this.children[0].material.dispose();
    };

    return threex.helpers.RectAreaLightHelper = RectAreaLightHelper;
});
define('skylark-threejs-ex/helpers/VertexNormalsHelper',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var _v1 = new THREE.Vector3();
    var _v2 = new THREE.Vector3();
    var _normalMatrix = new THREE.Matrix3();
    var _keys = [
        'a',
        'b',
        'c'
    ];
    function VertexNormalsHelper(object, size, hex, linewidth) {
        this.object = object;
        this.size = size !== undefined ? size : 1;
        var color = hex !== undefined ? hex : 16711680;
        var width = linewidth !== undefined ? linewidth : 1;
        var nNormals = 0;
        var objGeometry = this.object.geometry;
        if (objGeometry && objGeometry.isGeometry) {
            nNormals = objGeometry.faces.length * 3;
        } else if (objGeometry && objGeometry.isBufferGeometry) {
            nNormals = objGeometry.attributes.normal.count;
        }
        var geometry = new THREE.BufferGeometry();
        var positions = new THREE.Float32BufferAttribute(nNormals * 2 * 3, 3);
        geometry.setAttribute('position', positions);
        THREE.LineSegments.call(this, geometry, new THREE.LineBasicMaterial({
            color: color,
            linewidth: width
        }));
        this.matrixAutoUpdate = false;
        this.update();
    }
    VertexNormalsHelper.prototype = Object.create(THREE.LineSegments.prototype);
    VertexNormalsHelper.prototype.constructor = VertexNormalsHelper;
    VertexNormalsHelper.prototype.update = function () {
        this.object.updateMatrixWorld(true);
        _normalMatrix.getNormalMatrix(this.object.matrixWorld);
        var matrixWorld = this.object.matrixWorld;
        var position = this.geometry.attributes.position;
        var objGeometry = this.object.geometry;
        if (objGeometry && objGeometry.isGeometry) {
            var vertices = objGeometry.vertices;
            var faces = objGeometry.faces;
            var idx = 0;
            for (var i = 0, l = faces.length; i < l; i++) {
                var face = faces[i];
                for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {
                    var vertex = vertices[face[_keys[j]]];
                    var normal = face.vertexNormals[j];
                    _v1.copy(vertex).applyMatrix4(matrixWorld);
                    _v2.copy(normal).applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1);
                    position.setXYZ(idx, _v1.x, _v1.y, _v1.z);
                    idx = idx + 1;
                    position.setXYZ(idx, _v2.x, _v2.y, _v2.z);
                    idx = idx + 1;
                }
            }
        } else if (objGeometry && objGeometry.isBufferGeometry) {
            var objPos = objGeometry.attributes.position;
            var objNorm = objGeometry.attributes.normal;
            var idx = 0;
            for (var j = 0, jl = objPos.count; j < jl; j++) {
                _v1.set(objPos.getX(j), objPos.getY(j), objPos.getZ(j)).applyMatrix4(matrixWorld);
                _v2.set(objNorm.getX(j), objNorm.getY(j), objNorm.getZ(j));
                _v2.applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1);
                position.setXYZ(idx, _v1.x, _v1.y, _v1.z);
                idx = idx + 1;
                position.setXYZ(idx, _v2.x, _v2.y, _v2.z);
                idx = idx + 1;
            }
        }
        position.needsUpdate = true;
    };
    
    return threex.helpers.VertexNormalsHelper = VertexNormalsHelper;
});
define('skylark-threejs-ex/helpers/VertexTangentsHelper',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var _v1 = new THREE.Vector3();
    var _v2 = new THREE.Vector3();
    function VertexTangentsHelper(object, size, hex, linewidth) {
        this.object = object;
        this.size = size !== undefined ? size : 1;
        var color = hex !== undefined ? hex : 65535;
        var width = linewidth !== undefined ? linewidth : 1;
        var objGeometry = this.object.geometry;
        if (!(objGeometry && objGeometry.isBufferGeometry)) {
            console.error('THREE.VertexTangentsHelper: geometry not an instance of THREE.BufferGeometry.', objGeometry);
            return;
        }
        var nTangents = objGeometry.attributes.tangent.count;
        var geometry = new THREE.BufferGeometry();
        var positions = new THREE.Float32BufferAttribute(nTangents * 2 * 3, 3);
        geometry.setAttribute('position', positions);
        THREE.LineSegments.call(this, geometry, new THREE.LineBasicMaterial({
            color: color,
            linewidth: width
        }));
        this.matrixAutoUpdate = false;
        this.update();
    }
    VertexTangentsHelper.prototype = Object.create(THREE.LineSegments.prototype);
    VertexTangentsHelper.prototype.constructor = VertexTangentsHelper;
    VertexTangentsHelper.prototype.update = function () {
        this.object.updateMatrixWorld(true);
        var matrixWorld = this.object.matrixWorld;
        var position = this.geometry.attributes.position;
        var objGeometry = this.object.geometry;
        var objPos = objGeometry.attributes.position;
        var objTan = objGeometry.attributes.tangent;
        var idx = 0;
        for (var j = 0, jl = objPos.count; j < jl; j++) {
            _v1.set(objPos.getX(j), objPos.getY(j), objPos.getZ(j)).applyMatrix4(matrixWorld);
            _v2.set(objTan.getX(j), objTan.getY(j), objTan.getZ(j));
            _v2.transformDirection(matrixWorld).multiplyScalar(this.size).add(_v1);
            position.setXYZ(idx, _v1.x, _v1.y, _v1.z);
            idx = idx + 1;
            position.setXYZ(idx, _v2.x, _v2.y, _v2.z);
            idx = idx + 1;
        }
        position.needsUpdate = true;
    };

    return threex.helpers.VertexTangentsHelper = VertexTangentsHelper;
});
define('skylark-threejs-ex/interactive/SelectionBox',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var SelectionBox = function () {
        var frustum = new THREE.Frustum();
        var center = new THREE.Vector3();
        var tmpPoint = new THREE.Vector3();
        var vecNear = new THREE.Vector3();
        var vecTopLeft = new THREE.Vector3();
        var vecTopRight = new THREE.Vector3();
        var vecDownRight = new THREE.Vector3();
        var vecDownLeft = new THREE.Vector3();
        var vecFarTopLeft = new THREE.Vector3();
        var vecFarTopRight = new THREE.Vector3();
        var vecFarDownRight = new THREE.Vector3();
        var vecFarDownLeft = new THREE.Vector3();
        var vectemp1 = new THREE.Vector3();
        var vectemp2 = new THREE.Vector3();
        var vectemp3 = new THREE.Vector3();
        function SelectionBox(camera, scene, deep) {
            this.camera = camera;
            this.scene = scene;
            this.startPoint = new THREE.Vector3();
            this.endPoint = new THREE.Vector3();
            this.collection = [];
            this.deep = deep || Number.MAX_VALUE;
        }
        SelectionBox.prototype.select = function (startPoint, endPoint) {
            this.startPoint = startPoint || this.startPoint;
            this.endPoint = endPoint || this.endPoint;
            this.collection = [];
            this.updateFrustum(this.startPoint, this.endPoint);
            this.searchChildInFrustum(frustum, this.scene);
            return this.collection;
        };
        SelectionBox.prototype.updateFrustum = function (startPoint, endPoint) {
            startPoint = startPoint || this.startPoint;
            endPoint = endPoint || this.endPoint;
            this.camera.updateProjectionMatrix();
            this.camera.updateMatrixWorld();
            if (this.camera.isPerspectiveCamera) {
                tmpPoint.copy(startPoint);
                tmpPoint.x = Math.min(startPoint.x, endPoint.x);
                tmpPoint.y = Math.max(startPoint.y, endPoint.y);
                endPoint.x = Math.max(startPoint.x, endPoint.x);
                endPoint.y = Math.min(startPoint.y, endPoint.y);
                vecNear.copy(this.camera.position);
                vecTopLeft.copy(tmpPoint);
                vecTopRight.set(endPoint.x, tmpPoint.y, 0);
                vecDownRight.copy(endPoint);
                vecDownLeft.set(tmpPoint.x, endPoint.y, 0);
                vecTopLeft.unproject(this.camera);
                vecTopRight.unproject(this.camera);
                vecDownRight.unproject(this.camera);
                vecDownLeft.unproject(this.camera);
                vectemp1.copy(vecTopLeft).sub(vecNear);
                vectemp2.copy(vecTopRight).sub(vecNear);
                vectemp3.copy(vecDownRight).sub(vecNear);
                vectemp1.normalize();
                vectemp2.normalize();
                vectemp3.normalize();
                vectemp1.multiplyScalar(this.deep);
                vectemp2.multiplyScalar(this.deep);
                vectemp3.multiplyScalar(this.deep);
                vectemp1.add(vecNear);
                vectemp2.add(vecNear);
                vectemp3.add(vecNear);
                var planes = frustum.planes;
                planes[0].setFromCoplanarPoints(vecNear, vecTopLeft, vecTopRight);
                planes[1].setFromCoplanarPoints(vecNear, vecTopRight, vecDownRight);
                planes[2].setFromCoplanarPoints(vecDownRight, vecDownLeft, vecNear);
                planes[3].setFromCoplanarPoints(vecDownLeft, vecTopLeft, vecNear);
                planes[4].setFromCoplanarPoints(vecTopRight, vecDownRight, vecDownLeft);
                planes[5].setFromCoplanarPoints(vectemp3, vectemp2, vectemp1);
                planes[5].normal.multiplyScalar(-1);
            } else if (this.camera.isOrthographicCamera) {
                if (startPoint.equals(endPoint))
                    endPoint.addScalar(Number.EPSILON);
                var left = Math.min(startPoint.x, endPoint.x);
                var top = Math.max(startPoint.y, endPoint.y);
                var right = Math.max(startPoint.x, endPoint.x);
                var down = Math.min(startPoint.y, endPoint.y);
                vecTopLeft.set(left, top, -1);
                vecTopRight.set(right, top, -1);
                vecDownRight.set(right, down, -1);
                vecDownLeft.set(left, down, -1);
                vecFarTopLeft.set(left, top, 1);
                vecFarTopRight.set(right, top, 1);
                vecFarDownRight.set(right, down, 1);
                vecFarDownLeft.set(left, down, 1);
                vecTopLeft.unproject(this.camera);
                vecTopRight.unproject(this.camera);
                vecDownRight.unproject(this.camera);
                vecDownLeft.unproject(this.camera);
                vecFarTopLeft.unproject(this.camera);
                vecFarTopRight.unproject(this.camera);
                vecFarDownRight.unproject(this.camera);
                vecFarDownLeft.unproject(this.camera);
                var planes = frustum.planes;
                planes[0].setFromCoplanarPoints(vecTopLeft, vecFarTopLeft, vecFarTopRight);
                planes[1].setFromCoplanarPoints(vecTopRight, vecFarTopRight, vecFarDownRight);
                planes[2].setFromCoplanarPoints(vecFarDownRight, vecFarDownLeft, vecDownLeft);
                planes[3].setFromCoplanarPoints(vecFarDownLeft, vecFarTopLeft, vecTopLeft);
                planes[4].setFromCoplanarPoints(vecTopRight, vecDownRight, vecDownLeft);
                planes[5].setFromCoplanarPoints(vecFarDownRight, vecFarTopRight, vecFarTopLeft);
                planes[5].normal.multiplyScalar(-1);
            } else {
                console.error('THREE.SelectionBox: Unsupported camera type.');
            }
        };
        SelectionBox.prototype.searchChildInFrustum = function (frustum, object) {
            if (object.isMesh || object.isLine || object.isPoints) {
                if (object.material !== undefined) {
                    if (object.geometry.boundingSphere === null)
                        object.geometry.computeBoundingSphere();
                    center.copy(object.geometry.boundingSphere.center);
                    center.applyMatrix4(object.matrixWorld);
                    if (frustum.containsPoint(center)) {
                        this.collection.push(object);
                    }
                }
            }
            if (object.children.length > 0) {
                for (var x = 0; x < object.children.length; x++) {
                    this.searchChildInFrustum(frustum, object.children[x]);
                }
            }
        };
        return SelectionBox;
    }();

    return threex.interactive.SelectionBox  =SelectionBox;
});
define('skylark-threejs-ex/interactive/SelectionHelper',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var SelectionHelper = function () {
        function SelectionHelper(selectionBox, renderer, cssClassName) {
            this.element = document.createElement('div');
            this.element.classList.add(cssClassName);
            this.element.style.pointerEvents = 'none';
            this.renderer = renderer;
            this.startPoint = new THREE.Vector2();
            this.pointTopLeft = new THREE.Vector2();
            this.pointBottomRight = new THREE.Vector2();
            this.isDown = false;
            this.renderer.domElement.addEventListener('mousedown', function (event) {
                this.isDown = true;
                this.onSelectStart(event);
            }.bind(this), false);
            this.renderer.domElement.addEventListener('mousemove', function (event) {
                if (this.isDown) {
                    this.onSelectMove(event);
                }
            }.bind(this), false);
            this.renderer.domElement.addEventListener('mouseup', function (event) {
                this.isDown = false;
                this.onSelectOver(event);
            }.bind(this), false);
        }
        SelectionHelper.prototype.onSelectStart = function (event) {
            this.renderer.domElement.parentElement.appendChild(this.element);
            this.element.style.left = event.clientX + 'px';
            this.element.style.top = event.clientY + 'px';
            this.element.style.width = '0px';
            this.element.style.height = '0px';
            this.startPoint.x = event.clientX;
            this.startPoint.y = event.clientY;
        };
        SelectionHelper.prototype.onSelectMove = function (event) {
            this.pointBottomRight.x = Math.max(this.startPoint.x, event.clientX);
            this.pointBottomRight.y = Math.max(this.startPoint.y, event.clientY);
            this.pointTopLeft.x = Math.min(this.startPoint.x, event.clientX);
            this.pointTopLeft.y = Math.min(this.startPoint.y, event.clientY);
            this.element.style.left = this.pointTopLeft.x + 'px';
            this.element.style.top = this.pointTopLeft.y + 'px';
            this.element.style.width = this.pointBottomRight.x - this.pointTopLeft.x + 'px';
            this.element.style.height = this.pointBottomRight.y - this.pointTopLeft.y + 'px';
        };
        SelectionHelper.prototype.onSelectOver = function () {
            this.element.parentElement.removeChild(this.element);
        };
        return SelectionHelper;
    }();

    return threex.interactive.SelectionHelper = SelectionHelper;
});
define('skylark-threejs-ex/lights/LightProbeGenerator',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var LightProbeGenerator = {
        fromCubeTexture: function (cubeTexture) {
            var norm, lengthSq, weight, totalWeight = 0;
            var coord = new THREE.Vector3();
            var dir = new THREE.Vector3();
            var color = new THREE.Color();
            var shBasis = [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ];
            var sh = new THREE.SphericalHarmonics3();
            var shCoefficients = sh.coefficients;
            for (var faceIndex = 0; faceIndex < 6; faceIndex++) {
                var image = cubeTexture.image[faceIndex];
                var width = image.width;
                var height = image.height;
                var canvas = document.createElement('canvas');
                canvas.width = width;
                canvas.height = height;
                var context = canvas.getContext('2d');
                context.drawImage(image, 0, 0, width, height);
                var imageData = context.getImageData(0, 0, width, height);
                var data = imageData.data;
                var imageWidth = imageData.width;
                var pixelSize = 2 / imageWidth;
                for (var i = 0, il = data.length; i < il; i += 4) {
                    color.setRGB(data[i] / 255, data[i + 1] / 255, data[i + 2] / 255);
                    convertColorToLinear(color, cubeTexture.encoding);
                    var pixelIndex = i / 4;
                    var col = -1 + (pixelIndex % imageWidth + 0.5) * pixelSize;
                    var row = 1 - (Math.floor(pixelIndex / imageWidth) + 0.5) * pixelSize;
                    switch (faceIndex) {
                    case 0:
                        coord.set(-1, row, -col);
                        break;
                    case 1:
                        coord.set(1, row, col);
                        break;
                    case 2:
                        coord.set(-col, 1, -row);
                        break;
                    case 3:
                        coord.set(-col, -1, row);
                        break;
                    case 4:
                        coord.set(-col, row, 1);
                        break;
                    case 5:
                        coord.set(col, row, -1);
                        break;
                    }
                    lengthSq = coord.lengthSq();
                    weight = 4 / (Math.sqrt(lengthSq) * lengthSq);
                    totalWeight += weight;
                    dir.copy(coord).normalize();
                    THREE.SphericalHarmonics3.getBasisAt(dir, shBasis);
                    for (var j = 0; j < 9; j++) {
                        shCoefficients[j].x += shBasis[j] * color.r * weight;
                        shCoefficients[j].y += shBasis[j] * color.g * weight;
                        shCoefficients[j].z += shBasis[j] * color.b * weight;
                    }
                }
            }
            norm = 4 * Math.PI / totalWeight;
            for (var j = 0; j < 9; j++) {
                shCoefficients[j].x *= norm;
                shCoefficients[j].y *= norm;
                shCoefficients[j].z *= norm;
            }
            return new THREE.LightProbe(sh);
        },
        fromCubeRenderTarget: function (renderer, cubeRenderTarget) {
            var norm, lengthSq, weight, totalWeight = 0;
            var coord = new THREE.Vector3();
            var dir = new THREE.Vector3();
            var color = new THREE.Color();
            var shBasis = [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ];
            var sh = new THREE.SphericalHarmonics3();
            var shCoefficients = sh.coefficients;
            for (var faceIndex = 0; faceIndex < 6; faceIndex++) {
                var imageWidth = cubeRenderTarget.width;
                var data = new Uint8Array(imageWidth * imageWidth * 4);
                renderer.readRenderTargetPixels(cubeRenderTarget, 0, 0, imageWidth, imageWidth, data, faceIndex);
                var pixelSize = 2 / imageWidth;
                for (var i = 0, il = data.length; i < il; i += 4) {
                    color.setRGB(data[i] / 255, data[i + 1] / 255, data[i + 2] / 255);
                    convertColorToLinear(color, cubeRenderTarget.texture.encoding);
                    var pixelIndex = i / 4;
                    var col = -1 + (pixelIndex % imageWidth + 0.5) * pixelSize;
                    var row = 1 - (Math.floor(pixelIndex / imageWidth) + 0.5) * pixelSize;
                    switch (faceIndex) {
                    case 0:
                        coord.set(1, row, -col);
                        break;
                    case 1:
                        coord.set(-1, row, col);
                        break;
                    case 2:
                        coord.set(col, 1, -row);
                        break;
                    case 3:
                        coord.set(col, -1, row);
                        break;
                    case 4:
                        coord.set(col, row, 1);
                        break;
                    case 5:
                        coord.set(-col, row, -1);
                        break;
                    }
                    lengthSq = coord.lengthSq();
                    weight = 4 / (Math.sqrt(lengthSq) * lengthSq);
                    totalWeight += weight;
                    dir.copy(coord).normalize();
                    THREE.SphericalHarmonics3.getBasisAt(dir, shBasis);
                    for (var j = 0; j < 9; j++) {
                        shCoefficients[j].x += shBasis[j] * color.r * weight;
                        shCoefficients[j].y += shBasis[j] * color.g * weight;
                        shCoefficients[j].z += shBasis[j] * color.b * weight;
                    }
                }
            }
            norm = 4 * Math.PI / totalWeight;
            for (var j = 0; j < 9; j++) {
                shCoefficients[j].x *= norm;
                shCoefficients[j].y *= norm;
                shCoefficients[j].z *= norm;
            }
            return new THREE.LightProbe(sh);
        }
    };
    var convertColorToLinear = function (color, encoding) {
        switch (encoding) {
        case THREE.sRGBEncoding:
            color.convertSRGBToLinear();
            break;
        case THREE.LinearEncoding:
            break;
        default:
            console.warn('WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.');
            break;
        }
        return color;
    };
    
    return threex.lights.LightProbeGenerator = LightProbeGenerator;
});
define('skylark-threejs-ex/lights/RectAreaLightUniformsLib',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var RectAreaLightUniformsLib = {
        init: function () {
            var LTC_MAT_1 = [
                1,
                0,
                0,
                0.00002,
                1,
                0,
                0,
                0.000503905,
                1,
                0,
                0,
                0.00201562,
                1,
                0,
                0,
                0.00453516,
                1,
                0,
                0,
                0.00806253,
                1,
                0,
                0,
                0.0125978,
                1,
                0,
                0,
                0.018141,
                1,
                0,
                0,
                0.0246924,
                1,
                0,
                0,
                0.0322525,
                1,
                0,
                0,
                0.0408213,
                1,
                0,
                0,
                0.0503999,
                1,
                0,
                0,
                0.0609894,
                1,
                0,
                0,
                0.0725906,
                1,
                0,
                0,
                0.0852058,
                1,
                0,
                0,
                0.0988363,
                1,
                0,
                0,
                0.113484,
                1,
                0,
                0,
                0.129153,
                1,
                0,
                0,
                0.145839,
                1,
                0,
                0,
                0.163548,
                1,
                0,
                0,
                0.182266,
                1,
                0,
                0,
                0.201942,
                1,
                0,
                0,
                0.222314,
                1,
                0,
                0,
                0.241906,
                1,
                0,
                0,
                0.262314,
                1,
                0,
                0,
                0.285754,
                1,
                0,
                0,
                0.310159,
                1,
                0,
                0,
                0.335426,
                1,
                0,
                0,
                0.361341,
                1,
                0,
                0,
                0.387445,
                1,
                0,
                0,
                0.412784,
                1,
                0,
                0,
                0.438197,
                1,
                0,
                0,
                0.466966,
                1,
                0,
                0,
                0.49559,
                1,
                0,
                0,
                0.523448,
                1,
                0,
                0,
                0.549938,
                1,
                0,
                0,
                0.57979,
                1,
                0,
                0,
                0.608746,
                1,
                0,
                0,
                0.636185,
                1,
                0,
                0,
                0.664748,
                1,
                0,
                0,
                0.69313,
                1,
                0,
                0,
                0.71966,
                1,
                0,
                0,
                0.747662,
                1,
                0,
                0,
                0.774023,
                1,
                0,
                0,
                0.799775,
                1,
                0,
                0,
                0.825274,
                1,
                0,
                0,
                0.849156,
                1,
                0,
                0,
                0.873248,
                1,
                0,
                0,
                0.89532,
                1,
                0,
                0,
                0.917565,
                1,
                0,
                0,
                0.937863,
                1,
                0,
                0,
                0.958139,
                1,
                0,
                0,
                0.976563,
                1,
                0,
                0,
                0.994658,
                1,
                0,
                0,
                1.0112,
                1,
                0,
                0,
                1.02712,
                1,
                0,
                0,
                1.04189,
                1,
                0,
                0,
                1.05568,
                1,
                0,
                0,
                1.06877,
                1,
                0,
                0,
                1.08058,
                1,
                0,
                0,
                1.09194,
                1,
                0,
                0,
                1.10191,
                1,
                0,
                0,
                1.11161,
                1,
                0,
                0,
                1.1199,
                1,
                0,
                0,
                1.12813,
                0.999547,
                -4.48815e-7,
                0.0224417,
                0.0000199902,
                0.999495,
                -0.0000113079,
                0.0224406,
                0.000503651,
                0.999496,
                -0.0000452317,
                0.0224406,
                0.00201461,
                0.999496,
                -0.000101772,
                0.0224406,
                0.00453287,
                0.999495,
                -0.000180928,
                0.0224406,
                0.00805845,
                0.999497,
                -0.000282702,
                0.0224406,
                0.0125914,
                0.999496,
                -0.000407096,
                0.0224406,
                0.0181319,
                0.999498,
                -0.000554114,
                0.0224406,
                0.02468,
                0.999499,
                -0.000723768,
                0.0224406,
                0.0322363,
                0.999495,
                -0.000916058,
                0.0224405,
                0.0408009,
                0.999499,
                -0.00113101,
                0.0224408,
                0.050375,
                0.999494,
                -0.00136863,
                0.0224405,
                0.0609586,
                0.999489,
                -0.00162896,
                0.0224401,
                0.0725537,
                0.999489,
                -0.00191201,
                0.0224414,
                0.0851619,
                0.999498,
                -0.00221787,
                0.0224413,
                0.0987867,
                0.999492,
                -0.00254642,
                0.0224409,
                0.113426,
                0.999507,
                -0.00289779,
                0.0224417,
                0.129088,
                0.999494,
                -0.0032716,
                0.0224386,
                0.145767,
                0.999546,
                -0.0036673,
                0.0224424,
                0.163472,
                0.999543,
                -0.00408166,
                0.0224387,
                0.182182,
                0.999499,
                -0.00450056,
                0.0224338,
                0.201843,
                0.999503,
                -0.00483661,
                0.0224203,
                0.222198,
                0.999546,
                -0.00452928,
                0.022315,
                0.241714,
                0.999508,
                -0.00587403,
                0.0224329,
                0.262184,
                0.999509,
                -0.00638806,
                0.0224271,
                0.285609,
                0.999501,
                -0.00691028,
                0.0224166,
                0.309998,
                0.999539,
                -0.00741979,
                0.0223989,
                0.335262,
                0.999454,
                -0.00786282,
                0.0223675,
                0.361154,
                0.999529,
                -0.00811928,
                0.0222828,
                0.387224,
                0.999503,
                -0.00799941,
                0.0221063,
                0.41252,
                0.999561,
                -0.00952753,
                0.0223057,
                0.438006,
                0.999557,
                -0.0099134,
                0.0222065,
                0.466735,
                0.999541,
                -0.0100935,
                0.0220402,
                0.495332,
                0.999562,
                -0.00996821,
                0.0218067,
                0.523197,
                0.999556,
                -0.0105031,
                0.0217096,
                0.550223,
                0.999561,
                -0.0114191,
                0.0217215,
                0.579498,
                0.999588,
                -0.0111818,
                0.0213357,
                0.608416,
                0.999633,
                -0.0107725,
                0.0208689,
                0.635965,
                0.999527,
                -0.0121671,
                0.0210149,
                0.664476,
                0.999508,
                -0.0116005,
                0.020431,
                0.692786,
                0.999568,
                -0.0115604,
                0.0199791,
                0.719709,
                0.999671,
                -0.0121117,
                0.0197415,
                0.74737,
                0.999688,
                -0.0110769,
                0.0188846,
                0.773692,
                0.99962,
                -0.0122368,
                0.0188452,
                0.799534,
                0.999823,
                -0.0110325,
                0.0178001,
                0.825046,
                0.999599,
                -0.0114923,
                0.0174221,
                0.849075,
                0.999619,
                -0.0105923,
                0.0164345,
                0.872999,
                0.999613,
                -0.0105988,
                0.0158227,
                0.895371,
                0.99964,
                -0.00979861,
                0.0148131,
                0.917364,
                0.99977,
                -0.00967238,
                0.0140721,
                0.938002,
                0.999726,
                -0.00869175,
                0.0129543,
                0.957917,
                0.99973,
                -0.00866872,
                0.0122329,
                0.976557,
                0.999773,
                -0.00731956,
                0.0108958,
                0.994459,
                0.999811,
                -0.00756027,
                0.0102715,
                1.01118,
                0.999862,
                -0.00583732,
                0.00878781,
                1.02701,
                0.999835,
                -0.00631438,
                0.00827529,
                1.04186,
                0.999871,
                -0.00450785,
                0.00674583,
                1.05569,
                0.999867,
                -0.00486079,
                0.00621041,
                1.06861,
                0.999939,
                -0.00322072,
                0.00478301,
                1.08064,
                0.999918,
                -0.00318199,
                0.00406395,
                1.09181,
                1.00003,
                -0.00193348,
                0.00280682,
                1.10207,
                0.999928,
                -0.00153729,
                0.00198741,
                1.11152,
                0.999933,
                -0.000623666,
                0.000917714,
                1.12009,
                1,
                -0.00000102387,
                9.07581e-7,
                1.12813,
                0.997866,
                -8.96716e-7,
                0.0448334,
                0.0000199584,
                0.997987,
                -0.0000225945,
                0.0448389,
                0.000502891,
                0.997987,
                -0.0000903781,
                0.0448388,
                0.00201156,
                0.997985,
                -0.000203351,
                0.0448388,
                0.00452602,
                0.997986,
                -0.000361514,
                0.0448388,
                0.00804629,
                0.997987,
                -0.00056487,
                0.0448389,
                0.0125724,
                0.997988,
                -0.000813423,
                0.0448389,
                0.0181045,
                0.997984,
                -0.00110718,
                0.0448387,
                0.0246427,
                0.997985,
                -0.00144616,
                0.0448388,
                0.0321875,
                0.997987,
                -0.00183038,
                0.044839,
                0.0407392,
                0.997983,
                -0.00225987,
                0.0448387,
                0.0502986,
                0.997991,
                -0.00273467,
                0.0448389,
                0.0608667,
                0.997984,
                -0.00325481,
                0.0448384,
                0.0724444,
                0.998002,
                -0.00382043,
                0.044839,
                0.0850348,
                0.997997,
                -0.00443145,
                0.0448396,
                0.0986372,
                0.998007,
                -0.00508796,
                0.0448397,
                0.113255,
                0.998008,
                -0.00578985,
                0.04484,
                0.128891,
                0.998003,
                -0.00653683,
                0.0448384,
                0.145548,
                0.997983,
                -0.00732713,
                0.0448358,
                0.163221,
                0.997985,
                -0.00815454,
                0.0448358,
                0.181899,
                0.998005,
                -0.00898985,
                0.0448286,
                0.201533,
                0.998026,
                -0.00964404,
                0.0447934,
                0.221821,
                0.998055,
                -0.00922677,
                0.044611,
                0.241282,
                0.99804,
                -0.0117361,
                0.0448245,
                0.261791,
                0.998048,
                -0.0127628,
                0.0448159,
                0.285181,
                0.998088,
                -0.0138055,
                0.0447996,
                0.30954,
                0.998058,
                -0.0148206,
                0.0447669,
                0.334751,
                0.998099,
                -0.0156998,
                0.044697,
                0.36061,
                0.998116,
                -0.0161976,
                0.0445122,
                0.386603,
                0.998195,
                -0.015945,
                0.0441711,
                0.411844,
                0.998168,
                -0.0183947,
                0.0444255,
                0.43773,
                0.998184,
                -0.0197913,
                0.0443809,
                0.466009,
                0.998251,
                -0.0201426,
                0.0440689,
                0.494574,
                0.998305,
                -0.0198847,
                0.0435632,
                0.522405,
                0.998273,
                -0.0210577,
                0.043414,
                0.549967,
                0.998254,
                -0.0227901,
                0.0433943,
                0.578655,
                0.998349,
                -0.0223108,
                0.0426529,
                0.60758,
                0.99843,
                -0.0223088,
                0.042,
                0.635524,
                0.998373,
                -0.0241141,
                0.0418987,
                0.663621,
                0.998425,
                -0.0231446,
                0.0408118,
                0.691906,
                0.998504,
                -0.0233684,
                0.0400565,
                0.719339,
                0.998443,
                -0.0241652,
                0.0394634,
                0.74643,
                0.99848,
                -0.0228715,
                0.0380002,
                0.773086,
                0.998569,
                -0.023519,
                0.0372322,
                0.798988,
                0.998619,
                -0.0223108,
                0.0356468,
                0.824249,
                0.998594,
                -0.0223105,
                0.034523,
                0.848808,
                0.998622,
                -0.0213426,
                0.0328887,
                0.87227,
                0.998669,
                -0.0207912,
                0.0314374,
                0.895157,
                0.998705,
                -0.0198416,
                0.0296925,
                0.916769,
                0.998786,
                -0.0189168,
                0.0279634,
                0.937773,
                0.998888,
                -0.0178811,
                0.0261597,
                0.957431,
                0.99906,
                -0.0166845,
                0.0242159,
                0.976495,
                0.999038,
                -0.0155464,
                0.0222638,
                0.994169,
                0.999237,
                -0.0141349,
                0.0201967,
                1.01112,
                0.999378,
                -0.0129324,
                0.0181744,
                1.02692,
                0.999433,
                -0.0113192,
                0.0159898,
                1.04174,
                0.999439,
                -0.0101244,
                0.0140385,
                1.05559,
                0.999614,
                -0.00837456,
                0.0117826,
                1.06852,
                0.999722,
                -0.00721769,
                0.00983745,
                1.08069,
                0.999817,
                -0.00554067,
                0.00769002,
                1.09176,
                0.99983,
                -0.00426961,
                0.005782,
                1.10211,
                0.999964,
                -0.00273904,
                0.00374503,
                1.11152,
                1.00001,
                -0.00136739,
                0.00187176,
                1.12031,
                0.999946,
                0.0000393227,
                -0.000028919,
                1.12804,
                0.995847,
                -0.0000013435,
                0.0671785,
                0.000019916,
                0.995464,
                -0.0000338387,
                0.0671527,
                0.000501622,
                0.99547,
                -0.000135355,
                0.0671531,
                0.00200649,
                0.995471,
                -0.00030455,
                0.0671532,
                0.00451461,
                0.99547,
                -0.000541423,
                0.0671531,
                0.008026,
                0.995471,
                -0.00084598,
                0.0671531,
                0.0125407,
                0.99547,
                -0.00121823,
                0.0671531,
                0.0180589,
                0.99547,
                -0.00165817,
                0.0671531,
                0.0245806,
                0.995463,
                -0.00216583,
                0.0671526,
                0.0321062,
                0.995468,
                -0.00274127,
                0.0671527,
                0.0406366,
                0.995474,
                -0.00338447,
                0.0671534,
                0.0501717,
                0.995473,
                -0.00409554,
                0.0671533,
                0.0607131,
                0.995478,
                -0.00487451,
                0.0671531,
                0.0722618,
                0.995476,
                -0.00572148,
                0.0671532,
                0.0848191,
                0.995477,
                -0.00663658,
                0.0671539,
                0.0983882,
                0.995498,
                -0.00761986,
                0.0671541,
                0.112972,
                0.995509,
                -0.00867094,
                0.0671542,
                0.128568,
                0.995509,
                -0.00978951,
                0.0671531,
                0.145183,
                0.995503,
                -0.0109725,
                0.0671491,
                0.162808,
                0.995501,
                -0.012211,
                0.0671465,
                0.181441,
                0.99553,
                -0.0134565,
                0.0671371,
                0.201015,
                0.99555,
                -0.014391,
                0.0670831,
                0.221206,
                0.99558,
                -0.014351,
                0.0668883,
                0.240813,
                0.995577,
                -0.0173997,
                0.0671055,
                0.261257,
                0.995602,
                -0.0191111,
                0.0671178,
                0.284467,
                0.995623,
                -0.0206705,
                0.0670946,
                0.308765,
                0.995658,
                -0.022184,
                0.0670472,
                0.333905,
                0.995705,
                -0.0234832,
                0.0669417,
                0.359677,
                0.995719,
                -0.0241933,
                0.0666714,
                0.385554,
                0.995786,
                -0.0243539,
                0.066266,
                0.410951,
                0.995887,
                -0.0271866,
                0.0664367,
                0.437163,
                0.995944,
                -0.0296012,
                0.0664931,
                0.464842,
                0.996004,
                -0.0301045,
                0.0660105,
                0.49332,
                0.996128,
                -0.0298311,
                0.0652694,
                0.521131,
                0.996253,
                -0.0316426,
                0.0650739,
                0.549167,
                0.996244,
                -0.0339043,
                0.0649433,
                0.57737,
                0.996309,
                -0.033329,
                0.0638926,
                0.606073,
                0.996417,
                -0.0338935,
                0.0630849,
                0.634527,
                0.996372,
                -0.0353104,
                0.0625083,
                0.66256,
                0.996542,
                -0.0348942,
                0.0611986,
                0.690516,
                0.996568,
                -0.0351614,
                0.060069,
                0.718317,
                0.996711,
                -0.0354317,
                0.0588522,
                0.74528,
                0.996671,
                -0.0349513,
                0.0571902,
                0.772061,
                0.996865,
                -0.0345622,
                0.0555321,
                0.798089,
                0.996802,
                -0.0342566,
                0.0537816,
                0.823178,
                0.996992,
                -0.0330862,
                0.0516095,
                0.847949,
                0.996944,
                -0.0324666,
                0.0495537,
                0.871431,
                0.997146,
                -0.0309544,
                0.0470302,
                0.894357,
                0.997189,
                -0.0299372,
                0.0446043,
                0.916142,
                0.997471,
                -0.0281389,
                0.0418812,
                0.937193,
                0.997515,
                -0.0268702,
                0.0391823,
                0.957,
                0.997812,
                -0.0247166,
                0.0361338,
                0.975936,
                0.998027,
                -0.0233525,
                0.0333945,
                0.99391,
                0.998233,
                -0.0209839,
                0.0301917,
                1.01075,
                0.998481,
                -0.0194309,
                0.027271,
                1.02669,
                0.998859,
                -0.0169728,
                0.0240162,
                1.04173,
                0.99894,
                -0.0152322,
                0.0210517,
                1.05551,
                0.999132,
                -0.0127497,
                0.0178632,
                1.06856,
                0.999369,
                -0.0108282,
                0.014787,
                1.08054,
                0.999549,
                -0.00845886,
                0.0116185,
                1.09185,
                0.999805,
                -0.0063937,
                0.00867209,
                1.10207,
                0.99985,
                -0.00414582,
                0.00566823,
                1.1117,
                0.999912,
                -0.00207443,
                0.00277562,
                1.12022,
                1.00001,
                0.0000870226,
                -0.000053766,
                1.12832,
                0.991943,
                -0.00000178672,
                0.0893382,
                0.0000198384,
                0.991952,
                -0.0000450183,
                0.089339,
                0.000499849,
                0.991956,
                -0.000180074,
                0.0893394,
                0.0019994,
                0.991955,
                -0.000405167,
                0.0893393,
                0.00449867,
                0.991953,
                -0.000720298,
                0.0893391,
                0.00799764,
                0.991955,
                -0.00112548,
                0.0893393,
                0.0124964,
                0.991957,
                -0.0016207,
                0.0893395,
                0.0179951,
                0.991958,
                -0.00220601,
                0.0893396,
                0.0244939,
                0.991947,
                -0.00288137,
                0.0893385,
                0.0319929,
                0.991962,
                -0.00364693,
                0.0893399,
                0.0404933,
                0.991965,
                -0.00450264,
                0.0893399,
                0.049995,
                0.99198,
                -0.00544862,
                0.0893411,
                0.0604995,
                0.99197,
                -0.00648491,
                0.0893397,
                0.0720074,
                0.991976,
                -0.00761164,
                0.089341,
                0.0845207,
                0.99198,
                -0.00882891,
                0.0893405,
                0.0980413,
                0.991982,
                -0.0101367,
                0.0893396,
                0.112571,
                0.992008,
                -0.011535,
                0.0893415,
                0.128115,
                0.992026,
                -0.0130228,
                0.0893414,
                0.144672,
                0.992064,
                -0.0145966,
                0.0893418,
                0.162241,
                0.992041,
                -0.0162421,
                0.0893359,
                0.180801,
                0.992086,
                -0.0178888,
                0.0893214,
                0.200302,
                0.992157,
                -0.0190368,
                0.0892401,
                0.220332,
                0.992181,
                -0.0195584,
                0.0890525,
                0.240144,
                0.992175,
                -0.0227257,
                0.0892153,
                0.260728,
                0.99221,
                -0.0254195,
                0.089304,
                0.283473,
                0.99222,
                -0.0274883,
                0.0892703,
                0.307673,
                0.992317,
                -0.0294905,
                0.0892027,
                0.332729,
                0.992374,
                -0.0311861,
                0.0890577,
                0.358387,
                0.992505,
                -0.0320656,
                0.0886994,
                0.384102,
                0.992568,
                -0.0329715,
                0.0883198,
                0.409767,
                0.992675,
                -0.036006,
                0.0883602,
                0.436145,
                0.992746,
                -0.0392897,
                0.0884591,
                0.463217,
                0.992873,
                -0.0399337,
                0.0878287,
                0.491557,
                0.992934,
                -0.040231,
                0.0870108,
                0.519516,
                0.993091,
                -0.0422013,
                0.0865857,
                0.547741,
                0.993259,
                -0.0443503,
                0.0861937,
                0.575792,
                0.993455,
                -0.0446368,
                0.0851187,
                0.604233,
                0.993497,
                -0.0454299,
                0.0840576,
                0.632925,
                0.993694,
                -0.0463296,
                0.0829671,
                0.660985,
                0.993718,
                -0.0470619,
                0.0817185,
                0.688714,
                0.993973,
                -0.0468838,
                0.0800294,
                0.716743,
                0.994207,
                -0.046705,
                0.0781286,
                0.74377,
                0.994168,
                -0.0469698,
                0.0763337,
                0.77042,
                0.9945,
                -0.0456816,
                0.0738184,
                0.796659,
                0.994356,
                -0.0455518,
                0.0715545,
                0.821868,
                0.994747,
                -0.0439488,
                0.0686085,
                0.846572,
                0.994937,
                -0.0430056,
                0.065869,
                0.870435,
                0.995142,
                -0.0413414,
                0.0626446,
                0.893272,
                0.995451,
                -0.0396521,
                0.05929,
                0.915376,
                0.995445,
                -0.0378453,
                0.0558503,
                0.936196,
                0.995967,
                -0.0355219,
                0.0520949,
                0.956376,
                0.996094,
                -0.0335146,
                0.048377,
                0.975327,
                0.996622,
                -0.030682,
                0.0442575,
                0.993471,
                0.996938,
                -0.0285504,
                0.0404693,
                1.01052,
                0.997383,
                -0.0253399,
                0.0360903,
                1.02637,
                0.997714,
                -0.0231651,
                0.0322176,
                1.04139,
                0.998249,
                -0.0198138,
                0.0278433,
                1.05542,
                0.998596,
                -0.0174337,
                0.0238759,
                1.06846,
                0.998946,
                -0.0141349,
                0.0195944,
                1.08056,
                0.99928,
                -0.0115603,
                0.0156279,
                1.09181,
                0.999507,
                -0.00839065,
                0.0114607,
                1.10213,
                0.999697,
                -0.005666,
                0.00763325,
                1.11169,
                0.999869,
                -0.00269902,
                0.00364946,
                1.12042,
                1.00001,
                0.0000623836,
                -0.0000319288,
                1.12832,
                0.987221,
                -0.00000222675,
                0.111332,
                0.0000197456,
                0.98739,
                -0.0000561116,
                0.111351,
                0.000497563,
                0.987448,
                -0.000224453,
                0.111357,
                0.00199031,
                0.987441,
                -0.000505019,
                0.111357,
                0.0044782,
                0.987442,
                -0.000897816,
                0.111357,
                0.00796129,
                0.987442,
                -0.00140284,
                0.111357,
                0.0124396,
                0.987444,
                -0.00202012,
                0.111357,
                0.0179132,
                0.987442,
                -0.00274964,
                0.111357,
                0.0243824,
                0.987446,
                -0.00359147,
                0.111357,
                0.0318474,
                0.987435,
                -0.00454562,
                0.111356,
                0.0403086,
                0.987461,
                -0.00561225,
                0.111358,
                0.0497678,
                0.987458,
                -0.00679125,
                0.111358,
                0.0602239,
                0.987443,
                -0.0080828,
                0.111356,
                0.0716792,
                0.987476,
                -0.0094872,
                0.111358,
                0.0841364,
                0.98749,
                -0.0110044,
                0.111361,
                0.097597,
                0.987508,
                -0.0126344,
                0.111362,
                0.112062,
                0.987494,
                -0.0143767,
                0.111357,
                0.127533,
                0.987526,
                -0.0162307,
                0.111359,
                0.144015,
                0.987558,
                -0.0181912,
                0.111361,
                0.161502,
                0.987602,
                -0.0202393,
                0.111355,
                0.179979,
                0.987692,
                -0.022273,
                0.111346,
                0.199386,
                0.987702,
                -0.0235306,
                0.111215,
                0.219183,
                0.987789,
                -0.0247628,
                0.111061,
                0.239202,
                0.987776,
                -0.0280668,
                0.111171,
                0.259957,
                0.987856,
                -0.0316751,
                0.111327,
                0.282198,
                0.987912,
                -0.0342468,
                0.111282,
                0.306294,
                0.988,
                -0.0367205,
                0.111198,
                0.331219,
                0.988055,
                -0.0387766,
                0.110994,
                0.356708,
                0.988241,
                -0.0397722,
                0.110547,
                0.382234,
                0.988399,
                -0.0416076,
                0.110198,
                0.408227,
                0.988539,
                -0.0448192,
                0.110137,
                0.434662,
                0.988661,
                -0.0483793,
                0.110143,
                0.461442,
                0.988967,
                -0.0495895,
                0.109453,
                0.489318,
                0.989073,
                -0.0506797,
                0.108628,
                0.517516,
                0.989274,
                -0.0526953,
                0.108003,
                0.545844,
                0.989528,
                -0.054578,
                0.107255,
                0.573823,
                0.989709,
                -0.0561503,
                0.106294,
                0.601944,
                0.989991,
                -0.056866,
                0.104896,
                0.630855,
                0.990392,
                -0.0572914,
                0.103336,
                0.658925,
                0.990374,
                -0.0586224,
                0.10189,
                0.686661,
                0.990747,
                -0.0584764,
                0.099783,
                0.714548,
                0.991041,
                -0.0582662,
                0.0974309,
                0.74186,
                0.991236,
                -0.0584118,
                0.0951678,
                0.768422,
                0.991585,
                -0.0573055,
                0.0921581,
                0.794817,
                0.991984,
                -0.0564241,
                0.0891167,
                0.820336,
                0.9921,
                -0.0553608,
                0.085805,
                0.84493,
                0.992749,
                -0.0533816,
                0.0820354,
                0.868961,
                0.99288,
                -0.0518661,
                0.0782181,
                0.891931,
                0.993511,
                -0.0492492,
                0.0738935,
                0.914186,
                0.993617,
                -0.0471956,
                0.0696402,
                0.93532,
                0.99411,
                -0.044216,
                0.0649659,
                0.95543,
                0.994595,
                -0.0416654,
                0.0603177,
                0.974685,
                0.994976,
                -0.0384314,
                0.0553493,
                0.992807,
                0.995579,
                -0.0353491,
                0.0503942,
                1.00996,
                0.996069,
                -0.0319787,
                0.0452123,
                1.02606,
                0.996718,
                -0.028472,
                0.0400112,
                1.04114,
                0.997173,
                -0.0250789,
                0.0349456,
                1.05517,
                0.997818,
                -0.0213326,
                0.029653,
                1.0683,
                0.998318,
                -0.0178509,
                0.024549,
                1.0805,
                0.998853,
                -0.0141118,
                0.0194197,
                1.09177,
                0.999218,
                -0.0105914,
                0.0143869,
                1.1022,
                0.999594,
                -0.00693474,
                0.00943517,
                1.11175,
                0.99975,
                -0.00340478,
                0.00464051,
                1.12056,
                1.00001,
                0.000109172,
                -0.000112821,
                1.12853,
                0.983383,
                -0.00000266524,
                0.133358,
                0.0000196534,
                0.981942,
                -0.0000671009,
                0.133162,
                0.000494804,
                0.981946,
                -0.000268405,
                0.133163,
                0.00197923,
                0.981944,
                -0.000603912,
                0.133163,
                0.00445326,
                0.981941,
                -0.00107362,
                0.133162,
                0.00791693,
                0.981946,
                -0.00167755,
                0.133163,
                0.0123703,
                0.981944,
                -0.00241569,
                0.133162,
                0.0178135,
                0.981945,
                -0.00328807,
                0.133163,
                0.0242466,
                0.981945,
                -0.00429472,
                0.133162,
                0.03167,
                0.981955,
                -0.00543573,
                0.133164,
                0.0400846,
                0.981951,
                -0.00671105,
                0.133163,
                0.0494901,
                0.981968,
                -0.00812092,
                0.133165,
                0.0598886,
                0.981979,
                -0.00966541,
                0.133166,
                0.0712811,
                0.981996,
                -0.0113446,
                0.133168,
                0.083669,
                0.982014,
                -0.0131585,
                0.133169,
                0.0970533,
                0.982011,
                -0.0151073,
                0.133167,
                0.111438,
                0.982062,
                -0.0171906,
                0.133172,
                0.126826,
                0.9821,
                -0.0194067,
                0.133175,
                0.143215,
                0.982149,
                -0.0217502,
                0.133176,
                0.160609,
                0.982163,
                -0.0241945,
                0.133173,
                0.178981,
                0.982247,
                -0.0265907,
                0.133148,
                0.198249,
                0.982291,
                -0.027916,
                0.132974,
                0.217795,
                0.982396,
                -0.0299663,
                0.132868,
                0.238042,
                0.982456,
                -0.0334544,
                0.132934,
                0.258901,
                0.982499,
                -0.0378636,
                0.133137,
                0.280639,
                0.982617,
                -0.0409274,
                0.133085,
                0.304604,
                0.98274,
                -0.0438523,
                0.132985,
                0.329376,
                0.982944,
                -0.0462288,
                0.132728,
                0.354697,
                0.98308,
                -0.0475995,
                0.132228,
                0.380102,
                0.983391,
                -0.0501901,
                0.131924,
                0.406256,
                0.983514,
                -0.0535899,
                0.131737,
                0.432735,
                0.98373,
                -0.0571858,
                0.131567,
                0.459359,
                0.984056,
                -0.0592353,
                0.130932,
                0.486637,
                0.984234,
                -0.0610488,
                0.130092,
                0.51509,
                0.984748,
                -0.0630758,
                0.12923,
                0.543461,
                0.985073,
                -0.0647398,
                0.128174,
                0.571376,
                0.985195,
                -0.0671941,
                0.127133,
                0.599414,
                0.985734,
                -0.0681345,
                0.125576,
                0.628134,
                0.986241,
                -0.0686089,
                0.123639,
                0.656399,
                0.986356,
                -0.0698511,
                0.121834,
                0.684258,
                0.986894,
                -0.0700931,
                0.119454,
                0.711818,
                0.987382,
                -0.0698321,
                0.116718,
                0.739511,
                0.988109,
                -0.0693975,
                0.113699,
                0.766267,
                0.988363,
                -0.0689584,
                0.110454,
                0.792456,
                0.989112,
                -0.0672353,
                0.106602,
                0.81813,
                0.989241,
                -0.0662034,
                0.10267,
                0.842889,
                0.990333,
                -0.0638938,
                0.0981381,
                0.867204,
                0.990591,
                -0.0618534,
                0.0935388,
                0.89038,
                0.991106,
                -0.0593117,
                0.088553,
                0.912576,
                0.991919,
                -0.0562676,
                0.0832187,
                0.934118,
                0.992111,
                -0.0534085,
                0.0778302,
                0.954254,
                0.992997,
                -0.0495459,
                0.0720453,
                0.973722,
                0.993317,
                -0.0463707,
                0.0663458,
                0.991949,
                0.994133,
                -0.0421245,
                0.0601883,
                1.00936,
                0.994705,
                -0.0384977,
                0.0542501,
                1.02559,
                0.995495,
                -0.0340956,
                0.0479862,
                1.04083,
                0.996206,
                -0.030105,
                0.041887,
                1.05497,
                0.996971,
                -0.0256095,
                0.0355355,
                1.06824,
                0.997796,
                -0.0213932,
                0.0293655,
                1.08056,
                0.998272,
                -0.0169612,
                0.0232926,
                1.09182,
                0.998857,
                -0.0126756,
                0.0172786,
                1.10219,
                0.99939,
                -0.00832486,
                0.0113156,
                1.11192,
                0.999752,
                -0.00410826,
                0.00557892,
                1.12075,
                1,
                0.000150957,
                -0.000119101,
                1.12885,
                0.975169,
                -0.00000309397,
                0.154669,
                0.0000195073,
                0.975439,
                -0.0000779608,
                0.154712,
                0.000491534,
                0.975464,
                -0.000311847,
                0.154716,
                0.00196617,
                0.975464,
                -0.000701656,
                0.154716,
                0.00442387,
                0.975462,
                -0.0012474,
                0.154715,
                0.0078647,
                0.975461,
                -0.00194906,
                0.154715,
                0.0122886,
                0.975464,
                -0.00280667,
                0.154715,
                0.0176959,
                0.975468,
                -0.00382025,
                0.154716,
                0.0240867,
                0.975471,
                -0.00498985,
                0.154716,
                0.0314612,
                0.975472,
                -0.00631541,
                0.154717,
                0.0398199,
                0.975486,
                -0.00779719,
                0.154718,
                0.0491639,
                0.975489,
                -0.00943505,
                0.154718,
                0.0594932,
                0.975509,
                -0.0112295,
                0.154721,
                0.0708113,
                0.97554,
                -0.0131802,
                0.154724,
                0.0831176,
                0.975557,
                -0.0152876,
                0.154726,
                0.096415,
                0.975585,
                -0.0175512,
                0.154728,
                0.110705,
                0.975605,
                -0.0199713,
                0.154729,
                0.125992,
                0.975645,
                -0.0225447,
                0.154729,
                0.142272,
                0.975711,
                -0.0252649,
                0.154735,
                0.159549,
                0.975788,
                -0.0280986,
                0.154736,
                0.177805,
                0.975872,
                -0.0308232,
                0.154704,
                0.196911,
                0.975968,
                -0.0324841,
                0.154525,
                0.216324,
                0.976063,
                -0.0351281,
                0.154432,
                0.236628,
                0.976157,
                -0.0388618,
                0.15446,
                0.257539,
                0.976204,
                -0.0437704,
                0.154665,
                0.278975,
                0.976358,
                -0.047514,
                0.154652,
                0.302606,
                0.976571,
                -0.0508638,
                0.154535,
                0.327204,
                0.976725,
                -0.0534995,
                0.154221,
                0.352276,
                0.977013,
                -0.0555547,
                0.153737,
                0.377696,
                0.977294,
                -0.0586728,
                0.153403,
                0.403855,
                0.977602,
                -0.0622715,
                0.15312,
                0.430333,
                0.977932,
                -0.0658166,
                0.152755,
                0.456855,
                0.978241,
                -0.0689877,
                0.152233,
                0.483668,
                0.978602,
                -0.0712805,
                0.15132,
                0.512097,
                0.979234,
                -0.0732775,
                0.150235,
                0.540455,
                0.97977,
                -0.075163,
                0.148978,
                0.568486,
                0.979995,
                -0.0778026,
                0.147755,
                0.596524,
                0.98078,
                -0.0791854,
                0.146019,
                0.624825,
                0.981628,
                -0.0799666,
                0.143906,
                0.653403,
                0.982067,
                -0.0808532,
                0.141561,
                0.681445,
                0.98271,
                -0.0816024,
                0.139025,
                0.708918,
                0.983734,
                -0.0812511,
                0.135764,
                0.736594,
                0.98431,
                -0.0806201,
                0.132152,
                0.763576,
                0.985071,
                -0.0801605,
                0.12846,
                0.789797,
                0.98618,
                -0.0784208,
                0.124084,
                0.815804,
                0.986886,
                -0.0766643,
                0.1193,
                0.840869,
                0.987485,
                -0.0747744,
                0.114236,
                0.864952,
                0.988431,
                -0.0716701,
                0.108654,
                0.888431,
                0.988886,
                -0.0691609,
                0.102994,
                0.910963,
                0.990024,
                -0.0654048,
                0.0967278,
                0.932629,
                0.990401,
                -0.0619765,
                0.090384,
                0.95313,
                0.991093,
                -0.0579296,
                0.0837885,
                0.972587,
                0.992018,
                -0.0536576,
                0.0770171,
                0.991184,
                0.992536,
                -0.0493719,
                0.0701486,
                1.00863,
                0.993421,
                -0.0444813,
                0.062953,
                1.02494,
                0.993928,
                -0.040008,
                0.0560455,
                1.04017,
                0.994994,
                -0.0347982,
                0.04856,
                1.05463,
                0.995866,
                -0.0301017,
                0.0416152,
                1.06807,
                0.996916,
                -0.0248225,
                0.0342597,
                1.08039,
                0.997766,
                -0.0199229,
                0.0271668,
                1.09177,
                0.998479,
                -0.0147422,
                0.0201387,
                1.10235,
                0.99921,
                -0.00980173,
                0.0131944,
                1.11206,
                0.999652,
                -0.0047426,
                0.00640712,
                1.12104,
                0.999998,
                0.0000891673,
                -0.00010379,
                1.12906,
                0.967868,
                -0.00000351885,
                0.175947,
                0.0000193569,
                0.968001,
                -0.0000886733,
                0.175972,
                0.000487782,
                0.96801,
                -0.000354697,
                0.175973,
                0.00195115,
                0.968012,
                -0.000798063,
                0.175974,
                0.00439006,
                0.968011,
                -0.00141879,
                0.175973,
                0.00780461,
                0.968011,
                -0.00221686,
                0.175973,
                0.0121948,
                0.968016,
                -0.00319231,
                0.175974,
                0.0175607,
                0.968019,
                -0.00434515,
                0.175974,
                0.0239027,
                0.968018,
                -0.00567538,
                0.175974,
                0.0312208,
                0.968033,
                -0.00718308,
                0.175977,
                0.0395158,
                0.968049,
                -0.00886836,
                0.175979,
                0.0487885,
                0.968047,
                -0.0107312,
                0.175978,
                0.0590394,
                0.968072,
                -0.0127719,
                0.175981,
                0.0702705,
                0.968108,
                -0.0149905,
                0.175986,
                0.0824836,
                0.968112,
                -0.0173866,
                0.175985,
                0.0956783,
                0.968173,
                -0.0199611,
                0.175993,
                0.109862,
                0.96827,
                -0.0227128,
                0.176008,
                0.125033,
                0.968292,
                -0.025639,
                0.17601,
                0.141193,
                0.968339,
                -0.0287299,
                0.176007,
                0.158336,
                0.968389,
                -0.0319399,
                0.176001,
                0.176441,
                0.968501,
                -0.034941,
                0.175962,
                0.195359,
                0.968646,
                -0.0370812,
                0.175793,
                0.214686,
                0.968789,
                -0.0402329,
                0.175708,
                0.234973,
                0.96886,
                -0.0442601,
                0.1757,
                0.255871,
                0.969013,
                -0.049398,
                0.175876,
                0.277238,
                0.969242,
                -0.0539932,
                0.17594,
                0.300326,
                0.969419,
                -0.0577299,
                0.175781,
                0.324702,
                0.969763,
                -0.0605643,
                0.175432,
                0.349527,
                0.970093,
                -0.0634488,
                0.174992,
                0.374976,
                0.970361,
                -0.0670589,
                0.174611,
                0.401097,
                0.970825,
                -0.0708246,
                0.174226,
                0.427496,
                0.971214,
                -0.0742871,
                0.173684,
                0.453858,
                0.971622,
                -0.0782608,
                0.173186,
                0.480637,
                0.972175,
                -0.0813151,
                0.172288,
                0.508655,
                0.972944,
                -0.0832678,
                0.170979,
                0.536973,
                0.973595,
                -0.0855964,
                0.169573,
                0.565138,
                0.974345,
                -0.0882163,
                0.168152,
                0.593222,
                0.975233,
                -0.0901671,
                0.166314,
                0.621201,
                0.976239,
                -0.0912111,
                0.163931,
                0.649919,
                0.977289,
                -0.0916959,
                0.161106,
                0.678011,
                0.978076,
                -0.0927061,
                0.158272,
                0.705717,
                0.979533,
                -0.0925562,
                0.15475,
                0.733228,
                0.980335,
                -0.0918159,
                0.150638,
                0.760454,
                0.981808,
                -0.0908508,
                0.146201,
                0.786918,
                0.983061,
                -0.0896172,
                0.141386,
                0.812953,
                0.984148,
                -0.0871588,
                0.135837,
                0.838281,
                0.985047,
                -0.0850624,
                0.130135,
                0.862594,
                0.986219,
                -0.0818541,
                0.123882,
                0.88633,
                0.987043,
                -0.0784523,
                0.117126,
                0.908952,
                0.988107,
                -0.0749601,
                0.110341,
                0.930744,
                0.988955,
                -0.0703548,
                0.102885,
                0.951728,
                0.989426,
                -0.0662798,
                0.0954167,
                0.971166,
                0.990421,
                -0.0610834,
                0.0876331,
                0.989984,
                0.991032,
                -0.0562936,
                0.0797785,
                1.00765,
                0.992041,
                -0.0508154,
                0.0718166,
                1.02434,
                0.992794,
                -0.0454045,
                0.0637125,
                1.03976,
                0.993691,
                -0.0398194,
                0.0555338,
                1.05418,
                0.994778,
                -0.0341482,
                0.0473388,
                1.06772,
                0.995915,
                -0.028428,
                0.0391016,
                1.08028,
                0.997109,
                -0.022642,
                0.0309953,
                1.09185,
                0.998095,
                -0.0168738,
                0.0230288,
                1.10247,
                0.998985,
                -0.0111274,
                0.0150722,
                1.11229,
                0.999581,
                -0.00543881,
                0.00740605,
                1.12131,
                1.00003,
                0.000162239,
                -0.000105549,
                1.12946,
                0.959505,
                -0.00000393734,
                0.196876,
                0.0000191893,
                0.959599,
                -0.0000992157,
                0.196895,
                0.000483544,
                0.959641,
                -0.000396868,
                0.196903,
                0.0019342,
                0.959599,
                -0.000892948,
                0.196895,
                0.00435193,
                0.959603,
                -0.00158747,
                0.196896,
                0.0077368,
                0.959604,
                -0.00248042,
                0.196896,
                0.0120888,
                0.959605,
                -0.00357184,
                0.196896,
                0.0174082,
                0.959605,
                -0.00486169,
                0.196896,
                0.0236949,
                0.959613,
                -0.00635008,
                0.196897,
                0.0309497,
                0.959619,
                -0.00803696,
                0.196898,
                0.0391725,
                0.959636,
                -0.00992255,
                0.196901,
                0.0483649,
                0.959634,
                -0.0120067,
                0.1969,
                0.0585266,
                0.959675,
                -0.0142898,
                0.196906,
                0.0696609,
                0.959712,
                -0.0167717,
                0.196911,
                0.0817678,
                0.959752,
                -0.0194524,
                0.196918,
                0.0948494,
                0.959807,
                -0.0223321,
                0.196925,
                0.10891,
                0.959828,
                -0.0254091,
                0.196924,
                0.123947,
                0.959906,
                -0.0286815,
                0.196934,
                0.139968,
                0.960005,
                -0.0321371,
                0.196944,
                0.156968,
                0.960071,
                -0.0357114,
                0.196936,
                0.17491,
                0.960237,
                -0.0389064,
                0.196882,
                0.193597,
                0.960367,
                -0.041623,
                0.196731,
                0.21285,
                0.960562,
                -0.0452655,
                0.196654,
                0.233075,
                0.960735,
                -0.0496207,
                0.196643,
                0.253941,
                0.960913,
                -0.0549379,
                0.196774,
                0.275278,
                0.961121,
                -0.0603414,
                0.196893,
                0.297733,
                0.96139,
                -0.0644244,
                0.196717,
                0.321877,
                0.961818,
                -0.067556,
                0.196314,
                0.346476,
                0.962175,
                -0.0712709,
                0.195917,
                0.371907,
                0.96255,
                -0.0752848,
                0.1955,
                0.397916,
                0.963164,
                -0.0792073,
                0.195026,
                0.424229,
                0.963782,
                -0.0828225,
                0.194424,
                0.450637,
                0.964306,
                -0.0873119,
                0.193831,
                0.477288,
                0.964923,
                -0.0911051,
                0.192973,
                0.504716,
                0.966048,
                -0.093251,
                0.19151,
                0.533053,
                0.967024,
                -0.0958983,
                0.190013,
                0.561366,
                0.968038,
                -0.09835,
                0.188253,
                0.589464,
                0.969152,
                -0.100754,
                0.186257,
                0.617433,
                0.970557,
                -0.102239,
                0.183775,
                0.645801,
                0.972104,
                -0.102767,
                0.180645,
                0.674278,
                0.973203,
                -0.103492,
                0.177242,
                0.702004,
                0.975123,
                -0.103793,
                0.17345,
                0.729529,
                0.97641,
                -0.102839,
                0.168886,
                0.756712,
                0.978313,
                -0.101687,
                0.163892,
                0.783801,
                0.980036,
                -0.100314,
                0.158439,
                0.809671,
                0.981339,
                -0.097836,
                0.152211,
                0.835402,
                0.982794,
                -0.0950006,
                0.145679,
                0.860081,
                0.984123,
                -0.0920994,
                0.138949,
                0.883757,
                0.984918,
                -0.0878641,
                0.131283,
                0.90685,
                0.985999,
                -0.083939,
                0.123464,
                0.928786,
                0.987151,
                -0.0791234,
                0.115324,
                0.94983,
                0.987827,
                -0.0739332,
                0.106854,
                0.96962,
                0.988806,
                -0.0688088,
                0.0982691,
                0.98861,
                0.989588,
                -0.0628962,
                0.0893456,
                1.00667,
                0.990438,
                -0.0573146,
                0.0805392,
                1.02344,
                0.991506,
                -0.0509433,
                0.0713725,
                1.03933,
                0.992492,
                -0.0448724,
                0.0623732,
                1.05378,
                0.993663,
                -0.0383497,
                0.0530838,
                1.06747,
                0.994956,
                -0.0319593,
                0.0439512,
                1.08007,
                0.99634,
                -0.025401,
                0.0347803,
                1.09182,
                0.99761,
                -0.0189687,
                0.0257954,
                1.1025,
                0.99863,
                -0.0124441,
                0.0169893,
                1.11247,
                0.99947,
                -0.00614003,
                0.00829498,
                1.12151,
                1.00008,
                0.000216624,
                -0.000146107,
                1.12993,
                0.950129,
                -0.00000434955,
                0.217413,
                0.0000190081,
                0.950264,
                -0.00010957,
                0.217444,
                0.00047884,
                0.9503,
                -0.000438299,
                0.217451,
                0.00191543,
                0.950246,
                -0.000986124,
                0.21744,
                0.00430951,
                0.950246,
                -0.00175311,
                0.21744,
                0.00766137,
                0.950245,
                -0.00273923,
                0.21744,
                0.011971,
                0.950253,
                -0.00394453,
                0.217441,
                0.0172385,
                0.950258,
                -0.00536897,
                0.217442,
                0.0234641,
                0.950267,
                -0.00701262,
                0.217444,
                0.030648,
                0.950277,
                -0.00887551,
                0.217446,
                0.038791,
                0.950284,
                -0.0109576,
                0.217446,
                0.0478931,
                0.950312,
                -0.0132591,
                0.217451,
                0.0579568,
                0.950334,
                -0.01578,
                0.217454,
                0.0689821,
                0.950378,
                -0.0185204,
                0.217462,
                0.0809714,
                0.950417,
                -0.0214803,
                0.217467,
                0.0939265,
                0.950488,
                -0.0246594,
                0.217479,
                0.10785,
                0.950534,
                -0.0280565,
                0.217483,
                0.122743,
                0.950633,
                -0.0316685,
                0.217498,
                0.138611,
                0.950698,
                -0.0354787,
                0.217499,
                0.155442,
                0.950844,
                -0.0394003,
                0.217507,
                0.173208,
                0.950999,
                -0.0426812,
                0.217419,
                0.191605,
                0.951221,
                -0.0461302,
                0.217317,
                0.21084,
                0.951412,
                -0.0502131,
                0.217238,
                0.230945,
                0.951623,
                -0.0549183,
                0.21722,
                0.251745,
                0.951867,
                -0.0604493,
                0.217306,
                0.273001,
                0.952069,
                -0.0665189,
                0.217466,
                0.294874,
                0.952459,
                -0.0709179,
                0.217266,
                0.318732,
                0.952996,
                -0.0746112,
                0.216891,
                0.34318,
                0.953425,
                -0.0789252,
                0.216503,
                0.36849,
                0.953885,
                -0.0833293,
                0.216042,
                0.394373,
                0.954617,
                -0.087371,
                0.215469,
                0.420505,
                0.955429,
                -0.0914054,
                0.214802,
                0.446907,
                0.956068,
                -0.0961671,
                0.214146,
                0.473522,
                0.957094,
                -0.10048,
                0.213286,
                0.50052,
                0.958372,
                -0.103248,
                0.211796,
                0.528715,
                0.959654,
                -0.106033,
                0.21016,
                0.557065,
                0.961305,
                -0.108384,
                0.208149,
                0.585286,
                0.962785,
                -0.111122,
                0.206024,
                0.613334,
                0.964848,
                -0.112981,
                0.203442,
                0.641334,
                0.966498,
                -0.113717,
                0.19996,
                0.669955,
                0.968678,
                -0.114121,
                0.196105,
                0.698094,
                0.970489,
                -0.114524,
                0.191906,
                0.725643,
                0.972903,
                -0.113792,
                0.186963,
                0.752856,
                0.974701,
                -0.112406,
                0.181343,
                0.780013,
                0.976718,
                -0.110685,
                0.175185,
                0.806268,
                0.978905,
                -0.108468,
                0.168535,
                0.832073,
                0.980267,
                -0.105061,
                0.161106,
                0.857149,
                0.981967,
                -0.101675,
                0.153387,
                0.881145,
                0.983063,
                -0.0974492,
                0.145199,
                0.904255,
                0.984432,
                -0.0925815,
                0.136527,
                0.926686,
                0.985734,
                -0.0877983,
                0.127584,
                0.947901,
                0.986228,
                -0.081884,
                0.118125,
                0.968111,
                0.98719,
                -0.0761208,
                0.108594,
                0.98719,
                0.988228,
                -0.0698196,
                0.0989996,
                1.00559,
                0.989046,
                -0.0632739,
                0.0890074,
                1.02246,
                0.990242,
                -0.056522,
                0.0790832,
                1.03841,
                0.991252,
                -0.0495272,
                0.0689182,
                1.05347,
                0.992542,
                -0.0425373,
                0.0588592,
                1.06724,
                0.994096,
                -0.0353198,
                0.0486833,
                1.08009,
                0.995593,
                -0.028235,
                0.0385977,
                1.09177,
                0.99711,
                -0.0209511,
                0.0286457,
                1.10274,
                0.998263,
                -0.0139289,
                0.0188497,
                1.11262,
                0.999254,
                -0.0067359,
                0.009208,
                1.12191,
                0.999967,
                0.000141846,
                -0.0000657764,
                1.13024,
                0.935608,
                -0.00000474692,
                0.236466,
                0.0000187817,
                0.93996,
                -0.00011971,
                0.237568,
                0.000473646,
                0.939959,
                -0.000478845,
                0.237567,
                0.0018946,
                0.939954,
                -0.0010774,
                0.237566,
                0.00426284,
                0.939956,
                -0.00191538,
                0.237566,
                0.00757842,
                0.939954,
                -0.00299277,
                0.237566,
                0.0118413,
                0.93996,
                -0.00430961,
                0.237567,
                0.0170518,
                0.939969,
                -0.00586589,
                0.237569,
                0.02321,
                0.939982,
                -0.00766166,
                0.237572,
                0.0303164,
                0.939987,
                -0.00969686,
                0.237572,
                0.0383711,
                0.939997,
                -0.0119715,
                0.237574,
                0.0473751,
                0.940031,
                -0.0144858,
                0.237581,
                0.0573298,
                0.940073,
                -0.0172399,
                0.237589,
                0.0682366,
                0.94012,
                -0.0202335,
                0.237598,
                0.080097,
                0.940162,
                -0.0234663,
                0.237604,
                0.0929116,
                0.940237,
                -0.0269387,
                0.237615,
                0.106686,
                0.940328,
                -0.0306489,
                0.237632,
                0.121421,
                0.940419,
                -0.0345917,
                0.237645,
                0.137115,
                0.940522,
                -0.0387481,
                0.237654,
                0.153766,
                0.940702,
                -0.0429906,
                0.237661,
                0.17133,
                0.940871,
                -0.0465089,
                0.237561,
                0.189502,
                0.941103,
                -0.050531,
                0.23748,
                0.208616,
                0.941369,
                -0.0550657,
                0.237423,
                0.228595,
                0.941641,
                -0.0601337,
                0.237399,
                0.249287,
                0.941903,
                -0.0658804,
                0.237443,
                0.270467,
                0.942224,
                -0.0722674,
                0.237597,
                0.292024,
                0.942633,
                -0.0771788,
                0.237419,
                0.315272,
                0.943172,
                -0.0815623,
                0.237068,
                0.339579,
                0.943691,
                -0.0863973,
                0.236682,
                0.364717,
                0.944382,
                -0.0911536,
                0.236213,
                0.390435,
                0.945392,
                -0.0952967,
                0.235562,
                0.416425,
                0.946185,
                -0.0998948,
                0.234832,
                0.442772,
                0.947212,
                -0.104796,
                0.234114,
                0.469347,
                0.948778,
                -0.10928,
                0.233222,
                0.496162,
                0.950149,
                -0.113081,
                0.231845,
                0.523978,
                0.951989,
                -0.115893,
                0.230005,
                0.552295,
                0.953921,
                -0.11846,
                0.227862,
                0.580569,
                0.955624,
                -0.12115,
                0.225439,
                0.608698,
                0.958234,
                -0.123373,
                0.222635,
                0.636696,
                0.960593,
                -0.124519,
                0.219093,
                0.665208,
                0.963201,
                -0.124736,
                0.214749,
                0.693557,
                0.965642,
                -0.125012,
                0.210059,
                0.721334,
                0.968765,
                -0.124661,
                0.204935,
                0.748613,
                0.971753,
                -0.122996,
                0.198661,
                0.776224,
                0.973751,
                -0.120998,
                0.191823,
                0.802461,
                0.976709,
                -0.118583,
                0.184359,
                0.828399,
                0.977956,
                -0.115102,
                0.176437,
                0.853693,
                0.979672,
                -0.111077,
                0.167681,
                0.877962,
                0.981816,
                -0.10688,
                0.158872,
                0.901564,
                0.98238,
                -0.101469,
                0.149398,
                0.924057,
                0.983964,
                -0.0960013,
                0.139436,
                0.945751,
                0.984933,
                -0.0899626,
                0.12943,
                0.966272,
                0.985694,
                -0.0832973,
                0.11894,
                0.985741,
                0.986822,
                -0.0767082,
                0.108349,
                1.00407,
                0.987725,
                -0.0693614,
                0.0976026,
                1.02154,
                0.98877,
                -0.06211,
                0.086652,
                1.03757,
                0.990129,
                -0.0544143,
                0.0756182,
                1.05296,
                0.991337,
                -0.046744,
                0.0645753,
                1.06683,
                0.992978,
                -0.0387931,
                0.0534683,
                1.0798,
                0.994676,
                -0.030973,
                0.0424137,
                1.09181,
                0.99645,
                -0.0230311,
                0.0314035,
                1.10286,
                0.997967,
                -0.0152065,
                0.0206869,
                1.11291,
                0.99922,
                -0.00744837,
                0.010155,
                1.12237,
                1.00002,
                0.000240209,
                -0.0000752767,
                1.13089,
                0.922948,
                -0.00000515351,
                0.255626,
                0.0000186069,
                0.928785,
                -0.000129623,
                0.257244,
                0.000468009,
                0.928761,
                -0.00051849,
                0.257237,
                0.00187202,
                0.928751,
                -0.0011666,
                0.257235,
                0.00421204,
                0.928751,
                -0.00207395,
                0.257234,
                0.0074881,
                0.928754,
                -0.00324055,
                0.257235,
                0.0117002,
                0.92876,
                -0.00466639,
                0.257236,
                0.0168486,
                0.928763,
                -0.00635149,
                0.257237,
                0.0229334,
                0.928774,
                -0.00829584,
                0.257239,
                0.029955,
                0.928791,
                -0.0104995,
                0.257243,
                0.0379139,
                0.928804,
                -0.0129623,
                0.257245,
                0.0468108,
                0.928847,
                -0.0156846,
                0.257255,
                0.0566473,
                0.92889,
                -0.0186661,
                0.257263,
                0.0674246,
                0.928924,
                -0.0219067,
                0.257268,
                0.0791433,
                0.928989,
                -0.0254066,
                0.257282,
                0.0918076,
                0.92909,
                -0.0291651,
                0.257301,
                0.105419,
                0.92918,
                -0.0331801,
                0.257316,
                0.119978,
                0.92929,
                -0.0374469,
                0.257332,
                0.135491,
                0.929453,
                -0.041939,
                0.257357,
                0.151948,
                0.929586,
                -0.0464612,
                0.257347,
                0.169275,
                0.929858,
                -0.0503426,
                0.257269,
                0.187257,
                0.930125,
                -0.0548409,
                0.257199,
                0.206204,
                0.930403,
                -0.0598063,
                0.257149,
                0.22601,
                0.930726,
                -0.0652437,
                0.257122,
                0.246561,
                0.931098,
                -0.0712376,
                0.257153,
                0.267618,
                0.931396,
                -0.0777506,
                0.257237,
                0.288993,
                0.931947,
                -0.0832374,
                0.257124,
                0.311527,
                0.932579,
                -0.0883955,
                0.25683,
                0.335697,
                0.933194,
                -0.0937037,
                0.256444,
                0.360634,
                0.934013,
                -0.0987292,
                0.255939,
                0.386126,
                0.935307,
                -0.103215,
                0.255282,
                0.412018,
                0.936374,
                -0.108234,
                0.254538,
                0.438292,
                0.93776,
                -0.113234,
                0.253728,
                0.464805,
                0.939599,
                -0.118013,
                0.25275,
                0.491464,
                0.941036,
                -0.122661,
                0.251404,
                0.518751,
                0.94337,
                -0.125477,
                0.249435,
                0.547133,
                0.945318,
                -0.128374,
                0.247113,
                0.575456,
                0.947995,
                -0.130996,
                0.244441,
                0.60372,
                0.950818,
                -0.133438,
                0.241352,
                0.63174,
                0.954378,
                -0.135004,
                0.237849,
                0.659971,
                0.957151,
                -0.135313,
                0.233188,
                0.688478,
                0.960743,
                -0.13521,
                0.228001,
                0.716767,
                0.964352,
                -0.135007,
                0.222249,
                0.744349,
                0.967273,
                -0.133523,
                0.21542,
                0.771786,
                0.969767,
                -0.131155,
                0.208039,
                0.798639,
                0.973195,
                -0.128492,
                0.200076,
                0.824774,
                0.975557,
                -0.125094,
                0.191451,
                0.850222,
                0.977692,
                -0.120578,
                0.18184,
                0.874761,
                0.98026,
                -0.115882,
                0.172102,
                0.898497,
                0.981394,
                -0.110372,
                0.161859,
                0.921636,
                0.982386,
                -0.10415,
                0.15108,
                0.943467,
                0.983783,
                -0.0978128,
                0.140407,
                0.964045,
                0.98422,
                -0.0906171,
                0.129058,
                0.98398,
                0.985447,
                -0.0832921,
                0.117614,
                1.00276,
                0.986682,
                -0.0754412,
                0.10585,
                1.02047,
                0.987326,
                -0.0673885,
                0.0940943,
                1.03678,
                0.988707,
                -0.0592565,
                0.0822093,
                1.05218,
                0.990185,
                -0.050717,
                0.070192,
                1.06652,
                0.991866,
                -0.0423486,
                0.0582081,
                1.07965,
                0.993897,
                -0.0336118,
                0.0460985,
                1.09188,
                0.995841,
                -0.0252178,
                0.0342737,
                1.10307,
                0.997605,
                -0.0164893,
                0.0224829,
                1.11324,
                0.999037,
                -0.00817112,
                0.0110647,
                1.12262,
                1.00003,
                0.000291686,
                -0.000168673,
                1.13139,
                0.915304,
                -0.00000552675,
                0.275999,
                0.0000183285,
                0.91668,
                -0.000139285,
                0.276414,
                0.000461914,
                0.916664,
                -0.00055713,
                0.276409,
                0.00184763,
                0.916653,
                -0.00125354,
                0.276406,
                0.00415715,
                0.916651,
                -0.00222851,
                0.276405,
                0.00739053,
                0.916655,
                -0.00348205,
                0.276406,
                0.0115478,
                0.916653,
                -0.00501414,
                0.276405,
                0.0166291,
                0.916667,
                -0.00682478,
                0.276409,
                0.0226346,
                0.91668,
                -0.00891398,
                0.276412,
                0.0295648,
                0.91669,
                -0.0112817,
                0.276413,
                0.0374199,
                0.916727,
                -0.013928,
                0.276422,
                0.0462016,
                0.916759,
                -0.0168528,
                0.276429,
                0.0559101,
                0.916793,
                -0.0200558,
                0.276436,
                0.0665466,
                0.916849,
                -0.0235373,
                0.276448,
                0.0781139,
                0.916964,
                -0.0272973,
                0.276474,
                0.0906156,
                0.917047,
                -0.0313344,
                0.276491,
                0.104051,
                0.917152,
                -0.0356465,
                0.276511,
                0.118424,
                0.917286,
                -0.0402271,
                0.276533,
                0.133736,
                0.917469,
                -0.0450408,
                0.276564,
                0.149978,
                0.917686,
                -0.0497872,
                0.276563,
                0.167057,
                0.917953,
                -0.0540937,
                0.276493,
                0.184846,
                0.918228,
                -0.0590709,
                0.276437,
                0.203614,
                0.918572,
                -0.0644277,
                0.276398,
                0.223212,
                0.918918,
                -0.0702326,
                0.276362,
                0.243584,
                0.919356,
                -0.076484,
                0.276383,
                0.264465,
                0.919842,
                -0.0830808,
                0.276434,
                0.285701,
                0.920451,
                -0.0892972,
                0.276407,
                0.307559,
                0.921113,
                -0.095016,
                0.276128,
                0.331501,
                0.921881,
                -0.100771,
                0.275754,
                0.356207,
                0.923027,
                -0.106029,
                0.275254,
                0.381477,
                0.924364,
                -0.111029,
                0.274595,
                0.40722,
                0.925818,
                -0.116345,
                0.273841,
                0.433385,
                0.92746,
                -0.121424,
                0.272913,
                0.459848,
                0.929167,
                -0.12657,
                0.271837,
                0.486493,
                0.931426,
                -0.131581,
                0.270575,
                0.513432,
                0.934001,
                -0.135038,
                0.268512,
                0.541502,
                0.936296,
                -0.138039,
                0.266135,
                0.569658,
                0.939985,
                -0.140687,
                0.263271,
                0.598375,
                0.943516,
                -0.143247,
                0.260058,
                0.626563,
                0.94782,
                -0.145135,
                0.256138,
                0.654711,
                0.951023,
                -0.145733,
                0.251154,
                0.683285,
                0.955338,
                -0.145554,
                0.245562,
                0.711831,
                0.959629,
                -0.145008,
                0.239265,
                0.739573,
                0.963123,
                -0.144003,
                0.232064,
                0.767027,
                0.966742,
                -0.141289,
                0.224036,
                0.794359,
                0.969991,
                -0.138247,
                0.215305,
                0.820361,
                0.973403,
                -0.134786,
                0.206051,
                0.846548,
                0.975317,
                -0.129966,
                0.195914,
                0.871541,
                0.977647,
                -0.12471,
                0.185184,
                0.895313,
                0.980137,
                -0.119086,
                0.174161,
                0.918398,
                0.981031,
                -0.112297,
                0.162792,
                0.940679,
                0.982037,
                -0.105372,
                0.150952,
                0.961991,
                0.983164,
                -0.097821,
                0.138921,
                0.981913,
                0.983757,
                -0.0897245,
                0.126611,
                1.00109,
                0.985036,
                -0.0815974,
                0.114228,
                1.01902,
                0.986289,
                -0.0727725,
                0.101389,
                1.03604,
                0.987329,
                -0.0639323,
                0.0886476,
                1.05149,
                0.989193,
                -0.0548109,
                0.0756837,
                1.06619,
                0.990716,
                -0.045687,
                0.0627581,
                1.07948,
                0.992769,
                -0.0364315,
                0.0498337,
                1.09172,
                0.99524,
                -0.0271761,
                0.0370305,
                1.1033,
                0.997154,
                -0.0179609,
                0.0243959,
                1.11353,
                0.998845,
                -0.00878063,
                0.0119567,
                1.12319,
                1.00002,
                0.000259038,
                -0.000108146,
                1.13177,
                0.903945,
                -0.00000591681,
                0.295126,
                0.0000181226,
                0.903668,
                -0.000148672,
                0.295037,
                0.000455367,
                0.903677,
                -0.000594683,
                0.29504,
                0.00182145,
                0.903673,
                -0.00133805,
                0.295039,
                0.00409831,
                0.903666,
                -0.00237872,
                0.295036,
                0.00728584,
                0.903668,
                -0.00371676,
                0.295037,
                0.0113842,
                0.903679,
                -0.00535212,
                0.29504,
                0.0163936,
                0.903684,
                -0.00728479,
                0.295041,
                0.0223141,
                0.903698,
                -0.00951473,
                0.295044,
                0.0291462,
                0.903718,
                -0.0120419,
                0.295049,
                0.0368904,
                0.903754,
                -0.0148664,
                0.295058,
                0.0455477,
                0.903801,
                -0.017988,
                0.29507,
                0.0551194,
                0.903851,
                -0.0214064,
                0.295082,
                0.0656058,
                0.903921,
                -0.0251219,
                0.295097,
                0.0770109,
                0.904002,
                -0.0291337,
                0.295116,
                0.0893354,
                0.904111,
                -0.033441,
                0.29514,
                0.102583,
                0.904246,
                -0.0380415,
                0.295169,
                0.116755,
                0.904408,
                -0.0429258,
                0.295202,
                0.131853,
                0.904637,
                -0.0480468,
                0.295245,
                0.147869,
                0.904821,
                -0.0529208,
                0.295214,
                0.164658,
                0.905163,
                -0.0577748,
                0.295185,
                0.182274,
                0.905469,
                -0.0631763,
                0.295143,
                0.200828,
                0.905851,
                -0.068917,
                0.295112,
                0.2202,
                0.906322,
                -0.0750861,
                0.295104,
                0.240372,
                0.906761,
                -0.0815855,
                0.295086,
                0.261082,
                0.90735,
                -0.0882138,
                0.295095,
                0.282123,
                0.908087,
                -0.095082,
                0.295139,
                0.303563,
                0.908826,
                -0.101488,
                0.29492,
                0.327028,
                0.909832,
                -0.107577,
                0.294577,
                0.351464,
                0.911393,
                -0.113033,
                0.294115,
                0.376497,
                0.912804,
                -0.118629,
                0.293446,
                0.402115,
                0.914081,
                -0.124232,
                0.292581,
                0.428111,
                0.91637,
                -0.129399,
                0.29166,
                0.454442,
                0.91814,
                -0.134892,
                0.290422,
                0.481024,
                0.921179,
                -0.140069,
                0.289194,
                0.507924,
                0.924544,
                -0.144431,
                0.287421,
                0.535557,
                0.927995,
                -0.147498,
                0.284867,
                0.563984,
                0.931556,
                -0.150197,
                0.281722,
                0.5923,
                0.935777,
                -0.152711,
                0.278207,
                0.620832,
                0.940869,
                -0.154836,
                0.274148,
                0.649069,
                0.945994,
                -0.155912,
                0.269057,
                0.677746,
                0.949634,
                -0.155641,
                0.262799,
                0.706293,
                0.955032,
                -0.154809,
                0.256097,
                0.734278,
                0.95917,
                -0.153678,
                0.248618,
                0.761751,
                0.962931,
                -0.151253,
                0.239794,
                0.789032,
                0.966045,
                -0.147625,
                0.230281,
                0.815422,
                0.96971,
                -0.143964,
                0.220382,
                0.841787,
                0.972747,
                -0.139464,
                0.209846,
                0.867446,
                0.975545,
                -0.133459,
                0.198189,
                0.892004,
                0.978381,
                -0.127424,
                0.186362,
                0.915458,
                0.979935,
                -0.120506,
                0.173964,
                0.937948,
                0.980948,
                -0.11282,
                0.161429,
                0.959732,
                0.982234,
                -0.104941,
                0.148557,
                0.980118,
                0.982767,
                -0.0962905,
                0.135508,
                0.999463,
                0.983544,
                -0.0873625,
                0.122338,
                1.01756,
                0.984965,
                -0.0783447,
                0.108669,
                1.03492,
                0.986233,
                -0.0684798,
                0.0949911,
                1.05087,
                0.987796,
                -0.0590867,
                0.0811386,
                1.0656,
                0.989885,
                -0.0489145,
                0.0673099,
                1.0794,
                0.991821,
                -0.0391,
                0.0535665,
                1.09174,
                0.99448,
                -0.029087,
                0.0397529,
                1.10341,
                0.996769,
                -0.019114,
                0.0261463,
                1.11383,
                0.998641,
                -0.00947007,
                0.0128731,
                1.1237,
                0.999978,
                0.000446316,
                -0.000169093,
                1.13253,
                0.888362,
                -0.00000627064,
                0.312578,
                0.0000178215,
                0.889988,
                -0.000157791,
                0.313148,
                0.000448451,
                0.889825,
                -0.000631076,
                0.313092,
                0.00179356,
                0.88984,
                -0.00141994,
                0.313097,
                0.00403554,
                0.889828,
                -0.0025243,
                0.313092,
                0.00717429,
                0.889831,
                -0.00394421,
                0.313093,
                0.0112099,
                0.889831,
                -0.00567962,
                0.313093,
                0.0161425,
                0.889844,
                -0.00773051,
                0.313096,
                0.0219724,
                0.889858,
                -0.0100968,
                0.3131,
                0.0286999,
                0.889882,
                -0.0127786,
                0.313106,
                0.0363256,
                0.889918,
                -0.0157757,
                0.313116,
                0.0448509,
                0.889967,
                -0.0190878,
                0.313129,
                0.0542758,
                0.89003,
                -0.022715,
                0.313145,
                0.0646032,
                0.890108,
                -0.0266566,
                0.313165,
                0.0758339,
                0.890218,
                -0.0309131,
                0.313193,
                0.0879729,
                0.890351,
                -0.0354819,
                0.313226,
                0.101019,
                0.89051,
                -0.0403613,
                0.313263,
                0.114979,
                0.890672,
                -0.0455385,
                0.313294,
                0.129848,
                0.890882,
                -0.0509444,
                0.313333,
                0.145616,
                0.891189,
                -0.0559657,
                0.313324,
                0.162122,
                0.891457,
                -0.0613123,
                0.313281,
                0.179524,
                0.891856,
                -0.0671488,
                0.313281,
                0.197855,
                0.892312,
                -0.0732732,
                0.313268,
                0.216991,
                0.892819,
                -0.0797865,
                0.313263,
                0.236924,
                0.893369,
                -0.0865269,
                0.313247,
                0.257433,
                0.894045,
                -0.0931592,
                0.313205,
                0.278215,
                0.894884,
                -0.100532,
                0.313276,
                0.299467,
                0.895832,
                -0.107716,
                0.313205,
                0.322276,
                0.897043,
                -0.114099,
                0.312873,
                0.34642,
                0.898515,
                -0.119941,
                0.312331,
                0.371187,
                0.900191,
                -0.126044,
                0.311731,
                0.396656,
                0.90188,
                -0.131808,
                0.310859,
                0.422488,
                0.904359,
                -0.137289,
                0.309857,
                0.448744,
                0.906923,
                -0.142991,
                0.308714,
                0.475239,
                0.910634,
                -0.148253,
                0.307465,
                0.501983,
                0.914502,
                -0.153332,
                0.305774,
                0.529254,
                0.919046,
                -0.156646,
                0.303156,
                0.557709,
                0.923194,
                -0.159612,
                0.299928,
                0.586267,
                0.928858,
                -0.162027,
                0.296245,
                0.614925,
                0.934464,
                -0.164203,
                0.291832,
                0.643187,
                0.939824,
                -0.165602,
                0.286565,
                0.671601,
                0.944582,
                -0.165383,
                0.280073,
                0.700213,
                0.949257,
                -0.164439,
                0.272891,
                0.728432,
                0.954389,
                -0.162953,
                0.264771,
                0.756082,
                0.958595,
                -0.161007,
                0.255927,
                0.78369,
                0.962138,
                -0.157243,
                0.245769,
                0.810769,
                0.966979,
                -0.152872,
                0.235127,
                0.836999,
                0.969566,
                -0.148209,
                0.22347,
                0.862684,
                0.972372,
                -0.142211,
                0.211147,
                0.887847,
                0.975916,
                -0.135458,
                0.198606,
                0.911843,
                0.978026,
                -0.128398,
                0.185498,
                0.934795,
                0.979686,
                -0.120313,
                0.17171,
                0.956787,
                0.980748,
                -0.11166,
                0.158159,
                0.978046,
                0.981622,
                -0.103035,
                0.144399,
                0.997693,
                0.982356,
                -0.0930328,
                0.13001,
                1.01642,
                0.983308,
                -0.0834627,
                0.115778,
                1.03366,
                0.985037,
                -0.0732249,
                0.101327,
                1.05014,
                0.986493,
                -0.0628145,
                0.086554,
                1.06507,
                0.988484,
                -0.0526556,
                0.0720413,
                1.07907,
                0.991051,
                -0.0415744,
                0.0571151,
                1.09189,
                0.993523,
                -0.0314275,
                0.0426643,
                1.10369,
                0.99628,
                -0.0203603,
                0.0279325,
                1.11423,
                0.998344,
                -0.0102446,
                0.0138182,
                1.12421,
                0.999997,
                0.00042612,
                -0.000193628,
                1.1333,
                0.871555,
                -0.00000660007,
                0.329176,
                0.0000174749,
                0.875255,
                -0.000166579,
                0.330571,
                0.000441051,
                0.875644,
                -0.000666394,
                0.330718,
                0.00176441,
                0.875159,
                -0.00149903,
                0.330536,
                0.00396899,
                0.87516,
                -0.00266493,
                0.330536,
                0.007056,
                0.875158,
                -0.00416393,
                0.330535,
                0.0110251,
                0.87516,
                -0.00599598,
                0.330535,
                0.0158764,
                0.875163,
                -0.00816108,
                0.330536,
                0.0216101,
                0.875174,
                -0.0106591,
                0.330538,
                0.0282266,
                0.875199,
                -0.0134899,
                0.330545,
                0.0357266,
                0.875257,
                -0.0166538,
                0.330563,
                0.0441117,
                0.875304,
                -0.0201501,
                0.330575,
                0.0533821,
                0.875373,
                -0.0239785,
                0.330595,
                0.0635395,
                0.875464,
                -0.0281389,
                0.330619,
                0.0745872,
                0.875565,
                -0.0326301,
                0.330645,
                0.0865255,
                0.875691,
                -0.0374516,
                0.330676,
                0.0993599,
                0.875897,
                -0.0425993,
                0.330733,
                0.113093,
                0.876091,
                -0.0480576,
                0.330776,
                0.127722,
                0.876353,
                -0.0537216,
                0.330826,
                0.143227,
                0.876649,
                -0.0589807,
                0.330809,
                0.159462,
                0.877034,
                -0.0647865,
                0.330819,
                0.176642,
                0.877443,
                -0.0709789,
                0.330817,
                0.194702,
                0.877956,
                -0.0774782,
                0.330832,
                0.213577,
                0.878499,
                -0.0843175,
                0.330822,
                0.233246,
                0.879144,
                -0.0912714,
                0.330804,
                0.253512,
                0.879982,
                -0.0980824,
                0.330766,
                0.274137,
                0.88097,
                -0.105823,
                0.330864,
                0.295209,
                0.882051,
                -0.113671,
                0.330896,
                0.317226,
                0.883397,
                -0.120303,
                0.330545,
                0.341068,
                0.884987,
                -0.12667,
                0.330068,
                0.365613,
                0.886789,
                -0.133118,
                0.329418,
                0.390807,
                0.889311,
                -0.139024,
                0.328683,
                0.416494,
                0.891995,
                -0.144971,
                0.327729,
                0.442618,
                0.895106,
                -0.150747,
                0.326521,
                0.469131,
                0.899527,
                -0.156283,
                0.325229,
                0.495921,
                0.90504,
                -0.161707,
                0.32378,
                0.523162,
                0.909875,
                -0.165661,
                0.32122,
                0.55092,
                0.91561,
                -0.168755,
                0.317942,
                0.579928,
                0.921225,
                -0.171193,
                0.313983,
                0.608539,
                0.927308,
                -0.17319,
                0.309636,
                0.636854,
                0.933077,
                -0.174819,
                0.304262,
                0.66523,
                0.938766,
                -0.175002,
                0.297563,
                0.693609,
                0.943667,
                -0.173946,
                0.289613,
                0.722157,
                0.949033,
                -0.172221,
                0.281227,
                0.750021,
                0.953765,
                -0.169869,
                0.271545,
                0.777466,
                0.95804,
                -0.166578,
                0.261034,
                0.804853,
                0.962302,
                -0.161761,
                0.249434,
                0.831569,
                0.966544,
                -0.156636,
                0.237484,
                0.857779,
                0.969372,
                -0.150784,
                0.224395,
                0.883051,
                0.972486,
                -0.143672,
                0.210786,
                0.907864,
                0.975853,
                -0.135772,
                0.196556,
                0.931223,
                0.977975,
                -0.127942,
                0.182307,
                0.954061,
                0.979122,
                -0.118347,
                0.167607,
                0.97531,
                0.980719,
                -0.109112,
                0.152739,
                0.995666,
                0.981223,
                -0.0991789,
                0.137932,
                1.01475,
                0.98216,
                -0.0883553,
                0.122692,
                1.03253,
                0.983379,
                -0.0780825,
                0.107493,
                1.04917,
                0.985434,
                -0.0665646,
                0.0917791,
                1.06464,
                0.987332,
                -0.0557714,
                0.0764949,
                1.07896,
                0.990004,
                -0.0442805,
                0.060721,
                1.09199,
                0.992975,
                -0.0331676,
                0.0452284,
                1.10393,
                0.995811,
                -0.0219547,
                0.0297934,
                1.11476,
                0.9982,
                -0.0107613,
                0.0146415,
                1.12484,
                1.00002,
                0.000248678,
                -0.00014555,
                1.13413,
                0.859519,
                -0.00000693595,
                0.347264,
                0.0000171673,
                0.859843,
                -0.00017503,
                0.347394,
                0.000433219,
                0.859656,
                -0.000700076,
                0.347319,
                0.00173277,
                0.859671,
                -0.00157517,
                0.347325,
                0.00389875,
                0.859669,
                -0.00280028,
                0.347324,
                0.00693112,
                0.85967,
                -0.0043754,
                0.347324,
                0.01083,
                0.859665,
                -0.00630049,
                0.347321,
                0.0155954,
                0.859685,
                -0.0085755,
                0.347328,
                0.0212278,
                0.859694,
                -0.0112003,
                0.347329,
                0.0277273,
                0.859718,
                -0.0141747,
                0.347336,
                0.0350946,
                0.85976,
                -0.0174988,
                0.347348,
                0.0433314,
                0.85982,
                -0.0211722,
                0.347366,
                0.0524384,
                0.859892,
                -0.0251941,
                0.347387,
                0.0624168,
                0.860006,
                -0.0295649,
                0.347422,
                0.0732708,
                0.860122,
                -0.0342825,
                0.347453,
                0.0849999,
                0.860282,
                -0.0393462,
                0.347499,
                0.0976102,
                0.860482,
                -0.0447513,
                0.347554,
                0.111104,
                0.860719,
                -0.0504775,
                0.347614,
                0.125479,
                0.860998,
                -0.0563577,
                0.347666,
                0.140703,
                0.861322,
                -0.0619473,
                0.347662,
                0.156681,
                0.861724,
                -0.0681277,
                0.347684,
                0.173597,
                0.862198,
                -0.0746567,
                0.347709,
                0.191371,
                0.862733,
                -0.0815234,
                0.347727,
                0.209976,
                0.863371,
                -0.0886643,
                0.347744,
                0.229351,
                0.86414,
                -0.0957908,
                0.347734,
                0.24934,
                0.865138,
                -0.102912,
                0.34772,
                0.269797,
                0.866182,
                -0.110924,
                0.3478,
                0.290654,
                0.867436,
                -0.119223,
                0.347911,
                0.312074,
                0.869087,
                -0.126197,
                0.347649,
                0.335438,
                0.870859,
                -0.133145,
                0.347222,
                0.359732,
                0.872997,
                -0.139869,
                0.346645,
                0.38467,
                0.875939,
                -0.146089,
                0.345935,
                0.41019,
                0.879012,
                -0.152334,
                0.345012,
                0.436218,
                0.883353,
                -0.15821,
                0.343924,
                0.462641,
                0.888362,
                -0.164097,
                0.342636,
                0.489449,
                0.895026,
                -0.169528,
                0.341351,
                0.516629,
                0.900753,
                -0.174408,
                0.339115,
                0.544109,
                0.906814,
                -0.17751,
                0.335809,
                0.572857,
                0.912855,
                -0.180101,
                0.331597,
                0.601554,
                0.919438,
                -0.182116,
                0.32698,
                0.630198,
                0.925962,
                -0.183494,
                0.321449,
                0.658404,
                0.931734,
                -0.184159,
                0.314595,
                0.686625,
                0.93762,
                -0.18304,
                0.306462,
                0.71531,
                0.943858,
                -0.181323,
                0.297514,
                0.744272,
                0.948662,
                -0.178683,
                0.287447,
                0.771462,
                0.953299,
                -0.175379,
                0.276166,
                0.798593,
                0.957346,
                -0.170395,
                0.263758,
                0.8256,
                0.962565,
                -0.165042,
                0.251019,
                0.852575,
                0.966075,
                -0.158655,
                0.237011,
                0.878316,
                0.969048,
                -0.151707,
                0.222518,
                0.90329,
                0.972423,
                -0.143271,
                0.207848,
                0.927745,
                0.975833,
                -0.134824,
                0.192463,
                0.950859,
                0.977629,
                -0.125444,
                0.1768,
                0.972947,
                0.978995,
                -0.114949,
                0.161033,
                0.993263,
                0.980533,
                -0.104936,
                0.145523,
                1.01337,
                0.980745,
                -0.0935577,
                0.129799,
                1.03128,
                0.981814,
                -0.0822956,
                0.113486,
                1.04825,
                0.983943,
                -0.0710082,
                0.0972925,
                1.06405,
                0.986141,
                -0.0587931,
                0.0808138,
                1.0785,
                0.988878,
                -0.0472755,
                0.0644915,
                1.09204,
                0.992132,
                -0.0349128,
                0.0478128,
                1.10413,
                0.9953,
                -0.0232407,
                0.031621,
                1.11527,
                0.998117,
                -0.0112713,
                0.0154935,
                1.12551,
                1.00003,
                0.000339743,
                -0.000195763,
                1.13504,
                0.845441,
                -0.00000729126,
                0.364305,
                0.0000169208,
                0.843588,
                -0.000183164,
                0.363506,
                0.000425067,
                0.843412,
                -0.00073253,
                0.36343,
                0.00169999,
                0.843401,
                -0.00164818,
                0.363426,
                0.00382495,
                0.843399,
                -0.00293008,
                0.363425,
                0.00679993,
                0.843401,
                -0.00457822,
                0.363425,
                0.010625,
                0.843394,
                -0.00659249,
                0.363421,
                0.0153002,
                0.843398,
                -0.00897282,
                0.363421,
                0.0208258,
                0.843415,
                -0.0117191,
                0.363426,
                0.0272024,
                0.843438,
                -0.0148312,
                0.363432,
                0.0344305,
                0.843483,
                -0.018309,
                0.363447,
                0.0425116,
                0.84356,
                -0.0221521,
                0.363472,
                0.0514471,
                0.843646,
                -0.0263597,
                0.363499,
                0.061238,
                0.843743,
                -0.0309315,
                0.363527,
                0.0718873,
                0.84388,
                -0.0358658,
                0.363569,
                0.0833969,
                0.844079,
                -0.0411624,
                0.363631,
                0.0957742,
                0.844279,
                -0.0468128,
                0.363688,
                0.109015,
                0.844549,
                -0.0527923,
                0.363761,
                0.123124,
                0.844858,
                -0.0588204,
                0.363817,
                0.138044,
                0.84522,
                -0.0647573,
                0.36383,
                0.153755,
                0.845669,
                -0.0713181,
                0.363879,
                0.170394,
                0.846155,
                -0.0781697,
                0.363908,
                0.187861,
                0.846789,
                -0.0853913,
                0.363969,
                0.206176,
                0.847502,
                -0.0928086,
                0.363999,
                0.225244,
                0.8484,
                -0.10005,
                0.363997,
                0.244926,
                0.849461,
                -0.107615,
                0.364008,
                0.265188,
                0.850562,
                -0.115814,
                0.364055,
                0.28587,
                0.851962,
                -0.124334,
                0.364179,
                0.306926,
                0.854326,
                -0.131995,
                0.364233,
                0.329605,
                0.856295,
                -0.139338,
                0.363856,
                0.35359,
                0.858857,
                -0.146346,
                0.363347,
                0.37831,
                0.862428,
                -0.152994,
                0.362807,
                0.403722,
                0.866203,
                -0.159463,
                0.361963,
                0.429537,
                0.871629,
                -0.165623,
                0.36112,
                0.456,
                0.877365,
                -0.171649,
                0.359917,
                0.482773,
                0.883744,
                -0.177151,
                0.35848,
                0.509705,
                0.890693,
                -0.182381,
                0.356523,
                0.537215,
                0.897278,
                -0.186076,
                0.3533,
                0.565493,
                0.903958,
                -0.188602,
                0.349095,
                0.594293,
                0.910908,
                -0.190755,
                0.344215,
                0.623165,
                0.918117,
                -0.192063,
                0.338606,
                0.651573,
                0.924644,
                -0.192758,
                0.331544,
                0.679869,
                0.931054,
                -0.192238,
                0.323163,
                0.708668,
                0.937303,
                -0.190035,
                0.313529,
                0.737201,
                0.943387,
                -0.187162,
                0.303152,
                0.764977,
                0.948494,
                -0.183876,
                0.29146,
                0.792683,
                0.952546,
                -0.178901,
                0.277917,
                0.819228,
                0.958077,
                -0.173173,
                0.264753,
                0.846559,
                0.962462,
                -0.16645,
                0.25002,
                0.872962,
                0.966569,
                -0.159452,
                0.234873,
                0.898729,
                0.969108,
                -0.15074,
                0.218752,
                0.923126,
                0.973072,
                -0.141523,
                0.202673,
                0.947278,
                0.975452,
                -0.132075,
                0.186326,
                0.969938,
                0.977784,
                -0.121257,
                0.169396,
                0.991325,
                0.97899,
                -0.110182,
                0.153044,
                1.01123,
                0.979777,
                -0.0989634,
                0.136485,
                1.0299,
                0.980865,
                -0.0865894,
                0.119343,
                1.04727,
                0.982432,
                -0.0746115,
                0.102452,
                1.06341,
                0.984935,
                -0.0621822,
                0.0852423,
                1.07834,
                0.987776,
                -0.0495694,
                0.0678546,
                1.092,
                0.99103,
                -0.0372386,
                0.0506917,
                1.1043,
                0.99474,
                -0.0244353,
                0.0333316,
                1.11576,
                0.997768,
                -0.0121448,
                0.0164348,
                1.12617,
                1.00003,
                0.00031774,
                -0.000169504,
                1.13598,
                0.825551,
                -0.00000756799,
                0.378425,
                0.0000165099,
                0.82664,
                -0.000190922,
                0.378923,
                0.000416504,
                0.826323,
                -0.000763495,
                0.378779,
                0.0016656,
                0.826359,
                -0.00171789,
                0.378795,
                0.00374768,
                0.82636,
                -0.00305402,
                0.378795,
                0.00666259,
                0.826368,
                -0.00477185,
                0.378798,
                0.0104104,
                0.826364,
                -0.00687131,
                0.378795,
                0.0149912,
                0.826368,
                -0.00935232,
                0.378795,
                0.0204054,
                0.826376,
                -0.0122146,
                0.378797,
                0.0266532,
                0.826399,
                -0.0154581,
                0.378803,
                0.0337355,
                0.82646,
                -0.0190825,
                0.378824,
                0.0416537,
                0.826525,
                -0.0230873,
                0.378846,
                0.0504091,
                0.826614,
                -0.0274719,
                0.378876,
                0.0600032,
                0.82674,
                -0.0322355,
                0.378917,
                0.0704393,
                0.826888,
                -0.0373766,
                0.378964,
                0.0817195,
                0.827078,
                -0.0428936,
                0.379024,
                0.0938492,
                0.827318,
                -0.0487778,
                0.379099,
                0.106828,
                0.82764,
                -0.0549935,
                0.379199,
                0.120659,
                0.827926,
                -0.0611058,
                0.379227,
                0.13526,
                0.828325,
                -0.0675054,
                0.379275,
                0.150713,
                0.828801,
                -0.0743455,
                0.379332,
                0.167034,
                0.8294,
                -0.0815523,
                0.379415,
                0.184209,
                0.830094,
                -0.0890779,
                0.379495,
                0.202203,
                0.8309,
                -0.096736,
                0.379555,
                0.220945,
                0.831943,
                -0.104135,
                0.379577,
                0.240306,
                0.833037,
                -0.112106,
                0.379604,
                0.260317,
                0.834278,
                -0.120554,
                0.379668,
                0.2808,
                0.836192,
                -0.129128,
                0.3799,
                0.301654,
                0.838671,
                -0.137541,
                0.380109,
                0.323502,
                0.840939,
                -0.14523,
                0.379809,
                0.347176,
                0.844575,
                -0.15248,
                0.379593,
                0.371706,
                0.848379,
                -0.159607,
                0.37909,
                0.39688,
                0.853616,
                -0.166267,
                0.378617,
                0.422702,
                0.858921,
                -0.172698,
                0.377746,
                0.448919,
                0.865324,
                -0.178823,
                0.376749,
                0.475661,
                0.872207,
                -0.184542,
                0.375363,
                0.502599,
                0.880018,
                -0.189836,
                0.373657,
                0.529914,
                0.88694,
                -0.194294,
                0.370673,
                0.557683,
                0.894779,
                -0.197022,
                0.36662,
                0.586848,
                0.902242,
                -0.199108,
                0.36138,
                0.615831,
                0.909914,
                -0.200398,
                0.355434,
                0.644478,
                0.917088,
                -0.20094,
                0.348173,
                0.672905,
                0.923888,
                -0.200671,
                0.339482,
                0.701327,
                0.930495,
                -0.198773,
                0.32956,
                0.730101,
                0.937247,
                -0.195394,
                0.318363,
                0.758383,
                0.943108,
                -0.191956,
                0.306323,
                0.786539,
                0.948296,
                -0.187227,
                0.292576,
                0.813637,
                0.953472,
                -0.181165,
                0.278234,
                0.840793,
                0.958485,
                -0.174119,
                0.263054,
                0.867712,
                0.962714,
                -0.166564,
                0.246756,
                0.893635,
                0.966185,
                -0.158181,
                0.229945,
                0.919028,
                0.970146,
                -0.148275,
                0.212633,
                0.943413,
                0.973491,
                -0.138157,
                0.195229,
                0.966627,
                0.975741,
                -0.127574,
                0.178048,
                0.988817,
                0.977238,
                -0.11554,
                0.160312,
                1.00924,
                0.978411,
                -0.10364,
                0.142857,
                1.02845,
                0.979811,
                -0.0913122,
                0.125317,
                1.04648,
                0.98116,
                -0.0782558,
                0.107627,
                1.06284,
                0.983543,
                -0.0655957,
                0.0895862,
                1.07798,
                0.986789,
                -0.0520411,
                0.0713756,
                1.092,
                0.990292,
                -0.0389727,
                0.053228,
                1.10484,
                0.994187,
                -0.025808,
                0.0351945,
                1.11642,
                0.997499,
                -0.0126071,
                0.0173198,
                1.12703,
                0.999999,
                0.000275604,
                -0.000148602,
                1.13674,
                0.81075,
                -0.0000078735,
                0.394456,
                0.0000161829,
                0.808692,
                -0.000198293,
                0.393453,
                0.000407564,
                0.80846,
                -0.000792877,
                0.39334,
                0.00162965,
                0.808595,
                -0.00178416,
                0.393407,
                0.00366711,
                0.808597,
                -0.00317182,
                0.393408,
                0.00651934,
                0.808598,
                -0.00495589,
                0.393408,
                0.0101866,
                0.808591,
                -0.00713627,
                0.393403,
                0.0146689,
                0.808592,
                -0.00971285,
                0.393402,
                0.0199667,
                0.80861,
                -0.0126855,
                0.393407,
                0.0260803,
                0.808633,
                -0.0160538,
                0.393413,
                0.0330107,
                0.80868,
                -0.0198175,
                0.393429,
                0.0407589,
                0.808748,
                -0.0239758,
                0.393453,
                0.0493264,
                0.808854,
                -0.0285286,
                0.39349,
                0.0587161,
                0.808992,
                -0.0334748,
                0.39354,
                0.0689304,
                0.809141,
                -0.0388116,
                0.393588,
                0.0799707,
                0.809352,
                -0.0445375,
                0.39366,
                0.0918432,
                0.809608,
                -0.0506427,
                0.393742,
                0.104549,
                0.809915,
                -0.0570708,
                0.393834,
                0.118085,
                0.810253,
                -0.0633526,
                0.393885,
                0.132377,
                0.810687,
                -0.0700966,
                0.393953,
                0.147537,
                0.811233,
                -0.0772274,
                0.394047,
                0.163543,
                0.811865,
                -0.0847629,
                0.394148,
                0.180394,
                0.812648,
                -0.0925663,
                0.394265,
                0.198051,
                0.813583,
                -0.100416,
                0.394363,
                0.216443,
                0.814683,
                -0.108119,
                0.394402,
                0.235502,
                0.815948,
                -0.11644,
                0.394489,
                0.255242,
                0.817278,
                -0.125036,
                0.394542,
                0.275441,
                0.819605,
                -0.133655,
                0.39486,
                0.296094,
                0.822256,
                -0.142682,
                0.395248,
                0.317309,
                0.825349,
                -0.150756,
                0.395241,
                0.340516,
                0.829605,
                -0.158392,
                0.395285,
                0.364819,
                0.83391,
                -0.165801,
                0.394922,
                0.389736,
                0.839808,
                -0.172677,
                0.394691,
                0.415409,
                0.845708,
                -0.179448,
                0.394006,
                0.441546,
                0.853025,
                -0.185746,
                0.393279,
                0.46832,
                0.859666,
                -0.191684,
                0.391655,
                0.495302,
                0.86789,
                -0.197146,
                0.390068,
                0.52262,
                0.875845,
                -0.201904,
                0.38727,
                0.550336,
                0.882634,
                -0.205023,
                0.382688,
                0.578825,
                0.891076,
                -0.207098,
                0.377543,
                0.608103,
                0.900589,
                -0.208474,
                0.371752,
                0.63723,
                0.90791,
                -0.209068,
                0.364016,
                0.665769,
                0.915971,
                -0.208655,
                0.355593,
                0.694428,
                0.923455,
                -0.20729,
                0.345439,
                0.723224,
                0.931514,
                -0.203821,
                0.334099,
                0.751925,
                0.937885,
                -0.19986,
                0.321069,
                0.780249,
                0.943136,
                -0.194993,
                0.306571,
                0.8077,
                0.948818,
                -0.189132,
                0.291556,
                0.83497,
                0.954433,
                -0.181617,
                0.275745,
                0.86188,
                0.959078,
                -0.173595,
                0.258695,
                0.888562,
                0.962705,
                -0.164855,
                0.240825,
                0.914008,
                0.966753,
                -0.155129,
                0.22268,
                0.939145,
                0.970704,
                -0.144241,
                0.204542,
                0.963393,
                0.973367,
                -0.133188,
                0.185927,
                0.985983,
                0.975984,
                -0.121146,
                0.167743,
                1.00704,
                0.976994,
                -0.108366,
                0.149218,
                1.02715,
                0.978485,
                -0.0956746,
                0.13131,
                1.0455,
                0.980074,
                -0.0820733,
                0.112513,
                1.06221,
                0.98225,
                -0.0684061,
                0.0938323,
                1.07782,
                0.98553,
                -0.0549503,
                0.0749508,
                1.09199,
                0.989529,
                -0.0407857,
                0.055848,
                1.10508,
                0.993536,
                -0.0271978,
                0.0368581,
                1.11684,
                0.997247,
                -0.0132716,
                0.0181845,
                1.12789,
                1,
                0.000431817,
                -0.000198809,
                1.13792,
                0.785886,
                -0.00000812608,
                0.405036,
                0.0000157669,
                0.790388,
                -0.000205278,
                0.407355,
                0.000398297,
                0.790145,
                -0.000820824,
                0.407231,
                0.00159263,
                0.790135,
                -0.00184681,
                0.407226,
                0.00358336,
                0.790119,
                -0.00328316,
                0.407218,
                0.00637039,
                0.790126,
                -0.00512988,
                0.40722,
                0.0099539,
                0.79013,
                -0.00738684,
                0.407221,
                0.0143339,
                0.790135,
                -0.0100538,
                0.407221,
                0.0195107,
                0.790134,
                -0.0131306,
                0.407217,
                0.0254848,
                0.79016,
                -0.0166169,
                0.407224,
                0.0322572,
                0.790197,
                -0.020512,
                0.407236,
                0.0398284,
                0.790273,
                -0.0248157,
                0.407263,
                0.0482014,
                0.790381,
                -0.029527,
                0.407304,
                0.0573777,
                0.790521,
                -0.0346446,
                0.407355,
                0.0673602,
                0.790704,
                -0.0401665,
                0.40742,
                0.0781522,
                0.790925,
                -0.0460896,
                0.407499,
                0.0897582,
                0.791195,
                -0.0524017,
                0.407589,
                0.10218,
                0.791522,
                -0.0590121,
                0.407691,
                0.11541,
                0.791878,
                -0.0654876,
                0.407748,
                0.12939,
                0.792361,
                -0.0725207,
                0.407849,
                0.144237,
                0.792942,
                -0.0799844,
                0.407963,
                0.159924,
                0.79362,
                -0.0877896,
                0.408087,
                0.176425,
                0.794529,
                -0.0958451,
                0.408259,
                0.193733,
                0.795521,
                -0.103827,
                0.408362,
                0.211756,
                0.796778,
                -0.111937,
                0.408482,
                0.230524,
                0.798027,
                -0.120521,
                0.408547,
                0.249967,
                0.799813,
                -0.129242,
                0.408721,
                0.269926,
                0.802387,
                -0.138048,
                0.409148,
                0.290338,
                0.805279,
                -0.147301,
                0.409641,
                0.311193,
                0.809251,
                -0.155895,
                0.410154,
                0.333611,
                0.813733,
                -0.163942,
                0.410297,
                0.357615,
                0.819081,
                -0.171666,
                0.410373,
                0.382339,
                0.825427,
                -0.178905,
                0.410348,
                0.407828,
                0.83172,
                -0.185812,
                0.409486,
                0.434034,
                0.83877,
                -0.192318,
                0.408776,
                0.460493,
                0.845817,
                -0.198249,
                0.407176,
                0.487346,
                0.854664,
                -0.204034,
                0.405719,
                0.514832,
                0.863495,
                -0.208908,
                0.403282,
                0.542401,
                0.871883,
                -0.212765,
                0.399293,
                0.570683,
                0.88065,
                -0.214911,
                0.393803,
                0.599947,
                0.89004,
                -0.216214,
                0.387536,
                0.62932,
                0.898476,
                -0.216745,
                0.379846,
                0.658319,
                0.906738,
                -0.216387,
                0.370625,
                0.687138,
                0.914844,
                -0.215053,
                0.360139,
                0.71601,
                0.923877,
                -0.212007,
                0.348849,
                0.745124,
                0.931925,
                -0.207481,
                0.335639,
                0.773366,
                0.938054,
                -0.202418,
                0.320798,
                0.801636,
                0.943895,
                -0.196507,
                0.304772,
                0.829055,
                0.949468,
                -0.189009,
                0.288033,
                0.856097,
                0.955152,
                -0.180539,
                0.270532,
                0.88301,
                0.959403,
                -0.171437,
                0.251639,
                0.909296,
                0.963309,
                -0.161661,
                0.232563,
                0.934868,
                0.967399,
                -0.150425,
                0.213231,
                0.959662,
                0.972009,
                -0.138659,
                0.194247,
                0.98302,
                0.97433,
                -0.126595,
                0.174718,
                1.00517,
                0.975823,
                -0.113205,
                0.155518,
                1.02566,
                0.976371,
                -0.0996096,
                0.136709,
                1.04418,
                0.978705,
                -0.0860754,
                0.117571,
                1.06146,
                0.981477,
                -0.0714438,
                0.0980046,
                1.07777,
                0.984263,
                -0.0572304,
                0.0782181,
                1.09214,
                0.988423,
                -0.0428875,
                0.0584052,
                1.10553,
                0.993,
                -0.0282442,
                0.038522,
                1.11758,
                0.99704,
                -0.0140183,
                0.0190148,
                1.12864,
                0.999913,
                0.000369494,
                -0.000145203,
                1.13901,
                0.777662,
                -0.0000084153,
                0.423844,
                0.0000154403,
                0.770458,
                -0.000211714,
                0.419915,
                0.00038845,
                0.770716,
                -0.000846888,
                0.420055,
                0.00155386,
                0.770982,
                -0.00190567,
                0.420202,
                0.00349653,
                0.770981,
                -0.00338782,
                0.420201,
                0.00621606,
                0.77098,
                -0.00529338,
                0.4202,
                0.00971274,
                0.770983,
                -0.00762223,
                0.4202,
                0.0139867,
                0.770985,
                -0.0103741,
                0.420198,
                0.0190381,
                0.770996,
                -0.0135489,
                0.4202,
                0.0248677,
                0.771029,
                -0.0171461,
                0.420212,
                0.0314764,
                0.771052,
                -0.0211647,
                0.420215,
                0.0388648,
                0.771131,
                -0.0256048,
                0.420245,
                0.047036,
                0.771235,
                -0.0304647,
                0.420284,
                0.0559911,
                0.771383,
                -0.0357436,
                0.420341,
                0.0657346,
                0.771591,
                -0.0414392,
                0.420423,
                0.0762694,
                0.771819,
                -0.0475462,
                0.420506,
                0.0875984,
                0.772123,
                -0.0540506,
                0.420617,
                0.099727,
                0.772464,
                -0.060797,
                0.42072,
                0.112637,
                0.772855,
                -0.0675393,
                0.420799,
                0.126313,
                0.773317,
                -0.0748323,
                0.420893,
                0.140824,
                0.773981,
                -0.0825681,
                0.421058,
                0.15617,
                0.774746,
                -0.0906307,
                0.421226,
                0.172322,
                0.77566,
                -0.0988982,
                0.421397,
                0.189253,
                0.776837,
                -0.106994,
                0.421569,
                0.206912,
                0.778097,
                -0.115528,
                0.421704,
                0.225359,
                0.779588,
                -0.124317,
                0.421849,
                0.24447,
                0.781574,
                -0.133139,
                0.422097,
                0.264156,
                0.784451,
                -0.142179,
                0.422615,
                0.284318,
                0.787682,
                -0.15165,
                0.423269,
                0.304902,
                0.792433,
                -0.160771,
                0.424396,
                0.3265,
                0.797359,
                -0.169166,
                0.424772,
                0.35014,
                0.803986,
                -0.177149,
                0.425475,
                0.374768,
                0.809504,
                -0.184745,
                0.424996,
                0.399928,
                0.815885,
                -0.19173,
                0.424247,
                0.425796,
                0.823513,
                -0.198525,
                0.423515,
                0.452287,
                0.832549,
                -0.204709,
                0.422787,
                0.479321,
                0.841653,
                -0.210447,
                0.421187,
                0.506718,
                0.850401,
                -0.215501,
                0.418519,
                0.53432,
                0.859854,
                -0.219752,
                0.414715,
                0.56242,
                0.869364,
                -0.222305,
                0.409462,
                0.591558,
                0.878837,
                -0.223744,
                0.402926,
                0.621074,
                0.888636,
                -0.224065,
                0.395043,
                0.650538,
                0.898132,
                -0.223742,
                0.38564,
                0.679538,
                0.907181,
                -0.222308,
                0.375378,
                0.708674,
                0.915621,
                -0.219837,
                0.363212,
                0.737714,
                0.9239,
                -0.215233,
                0.349313,
                0.767014,
                0.931644,
                -0.209592,
                0.334162,
                0.795133,
                0.938887,
                -0.203644,
                0.317943,
                0.823228,
                0.945282,
                -0.196349,
                0.300581,
                0.850822,
                0.950758,
                -0.18742,
                0.282195,
                0.877594,
                0.956146,
                -0.177879,
                0.262481,
                0.904564,
                0.960355,
                -0.167643,
                0.242487,
                0.930741,
                0.965256,
                -0.156671,
                0.222668,
                0.955868,
                0.968029,
                -0.144123,
                0.201907,
                0.979869,
                0.97251,
                -0.131305,
                0.18202,
                1.00291,
                0.974925,
                -0.118335,
                0.161909,
                1.02392,
                0.975402,
                -0.103714,
                0.142129,
                1.0433,
                0.976987,
                -0.089415,
                0.122447,
                1.06089,
                0.979677,
                -0.0748858,
                0.102248,
                1.07713,
                0.983184,
                -0.0596086,
                0.0814851,
                1.09218,
                0.987466,
                -0.0447671,
                0.0609484,
                1.10585,
                0.992348,
                -0.0295217,
                0.0401835,
                1.11829,
                0.996674,
                -0.0143917,
                0.0198163,
                1.12966,
                1.00003,
                0.000321364,
                -0.000149983,
                1.1402,
                0.757901,
                -0.00000869074,
                0.436176,
                0.0000151011,
                0.751195,
                -0.000217848,
                0.432317,
                0.000378533,
                0.751178,
                -0.000871373,
                0.432307,
                0.0015141,
                0.751195,
                -0.00196061,
                0.432317,
                0.0034068,
                0.751198,
                -0.00348552,
                0.432318,
                0.00605659,
                0.751195,
                -0.00544599,
                0.432315,
                0.00946353,
                0.751207,
                -0.00784203,
                0.43232,
                0.013628,
                0.751213,
                -0.0106732,
                0.43232,
                0.0185499,
                0.751221,
                -0.0139393,
                0.432319,
                0.0242302,
                0.751244,
                -0.0176398,
                0.432325,
                0.0306694,
                0.7513,
                -0.0217743,
                0.432348,
                0.0378698,
                0.751358,
                -0.0263412,
                0.432367,
                0.0458321,
                0.751458,
                -0.0313396,
                0.432404,
                0.0545587,
                0.751608,
                -0.0367682,
                0.432464,
                0.0640543,
                0.7518,
                -0.0426246,
                0.43254,
                0.0743222,
                0.752065,
                -0.0489031,
                0.432645,
                0.0853668,
                0.752376,
                -0.0555828,
                0.432762,
                0.0971911,
                0.752715,
                -0.0623861,
                0.432859,
                0.109768,
                0.753137,
                -0.069415,
                0.432958,
                0.123126,
                0.753676,
                -0.0770039,
                0.433099,
                0.137308,
                0.754345,
                -0.084971,
                0.433272,
                0.15229,
                0.755235,
                -0.0932681,
                0.433504,
                0.168075,
                0.756186,
                -0.10171,
                0.433693,
                0.184625,
                0.757363,
                -0.110019,
                0.433857,
                0.201897,
                0.75884,
                -0.11887,
                0.434102,
                0.220014,
                0.760467,
                -0.127881,
                0.434306,
                0.238778,
                0.762969,
                -0.136766,
                0.434751,
                0.258172,
                0.765823,
                -0.14612,
                0.43529,
                0.278062,
                0.769676,
                -0.15566,
                0.436236,
                0.298437,
                0.774909,
                -0.165177,
                0.437754,
                0.319532,
                0.77994,
                -0.17402,
                0.438343,
                0.342505,
                0.785757,
                -0.182201,
                0.438609,
                0.366693,
                0.792487,
                -0.190104,
                0.438762,
                0.391668,
                0.80038,
                -0.197438,
                0.438795,
                0.417494,
                0.808494,
                -0.204365,
                0.438226,
                0.443933,
                0.817695,
                -0.210714,
                0.437283,
                0.470929,
                0.828111,
                -0.216651,
                0.436087,
                0.498569,
                0.837901,
                -0.221804,
                0.433717,
                0.526165,
                0.847813,
                -0.226318,
                0.430133,
                0.554155,
                0.858314,
                -0.229297,
                0.425213,
                0.582822,
                0.868891,
                -0.230999,
                0.418576,
                0.612847,
                0.878941,
                -0.231155,
                0.410405,
                0.642445,
                0.888809,
                -0.230935,
                0.400544,
                0.672024,
                0.898089,
                -0.229343,
                0.389613,
                0.701366,
                0.908081,
                -0.226886,
                0.377197,
                0.730763,
                0.916819,
                -0.222676,
                0.363397,
                0.759642,
                0.924968,
                -0.216835,
                0.347437,
                0.788775,
                0.932906,
                -0.210245,
                0.32995,
                0.817135,
                0.940025,
                -0.202992,
                0.312262,
                0.844912,
                0.946101,
                -0.19436,
                0.293313,
                0.872164,
                0.952835,
                -0.184125,
                0.273638,
                0.899443,
                0.957347,
                -0.173657,
                0.252385,
                0.926389,
                0.961434,
                -0.162204,
                0.231038,
                0.951947,
                0.965522,
                -0.14979,
                0.209834,
                0.976751,
                0.969412,
                -0.136307,
                0.188821,
                1.00022,
                0.973902,
                -0.122527,
                0.168013,
                1.02229,
                0.974045,
                -0.108213,
                0.147634,
                1.04199,
                0.975775,
                -0.0927397,
                0.12705,
                1.06019,
                0.978383,
                -0.0778212,
                0.106309,
                1.07711,
                0.98211,
                -0.0621216,
                0.0849279,
                1.09245,
                0.986517,
                -0.0463847,
                0.0633519,
                1.10651,
                0.991696,
                -0.0309353,
                0.0419698,
                1.11903,
                0.996349,
                -0.0150914,
                0.0206272,
                1.13073,
                1.00003,
                0.000442449,
                -0.000231396,
                1.14146,
                0.727498,
                -0.00000885074,
                0.441528,
                0.0000145832,
                0.730897,
                -0.000223525,
                0.443589,
                0.000368298,
                0.730796,
                -0.000893996,
                0.443528,
                0.00147303,
                0.730805,
                -0.00201149,
                0.443533,
                0.00331433,
                0.730814,
                -0.00357596,
                0.443538,
                0.00589222,
                0.730815,
                -0.00558734,
                0.443538,
                0.00920678,
                0.730822,
                -0.00804544,
                0.44354,
                0.0132582,
                0.730836,
                -0.0109501,
                0.443545,
                0.0180468,
                0.730848,
                -0.0143008,
                0.443546,
                0.0235732,
                0.730871,
                -0.0180969,
                0.443552,
                0.0298382,
                0.730915,
                -0.022338,
                0.443567,
                0.0368438,
                0.730982,
                -0.0270225,
                0.443591,
                0.044591,
                0.731076,
                -0.0321491,
                0.443627,
                0.0530831,
                0.731245,
                -0.0377166,
                0.443699,
                0.0623243,
                0.73144,
                -0.0437216,
                0.443777,
                0.0723181,
                0.7317,
                -0.0501576,
                0.443881,
                0.0830691,
                0.732034,
                -0.0569942,
                0.444014,
                0.0945809,
                0.732388,
                -0.0638756,
                0.444113,
                0.106825,
                0.732853,
                -0.071203,
                0.444247,
                0.119859,
                0.733473,
                -0.0790076,
                0.444442,
                0.13369,
                0.734195,
                -0.0871937,
                0.444645,
                0.148304,
                0.735069,
                -0.095696,
                0.444877,
                0.163702,
                0.736169,
                -0.10426,
                0.445133,
                0.179861,
                0.73747,
                -0.112853,
                0.44537,
                0.196778,
                0.738991,
                -0.12199,
                0.445651,
                0.214496,
                0.740865,
                -0.131153,
                0.445958,
                0.232913,
                0.743637,
                -0.140245,
                0.446548,
                0.251977,
                0.746797,
                -0.149722,
                0.447246,
                0.271551,
                0.751517,
                -0.159341,
                0.448656,
                0.291774,
                0.756156,
                -0.169106,
                0.449866,
                0.312455,
                0.761519,
                -0.178436,
                0.450919,
                0.334552,
                0.768295,
                -0.186904,
                0.451776,
                0.358491,
                0.776613,
                -0.195117,
                0.452832,
                0.383446,
                0.783966,
                -0.202695,
                0.45249,
                0.408945,
                0.793542,
                -0.20985,
                0.452587,
                0.435364,
                0.803192,
                -0.216403,
                0.451852,
                0.462336,
                0.813892,
                -0.22251,
                0.450708,
                0.48987,
                0.824968,
                -0.227676,
                0.4486,
                0.517697,
                0.835859,
                -0.232443,
                0.445156,
                0.545975,
                0.846825,
                -0.235775,
                0.440351,
                0.574483,
                0.858085,
                -0.237897,
                0.433641,
                0.604246,
                0.868825,
                -0.238074,
                0.425354,
                0.634101,
                0.879638,
                -0.237661,
                0.415383,
                0.664201,
                0.889966,
                -0.236186,
                0.404136,
                0.693918,
                0.899479,
                -0.233599,
                0.390917,
                0.723481,
                0.908769,
                -0.229737,
                0.376352,
                0.75258,
                0.917966,
                -0.223836,
                0.360372,
                0.781764,
                0.926304,
                -0.217067,
                0.342551,
                0.811139,
                0.934626,
                -0.209309,
                0.324238,
                0.839585,
                0.941841,
                -0.20071,
                0.304484,
                0.867044,
                0.94789,
                -0.190602,
                0.283607,
                0.894579,
                0.954196,
                -0.179253,
                0.262205,
                0.921743,
                0.958383,
                -0.167646,
                0.239847,
                0.948026,
                0.963119,
                -0.155073,
                0.218078,
                0.973296,
                0.966941,
                -0.141426,
                0.195899,
                0.998135,
                0.970836,
                -0.126849,
                0.174121,
                1.02021,
                0.973301,
                -0.112296,
                0.153052,
                1.04085,
                0.97448,
                -0.0964965,
                0.131733,
                1.05946,
                0.977045,
                -0.080489,
                0.10997,
                1.07693,
                0.980751,
                -0.064844,
                0.0881657,
                1.09254,
                0.985475,
                -0.0481938,
                0.0657987,
                1.10697,
                0.991089,
                -0.0319185,
                0.0435215,
                1.12004,
                0.996122,
                -0.0158088,
                0.0214779,
                1.13173,
                1.00001,
                0.000372455,
                -0.000200295,
                1.14291,
                0.708622,
                -0.00000907597,
                0.45304,
                0.0000141962,
                0.711162,
                -0.000228911,
                0.454662,
                0.000358052,
                0.709812,
                -0.000914446,
                0.453797,
                0.00143034,
                0.709865,
                -0.00205819,
                0.453834,
                0.00321935,
                0.709864,
                -0.00365894,
                0.453833,
                0.00572331,
                0.709855,
                -0.00571692,
                0.453826,
                0.00894278,
                0.709862,
                -0.00823201,
                0.453828,
                0.012878,
                0.709875,
                -0.011204,
                0.453832,
                0.0175295,
                0.709896,
                -0.0146323,
                0.453839,
                0.0228978,
                0.709925,
                -0.0185163,
                0.453847,
                0.0289839,
                0.709974,
                -0.0228551,
                0.453866,
                0.0357894,
                0.710045,
                -0.0276473,
                0.453892,
                0.0433161,
                0.710133,
                -0.032891,
                0.453924,
                0.0515665,
                0.710292,
                -0.0385851,
                0.453992,
                0.0605458,
                0.710485,
                -0.0447254,
                0.45407,
                0.0702574,
                0.710769,
                -0.0513051,
                0.454192,
                0.0807077,
                0.711106,
                -0.0582733,
                0.454329,
                0.091896,
                0.711516,
                -0.0652866,
                0.45446,
                0.103814,
                0.712071,
                -0.0728426,
                0.454653,
                0.116508,
                0.712676,
                -0.0808307,
                0.45484,
                0.129968,
                0.713476,
                -0.0892216,
                0.455096,
                0.144206,
                0.714377,
                -0.0979047,
                0.455346,
                0.159212,
                0.715579,
                -0.106531,
                0.455647,
                0.174973,
                0.716977,
                -0.115492,
                0.455961,
                0.191504,
                0.71862,
                -0.124821,
                0.456315,
                0.208835,
                0.72084,
                -0.134079,
                0.4568,
                0.226869,
                0.723786,
                -0.143427,
                0.457521,
                0.245582,
                0.727464,
                -0.153061,
                0.458475,
                0.264957,
                0.732771,
                -0.162768,
                0.460239,
                0.284948,
                0.736515,
                -0.172627,
                0.460899,
                0.30522,
                0.743519,
                -0.182487,
                0.463225,
                0.326717,
                0.750041,
                -0.191295,
                0.464027,
                0.350113,
                0.758589,
                -0.199746,
                0.465227,
                0.374782,
                0.767703,
                -0.207584,
                0.465877,
                0.400226,
                0.777484,
                -0.214973,
                0.465996,
                0.426442,
                0.788792,
                -0.221796,
                0.466019,
                0.453688,
                0.800194,
                -0.228038,
                0.465083,
                0.481246,
                0.811234,
                -0.233346,
                0.462506,
                0.509086,
                0.822859,
                -0.238073,
                0.459257,
                0.537338,
                0.835082,
                -0.241764,
                0.454863,
                0.566108,
                0.846332,
                -0.244241,
                0.448163,
                0.595126,
                0.858355,
                -0.244736,
                0.439709,
                0.625574,
                0.87034,
                -0.244278,
                0.429837,
                0.65617,
                0.881027,
                -0.24255,
                0.418002,
                0.686029,
                0.891007,
                -0.239912,
                0.404325,
                0.716039,
                0.900874,
                -0.236133,
                0.389222,
                0.745518,
                0.911072,
                -0.230672,
                0.373269,
                0.775026,
                0.920359,
                -0.22356,
                0.355083,
                0.804521,
                0.928604,
                -0.215591,
                0.335533,
                0.834045,
                0.937175,
                -0.206503,
                0.315278,
                0.861612,
                0.942825,
                -0.196684,
                0.293653,
                0.889131,
                0.949805,
                -0.185116,
                0.271503,
                0.916853,
                0.955535,
                -0.172703,
                0.248821,
                0.943541,
                0.959843,
                -0.159978,
                0.225591,
                0.970132,
                0.964393,
                -0.146375,
                0.202719,
                0.994709,
                0.968008,
                -0.131269,
                0.179928,
                1.0186,
                0.971013,
                -0.11569,
                0.158007,
                1.03928,
                0.973334,
                -0.1003,
                0.13624,
                1.05887,
                0.975775,
                -0.0833352,
                0.1138,
                1.07652,
                0.979579,
                -0.0668981,
                0.0913141,
                1.09297,
                0.984323,
                -0.0500902,
                0.0683051,
                1.10734,
                0.990351,
                -0.0332377,
                0.0451771,
                1.12084,
                0.995823,
                -0.0161491,
                0.0221705,
                1.13296,
                1.0001,
                0.000234083,
                -0.000108712,
                1.14441,
                0.683895,
                -0.00000924677,
                0.46015,
                0.0000137429,
                0.68833,
                -0.000233383,
                0.463134,
                0.000346865,
                0.688368,
                -0.000933547,
                0.463159,
                0.00138748,
                0.688367,
                -0.00210049,
                0.463159,
                0.00312187,
                0.688369,
                -0.00373415,
                0.463159,
                0.00555004,
                0.688377,
                -0.00583449,
                0.463163,
                0.00867216,
                0.688386,
                -0.00840128,
                0.463166,
                0.0124884,
                0.688398,
                -0.0114343,
                0.463169,
                0.0169993,
                0.688418,
                -0.0149329,
                0.463175,
                0.0222054,
                0.688453,
                -0.0188964,
                0.463188,
                0.028108,
                0.688515,
                -0.0233239,
                0.463214,
                0.0347085,
                0.68857,
                -0.0282136,
                0.463231,
                0.0420091,
                0.688679,
                -0.033564,
                0.463276,
                0.0500132,
                0.688854,
                -0.0393733,
                0.463356,
                0.0587255,
                0.689038,
                -0.0456354,
                0.46343,
                0.0681476,
                0.689321,
                -0.0523433,
                0.463553,
                0.0782897,
                0.689662,
                -0.059412,
                0.463693,
                0.0891501,
                0.690188,
                -0.0665736,
                0.4639,
                0.100735,
                0.690755,
                -0.0743106,
                0.464107,
                0.113074,
                0.691405,
                -0.0824722,
                0.464329,
                0.126161,
                0.692198,
                -0.0910484,
                0.464585,
                0.140007,
                0.693196,
                -0.0998778,
                0.464893,
                0.154612,
                0.69454,
                -0.108651,
                0.465285,
                0.169984,
                0.695921,
                -0.117855,
                0.465596,
                0.186106,
                0.697749,
                -0.12734,
                0.466056,
                0.203034,
                0.700375,
                -0.136714,
                0.466771,
                0.220703,
                0.703395,
                -0.146386,
                0.467579,
                0.239062,
                0.707904,
                -0.156096,
                0.469067,
                0.258188,
                0.711673,
                -0.165904,
                0.469851,
                0.277759,
                0.717489,
                -0.175812,
                0.471815,
                0.297935,
                0.724051,
                -0.185931,
                0.47389,
                0.318916,
                0.731965,
                -0.195238,
                0.47587,
                0.341591,
                0.741151,
                -0.204021,
                0.477523,
                0.366062,
                0.751416,
                -0.212113,
                0.478881,
                0.391396,
                0.761848,
                -0.21979,
                0.479226,
                0.417599,
                0.771886,
                -0.2267,
                0.478495,
                0.444401,
                0.783998,
                -0.232991,
                0.477622,
                0.472084,
                0.796523,
                -0.238645,
                0.475833,
                0.500193,
                0.808851,
                -0.243396,
                0.472568,
                0.52865,
                0.821191,
                -0.247226,
                0.467857,
                0.557362,
                0.834261,
                -0.250102,
                0.461871,
                0.586768,
                0.846762,
                -0.251056,
                0.453543,
                0.617085,
                0.859867,
                -0.250604,
                0.443494,
                0.647659,
                0.871948,
                -0.248783,
                0.431711,
                0.678119,
                0.882967,
                -0.245855,
                0.417911,
                0.708399,
                0.892826,
                -0.242168,
                0.401993,
                0.738256,
                0.90332,
                -0.237062,
                0.385371,
                0.767999,
                0.913633,
                -0.22997,
                0.366837,
                0.798191,
                0.922774,
                -0.221687,
                0.346372,
                0.827756,
                0.931371,
                -0.212345,
                0.325682,
                0.856425,
                0.938929,
                -0.20206,
                0.303665,
                0.884299,
                0.944821,
                -0.190981,
                0.280786,
                0.912023,
                0.951792,
                -0.178065,
                0.2573,
                0.939669,
                0.957712,
                -0.164634,
                0.233448,
                0.96655,
                0.961912,
                -0.150863,
                0.209504,
                0.992366,
                0.966382,
                -0.13577,
                0.18597,
                1.01633,
                0.969588,
                -0.119593,
                0.162905,
                1.03843,
                0.971777,
                -0.103203,
                0.14053,
                1.05841,
                0.97433,
                -0.0865888,
                0.117909,
                1.07632,
                0.978686,
                -0.0690829,
                0.0944101,
                1.09326,
                0.983281,
                -0.0516568,
                0.0705671,
                1.10796,
                0.989562,
                -0.034558,
                0.0468592,
                1.12182,
                0.995465,
                -0.0167808,
                0.0229846,
                1.1342,
                0.999991,
                0.000373016,
                -0.000235606,
                1.1459,
                0.662251,
                -0.00000939016,
                0.468575,
                0.0000132714,
                0.666634,
                -0.000237624,
                0.471675,
                0.000335842,
                0.666411,
                -0.000950385,
                0.471516,
                0.00134321,
                0.666399,
                -0.00213833,
                0.471509,
                0.00302221,
                0.666386,
                -0.0038014,
                0.471499,
                0.00537283,
                0.666405,
                -0.00593958,
                0.471511,
                0.00839533,
                0.666406,
                -0.00855253,
                0.471508,
                0.0120898,
                0.666428,
                -0.0116401,
                0.471519,
                0.0164569,
                0.666444,
                -0.0152015,
                0.471522,
                0.0214971,
                0.66649,
                -0.0192362,
                0.471543,
                0.027212,
                0.666537,
                -0.0237428,
                0.471558,
                0.033603,
                0.666617,
                -0.0287198,
                0.471591,
                0.0406728,
                0.666718,
                -0.0341647,
                0.471631,
                0.0484238,
                0.666889,
                -0.0400759,
                0.47171,
                0.0568621,
                0.667104,
                -0.0464479,
                0.471805,
                0.0659915,
                0.667374,
                -0.0532677,
                0.471923,
                0.0758178,
                0.667772,
                -0.0603805,
                0.472098,
                0.0863425,
                0.668371,
                -0.0677392,
                0.472363,
                0.0975917,
                0.668971,
                -0.0756028,
                0.472596,
                0.109567,
                0.669696,
                -0.0839293,
                0.472869,
                0.122272,
                0.670481,
                -0.0926683,
                0.473126,
                0.135718,
                0.6715,
                -0.1016,
                0.473442,
                0.149914,
                0.672911,
                -0.110566,
                0.47389,
                0.164882,
                0.674512,
                -0.119984,
                0.474354,
                0.180602,
                0.67651,
                -0.129574,
                0.474922,
                0.19711,
                0.679292,
                -0.139106,
                0.475764,
                0.214371,
                0.682798,
                -0.148993,
                0.476886,
                0.232405,
                0.686955,
                -0.158737,
                0.478179,
                0.251153,
                0.691406,
                -0.168754,
                0.479432,
                0.270436,
                0.697438,
                -0.178703,
                0.481481,
                0.290374,
                0.704761,
                -0.188955,
                0.484143,
                0.311044,
                0.713599,
                -0.198814,
                0.487007,
                0.333003,
                0.723194,
                -0.207869,
                0.488962,
                0.357144,
                0.732601,
                -0.216189,
                0.489815,
                0.382169,
                0.744193,
                -0.22398,
                0.490888,
                0.408227,
                0.754907,
                -0.231156,
                0.490355,
                0.434928,
                0.767403,
                -0.23747,
                0.489548,
                0.462599,
                0.78107,
                -0.243503,
                0.488274,
                0.490908,
                0.793893,
                -0.248114,
                0.484843,
                0.519421,
                0.807296,
                -0.25222,
                0.4803,
                0.548561,
                0.820529,
                -0.255265,
                0.474097,
                0.577772,
                0.833716,
                -0.256741,
                0.466041,
                0.607782,
                0.848403,
                -0.25637,
                0.456547,
                0.638807,
                0.860755,
                -0.254804,
                0.443946,
                0.670058,
                0.874012,
                -0.251834,
                0.430852,
                0.700749,
                0.885619,
                -0.247867,
                0.414903,
                0.731446,
                0.896069,
                -0.242634,
                0.397276,
                0.761191,
                0.906266,
                -0.236093,
                0.378535,
                0.791053,
                0.916759,
                -0.227543,
                0.358038,
                0.821298,
                0.92523,
                -0.21783,
                0.335705,
                0.850747,
                0.93436,
                -0.207534,
                0.313797,
                0.879258,
                0.941631,
                -0.195983,
                0.289671,
                0.907734,
                0.947564,
                -0.183567,
                0.265319,
                0.935206,
                0.953681,
                -0.169345,
                0.240815,
                0.962739,
                0.960008,
                -0.154909,
                0.216119,
                0.989227,
                0.964145,
                -0.140161,
                0.192096,
                1.01465,
                0.968171,
                -0.123411,
                0.167855,
                1.03737,
                0.969859,
                -0.106525,
                0.144817,
                1.05767,
                0.972666,
                -0.0891023,
                0.12149,
                1.0761,
                0.977055,
                -0.0718094,
                0.0975306,
                1.09336,
                0.982527,
                -0.0534213,
                0.0730217,
                1.10878,
                0.989001,
                -0.0355579,
                0.0483366,
                1.12285,
                0.99512,
                -0.0176383,
                0.023938,
                1.13548,
                1.00007,
                0.000368831,
                -0.000211581,
                1.14744,
                0.651047,
                -0.00000960845,
                0.484101,
                0.000012922,
                0.644145,
                -0.000241347,
                0.478968,
                0.000324578,
                0.64396,
                -0.000965142,
                0.478831,
                0.00129798,
                0.64396,
                -0.00217154,
                0.47883,
                0.00292046,
                0.643968,
                -0.00386049,
                0.478835,
                0.00519202,
                0.643974,
                -0.00603186,
                0.478838,
                0.0081128,
                0.643977,
                -0.0086854,
                0.478836,
                0.011683,
                0.643982,
                -0.0118207,
                0.478834,
                0.0159031,
                0.644024,
                -0.0154374,
                0.478856,
                0.0207743,
                0.644059,
                -0.0195343,
                0.478868,
                0.0262975,
                0.644122,
                -0.0241103,
                0.478896,
                0.0324747,
                0.644207,
                -0.0291638,
                0.478933,
                0.039309,
                0.64432,
                -0.0346919,
                0.478981,
                0.0468029,
                0.644481,
                -0.0406919,
                0.479053,
                0.0549614,
                0.644722,
                -0.047159,
                0.479169,
                0.0637909,
                0.645013,
                -0.0540748,
                0.479302,
                0.0732974,
                0.645503,
                -0.0612001,
                0.479541,
                0.0834898,
                0.646117,
                -0.0687303,
                0.479829,
                0.0943873,
                0.646707,
                -0.0767846,
                0.480061,
                0.105991,
                0.647431,
                -0.0852465,
                0.480343,
                0.11831,
                0.64831,
                -0.0940719,
                0.48066,
                0.131348,
                0.649486,
                -0.103056,
                0.481083,
                0.14514,
                0.650864,
                -0.112261,
                0.481528,
                0.159676,
                0.652604,
                -0.121852,
                0.482102,
                0.174979,
                0.654825,
                -0.131505,
                0.482813,
                0.191079,
                0.657876,
                -0.141189,
                0.483876,
                0.207927,
                0.661339,
                -0.151239,
                0.48499,
                0.225586,
                0.665463,
                -0.161091,
                0.486279,
                0.243947,
                0.670542,
                -0.171235,
                0.487968,
                0.262957,
                0.677361,
                -0.181347,
                0.49053,
                0.282781,
                0.685672,
                -0.191679,
                0.493862,
                0.303311,
                0.694551,
                -0.201781,
                0.49699,
                0.324607,
                0.703753,
                -0.211164,
                0.498884,
                0.347916,
                0.713703,
                -0.219675,
                0.500086,
                0.372628,
                0.725911,
                -0.227836,
                0.501554,
                0.398694,
                0.73862,
                -0.23533,
                0.502193,
                0.425529,
                0.752118,
                -0.241786,
                0.501811,
                0.453209,
                0.76579,
                -0.247865,
                0.500185,
                0.481381,
                0.779568,
                -0.252696,
                0.497159,
                0.51011,
                0.793991,
                -0.256802,
                0.492765,
                0.539322,
                0.808182,
                -0.259942,
                0.486827,
                0.569078,
                0.821698,
                -0.261703,
                0.478386,
                0.598818,
                0.836009,
                -0.262006,
                0.468772,
                0.629762,
                0.849824,
                -0.260333,
                0.456352,
                0.661366,
                0.863888,
                -0.257398,
                0.442533,
                0.69295,
                0.876585,
                -0.253264,
                0.426573,
                0.723608,
                0.888665,
                -0.248026,
                0.408964,
                0.754378,
                0.899537,
                -0.241487,
                0.389677,
                0.784761,
                0.9094,
                -0.233463,
                0.368516,
                0.814688,
                0.920166,
                -0.223397,
                0.346624,
                0.845009,
                0.928899,
                -0.21255,
                0.322717,
                0.874431,
                0.937156,
                -0.200869,
                0.298698,
                0.902922,
                0.943861,
                -0.188387,
                0.273491,
                0.931356,
                0.949557,
                -0.174341,
                0.247866,
                0.958854,
                0.955862,
                -0.158994,
                0.222496,
                0.986098,
                0.961721,
                -0.143664,
                0.197522,
                1.01229,
                0.965976,
                -0.127412,
                0.17302,
                1.03571,
                0.968652,
                -0.109798,
                0.148954,
                1.05699,
                0.971084,
                -0.0916787,
                0.125044,
                1.07587,
                0.975584,
                -0.0739634,
                0.100577,
                1.09372,
                0.98122,
                -0.055322,
                0.0753666,
                1.10948,
                0.988253,
                -0.0366825,
                0.0498899,
                1.12394,
                0.99482,
                -0.0180389,
                0.024611,
                1.13694,
                1.00001,
                0.000229839,
                -0.000188283,
                1.14919,
                0.613867,
                -0.00000964198,
                0.479449,
                0.0000123452,
                0.621485,
                -0.000244534,
                0.485399,
                0.000313091,
                0.621429,
                -0.000978202,
                0.485353,
                0.00125245,
                0.62112,
                -0.00220004,
                0.485114,
                0.00281687,
                0.621119,
                -0.0039111,
                0.485112,
                0.00500783,
                0.621122,
                -0.00611091,
                0.485112,
                0.00782498,
                0.621133,
                -0.00879922,
                0.485117,
                0.0112687,
                0.621152,
                -0.0119756,
                0.485125,
                0.0153394,
                0.621183,
                -0.0156396,
                0.485139,
                0.0200382,
                0.621227,
                -0.0197898,
                0.485158,
                0.0253663,
                0.621298,
                -0.0244253,
                0.485192,
                0.0313261,
                0.621388,
                -0.0295441,
                0.485233,
                0.0379204,
                0.621507,
                -0.0351432,
                0.485286,
                0.0451523,
                0.621693,
                -0.0412198,
                0.485378,
                0.0530277,
                0.621933,
                -0.0477673,
                0.485495,
                0.0615522,
                0.622232,
                -0.0547574,
                0.485635,
                0.0707316,
                0.622809,
                -0.0619417,
                0.485943,
                0.0805883,
                0.623407,
                -0.069625,
                0.486232,
                0.0911267,
                0.62406,
                -0.077796,
                0.486516,
                0.102354,
                0.624835,
                -0.0863731,
                0.486838,
                0.114279,
                0.625758,
                -0.095251,
                0.487188,
                0.126902,
                0.627043,
                -0.104299,
                0.487695,
                0.140285,
                0.628438,
                -0.113724,
                0.488163,
                0.154397,
                0.630325,
                -0.123417,
                0.488858,
                0.169267,
                0.632801,
                -0.133137,
                0.489754,
                0.184941,
                0.635784,
                -0.143052,
                0.490815,
                0.20136,
                0.639406,
                -0.153132,
                0.492048,
                0.218643,
                0.643872,
                -0.163143,
                0.49363,
                0.236615,
                0.6499,
                -0.17333,
                0.496009,
                0.255449,
                0.657201,
                -0.183622,
                0.498994,
                0.275006,
                0.666221,
                -0.194019,
                0.502888,
                0.295354,
                0.674419,
                -0.204192,
                0.505459,
                0.316244,
                0.683729,
                -0.21406,
                0.507771,
                0.33849,
                0.695584,
                -0.222854,
                0.510245,
                0.363166,
                0.708583,
                -0.231315,
                0.512293,
                0.389071,
                0.721233,
                -0.238911,
                0.512747,
                0.415737,
                0.735134,
                -0.245657,
                0.512482,
                0.443331,
                0.750179,
                -0.251879,
                0.511526,
                0.471891,
                0.765073,
                -0.256911,
                0.508935,
                0.500892,
                0.779794,
                -0.261144,
                0.504341,
                0.530294,
                0.794801,
                -0.264316,
                0.498515,
                0.560144,
                0.810339,
                -0.266276,
                0.491015,
                0.590213,
                0.824818,
                -0.266981,
                0.481126,
                0.620865,
                0.839375,
                -0.265778,
                0.468685,
                0.652687,
                0.853043,
                -0.262748,
                0.453925,
                0.684759,
                0.867335,
                -0.258474,
                0.437912,
                0.716209,
                0.88037,
                -0.253187,
                0.419648,
                0.747508,
                0.891711,
                -0.246476,
                0.39982,
                0.77797,
                0.902896,
                -0.238735,
                0.37879,
                0.808586,
                0.913601,
                -0.22885,
                0.355891,
                0.838843,
                0.923019,
                -0.217656,
                0.331773,
                0.869014,
                0.933432,
                -0.205539,
                0.307356,
                0.898512,
                0.939691,
                -0.192595,
                0.281321,
                0.9269,
                0.946938,
                -0.178945,
                0.255441,
                0.955297,
                0.952372,
                -0.163587,
                0.229013,
                0.983231,
                0.95909,
                -0.147214,
                0.203179,
                1.00971,
                0.963675,
                -0.13064,
                0.17792,
                1.03438,
                0.968247,
                -0.113121,
                0.152898,
                1.05625,
                0.97001,
                -0.0945824,
                0.128712,
                1.07598,
                0.974458,
                -0.0755648,
                0.103349,
                1.094,
                0.980168,
                -0.0571998,
                0.0776731,
                1.1104,
                0.987295,
                -0.0377994,
                0.0514445,
                1.12491,
                0.994432,
                -0.0186417,
                0.025429,
                1.13851,
                0.999975,
                0.000542714,
                -0.000282356,
                1.15108,
                0.592656,
                -0.00000980249,
                0.486018,
                0.0000119532,
                0.598467,
                -0.000247275,
                0.490781,
                0.000301531,
                0.597934,
                -0.000988317,
                0.490343,
                0.00120517,
                0.597903,
                -0.00222366,
                0.490319,
                0.0027116,
                0.597913,
                -0.00395315,
                0.490327,
                0.00482077,
                0.597919,
                -0.00617653,
                0.490329,
                0.00753264,
                0.597936,
                -0.00889375,
                0.490339,
                0.0108478,
                0.597956,
                -0.0121043,
                0.490347,
                0.0147668,
                0.597992,
                -0.0158073,
                0.490365,
                0.0192905,
                0.598032,
                -0.0200017,
                0.490382,
                0.0244204,
                0.598109,
                -0.0246865,
                0.49042,
                0.0301593,
                0.598215,
                -0.0298594,
                0.490474,
                0.03651,
                0.59833,
                -0.0355167,
                0.490524,
                0.0434757,
                0.598525,
                -0.0416559,
                0.490624,
                0.0510629,
                0.598778,
                -0.0482692,
                0.490753,
                0.0592781,
                0.599135,
                -0.0553114,
                0.49094,
                0.0681304,
                0.599802,
                -0.062542,
                0.491328,
                0.0776467,
                0.600361,
                -0.0703638,
                0.491598,
                0.0878184,
                0.60101,
                -0.0786256,
                0.491882,
                0.0986573,
                0.601811,
                -0.0872962,
                0.492232,
                0.11018,
                0.602861,
                -0.0962284,
                0.492684,
                0.1224,
                0.604167,
                -0.10538,
                0.493213,
                0.135354,
                0.605693,
                -0.114896,
                0.493799,
                0.149034,
                0.607682,
                -0.124654,
                0.494576,
                0.163469,
                0.610672,
                -0.13456,
                0.4959,
                0.178747,
                0.613313,
                -0.144581,
                0.496713,
                0.194723,
                0.617603,
                -0.154703,
                0.498499,
                0.211617,
                0.622174,
                -0.16489,
                0.500188,
                0.229183,
                0.628855,
                -0.175164,
                0.503072,
                0.247786,
                0.636963,
                -0.185565,
                0.506798,
                0.267116,
                0.644866,
                -0.195911,
                0.509719,
                0.28702,
                0.653741,
                -0.206104,
                0.512776,
                0.307763,
                0.664942,
                -0.216447,
                0.516812,
                0.329631,
                0.67633,
                -0.22552,
                0.519181,
                0.353515,
                0.690012,
                -0.234316,
                0.521681,
                0.379226,
                0.704243,
                -0.242032,
                0.523129,
                0.405901,
                0.719396,
                -0.249172,
                0.523768,
                0.433585,
                0.734471,
                -0.255543,
                0.522541,
                0.462085,
                0.750539,
                -0.260697,
                0.520217,
                0.491233,
                0.766365,
                -0.26501,
                0.516293,
                0.521094,
                0.781677,
                -0.268409,
                0.509708,
                0.551014,
                0.797132,
                -0.270399,
                0.501944,
                0.581463,
                0.812655,
                -0.271247,
                0.492025,
                0.612402,
                0.828592,
                -0.270708,
                0.480424,
                0.643798,
                0.844044,
                -0.268085,
                0.465955,
                0.67682,
                0.857305,
                -0.263459,
                0.448425,
                0.708496,
                0.87114,
                -0.258151,
                0.430243,
                0.74046,
                0.884936,
                -0.251171,
                0.410578,
                0.771583,
                0.895772,
                -0.243305,
                0.38862,
                0.802234,
                0.906961,
                -0.234037,
                0.365214,
                0.833179,
                0.917775,
                -0.222714,
                0.34116,
                0.86353,
                0.927883,
                -0.210175,
                0.31572,
                0.893557,
                0.936617,
                -0.196925,
                0.289159,
                0.922976,
                0.943384,
                -0.182788,
                0.261996,
                0.951606,
                0.949713,
                -0.167965,
                0.235324,
                0.979958,
                0.955818,
                -0.151109,
                0.208408,
                1.00765,
                0.961344,
                -0.133834,
                0.182591,
                1.03329,
                0.965469,
                -0.115987,
                0.156958,
                1.0557,
                0.968693,
                -0.09746,
                0.132239,
                1.07583,
                0.973165,
                -0.0778514,
                0.106195,
                1.09451,
                0.979387,
                -0.0585067,
                0.0797669,
                1.11137,
                0.98671,
                -0.0390409,
                0.0530263,
                1.12643,
                0.994093,
                -0.019408,
                0.0263163,
                1.14016,
                1.00002,
                0.000540029,
                -0.000194487,
                1.15299,
                0.574483,
                -0.00000989066,
                0.494533,
                0.0000114896,
                0.574478,
                -0.000249127,
                0.494528,
                0.000289403,
                0.574607,
                -0.000996811,
                0.494637,
                0.00115797,
                0.574396,
                -0.00224241,
                0.494458,
                0.00260498,
                0.574377,
                -0.00398632,
                0.49444,
                0.00463102,
                0.574386,
                -0.00622836,
                0.494445,
                0.00723623,
                0.574401,
                -0.0089683,
                0.494453,
                0.010421,
                0.574419,
                -0.0122056,
                0.49446,
                0.0141859,
                0.574459,
                -0.0159396,
                0.494481,
                0.0185322,
                0.574525,
                -0.0201692,
                0.49452,
                0.0234617,
                0.574587,
                -0.0248924,
                0.494547,
                0.0289762,
                0.574697,
                -0.0301074,
                0.494604,
                0.0350797,
                0.574853,
                -0.0358114,
                0.494688,
                0.0417767,
                0.575027,
                -0.041999,
                0.494772,
                0.0490718,
                0.575294,
                -0.0486618,
                0.494915,
                0.0569728,
                0.575733,
                -0.0557148,
                0.495173,
                0.0654955,
                0.576356,
                -0.0630489,
                0.495537,
                0.0746612,
                0.576944,
                -0.0709285,
                0.495836,
                0.0844615,
                0.57765,
                -0.0792723,
                0.496177,
                0.0949142,
                0.578491,
                -0.0880167,
                0.496563,
                0.10603,
                0.579639,
                -0.0969462,
                0.497096,
                0.117841,
                0.580989,
                -0.10622,
                0.497684,
                0.130367,
                0.582587,
                -0.115861,
                0.498337,
                0.143609,
                0.584951,
                -0.125605,
                0.499414,
                0.157625,
                0.587602,
                -0.135608,
                0.500518,
                0.172413,
                0.59076,
                -0.145742,
                0.501767,
                0.187999,
                0.594992,
                -0.155934,
                0.503542,
                0.20445,
                0.600656,
                -0.166303,
                0.506135,
                0.221764,
                0.607816,
                -0.176681,
                0.509542,
                0.24002,
                0.61522,
                -0.187071,
                0.51263,
                0.258992,
                0.623702,
                -0.197465,
                0.516021,
                0.278773,
                0.634192,
                -0.207816,
                0.520422,
                0.299377,
                0.644936,
                -0.218183,
                0.524073,
                0.320802,
                0.657888,
                -0.2278,
                0.528049,
                0.34384,
                0.670666,
                -0.236747,
                0.52986,
                0.36916,
                0.685626,
                -0.24484,
                0.531892,
                0.395867,
                0.701304,
                -0.252071,
                0.532727,
                0.423488,
                0.717727,
                -0.258714,
                0.532146,
                0.452201,
                0.733914,
                -0.264211,
                0.529883,
                0.481579,
                0.750529,
                -0.26859,
                0.5259,
                0.511558,
                0.76747,
                -0.272046,
                0.51999,
                0.542042,
                0.785189,
                -0.274225,
                0.513083,
                0.572799,
                0.800954,
                -0.275189,
                0.502936,
                0.603816,
                0.816962,
                -0.274946,
                0.490921,
                0.635461,
                0.83336,
                -0.272695,
                0.47684,
                0.6676,
                0.848143,
                -0.268223,
                0.459405,
                0.70051,
                0.861818,
                -0.262768,
                0.440319,
                0.732902,
                0.876828,
                -0.255872,
                0.420123,
                0.765084,
                0.889312,
                -0.247703,
                0.398379,
                0.796391,
                0.900412,
                -0.238381,
                0.374496,
                0.827333,
                0.912251,
                -0.227783,
                0.349874,
                0.858385,
                0.921792,
                -0.214832,
                0.323181,
                0.888652,
                0.931273,
                -0.200949,
                0.296624,
                0.917763,
                0.940295,
                -0.186537,
                0.269211,
                0.947878,
                0.946812,
                -0.171538,
                0.241447,
                0.977016,
                0.953588,
                -0.155254,
                0.213829,
                1.00501,
                0.958841,
                -0.137156,
                0.186807,
                1.03179,
                0.963746,
                -0.118699,
                0.160706,
                1.05502,
                0.966468,
                -0.0998358,
                0.135504,
                1.07568,
                0.971178,
                -0.0805186,
                0.109131,
                1.09479,
                0.97831,
                -0.0599348,
                0.0818293,
                1.1123,
                0.985886,
                -0.0399661,
                0.0545872,
                1.12771,
                0.994021,
                -0.0198682,
                0.0269405,
                1.14186,
                1.00009,
                0.000271022,
                -0.00012989,
                1.15514,
                0.538716,
                -0.00000990918,
                0.486732,
                0.0000109675,
                0.550656,
                -0.000250642,
                0.497518,
                0.000277412,
                0.55057,
                -0.00100265,
                0.497441,
                0.00110974,
                0.550903,
                -0.00225672,
                0.497733,
                0.00249779,
                0.550568,
                -0.00401046,
                0.497438,
                0.00443906,
                0.550574,
                -0.00626613,
                0.49744,
                0.00693637,
                0.550591,
                -0.0090226,
                0.497449,
                0.00998921,
                0.550623,
                -0.0122795,
                0.497469,
                0.0135984,
                0.550667,
                -0.0160361,
                0.497495,
                0.0177654,
                0.550724,
                -0.0202908,
                0.497526,
                0.0224915,
                0.550792,
                -0.0250421,
                0.497557,
                0.0277795,
                0.550918,
                -0.0302878,
                0.49763,
                0.0336334,
                0.551058,
                -0.0360241,
                0.497701,
                0.0400573,
                0.551276,
                -0.0422473,
                0.497824,
                0.0470585,
                0.551551,
                -0.0489441,
                0.497977,
                0.0546433,
                0.552074,
                -0.0559596,
                0.498312,
                0.0628367,
                0.552681,
                -0.0633978,
                0.498679,
                0.071646,
                0.553324,
                -0.0713176,
                0.499031,
                0.0810746,
                0.554011,
                -0.0797268,
                0.499365,
                0.091129,
                0.55488,
                -0.0885238,
                0.499779,
                0.101837,
                0.556171,
                -0.0974417,
                0.500444,
                0.113239,
                0.557498,
                -0.106841,
                0.501025,
                0.125316,
                0.559299,
                -0.116533,
                0.501864,
                0.138128,
                0.561647,
                -0.126298,
                0.502967,
                0.151695,
                0.564347,
                -0.136388,
                0.504129,
                0.16604,
                0.567863,
                -0.146576,
                0.505713,
                0.181207,
                0.572569,
                -0.156832,
                0.507953,
                0.197259,
                0.578919,
                -0.167323,
                0.511186,
                0.214258,
                0.585387,
                -0.177712,
                0.514042,
                0.232038,
                0.593134,
                -0.188184,
                0.517484,
                0.250733,
                0.603295,
                -0.198717,
                0.522345,
                0.270454,
                0.613854,
                -0.209177,
                0.526751,
                0.290807,
                0.626092,
                -0.219644,
                0.531595,
                0.312202,
                0.637868,
                -0.229494,
                0.534721,
                0.334435,
                0.652458,
                -0.238718,
                0.538304,
                0.359184,
                0.666985,
                -0.247061,
                0.539875,
                0.385637,
                0.683301,
                -0.254652,
                0.541042,
                0.41328,
                0.69998,
                -0.261376,
                0.540735,
                0.441903,
                0.717824,
                -0.267085,
                0.539139,
                0.471609,
                0.734617,
                -0.271465,
                0.534958,
                0.501446,
                0.753663,
                -0.27528,
                0.53032,
                0.532571,
                0.770512,
                -0.277617,
                0.522134,
                0.563641,
                0.787356,
                -0.278525,
                0.51206,
                0.595067,
                0.806252,
                -0.278512,
                0.50119,
                0.627226,
                0.822061,
                -0.277023,
                0.486791,
                0.659402,
                0.838959,
                -0.273175,
                0.470467,
                0.692874,
                0.85379,
                -0.267238,
                0.450688,
                0.725702,
                0.868268,
                -0.260327,
                0.429741,
                0.75832,
                0.881994,
                -0.251946,
                0.407223,
                0.790189,
                0.893885,
                -0.242432,
                0.383214,
                0.821625,
                0.905118,
                -0.231904,
                0.357297,
                0.853011,
                0.916045,
                -0.219545,
                0.330733,
                0.883773,
                0.927614,
                -0.205378,
                0.303916,
                0.914435,
                0.936005,
                -0.190388,
                0.275941,
                0.944502,
                0.944533,
                -0.1749,
                0.247493,
                0.974439,
                0.950758,
                -0.158588,
                0.218996,
                1.00286,
                0.957078,
                -0.141027,
                0.191559,
                1.0304,
                0.962448,
                -0.121507,
                0.164457,
                1.05466,
                0.964993,
                -0.102068,
                0.138636,
                1.0761,
                0.970017,
                -0.0822598,
                0.111861,
                1.09541,
                0.97661,
                -0.062033,
                0.0843438,
                1.11317,
                0.985073,
                -0.0409832,
                0.0558496,
                1.12911,
                0.993515,
                -0.020146,
                0.0275331,
                1.1438,
                1.00006,
                0.00027329,
                -0.000107883,
                1.15736,
                0.525324,
                -0.00000999341,
                0.498153,
                0.0000105385,
                0.526513,
                -0.000251605,
                0.499277,
                0.000265329,
                0.526517,
                -0.00100641,
                0.499282,
                0.0010613,
                0.526588,
                -0.00226466,
                0.499337,
                0.00238823,
                0.526539,
                -0.0040255,
                0.499302,
                0.00424535,
                0.526547,
                -0.00628954,
                0.499306,
                0.00663364,
                0.526561,
                -0.00905628,
                0.499313,
                0.00955337,
                0.526593,
                -0.0123253,
                0.499334,
                0.0130054,
                0.526642,
                -0.0160957,
                0.499365,
                0.0169911,
                0.5267,
                -0.0203661,
                0.499396,
                0.0215122,
                0.526792,
                -0.0251347,
                0.499451,
                0.0265718,
                0.526904,
                -0.0303985,
                0.499511,
                0.0321732,
                0.527079,
                -0.0361554,
                0.499617,
                0.0383231,
                0.527285,
                -0.0423982,
                0.499731,
                0.045026,
                0.527602,
                -0.0491121,
                0.499924,
                0.0522936,
                0.528166,
                -0.0561127,
                0.500306,
                0.0601528,
                0.52879,
                -0.0635988,
                0.5007,
                0.0686059,
                0.529421,
                -0.071581,
                0.501048,
                0.0776518,
                0.530144,
                -0.0799854,
                0.501421,
                0.0873148,
                0.531062,
                -0.0888032,
                0.501884,
                0.0976084,
                0.532374,
                -0.0977643,
                0.50259,
                0.108588,
                0.533828,
                -0.107197,
                0.50329,
                0.120234,
                0.53581,
                -0.116887,
                0.504312,
                0.132602,
                0.538063,
                -0.126755,
                0.505365,
                0.145721,
                0.5409,
                -0.136819,
                0.506668,
                0.159617,
                0.544882,
                -0.147117,
                0.508731,
                0.174369,
                0.550238,
                -0.157446,
                0.511601,
                0.190028,
                0.556038,
                -0.167988,
                0.514431,
                0.206587,
                0.563031,
                -0.178364,
                0.517808,
                0.224046,
                0.571543,
                -0.189007,
                0.521937,
                0.242503,
                0.582255,
                -0.199546,
                0.527415,
                0.261977,
                0.59272,
                -0.210084,
                0.531682,
                0.282162,
                0.605648,
                -0.220448,
                0.537123,
                0.303426,
                0.61785,
                -0.230593,
                0.540664,
                0.325323,
                0.632223,
                -0.240238,
                0.544467,
                0.348993,
                0.648819,
                -0.24887,
                0.547594,
                0.375462,
                0.665825,
                -0.256657,
                0.54912,
                0.403024,
                0.683389,
                -0.263711,
                0.549294,
                0.431773,
                0.701495,
                -0.269666,
                0.547649,
                0.461494,
                0.719197,
                -0.274169,
                0.543786,
                0.491623,
                0.737906,
                -0.278124,
                0.538644,
                0.522994,
                0.756652,
                -0.280632,
                0.531057,
                0.554775,
                0.775279,
                -0.281741,
                0.521972,
                0.586441,
                0.792688,
                -0.281652,
                0.509613,
                0.618596,
                0.811894,
                -0.280345,
                0.496497,
                0.651462,
                0.827938,
                -0.277128,
                0.47968,
                0.684023,
                0.844837,
                -0.271646,
                0.460688,
                0.718024,
                0.859239,
                -0.264397,
                0.438872,
                0.751207,
                0.874088,
                -0.256144,
                0.41577,
                0.784232,
                0.887693,
                -0.246311,
                0.391369,
                0.816191,
                0.899402,
                -0.235497,
                0.365872,
                0.847828,
                0.910973,
                -0.223631,
                0.338618,
                0.87934,
                0.92204,
                -0.209874,
                0.310803,
                0.910325,
                0.930987,
                -0.194265,
                0.281802,
                0.940695,
                0.94,
                -0.178125,
                0.252836,
                0.970958,
                0.948018,
                -0.161479,
                0.224239,
                1.00078,
                0.955141,
                -0.144038,
                0.195857,
                1.0288,
                0.960513,
                -0.124915,
                0.168487,
                1.05371,
                0.963964,
                -0.104284,
                0.141495,
                1.07596,
                0.968713,
                -0.0838732,
                0.114437,
                1.09628,
                0.975524,
                -0.0635579,
                0.0863105,
                1.11448,
                0.98431,
                -0.042291,
                0.0574774,
                1.13069,
                0.992916,
                -0.0209131,
                0.0284343,
                1.14568,
                0.999926,
                0.000743097,
                -0.000379265,
                1.15955,
                0.501042,
                -0.00000998428,
                0.498726,
                0.0000100306,
                0.502992,
                -0.000252112,
                0.500665,
                0.000253283,
                0.502417,
                -0.00100791,
                0.500092,
                0.00101259,
                0.502965,
                -0.00226919,
                0.500621,
                0.00227978,
                0.502318,
                -0.00403109,
                0.499994,
                0.00405011,
                0.502333,
                -0.00629832,
                0.500005,
                0.00632868,
                0.502362,
                -0.00906907,
                0.500027,
                0.00911446,
                0.502369,
                -0.0123423,
                0.500023,
                0.0124078,
                0.50243,
                -0.0161178,
                0.500066,
                0.016211,
                0.502493,
                -0.0203937,
                0.500103,
                0.0205256,
                0.502592,
                -0.0251684,
                0.500166,
                0.0253548,
                0.502707,
                -0.0304389,
                0.50023,
                0.0307029,
                0.502881,
                -0.0362015,
                0.500335,
                0.0365753,
                0.503124,
                -0.0424507,
                0.500488,
                0.0429798,
                0.503443,
                -0.0491582,
                0.500686,
                0.0499268,
                0.504083,
                -0.0561476,
                0.501155,
                0.0574541,
                0.504668,
                -0.0636846,
                0.501524,
                0.0655408,
                0.505319,
                -0.0716834,
                0.501904,
                0.0742072,
                0.50609,
                -0.0800925,
                0.502321,
                0.0834699,
                0.507122,
                -0.0888425,
                0.502896,
                0.0933603,
                0.508414,
                -0.097855,
                0.503603,
                0.10391,
                0.509955,
                -0.107304,
                0.504416,
                0.115113,
                0.512061,
                -0.116921,
                0.505565,
                0.127054,
                0.514419,
                -0.12689,
                0.506732,
                0.139709,
                0.517529,
                -0.136934,
                0.508338,
                0.153173,
                0.522085,
                -0.147327,
                0.510987,
                0.167528,
                0.526986,
                -0.157612,
                0.513527,
                0.182708,
                0.533122,
                -0.168213,
                0.516717,
                0.198881,
                0.540807,
                -0.178688,
                0.520832,
                0.215986,
                0.550687,
                -0.189511,
                0.52632,
                0.234335,
                0.560567,
                -0.199998,
                0.531009,
                0.253375,
                0.571698,
                -0.210652,
                0.535839,
                0.273499,
                0.584364,
                -0.220917,
                0.541091,
                0.294355,
                0.599066,
                -0.23137,
                0.546875,
                0.316525,
                0.614148,
                -0.241206,
                0.551306,
                0.339671,
                0.631157,
                -0.250379,
                0.555187,
                0.36531,
                0.647919,
                -0.258397,
                0.556595,
                0.392767,
                0.666112,
                -0.265528,
                0.556949,
                0.421397,
                0.686158,
                -0.271827,
                0.556617,
                0.451433,
                0.704838,
                -0.27674,
                0.552975,
                0.482131,
                0.723957,
                -0.280733,
                0.547814,
                0.513458,
                0.74262,
                -0.283359,
                0.53997,
                0.545446,
                0.762009,
                -0.284541,
                0.530422,
                0.57775,
                0.781314,
                -0.284507,
                0.518546,
                0.610434,
                0.799116,
                -0.283309,
                0.504178,
                0.643178,
                0.817604,
                -0.280378,
                0.48843,
                0.676248,
                0.83459,
                -0.275619,
                0.469457,
                0.709698,
                0.850974,
                -0.26856,
                0.447698,
                0.744245,
                0.866747,
                -0.260094,
                0.424791,
                0.777695,
                0.881412,
                -0.249929,
                0.399913,
                0.810392,
                0.8936,
                -0.239137,
                0.37308,
                0.842872,
                0.905943,
                -0.226818,
                0.345705,
                0.874677,
                0.916408,
                -0.213699,
                0.31706,
                0.906257,
                0.927215,
                -0.198428,
                0.288444,
                0.936881,
                0.935625,
                -0.181643,
                0.258329,
                0.96795,
                0.944076,
                -0.164386,
                0.228488,
                0.998216,
                0.951229,
                -0.146339,
                0.199763,
                1.02689,
                0.958793,
                -0.127709,
                0.172153,
                1.0535,
                0.963219,
                -0.107244,
                0.144989,
                1.07646,
                0.967562,
                -0.0857764,
                0.11685,
                1.09675,
                0.974866,
                -0.0645377,
                0.0880571,
                1.11576,
                0.983353,
                -0.0431732,
                0.0587352,
                1.13227,
                0.992503,
                -0.0218356,
                0.0294181,
                1.1478,
                1.00003,
                0.000605203,
                -0.000231013,
                1.16207,
                0.482935,
                -0.0000101177,
                0.504695,
                0.00000968142,
                0.477554,
                -0.000251521,
                0.499071,
                0.000240676,
                0.477904,
                -0.00100683,
                0.499436,
                0.00096342,
                0.478368,
                -0.00226636,
                0.499899,
                0.0021687,
                0.477977,
                -0.00402719,
                0.499513,
                0.00385384,
                0.477993,
                -0.00629226,
                0.499525,
                0.0060221,
                0.478011,
                -0.00906011,
                0.499536,
                0.00867289,
                0.478051,
                -0.0123305,
                0.499566,
                0.0118074,
                0.478089,
                -0.016102,
                0.499587,
                0.0154269,
                0.478171,
                -0.0203736,
                0.499645,
                0.0195341,
                0.478254,
                -0.025143,
                0.499692,
                0.0241318,
                0.47839,
                -0.0304071,
                0.499779,
                0.0292247,
                0.478588,
                -0.0361631,
                0.499911,
                0.0348196,
                0.478812,
                -0.0424023,
                0.500046,
                0.0409231,
                0.479208,
                -0.0490724,
                0.500326,
                0.047552,
                0.479841,
                -0.0560722,
                0.500805,
                0.0547377,
                0.480392,
                -0.0636125,
                0.501152,
                0.0624607,
                0.481068,
                -0.0716134,
                0.501561,
                0.0707473,
                0.481898,
                -0.0800062,
                0.502054,
                0.0796118,
                0.483022,
                -0.0886568,
                0.502728,
                0.0890974,
                0.484332,
                -0.0977553,
                0.503479,
                0.0992099,
                0.486126,
                -0.107173,
                0.504546,
                0.10999,
                0.488066,
                -0.11677,
                0.50557,
                0.121476,
                0.490521,
                -0.126725,
                0.506849,
                0.133672,
                0.494232,
                -0.136793,
                0.50911,
                0.146731,
                0.498302,
                -0.147116,
                0.511345,
                0.160577,
                0.503565,
                -0.157446,
                0.514344,
                0.175335,
                0.510902,
                -0.168121,
                0.518824,
                0.191207,
                0.519263,
                -0.178799,
                0.523666,
                0.208058,
                0.528204,
                -0.189407,
                0.528296,
                0.225875,
                0.538854,
                -0.200145,
                0.533724,
                0.244782,
                0.551278,
                -0.210701,
                0.539833,
                0.264753,
                0.565222,
                -0.221303,
                0.546131,
                0.285745,
                0.579403,
                -0.231688,
                0.551496,
                0.307592,
                0.595469,
                -0.241718,
                0.556809,
                0.330582,
                0.610929,
                -0.250992,
                0.559641,
                0.354995,
                0.629433,
                -0.259602,
                0.562379,
                0.382471,
                0.648504,
                -0.267038,
                0.563676,
                0.411126,
                0.66756,
                -0.273388,
                0.562092,
                0.440924,
                0.689143,
                -0.278788,
                0.560807,
                0.472118,
                0.709056,
                -0.282783,
                0.555701,
                0.503774,
                0.729855,
                -0.285836,
                0.548698,
                0.536364,
                0.748954,
                -0.287078,
                0.538544,
                0.56895,
                0.768373,
                -0.287133,
                0.526711,
                0.601991,
                0.78827,
                -0.285839,
                0.512511,
                0.635403,
                0.807465,
                -0.283238,
                0.496323,
                0.668797,
                0.825194,
                -0.27906,
                0.477638,
                0.702584,
                0.842203,
                -0.272286,
                0.456253,
                0.736393,
                0.857749,
                -0.263854,
                0.432412,
                0.77096,
                0.874799,
                -0.253943,
                0.407806,
                0.80489,
                0.887497,
                -0.24237,
                0.38033,
                0.83771,
                0.89966,
                -0.230278,
                0.352446,
                0.870376,
                0.911753,
                -0.21646,
                0.323268,
                0.902256,
                0.923011,
                -0.202071,
                0.294314,
                0.933306,
                0.932375,
                -0.185519,
                0.264104,
                0.965177,
                0.940537,
                -0.167604,
                0.234035,
                0.996303,
                0.948904,
                -0.149068,
                0.20412,
                1.0261,
                0.955263,
                -0.129539,
                0.175431,
                1.05304,
                0.960303,
                -0.109932,
                0.148116,
                1.07617,
                0.965512,
                -0.0880572,
                0.119693,
                1.09742,
                0.973466,
                -0.0660548,
                0.0901619,
                1.11721,
                0.98284,
                -0.0439228,
                0.0599875,
                1.13436,
                0.992216,
                -0.0219588,
                0.0298975,
                1.15006,
                0.999946,
                0.000119402,
                -0.0000208547,
                1.16471,
                0.447827,
                -0.0000100414,
                0.491543,
                0.00000914833,
                0.454778,
                -0.000251257,
                0.499172,
                0.00022891,
                0.453519,
                -0.00100342,
                0.497787,
                0.000914184,
                0.45357,
                -0.00225776,
                0.497847,
                0.00205701,
                0.453578,
                -0.00401371,
                0.497855,
                0.00365705,
                0.45357,
                -0.00627107,
                0.497841,
                0.00571453,
                0.453598,
                -0.00902968,
                0.497864,
                0.00823019,
                0.453627,
                -0.0122888,
                0.497882,
                0.0112049,
                0.453684,
                -0.0160475,
                0.497923,
                0.0146405,
                0.453764,
                -0.0203044,
                0.49798,
                0.0185394,
                0.453866,
                -0.0250576,
                0.498049,
                0.0229054,
                0.453996,
                -0.0303028,
                0.49813,
                0.0277424,
                0.454196,
                -0.0360379,
                0.498267,
                0.0330587,
                0.454457,
                -0.0422521,
                0.498445,
                0.0388613,
                0.454926,
                -0.0488393,
                0.498812,
                0.0451767,
                0.455525,
                -0.0558653,
                0.499272,
                0.0520153,
                0.456074,
                -0.0633772,
                0.499625,
                0.0593754,
                0.456752,
                -0.0713606,
                0.500049,
                0.0672751,
                0.457648,
                -0.07971,
                0.500615,
                0.0757447,
                0.458849,
                -0.0883032,
                0.501399,
                0.0848231,
                0.46029,
                -0.0974095,
                0.502293,
                0.0945135,
                0.462,
                -0.106729,
                0.503301,
                0.104848,
                0.464121,
                -0.116354,
                0.504533,
                0.115884,
                0.466889,
                -0.126214,
                0.506172,
                0.127652,
                0.470744,
                -0.136324,
                0.508667,
                0.14024,
                0.47488,
                -0.146595,
                0.510995,
                0.153673,
                0.480845,
                -0.157027,
                0.514832,
                0.168053,
                0.488262,
                -0.167658,
                0.519506,
                0.183508,
                0.496547,
                -0.178343,
                0.524347,
                0.199948,
                0.506254,
                -0.188916,
                0.52983,
                0.217503,
                0.517961,
                -0.199975,
                0.536357,
                0.236272,
                0.531484,
                -0.210624,
                0.543641,
                0.256096,
                0.545496,
                -0.221227,
                0.550048,
                0.277085,
                0.559497,
                -0.231568,
                0.555076,
                0.298615,
                0.575752,
                -0.241698,
                0.560541,
                0.321547,
                0.591999,
                -0.251172,
                0.564156,
                0.345602,
                0.610654,
                -0.260178,
                0.567607,
                0.371851,
                0.630484,
                -0.268094,
                0.56923,
                0.40076,
                0.651807,
                -0.274661,
                0.569779,
                0.430801,
                0.67239,
                -0.280331,
                0.566791,
                0.461939,
                0.693024,
                -0.284501,
                0.562007,
                0.493854,
                0.715473,
                -0.287852,
                0.555791,
                0.526992,
                0.736323,
                -0.28929,
                0.546345,
                0.560102,
                0.755771,
                -0.289405,
                0.534,
                0.593543,
                0.775424,
                -0.2881,
                0.519114,
                0.627256,
                0.795447,
                -0.285562,
                0.502543,
                0.661464,
                0.815319,
                -0.281416,
                0.484773,
                0.695206,
                0.831769,
                -0.275523,
                0.463445,
                0.729044,
                0.849464,
                -0.267516,
                0.440269,
                0.764069,
                0.866775,
                -0.257584,
                0.415049,
                0.799089,
                0.881252,
                -0.245817,
                0.388049,
                0.831948,
                0.894209,
                -0.233127,
                0.35889,
                0.865526,
                0.906922,
                -0.219579,
                0.329915,
                0.89818,
                0.919686,
                -0.204491,
                0.300441,
                0.930013,
                0.929044,
                -0.188962,
                0.269445,
                0.962061,
                0.938393,
                -0.171079,
                0.238402,
                0.994214,
                0.94661,
                -0.15199,
                0.208204,
                1.02533,
                0.953095,
                -0.131953,
                0.178653,
                1.0529,
                0.958644,
                -0.111233,
                0.150684,
                1.0771,
                0.963925,
                -0.0903098,
                0.122359,
                1.09855,
                0.971995,
                -0.0680505,
                0.0923342,
                1.11874,
                0.981658,
                -0.0448512,
                0.0614195,
                1.13635,
                0.991649,
                -0.0221931,
                0.0303582,
                1.15238,
                0.999985,
                0.000393403,
                -0.000111086,
                1.16772,
                0.396806,
                -0.00000971563,
                0.457671,
                0.00000842355,
                0.429186,
                -0.000249421,
                0.495017,
                0.00021625,
                0.429324,
                -0.000998052,
                0.495173,
                0.000865322,
                0.429175,
                -0.00224487,
                0.494999,
                0.00194637,
                0.429129,
                -0.00399041,
                0.494952,
                0.00346004,
                0.429153,
                -0.00623476,
                0.494974,
                0.00540684,
                0.429168,
                -0.0089773,
                0.494983,
                0.00778714,
                0.429207,
                -0.0122175,
                0.495012,
                0.0106022,
                0.429257,
                -0.0159542,
                0.495047,
                0.0138535,
                0.429338,
                -0.0201864,
                0.495106,
                0.0175443,
                0.429431,
                -0.0249104,
                0.495165,
                0.0216774,
                0.429587,
                -0.0301252,
                0.495279,
                0.0262594,
                0.429796,
                -0.0358249,
                0.495432,
                0.0312968,
                0.430065,
                -0.0419972,
                0.495621,
                0.0367985,
                0.430588,
                -0.0485144,
                0.496061,
                0.042798,
                0.43113,
                -0.0555028,
                0.496472,
                0.0492914,
                0.431743,
                -0.0629852,
                0.496904,
                0.0562907,
                0.432448,
                -0.0709256,
                0.497369,
                0.0638056,
                0.433414,
                -0.0791942,
                0.498032,
                0.071885,
                0.434638,
                -0.0877346,
                0.498854,
                0.0805517,
                0.43611,
                -0.0968056,
                0.499812,
                0.0898047,
                0.437859,
                -0.106002,
                0.500891,
                0.0997142,
                0.440017,
                -0.115648,
                0.502198,
                0.110289,
                0.443236,
                -0.125427,
                0.504389,
                0.121644,
                0.44697,
                -0.135492,
                0.506809,
                0.133769,
                0.451689,
                -0.145746,
                0.509858,
                0.146787,
                0.45811,
                -0.156219,
                0.514247,
                0.160793,
                0.465305,
                -0.166834,
                0.518816,
                0.175791,
                0.474085,
                -0.177546,
                0.524331,
                0.191906,
                0.484808,
                -0.188262,
                0.53104,
                0.209199,
                0.49732,
                -0.199346,
                0.538511,
                0.227825,
                0.509693,
                -0.209951,
                0.544554,
                0.247269,
                0.524367,
                -0.220533,
                0.551616,
                0.267978,
                0.539228,
                -0.231082,
                0.557368,
                0.289672,
                0.55644,
                -0.241342,
                0.563782,
                0.31268,
                0.574204,
                -0.250964,
                0.568851,
                0.33651,
                0.593388,
                -0.260306,
                0.57312,
                0.362219,
                0.613358,
                -0.268667,
                0.574916,
                0.390322,
                0.634512,
                -0.275591,
                0.575053,
                0.420478,
                0.65563,
                -0.281328,
                0.572404,
                0.451614,
                0.678265,
                -0.285948,
                0.568893,
                0.484112,
                0.70011,
                -0.289408,
                0.561878,
                0.517348,
                0.723005,
                -0.291328,
                0.55359,
                0.551355,
                0.743744,
                -0.291418,
                0.541099,
                0.585109,
                0.763949,
                -0.290252,
                0.526489,
                0.619487,
                0.784186,
                -0.287648,
                0.509496,
                0.65404,
                0.804304,
                -0.283782,
                0.491484,
                0.688649,
                0.823629,
                -0.278067,
                0.470517,
                0.723133,
                0.84094,
                -0.270588,
                0.44705,
                0.757163,
                0.857852,
                -0.261188,
                0.421252,
                0.792816,
                0.874934,
                -0.249313,
                0.394191,
                0.827248,
                0.888709,
                -0.236492,
                0.365359,
                0.861074,
                0.902589,
                -0.222185,
                0.336016,
                0.894417,
                0.914201,
                -0.207314,
                0.30527,
                0.926825,
                0.925978,
                -0.191146,
                0.274532,
                0.9595,
                0.93512,
                -0.174135,
                0.243393,
                0.991583,
                0.943656,
                -0.155231,
                0.212414,
                1.02356,
                0.951719,
                -0.134403,
                0.182005,
                1.05239,
                0.957164,
                -0.113023,
                0.153043,
                1.07754,
                0.962656,
                -0.0914493,
                0.124186,
                1.09984,
                0.970695,
                -0.0694179,
                0.0941654,
                1.12,
                0.980749,
                -0.0466199,
                0.0629671,
                1.13849,
                0.991205,
                -0.0227032,
                0.0311146,
                1.15494,
                0.999884,
                0.000632388,
                -0.000254483,
                1.1706,
                0.379821,
                -0.00000957289,
                0.460637,
                0.00000789337,
                0.405188,
                -0.000247483,
                0.491396,
                0.000204064,
                0.404796,
                -0.000989434,
                0.490914,
                0.000815853,
                0.40483,
                -0.00222607,
                0.490949,
                0.00183559,
                0.40473,
                -0.00395723,
                0.49084,
                0.00326332,
                0.404731,
                -0.00618287,
                0.490836,
                0.00509945,
                0.404768,
                -0.00890258,
                0.490871,
                0.00734463,
                0.404791,
                -0.0121156,
                0.490883,
                0.00999992,
                0.404857,
                -0.0158214,
                0.490938,
                0.0130676,
                0.404943,
                -0.0200178,
                0.491004,
                0.0165503,
                0.405059,
                -0.0247027,
                0.491093,
                0.0204521,
                0.405213,
                -0.0298729,
                0.491205,
                0.0247788,
                0.405399,
                -0.0355226,
                0.491333,
                0.0295373,
                0.405731,
                -0.0416352,
                0.491604,
                0.034741,
                0.406303,
                -0.0480807,
                0.492116,
                0.0404255,
                0.406814,
                -0.0550458,
                0.492506,
                0.0465732,
                0.407404,
                -0.0624652,
                0.492926,
                0.0532058,
                0.408149,
                -0.0702958,
                0.493442,
                0.0603442,
                0.409128,
                -0.0784623,
                0.494136,
                0.0680297,
                0.410408,
                -0.087007,
                0.495054,
                0.0762786,
                0.411813,
                -0.0959639,
                0.495962,
                0.0851046,
                0.413735,
                -0.105075,
                0.497257,
                0.0945878,
                0.416137,
                -0.114646,
                0.498882,
                0.104725,
                0.41934,
                -0.124394,
                0.501132,
                0.11563,
                0.423326,
                -0.134328,
                0.503883,
                0.127325,
                0.428419,
                -0.14458,
                0.50747,
                0.139911,
                0.43484,
                -0.154979,
                0.511964,
                0.153481,
                0.442641,
                -0.165628,
                0.517328,
                0.168114,
                0.452511,
                -0.176365,
                0.524258,
                0.183995,
                0.463473,
                -0.187298,
                0.531248,
                0.200953,
                0.475564,
                -0.198244,
                0.538367,
                0.219176,
                0.488664,
                -0.208938,
                0.545175,
                0.238514,
                0.504073,
                -0.219599,
                0.553227,
                0.259129,
                0.520832,
                -0.230378,
                0.560653,
                0.280997,
                0.538455,
                -0.240703,
                0.567523,
                0.303821,
                0.55709,
                -0.250548,
                0.573287,
                0.327948,
                0.576646,
                -0.259964,
                0.577795,
                0.353362,
                0.596705,
                -0.268721,
                0.580077,
                0.380336,
                0.618053,
                -0.276054,
                0.58018,
                0.4101,
                0.640303,
                -0.282176,
                0.578747,
                0.44161,
                0.662365,
                -0.286931,
                0.574294,
                0.474106,
                0.684542,
                -0.290521,
                0.567035,
                0.507549,
                0.707984,
                -0.292672,
                0.558687,
                0.541853,
                0.730913,
                -0.293189,
                0.547606,
                0.576581,
                0.752948,
                -0.292199,
                0.533471,
                0.61172,
                0.773452,
                -0.289508,
                0.516395,
                0.646339,
                0.794715,
                -0.285716,
                0.497873,
                0.682131,
                0.814251,
                -0.280051,
                0.476845,
                0.716396,
                0.833057,
                -0.272873,
                0.453449,
                0.751503,
                0.84959,
                -0.263982,
                0.427857,
                0.786085,
                0.867022,
                -0.252745,
                0.400335,
                0.821355,
                0.882277,
                -0.239655,
                0.371304,
                0.85646,
                0.895375,
                -0.225386,
                0.340397,
                0.890828,
                0.909347,
                -0.209587,
                0.310005,
                0.923532,
                0.921885,
                -0.193433,
                0.2796,
                0.956419,
                0.932127,
                -0.176135,
                0.247276,
                0.989445,
                0.941869,
                -0.157872,
                0.216186,
                1.02221,
                0.949735,
                -0.137577,
                0.185602,
                1.05195,
                0.956617,
                -0.115285,
                0.155767,
                1.07822,
                0.961974,
                -0.0928418,
                0.126103,
                1.10149,
                0.96972,
                -0.0700592,
                0.0956758,
                1.12207,
                0.98012,
                -0.0474671,
                0.0643269,
                1.1408,
                0.990825,
                -0.0238113,
                0.0320863,
                1.1577,
                0.999876,
                0.000381574,
                -0.0000812203,
                1.17403,
                0.367636,
                -0.00000961342,
                0.469176,
                0.00000753287,
                0.380377,
                -0.000244772,
                0.485434,
                0.000191797,
                0.380416,
                -0.000978857,
                0.485475,
                0.000767015,
                0.380376,
                -0.00220165,
                0.485435,
                0.00172522,
                0.380419,
                -0.00391408,
                0.485487,
                0.00306734,
                0.380438,
                -0.00611549,
                0.485505,
                0.00479332,
                0.380462,
                -0.00880558,
                0.485525,
                0.00690391,
                0.380496,
                -0.0119837,
                0.485551,
                0.00940039,
                0.38056,
                -0.0156487,
                0.485605,
                0.0122848,
                0.38064,
                -0.0197988,
                0.485666,
                0.0155601,
                0.380767,
                -0.0244324,
                0.48577,
                0.0192313,
                0.380909,
                -0.0295444,
                0.485871,
                0.0233032,
                0.381142,
                -0.0351321,
                0.48606,
                0.0277861,
                0.381472,
                -0.0411535,
                0.486336,
                0.0326939,
                0.382015,
                -0.0475408,
                0.486833,
                0.0380565,
                0.382523,
                -0.0544395,
                0.487231,
                0.0438615,
                0.383129,
                -0.061784,
                0.487683,
                0.0501332,
                0.383952,
                -0.0695085,
                0.488313,
                0.0568996,
                0.38498,
                -0.0775819,
                0.489077,
                0.0641952,
                0.386331,
                -0.0860443,
                0.490113,
                0.0720324,
                0.387788,
                -0.0948406,
                0.491099,
                0.0804379,
                0.389808,
                -0.103899,
                0.492566,
                0.0894899,
                0.39252,
                -0.113313,
                0.494601,
                0.0992098,
                0.395493,
                -0.123007,
                0.496619,
                0.109641,
                0.399826,
                -0.132859,
                0.499912,
                0.120919,
                0.405341,
                -0.143077,
                0.504061,
                0.133107,
                0.411932,
                -0.153465,
                0.508905,
                0.146263,
                0.420591,
                -0.164108,
                0.515482,
                0.160544,
                0.43101,
                -0.174893,
                0.523191,
                0.176123,
                0.441881,
                -0.185839,
                0.53026,
                0.192757,
                0.453919,
                -0.196633,
                0.537295,
                0.210535,
                0.468715,
                -0.207611,
                0.546156,
                0.229886,
                0.485182,
                -0.218517,
                0.555173,
                0.250543,
                0.501926,
                -0.229249,
                0.562728,
                0.27221,
                0.51785,
                -0.239481,
                0.567494,
                0.294892,
                0.536947,
                -0.249395,
                0.573889,
                0.318987,
                0.557115,
                -0.259,
                0.578831,
                0.344348,
                0.577966,
                -0.268075,
                0.582055,
                0.371223,
                0.599489,
                -0.276115,
                0.583307,
                0.399834,
                0.62479,
                -0.282523,
                0.583902,
                0.431415,
                0.647504,
                -0.287663,
                0.57953,
                0.464301,
                0.670601,
                -0.291538,
                0.573103,
                0.498123,
                0.693539,
                -0.293842,
                0.563731,
                0.532662,
                0.717385,
                -0.294681,
                0.553169,
                0.567925,
                0.741533,
                -0.293717,
                0.539908,
                0.603502,
                0.762142,
                -0.291156,
                0.521902,
                0.639074,
                0.783014,
                -0.28719,
                0.502815,
                0.674439,
                0.805158,
                -0.281773,
                0.482598,
                0.710497,
                0.823646,
                -0.274682,
                0.458949,
                0.7456,
                0.841879,
                -0.266184,
                0.433129,
                0.781085,
                0.859515,
                -0.255682,
                0.406064,
                0.816,
                0.875335,
                -0.242849,
                0.376509,
                0.851074,
                0.890147,
                -0.228329,
                0.345502,
                0.886473,
                0.903144,
                -0.212491,
                0.31428,
                0.920751,
                0.916618,
                -0.195695,
                0.282994,
                0.954606,
                0.927953,
                -0.178267,
                0.251091,
                0.988402,
                0.937414,
                -0.159549,
                0.219107,
                1.02141,
                0.946823,
                -0.140022,
                0.18896,
                1.05167,
                0.954651,
                -0.118154,
                0.158667,
                1.07819,
                0.959955,
                -0.0946636,
                0.128808,
                1.1025,
                0.96858,
                -0.0711792,
                0.0973787,
                1.12391,
                0.97938,
                -0.0475046,
                0.0650965,
                1.14322,
                0.990498,
                -0.024059,
                0.0326267,
                1.16077,
                0.999844,
                -0.0000512408,
                0.000112444,
                1.17727,
                0.316912,
                -0.00000934977,
                0.425996,
                0.00000695559,
                0.356423,
                -0.000241372,
                0.479108,
                0.000179562,
                0.356272,
                -0.000965292,
                0.478897,
                0.00071811,
                0.356262,
                -0.00217182,
                0.478894,
                0.00161574,
                0.356265,
                -0.00386092,
                0.478895,
                0.00287261,
                0.356278,
                -0.0060324,
                0.478905,
                0.00448907,
                0.356293,
                -0.00868565,
                0.478914,
                0.00646572,
                0.356346,
                -0.0118207,
                0.478965,
                0.00880438,
                0.356395,
                -0.0154355,
                0.479001,
                0.0115066,
                0.356484,
                -0.019529,
                0.479075,
                0.0145762,
                0.356609,
                -0.0240991,
                0.47918,
                0.018018,
                0.356766,
                -0.0291413,
                0.479305,
                0.0218379,
                0.357009,
                -0.0346498,
                0.479512,
                0.0260454,
                0.357424,
                -0.0405462,
                0.479909,
                0.0306657,
                0.357899,
                -0.0468825,
                0.480337,
                0.0357054,
                0.358424,
                -0.0536887,
                0.480771,
                0.0411728,
                0.359041,
                -0.0609416,
                0.481242,
                0.0470841,
                0.359903,
                -0.0685239,
                0.481943,
                0.0534831,
                0.360932,
                -0.0764883,
                0.482741,
                0.0603795,
                0.362196,
                -0.0848364,
                0.483688,
                0.0678028,
                0.363847,
                -0.0935002,
                0.484947,
                0.0758086,
                0.365972,
                -0.102471,
                0.486588,
                0.0844173,
                0.368741,
                -0.111751,
                0.488787,
                0.0937199,
                0.372146,
                -0.121334,
                0.491405,
                0.103732,
                0.377114,
                -0.131147,
                0.495604,
                0.114608,
                0.38226,
                -0.141213,
                0.499436,
                0.126345,
                0.389609,
                -0.151632,
                0.505334,
                0.139116,
                0.397925,
                -0.162073,
                0.51168,
                0.152995,
                0.407824,
                -0.172819,
                0.518876,
                0.168071,
                0.420014,
                -0.183929,
                0.527639,
                0.184495,
                0.434266,
                -0.195032,
                0.537588,
                0.20232,
                0.447352,
                -0.205792,
                0.544379,
                0.221189,
                0.463726,
                -0.216704,
                0.553422,
                0.241616,
                0.481406,
                -0.227531,
                0.562074,
                0.263298,
                0.498707,
                -0.238017,
                0.568227,
                0.286116,
                0.518039,
                -0.247936,
                0.574473,
                0.3101,
                0.538277,
                -0.257437,
                0.579191,
                0.335401,
                0.561166,
                -0.266829,
                0.584807,
                0.362246,
                0.583189,
                -0.275329,
                0.586476,
                0.390609,
                0.606024,
                -0.28234,
                0.585578,
                0.420998,
                0.632419,
                -0.287924,
                0.584496,
                0.454357,
                0.656128,
                -0.291972,
                0.577766,
                0.488233,
                0.679953,
                -0.29456,
                0.56875,
                0.523248,
                0.704654,
                -0.295816,
                0.558388,
                0.559168,
                0.729016,
                -0.295157,
                0.544826,
                0.595326,
                0.752062,
                -0.292779,
                0.528273,
                0.631864,
                0.773138,
                -0.288681,
                0.508482,
                0.667793,
                0.794869,
                -0.283358,
                0.487341,
                0.704035,
                0.815101,
                -0.27608,
                0.46354,
                0.739925,
                0.834212,
                -0.26767,
                0.438672,
                0.775539,
                0.852368,
                -0.257397,
                0.411239,
                0.810895,
                0.870207,
                -0.245689,
                0.3829,
                0.846472,
                0.884063,
                -0.231452,
                0.351496,
                0.881788,
                0.898284,
                -0.215561,
                0.31895,
                0.917438,
                0.912964,
                -0.198208,
                0.287367,
                0.952422,
                0.924666,
                -0.180426,
                0.254487,
                0.987551,
                0.934429,
                -0.161525,
                0.222226,
                1.02142,
                0.943485,
                -0.141197,
                0.191143,
                1.05218,
                0.9521,
                -0.120085,
                0.161112,
                1.07937,
                0.957876,
                -0.0975881,
                0.130982,
                1.10403,
                0.966943,
                -0.0726842,
                0.0990553,
                1.12616,
                0.978313,
                -0.0483705,
                0.0662818,
                1.14619,
                0.990048,
                -0.0239072,
                0.0329243,
                1.16413,
                0.999984,
                0.000461885,
                -0.0000772859,
                1.18099,
                0.321287,
                -0.00000935049,
                0.455413,
                0.00000659662,
                0.332595,
                -0.000237513,
                0.471437,
                0.000167562,
                0.332729,
                -0.000949964,
                0.471618,
                0.000670192,
                0.332305,
                -0.00213618,
                0.471028,
                0.00150712,
                0.332326,
                -0.00379765,
                0.471055,
                0.00267959,
                0.332344,
                -0.00593353,
                0.471072,
                0.00418751,
                0.332356,
                -0.00854349,
                0.471077,
                0.00603172,
                0.332403,
                -0.0116268,
                0.471121,
                0.00821362,
                0.332461,
                -0.0151824,
                0.47117,
                0.0107357,
                0.332552,
                -0.0192088,
                0.471251,
                0.0136014,
                0.332657,
                -0.0237024,
                0.47133,
                0.0168152,
                0.332835,
                -0.0286615,
                0.471487,
                0.0203853,
                0.333083,
                -0.0340765,
                0.471708,
                0.0243212,
                0.333547,
                -0.0398563,
                0.47219,
                0.0286518,
                0.333989,
                -0.0460916,
                0.472587,
                0.0333763,
                0.334532,
                -0.0527897,
                0.473054,
                0.0385084,
                0.335167,
                -0.0599284,
                0.473568,
                0.0440638,
                0.33608,
                -0.0673514,
                0.474362,
                0.0500962,
                0.337146,
                -0.0752237,
                0.475231,
                0.0566022,
                0.338462,
                -0.083418,
                0.476282,
                0.0636272,
                0.34014,
                -0.0919382,
                0.477615,
                0.0712153,
                0.342341,
                -0.100741,
                0.479404,
                0.079417,
                0.345088,
                -0.109905,
                0.481618,
                0.0882631,
                0.349049,
                -0.119369,
                0.485081,
                0.0978851,
                0.353939,
                -0.129033,
                0.489317,
                0.108336,
                0.359893,
                -0.139038,
                0.494309,
                0.119698,
                0.366945,
                -0.149411,
                0.499983,
                0.132024,
                0.375814,
                -0.159843,
                0.507185,
                0.145558,
                0.387112,
                -0.170664,
                0.516392,
                0.160433,
                0.40023,
                -0.181897,
                0.526519,
                0.176648,
                0.412555,
                -0.192785,
                0.53423,
                0.193922,
                0.427023,
                -0.203663,
                0.542741,
                0.212662,
                0.443685,
                -0.214695,
                0.552066,
                0.232944,
                0.461499,
                -0.225561,
                0.560762,
                0.254495,
                0.480975,
                -0.236257,
                0.569421,
                0.277531,
                0.501,
                -0.24639,
                0.576101,
                0.301724,
                0.521691,
                -0.256101,
                0.581493,
                0.327112,
                0.543478,
                -0.265289,
                0.585221,
                0.353917,
                0.566094,
                -0.273938,
                0.587614,
                0.381941,
                0.589578,
                -0.281679,
                0.587991,
                0.41172,
                0.614583,
                -0.287655,
                0.585928,
                0.444148,
                0.641813,
                -0.292228,
                0.582092,
                0.478617,
                0.666189,
                -0.295172,
                0.57398,
                0.51397,
                0.690475,
                -0.29648,
                0.561676,
                0.550118,
                0.715543,
                -0.296203,
                0.548758,
                0.586933,
                0.740405,
                -0.293999,
                0.532792,
                0.62384,
                0.762183,
                -0.28998,
                0.512735,
                0.660723,
                0.786069,
                -0.28478,
                0.492402,
                0.69807,
                0.806812,
                -0.277568,
                0.469058,
                0.734422,
                0.826987,
                -0.268951,
                0.443017,
                0.770946,
                0.844588,
                -0.259049,
                0.415501,
                0.80699,
                0.863725,
                -0.2471,
                0.387328,
                0.842107,
                0.879137,
                -0.234157,
                0.356108,
                0.878078,
                0.894634,
                -0.218719,
                0.324315,
                0.914058,
                0.909162,
                -0.201293,
                0.291813,
                0.949922,
                0.92072,
                -0.18267,
                0.258474,
                0.985337,
                0.93158,
                -0.163212,
                0.225593,
                1.0205,
                0.941238,
                -0.142771,
                0.193986,
                1.05273,
                0.949293,
                -0.120956,
                0.163392,
                1.08075,
                0.956226,
                -0.0985743,
                0.132934,
                1.10559,
                0.96546,
                -0.075118,
                0.101255,
                1.12823,
                0.977403,
                -0.0497921,
                0.0675441,
                1.149,
                0.989648,
                -0.0241574,
                0.0334681,
                1.16765,
                1.00001,
                0.0005762,
                -0.000184807,
                1.18519,
                0.303474,
                -0.00000916603,
                0.4542,
                0.0000061243,
                0.308894,
                -0.000232869,
                0.462306,
                0.000155592,
                0.309426,
                -0.000931661,
                0.463093,
                0.000622499,
                0.308643,
                -0.0020949,
                0.461933,
                0.00139979,
                0.308651,
                -0.0037242,
                0.461941,
                0.00248874,
                0.308662,
                -0.00581873,
                0.46195,
                0.00388933,
                0.308687,
                -0.00837818,
                0.461974,
                0.00560247,
                0.308728,
                -0.0114016,
                0.462011,
                0.00762948,
                0.308789,
                -0.0148884,
                0.462067,
                0.00997326,
                0.308882,
                -0.0188369,
                0.462151,
                0.0126375,
                0.309007,
                -0.0232436,
                0.462263,
                0.0156271,
                0.30918,
                -0.0281054,
                0.462417,
                0.0189498,
                0.309442,
                -0.0334065,
                0.462667,
                0.0226167,
                0.309901,
                -0.0390589,
                0.463162,
                0.0266614,
                0.310331,
                -0.0452042,
                0.463555,
                0.0310715,
                0.310858,
                -0.0517735,
                0.464019,
                0.0358698,
                0.311576,
                -0.0587359,
                0.464669,
                0.0410848,
                0.312436,
                -0.0660383,
                0.465406,
                0.0467453,
                0.313526,
                -0.0737266,
                0.466339,
                0.0528718,
                0.314903,
                -0.0817574,
                0.467504,
                0.0595039,
                0.316814,
                -0.090167,
                0.469226,
                0.0666888,
                0.318965,
                -0.0987555,
                0.470981,
                0.0744658,
                0.322077,
                -0.107792,
                0.473814,
                0.082912,
                0.325947,
                -0.117098,
                0.477241,
                0.0920846,
                0.331008,
                -0.126602,
                0.48184,
                0.102137,
                0.337893,
                -0.136619,
                0.488334,
                0.113135,
                0.345106,
                -0.146838,
                0.494415,
                0.12511,
                0.355111,
                -0.157357,
                0.503275,
                0.138356,
                0.365095,
                -0.167955,
                0.510966,
                0.152686,
                0.378344,
                -0.179157,
                0.521508,
                0.16856,
                0.391599,
                -0.190143,
                0.530455,
                0.18561,
                0.407786,
                -0.20123,
                0.541275,
                0.204308,
                0.425294,
                -0.212456,
                0.551784,
                0.224623,
                0.444021,
                -0.223568,
                0.561493,
                0.246172,
                0.463418,
                -0.234154,
                0.569886,
                0.268979,
                0.484077,
                -0.244546,
                0.577116,
                0.293411,
                0.505513,
                -0.254301,
                0.582914,
                0.318936,
                0.527672,
                -0.263564,
                0.587208,
                0.345856,
                0.550565,
                -0.272332,
                0.589277,
                0.374054,
                0.573656,
                -0.280011,
                0.588426,
                0.403276,
                0.59827,
                -0.286924,
                0.587504,
                0.43474,
                0.624731,
                -0.291994,
                0.583401,
                0.468767,
                0.652396,
                -0.295159,
                0.576997,
                0.504411,
                0.67732,
                -0.296954,
                0.565863,
                0.54114,
                0.703147,
                -0.296877,
                0.552316,
                0.57816,
                0.728715,
                -0.295147,
                0.536773,
                0.616124,
                0.752448,
                -0.291275,
                0.51771,
                0.653885,
                0.775169,
                -0.285905,
                0.496087,
                0.691537,
                0.799307,
                -0.279064,
                0.474232,
                0.729251,
                0.819482,
                -0.270294,
                0.447676,
                0.766267,
                0.837659,
                -0.260032,
                0.419656,
                0.802616,
                0.856903,
                -0.248497,
                0.391328,
                0.838583,
                0.873325,
                -0.235252,
                0.360285,
                0.874711,
                0.889788,
                -0.221126,
                0.329215,
                0.91077,
                0.904486,
                -0.204304,
                0.296392,
                0.94653,
                0.917711,
                -0.185562,
                0.262159,
                0.983828,
                0.928969,
                -0.165635,
                0.229142,
                1.01955,
                0.939707,
                -0.14442,
                0.19673,
                1.05317,
                0.948167,
                -0.122147,
                0.165095,
                1.0823,
                0.955222,
                -0.099098,
                0.13451,
                1.10791,
                0.964401,
                -0.0755332,
                0.102476,
                1.1312,
                0.976605,
                -0.0513817,
                0.0689667,
                1.15218,
                0.989085,
                -0.0258499,
                0.034506,
                1.17129,
                0.999908,
                0.000617773,
                -0.000271268,
                1.18961,
                0.285803,
                -0.00000905752,
                0.452348,
                0.00000572272,
                0.284689,
                -0.00022732,
                0.450581,
                0.000143626,
                0.285263,
                -0.000910214,
                0.451482,
                0.000575099,
                0.285302,
                -0.00204784,
                0.451553,
                0.00129395,
                0.285318,
                -0.00364057,
                0.451574,
                0.0023006,
                0.28533,
                -0.00568813,
                0.451585,
                0.00359547,
                0.285361,
                -0.00819001,
                0.451618,
                0.00517934,
                0.285397,
                -0.0111458,
                0.45165,
                0.007054,
                0.285447,
                -0.0145536,
                0.451688,
                0.00922167,
                0.285527,
                -0.0184127,
                0.451758,
                0.0116869,
                0.285688,
                -0.0227207,
                0.451929,
                0.0144555,
                0.28584,
                -0.0274712,
                0.452055,
                0.0175341,
                0.286136,
                -0.0326278,
                0.452369,
                0.0209406,
                0.286574,
                -0.0381792,
                0.452853,
                0.0246965,
                0.287012,
                -0.0441879,
                0.453272,
                0.0287996,
                0.287542,
                -0.0506096,
                0.453752,
                0.033268,
                0.288299,
                -0.0573634,
                0.454488,
                0.0381504,
                0.289186,
                -0.0645458,
                0.455294,
                0.0434447,
                0.290302,
                -0.0720405,
                0.456301,
                0.0491973,
                0.291776,
                -0.0799046,
                0.457648,
                0.0554453,
                0.29372,
                -0.088117,
                0.459483,
                0.0622311,
                0.296052,
                -0.0965328,
                0.461571,
                0.0695992,
                0.299563,
                -0.105409,
                0.465085,
                0.077658,
                0.30335,
                -0.114553,
                0.468506,
                0.0864176,
                0.309167,
                -0.123917,
                0.474423,
                0.0961078,
                0.31529,
                -0.13381,
                0.47995,
                0.106643,
                0.324163,
                -0.144021,
                0.488592,
                0.118322,
                0.333272,
                -0.154382,
                0.496461,
                0.131133,
                0.344224,
                -0.165015,
                0.50562,
                0.145208,
                0.357733,
                -0.176168,
                0.516719,
                0.16073,
                0.373046,
                -0.187468,
                0.528513,
                0.177807,
                0.38788,
                -0.198488,
                0.537713,
                0.196072,
                0.405133,
                -0.209545,
                0.547999,
                0.21605,
                0.423845,
                -0.220724,
                0.55759,
                0.237484,
                0.443777,
                -0.231518,
                0.566246,
                0.26039,
                0.464824,
                -0.242035,
                0.574326,
                0.284835,
                0.486635,
                -0.251898,
                0.58037,
                0.310518,
                0.51012,
                -0.261304,
                0.58568,
                0.337678,
                0.535301,
                -0.270384,
                0.590197,
                0.366242,
                0.559193,
                -0.27841,
                0.590569,
                0.395873,
                0.583544,
                -0.285325,
                0.588161,
                0.426857,
                0.608834,
                -0.291113,
                0.584249,
                0.459477,
                0.635753,
                -0.294882,
                0.57763,
                0.494734,
                0.664367,
                -0.297088,
                0.569479,
                0.532023,
                0.689688,
                -0.297364,
                0.555064,
                0.569629,
                0.715732,
                -0.295949,
                0.539522,
                0.608124,
                0.741307,
                -0.292259,
                0.521613,
                0.646231,
                0.764949,
                -0.287063,
                0.49969,
                0.684938,
                0.788599,
                -0.28012,
                0.476747,
                0.723548,
                0.81048,
                -0.27153,
                0.45116,
                0.761135,
                0.831372,
                -0.261289,
                0.424101,
                0.798916,
                0.850092,
                -0.249559,
                0.39443,
                0.835952,
                0.867777,
                -0.236348,
                0.363849,
                0.871606,
                0.884632,
                -0.221569,
                0.332477,
                0.907843,
                0.90047,
                -0.20618,
                0.300667,
                0.944187,
                0.914524,
                -0.188771,
                0.266552,
                0.981371,
                0.926892,
                -0.168362,
                0.232349,
                1.01841,
                0.937951,
                -0.146761,
                0.199359,
                1.05308,
                0.947236,
                -0.123813,
                0.1675,
                1.0839,
                0.954367,
                -0.099984,
                0.136166,
                1.11047,
                0.963907,
                -0.0759278,
                0.103808,
                1.13414,
                0.976218,
                -0.0511367,
                0.0697061,
                1.15575,
                0.988772,
                -0.0267415,
                0.0352529,
                1.17531,
                0.999888,
                -0.000520778,
                0.000289926,
                1.19389,
                0.263546,
                -0.00000883274,
                0.441896,
                0.00000526783,
                0.262352,
                -0.000221849,
                0.439889,
                0.000132311,
                0.262325,
                -0.000886683,
                0.439848,
                0.000528824,
                0.26228,
                -0.00199476,
                0.439765,
                0.00118975,
                0.262372,
                -0.00354671,
                0.439922,
                0.00211568,
                0.26239,
                -0.00554141,
                0.439941,
                0.00330652,
                0.262412,
                -0.00797888,
                0.439961,
                0.00476346,
                0.262453,
                -0.0108584,
                0.440002,
                0.00648818,
                0.262528,
                -0.0141788,
                0.440085,
                0.0084835,
                0.262615,
                -0.017938,
                0.440166,
                0.0107533,
                0.262744,
                -0.0221346,
                0.440291,
                0.0133044,
                0.262939,
                -0.026762,
                0.440493,
                0.0161445,
                0.263277,
                -0.0317573,
                0.440889,
                0.0192974,
                0.26368,
                -0.0371832,
                0.441338,
                0.0227699,
                0.264106,
                -0.0430371,
                0.441753,
                0.0265698,
                0.264624,
                -0.0493035,
                0.442227,
                0.0307178,
                0.265378,
                -0.0558669,
                0.442985,
                0.0352616,
                0.266253,
                -0.0628718,
                0.443795,
                0.0401968,
                0.267478,
                -0.0701569,
                0.445008,
                0.04559,
                0.269062,
                -0.077845,
                0.446599,
                0.0514539,
                0.270926,
                -0.0857941,
                0.448349,
                0.0578382,
                0.273693,
                -0.0940773,
                0.451221,
                0.0648363,
                0.276746,
                -0.102704,
                0.454097,
                0.0724389,
                0.281693,
                -0.111735,
                0.459517,
                0.0808744,
                0.287335,
                -0.121004,
                0.46531,
                0.0901551,
                0.29448,
                -0.130734,
                0.472605,
                0.100371,
                0.30257,
                -0.140777,
                0.480251,
                0.111644,
                0.312465,
                -0.15111,
                0.489444,
                0.124111,
                0.324856,
                -0.16189,
                0.500919,
                0.137979,
                0.33774,
                -0.172946,
                0.511317,
                0.153163,
                0.35255,
                -0.184152,
                0.522684,
                0.169817,
                0.367786,
                -0.19522,
                0.53248,
                0.187886,
                0.385474,
                -0.20632,
                0.543326,
                0.207634,
                0.404976,
                -0.217744,
                0.554109,
                0.229165,
                0.425203,
                -0.228691,
                0.563395,
                0.252068,
                0.446704,
                -0.239299,
                0.571565,
                0.276471,
                0.468951,
                -0.249348,
                0.577935,
                0.302323,
                0.493487,
                -0.258933,
                0.584309,
                0.329882,
                0.517861,
                -0.268009,
                0.58773,
                0.358525,
                0.543309,
                -0.276238,
                0.589612,
                0.388585,
                0.569704,
                -0.28356,
                0.589294,
                0.419787,
                0.594871,
                -0.289497,
                0.585137,
                0.452114,
                0.622555,
                -0.294452,
                0.580356,
                0.486466,
                0.651167,
                -0.296918,
                0.57185,
                0.523079,
                0.677332,
                -0.297647,
                0.558428,
                0.5611,
                0.703718,
                -0.296321,
                0.542232,
                0.599592,
                0.730262,
                -0.293339,
                0.524541,
                0.639138,
                0.754304,
                -0.288036,
                0.502691,
                0.677978,
                0.778051,
                -0.281018,
                0.479212,
                0.716537,
                0.801557,
                -0.272414,
                0.454071,
                0.75586,
                0.822559,
                -0.262419,
                0.425952,
                0.794477,
                0.843051,
                -0.250702,
                0.397313,
                0.832664,
                0.86232,
                -0.237264,
                0.366534,
                0.869876,
                0.879044,
                -0.222716,
                0.334816,
                0.906973,
                0.896362,
                -0.206827,
                0.303143,
                0.943558,
                0.910342,
                -0.189659,
                0.269699,
                0.979759,
                0.924119,
                -0.171108,
                0.236411,
                1.01718,
                0.935374,
                -0.149579,
                0.202224,
                1.05289,
                0.944295,
                -0.126295,
                0.16989,
                1.08496,
                0.952227,
                -0.101511,
                0.138089,
                1.11256,
                0.962041,
                -0.0766392,
                0.105053,
                1.1375,
                0.97528,
                -0.0511967,
                0.070329,
                1.15983,
                0.988476,
                -0.025463,
                0.0351268,
                1.17987,
                0.999962,
                0.0000286808,
                0.0000145564,
                1.19901,
                0.227089,
                -0.00000841413,
                0.404216,
                0.00000472707,
                0.239725,
                -0.000215083,
                0.426708,
                0.000120833,
                0.239904,
                -0.000860718,
                0.427028,
                0.000483555,
                0.239911,
                -0.00193661,
                0.427039,
                0.00108806,
                0.239914,
                -0.00344276,
                0.42704,
                0.00193457,
                0.239933,
                -0.00537907,
                0.427064,
                0.00302363,
                0.239944,
                -0.00774482,
                0.427065,
                0.00435604,
                0.239993,
                -0.01054,
                0.427122,
                0.00593398,
                0.240052,
                -0.0137626,
                0.427179,
                0.00775987,
                0.240148,
                -0.0174115,
                0.427279,
                0.00983854,
                0.240278,
                -0.021484,
                0.42741,
                0.0121763,
                0.240472,
                -0.0259729,
                0.427618,
                0.0147827,
                0.240839,
                -0.0308131,
                0.428086,
                0.0176837,
                0.241201,
                -0.0360893,
                0.428482,
                0.0208775,
                0.241626,
                -0.0417723,
                0.428907,
                0.0243821,
                0.242207,
                -0.0478337,
                0.42952,
                0.0282228,
                0.24298,
                -0.0542199,
                0.430332,
                0.0324333,
                0.243881,
                -0.0610015,
                0.431222,
                0.0370252,
                0.245123,
                -0.0680874,
                0.432512,
                0.0420535,
                0.24667,
                -0.0755482,
                0.434088,
                0.0475414,
                0.248779,
                -0.0832873,
                0.436323,
                0.0535542,
                0.251665,
                -0.0913546,
                0.439509,
                0.0601716,
                0.255305,
                -0.0998489,
                0.443478,
                0.0674282,
                0.260049,
                -0.108576,
                0.448713,
                0.0754673,
                0.266192,
                -0.117754,
                0.455524,
                0.084339,
                0.273158,
                -0.127294,
                0.4627,
                0.0941683,
                0.282131,
                -0.137311,
                0.472068,
                0.10515,
                0.293332,
                -0.147736,
                0.483565,
                0.117402,
                0.304667,
                -0.158357,
                0.493702,
                0.130824,
                0.317785,
                -0.169274,
                0.504708,
                0.145724,
                0.333245,
                -0.180595,
                0.517107,
                0.16215,
                0.349843,
                -0.191892,
                0.528849,
                0.180149,
                0.367944,
                -0.203168,
                0.540301,
                0.199746,
                0.387579,
                -0.214443,
                0.551514,
                0.221047,
                0.408247,
                -0.225624,
                0.560906,
                0.243981,
                0.43014,
                -0.236422,
                0.56959,
                0.268513,
                0.452669,
                -0.24654,
                0.576098,
                0.294409,
                0.476196,
                -0.256157,
                0.580925,
                0.322002,
                0.501157,
                -0.265289,
                0.584839,
                0.351052,
                0.527632,
                -0.273671,
                0.587614,
                0.3812,
                0.555754,
                -0.281254,
                0.589119,
                0.412994,
                0.581682,
                -0.287448,
                0.585204,
                0.445498,
                0.608196,
                -0.292614,
                0.579006,
                0.479505,
                0.635661,
                -0.296068,
                0.571297,
                0.514643,
                0.664999,
                -0.297395,
                0.560855,
                0.552213,
                0.691039,
                -0.296645,
                0.544525,
                0.591365,
                0.7179,
                -0.293785,
                0.526535,
                0.630883,
                0.744059,
                -0.289089,
                0.50545,
                0.670932,
                0.76863,
                -0.282239,
                0.482514,
                0.710904,
                0.793273,
                -0.273688,
                0.457246,
                0.750259,
                0.814731,
                -0.26328,
                0.428872,
                0.78948,
                0.835603,
                -0.251526,
                0.399384,
                0.828597,
                0.85489,
                -0.238339,
                0.368811,
                0.866892,
                0.872828,
                -0.223607,
                0.336617,
                0.90563,
                0.889462,
                -0.207538,
                0.303997,
                0.943538,
                0.904929,
                -0.190297,
                0.270812,
                0.980591,
                0.919101,
                -0.172034,
                0.237453,
                1.01935,
                0.930536,
                -0.152058,
                0.204431,
                1.05498,
                0.941223,
                -0.129515,
                0.172495,
                1.08717,
                0.94982,
                -0.104263,
                0.140175,
                1.11551,
                0.960592,
                -0.0781944,
                0.106465,
                1.14098,
                0.974629,
                -0.051688,
                0.0711592,
                1.16418,
                0.98811,
                -0.0253929,
                0.0354432,
                1.18465,
                1.00004,
                0.000804378,
                -0.000330876,
                1.20462,
                0.214668,
                -0.00000821282,
                0.406619,
                0.00000433582,
                0.218053,
                -0.000208144,
                0.413025,
                0.000109887,
                0.217987,
                -0.000832212,
                0.412901,
                0.000439362,
                0.217971,
                -0.00187246,
                0.412876,
                0.000988623,
                0.217968,
                -0.00332855,
                0.41286,
                0.00175772,
                0.217985,
                -0.00520055,
                0.412882,
                0.00274729,
                0.218014,
                -0.00748814,
                0.412916,
                0.00395842,
                0.218054,
                -0.0101901,
                0.412957,
                0.00539274,
                0.218106,
                -0.0133057,
                0.413005,
                0.00705348,
                0.218217,
                -0.0168342,
                0.413139,
                0.00894581,
                0.218338,
                -0.0207707,
                0.413258,
                0.0110754,
                0.21855,
                -0.0251001,
                0.413509,
                0.0134551,
                0.218913,
                -0.0297861,
                0.413992,
                0.0161081,
                0.219265,
                -0.0348956,
                0.414383,
                0.0190307,
                0.219696,
                -0.0403909,
                0.414839,
                0.0222458,
                0.220329,
                -0.0462003,
                0.415567,
                0.025792,
                0.220989,
                -0.0524208,
                0.41621,
                0.0296637,
                0.222027,
                -0.058948,
                0.417385,
                0.0339323,
                0.223301,
                -0.0658208,
                0.418779,
                0.0386055,
                0.224988,
                -0.0730347,
                0.420665,
                0.0437355,
                0.227211,
                -0.0805274,
                0.423198,
                0.0493844,
                0.230131,
                -0.088395,
                0.426566,
                0.0556135,
                0.233908,
                -0.0966208,
                0.43091,
                0.0624829,
                0.239092,
                -0.105223,
                0.437148,
                0.0701636,
                0.245315,
                -0.11424,
                0.444302,
                0.0786949,
                0.253166,
                -0.12368,
                0.453262,
                0.0882382,
                0.262374,
                -0.133569,
                0.463211,
                0.0988682,
                0.273145,
                -0.143836,
                0.474271,
                0.110727,
                0.285512,
                -0.154577,
                0.4863,
                0.123945,
                0.299512,
                -0.165501,
                0.498817,
                0.138581,
                0.314287,
                -0.176698,
                0.510341,
                0.154676,
                0.331083,
                -0.188066,
                0.522583,
                0.172459,
                0.349615,
                -0.199597,
                0.534879,
                0.191979,
                0.369318,
                -0.210843,
                0.546083,
                0.21309,
                0.390377,
                -0.222068,
                0.5562,
                0.235998,
                0.412411,
                -0.233059,
                0.564704,
                0.260518,
                0.435715,
                -0.24357,
                0.572314,
                0.286795,
                0.461196,
                -0.253356,
                0.579395,
                0.314559,
                0.485587,
                -0.262362,
                0.581985,
                0.343581,
                0.511908,
                -0.270895,
                0.584347,
                0.374367,
                0.539798,
                -0.278452,
                0.58505,
                0.406015,
                0.567974,
                -0.284877,
                0.583344,
                0.439168,
                0.594303,
                -0.290124,
                0.577348,
                0.473005,
                0.622951,
                -0.294183,
                0.570751,
                0.508534,
                0.652404,
                -0.296389,
                0.561541,
                0.544764,
                0.679291,
                -0.296605,
                0.546426,
                0.582927,
                0.706437,
                -0.294095,
                0.528599,
                0.622681,
                0.734485,
                -0.28978,
                0.508676,
                0.663567,
                0.758841,
                -0.283363,
                0.484768,
                0.704092,
                0.78537,
                -0.275015,
                0.460434,
                0.745101,
                0.807315,
                -0.264689,
                0.432166,
                0.784712,
                0.8271,
                -0.252597,
                0.401807,
                0.824241,
                0.849191,
                -0.239154,
                0.371458,
                0.863803,
                0.867046,
                -0.224451,
                0.338873,
                0.903063,
                0.8852,
                -0.208342,
                0.306175,
                0.942763,
                0.901771,
                -0.190684,
                0.272759,
                0.981559,
                0.915958,
                -0.172105,
                0.239306,
                1.02048,
                0.928046,
                -0.152214,
                0.206071,
                1.05765,
                0.939961,
                -0.130247,
                0.17367,
                1.08999,
                0.948711,
                -0.10672,
                0.142201,
                1.11829,
                0.959305,
                -0.0808688,
                0.108454,
                1.14467,
                0.973009,
                -0.0539145,
                0.0728109,
                1.16839,
                0.987631,
                -0.0262947,
                0.0360625,
                1.19004,
                0.999978,
                0.00132758,
                -0.000559424,
                1.21058,
                0.193925,
                -0.00000793421,
                0.391974,
                0.00000392537,
                0.196746,
                -0.000200315,
                0.397675,
                0.0000991033,
                0.19667,
                -0.000801099,
                0.397521,
                0.000396342,
                0.196633,
                -0.00180246,
                0.397445,
                0.000891829,
                0.196654,
                -0.00320443,
                0.397482,
                0.00158582,
                0.196659,
                -0.00500647,
                0.39748,
                0.00247867,
                0.196683,
                -0.0072086,
                0.397506,
                0.00357167,
                0.196728,
                -0.00981001,
                0.397562,
                0.00486675,
                0.196792,
                -0.0128096,
                0.397633,
                0.00636707,
                0.19689,
                -0.0162055,
                0.397746,
                0.00807752,
                0.197017,
                -0.0199943,
                0.397884,
                0.0100052,
                0.19729,
                -0.024139,
                0.39827,
                0.0121691,
                0.197583,
                -0.0286671,
                0.398639,
                0.0145755,
                0.197927,
                -0.0335858,
                0.399034,
                0.0172355,
                0.198383,
                -0.0388806,
                0.399554,
                0.0201718,
                0.199002,
                -0.0444736,
                0.400289,
                0.0234194,
                0.199739,
                -0.0504583,
                0.401111,
                0.026984,
                0.200784,
                -0.056729,
                0.402349,
                0.0309217,
                0.202075,
                -0.0633643,
                0.403841,
                0.0352496,
                0.203898,
                -0.0703247,
                0.406076,
                0.0400313,
                0.206199,
                -0.0775565,
                0.408841,
                0.0453282,
                0.209252,
                -0.085184,
                0.41259,
                0.0511794,
                0.213638,
                -0.0931994,
                0.418288,
                0.0577459,
                0.21881,
                -0.101617,
                0.424681,
                0.0650508,
                0.225642,
                -0.11052,
                0.433429,
                0.0732759,
                0.233717,
                -0.119772,
                0.442897,
                0.0824683,
                0.242823,
                -0.129505,
                0.452888,
                0.0927484,
                0.254772,
                -0.139906,
                0.466407,
                0.104417,
                0.266603,
                -0.150402,
                0.477413,
                0.117211,
                0.28073,
                -0.161395,
                0.490519,
                0.131598,
                0.295399,
                -0.172465,
                0.50201,
                0.147407,
                0.312705,
                -0.183982,
                0.515311,
                0.165031,
                0.331335,
                -0.195532,
                0.52786,
                0.184336,
                0.351037,
                -0.206971,
                0.5392,
                0.205361,
                0.372175,
                -0.218117,
                0.54941,
                0.228043,
                0.394548,
                -0.229327,
                0.558642,
                0.25267,
                0.419598,
                -0.240052,
                0.567861,
                0.279071,
                0.443922,
                -0.249937,
                0.573332,
                0.306882,
                0.471495,
                -0.259407,
                0.58013,
                0.33661,
                0.496769,
                -0.267749,
                0.580564,
                0.367328,
                0.524951,
                -0.275524,
                0.581696,
                0.399753,
                0.55318,
                -0.282148,
                0.579885,
                0.433134,
                0.581577,
                -0.287533,
                0.575471,
                0.467534,
                0.609231,
                -0.291612,
                0.567445,
                0.502943,
                0.637478,
                -0.293911,
                0.557657,
                0.53871,
                0.667795,
                -0.295096,
                0.546535,
                0.576568,
                0.694272,
                -0.294073,
                0.529561,
                0.614929,
                0.722937,
                -0.290386,
                0.510561,
                0.655909,
                0.749682,
                -0.284481,
                0.487846,
                0.697663,
                0.774754,
                -0.276188,
                0.462487,
                0.738515,
                0.799301,
                -0.266215,
                0.43481,
                0.779802,
                0.820762,
                -0.254116,
                0.404879,
                0.820045,
                0.843231,
                -0.240393,
                0.374559,
                0.860294,
                0.861857,
                -0.225503,
                0.341582,
                0.900965,
                0.880815,
                -0.209382,
                0.308778,
                0.941727,
                0.89766,
                -0.19155,
                0.275232,
                0.980916,
                0.912926,
                -0.172346,
                0.240938,
                1.02162,
                0.926391,
                -0.151799,
                0.207223,
                1.0597,
                0.938429,
                -0.129968,
                0.17484,
                1.09291,
                0.947834,
                -0.10651,
                0.142984,
                1.12248,
                0.958432,
                -0.0824098,
                0.109902,
                1.149,
                0.972402,
                -0.0565242,
                0.0744454,
                1.1733,
                0.987191,
                -0.028427,
                0.0373794,
                1.19538,
                0.999975,
                0.0000385685,
                -0.00004203,
                1.21676,
                0.178114,
                -0.00000766075,
                0.385418,
                0.00000354027,
                0.176074,
                -0.000191966,
                0.381002,
                0.0000887135,
                0.17601,
                -0.000767549,
                0.380861,
                0.000354715,
                0.17598,
                -0.00172696,
                0.380798,
                0.000798168,
                0.175994,
                -0.00307012,
                0.380824,
                0.00141928,
                0.176017,
                -0.00479684,
                0.380858,
                0.00221859,
                0.176019,
                -0.00690648,
                0.380839,
                0.00319714,
                0.176072,
                -0.00939888,
                0.380913,
                0.0043572,
                0.176131,
                -0.0122726,
                0.380979,
                0.005702,
                0.176239,
                -0.0155264,
                0.38112,
                0.00723689,
                0.176371,
                -0.0191551,
                0.381272,
                0.00896907,
                0.176638,
                -0.023117,
                0.381669,
                0.0109194,
                0.176912,
                -0.0274633,
                0.382015,
                0.0130903,
                0.177279,
                -0.032173,
                0.382476,
                0.0154949,
                0.17774,
                -0.0372219,
                0.383041,
                0.0181669,
                0.178344,
                -0.0426132,
                0.38378,
                0.0211209,
                0.179153,
                -0.0483309,
                0.384773,
                0.0243899,
                0.180197,
                -0.0543447,
                0.386076,
                0.0280062,
                0.181581,
                -0.0607122,
                0.387809,
                0.032004,
                0.18344,
                -0.0673855,
                0.390205,
                0.036453,
                0.186139,
                -0.0743989,
                0.393944,
                0.0414162,
                0.189432,
                -0.0817731,
                0.39832,
                0.0469394,
                0.193795,
                -0.0895464,
                0.404188,
                0.0531442,
                0.199641,
                -0.0978264,
                0.4121,
                0.0601374,
                0.206679,
                -0.106499,
                0.421425,
                0.0680078,
                0.214865,
                -0.115654,
                0.431504,
                0.076919,
                0.224406,
                -0.125268,
                0.442526,
                0.0868835,
                0.235876,
                -0.135475,
                0.455465,
                0.0981875,
                0.248335,
                -0.146023,
                0.4681,
                0.110759,
                0.262868,
                -0.157016,
                0.482069,
                0.124885,
                0.278962,
                -0.168245,
                0.496182,
                0.140645,
                0.295082,
                -0.17958,
                0.507401,
                0.157838,
                0.313738,
                -0.191227,
                0.520252,
                0.17695,
                0.333573,
                -0.202718,
                0.531708,
                0.197817,
                0.356433,
                -0.214424,
                0.544509,
                0.220785,
                0.378853,
                -0.225492,
                0.55373,
                0.245306,
                0.402717,
                -0.236236,
                0.561348,
                0.271593,
                0.428375,
                -0.246568,
                0.568538,
                0.299776,
                0.454724,
                -0.255941,
                0.573462,
                0.329433,
                0.482291,
                -0.264511,
                0.576356,
                0.360598,
                0.509706,
                -0.272129,
                0.576446,
                0.393204,
                0.538805,
                -0.278979,
                0.575298,
                0.427227,
                0.568919,
                -0.284528,
                0.572154,
                0.462157,
                0.596804,
                -0.288801,
                0.564691,
                0.497997,
                0.625987,
                -0.291334,
                0.555134,
                0.534467,
                0.656414,
                -0.292722,
                0.545051,
                0.571736,
                0.683916,
                -0.292185,
                0.528813,
                0.610158,
                0.711809,
                -0.290043,
                0.51106,
                0.649061,
                0.739547,
                -0.285246,
                0.490103,
                0.690081,
                0.766914,
                -0.277647,
                0.465523,
                0.732554,
                0.791375,
                -0.267603,
                0.437718,
                0.773982,
                0.814772,
                -0.256109,
                0.40882,
                0.81609,
                0.836691,
                -0.242281,
                0.377823,
                0.856849,
                0.856984,
                -0.227155,
                0.34496,
                0.898363,
                0.876332,
                -0.210395,
                0.311335,
                0.939471,
                0.894988,
                -0.192612,
                0.277703,
                0.980799,
                0.911113,
                -0.173236,
                0.243019,
                1.02215,
                0.924092,
                -0.152258,
                0.209037,
                1.06139,
                0.936828,
                -0.129575,
                0.175909,
                1.09635,
                0.946869,
                -0.10594,
                0.143852,
                1.12707,
                0.958284,
                -0.081318,
                0.110289,
                1.15419,
                0.972325,
                -0.0556133,
                0.0747232,
                1.17909,
                0.986878,
                -0.0297899,
                0.0383149,
                1.20163,
                0.999936,
                -0.00197169,
                0.000912402,
                1.22338,
                0.151174,
                -0.00000720365,
                0.351531,
                0.00000309789,
                0.155594,
                -0.00018279,
                0.361806,
                0.000078608,
                0.156099,
                -0.000731569,
                0.362982,
                0.000314615,
                0.156053,
                -0.00164578,
                0.362869,
                0.000707845,
                0.156093,
                -0.0029261,
                0.362961,
                0.00125884,
                0.156099,
                -0.00457155,
                0.362959,
                0.00196783,
                0.15612,
                -0.00658224,
                0.362982,
                0.00283622,
                0.156168,
                -0.00895774,
                0.363048,
                0.00386625,
                0.156221,
                -0.0116962,
                0.363101,
                0.00506109,
                0.156324,
                -0.0147973,
                0.363241,
                0.00642675,
                0.156476,
                -0.0182503,
                0.363448,
                0.00797175,
                0.156731,
                -0.0220266,
                0.36384,
                0.00971484,
                0.156994,
                -0.026176,
                0.364179,
                0.0116575,
                0.157341,
                -0.0306701,
                0.36462,
                0.0138207,
                0.157867,
                -0.0354591,
                0.365364,
                0.0162356,
                0.15846,
                -0.0406141,
                0.366111,
                0.0189092,
                0.159308,
                -0.0460519,
                0.367248,
                0.021885,
                0.160426,
                -0.0518096,
                0.368767,
                0.0252004,
                0.161877,
                -0.0578906,
                0.370745,
                0.0288825,
                0.163995,
                -0.0642812,
                0.373831,
                0.0330139,
                0.16655,
                -0.0710067,
                0.377366,
                0.0376283,
                0.170237,
                -0.0781522,
                0.382799,
                0.0428493,
                0.175096,
                -0.0857172,
                0.389915,
                0.0487324,
                0.181069,
                -0.0938025,
                0.398487,
                0.0554214,
                0.188487,
                -0.102363,
                0.408799,
                0.0630189,
                0.197029,
                -0.111343,
                0.419991,
                0.071634,
                0.206684,
                -0.120812,
                0.431455,
                0.0812797,
                0.218698,
                -0.131033,
                0.445746,
                0.0923651,
                0.230726,
                -0.141373,
                0.457471,
                0.104545,
                0.245516,
                -0.152387,
                0.472388,
                0.118449,
                0.261551,
                -0.163628,
                0.486671,
                0.133923,
                0.277437,
                -0.174814,
                0.49762,
                0.150849,
                0.296662,
                -0.186713,
                0.51162,
                0.169924,
                0.31795,
                -0.198513,
                0.525435,
                0.190848,
                0.339422,
                -0.210119,
                0.536267,
                0.213504,
                0.362143,
                -0.221354,
                0.545982,
                0.237947,
                0.387198,
                -0.23224,
                0.555364,
                0.264427,
                0.412349,
                -0.24257,
                0.561489,
                0.292519,
                0.439274,
                -0.252284,
                0.566903,
                0.322561,
                0.466779,
                -0.261023,
                0.569614,
                0.353952,
                0.496011,
                -0.26899,
                0.571589,
                0.387278,
                0.524964,
                -0.275498,
                0.570325,
                0.421356,
                0.556518,
                -0.281449,
                0.568792,
                0.457314,
                0.584363,
                -0.285526,
                0.560268,
                0.493199,
                0.614214,
                -0.28844,
                0.55205,
                0.530276,
                0.645684,
                -0.289777,
                0.541906,
                0.56855,
                0.673446,
                -0.289722,
                0.526464,
                0.606927,
                0.701924,
                -0.287792,
                0.509872,
                0.645945,
                0.73037,
                -0.284315,
                0.490649,
                0.685564,
                0.757405,
                -0.278804,
                0.467964,
                0.726511,
                0.784025,
                -0.269543,
                0.441468,
                0.768601,
                0.808255,
                -0.258117,
                0.41216,
                0.811321,
                0.830739,
                -0.244728,
                0.380606,
                0.853496,
                0.851914,
                -0.229428,
                0.348111,
                0.895374,
                0.872586,
                -0.212508,
                0.314732,
                0.937674,
                0.891581,
                -0.194025,
                0.280338,
                0.979869,
                0.907641,
                -0.174711,
                0.245203,
                1.02253,
                0.922233,
                -0.153509,
                0.21077,
                1.06371,
                0.935878,
                -0.130418,
                0.177399,
                1.09972,
                0.946338,
                -0.105558,
                0.144507,
                1.13124,
                0.957265,
                -0.080059,
                0.110508,
                1.15973,
                0.971668,
                -0.0539766,
                0.0742311,
                1.18515,
                0.9866,
                -0.0277101,
                0.0375224,
                1.20858,
                1.00021,
                -0.000515531,
                0.000135226,
                1.23135,
                0.137468,
                -0.00000686011,
                0.345041,
                0.00000273315,
                0.13703,
                -0.000173378,
                0.343936,
                0.0000690761,
                0.136986,
                -0.000693048,
                0.34383,
                0.000276126,
                0.136964,
                -0.00155931,
                0.343761,
                0.000621337,
                0.137003,
                -0.00277211,
                0.343863,
                0.00110494,
                0.137012,
                -0.00433103,
                0.343868,
                0.00172744,
                0.137043,
                -0.00623606,
                0.343916,
                0.00249022,
                0.13709,
                -0.0084868,
                0.343986,
                0.00339559,
                0.137145,
                -0.0110814,
                0.344045,
                0.00444687,
                0.137242,
                -0.0140187,
                0.344177,
                0.00565007,
                0.137431,
                -0.0172713,
                0.344491,
                0.00701868,
                0.137644,
                -0.0208605,
                0.344805,
                0.00856042,
                0.13791,
                -0.024792,
                0.345172,
                0.0102863,
                0.138295,
                -0.0290461,
                0.345734,
                0.0122185,
                0.138764,
                -0.0335957,
                0.346371,
                0.0143771,
                0.139415,
                -0.038467,
                0.347298,
                0.0167894,
                0.140272,
                -0.0436176,
                0.348527,
                0.0194895,
                0.141457,
                -0.0491016,
                0.350276,
                0.0225043,
                0.14303,
                -0.0548764,
                0.352646,
                0.0258962,
                0.145289,
                -0.0610096,
                0.356206,
                0.0297168,
                0.148502,
                -0.0674777,
                0.361488,
                0.0340562,
                0.152188,
                -0.074345,
                0.367103,
                0.0389534,
                0.157359,
                -0.0817442,
                0.375247,
                0.0445541,
                0.16379,
                -0.0896334,
                0.385064,
                0.0509535,
                0.171376,
                -0.098005,
                0.396082,
                0.0582611,
                0.179901,
                -0.106817,
                0.407418,
                0.06654,
                0.189892,
                -0.116239,
                0.420031,
                0.075994,
                0.201838,
                -0.12627,
                0.434321,
                0.0867239,
                0.214311,
                -0.136701,
                0.447631,
                0.0987517,
                0.228902,
                -0.147616,
                0.462046,
                0.112353,
                0.245107,
                -0.158871,
                0.476942,
                0.127605,
                0.262292,
                -0.170261,
                0.490285,
                0.144469,
                0.281215,
                -0.182017,
                0.503783,
                0.163282,
                0.301058,
                -0.193729,
                0.515505,
                0.183873,
                0.322752,
                -0.205512,
                0.52682,
                0.206466,
                0.347547,
                -0.217214,
                0.539473,
                0.231194,
                0.370969,
                -0.227966,
                0.546625,
                0.257288,
                0.397533,
                -0.238555,
                0.55472,
                0.285789,
                0.42398,
                -0.248278,
                0.559468,
                0.315746,
                0.452928,
                -0.257422,
                0.564095,
                0.347724,
                0.482121,
                -0.265306,
                0.565426,
                0.380922,
                0.510438,
                -0.272043,
                0.563205,
                0.415639,
                0.541188,
                -0.277614,
                0.561087,
                0.451702,
                0.571667,
                -0.281927,
                0.554922,
                0.48845,
                0.602432,
                -0.285015,
                0.546838,
                0.526442,
                0.634126,
                -0.286512,
                0.537415,
                0.564896,
                0.662816,
                -0.286388,
                0.522906,
                0.604037,
                0.692411,
                -0.284734,
                0.507003,
                0.643795,
                0.720946,
                -0.281297,
                0.488398,
                0.68298,
                0.748293,
                -0.276262,
                0.466353,
                0.723466,
                0.776931,
                -0.269978,
                0.443573,
                0.764565,
                0.801065,
                -0.260305,
                0.415279,
                0.805838,
                0.825843,
                -0.247426,
                0.384773,
                0.849985,
                0.84807,
                -0.232437,
                0.352555,
                0.893174,
                0.869122,
                -0.215806,
                0.318642,
                0.936564,
                0.888963,
                -0.197307,
                0.28381,
                0.980253,
                0.905547,
                -0.177203,
                0.247888,
                1.02463,
                0.918554,
                -0.155542,
                0.212904,
                1.06714,
                0.931395,
                -0.131948,
                0.1787,
                1.10451,
                0.941749,
                -0.106723,
                0.145902,
                1.13694,
                0.954551,
                -0.0804939,
                0.111193,
                1.1666,
                0.970279,
                -0.0534239,
                0.0744697,
                1.19249,
                0.986117,
                -0.0257452,
                0.0368788,
                1.21665,
                0.999938,
                0.00190634,
                -0.0010291,
                1.23981,
                0.118493,
                -0.00000647439,
                0.32272,
                0.0000023772,
                0.118765,
                -0.000163023,
                0.323456,
                0.0000598573,
                0.118772,
                -0.00065212,
                0.323477,
                0.000239447,
                0.118843,
                -0.00146741,
                0.323657,
                0.000538881,
                0.118804,
                -0.00260846,
                0.323553,
                0.00095826,
                0.118826,
                -0.00407576,
                0.323595,
                0.00149845,
                0.118846,
                -0.00586826,
                0.323617,
                0.00216047,
                0.118886,
                -0.00798578,
                0.32367,
                0.00294679,
                0.118947,
                -0.0104273,
                0.323753,
                0.00386124,
                0.119055,
                -0.0131909,
                0.323922,
                0.00490999,
                0.119241,
                -0.0162444,
                0.324251,
                0.00610804,
                0.11944,
                -0.0196339,
                0.324544,
                0.00745805,
                0.119739,
                -0.0233378,
                0.325026,
                0.00897805,
                0.12011,
                -0.0273179,
                0.325586,
                0.0106895,
                0.120571,
                -0.0316143,
                0.326231,
                0.0126073,
                0.12124,
                -0.0361939,
                0.327264,
                0.0147654,
                0.122162,
                -0.0410511,
                0.328733,
                0.0172001,
                0.123378,
                -0.0462233,
                0.330659,
                0.0199375,
                0.125183,
                -0.0517109,
                0.333754,
                0.0230498,
                0.127832,
                -0.0575652,
                0.338507,
                0.026597,
                0.130909,
                -0.0637441,
                0.343666,
                0.0306345,
                0.135221,
                -0.0704302,
                0.351063,
                0.035273,
                0.14082,
                -0.0776364,
                0.360604,
                0.0406137,
                0.146781,
                -0.0852293,
                0.369638,
                0.0466788,
                0.155121,
                -0.0935351,
                0.3827,
                0.0537628,
                0.16398,
                -0.102234,
                0.39522,
                0.0617985,
                0.173926,
                -0.111465,
                0.40793,
                0.07097,
                0.185137,
                -0.121296,
                0.42105,
                0.0813426,
                0.19826,
                -0.13169,
                0.435735,
                0.0931596,
                0.212938,
                -0.142614,
                0.450932,
                0.106547,
                0.229046,
                -0.153884,
                0.465726,
                0.121575,
                0.246246,
                -0.165382,
                0.479461,
                0.138286,
                0.264637,
                -0.176806,
                0.492106,
                0.15666,
                0.284959,
                -0.188793,
                0.504774,
                0.17728,
                0.308157,
                -0.200763,
                0.518805,
                0.19988,
                0.330951,
                -0.21239,
                0.528231,
                0.224293,
                0.3549,
                -0.223521,
                0.536376,
                0.250541,
                0.381502,
                -0.234169,
                0.544846,
                0.278902,
                0.409529,
                -0.244077,
                0.551717,
                0.309227,
                0.437523,
                -0.253363,
                0.55517,
                0.341426,
                0.467624,
                -0.261659,
                0.557772,
                0.37518,
                0.497268,
                -0.268498,
                0.556442,
                0.41007,
                0.528294,
                -0.274018,
                0.553915,
                0.446445,
                0.559053,
                -0.278169,
                0.549153,
                0.483779,
                0.589329,
                -0.281229,
                0.539878,
                0.522249,
                0.622503,
                -0.282902,
                0.53162,
                0.561754,
                0.652382,
                -0.282815,
                0.518119,
                0.601544,
                0.681847,
                -0.281247,
                0.502187,
                0.641574,
                0.712285,
                -0.277986,
                0.484824,
                0.682633,
                0.740094,
                -0.273017,
                0.463483,
                0.723426,
                0.768478,
                -0.266692,
                0.441299,
                0.763747,
                0.794556,
                -0.258358,
                0.415238,
                0.805565,
                0.819408,
                -0.248807,
                0.386912,
                0.847254,
                0.843411,
                -0.236214,
                0.356165,
                0.891091,
                0.862397,
                -0.219794,
                0.320562,
                0.936174,
                0.883113,
                -0.201768,
                0.285322,
                0.982562,
                0.90023,
                -0.181672,
                0.249713,
                1.02862,
                0.915192,
                -0.159279,
                0.214546,
                1.07163,
                0.928458,
                -0.134725,
                0.180285,
                1.10995,
                0.94069,
                -0.10913,
                0.147119,
                1.14354,
                0.953409,
                -0.0821315,
                0.112492,
                1.17372,
                0.969537,
                -0.0542677,
                0.0752014,
                1.20043,
                0.985612,
                -0.0259096,
                0.0370361,
                1.22528,
                0.999835,
                0.00298198,
                -0.00151801,
                1.24959,
                0.10097,
                -0.00000602574,
                0.300277,
                0.00000202619,
                0.101577,
                -0.000152164,
                0.302077,
                0.0000511662,
                0.101572,
                -0.000608889,
                0.302066,
                0.000204751,
                0.101566,
                -0.00136997,
                0.302047,
                0.000460753,
                0.101592,
                -0.00243557,
                0.302114,
                0.000819497,
                0.101608,
                -0.0038053,
                0.30214,
                0.00128154,
                0.101627,
                -0.00547906,
                0.30216,
                0.0018483,
                0.101669,
                -0.00745647,
                0.302224,
                0.00252223,
                0.101732,
                -0.00973615,
                0.302318,
                0.00330716,
                0.101844,
                -0.0123097,
                0.302513,
                0.00421061,
                0.102025,
                -0.0151681,
                0.30285,
                0.00524481,
                0.102224,
                -0.0183334,
                0.303166,
                0.0064154,
                0.102515,
                -0.0217819,
                0.303654,
                0.00774063,
                0.102886,
                -0.0255067,
                0.304243,
                0.0092398,
                0.103395,
                -0.029514,
                0.305089,
                0.0109339,
                0.104109,
                -0.0337912,
                0.306301,
                0.0128561,
                0.105074,
                -0.0383565,
                0.30798,
                0.0150338,
                0.10654,
                -0.0432132,
                0.310726,
                0.0175228,
                0.108478,
                -0.0484244,
                0.314351,
                0.0203648,
                0.111015,
                -0.0539339,
                0.319032,
                0.0236325,
                0.114682,
                -0.0598885,
                0.32605,
                0.0274188,
                0.11911,
                -0.0663375,
                0.334109,
                0.0317905,
                0.124736,
                -0.0733011,
                0.344013,
                0.0368502,
                0.131479,
                -0.0807744,
                0.355358,
                0.0427104,
                0.139283,
                -0.0888204,
                0.367614,
                0.0494788,
                0.148054,
                -0.0973394,
                0.380072,
                0.0572367,
                0.159037,
                -0.10665,
                0.395678,
                0.0662704,
                0.169794,
                -0.116221,
                0.40795,
                0.0763192,
                0.18314,
                -0.126632,
                0.423546,
                0.087956,
                0.197515,
                -0.137383,
                0.438213,
                0.101042,
                0.213514,
                -0.148641,
                0.453248,
                0.115827,
                0.23065,
                -0.160117,
                0.46688,
                0.132283,
                0.249148,
                -0.171807,
                0.479962,
                0.150644,
                0.270219,
                -0.183695,
                0.494618,
                0.171073,
                0.292338,
                -0.195574,
                0.506937,
                0.193378,
                0.314999,
                -0.207205,
                0.516463,
                0.217585,
                0.340991,
                -0.218955,
                0.528123,
                0.24428,
                0.367982,
                -0.229917,
                0.537025,
                0.272784,
                0.39432,
                -0.239737,
                0.541627,
                0.302742,
                0.423364,
                -0.249048,
                0.546466,
                0.335112,
                0.453751,
                -0.257329,
                0.549466,
                0.369032,
                0.48416,
                -0.264623,
                0.549503,
                0.404577,
                0.515262,
                -0.270411,
                0.547008,
                0.441337,
                0.547036,
                -0.274581,
                0.542249,
                0.479162,
                0.576614,
                -0.277266,
                0.533015,
                0.517904,
                0.611143,
                -0.279144,
                0.525512,
                0.558508,
                0.640989,
                -0.279001,
                0.51154,
                0.598995,
                0.671182,
                -0.277324,
                0.495641,
                0.639935,
                0.700848,
                -0.273908,
                0.477526,
                0.681017,
                0.729862,
                -0.269063,
                0.457955,
                0.722764,
                0.758273,
                -0.262282,
                0.434846,
                0.764349,
                0.784121,
                -0.254281,
                0.409203,
                0.806206,
                0.809798,
                -0.24505,
                0.382694,
                0.848617,
                0.834953,
                -0.233861,
                0.354034,
                0.892445,
                0.856817,
                -0.221308,
                0.321764,
                0.936263,
                0.877609,
                -0.205996,
                0.288118,
                0.982401,
                0.897489,
                -0.186702,
                0.253277,
                1.02975,
                0.913792,
                -0.164618,
                0.217963,
                1.07488,
                0.92785,
                -0.140023,
                0.183221,
                1.11487,
                0.940378,
                -0.11328,
                0.149385,
                1.14947,
                0.95273,
                -0.0853958,
                0.114152,
                1.1807,
                0.969059,
                -0.0568698,
                0.0769845,
                1.20912,
                0.985574,
                -0.0276502,
                0.0381186,
                1.23498,
                0.999943,
                0.00239052,
                -0.00126861,
                1.25987,
                0.0852715,
                -0.00000560067,
                0.279021,
                0.00000171162,
                0.0854143,
                -0.000140871,
                0.279483,
                0.0000430516,
                0.0854191,
                -0.000563385,
                0.2795,
                0.000172184,
                0.0854188,
                -0.00126753,
                0.279493,
                0.000387464,
                0.0854229,
                -0.00225337,
                0.279501,
                0.00068918,
                0.0854443,
                -0.00352086,
                0.279549,
                0.00107803,
                0.0854697,
                -0.00506962,
                0.279591,
                0.00155536,
                0.0855093,
                -0.00689873,
                0.279652,
                0.00212354,
                0.0855724,
                -0.00900821,
                0.279752,
                0.00278703,
                0.0856991,
                -0.0113799,
                0.280011,
                0.0035551,
                0.085855,
                -0.0140314,
                0.280297,
                0.00443449,
                0.0860682,
                -0.016963,
                0.280682,
                0.00543636,
                0.086344,
                -0.0201438,
                0.281159,
                0.0065788,
                0.0867426,
                -0.0235999,
                0.281886,
                0.00787977,
                0.087239,
                -0.0273069,
                0.282745,
                0.0093606,
                0.0879815,
                -0.031269,
                0.284139,
                0.011056,
                0.0891258,
                -0.035531,
                0.28647,
                0.0130065,
                0.0906909,
                -0.0400947,
                0.289708,
                0.0152495,
                0.0927624,
                -0.0449638,
                0.293904,
                0.0178454,
                0.0958376,
                -0.0502427,
                0.300471,
                0.0208915,
                0.0995827,
                -0.0559514,
                0.30806,
                0.0244247,
                0.104526,
                -0.0622152,
                0.317874,
                0.0285721,
                0.110532,
                -0.0690046,
                0.329332,
                0.0334227,
                0.117385,
                -0.0763068,
                0.341217,
                0.0390466,
                0.12522,
                -0.084184,
                0.353968,
                0.0455786,
                0.134037,
                -0.0925248,
                0.366797,
                0.0530773,
                0.144014,
                -0.101487,
                0.380209,
                0.0617424,
                0.156013,
                -0.111273,
                0.395956,
                0.071777,
                0.168872,
                -0.121431,
                0.41053,
                0.0830905,
                0.183089,
                -0.132105,
                0.425073,
                0.0959341,
                0.198763,
                -0.143286,
                0.439833,
                0.110448,
                0.216159,
                -0.154841,
                0.454507,
                0.126769,
                0.234859,
                -0.166588,
                0.468368,
                0.14495,
                0.255879,
                -0.178626,
                0.482846,
                0.165233,
                0.27677,
                -0.190218,
                0.493489,
                0.187217,
                0.301184,
                -0.202227,
                0.506549,
                0.211659,
                0.325852,
                -0.213764,
                0.5158,
                0.237922,
                0.352824,
                -0.22487,
                0.525442,
                0.26632,
                0.380882,
                -0.235246,
                0.532487,
                0.296691,
                0.410137,
                -0.244847,
                0.537703,
                0.329179,
                0.439787,
                -0.253122,
                0.540361,
                0.363135,
                0.472291,
                -0.260517,
                0.542734,
                0.399222,
                0.501856,
                -0.266519,
                0.538826,
                0.436352,
                0.534816,
                -0.270905,
                0.535152,
                0.474505,
                0.565069,
                -0.273826,
                0.525979,
                0.513988,
                0.597154,
                -0.275333,
                0.516394,
                0.554852,
                0.630473,
                -0.275314,
                0.506206,
                0.596592,
                0.660574,
                -0.273323,
                0.489769,
                0.638117,
                0.692015,
                -0.270008,
                0.472578,
                0.680457,
                0.720647,
                -0.265001,
                0.452134,
                0.723008,
                0.750528,
                -0.258311,
                0.430344,
                0.765954,
                0.777568,
                -0.250046,
                0.405624,
                0.809012,
                0.80387,
                -0.240114,
                0.378339,
                0.852425,
                0.828439,
                -0.228737,
                0.349877,
                0.895346,
                0.851472,
                -0.216632,
                0.318968,
                0.940695,
                0.873906,
                -0.202782,
                0.287489,
                0.987235,
                0.89467,
                -0.187059,
                0.254394,
                1.03348,
                0.912281,
                -0.168818,
                0.221294,
                1.07812,
                0.927358,
                -0.146494,
                0.18675,
                1.11928,
                0.940385,
                -0.120009,
                0.152322,
                1.15609,
                0.952672,
                -0.0917183,
                0.117514,
                1.18875,
                0.968496,
                -0.0620321,
                0.0797405,
                1.21821,
                0.985236,
                -0.0314945,
                0.0402383,
                1.24523,
                0.99998,
                -0.000575153,
                0.000110644,
                1.27133,
                0.0702429,
                -0.00000512222,
                0.255273,
                0.00000140947,
                0.0702981,
                -0.000128826,
                0.255469,
                0.0000354488,
                0.0703691,
                -0.000515562,
                0.255727,
                0.000141874,
                0.0703805,
                -0.00116,
                0.255754,
                0.00031929,
                0.0703961,
                -0.00206224,
                0.255813,
                0.000567999,
                0.0704102,
                -0.00322223,
                0.255839,
                0.00088871,
                0.0704298,
                -0.00463928,
                0.255863,
                0.00128272,
                0.0704759,
                -0.00631375,
                0.255953,
                0.00175283,
                0.0705434,
                -0.00824317,
                0.256079,
                0.00230342,
                0.0706693,
                -0.010412,
                0.25636,
                0.0029443,
                0.0708189,
                -0.0128439,
                0.256647,
                0.00368031,
                0.0710364,
                -0.0155177,
                0.257084,
                0.00452614,
                0.0713223,
                -0.0184374,
                0.257637,
                0.00549706,
                0.0717182,
                -0.0216002,
                0.258416,
                0.00661246,
                0.072321,
                -0.0249966,
                0.259699,
                0.00790147,
                0.0731446,
                -0.0286566,
                0.261475,
                0.0093884,
                0.0743352,
                -0.0325888,
                0.264132,
                0.0111186,
                0.0760676,
                -0.036843,
                0.26815,
                0.013145,
                0.078454,
                -0.0414292,
                0.273636,
                0.0155251,
                0.0818618,
                -0.0464634,
                0.281653,
                0.0183525,
                0.0857382,
                -0.0519478,
                0.289992,
                0.0216642,
                0.0908131,
                -0.0579836,
                0.30066,
                0.0255956,
                0.0967512,
                -0.0645124,
                0.312204,
                0.0301954,
                0.103717,
                -0.0716505,
                0.325001,
                0.0356017,
                0.111596,
                -0.0793232,
                0.338129,
                0.041896,
                0.120933,
                -0.087645,
                0.352853,
                0.0492447,
                0.130787,
                -0.096492,
                0.366192,
                0.0576749,
                0.142311,
                -0.105973,
                0.380864,
                0.0673969,
                0.155344,
                -0.116182,
                0.396575,
                0.0785899,
                0.169535,
                -0.126815,
                0.411443,
                0.0912377,
                0.185173,
                -0.138015,
                0.426256,
                0.105607,
                0.201755,
                -0.149325,
                0.439607,
                0.121551,
                0.221334,
                -0.161207,
                0.455467,
                0.139608,
                0.241461,
                -0.173162,
                0.469096,
                0.159591,
                0.26294,
                -0.18504,
                0.481014,
                0.18156,
                0.286776,
                -0.196881,
                0.493291,
                0.205781,
                0.311596,
                -0.208311,
                0.503556,
                0.231819,
                0.338667,
                -0.219671,
                0.513268,
                0.260274,
                0.366021,
                -0.230451,
                0.519414,
                0.290862,
                0.395875,
                -0.240131,
                0.526766,
                0.323196,
                0.425564,
                -0.248566,
                0.52905,
                0.357071,
                0.457094,
                -0.256195,
                0.530796,
                0.393262,
                0.488286,
                -0.262331,
                0.528703,
                0.430797,
                0.522291,
                -0.267141,
                0.52727,
                0.470231,
                0.554172,
                -0.270411,
                0.519848,
                0.510477,
                0.586427,
                -0.271986,
                0.510307,
                0.551594,
                0.619638,
                -0.27192,
                0.499158,
                0.593849,
                0.650656,
                -0.269817,
                0.483852,
                0.636314,
                0.68284,
                -0.266267,
                0.467515,
                0.679679,
                0.714356,
                -0.26113,
                0.44931,
                0.723884,
                0.742717,
                -0.254067,
                0.425789,
                0.767245,
                0.770894,
                -0.245652,
                0.401144,
                0.811819,
                0.797358,
                -0.235554,
                0.374224,
                0.856315,
                0.823377,
                -0.223896,
                0.346167,
                0.901077,
                0.847456,
                -0.210865,
                0.316056,
                0.946502,
                0.870697,
                -0.196574,
                0.284503,
                0.993711,
                0.891068,
                -0.180814,
                0.251628,
                1.04134,
                0.909267,
                -0.163314,
                0.219065,
                1.08609,
                0.925653,
                -0.143304,
                0.186446,
                1.12702,
                0.940017,
                -0.121322,
                0.153416,
                1.16371,
                0.952398,
                -0.0973872,
                0.120334,
                1.19712,
                0.967568,
                -0.0698785,
                0.08352,
                1.22791,
                0.984772,
                -0.0390031,
                0.0439209,
                1.25672,
                1.00026,
                -0.0070087,
                0.00315668,
                1.28428,
                0.0556653,
                -0.00000459654,
                0.227325,
                0.00000112556,
                0.0565238,
                -0.000116382,
                0.230826,
                0.0000284985,
                0.0565717,
                -0.000465666,
                0.231026,
                0.000114036,
                0.0565859,
                -0.00104773,
                0.231079,
                0.000256656,
                0.0565761,
                -0.00186255,
                0.231025,
                0.00045663,
                0.0565913,
                -0.00291002,
                0.231058,
                0.000714664,
                0.0566108,
                -0.00418998,
                0.231085,
                0.00103224,
                0.0566532,
                -0.00570206,
                0.231169,
                0.00141202,
                0.0567473,
                -0.00743666,
                0.231417,
                0.00186018,
                0.0568567,
                -0.00940298,
                0.231661,
                0.00238264,
                0.0569859,
                -0.0115991,
                0.231895,
                0.00298699,
                0.0572221,
                -0.0140096,
                0.232456,
                0.00368957,
                0.057519,
                -0.0166508,
                0.233096,
                0.00450303,
                0.0579534,
                -0.01951,
                0.234094,
                0.00544945,
                0.0585922,
                -0.0225991,
                0.235629,
                0.00655564,
                0.0595647,
                -0.0259416,
                0.238106,
                0.00785724,
                0.0609109,
                -0.0295661,
                0.241557,
                0.00939127,
                0.0628751,
                -0.0335126,
                0.246652,
                0.0112198,
                0.0656908,
                -0.0378604,
                0.254091,
                0.0134168,
                0.0691347,
                -0.0426543,
                0.262666,
                0.0160374,
                0.0732165,
                -0.0478967,
                0.272029,
                0.0191514,
                0.0782863,
                -0.0536716,
                0.283007,
                0.0228597,
                0.0843973,
                -0.0600683,
                0.295732,
                0.0272829,
                0.0913598,
                -0.0670095,
                0.308779,
                0.032484,
                0.0994407,
                -0.0745516,
                0.322886,
                0.0385886,
                0.108189,
                -0.082712,
                0.336408,
                0.0457133,
                0.118574,
                -0.0914927,
                0.351692,
                0.0539832,
                0.129989,
                -0.100854,
                0.366502,
                0.0635162,
                0.142722,
                -0.110837,
                0.381675,
                0.0744386,
                0.156654,
                -0.121353,
                0.3963,
                0.0868483,
                0.172151,
                -0.132414,
                0.411477,
                0.100963,
                0.188712,
                -0.143809,
                0.42508,
                0.116795,
                0.208093,
                -0.155765,
                0.441328,
                0.134715,
                0.227936,
                -0.167608,
                0.454328,
                0.154396,
                0.249495,
                -0.179579,
                0.467235,
                0.176179,
                0.27362,
                -0.191488,
                0.480248,
                0.200193,
                0.296371,
                -0.202618,
                0.487886,
                0.225775,
                0.324234,
                -0.214133,
                0.499632,
                0.25441,
                0.353049,
                -0.225212,
                0.509532,
                0.285077,
                0.381785,
                -0.234875,
                0.514265,
                0.317047,
                0.414038,
                -0.244205,
                0.521282,
                0.351874,
                0.445251,
                -0.252145,
                0.522931,
                0.388279,
                0.476819,
                -0.258433,
                0.520947,
                0.425825,
                0.509209,
                -0.263411,
                0.517669,
                0.465104,
                0.542759,
                -0.266732,
                0.512841,
                0.505741,
                0.574822,
                -0.268263,
                0.503317,
                0.547611,
                0.609324,
                -0.268489,
                0.493035,
                0.590953,
                0.641772,
                -0.266941,
                0.478816,
                0.63488,
                0.674049,
                -0.263297,
                0.462863,
                0.679072,
                0.705071,
                -0.257618,
                0.442931,
                0.723487,
                0.734709,
                -0.250625,
                0.421299,
                0.768708,
                0.763704,
                -0.24179,
                0.397085,
                0.814375,
                0.791818,
                -0.231115,
                0.370577,
                0.859907,
                0.817439,
                -0.21922,
                0.34232,
                0.906715,
                0.843202,
                -0.205658,
                0.312627,
                0.953943,
                0.866639,
                -0.190563,
                0.280933,
                1.00185,
                0.888129,
                -0.173978,
                0.248393,
                1.05105,
                0.907239,
                -0.155485,
                0.216007,
                1.09704,
                0.923893,
                -0.134782,
                0.183233,
                1.13857,
                0.938882,
                -0.11249,
                0.150376,
                1.17539,
                0.952464,
                -0.0890706,
                0.117177,
                1.20924,
                0.968529,
                -0.0646523,
                0.0813095,
                1.24055,
                0.984763,
                -0.038606,
                0.0439378,
                1.27018,
                1.00053,
                -0.01238,
                0.00598668,
                1.29873,
                0.0437928,
                -0.00000409594,
                0.204012,
                8.79224e-7,
                0.0440166,
                -0.000103395,
                0.205049,
                0.0000221946,
                0.0440529,
                -0.000413633,
                0.205225,
                0.0000887981,
                0.0440493,
                -0.000930594,
                0.2052,
                0.000199858,
                0.0439884,
                -0.00165352,
                0.204901,
                0.000355495,
                0.0440716,
                -0.0025849,
                0.205255,
                0.000556983,
                0.0440968,
                -0.00372222,
                0.205311,
                0.000805326,
                0.0441359,
                -0.00506478,
                0.205391,
                0.00110333,
                0.0442231,
                -0.00660384,
                0.205638,
                0.00145768,
                0.0443254,
                -0.00835246,
                0.205877,
                0.00187275,
                0.0444832,
                -0.0102992,
                0.20627,
                0.00235938,
                0.0447001,
                -0.0124449,
                0.206796,
                0.0029299,
                0.0450168,
                -0.0147935,
                0.207593,
                0.0036005,
                0.0454816,
                -0.017336,
                0.208819,
                0.00439246,
                0.0462446,
                -0.0201156,
                0.211036,
                0.00533864,
                0.0473694,
                -0.0231568,
                0.214388,
                0.00646984,
                0.0490191,
                -0.0264941,
                0.219357,
                0.00783856,
                0.0512776,
                -0.030184,
                0.226061,
                0.00950182,
                0.0541279,
                -0.0342661,
                0.234094,
                0.0115156,
                0.0578989,
                -0.0388539,
                0.244297,
                0.0139687,
                0.0620835,
                -0.0438735,
                0.254457,
                0.0169015,
                0.0673497,
                -0.04951,
                0.266706,
                0.0204554,
                0.0731759,
                -0.0556263,
                0.278753,
                0.0246606,
                0.0803937,
                -0.0624585,
                0.29309,
                0.0297126,
                0.0879287,
                -0.0697556,
                0.305856,
                0.0355868,
                0.0970669,
                -0.0778795,
                0.321059,
                0.0425768,
                0.106508,
                -0.0863541,
                0.333873,
                0.05056,
                0.11776,
                -0.0955935,
                0.349008,
                0.0598972,
                0.130081,
                -0.105438,
                0.363776,
                0.0706314,
                0.144454,
                -0.115899,
                0.380112,
                0.0828822,
                0.1596,
                -0.126827,
                0.394843,
                0.0967611,
                0.176097,
                -0.138161,
                0.409033,
                0.112381,
                0.194726,
                -0.149904,
                0.424257,
                0.129952,
                0.213944,
                -0.161675,
                0.436945,
                0.149333,
                0.235516,
                -0.173659,
                0.450176,
                0.170892,
                0.260564,
                -0.185963,
                0.466305,
                0.194984,
                0.285183,
                -0.197582,
                0.477328,
                0.220805,
                0.311095,
                -0.208697,
                0.486566,
                0.248694,
                0.338924,
                -0.219519,
                0.494811,
                0.279015,
                0.369757,
                -0.229766,
                0.504065,
                0.311725,
                0.3996,
                -0.238879,
                0.507909,
                0.345844,
                0.430484,
                -0.246802,
                0.509805,
                0.381749,
                0.46413,
                -0.253924,
                0.511436,
                0.420251,
                0.497077,
                -0.259319,
                0.508787,
                0.459957,
                0.530434,
                -0.263297,
                0.50394,
                0.501356,
                0.565725,
                -0.265619,
                0.49804,
                0.544252,
                0.599254,
                -0.265842,
                0.487346,
                0.587856,
                0.631251,
                -0.263978,
                0.472975,
                0.631969,
                0.663972,
                -0.26043,
                0.457135,
                0.677471,
                0.697724,
                -0.255358,
                0.439844,
                0.723744,
                0.727725,
                -0.248308,
                0.417872,
                0.770653,
                0.756417,
                -0.239181,
                0.39273,
                0.817357,
                0.785419,
                -0.22814,
                0.367839,
                0.864221,
                0.81266,
                -0.215681,
                0.339449,
                0.912701,
                0.839391,
                -0.201623,
                0.309279,
                0.962419,
                0.86366,
                -0.185624,
                0.278029,
                1.0122,
                0.885028,
                -0.16797,
                0.245294,
                1.06186,
                0.904639,
                -0.148336,
                0.212689,
                1.10934,
                0.922048,
                -0.12637,
                0.179616,
                1.15063,
                0.936952,
                -0.102928,
                0.146749,
                1.18885,
                0.951895,
                -0.0785268,
                0.112733,
                1.22352,
                0.967198,
                -0.0530153,
                0.0760056,
                1.25681,
                0.984405,
                -0.02649,
                0.0383183,
                1.28762,
                1.00021,
                0.00070019,
                -0.00020039,
                1.31656,
                0.0325964,
                -0.00000355447,
                0.176706,
                6.55682e-7,
                0.0329333,
                -0.0000899174,
                0.178527,
                0.0000165869,
                0.0329181,
                -0.000359637,
                0.178453,
                0.0000663498,
                0.0329085,
                -0.000808991,
                0.178383,
                0.000149332,
                0.0329181,
                -0.00143826,
                0.178394,
                0.000265873,
                0.0329425,
                -0.00224678,
                0.178517,
                0.000416597,
                0.0329511,
                -0.00323575,
                0.17849,
                0.000603299,
                0.033011,
                -0.00439875,
                0.178695,
                0.000829422,
                0.0330733,
                -0.00574059,
                0.178843,
                0.00109908,
                0.0331857,
                -0.00725896,
                0.179176,
                0.00141933,
                0.0333445,
                -0.00895289,
                0.179618,
                0.0017999,
                0.0335674,
                -0.0108219,
                0.180238,
                0.00225316,
                0.033939,
                -0.0128687,
                0.181417,
                0.00279765,
                0.0345239,
                -0.015114,
                0.183395,
                0.0034564,
                0.0354458,
                -0.017596,
                0.186616,
                0.00425864,
                0.0368313,
                -0.0203524,
                0.191547,
                0.00524936,
                0.0386115,
                -0.0234105,
                0.197508,
                0.00647033,
                0.0410303,
                -0.0268509,
                0.205395,
                0.00798121,
                0.0442245,
                -0.0307481,
                0.215365,
                0.0098557,
                0.0478659,
                -0.0350863,
                0.225595,
                0.0121417,
                0.0522416,
                -0.0399506,
                0.236946,
                0.0149385,
                0.0574513,
                -0.045357,
                0.249442,
                0.0183189,
                0.0631208,
                -0.0512863,
                0.261222,
                0.0223644,
                0.0701124,
                -0.0579273,
                0.275418,
                0.0272418,
                0.0777331,
                -0.0650652,
                0.288989,
                0.0329458,
                0.0862709,
                -0.0728813,
                0.302546,
                0.0396819,
                0.096103,
                -0.081363,
                0.317164,
                0.04757,
                0.106976,
                -0.0904463,
                0.331733,
                0.0567012,
                0.119175,
                -0.100105,
                0.34661,
                0.067202,
                0.132919,
                -0.110375,
                0.362249,
                0.0792588,
                0.147727,
                -0.121115,
                0.376978,
                0.0928672,
                0.163618,
                -0.132299,
                0.390681,
                0.108228,
                0.182234,
                -0.143887,
                0.406571,
                0.125502,
                0.201809,
                -0.155827,
                0.42042,
                0.144836,
                0.225041,
                -0.168357,
                0.438411,
                0.166706,
                0.247621,
                -0.18004,
                0.450368,
                0.189909,
                0.27097,
                -0.191536,
                0.460083,
                0.215251,
                0.296658,
                -0.203024,
                0.469765,
                0.243164,
                0.325892,
                -0.214056,
                0.481837,
                0.273388,
                0.35406,
                -0.224104,
                0.487474,
                0.305344,
                0.384372,
                -0.233489,
                0.492773,
                0.339741,
                0.41749,
                -0.241874,
                0.498451,
                0.376287,
                0.45013,
                -0.248834,
                0.499632,
                0.414195,
                0.481285,
                -0.254658,
                0.495233,
                0.454077,
                0.519183,
                -0.259367,
                0.496401,
                0.496352,
                0.551544,
                -0.261818,
                0.487686,
                0.538798,
                0.587349,
                -0.262964,
                0.479453,
                0.583626,
                0.621679,
                -0.262128,
                0.467709,
                0.629451,
                0.654991,
                -0.258998,
                0.452123,
                0.67566,
                0.686873,
                -0.254119,
                0.433495,
                0.723248,
                0.719801,
                -0.246946,
                0.413657,
                0.771156,
                0.750355,
                -0.237709,
                0.390366,
                0.81989,
                0.780033,
                -0.226549,
                0.364947,
                0.868601,
                0.809254,
                -0.214186,
                0.337256,
                0.920034,
                0.836576,
                -0.199639,
                0.307395,
                0.971706,
                0.861774,
                -0.183169,
                0.275431,
                1.02479,
                0.885707,
                -0.165111,
                0.243431,
                1.07837,
                0.904742,
                -0.144363,
                0.210921,
                1.12783,
                0.915604,
                -0.121305,
                0.17647,
                1.17254,
                0.930959,
                -0.0962119,
                0.143106,
                1.21012,
                0.948404,
                -0.069969,
                0.108112,
                1.24474,
                0.967012,
                -0.0427586,
                0.0708478,
                1.27718,
                0.984183,
                -0.0147043,
                0.032335,
                1.3083,
                0.999577,
                0.0142165,
                -0.00726867,
                1.3382,
                0.0229227,
                -0.00000299799,
                0.148623,
                4.62391e-7,
                0.0232194,
                -0.0000758796,
                0.15054,
                0.0000117033,
                0.0232315,
                -0.000303636,
                0.15063,
                0.0000468397,
                0.0232354,
                -0.000683189,
                0.150624,
                0.000105472,
                0.0232092,
                -0.0012136,
                0.150445,
                0.000187744,
                0.0232523,
                -0.00189765,
                0.150679,
                0.000294847,
                0.0232828,
                -0.00273247,
                0.150789,
                0.000428013,
                0.0233371,
                -0.00371287,
                0.150995,
                0.000591134,
                0.0234015,
                -0.00484794,
                0.15118,
                0.000787642,
                0.023514,
                -0.00612877,
                0.151562,
                0.00102547,
                0.023679,
                -0.00756125,
                0.152116,
                0.00131351,
                0.0239559,
                -0.00914651,
                0.153162,
                0.00166594,
                0.0244334,
                -0.010904,
                0.155133,
                0.00210182,
                0.025139,
                -0.0128615,
                0.158035,
                0.00264406,
                0.0262598,
                -0.0150628,
                0.162751,
                0.00332923,
                0.0277875,
                -0.0175532,
                0.168944,
                0.00419773,
                0.0298472,
                -0.0203981,
                0.176835,
                0.00530034,
                0.0325444,
                -0.023655,
                0.186686,
                0.00669777,
                0.0355581,
                -0.0272982,
                0.196248,
                0.00842661,
                0.0392841,
                -0.0314457,
                0.207352,
                0.0105854,
                0.0436815,
                -0.0361157,
                0.219279,
                0.0132458,
                0.0485272,
                -0.0412932,
                0.230728,
                0.0164736,
                0.0541574,
                -0.0470337,
                0.242994,
                0.0203715,
                0.0609479,
                -0.0535002,
                0.257042,
                0.0250953,
                0.0685228,
                -0.0605409,
                0.27102,
                0.0306856,
                0.0768042,
                -0.0680553,
                0.28406,
                0.037193,
                0.0864844,
                -0.0765011,
                0.299186,
                0.0449795,
                0.0969415,
                -0.0852674,
                0.3132,
                0.0538316,
                0.108478,
                -0.0947333,
                0.327138,
                0.0641149,
                0.121705,
                -0.10481,
                0.342345,
                0.0759185,
                0.136743,
                -0.115474,
                0.358472,
                0.0894116,
                0.152986,
                -0.126536,
                0.374067,
                0.104562,
                0.170397,
                -0.138061,
                0.388267,
                0.121632,
                0.191392,
                -0.150203,
                0.406467,
                0.140996,
                0.211566,
                -0.161751,
                0.418641,
                0.161696,
                0.233567,
                -0.173407,
                0.430418,
                0.184557,
                0.257769,
                -0.185397,
                0.44277,
                0.210092,
                0.28531,
                -0.197048,
                0.457191,
                0.237827,
                0.311726,
                -0.20784,
                0.464712,
                0.267253,
                0.340537,
                -0.218345,
                0.472539,
                0.299332,
                0.372921,
                -0.228306,
                0.482331,
                0.333988,
                0.402924,
                -0.236665,
                0.484378,
                0.369722,
                0.434475,
                -0.244097,
                0.484717,
                0.407836,
                0.469736,
                -0.250547,
                0.487093,
                0.448465,
                0.505045,
                -0.25511,
                0.485575,
                0.490263,
                0.540262,
                -0.258444,
                0.481225,
                0.534495,
                0.576347,
                -0.259903,
                0.473481,
                0.579451,
                0.608656,
                -0.259572,
                0.4603,
                0.625604,
                0.646679,
                -0.257908,
                0.450341,
                0.674511,
                0.679902,
                -0.253663,
                0.431561,
                0.723269,
                0.714159,
                -0.247419,
                0.412684,
                0.773263,
                0.745345,
                -0.239122,
                0.389388,
                0.824182,
                0.778248,
                -0.228837,
                0.365361,
                0.876634,
                0.807208,
                -0.216197,
                0.337667,
                0.92945,
                0.835019,
                -0.201772,
                0.307197,
                0.985261,
                0.860261,
                -0.185291,
                0.274205,
                1.04299,
                0.877601,
                -0.165809,
                0.240178,
                1.09816,
                0.898211,
                -0.143897,
                0.207571,
                1.14694,
                0.915789,
                -0.119513,
                0.174904,
                1.19008,
                0.931831,
                -0.0932919,
                0.141423,
                1.2297,
                0.949244,
                -0.0656528,
                0.105603,
                1.26553,
                0.967527,
                -0.0370262,
                0.0679551,
                1.29986,
                0.984139,
                -0.00730117,
                0.0283133,
                1.33252,
                0.999713,
                0.0234648,
                -0.0121785,
                1.36397,
                0.0152135,
                -0.00000245447,
                0.122795,
                3.04092e-7,
                0.0151652,
                -0.0000615778,
                0.122399,
                0.0000076292,
                0.0151181,
                -0.000245948,
                0.122023,
                0.0000304802,
                0.0151203,
                -0.000553394,
                0.12203,
                0.0000686634,
                0.015125,
                -0.000983841,
                0.122037,
                0.000122463,
                0.0151427,
                -0.00153774,
                0.12214,
                0.000192706,
                0.0151708,
                -0.0022103,
                0.122237,
                0.000281219,
                0.0152115,
                -0.00300741,
                0.12238,
                0.000390804,
                0.0152877,
                -0.00392494,
                0.1227,
                0.000526317,
                0.015412,
                -0.00496597,
                0.123244,
                0.00069443,
                0.0156201,
                -0.00613314,
                0.124228,
                0.00090547,
                0.0159658,
                -0.00744113,
                0.125945,
                0.0011732,
                0.0165674,
                -0.00892546,
                0.129098,
                0.00151888,
                0.017487,
                -0.010627,
                0.133865,
                0.00197007,
                0.018839,
                -0.0126043,
                0.140682,
                0.0025637,
                0.020554,
                -0.0148814,
                0.148534,
                0.00333637,
                0.0226727,
                -0.0175123,
                0.157381,
                0.00433738,
                0.0251879,
                -0.0205266,
                0.166685,
                0.00561664,
                0.0283635,
                -0.0240319,
                0.177796,
                0.00725563,
                0.0318694,
                -0.0279432,
                0.188251,
                0.00928811,
                0.0361044,
                -0.0324313,
                0.200038,
                0.011835,
                0.0406656,
                -0.0373527,
                0.210685,
                0.0149146,
                0.0463846,
                -0.0430132,
                0.224182,
                0.0187254,
                0.0525696,
                -0.0491013,
                0.23634,
                0.0232283,
                0.0598083,
                -0.0559175,
                0.250013,
                0.0286521,
                0.0679437,
                -0.0633657,
                0.263981,
                0.0350634,
                0.0771181,
                -0.0714602,
                0.278072,
                0.0425882,
                0.0881273,
                -0.0803502,
                0.29511,
                0.0514487,
                0.0996628,
                -0.0896903,
                0.309976,
                0.0615766,
                0.112702,
                -0.099644,
                0.325611,
                0.0732139,
                0.126488,
                -0.109829,
                0.339321,
                0.0862324,
                0.142625,
                -0.120859,
                0.35574,
                0.101275,
                0.15953,
                -0.131956,
                0.369845,
                0.117892,
                0.176991,
                -0.143145,
                0.38146,
                0.136205,
                0.199715,
                -0.155292,
                0.40052,
                0.157252,
                0.220787,
                -0.167066,
                0.412055,
                0.179966,
                0.243697,
                -0.178396,
                0.423133,
                0.204418,
                0.272106,
                -0.190433,
                0.439524,
                0.232141,
                0.297637,
                -0.201265,
                0.447041,
                0.261109,
                0.325273,
                -0.211834,
                0.454488,
                0.292627,
                0.357219,
                -0.221889,
                0.465004,
                0.326669,
                0.387362,
                -0.230729,
                0.468527,
                0.362426,
                0.423131,
                -0.23924,
                0.475836,
                0.401533,
                0.45543,
                -0.246067,
                0.475017,
                0.441902,
                0.493393,
                -0.251557,
                0.478017,
                0.484239,
                0.526253,
                -0.255571,
                0.4709,
                0.528586,
                0.560554,
                -0.257752,
                0.463167,
                0.574346,
                0.599306,
                -0.258076,
                0.456452,
                0.621655,
                0.634541,
                -0.256471,
                0.443725,
                0.670492,
                0.668907,
                -0.253283,
                0.428719,
                0.721943,
                0.705619,
                -0.247562,
                0.411348,
                0.772477,
                0.739034,
                -0.240626,
                0.388939,
                0.8264,
                0.771408,
                -0.231493,
                0.36425,
                0.881702,
                0.803312,
                -0.220125,
                0.337321,
                0.9385,
                0.828457,
                -0.206645,
                0.305364,
                0.997437,
                0.854819,
                -0.190664,
                0.273715,
                1.05693,
                0.878666,
                -0.171429,
                0.242218,
                1.11251,
                0.898404,
                -0.149235,
                0.209556,
                1.16398,
                0.917416,
                -0.12435,
                0.176863,
                1.21014,
                0.933133,
                -0.0972703,
                0.142775,
                1.25178,
                0.95066,
                -0.0683607,
                0.106735,
                1.29028,
                0.968589,
                -0.0378724,
                0.0681609,
                1.32703,
                0.984776,
                -0.00605712,
                0.0273966,
                1.36158,
                0.99994,
                0.0263276,
                -0.0138124,
                1.3943,
                0.00867437,
                -0.00000186005,
                0.0928979,
                1.73682e-7,
                0.00864003,
                -0.0000466389,
                0.0925237,
                0.00000435505,
                0.00864593,
                -0.000186594,
                0.0925806,
                0.0000174322,
                0.00864095,
                -0.000419639,
                0.0924903,
                0.0000392862,
                0.00863851,
                -0.000746272,
                0.0924589,
                0.0000702598,
                0.00868531,
                -0.00116456,
                0.0929,
                0.000111188,
                0.00869667,
                -0.00167711,
                0.0928529,
                0.000163867,
                0.00874332,
                -0.00228051,
                0.0930914,
                0.00023104,
                0.00882709,
                -0.00297864,
                0.0935679,
                0.00031741,
                0.00898874,
                -0.00377557,
                0.0946165,
                0.000430186,
                0.00929346,
                -0.00469247,
                0.0967406,
                0.000580383,
                0.00978271,
                -0.00575491,
                0.100084,
                0.000783529,
                0.0105746,
                -0.00701514,
                0.105447,
                0.00106304,
                0.0116949,
                -0.00851797,
                0.112494,
                0.00144685,
                0.0130419,
                -0.0102757,
                0.119876,
                0.00196439,
                0.0148375,
                -0.012381,
                0.129034,
                0.00266433,
                0.0168725,
                -0.01482,
                0.137812,
                0.00358364,
                0.0193689,
                -0.0176563,
                0.147696,
                0.00478132,
                0.0222691,
                -0.0209211,
                0.157795,
                0.00631721,
                0.0256891,
                -0.0246655,
                0.168431,
                0.00826346,
                0.0294686,
                -0.0288597,
                0.178587,
                0.0106714,
                0.0340412,
                -0.0336441,
                0.190251,
                0.0136629,
                0.0393918,
                -0.039033,
                0.202999,
                0.0173272,
                0.0453947,
                -0.0450087,
                0.215655,
                0.0217448,
                0.0521936,
                -0.0515461,
                0.228686,
                0.0269941,
                0.0600279,
                -0.058817,
                0.242838,
                0.033272,
                0.0692398,
                -0.0667228,
                0.258145,
                0.0406457,
                0.0793832,
                -0.0752401,
                0.273565,
                0.0492239,
                0.0902297,
                -0.0841851,
                0.287735,
                0.0590105,
                0.102014,
                -0.0936479,
                0.301161,
                0.0702021,
                0.116054,
                -0.103967,
                0.317438,
                0.0832001,
                0.13191,
                -0.114622,
                0.334166,
                0.0977951,
                0.148239,
                -0.125452,
                0.348192,
                0.113985,
                0.165809,
                -0.136453,
                0.361094,
                0.131928,
                0.184616,
                -0.147648,
                0.373534,
                0.151811,
                0.207491,
                -0.159607,
                0.39101,
                0.174476,
                0.230106,
                -0.171119,
                0.402504,
                0.198798,
                0.257036,
                -0.182906,
                0.418032,
                0.225796,
                0.281172,
                -0.193605,
                0.425468,
                0.254027,
                0.312034,
                -0.204771,
                0.440379,
                0.285713,
                0.340402,
                -0.214988,
                0.445406,
                0.319196,
                0.370231,
                -0.224711,
                0.44968,
                0.35537,
                0.407105,
                -0.233516,
                0.460747,
                0.393838,
                0.439037,
                -0.240801,
                0.460624,
                0.433747,
                0.47781,
                -0.24762,
                0.465957,
                0.477234,
                0.510655,
                -0.251823,
                0.460054,
                0.52044,
                0.550584,
                -0.255552,
                0.459172,
                0.567853,
                0.585872,
                -0.257036,
                0.450311,
                0.615943,
                0.620466,
                -0.257535,
                0.437763,
                0.667693,
                0.660496,
                -0.255248,
                0.426639,
                0.718988,
                0.695578,
                -0.251141,
                0.409185,
                0.772503,
                0.732176,
                -0.244718,
                0.39015,
                0.827023,
                0.760782,
                -0.236782,
                0.362594,
                0.885651,
                0.79422,
                -0.225923,
                0.33711,
                0.943756,
                0.824521,
                -0.213855,
                0.308272,
                1.00874,
                0.854964,
                -0.197723,
                0.278529,
                1.06764,
                0.878065,
                -0.179209,
                0.246208,
                1.12836,
                0.899834,
                -0.157569,
                0.21329,
                1.18318,
                0.918815,
                -0.133206,
                0.181038,
                1.23161,
                0.934934,
                -0.106545,
                0.146993,
                1.27644,
                0.952115,
                -0.0780574,
                0.111175,
                1.31842,
                0.96906,
                -0.0478279,
                0.0728553,
                1.35839,
                0.985178,
                -0.0160014,
                0.032579,
                1.39697,
                1.00039,
                0.0173126,
                -0.0095256,
                1.43312,
                0.00384146,
                -0.00000124311,
                0.0613583,
                7.78271e-8,
                0.00390023,
                -0.0000314043,
                0.0622919,
                0.00000196626,
                0.00389971,
                -0.000125622,
                0.0622632,
                0.00000787379,
                0.00389491,
                -0.000282352,
                0.0620659,
                0.00001778,
                0.00391618,
                -0.000502512,
                0.0624687,
                0.0000320918,
                0.00392662,
                -0.000784458,
                0.0625113,
                0.0000515573,
                0.00396053,
                -0.00112907,
                0.0628175,
                0.0000778668,
                0.00401911,
                -0.00153821,
                0.0633286,
                0.000113811,
                0.00414994,
                -0.0020208,
                0.0646443,
                0.00016445,
                0.00441223,
                -0.00260007,
                0.0673886,
                0.000237734,
                0.00484427,
                -0.0033097,
                0.0716528,
                0.000345929,
                0.00549109,
                -0.00418966,
                0.0774998,
                0.000505987,
                0.00636293,
                -0.00527331,
                0.0844758,
                0.000739208,
                0.00746566,
                -0.00660428,
                0.0921325,
                0.00107347,
                0.00876625,
                -0.00818826,
                0.0997067,
                0.00153691,
                0.0103125,
                -0.0100811,
                0.107433,
                0.00217153,
                0.0123309,
                -0.0123643,
                0.117088,
                0.00303427,
                0.0146274,
                -0.0150007,
                0.126438,
                0.00416018,
                0.0172295,
                -0.0180531,
                0.135672,
                0.00561513,
                0.0204248,
                -0.0215962,
                0.146244,
                0.007478,
                0.0241597,
                -0.0256234,
                0.157481,
                0.00981046,
                0.0284693,
                -0.0302209,
                0.169125,
                0.0127148,
                0.033445,
                -0.0353333,
                0.181659,
                0.0162453,
                0.0391251,
                -0.0410845,
                0.1944,
                0.0205417,
                0.0454721,
                -0.0473451,
                0.207082,
                0.0256333,
                0.0530983,
                -0.0542858,
                0.221656,
                0.0317036,
                0.0615356,
                -0.0618384,
                0.236036,
                0.0388319,
                0.0703363,
                -0.0697631,
                0.248398,
                0.046974,
                0.0810391,
                -0.0784757,
                0.263611,
                0.0565246,
                0.0920144,
                -0.0873488,
                0.275857,
                0.0671724,
                0.105584,
                -0.0973652,
                0.292555,
                0.0798105,
                0.119506,
                -0.107271,
                0.306333,
                0.0935945,
                0.134434,
                -0.117608,
                0.318888,
                0.109106,
                0.153399,
                -0.128938,
                0.337552,
                0.127074,
                0.171258,
                -0.139944,
                0.349955,
                0.14643,
                0.191059,
                -0.151288,
                0.361545,
                0.168,
                0.215069,
                -0.163018,
                0.378421,
                0.192082,
                0.237838,
                -0.174226,
                0.38879,
                0.217838,
                0.266965,
                -0.186063,
                0.405857,
                0.246931,
                0.292827,
                -0.196909,
                0.414146,
                0.277505,
                0.324352,
                -0.207473,
                0.426955,
                0.310711,
                0.354427,
                -0.217713,
                0.433429,
                0.346794,
                0.389854,
                -0.227183,
                0.443966,
                0.385237,
                0.420749,
                -0.235131,
                0.44471,
                0.424955,
                0.459597,
                -0.242786,
                0.451729,
                0.468446,
                0.495316,
                -0.248767,
                0.45072,
                0.513422,
                0.534903,
                -0.253351,
                0.450924,
                0.560618,
                0.572369,
                -0.256277,
                0.445266,
                0.609677,
                0.612383,
                -0.2576,
                0.438798,
                0.660995,
                0.644037,
                -0.256931,
                0.421693,
                0.713807,
                0.686749,
                -0.254036,
                0.4109,
                0.767616,
                0.719814,
                -0.249785,
                0.390151,
                0.82533,
                0.754719,
                -0.244283,
                0.367847,
                0.888311,
                0.792022,
                -0.235076,
                0.345013,
                0.948177,
                0.822404,
                -0.225061,
                0.316193,
                1.01661,
                0.853084,
                -0.211113,
                0.287013,
                1.08075,
                0.879871,
                -0.19449,
                0.255424,
                1.14501,
                0.901655,
                -0.174023,
                0.222879,
                1.20203,
                0.919957,
                -0.1509,
                0.18989,
                1.25698,
                0.938412,
                -0.124923,
                0.15606,
                1.30588,
                0.953471,
                -0.0968139,
                0.120512,
                1.3529,
                0.970451,
                -0.066734,
                0.0828515,
                1.3986,
                0.985522,
                -0.034734,
                0.0424458,
                1.44148,
                1.00099,
                -0.00102222,
                0.000678929,
                1.48398,
                0.000965494,
                -6.27338e-7,
                0.0306409,
                1.97672e-8,
                0.00099168,
                -0.0000158573,
                0.0314638,
                4.99803e-7,
                0.000991068,
                -0.0000634012,
                0.031363,
                0.00000200682,
                0.000974567,
                -0.00014144,
                0.03036,
                0.00000457312,
                0.000998079,
                -0.000252812,
                0.031496,
                0.00000860131,
                0.00102243,
                -0.000396506,
                0.0319955,
                0.0000148288,
                0.00107877,
                -0.000577593,
                0.0331376,
                0.0000249141,
                0.00121622,
                -0.000816816,
                0.0359396,
                0.0000423011,
                0.0014455,
                -0.00113761,
                0.0399652,
                0.0000724613,
                0.00178791,
                -0.00156959,
                0.0450556,
                0.000123929,
                0.00225668,
                -0.00214064,
                0.0508025,
                0.000208531,
                0.00285627,
                -0.00287655,
                0.0568443,
                0.000341969,
                0.0035991,
                -0.00380271,
                0.0630892,
                0.000544158,
                0.00455524,
                -0.00496264,
                0.0702204,
                0.000842423,
                0.00569143,
                -0.0063793,
                0.0773426,
                0.00126704,
                0.00716928,
                -0.00813531,
                0.0860839,
                0.00186642,
                0.00885307,
                -0.0101946,
                0.0944079,
                0.00267014,
                0.0109316,
                -0.0126386,
                0.103951,
                0.00374033,
                0.0133704,
                -0.0154876,
                0.113786,
                0.0051304,
                0.0161525,
                -0.0187317,
                0.123477,
                0.00688858,
                0.0194267,
                -0.0224652,
                0.133986,
                0.00910557,
                0.0230967,
                -0.0265976,
                0.143979,
                0.0118074,
                0.0273627,
                -0.0312848,
                0.154645,
                0.0151266,
                0.0323898,
                -0.0365949,
                0.166765,
                0.0191791,
                0.0379225,
                -0.0422914,
                0.177932,
                0.0239236,
                0.0447501,
                -0.0487469,
                0.19167,
                0.0296568,
                0.0519391,
                -0.0556398,
                0.203224,
                0.0362924,
                0.0599464,
                -0.0631646,
                0.215652,
                0.0440585,
                0.0702427,
                -0.0714308,
                0.232089,
                0.0531619,
                0.0806902,
                -0.0800605,
                0.245258,
                0.0634564,
                0.0923194,
                -0.0892815,
                0.258609,
                0.0752481,
                0.106938,
                -0.09931,
                0.276654,
                0.0888914,
                0.121238,
                -0.109575,
                0.289847,
                0.104055,
                0.138817,
                -0.120461,
                0.307566,
                0.121266,
                0.15595,
                -0.131209,
                0.320117,
                0.139944,
                0.178418,
                -0.143049,
                0.339677,
                0.161591,
                0.197875,
                -0.154074,
                0.349886,
                0.184303,
                0.224368,
                -0.166307,
                0.369352,
                0.210669,
                0.252213,
                -0.178051,
                0.386242,
                0.238895,
                0.277321,
                -0.189335,
                0.395294,
                0.269182,
                0.310332,
                -0.200683,
                0.412148,
                0.302508,
                0.338809,
                -0.210856,
                0.418266,
                0.337264,
                0.372678,
                -0.220655,
                0.428723,
                0.374881,
                0.405632,
                -0.230053,
                0.433887,
                0.415656,
                0.442293,
                -0.237993,
                0.439911,
                0.457982,
                0.477256,
                -0.244897,
                0.440175,
                0.502831,
                0.515592,
                -0.250657,
                0.441079,
                0.550277,
                0.550969,
                -0.255459,
                0.435219,
                0.601102,
                0.592883,
                -0.257696,
                0.432882,
                0.651785,
                0.629092,
                -0.259894,
                0.421054,
                0.708961,
                0.672033,
                -0.258592,
                0.41177,
                0.763806,
                0.709147,
                -0.256525,
                0.395267,
                0.824249,
                0.745367,
                -0.254677,
                0.375013,
                0.8951,
                0.784715,
                -0.247892,
                0.353906,
                0.959317,
                0.818107,
                -0.240162,
                0.327801,
                1.03153,
                0.847895,
                -0.229741,
                0.298821,
                1.10601,
                0.879603,
                -0.213084,
                0.269115,
                1.164,
                0.902605,
                -0.195242,
                0.236606,
                1.22854,
                0.922788,
                -0.174505,
                0.203442,
                1.29017,
                0.944831,
                -0.150169,
                0.169594,
                1.34157,
                0.959656,
                -0.124099,
                0.135909,
                1.3956,
                0.972399,
                -0.0960626,
                0.0990563,
                1.45128,
                0.986549,
                -0.0657097,
                0.0602348,
                1.50312,
                1.00013,
                -0.0333558,
                0.0186694,
                1.55364,
                0.00000619747,
                -1e-7,
                0.00778326,
                7.96756e-11,
                2.37499e-8,
                -9.99999e-8,
                0.0000282592,
                1.14596e-10,
                0.00000100292,
                -0.00000166369,
                0.000250354,
                6.77492e-9,
                0.00000350752,
                -0.00000637769,
                0.000357289,
                6.31655e-8,
                0.00000826445,
                -0.0000174689,
                0.000516179,
                3.1851e-7,
                0.0000242481,
                -0.0000450868,
                0.0010223,
                0.00000130577,
                0.0000455631,
                -0.000089044,
                0.00144302,
                0.00000374587,
                0.0000971222,
                -0.000178311,
                0.00241912,
                0.0000102584,
                0.000171403,
                -0.000313976,
                0.00354938,
                0.0000236481,
                0.000292747,
                -0.000520026,
                0.00513765,
                0.0000496014,
                0.000789827,
                -0.00118187,
                0.0238621,
                0.000139056,
                0.00114093,
                -0.00171827,
                0.0286691,
                0.000244093,
                0.00176119,
                -0.00249667,
                0.0368565,
                0.000420623,
                0.0022233,
                -0.00333742,
                0.0400469,
                0.00065673,
                0.00343382,
                -0.00481976,
                0.0535751,
                0.00109323,
                0.00427602,
                -0.00600755,
                0.057099,
                0.00155268,
                0.00461435,
                -0.00737637,
                0.0551084,
                0.00215031,
                0.00695698,
                -0.00971401,
                0.0715767,
                0.00316529,
                0.00867619,
                -0.0120943,
                0.0793314,
                0.00436995,
                0.0106694,
                -0.0148202,
                0.0869391,
                0.0058959,
                0.0140351,
                -0.0183501,
                0.101572,
                0.00798757,
                0.0168939,
                -0.022006,
                0.11018,
                0.0104233,
                0.020197,
                -0.0261568,
                0.119041,
                0.0134167,
                0.0254702,
                -0.0312778,
                0.135404,
                0.0173009,
                0.0298384,
                -0.0362469,
                0.1437,
                0.0215428,
                0.035159,
                -0.042237,
                0.15512,
                0.0268882,
                0.0427685,
                -0.0488711,
                0.17128,
                0.033235,
                0.0494848,
                -0.0557997,
                0.181813,
                0.0404443,
                0.0592394,
                -0.0635578,
                0.198745,
                0.0490043,
                0.0681463,
                -0.071838,
                0.210497,
                0.0588239,
                0.0804753,
                -0.0809297,
                0.228864,
                0.0702835,
                0.0942205,
                -0.0906488,
                0.247008,
                0.0834012,
                0.106777,
                -0.100216,
                0.258812,
                0.0975952,
                0.124471,
                -0.110827,
                0.278617,
                0.114162,
                0.138389,
                -0.121193,
                0.287049,
                0.131983,
                0.159543,
                -0.13253,
                0.307151,
                0.152541,
                0.176432,
                -0.143611,
                0.31564,
                0.174673,
                0.201723,
                -0.15548,
                0.33538,
                0.199842,
                0.229721,
                -0.167166,
                0.355256,
                0.227097,
                0.250206,
                -0.178238,
                0.360047,
                0.256014,
                0.282118,
                -0.189905,
                0.378761,
                0.28855,
                0.312821,
                -0.201033,
                0.39181,
                0.323348,
                0.341482,
                -0.211584,
                0.397716,
                0.360564,
                0.377368,
                -0.221314,
                0.410141,
                0.400004,
                0.418229,
                -0.230474,
                0.423485,
                0.442371,
                0.444881,
                -0.239443,
                0.418874,
                0.488796,
                0.488899,
                -0.245987,
                0.427545,
                0.535012,
                0.520317,
                -0.253948,
                0.422147,
                0.589678,
                0.568566,
                -0.256616,
                0.42719,
                0.637683,
                0.599607,
                -0.26376,
                0.415114,
                0.703363,
                0.64222,
                -0.268687,
                0.408715,
                0.771363,
                0.685698,
                -0.2694,
                0.399722,
                0.83574,
                0.732327,
                -0.266642,
                0.388651,
                0.897764,
                0.769873,
                -0.267712,
                0.369198,
                0.983312,
                0.806733,
                -0.263479,
                0.346802,
                1.06222,
                0.843466,
                -0.254575,
                0.321368,
                1.13477,
                0.873008,
                -0.242749,
                0.29211,
                1.20712,
                0.908438,
                -0.22725,
                0.262143,
                1.27465,
                0.936321,
                -0.207621,
                0.228876,
                1.33203,
                0.950353,
                -0.187932,
                0.19484,
                1.40439,
                0.96442,
                -0.165154,
                0.163178,
                1.4732,
                0.979856,
                -0.139302,
                0.127531,
                1.53574,
                0.982561,
                -0.11134,
                0.0903457,
                1.59982,
                0.996389,
                -0.0808124,
                0.0489007,
                1.6577
            ];
            var LTC_MAT_2 = [
                1,
                0,
                0,
                0,
                1,
                7.91421e-31,
                0,
                0,
                1,
                1.04392e-24,
                0,
                0,
                1,
                3.49405e-21,
                0,
                0,
                1,
                1.09923e-18,
                0,
                0,
                1,
                9.47414e-17,
                0,
                0,
                1,
                3.59627e-15,
                0,
                0,
                1,
                7.72053e-14,
                0,
                0,
                1,
                1.08799e-12,
                0,
                0,
                1,
                1.10655e-11,
                0,
                0,
                1,
                8.65818e-11,
                0,
                0,
                0.999998,
                5.45037e-10,
                0,
                0,
                0.999994,
                2.85095e-9,
                0,
                0,
                0.999989,
                1.26931e-8,
                0,
                0,
                0.999973,
                4.89938e-8,
                0,
                0,
                0.999947,
                1.66347e-7,
                0,
                0,
                0.999894,
                5.02694e-7,
                0,
                0,
                0.999798,
                0.00000136532,
                0,
                0,
                0.999617,
                0.00000335898,
                0,
                0,
                0.999234,
                0.00000752126,
                0,
                0,
                0.998258,
                0.0000152586,
                0,
                0,
                0.99504,
                0.0000266207,
                0,
                0,
                0.980816,
                0.0000236802,
                0,
                0,
                0.967553,
                0.00000207684,
                0,
                0,
                0.966877,
                0.00000403733,
                0,
                0,
                0.965752,
                0.00000741174,
                0,
                0,
                0.96382,
                0.0000127746,
                0,
                0,
                0.960306,
                0.0000202792,
                0,
                0,
                0.953619,
                0.0000280232,
                0,
                0,
                0.941103,
                0.0000278816,
                0,
                0,
                0.926619,
                0.0000160221,
                0,
                0,
                0.920983,
                0.0000235164,
                0,
                0,
                0.912293,
                0.0000311924,
                0,
                0.0158731,
                0.899277,
                0.0000348118,
                0,
                0.0476191,
                0.880884,
                0.000026041,
                0,
                0.0793651,
                0.870399,
                0.0000338726,
                0,
                0.111111,
                0.856138,
                0.0000392906,
                0,
                0.142857,
                0.837436,
                0.0000372874,
                0,
                0.174603,
                0.820973,
                0.0000392558,
                0,
                0.206349,
                0.803583,
                0.0000434658,
                0,
                0.238095,
                0.782168,
                0.000040256,
                0,
                0.269841,
                0.764107,
                0.0000448159,
                0,
                0.301587,
                0.743092,
                0.0000457627,
                0,
                0.333333,
                0.721626,
                0.0000455314,
                0,
                0.365079,
                0.700375,
                0.0000477335,
                0,
                0.396825,
                0.677334,
                0.0000461072,
                0,
                0.428571,
                0.655702,
                0.0000484393,
                0,
                0.460317,
                0.632059,
                0.0000464583,
                0,
                0.492064,
                0.610125,
                0.0000483923,
                0,
                0.52381,
                0.58653,
                0.0000464342,
                0,
                0.555556,
                0.564508,
                0.0000477033,
                0,
                0.587302,
                0.541405,
                0.0000459263,
                0,
                0.619048,
                0.519556,
                0.000046412,
                0,
                0.650794,
                0.497292,
                0.0000448913,
                0,
                0.68254,
                0.475898,
                0.0000445789,
                0,
                0.714286,
                0.454722,
                0.0000433496,
                0,
                0.746032,
                0.434042,
                0.0000423054,
                0,
                0.777778,
                0.414126,
                0.0000413737,
                0,
                0.809524,
                0.394387,
                0.0000397265,
                0,
                0.84127,
                0.375841,
                0.0000390709,
                0,
                0.873016,
                0.357219,
                0.0000369938,
                0,
                0.904762,
                0.340084,
                0.0000365618,
                0,
                0.936508,
                0.322714,
                0.0000342533,
                0,
                0.968254,
                0.306974,
                0.0000339596,
                0,
                1,
                1,
                1.01524e-18,
                0,
                0,
                1,
                1.0292e-18,
                0,
                0,
                1,
                1.30908e-18,
                0,
                0,
                1,
                4.73331e-18,
                0,
                0,
                1,
                6.25319e-17,
                0,
                0,
                1,
                1.07932e-15,
                0,
                0,
                1,
                1.63779e-14,
                0,
                0,
                1,
                2.03198e-13,
                0,
                0,
                1,
                2.04717e-12,
                0,
                0,
                0.999999,
                1.68995e-11,
                0,
                0,
                0.999998,
                1.15855e-10,
                0,
                0,
                0.999996,
                6.6947e-10,
                0,
                0,
                0.999991,
                3.30863e-9,
                0,
                0,
                0.999983,
                1.41737e-8,
                0,
                0,
                0.999968,
                5.32626e-8,
                0,
                0,
                0.99994,
                1.77431e-7,
                0,
                0,
                0.999891,
                5.28835e-7,
                0,
                0,
                0.999797,
                0.00000142169,
                0,
                0,
                0.999617,
                0.00000347057,
                0,
                0,
                0.999227,
                0.0000077231,
                0,
                0,
                0.998239,
                0.0000155753,
                0,
                0,
                0.994937,
                0.0000268495,
                0,
                0,
                0.980225,
                0.0000213742,
                0,
                0,
                0.967549,
                0.0000021631,
                0,
                0,
                0.966865,
                0.00000417989,
                0,
                0,
                0.965739,
                0.00000763341,
                0,
                0,
                0.963794,
                0.0000130892,
                0,
                0,
                0.960244,
                0.0000206456,
                0,
                0,
                0.953495,
                0.0000282016,
                0,
                0.000148105,
                0.940876,
                0.0000271581,
                0,
                0.002454,
                0.926569,
                0.0000164159,
                0,
                0.00867491,
                0.920905,
                0.0000239521,
                0,
                0.01956,
                0.912169,
                0.0000315127,
                0,
                0.035433,
                0.899095,
                0.0000346626,
                0,
                0.056294,
                0.882209,
                0.0000290223,
                0,
                0.0818191,
                0.870272,
                0.0000342992,
                0,
                0.111259,
                0.855977,
                0.0000394164,
                0,
                0.142857,
                0.837431,
                0.0000372343,
                0,
                0.174603,
                0.820826,
                0.0000396691,
                0,
                0.206349,
                0.803408,
                0.0000435395,
                0,
                0.238095,
                0.782838,
                0.0000419579,
                0,
                0.269841,
                0.763941,
                0.0000450953,
                0,
                0.301587,
                0.742904,
                0.0000455847,
                0,
                0.333333,
                0.721463,
                0.0000458833,
                0,
                0.365079,
                0.700197,
                0.0000477159,
                0,
                0.396825,
                0.677501,
                0.0000470641,
                0,
                0.428571,
                0.655527,
                0.0000484732,
                0,
                0.460317,
                0.6324,
                0.0000476834,
                0,
                0.492064,
                0.609964,
                0.0000484213,
                0,
                0.52381,
                0.586839,
                0.0000475541,
                0,
                0.555556,
                0.564353,
                0.0000476951,
                0,
                0.587302,
                0.541589,
                0.0000467611,
                0,
                0.619048,
                0.519413,
                0.0000463493,
                0,
                0.650794,
                0.497337,
                0.0000453994,
                0,
                0.68254,
                0.475797,
                0.0000445308,
                0,
                0.714286,
                0.454659,
                0.0000435787,
                0,
                0.746032,
                0.434065,
                0.0000424839,
                0,
                0.777778,
                0.414018,
                0.000041436,
                0,
                0.809524,
                0.39455,
                0.0000401902,
                0,
                0.84127,
                0.375742,
                0.0000390813,
                0,
                0.873016,
                0.357501,
                0.0000377116,
                0,
                0.904762,
                0.339996,
                0.000036535,
                0,
                0.936508,
                0.323069,
                0.0000351265,
                0,
                0.968254,
                0.306897,
                0.0000339112,
                0,
                1,
                1,
                1.0396e-15,
                0,
                0,
                1,
                1.04326e-15,
                0,
                0,
                1,
                1.10153e-15,
                0,
                0,
                1,
                1.44668e-15,
                0,
                0,
                1,
                3.4528e-15,
                0,
                0,
                1,
                1.75958e-14,
                0,
                0,
                1,
                1.2627e-13,
                0,
                0,
                1,
                9.36074e-13,
                0,
                0,
                1,
                6.45742e-12,
                0,
                0,
                0.999998,
                4.01228e-11,
                0,
                0,
                0.999997,
                2.22338e-10,
                0,
                0,
                0.999995,
                1.0967e-9,
                0,
                0,
                0.999991,
                4.82132e-9,
                0,
                0,
                0.999981,
                1.89434e-8,
                0,
                0,
                0.999967,
                6.67716e-8,
                0,
                0,
                0.999938,
                2.12066e-7,
                0,
                0,
                0.999886,
                6.0977e-7,
                0,
                0,
                0.999792,
                0.00000159504,
                0,
                0,
                0.999608,
                0.00000381191,
                0,
                0,
                0.999209,
                0.00000833727,
                0,
                0,
                0.998179,
                0.0000165288,
                0,
                0,
                0.994605,
                0.0000274387,
                0,
                0,
                0.979468,
                0.0000167316,
                0,
                0,
                0.967529,
                0.00000242877,
                0,
                0,
                0.966836,
                0.00000461696,
                0,
                0,
                0.96569,
                0.00000830977,
                0,
                0,
                0.963706,
                0.0000140427,
                0,
                0.00000244659,
                0.960063,
                0.0000217353,
                0,
                0.000760774,
                0.953113,
                0.0000286606,
                0,
                0.00367261,
                0.940192,
                0.0000247691,
                0,
                0.00940263,
                0.927731,
                0.0000195814,
                0,
                0.018333,
                0.920669,
                0.0000252531,
                0,
                0.0306825,
                0.911799,
                0.0000324277,
                0,
                0.0465556,
                0.89857,
                0.0000340982,
                0,
                0.0659521,
                0.883283,
                0.0000319622,
                0,
                0.0887677,
                0.86989,
                0.000035548,
                0,
                0.114784,
                0.855483,
                0.0000397143,
                0,
                0.143618,
                0.837987,
                0.0000391665,
                0,
                0.174606,
                0.820546,
                0.0000411306,
                0,
                0.206349,
                0.802878,
                0.0000436753,
                0,
                0.238095,
                0.783402,
                0.0000444,
                0,
                0.269841,
                0.763439,
                0.0000458726,
                0,
                0.301587,
                0.742925,
                0.0000467097,
                0,
                0.333333,
                0.721633,
                0.0000478887,
                0,
                0.365079,
                0.69985,
                0.0000481251,
                0,
                0.396825,
                0.67783,
                0.0000491811,
                0,
                0.428571,
                0.655126,
                0.0000488199,
                0,
                0.460318,
                0.632697,
                0.0000496025,
                0,
                0.492064,
                0.609613,
                0.000048829,
                0,
                0.52381,
                0.587098,
                0.0000492754,
                0,
                0.555556,
                0.564119,
                0.0000482625,
                0,
                0.587302,
                0.541813,
                0.0000482807,
                0,
                0.619048,
                0.519342,
                0.0000471552,
                0,
                0.650794,
                0.497514,
                0.0000466765,
                0,
                0.68254,
                0.475879,
                0.0000455582,
                0,
                0.714286,
                0.454789,
                0.0000446007,
                0,
                0.746032,
                0.434217,
                0.0000435382,
                0,
                0.777778,
                0.414086,
                0.0000421753,
                0,
                0.809524,
                0.394744,
                0.0000412093,
                0,
                0.84127,
                0.375782,
                0.0000396634,
                0,
                0.873016,
                0.357707,
                0.0000386419,
                0,
                0.904762,
                0.340038,
                0.0000370345,
                0,
                0.936508,
                0.323284,
                0.0000359725,
                0,
                0.968254,
                0.306954,
                0.00003436,
                0,
                1,
                1,
                5.99567e-14,
                0,
                0,
                1,
                6.00497e-14,
                0,
                0,
                1,
                6.14839e-14,
                0,
                0,
                1,
                6.86641e-14,
                0,
                0,
                1,
                9.72658e-14,
                0,
                0,
                1,
                2.21271e-13,
                0,
                0,
                1,
                8.33195e-13,
                0,
                0,
                1,
                4.03601e-12,
                0,
                0,
                0.999999,
                2.06001e-11,
                0,
                0,
                0.999998,
                1.01739e-10,
                0,
                0,
                0.999997,
                4.70132e-10,
                0,
                0,
                0.999993,
                2.00436e-9,
                0,
                0,
                0.999988,
                7.83682e-9,
                0,
                0,
                0.999979,
                2.80338e-8,
                0,
                0,
                0.999962,
                9.17033e-8,
                0,
                0,
                0.999933,
                2.74514e-7,
                0,
                0,
                0.999881,
                7.53201e-7,
                0,
                0,
                0.999783,
                0.00000189826,
                0,
                0,
                0.999594,
                0.00000440279,
                0,
                0,
                0.999178,
                0.0000093898,
                0,
                0,
                0.998073,
                0.0000181265,
                0,
                0,
                0.993993,
                0.0000280487,
                0,
                0,
                0.979982,
                0.0000149422,
                0,
                0,
                0.968145,
                0.00000378481,
                0,
                0,
                0.966786,
                0.0000053771,
                0,
                0,
                0.965611,
                0.00000947508,
                0,
                0.0000388934,
                0.963557,
                0.0000156616,
                0,
                0.0009693,
                0.959752,
                0.0000235144,
                0,
                0.00370329,
                0.952461,
                0.0000291568,
                0,
                0.00868428,
                0.940193,
                0.0000240102,
                0,
                0.0161889,
                0.929042,
                0.0000231235,
                0,
                0.0263948,
                0.920266,
                0.0000273968,
                0,
                0.0394088,
                0.911178,
                0.0000337915,
                0,
                0.0552818,
                0.897873,
                0.0000333629,
                0,
                0.0740138,
                0.884053,
                0.0000351405,
                0,
                0.0955539,
                0.869455,
                0.0000378034,
                0,
                0.119795,
                0.854655,
                0.0000399378,
                0,
                0.14656,
                0.838347,
                0.0000419108,
                0,
                0.175573,
                0.820693,
                0.0000440831,
                0,
                0.206388,
                0.802277,
                0.0000445599,
                0,
                0.238095,
                0.783634,
                0.0000472691,
                0,
                0.269841,
                0.763159,
                0.0000476984,
                0,
                0.301587,
                0.742914,
                0.0000491487,
                0,
                0.333333,
                0.721662,
                0.0000502312,
                0,
                0.365079,
                0.699668,
                0.0000502817,
                0,
                0.396825,
                0.677839,
                0.000051406,
                0,
                0.428571,
                0.655091,
                0.0000511095,
                0,
                0.460317,
                0.632665,
                0.0000516067,
                0,
                0.492064,
                0.609734,
                0.0000512255,
                0,
                0.52381,
                0.587043,
                0.0000510263,
                0,
                0.555556,
                0.564298,
                0.000050565,
                0,
                0.587302,
                0.541769,
                0.0000497951,
                0,
                0.619048,
                0.519529,
                0.0000492698,
                0,
                0.650794,
                0.497574,
                0.0000482066,
                0,
                0.68254,
                0.476028,
                0.0000473689,
                0,
                0.714286,
                0.454961,
                0.0000461941,
                0,
                0.746032,
                0.434341,
                0.0000450618,
                0,
                0.777778,
                0.414364,
                0.0000438355,
                0,
                0.809524,
                0.394832,
                0.0000424196,
                0,
                0.84127,
                0.376109,
                0.0000412563,
                0,
                0.873016,
                0.35779,
                0.0000396226,
                0,
                0.904762,
                0.340379,
                0.0000384886,
                0,
                0.936508,
                0.323385,
                0.0000368214,
                0,
                0.968254,
                0.307295,
                0.0000356636,
                0,
                1,
                1,
                1.06465e-12,
                0,
                0,
                1,
                1.06555e-12,
                0,
                0,
                1,
                1.07966e-12,
                0,
                0,
                1,
                1.14601e-12,
                0,
                0,
                1,
                1.37123e-12,
                0,
                0,
                1,
                2.1243e-12,
                0,
                0,
                0.999999,
                4.89653e-12,
                0,
                0,
                0.999999,
                1.60283e-11,
                0,
                0,
                0.999998,
                6.2269e-11,
                0,
                0,
                0.999997,
                2.51859e-10,
                0,
                0,
                0.999996,
                9.96192e-10,
                0,
                0,
                0.999992,
                3.74531e-9,
                0,
                0,
                0.999986,
                1.32022e-8,
                0,
                0,
                0.999975,
                4.33315e-8,
                0,
                0,
                0.999959,
                1.31956e-7,
                0,
                0,
                0.999927,
                3.72249e-7,
                0,
                0,
                0.999871,
                9.72461e-7,
                0,
                0,
                0.999771,
                0.00000235343,
                0,
                0,
                0.999572,
                0.0000052768,
                0,
                0,
                0.999133,
                0.0000109237,
                0,
                0,
                0.997912,
                0.0000203675,
                0,
                0,
                0.993008,
                0.0000279396,
                0,
                0,
                0.980645,
                0.0000139604,
                0,
                0,
                0.970057,
                0.00000646596,
                0,
                0,
                0.966717,
                0.0000065089,
                0,
                0.0000474145,
                0.965497,
                0.0000111863,
                0,
                0.00089544,
                0.96334,
                0.0000179857,
                0,
                0.0032647,
                0.959294,
                0.0000259045,
                0,
                0.0075144,
                0.951519,
                0.0000292327,
                0,
                0.0138734,
                0.940517,
                0.0000249769,
                0,
                0.0224952,
                0.93014,
                0.000026803,
                0,
                0.0334828,
                0.91972,
                0.0000303656,
                0,
                0.0468973,
                0.910294,
                0.0000353323,
                0,
                0.0627703,
                0.897701,
                0.0000351002,
                0,
                0.0811019,
                0.884522,
                0.0000388104,
                0,
                0.10186,
                0.869489,
                0.0000412932,
                0,
                0.124985,
                0.853983,
                0.0000415781,
                0,
                0.150372,
                0.838425,
                0.0000454066,
                0,
                0.177868,
                0.820656,
                0.0000471624,
                0,
                0.207245,
                0.801875,
                0.0000475243,
                0,
                0.238143,
                0.783521,
                0.0000505621,
                0,
                0.269841,
                0.763131,
                0.000050721,
                0,
                0.301587,
                0.74261,
                0.0000523293,
                0,
                0.333333,
                0.72148,
                0.0000528699,
                0,
                0.365079,
                0.699696,
                0.0000538677,
                0,
                0.396825,
                0.677592,
                0.0000539255,
                0,
                0.428571,
                0.65525,
                0.0000546367,
                0,
                0.460317,
                0.632452,
                0.0000541348,
                0,
                0.492064,
                0.609903,
                0.0000544976,
                0,
                0.52381,
                0.586928,
                0.0000536201,
                0,
                0.555556,
                0.564464,
                0.0000535185,
                0,
                0.587302,
                0.541801,
                0.0000524949,
                0,
                0.619048,
                0.519681,
                0.000051812,
                0,
                0.650794,
                0.497685,
                0.0000507687,
                0,
                0.68254,
                0.47622,
                0.0000496243,
                0,
                0.714286,
                0.455135,
                0.0000485714,
                0,
                0.746032,
                0.4346,
                0.0000471847,
                0,
                0.777778,
                0.414564,
                0.0000459294,
                0,
                0.809524,
                0.395165,
                0.0000444705,
                0,
                0.84127,
                0.376333,
                0.0000430772,
                0,
                0.873016,
                0.358197,
                0.0000416229,
                0,
                0.904762,
                0.34064,
                0.0000401019,
                0,
                0.936508,
                0.323816,
                0.0000386623,
                0,
                0.968254,
                0.307581,
                0.0000370933,
                0,
                1,
                1,
                9.91541e-12,
                0,
                0,
                1,
                9.92077e-12,
                0,
                0,
                1,
                1.00041e-11,
                0,
                0,
                1,
                1.0385e-11,
                0,
                0,
                1,
                1.15777e-11,
                0,
                0,
                1,
                1.50215e-11,
                0,
                0,
                0.999999,
                2.54738e-11,
                0,
                0,
                0.999999,
                5.98822e-11,
                0,
                0,
                0.999998,
                1.79597e-10,
                0,
                0,
                0.999997,
                6.02367e-10,
                0,
                0,
                0.999994,
                2.06835e-9,
                0,
                0,
                0.99999,
                6.94952e-9,
                0,
                0,
                0.999984,
                2.23363e-8,
                0,
                0,
                0.999972,
                6.78578e-8,
                0,
                0,
                0.999952,
                1.93571e-7,
                0,
                0,
                0.999919,
                5.16594e-7,
                0,
                0,
                0.99986,
                0.00000128739,
                0,
                0,
                0.999753,
                0.00000299298,
                0,
                0,
                0.999546,
                0.00000648258,
                0,
                0,
                0.999074,
                0.0000129985,
                0,
                0,
                0.997671,
                0.0000232176,
                0,
                0,
                0.991504,
                0.0000256701,
                0,
                0,
                0.981148,
                0.0000131141,
                0,
                0,
                0.971965,
                0.00000869048,
                0,
                0.0000280182,
                0.966624,
                0.00000808301,
                0,
                0.000695475,
                0.965344,
                0.0000135235,
                0,
                0.00265522,
                0.963048,
                0.0000210592,
                0,
                0.00622975,
                0.958673,
                0.0000287473,
                0,
                0.0116234,
                0.950262,
                0.0000281379,
                0,
                0.018976,
                0.940836,
                0.0000271089,
                0,
                0.0283844,
                0.930996,
                0.000030926,
                0,
                0.0399151,
                0.919848,
                0.0000348359,
                0,
                0.0536063,
                0.909136,
                0.0000366092,
                0,
                0.0694793,
                0.897554,
                0.0000384162,
                0,
                0.0875342,
                0.884691,
                0.0000430971,
                0,
                0.107749,
                0.869414,
                0.0000447803,
                0,
                0.130087,
                0.853462,
                0.0000452858,
                0,
                0.154481,
                0.838187,
                0.0000495769,
                0,
                0.180833,
                0.820381,
                0.0000502709,
                0,
                0.209005,
                0.801844,
                0.0000522713,
                0,
                0.238791,
                0.783061,
                0.0000541505,
                0,
                0.269869,
                0.763205,
                0.0000553712,
                0,
                0.301587,
                0.742362,
                0.0000564909,
                0,
                0.333333,
                0.721393,
                0.0000572646,
                0,
                0.365079,
                0.699676,
                0.0000581012,
                0,
                0.396825,
                0.677395,
                0.000058096,
                0,
                0.428571,
                0.655208,
                0.0000585766,
                0,
                0.460317,
                0.632451,
                0.0000583602,
                0,
                0.492064,
                0.609839,
                0.0000580234,
                0,
                0.52381,
                0.587093,
                0.0000577161,
                0,
                0.555556,
                0.564467,
                0.0000568447,
                0,
                0.587302,
                0.542043,
                0.0000563166,
                0,
                0.619048,
                0.519826,
                0.000055156,
                0,
                0.650794,
                0.497952,
                0.0000541682,
                0,
                0.68254,
                0.476477,
                0.0000528971,
                0,
                0.714286,
                0.455412,
                0.0000514952,
                0,
                0.746032,
                0.434926,
                0.0000502222,
                0,
                0.777778,
                0.4149,
                0.0000485779,
                0,
                0.809524,
                0.395552,
                0.0000472242,
                0,
                0.84127,
                0.376712,
                0.0000454891,
                0,
                0.873016,
                0.358622,
                0.0000440924,
                0,
                0.904762,
                0.341048,
                0.0000422984,
                0,
                0.936508,
                0.324262,
                0.0000408582,
                0,
                0.968254,
                0.308013,
                0.0000390839,
                0,
                1,
                1,
                6.13913e-11,
                0,
                0,
                1,
                6.14145e-11,
                0,
                0,
                1,
                6.17708e-11,
                0,
                0,
                1,
                6.33717e-11,
                0,
                0,
                1,
                6.81648e-11,
                0,
                0,
                1,
                8.08291e-11,
                0,
                0,
                1,
                1.14608e-10,
                0,
                0,
                0.999998,
                2.10507e-10,
                0,
                0,
                0.999997,
                4.99595e-10,
                0,
                0,
                0.999995,
                1.39897e-9,
                0,
                0,
                0.999994,
                4.19818e-9,
                0,
                0,
                0.999988,
                1.27042e-8,
                0,
                0,
                0.999979,
                3.75153e-8,
                0,
                0,
                0.999965,
                1.06206e-7,
                0,
                0,
                0.999945,
                2.85381e-7,
                0,
                0,
                0.999908,
                7.23611e-7,
                0,
                0,
                0.999846,
                0.0000017255,
                0,
                0,
                0.999733,
                0.00000386104,
                0,
                0,
                0.999511,
                0.00000808493,
                0,
                0,
                0.998993,
                0.0000156884,
                0,
                0,
                0.997326,
                0.0000265538,
                0,
                0,
                0.989706,
                0.0000206466,
                0,
                0,
                0.981713,
                0.0000130756,
                0,
                0.0000070005,
                0.973636,
                0.0000106473,
                0,
                0.000464797,
                0.966509,
                0.000010194,
                0,
                0.00201743,
                0.965149,
                0.0000165881,
                0,
                0.00497549,
                0.962669,
                0.0000249147,
                0,
                0.00953262,
                0.95786,
                0.0000317449,
                0,
                0.0158211,
                0.949334,
                0.0000281045,
                0,
                0.0239343,
                0.941041,
                0.0000303263,
                0,
                0.0339372,
                0.931575,
                0.0000356754,
                0,
                0.0458738,
                0.920102,
                0.0000397075,
                0,
                0.059772,
                0.908002,
                0.0000384886,
                0,
                0.075645,
                0.897269,
                0.000043027,
                0,
                0.0934929,
                0.884559,
                0.0000479925,
                0,
                0.113302,
                0.869161,
                0.000048246,
                0,
                0.135045,
                0.853342,
                0.0000509505,
                0,
                0.158678,
                0.837633,
                0.0000542846,
                0,
                0.184136,
                0.820252,
                0.0000554139,
                0,
                0.211325,
                0.801872,
                0.0000581412,
                0,
                0.240113,
                0.782418,
                0.0000585535,
                0,
                0.270306,
                0.7631,
                0.0000610923,
                0,
                0.301594,
                0.742183,
                0.0000613678,
                0,
                0.333333,
                0.721098,
                0.0000627275,
                0,
                0.365079,
                0.699512,
                0.0000629413,
                0,
                0.396825,
                0.677372,
                0.0000636351,
                0,
                0.428571,
                0.655059,
                0.0000633555,
                0,
                0.460317,
                0.632567,
                0.0000636513,
                0,
                0.492064,
                0.609784,
                0.0000628965,
                0,
                0.52381,
                0.587237,
                0.0000625546,
                0,
                0.555556,
                0.564525,
                0.0000615825,
                0,
                0.587302,
                0.542181,
                0.0000605048,
                0,
                0.619048,
                0.520017,
                0.0000596329,
                0,
                0.650794,
                0.498204,
                0.0000581516,
                0,
                0.68254,
                0.476742,
                0.0000569186,
                0,
                0.714286,
                0.455803,
                0.0000553833,
                0,
                0.746032,
                0.435251,
                0.0000537807,
                0,
                0.777778,
                0.415374,
                0.0000522025,
                0,
                0.809524,
                0.395921,
                0.0000503421,
                0,
                0.84127,
                0.377253,
                0.0000488211,
                0,
                0.873016,
                0.359021,
                0.0000468234,
                0,
                0.904762,
                0.341637,
                0.0000453269,
                0,
                0.936508,
                0.3247,
                0.0000433014,
                0,
                0.968254,
                0.308625,
                0.0000418007,
                0,
                1,
                1,
                2.86798e-10,
                0,
                0,
                1,
                2.86877e-10,
                0,
                0,
                1,
                2.88094e-10,
                0,
                0,
                1,
                2.93506e-10,
                0,
                0,
                1,
                3.09262e-10,
                0,
                0,
                0.999999,
                3.48593e-10,
                0,
                0,
                0.999999,
                4.44582e-10,
                0,
                0,
                0.999998,
                6.88591e-10,
                0,
                0,
                0.999996,
                1.34391e-9,
                0,
                0,
                0.999993,
                3.17438e-9,
                0,
                0,
                0.999989,
                8.35609e-9,
                0,
                0,
                0.999983,
                2.28677e-8,
                0,
                0,
                0.999974,
                6.23361e-8,
                0,
                0,
                0.999959,
                1.65225e-7,
                0,
                0,
                0.999936,
                4.19983e-7,
                0,
                0,
                0.999896,
                0.00000101546,
                0,
                0,
                0.99983,
                0.00000232376,
                0,
                0,
                0.999709,
                0.0000050156,
                0,
                0,
                0.999469,
                0.000010167,
                0,
                0,
                0.998886,
                0.0000190775,
                0,
                0,
                0.996819,
                0.0000300511,
                0,
                0,
                0.988837,
                0.0000185092,
                0,
                1.68222e-7,
                0.982178,
                0.0000134622,
                0,
                0.000259622,
                0.975017,
                0.0000125961,
                0,
                0.00142595,
                0.967101,
                0.000013507,
                0,
                0.00382273,
                0.964905,
                0.0000205003,
                0,
                0.00764164,
                0.96218,
                0.000029546,
                0,
                0.0130121,
                0.956821,
                0.0000343738,
                0,
                0.0200253,
                0.948829,
                0.0000305063,
                0,
                0.0287452,
                0.941092,
                0.0000346487,
                0,
                0.039218,
                0.931883,
                0.0000412061,
                0,
                0.0514748,
                0.920211,
                0.0000444651,
                0,
                0.0655351,
                0.907307,
                0.0000431252,
                0,
                0.0814082,
                0.89684,
                0.0000490382,
                0,
                0.0990939,
                0.884119,
                0.000053334,
                0,
                0.118583,
                0.869148,
                0.000054114,
                0,
                0.139856,
                0.853377,
                0.0000578536,
                0,
                0.162882,
                0.836753,
                0.0000592285,
                0,
                0.187615,
                0.820063,
                0.0000622787,
                0,
                0.213991,
                0.801694,
                0.0000645492,
                0,
                0.241918,
                0.782116,
                0.000065353,
                0,
                0.271267,
                0.762673,
                0.0000674344,
                0,
                0.301847,
                0.742133,
                0.0000682788,
                0,
                0.333333,
                0.720779,
                0.0000691959,
                0,
                0.365079,
                0.699386,
                0.0000696817,
                0,
                0.396826,
                0.67732,
                0.0000699583,
                0,
                0.428572,
                0.654888,
                0.0000698447,
                0,
                0.460318,
                0.632499,
                0.0000694063,
                0,
                0.492064,
                0.609825,
                0.0000691612,
                0,
                0.52381,
                0.587287,
                0.0000681576,
                0,
                0.555556,
                0.564743,
                0.0000674138,
                0,
                0.587302,
                0.542409,
                0.0000661617,
                0,
                0.619048,
                0.520282,
                0.0000647785,
                0,
                0.650794,
                0.498506,
                0.0000633836,
                0,
                0.68254,
                0.477102,
                0.0000615905,
                0,
                0.714286,
                0.456167,
                0.0000601013,
                0,
                0.746032,
                0.435728,
                0.0000581457,
                0,
                0.777778,
                0.415809,
                0.0000564215,
                0,
                0.809524,
                0.396517,
                0.0000544997,
                0,
                0.84127,
                0.377737,
                0.0000525061,
                0,
                0.873016,
                0.359698,
                0.0000506831,
                0,
                0.904762,
                0.342164,
                0.000048568,
                0,
                0.936508,
                0.325417,
                0.0000467826,
                0,
                0.968254,
                0.309186,
                0.0000446736,
                0,
                1,
                1,
                1.09018e-9,
                0,
                0,
                1,
                1.0904e-9,
                0,
                0,
                1,
                1.09393e-9,
                0,
                0,
                1,
                1.1095e-9,
                0,
                0,
                1,
                1.154e-9,
                0,
                0,
                1,
                1.26089e-9,
                0,
                0,
                0.999999,
                1.5059e-9,
                0,
                0,
                0.999997,
                2.07899e-9,
                0,
                0,
                0.999994,
                3.48164e-9,
                0,
                0,
                0.999993,
                7.05728e-9,
                0,
                0,
                0.999987,
                1.63692e-8,
                0,
                0,
                0.999981,
                4.06033e-8,
                0,
                0,
                0.999969,
                1.0245e-7,
                0,
                0,
                0.999953,
                2.55023e-7,
                0,
                0,
                0.999925,
                6.1511e-7,
                0,
                0,
                0.999881,
                0.00000142218,
                0,
                0,
                0.99981,
                0.00000313086,
                0,
                0,
                0.99968,
                0.00000653119,
                0,
                0,
                0.999418,
                0.000012832,
                0,
                0,
                0.998748,
                0.0000232497,
                0,
                0,
                0.996066,
                0.0000329522,
                0,
                0,
                0.988379,
                0.0000179613,
                0,
                0.000108799,
                0.982567,
                0.0000143715,
                0,
                0.000921302,
                0.976097,
                0.0000148096,
                0,
                0.00280738,
                0.968475,
                0.0000178905,
                0,
                0.00596622,
                0.964606,
                0.0000253921,
                0,
                0.0105284,
                0.961564,
                0.0000348623,
                0,
                0.0165848,
                0.955517,
                0.0000357612,
                0,
                0.0242,
                0.948381,
                0.0000343493,
                0,
                0.03342,
                0.941095,
                0.0000405849,
                0,
                0.0442777,
                0.931923,
                0.0000475394,
                0,
                0.0567958,
                0.91996,
                0.0000484328,
                0,
                0.0709879,
                0.907419,
                0.0000502146,
                0,
                0.086861,
                0.89618,
                0.0000561654,
                0,
                0.104415,
                0.88337,
                0.0000587612,
                0,
                0.123643,
                0.869046,
                0.0000618057,
                0,
                0.144531,
                0.853278,
                0.0000657392,
                0,
                0.167057,
                0.836091,
                0.000066303,
                0,
                0.191188,
                0.819644,
                0.0000704445,
                0,
                0.216878,
                0.801246,
                0.0000714071,
                0,
                0.244062,
                0.782031,
                0.0000740093,
                0,
                0.272649,
                0.762066,
                0.000074685,
                0,
                0.302509,
                0.741964,
                0.0000766647,
                0,
                0.333442,
                0.720554,
                0.0000766328,
                0,
                0.365079,
                0.699098,
                0.0000777857,
                0,
                0.396826,
                0.677189,
                0.0000774633,
                0,
                0.428572,
                0.65484,
                0.0000776235,
                0,
                0.460318,
                0.632496,
                0.0000770316,
                0,
                0.492064,
                0.609908,
                0.0000762669,
                0,
                0.52381,
                0.587312,
                0.0000753972,
                0,
                0.555556,
                0.564938,
                0.0000739994,
                0,
                0.587302,
                0.542577,
                0.0000728382,
                0,
                0.619048,
                0.52062,
                0.000071112,
                0,
                0.650794,
                0.498819,
                0.0000694004,
                0,
                0.68254,
                0.477555,
                0.0000675575,
                0,
                0.714286,
                0.456568,
                0.0000653449,
                0,
                0.746032,
                0.436278,
                0.0000636068,
                0,
                0.777778,
                0.41637,
                0.0000613466,
                0,
                0.809524,
                0.397144,
                0.0000594177,
                0,
                0.84127,
                0.378412,
                0.0000570987,
                0,
                0.873016,
                0.360376,
                0.0000550419,
                0,
                0.904762,
                0.342906,
                0.0000527422,
                0,
                0.936508,
                0.326136,
                0.0000506544,
                0,
                0.968254,
                0.30997,
                0.0000484307,
                0,
                1,
                1,
                3.54014e-9,
                0,
                0,
                1,
                3.54073e-9,
                0,
                0,
                1,
                3.54972e-9,
                0,
                0,
                1,
                3.58929e-9,
                0,
                0,
                1,
                3.70093e-9,
                0,
                0,
                0.999999,
                3.96194e-9,
                0,
                0,
                0.999998,
                4.53352e-9,
                0,
                0,
                0.999997,
                5.78828e-9,
                0,
                0,
                0.999994,
                8.63812e-9,
                0,
                0,
                0.999991,
                1.53622e-8,
                0,
                0,
                0.999985,
                3.16356e-8,
                0,
                0,
                0.999977,
                7.12781e-8,
                0,
                0,
                0.999964,
                1.66725e-7,
                0,
                0,
                0.999945,
                3.90501e-7,
                0,
                0,
                0.999912,
                8.95622e-7,
                0,
                0,
                0.999866,
                0.00000198428,
                0,
                0,
                0.999786,
                0.00000421038,
                0,
                0,
                0.999647,
                0.00000850239,
                0,
                0,
                0.999356,
                0.0000162059,
                0,
                0,
                0.998563,
                0.0000282652,
                0,
                0,
                0.994928,
                0.0000336309,
                0,
                0.0000244244,
                0.987999,
                0.0000178458,
                0,
                0.000523891,
                0.982893,
                0.0000159162,
                0,
                0.00194729,
                0.977044,
                0.0000178056,
                0,
                0.00451099,
                0.969972,
                0.0000230624,
                0,
                0.00835132,
                0.964237,
                0.0000313922,
                0,
                0.013561,
                0.960791,
                0.0000406145,
                0,
                0.0202056,
                0.954292,
                0.0000372796,
                0,
                0.0283321,
                0.948052,
                0.0000403199,
                0,
                0.0379739,
                0.940938,
                0.0000479537,
                0,
                0.0491551,
                0.931689,
                0.0000545292,
                0,
                0.0618918,
                0.91987,
                0.000054038,
                0,
                0.0761941,
                0.907665,
                0.0000589909,
                0,
                0.0920672,
                0.895281,
                0.0000642651,
                0,
                0.109511,
                0.882621,
                0.0000659707,
                0,
                0.12852,
                0.86873,
                0.0000709973,
                0,
                0.149085,
                0.853008,
                0.0000742221,
                0,
                0.171189,
                0.835944,
                0.0000761754,
                0,
                0.194809,
                0.818949,
                0.0000797052,
                0,
                0.21991,
                0.800951,
                0.0000812434,
                0,
                0.246447,
                0.781847,
                0.0000838075,
                0,
                0.274352,
                0.761649,
                0.000084501,
                0,
                0.303535,
                0.74152,
                0.0000860258,
                0,
                0.333857,
                0.720495,
                0.0000866233,
                0,
                0.365104,
                0.698742,
                0.0000868326,
                0,
                0.396826,
                0.677096,
                0.000087133,
                0,
                0.428572,
                0.654782,
                0.0000863497,
                0,
                0.460318,
                0.632335,
                0.0000860206,
                0,
                0.492064,
                0.610031,
                0.0000849337,
                0,
                0.52381,
                0.587457,
                0.0000838279,
                0,
                0.555556,
                0.56513,
                0.000082309,
                0,
                0.587302,
                0.542877,
                0.0000803542,
                0,
                0.619048,
                0.5209,
                0.0000786928,
                0,
                0.650794,
                0.499291,
                0.0000765171,
                0,
                0.68254,
                0.477971,
                0.0000744753,
                0,
                0.714286,
                0.457221,
                0.000072209,
                0,
                0.746032,
                0.436803,
                0.0000697448,
                0,
                0.777778,
                0.417083,
                0.0000675333,
                0,
                0.809524,
                0.397749,
                0.0000648058,
                0,
                0.84127,
                0.379177,
                0.0000625759,
                0,
                0.873016,
                0.361061,
                0.0000598584,
                0,
                0.904762,
                0.343713,
                0.0000575797,
                0,
                0.936508,
                0.326894,
                0.0000549999,
                0,
                0.968254,
                0.310816,
                0.0000527482,
                0,
                1,
                1,
                1.0153e-8,
                0,
                0,
                1,
                1.01544e-8,
                0,
                0,
                1,
                1.01751e-8,
                0,
                0,
                1,
                1.02662e-8,
                0,
                0,
                1,
                1.0521e-8,
                0,
                0,
                0.999999,
                1.11049e-8,
                0,
                0,
                0.999999,
                1.23408e-8,
                0,
                0,
                0.999996,
                1.4924e-8,
                0,
                0,
                0.999992,
                2.04471e-8,
                0,
                0,
                0.999989,
                3.26539e-8,
                0,
                0,
                0.99998,
                6.03559e-8,
                0,
                0,
                0.999971,
                1.23936e-7,
                0,
                0,
                0.999955,
                2.69058e-7,
                0,
                0,
                0.999933,
                5.93604e-7,
                0,
                0,
                0.999901,
                0.00000129633,
                0,
                0,
                0.999847,
                0.00000275621,
                0,
                0,
                0.999761,
                0.00000564494,
                0,
                0,
                0.999607,
                0.0000110485,
                0,
                0,
                0.999282,
                0.0000204388,
                0,
                0,
                0.99831,
                0.0000341084,
                0,
                2.2038e-7,
                0.993288,
                0.0000294949,
                0,
                0.000242388,
                0.987855,
                0.0000192736,
                0,
                0.0012503,
                0.983167,
                0.0000182383,
                0,
                0.0032745,
                0.977908,
                0.0000218633,
                0,
                0.00646321,
                0.971194,
                0.0000290662,
                0,
                0.0109133,
                0.963867,
                0.0000386401,
                0,
                0.0166927,
                0.95982,
                0.0000462827,
                0,
                0.0238494,
                0.953497,
                0.0000420705,
                0,
                0.0324178,
                0.947621,
                0.0000477743,
                0,
                0.0424225,
                0.940611,
                0.0000568258,
                0,
                0.0538808,
                0.931174,
                0.0000618061,
                0,
                0.0668047,
                0.919919,
                0.0000627098,
                0,
                0.0812014,
                0.907856,
                0.0000694714,
                0,
                0.0970745,
                0.894509,
                0.0000735008,
                0,
                0.114424,
                0.881954,
                0.0000763369,
                0,
                0.133246,
                0.868309,
                0.0000821896,
                0,
                0.153534,
                0.852511,
                0.000083769,
                0,
                0.175275,
                0.835821,
                0.0000881615,
                0,
                0.198453,
                0.817981,
                0.0000896368,
                0,
                0.223042,
                0.800504,
                0.0000930906,
                0,
                0.249009,
                0.78141,
                0.0000945056,
                0,
                0.276304,
                0.761427,
                0.0000963605,
                0,
                0.304862,
                0.74094,
                0.0000968088,
                0,
                0.334584,
                0.720233,
                0.0000981481,
                0,
                0.365322,
                0.698592,
                0.0000979122,
                0,
                0.396826,
                0.676763,
                0.0000981057,
                0,
                0.428571,
                0.654808,
                0.0000973956,
                0,
                0.460318,
                0.632326,
                0.0000962619,
                0,
                0.492064,
                0.610049,
                0.0000952996,
                0,
                0.52381,
                0.58763,
                0.0000933334,
                0,
                0.555556,
                0.565261,
                0.0000917573,
                0,
                0.587302,
                0.543244,
                0.0000896636,
                0,
                0.619048,
                0.521273,
                0.0000873304,
                0,
                0.650794,
                0.499818,
                0.0000852648,
                0,
                0.68254,
                0.478536,
                0.0000823961,
                0,
                0.714286,
                0.457826,
                0.000079939,
                0,
                0.746032,
                0.437549,
                0.000077126,
                0,
                0.777778,
                0.41776,
                0.0000743043,
                0,
                0.809524,
                0.39863,
                0.0000716426,
                0,
                0.84127,
                0.379954,
                0.0000686456,
                0,
                0.873016,
                0.362025,
                0.0000660514,
                0,
                0.904762,
                0.344581,
                0.0000630755,
                0,
                0.936508,
                0.327909,
                0.0000605439,
                0,
                0.968254,
                0.311736,
                0.0000576345,
                0,
                1,
                1,
                2.63344e-8,
                0,
                0,
                1,
                2.63373e-8,
                0,
                0,
                1,
                2.63815e-8,
                0,
                0,
                1,
                2.65753e-8,
                0,
                0,
                1,
                2.71132e-8,
                0,
                0,
                0.999999,
                2.83279e-8,
                0,
                0,
                0.999997,
                3.0833e-8,
                0,
                0,
                0.999995,
                3.58711e-8,
                0,
                0,
                0.999992,
                4.61266e-8,
                0,
                0,
                0.999985,
                6.7574e-8,
                0,
                0,
                0.999977,
                1.1358e-7,
                0,
                0,
                0.999966,
                2.13657e-7,
                0,
                0,
                0.999948,
                4.31151e-7,
                0,
                0,
                0.999923,
                8.96656e-7,
                0,
                0,
                0.999884,
                0.00000186603,
                0,
                0,
                0.999826,
                0.00000381115,
                0,
                0,
                0.999732,
                0.00000754184,
                0,
                0,
                0.999561,
                0.0000143192,
                0,
                0,
                0.999191,
                0.0000257061,
                0,
                0,
                0.997955,
                0.0000405724,
                0,
                0.0000744132,
                0.992228,
                0.0000276537,
                0,
                0.000716477,
                0.987638,
                0.0000208885,
                0,
                0.0022524,
                0.983395,
                0.0000215226,
                0,
                0.00484816,
                0.978614,
                0.0000270795,
                0,
                0.00860962,
                0.972389,
                0.0000365282,
                0,
                0.0136083,
                0.964392,
                0.0000474747,
                0,
                0.0198941,
                0.95861,
                0.0000509141,
                0,
                0.0275023,
                0.952806,
                0.000048963,
                0,
                0.0364584,
                0.94712,
                0.0000571119,
                0,
                0.04678,
                0.940104,
                0.0000671704,
                0,
                0.0584799,
                0.930398,
                0.0000687586,
                0,
                0.0715665,
                0.919866,
                0.0000738161,
                0,
                0.086045,
                0.907853,
                0.0000813235,
                0,
                0.101918,
                0.894078,
                0.0000834582,
                0,
                0.119186,
                0.881177,
                0.0000892093,
                0,
                0.137845,
                0.867575,
                0.0000944548,
                0,
                0.157891,
                0.852107,
                0.0000969607,
                0,
                0.179316,
                0.835502,
                0.000101456,
                0,
                0.202106,
                0.81756,
                0.000103256,
                0,
                0.226243,
                0.79984,
                0.000106954,
                0,
                0.251704,
                0.780998,
                0.000108066,
                0,
                0.278451,
                0.761132,
                0.000110111,
                0,
                0.306436,
                0.740429,
                0.000110459,
                0,
                0.335586,
                0.719836,
                0.000111219,
                0,
                0.365796,
                0.698467,
                0.00011145,
                0,
                0.3969,
                0.676446,
                0.000110393,
                0,
                0.428571,
                0.654635,
                0.000110035,
                0,
                0.460318,
                0.632411,
                0.000108548,
                0,
                0.492064,
                0.609986,
                0.000106963,
                0,
                0.52381,
                0.587872,
                0.000105238,
                0,
                0.555556,
                0.565528,
                0.000102665,
                0,
                0.587302,
                0.543563,
                0.000100543,
                0,
                0.619048,
                0.52176,
                0.0000976182,
                0,
                0.650794,
                0.500188,
                0.0000947099,
                0,
                0.68254,
                0.479204,
                0.0000919929,
                0,
                0.714286,
                0.458413,
                0.0000886139,
                0,
                0.746032,
                0.438314,
                0.0000857839,
                0,
                0.777778,
                0.418573,
                0.000082411,
                0,
                0.809524,
                0.39947,
                0.0000792211,
                0,
                0.84127,
                0.380892,
                0.0000759546,
                0,
                0.873016,
                0.362953,
                0.0000727571,
                0,
                0.904762,
                0.345601,
                0.0000695738,
                0,
                0.936508,
                0.328895,
                0.0000664907,
                0,
                0.968254,
                0.312808,
                0.0000634277,
                0,
                1,
                1,
                6.28647e-8,
                0,
                0,
                1,
                6.28705e-8,
                0,
                0,
                1,
                6.29587e-8,
                0,
                0,
                1,
                6.33441e-8,
                0,
                0,
                0.999999,
                6.44087e-8,
                0,
                0,
                0.999998,
                6.67856e-8,
                0,
                0,
                0.999997,
                7.15889e-8,
                0,
                0,
                0.999995,
                8.09577e-8,
                0,
                0,
                0.999989,
                9.92764e-8,
                0,
                0,
                0.999983,
                1.35834e-7,
                0,
                0,
                0.999974,
                2.10482e-7,
                0,
                0,
                0.999959,
                3.65215e-7,
                0,
                0,
                0.999939,
                6.86693e-7,
                0,
                0,
                0.999911,
                0.0000013472,
                0,
                0,
                0.999868,
                0.0000026731,
                0,
                0,
                0.999804,
                0.00000524756,
                0,
                0,
                0.9997,
                0.0000100403,
                0,
                0,
                0.99951,
                0.0000185019,
                0,
                0,
                0.999078,
                0.0000322036,
                0,
                0.00000620676,
                0.997428,
                0.0000470002,
                0,
                0.000341552,
                0.99162,
                0.0000287123,
                0,
                0.00143727,
                0.987479,
                0.0000234706,
                0,
                0.00349201,
                0.983582,
                0.0000260083,
                0,
                0.0066242,
                0.979186,
                0.0000337927,
                0,
                0.0109113,
                0.97325,
                0.0000454689,
                0,
                0.0164064,
                0.965221,
                0.0000573759,
                0,
                0.0231463,
                0.957262,
                0.0000544114,
                0,
                0.0311571,
                0.952211,
                0.0000587006,
                0,
                0.0404572,
                0.946631,
                0.0000692256,
                0,
                0.0510592,
                0.939391,
                0.0000787819,
                0,
                0.0629723,
                0.929795,
                0.0000792368,
                0,
                0.0762025,
                0.91965,
                0.0000875075,
                0,
                0.090753,
                0.907737,
                0.0000950903,
                0,
                0.106626,
                0.893899,
                0.0000972963,
                0,
                0.123822,
                0.880239,
                0.00010459,
                0,
                0.142337,
                0.866562,
                0.000107689,
                0,
                0.16217,
                0.85164,
                0.000113081,
                0,
                0.183314,
                0.835021,
                0.000116636,
                0,
                0.20576,
                0.817311,
                0.000120074,
                0,
                0.229496,
                0.798845,
                0.000121921,
                0,
                0.254502,
                0.780479,
                0.00012475,
                0,
                0.280753,
                0.760694,
                0.000125255,
                0,
                0.308212,
                0.740142,
                0.000126719,
                0,
                0.336825,
                0.719248,
                0.00012636,
                0,
                0.366517,
                0.698209,
                0.000126712,
                0,
                0.397167,
                0.676398,
                0.000125769,
                0,
                0.428578,
                0.654378,
                0.000124432,
                0,
                0.460318,
                0.632484,
                0.000123272,
                0,
                0.492064,
                0.610113,
                0.00012085,
                0,
                0.52381,
                0.587931,
                0.000118411,
                0,
                0.555556,
                0.565872,
                0.00011569,
                0,
                0.587302,
                0.543814,
                0.000112521,
                0,
                0.619048,
                0.522265,
                0.000109737,
                0,
                0.650794,
                0.500835,
                0.000106228,
                0,
                0.68254,
                0.479818,
                0.000102591,
                0,
                0.714286,
                0.459258,
                0.0000991288,
                0,
                0.746032,
                0.439061,
                0.0000952325,
                0,
                0.777778,
                0.419552,
                0.000091895,
                0,
                0.809524,
                0.400399,
                0.0000879051,
                0,
                0.84127,
                0.381976,
                0.0000844775,
                0,
                0.873016,
                0.364009,
                0.0000806316,
                0,
                0.904762,
                0.346761,
                0.0000771848,
                0,
                0.936508,
                0.330049,
                0.0000735429,
                0,
                0.968254,
                0.314018,
                0.0000702103,
                0,
                1,
                1,
                1.39968e-7,
                0,
                0,
                1,
                1.39979e-7,
                0,
                0,
                1,
                1.40145e-7,
                0,
                0,
                1,
                1.4087e-7,
                0,
                0,
                0.999999,
                1.42865e-7,
                0,
                0,
                0.999998,
                1.47279e-7,
                0,
                0,
                0.999997,
                1.56057e-7,
                0,
                0,
                0.999992,
                1.7276e-7,
                0,
                0,
                0.999989,
                2.04352e-7,
                0,
                0,
                0.99998,
                2.6494e-7,
                0,
                0,
                0.999969,
                3.83435e-7,
                0,
                0,
                0.999953,
                6.18641e-7,
                0,
                0,
                0.999929,
                0.00000108755,
                0,
                0,
                0.999898,
                0.00000201497,
                0,
                0,
                0.999849,
                0.00000381346,
                0,
                0,
                0.999778,
                0.00000719815,
                0,
                0,
                0.999661,
                0.0000133215,
                0,
                0,
                0.999451,
                0.0000238313,
                0,
                0,
                0.998936,
                0.0000401343,
                0,
                0.000113724,
                0.99662,
                0.0000517346,
                0,
                0.000820171,
                0.991094,
                0.0000304323,
                0,
                0.00238143,
                0.987487,
                0.0000281757,
                0,
                0.00493527,
                0.983731,
                0.0000320048,
                0,
                0.00856859,
                0.979647,
                0.0000423905,
                0,
                0.0133393,
                0.973837,
                0.0000562935,
                0,
                0.0192863,
                0.96584,
                0.0000677442,
                0,
                0.0264369,
                0.956309,
                0.0000623073,
                0,
                0.03481,
                0.951523,
                0.0000704131,
                0,
                0.0444184,
                0.946003,
                0.0000836594,
                0,
                0.0552713,
                0.938454,
                0.0000911736,
                0,
                0.0673749,
                0.929279,
                0.0000938264,
                0,
                0.0807329,
                0.919239,
                0.000103754,
                0,
                0.0953479,
                0.907293,
                0.000109928,
                0,
                0.111221,
                0.893936,
                0.000115257,
                0,
                0.128352,
                0.879674,
                0.000122265,
                0,
                0.14674,
                0.865668,
                0.000125733,
                0,
                0.166382,
                0.850998,
                0.000132305,
                0,
                0.187276,
                0.834498,
                0.000134844,
                0,
                0.209413,
                0.816903,
                0.000139276,
                0,
                0.232786,
                0.798235,
                0.000140984,
                0,
                0.257382,
                0.779724,
                0.00014378,
                0,
                0.283181,
                0.760251,
                0.000144623,
                0,
                0.310156,
                0.739808,
                0.000145228,
                0,
                0.338269,
                0.718762,
                0.00014539,
                0,
                0.367461,
                0.697815,
                0.000144432,
                0,
                0.397646,
                0.67631,
                0.000143893,
                0,
                0.428685,
                0.654278,
                0.000141846,
                0,
                0.460318,
                0.632347,
                0.00013935,
                0,
                0.492064,
                0.610296,
                0.000137138,
                0,
                0.52381,
                0.588039,
                0.000133806,
                0,
                0.555556,
                0.566218,
                0.000130755,
                0,
                0.587302,
                0.544346,
                0.000127128,
                0,
                0.619048,
                0.522701,
                0.000123002,
                0,
                0.650794,
                0.501542,
                0.000119443,
                0,
                0.68254,
                0.480508,
                0.000115055,
                0,
                0.714286,
                0.460092,
                0.000111032,
                0,
                0.746032,
                0.440021,
                0.000106635,
                0,
                0.777778,
                0.420446,
                0.000102162,
                0,
                0.809524,
                0.401512,
                0.000098184,
                0,
                0.84127,
                0.38299,
                0.0000936497,
                0,
                0.873016,
                0.365232,
                0.000089813,
                0,
                0.904762,
                0.347865,
                0.0000853073,
                0,
                0.936508,
                0.331342,
                0.0000817068,
                0,
                0.968254,
                0.315202,
                0.0000773818,
                0,
                1,
                1,
                2.9368e-7,
                0,
                0,
                1,
                2.937e-7,
                0,
                0,
                1,
                2.93998e-7,
                0,
                0,
                1,
                2.95298e-7,
                0,
                0,
                0.999999,
                2.98865e-7,
                0,
                0,
                0.999998,
                3.067e-7,
                0,
                0,
                0.999995,
                3.22082e-7,
                0,
                0,
                0.999992,
                3.50767e-7,
                0,
                0,
                0.999986,
                4.03538e-7,
                0,
                0,
                0.999976,
                5.01372e-7,
                0,
                0,
                0.999964,
                6.8562e-7,
                0,
                0,
                0.999945,
                0.0000010374,
                0,
                0,
                0.999919,
                0.00000171269,
                0,
                0,
                0.999882,
                0.00000300175,
                0,
                0,
                0.999829,
                0.00000542144,
                0,
                0,
                0.999749,
                0.00000984182,
                0,
                0,
                0.99962,
                0.0000176213,
                0,
                0,
                0.999382,
                0.0000305995,
                0,
                0.0000138418,
                0.998751,
                0.0000496686,
                0,
                0.000389844,
                0.995344,
                0.0000510733,
                0,
                0.00150343,
                0.990768,
                0.0000345829,
                0,
                0.00352451,
                0.987464,
                0.0000342841,
                0,
                0.00655379,
                0.983846,
                0.0000399072,
                0,
                0.0106554,
                0.980007,
                0.0000533219,
                0,
                0.0158723,
                0.974494,
                0.0000696992,
                0,
                0.0222333,
                0.96622,
                0.0000776754,
                0,
                0.029758,
                0.956273,
                0.0000747718,
                0,
                0.0384596,
                0.950952,
                0.0000864611,
                0,
                0.0483473,
                0.945215,
                0.000100464,
                0,
                0.0594266,
                0.937287,
                0.000103729,
                0,
                0.0717019,
                0.928649,
                0.000111665,
                0,
                0.0851752,
                0.918791,
                0.00012353,
                0,
                0.0998479,
                0.906685,
                0.000127115,
                0,
                0.115721,
                0.893706,
                0.00013628,
                0,
                0.132794,
                0.879248,
                0.000142427,
                0,
                0.151067,
                0.864685,
                0.000148091,
                0,
                0.170538,
                0.850032,
                0.000153517,
                0,
                0.191204,
                0.833853,
                0.000157322,
                0,
                0.213063,
                0.816353,
                0.000161086,
                0,
                0.236107,
                0.797834,
                0.000164111,
                0,
                0.260329,
                0.778831,
                0.000165446,
                0,
                0.285714,
                0.759756,
                0.000167492,
                0,
                0.312243,
                0.739419,
                0.000166928,
                0,
                0.339887,
                0.718491,
                0.000167,
                0,
                0.368604,
                0.697392,
                0.000165674,
                0,
                0.398329,
                0.676102,
                0.000163815,
                0,
                0.428961,
                0.654243,
                0.000162003,
                0,
                0.460331,
                0.632176,
                0.000158831,
                0,
                0.492064,
                0.610407,
                0.000155463,
                0,
                0.52381,
                0.588394,
                0.000152062,
                0,
                0.555556,
                0.56645,
                0.000147665,
                0,
                0.587302,
                0.5449,
                0.00014375,
                0,
                0.619048,
                0.523276,
                0.000138905,
                0,
                0.650794,
                0.502179,
                0.000134189,
                0,
                0.68254,
                0.481359,
                0.000129392,
                0,
                0.714286,
                0.46092,
                0.000124556,
                0,
                0.746032,
                0.441084,
                0.00011957,
                0,
                0.777778,
                0.421517,
                0.000114652,
                0,
                0.809524,
                0.402721,
                0.000109688,
                0,
                0.84127,
                0.384222,
                0.000104667,
                0,
                0.873016,
                0.366534,
                0.0000999633,
                0,
                0.904762,
                0.349205,
                0.0000950177,
                0,
                0.936508,
                0.332702,
                0.0000907301,
                0,
                0.968254,
                0.316599,
                0.0000859769,
                0,
                1,
                1,
                5.85473e-7,
                0,
                0,
                1,
                5.85507e-7,
                0,
                0,
                1,
                5.8602e-7,
                0,
                0,
                0.999999,
                5.88259e-7,
                0,
                0,
                0.999999,
                5.94381e-7,
                0,
                0,
                0.999998,
                6.07754e-7,
                0,
                0,
                0.999995,
                6.33729e-7,
                0,
                0,
                0.99999,
                6.8137e-7,
                0,
                0,
                0.999984,
                7.67003e-7,
                0,
                0,
                0.999973,
                9.21212e-7,
                0,
                0,
                0.999959,
                0.00000120218,
                0,
                0,
                0.999936,
                0.00000172024,
                0,
                0,
                0.999907,
                0.00000268088,
                0,
                0,
                0.999866,
                0.00000445512,
                0,
                0,
                0.999806,
                0.00000768481,
                0,
                0,
                0.999716,
                0.00001342,
                0,
                0,
                0.999576,
                0.0000232473,
                0,
                0,
                0.9993,
                0.0000391694,
                0,
                0.000129917,
                0.998498,
                0.0000608429,
                0,
                0.000845035,
                0.994132,
                0.0000489743,
                0,
                0.00237616,
                0.99031,
                0.0000384644,
                0,
                0.00484456,
                0.987409,
                0.0000421768,
                0,
                0.00832472,
                0.983981,
                0.0000504854,
                0,
                0.0128643,
                0.980268,
                0.0000671028,
                0,
                0.0184947,
                0.974875,
                0.0000852749,
                0,
                0.025237,
                0.966063,
                0.000085531,
                0,
                0.0331046,
                0.956779,
                0.0000900588,
                0,
                0.0421067,
                0.950259,
                0.00010577,
                0,
                0.0522487,
                0.944239,
                0.000119458,
                0,
                0.0635343,
                0.936341,
                0.000122164,
                0,
                0.0759654,
                0.928047,
                0.000134929,
                0,
                0.0895434,
                0.918065,
                0.000145544,
                0,
                0.104269,
                0.906267,
                0.000150531,
                0,
                0.120142,
                0.893419,
                0.000161652,
                0,
                0.137163,
                0.878758,
                0.00016593,
                0,
                0.15533,
                0.863699,
                0.000174014,
                0,
                0.174645,
                0.848876,
                0.000177877,
                0,
                0.195106,
                0.833032,
                0.000184049,
                0,
                0.21671,
                0.815557,
                0.000186088,
                0,
                0.239454,
                0.797323,
                0.00019054,
                0,
                0.263332,
                0.778124,
                0.000191765,
                0,
                0.288336,
                0.758929,
                0.000192535,
                0,
                0.314451,
                0.738979,
                0.000192688,
                0,
                0.341658,
                0.718213,
                0.000191522,
                0,
                0.369924,
                0.696947,
                0.000190491,
                0,
                0.399202,
                0.675807,
                0.000187913,
                0,
                0.429416,
                0.654147,
                0.000184451,
                0,
                0.460447,
                0.63229,
                0.000181442,
                0,
                0.492064,
                0.610499,
                0.000177139,
                0,
                0.523809,
                0.588747,
                0.000172596,
                0,
                0.555555,
                0.566783,
                0.000167457,
                0,
                0.587301,
                0.545359,
                0.000162518,
                0,
                0.619048,
                0.523984,
                0.000156818,
                0,
                0.650794,
                0.502917,
                0.000151884,
                0,
                0.68254,
                0.482294,
                0.000145514,
                0,
                0.714286,
                0.461945,
                0.000140199,
                0,
                0.746032,
                0.442133,
                0.000134101,
                0,
                0.777778,
                0.422705,
                0.000128374,
                0,
                0.809524,
                0.403916,
                0.000122996,
                0,
                0.84127,
                0.38554,
                0.000116808,
                0,
                0.873016,
                0.367909,
                0.000111973,
                0,
                0.904762,
                0.350651,
                0.000105938,
                0,
                0.936508,
                0.334208,
                0.000101355,
                0,
                0.968254,
                0.318123,
                0.0000957629,
                0,
                1,
                1,
                0.00000111633,
                0,
                0,
                1,
                0.00000111639,
                0,
                0,
                1,
                0.00000111725,
                0,
                0,
                1,
                0.00000112096,
                0,
                0,
                0.999999,
                0.0000011311,
                0,
                0,
                0.999997,
                0.00000115315,
                0,
                0,
                0.999995,
                0.0000011956,
                0,
                0,
                0.999989,
                0.00000127239,
                0,
                0,
                0.999981,
                0.00000140772,
                0,
                0,
                0.999969,
                0.00000164541,
                0,
                0,
                0.999952,
                0.00000206607,
                0,
                0,
                0.999928,
                0.00000281783,
                0,
                0,
                0.999895,
                0.00000416835,
                0,
                0,
                0.999848,
                0.00000658728,
                0,
                0,
                0.999781,
                0.0000108648,
                0,
                0,
                0.999682,
                0.0000182579,
                0,
                0,
                0.999523,
                0.0000306003,
                0,
                0.0000159122,
                0.999205,
                0.0000499862,
                0,
                0.000391184,
                0.998131,
                0.000073306,
                0,
                0.00147534,
                0.993334,
                0.0000513229,
                0,
                0.0034227,
                0.99016,
                0.0000467783,
                0,
                0.00632232,
                0.987321,
                0.0000523413,
                0,
                0.0102295,
                0.984099,
                0.000064267,
                0,
                0.0151794,
                0.980432,
                0.0000843042,
                0,
                0.0211947,
                0.974976,
                0.000102819,
                0,
                0.0282899,
                0.966429,
                0.0000996234,
                0,
                0.0364739,
                0.957633,
                0.000111074,
                0,
                0.0457522,
                0.949422,
                0.000128644,
                0,
                0.0561278,
                0.943045,
                0.000140076,
                0,
                0.0676023,
                0.935448,
                0.000146349,
                0,
                0.0801762,
                0.927225,
                0.000161854,
                0,
                0.0938499,
                0.917033,
                0.000169135,
                0,
                0.108623,
                0.905762,
                0.000179987,
                0,
                0.124496,
                0.892879,
                0.000189832,
                0,
                0.141469,
                0.878435,
                0.000195881,
                0,
                0.159541,
                0.863114,
                0.00020466,
                0,
                0.178713,
                0.84776,
                0.000209473,
                0,
                0.198985,
                0.832084,
                0.000214861,
                0,
                0.220355,
                0.814915,
                0.000217695,
                0,
                0.242823,
                0.796711,
                0.000220313,
                0,
                0.266385,
                0.777603,
                0.00022313,
                0,
                0.291036,
                0.757991,
                0.000222471,
                0,
                0.316767,
                0.738371,
                0.000222869,
                0,
                0.343563,
                0.717872,
                0.000221243,
                0,
                0.371402,
                0.696619,
                0.000218089,
                0,
                0.400248,
                0.675379,
                0.00021562,
                0,
                0.430047,
                0.65411,
                0.00021169,
                0,
                0.460709,
                0.63241,
                0.000206947,
                0,
                0.492079,
                0.61046,
                0.000201709,
                0,
                0.52381,
                0.58903,
                0.000196753,
                0,
                0.555556,
                0.567267,
                0.000189637,
                0,
                0.587302,
                0.545886,
                0.000184735,
                0,
                0.619048,
                0.524714,
                0.000177257,
                0,
                0.650794,
                0.503789,
                0.000171424,
                0,
                0.68254,
                0.483204,
                0.000164688,
                0,
                0.714286,
                0.462976,
                0.000157172,
                0,
                0.746032,
                0.443294,
                0.000151341,
                0,
                0.777778,
                0.423988,
                0.000143737,
                0,
                0.809524,
                0.405325,
                0.000138098,
                0,
                0.84127,
                0.386981,
                0.000130698,
                0,
                0.873016,
                0.369436,
                0.000125276,
                0,
                0.904762,
                0.35219,
                0.000118349,
                0,
                0.936508,
                0.335804,
                0.00011312,
                0,
                0.968254,
                0.319749,
                0.000106687,
                0,
                1,
                1,
                0.00000204685,
                0,
                0,
                1,
                0.00000204694,
                0,
                0,
                1,
                0.00000204831,
                0,
                0,
                0.999999,
                0.00000205428,
                0,
                0,
                0.999999,
                0.00000207056,
                0,
                0,
                0.999997,
                0.00000210581,
                0,
                0,
                0.999993,
                0.0000021732,
                0,
                0,
                0.999987,
                0.00000229365,
                0,
                0,
                0.999979,
                0.00000250243,
                0,
                0,
                0.999965,
                0.00000286127,
                0,
                0,
                0.999947,
                0.00000348028,
                0,
                0,
                0.999918,
                0.00000455588,
                0,
                0,
                0.999881,
                0.00000643303,
                0,
                0,
                0.999828,
                0.00000970064,
                0,
                0,
                0.999753,
                0.0000153233,
                0,
                0,
                0.999642,
                0.000024793,
                0,
                0,
                0.999464,
                0.0000402032,
                0,
                0.000122947,
                0.999089,
                0.0000635852,
                0,
                0.000807414,
                0.997567,
                0.0000857026,
                0,
                0.00227206,
                0.992903,
                0.0000594912,
                0,
                0.00462812,
                0.990011,
                0.0000578515,
                0,
                0.00794162,
                0.987192,
                0.000065399,
                0,
                0.0122534,
                0.98418,
                0.0000819675,
                0,
                0.0175888,
                0.980491,
                0.000105514,
                0,
                0.0239635,
                0.974779,
                0.000121532,
                0,
                0.031387,
                0.96675,
                0.000119144,
                0,
                0.0398644,
                0.958248,
                0.000136125,
                0,
                0.0493982,
                0.948884,
                0.000155408,
                0,
                0.0599896,
                0.941673,
                0.000162281,
                0,
                0.0716382,
                0.934521,
                0.000176754,
                0,
                0.0843437,
                0.926205,
                0.000192873,
                0,
                0.0981056,
                0.916089,
                0.000200038,
                0,
                0.112923,
                0.904963,
                0.000213624,
                0,
                0.128796,
                0.892089,
                0.000221834,
                0,
                0.145725,
                0.878028,
                0.000232619,
                0,
                0.163709,
                0.86249,
                0.000238632,
                0,
                0.182749,
                0.846587,
                0.000247002,
                0,
                0.202847,
                0.830988,
                0.000250702,
                0,
                0.224001,
                0.814165,
                0.000255562,
                0,
                0.246214,
                0.796135,
                0.000257505,
                0,
                0.269482,
                0.777052,
                0.000258625,
                0,
                0.293805,
                0.757201,
                0.000258398,
                0,
                0.319176,
                0.737655,
                0.000256714,
                0,
                0.345587,
                0.717477,
                0.000255187,
                0,
                0.373021,
                0.696433,
                0.000251792,
                0,
                0.401454,
                0.675084,
                0.000247223,
                0,
                0.430844,
                0.653907,
                0.000242213,
                0,
                0.461125,
                0.632561,
                0.000237397,
                0,
                0.492187,
                0.610658,
                0.000229313,
                0,
                0.52381,
                0.589322,
                0.000224402,
                0,
                0.555556,
                0.567857,
                0.000216116,
                0,
                0.587302,
                0.54652,
                0.000209124,
                0,
                0.619048,
                0.525433,
                0.000201601,
                0,
                0.650794,
                0.504679,
                0.000192957,
                0,
                0.68254,
                0.484203,
                0.000186052,
                0,
                0.714286,
                0.464203,
                0.000177672,
                0,
                0.746032,
                0.444549,
                0.000170005,
                0,
                0.777778,
                0.425346,
                0.000162401,
                0,
                0.809524,
                0.406706,
                0.0001544,
                0,
                0.84127,
                0.388576,
                0.000147437,
                0,
                0.873016,
                0.37094,
                0.000139493,
                0,
                0.904762,
                0.353996,
                0.000133219,
                0,
                0.936508,
                0.337391,
                0.000125573,
                0,
                0.968254,
                0.321648,
                0.000119867,
                0,
                1,
                1,
                0.00000362511,
                0,
                0,
                1,
                0.00000362525,
                0,
                0,
                1,
                0.00000362739,
                0,
                0,
                0.999999,
                0.00000363673,
                0,
                0,
                0.999998,
                0.00000366214,
                0,
                0,
                0.999996,
                0.00000371698,
                0,
                0,
                0.999992,
                0.00000382116,
                0,
                0,
                0.999986,
                0.00000400554,
                0,
                0,
                0.999976,
                0.00000432058,
                0,
                0,
                0.999961,
                0.00000485194,
                0,
                0,
                0.999938,
                0.00000574808,
                0,
                0,
                0.999908,
                0.00000726643,
                0,
                0,
                0.999865,
                0.00000984707,
                0,
                0,
                0.999807,
                0.0000142217,
                0,
                0,
                0.999723,
                0.0000215581,
                0,
                0,
                0.999602,
                0.0000336114,
                0,
                0.0000119113,
                0.999398,
                0.0000527353,
                0,
                0.000355813,
                0.998946,
                0.0000805809,
                0,
                0.00137768,
                0.996647,
                0.0000942908,
                0,
                0.00322469,
                0.992298,
                0.0000668733,
                0,
                0.00597897,
                0.989802,
                0.0000716564,
                0,
                0.00968903,
                0.987019,
                0.0000821355,
                0,
                0.0143845,
                0.984219,
                0.000104555,
                0,
                0.0200831,
                0.980425,
                0.000131245,
                0,
                0.0267948,
                0.974241,
                0.000139613,
                0,
                0.034525,
                0.967006,
                0.000145931,
                0,
                0.0432757,
                0.95893,
                0.000167153,
                0,
                0.0530471,
                0.949157,
                0.000188146,
                0,
                0.0638386,
                0.94062,
                0.000194625,
                0,
                0.0756487,
                0.933509,
                0.000213721,
                0,
                0.0884762,
                0.925088,
                0.000229616,
                0,
                0.10232,
                0.915178,
                0.000239638,
                0,
                0.117178,
                0.904093,
                0.000254814,
                0,
                0.133051,
                0.891337,
                0.000263685,
                0,
                0.149939,
                0.877326,
                0.000274789,
                0,
                0.167841,
                0.861794,
                0.000280534,
                0,
                0.18676,
                0.845758,
                0.000289534,
                0,
                0.206696,
                0.829792,
                0.000294446,
                0,
                0.22765,
                0.813037,
                0.000296877,
                0,
                0.249625,
                0.795285,
                0.000300217,
                0,
                0.27262,
                0.776323,
                0.000299826,
                0,
                0.296636,
                0.756673,
                0.000299787,
                0,
                0.321671,
                0.736856,
                0.000297867,
                0,
                0.347718,
                0.716883,
                0.000294052,
                0,
                0.374768,
                0.696089,
                0.000289462,
                0,
                0.402804,
                0.67505,
                0.000285212,
                0,
                0.431796,
                0.653509,
                0.00027653,
                0,
                0.461695,
                0.63258,
                0.000271759,
                0,
                0.49242,
                0.61104,
                0.000262811,
                0,
                0.523822,
                0.589567,
                0.000255151,
                0,
                0.555556,
                0.568322,
                0.000246434,
                0,
                0.587302,
                0.547235,
                0.000237061,
                0,
                0.619048,
                0.52616,
                0.000228343,
                0,
                0.650794,
                0.505716,
                0.000219236,
                0,
                0.68254,
                0.485274,
                0.000209595,
                0,
                0.714286,
                0.465411,
                0.000201011,
                0,
                0.746032,
                0.445854,
                0.00019109,
                0,
                0.777778,
                0.426911,
                0.000182897,
                0,
                0.809524,
                0.408222,
                0.000173569,
                0,
                0.84127,
                0.390307,
                0.000165496,
                0,
                0.873016,
                0.372624,
                0.000156799,
                0,
                0.904762,
                0.355804,
                0.00014917,
                0,
                0.936508,
                0.33924,
                0.000140907,
                0,
                0.968254,
                0.323534,
                0.000134062,
                0,
                1,
                1,
                0.00000622487,
                0,
                0,
                1,
                0.0000062251,
                0,
                0,
                1,
                0.00000622837,
                0,
                0,
                0.999999,
                0.00000624259,
                0,
                0,
                0.999998,
                0.00000628127,
                0,
                0,
                0.999996,
                0.00000636451,
                0,
                0,
                0.999991,
                0.0000065218,
                0,
                0,
                0.999984,
                0.00000679782,
                0,
                0,
                0.999973,
                0.00000726361,
                0,
                0,
                0.999955,
                0.00000803644,
                0,
                0,
                0.999931,
                0.00000931397,
                0,
                0,
                0.999896,
                0.0000114299,
                0,
                0,
                0.999847,
                0.0000149402,
                0,
                0,
                0.999784,
                0.0000207461,
                0,
                0,
                0.999692,
                0.0000302493,
                0,
                0,
                0.999554,
                0.0000454957,
                0,
                0.0000997275,
                0.999326,
                0.0000690762,
                0,
                0.000724813,
                0.998757,
                0.000101605,
                0,
                0.0020972,
                0.995367,
                0.0000958745,
                0,
                0.00432324,
                0.99209,
                0.0000832808,
                0,
                0.00746347,
                0.989517,
                0.0000887601,
                0,
                0.0115534,
                0.987008,
                0.00010564,
                0,
                0.0166134,
                0.98421,
                0.000133179,
                0,
                0.0226552,
                0.98021,
                0.000161746,
                0,
                0.0296838,
                0.973676,
                0.000161821,
                0,
                0.0377016,
                0.967052,
                0.000178635,
                0,
                0.0467079,
                0.959385,
                0.000206765,
                0,
                0.0567013,
                0.949461,
                0.00022476,
                0,
                0.0676796,
                0.939578,
                0.00023574,
                0,
                0.0796403,
                0.932416,
                0.00025893,
                0,
                0.0925812,
                0.923759,
                0.000271228,
                0,
                0.106501,
                0.914223,
                0.000289165,
                0,
                0.121397,
                0.902942,
                0.000301156,
                0,
                0.13727,
                0.890419,
                0.000313852,
                0,
                0.15412,
                0.876639,
                0.000324408,
                0,
                0.171946,
                0.861316,
                0.00033249,
                0,
                0.190751,
                0.84496,
                0.000338497,
                0,
                0.210537,
                0.828427,
                0.000345861,
                0,
                0.231305,
                0.811871,
                0.000347863,
                0,
                0.253057,
                0.794397,
                0.000350225,
                0,
                0.275797,
                0.775726,
                0.000349915,
                0,
                0.299525,
                0.75617,
                0.000347297,
                0,
                0.324242,
                0.736091,
                0.000344232,
                0,
                0.349947,
                0.716213,
                0.000340835,
                0,
                0.376633,
                0.695736,
                0.000332369,
                0,
                0.404289,
                0.674961,
                0.000327943,
                0,
                0.432895,
                0.653518,
                0.000318533,
                0,
                0.462415,
                0.632574,
                0.000310391,
                0,
                0.492788,
                0.61134,
                0.000300755,
                0,
                0.523909,
                0.590017,
                0.000290506,
                0,
                0.555556,
                0.568752,
                0.000280446,
                0,
                0.587302,
                0.548061,
                0.000269902,
                0,
                0.619048,
                0.52711,
                0.000258815,
                0,
                0.650794,
                0.506682,
                0.000248481,
                0,
                0.68254,
                0.486524,
                0.000237141,
                0,
                0.714286,
                0.466812,
                0.000226872,
                0,
                0.746032,
                0.44732,
                0.000216037,
                0,
                0.777778,
                0.428473,
                0.000205629,
                0,
                0.809524,
                0.409921,
                0.000195691,
                0,
                0.84127,
                0.392028,
                0.000185457,
                0,
                0.873016,
                0.374606,
                0.000176436,
                0,
                0.904762,
                0.357601,
                0.000166508,
                0,
                0.936508,
                0.341348,
                0.000158385,
                0,
                0.968254,
                0.32542,
                0.000149203,
                0,
                1,
                1,
                0.0000103967,
                0,
                0,
                1,
                0.000010397,
                0,
                0,
                1,
                0.0000104019,
                0,
                0,
                0.999999,
                0.0000104231,
                0,
                0,
                0.999998,
                0.0000104806,
                0,
                0,
                0.999995,
                0.0000106042,
                0,
                0,
                0.999991,
                0.0000108366,
                0,
                0,
                0.999982,
                0.0000112415,
                0,
                0,
                0.999968,
                0.0000119174,
                0,
                0,
                0.99995,
                0.0000130227,
                0,
                0,
                0.999922,
                0.0000148176,
                0,
                0,
                0.999884,
                0.0000177303,
                0,
                0,
                0.99983,
                0.0000224564,
                0,
                0,
                0.999758,
                0.0000300966,
                0,
                0,
                0.999654,
                0.0000423193,
                0,
                0.00000549083,
                0.999503,
                0.0000614848,
                0,
                0.000296087,
                0.999237,
                0.0000903576,
                0,
                0.00123144,
                0.998491,
                0.0001271,
                0,
                0.00295954,
                0.994594,
                0.000107754,
                0,
                0.00555829,
                0.99178,
                0.000103025,
                0,
                0.00907209,
                0.989265,
                0.00011154,
                0,
                0.0135257,
                0.986998,
                0.000136296,
                0,
                0.0189327,
                0.984137,
                0.000169154,
                0,
                0.0252993,
                0.979798,
                0.000196671,
                0,
                0.0326272,
                0.97337,
                0.000196678,
                0,
                0.0409157,
                0.967239,
                0.000223121,
                0,
                0.0501623,
                0.959543,
                0.000253809,
                0,
                0.0603638,
                0.949466,
                0.000265972,
                0,
                0.0715171,
                0.939074,
                0.000288372,
                0,
                0.0836187,
                0.931118,
                0.000310983,
                0,
                0.0966657,
                0.922525,
                0.000325561,
                0,
                0.110656,
                0.912983,
                0.000345725,
                0,
                0.125588,
                0.901617,
                0.0003556,
                0,
                0.141461,
                0.889487,
                0.000374012,
                0,
                0.158275,
                0.875787,
                0.000383445,
                0,
                0.176031,
                0.860654,
                0.000393972,
                0,
                0.19473,
                0.844417,
                0.000400311,
                0,
                0.214374,
                0.82741,
                0.000405004,
                0,
                0.234967,
                0.810545,
                0.000407378,
                0,
                0.256512,
                0.793312,
                0.000407351,
                0,
                0.279011,
                0.774847,
                0.000406563,
                0,
                0.302468,
                0.755621,
                0.000404903,
                0,
                0.326887,
                0.735511,
                0.000397486,
                0,
                0.352266,
                0.715435,
                0.00039357,
                0,
                0.378605,
                0.695403,
                0.000384739,
                0,
                0.405897,
                0.674681,
                0.000376108,
                0,
                0.43413,
                0.65359,
                0.000365997,
                0,
                0.463277,
                0.632471,
                0.000354957,
                0,
                0.493295,
                0.61151,
                0.000343593,
                0,
                0.524106,
                0.59064,
                0.000331841,
                0,
                0.555561,
                0.569386,
                0.000318891,
                0,
                0.587302,
                0.548785,
                0.0003072,
                0,
                0.619048,
                0.528146,
                0.00029361,
                0,
                0.650794,
                0.507872,
                0.000281709,
                0,
                0.68254,
                0.487805,
                0.000268627,
                0,
                0.714286,
                0.468196,
                0.000255887,
                0,
                0.746032,
                0.448922,
                0.000243997,
                0,
                0.777778,
                0.430093,
                0.000231662,
                0,
                0.809524,
                0.411845,
                0.000220339,
                0,
                0.84127,
                0.393808,
                0.000208694,
                0,
                0.873016,
                0.376615,
                0.000198045,
                0,
                0.904762,
                0.359655,
                0.000187375,
                0,
                0.936508,
                0.343452,
                0.000177371,
                0,
                0.968254,
                0.32765,
                0.000167525,
                0,
                1,
                1,
                0.0000169351,
                0,
                0,
                1,
                0.0000169356,
                0,
                0,
                1,
                0.0000169427,
                0,
                0,
                0.999999,
                0.0000169736,
                0,
                0,
                0.999998,
                0.0000170575,
                0,
                0,
                0.999995,
                0.0000172372,
                0,
                0,
                0.99999,
                0.0000175739,
                0,
                0,
                0.999979,
                0.0000181568,
                0,
                0,
                0.999966,
                0.0000191206,
                0,
                0,
                0.999944,
                0.000020677,
                0,
                0,
                0.999912,
                0.0000231644,
                0,
                0,
                0.999869,
                0.0000271268,
                0,
                0,
                0.999811,
                0.0000334272,
                0,
                0,
                0.99973,
                0.0000433979,
                0,
                0,
                0.999617,
                0.0000590083,
                0,
                0.0000680315,
                0.999445,
                0.0000829497,
                0,
                0.000612796,
                0.999138,
                0.000118019,
                0,
                0.00187408,
                0.998095,
                0.000156712,
                0,
                0.00395791,
                0.993919,
                0.000125054,
                0,
                0.00692144,
                0.991333,
                0.000126091,
                0,
                0.0107962,
                0.989226,
                0.000144912,
                0,
                0.0155986,
                0.986954,
                0.000175737,
                0,
                0.0213364,
                0.983982,
                0.000213883,
                0,
                0.0280114,
                0.979128,
                0.000234526,
                0,
                0.0356226,
                0.973327,
                0.000243725,
                0,
                0.0441668,
                0.967416,
                0.0002773,
                0,
                0.0536399,
                0.959729,
                0.000308799,
                0,
                0.0640376,
                0.949758,
                0.000322447,
                0,
                0.0753554,
                0.939173,
                0.000350021,
                0,
                0.0875893,
                0.9296,
                0.000370089,
                0,
                0.100736,
                0.921181,
                0.000391365,
                0,
                0.114793,
                0.91164,
                0.000413636,
                0,
                0.129759,
                0.900435,
                0.000427068,
                0,
                0.145632,
                0.888183,
                0.000441046,
                0,
                0.162412,
                0.874772,
                0.000454968,
                0,
                0.180101,
                0.859566,
                0.000461882,
                0,
                0.1987,
                0.843579,
                0.000471556,
                0,
                0.218213,
                0.826453,
                0.000474335,
                0,
                0.238641,
                0.809164,
                0.000477078,
                0,
                0.259989,
                0.792179,
                0.00047755,
                0,
                0.282262,
                0.773866,
                0.000472573,
                0,
                0.305464,
                0.754944,
                0.000469765,
                0,
                0.329599,
                0.735133,
                0.000462371,
                0,
                0.35467,
                0.714858,
                0.000453674,
                0,
                0.380678,
                0.694829,
                0.000443888,
                0,
                0.407622,
                0.674453,
                0.000432052,
                0,
                0.435493,
                0.653685,
                0.000420315,
                0,
                0.464275,
                0.632666,
                0.000406829,
                0,
                0.493938,
                0.611676,
                0.000392234,
                0,
                0.524422,
                0.591193,
                0.000379208,
                0,
                0.555624,
                0.570145,
                0.00036319,
                0,
                0.587302,
                0.549566,
                0.000349111,
                0,
                0.619048,
                0.529278,
                0.000334166,
                0,
                0.650794,
                0.509026,
                0.000318456,
                0,
                0.68254,
                0.489186,
                0.00030449,
                0,
                0.714286,
                0.469662,
                0.000289051,
                0,
                0.746032,
                0.450691,
                0.000275494,
                0,
                0.777778,
                0.431841,
                0.000261437,
                0,
                0.809524,
                0.413752,
                0.000247846,
                0,
                0.84127,
                0.395951,
                0.000235085,
                0,
                0.873016,
                0.378633,
                0.000222245,
                0,
                0.904762,
                0.36194,
                0.000210533,
                0,
                0.936508,
                0.345599,
                0.000198494,
                0,
                0.968254,
                0.329999,
                0.000188133,
                0,
                1,
                1,
                0.0000269663,
                0,
                0,
                1,
                0.000026967,
                0,
                0,
                1,
                0.0000269772,
                0,
                0,
                0.999999,
                0.0000270214,
                0,
                0,
                0.999998,
                0.0000271415,
                0,
                0,
                0.999994,
                0.000027398,
                0,
                0,
                0.999988,
                0.0000278771,
                0,
                0,
                0.999977,
                0.0000287019,
                0,
                0,
                0.999961,
                0.0000300544,
                0,
                0,
                0.999937,
                0.0000322138,
                0,
                0,
                0.999904,
                0.0000356163,
                0,
                0,
                0.999854,
                0.0000409465,
                0,
                0,
                0.99979,
                0.0000492651,
                0,
                0,
                0.999699,
                0.0000621722,
                0,
                8.8288e-7,
                0.999572,
                0.0000819715,
                0,
                0.000223369,
                0.999381,
                0.000111689,
                0,
                0.00105414,
                0.999016,
                0.000153862,
                0,
                0.0026493,
                0.997437,
                0.000187667,
                0,
                0.00508608,
                0.993545,
                0.000155672,
                0,
                0.00840554,
                0.991135,
                0.000161455,
                0,
                0.012629,
                0.989157,
                0.000188241,
                0,
                0.0177661,
                0.986874,
                0.000226229,
                0,
                0.0238198,
                0.983714,
                0.000268668,
                0,
                0.0307887,
                0.978301,
                0.000277109,
                0,
                0.0386688,
                0.973227,
                0.000303446,
                0,
                0.0474554,
                0.967317,
                0.000341851,
                0,
                0.0571428,
                0.959477,
                0.000370885,
                0,
                0.0677256,
                0.950012,
                0.000392753,
                0,
                0.0791988,
                0.939484,
                0.00042781,
                0,
                0.0915576,
                0.928135,
                0.000443866,
                0,
                0.104798,
                0.919819,
                0.000472959,
                0,
                0.118918,
                0.910049,
                0.000491551,
                0,
                0.133915,
                0.899181,
                0.000512616,
                0,
                0.149788,
                0.886881,
                0.000523563,
                0,
                0.166537,
                0.87359,
                0.000540183,
                0,
                0.184164,
                0.858613,
                0.000547386,
                0,
                0.202669,
                0.842809,
                0.000554809,
                0,
                0.222056,
                0.825727,
                0.000558316,
                0,
                0.242329,
                0.808086,
                0.000557824,
                0,
                0.263492,
                0.790728,
                0.000556346,
                0,
                0.285551,
                0.772987,
                0.000552672,
                0,
                0.30851,
                0.7541,
                0.000543738,
                0,
                0.332376,
                0.734669,
                0.000536107,
                0,
                0.357153,
                0.714411,
                0.000523342,
                0,
                0.382845,
                0.694196,
                0.000512238,
                0,
                0.409454,
                0.674252,
                0.000497465,
                0,
                0.436977,
                0.65357,
                0.000481096,
                0,
                0.465404,
                0.632999,
                0.000467054,
                0,
                0.494713,
                0.611994,
                0.000448771,
                0,
                0.524864,
                0.591604,
                0.000431889,
                0,
                0.555779,
                0.571134,
                0.000415238,
                0,
                0.587302,
                0.550528,
                0.000396369,
                0,
                0.619048,
                0.530292,
                0.000379477,
                0,
                0.650794,
                0.510364,
                0.000361488,
                0,
                0.68254,
                0.490749,
                0.000343787,
                0,
                0.714286,
                0.471266,
                0.000327822,
                0,
                0.746032,
                0.452462,
                0.000310626,
                0,
                0.777778,
                0.433907,
                0.000295352,
                0,
                0.809524,
                0.415659,
                0.000279179,
                0,
                0.84127,
                0.398138,
                0.000264685,
                0,
                0.873016,
                0.380833,
                0.000249905,
                0,
                0.904762,
                0.364247,
                0.000236282,
                0,
                0.936508,
                0.348041,
                0.000222905,
                0,
                0.968254,
                0.332389,
                0.000210522,
                0,
                1,
                1,
                0.0000420604,
                0,
                0,
                1,
                0.0000420614,
                0,
                0,
                1,
                0.0000420757,
                0,
                0,
                0.999999,
                0.000042138,
                0,
                0,
                0.999997,
                0.0000423067,
                0,
                0,
                0.999993,
                0.0000426668,
                0,
                0,
                0.999986,
                0.0000433372,
                0,
                0,
                0.999974,
                0.0000444857,
                0,
                0,
                0.999956,
                0.0000463554,
                0,
                0,
                0.99993,
                0.0000493105,
                0,
                0,
                0.999892,
                0.0000539077,
                0,
                0,
                0.999838,
                0.0000610005,
                0,
                0,
                0.999767,
                0.0000718822,
                0,
                0,
                0.999666,
                0.0000884581,
                0,
                0.0000365471,
                0.999525,
                0.000113398,
                0,
                0.000485623,
                0.999311,
                0.000150043,
                0,
                0.00162096,
                0.998865,
                0.000200063,
                0,
                0.00355319,
                0.996278,
                0.000211014,
                0,
                0.00633818,
                0.992956,
                0.000189672,
                0,
                0.0100043,
                0.991017,
                0.000210262,
                0,
                0.0145648,
                0.989055,
                0.000244292,
                0,
                0.0200237,
                0.986741,
                0.000290481,
                0,
                0.0263798,
                0.983288,
                0.000334303,
                0,
                0.033629,
                0.977784,
                0.000340307,
                0,
                0.0417652,
                0.973037,
                0.000377864,
                0,
                0.0507821,
                0.967181,
                0.0004239,
                0,
                0.060673,
                0.958971,
                0.000443854,
                0,
                0.0714314,
                0.950093,
                0.000483039,
                0,
                0.0830518,
                0.939552,
                0.000517934,
                0,
                0.0955288,
                0.927678,
                0.000539449,
                0,
                0.108859,
                0.918278,
                0.000568604,
                0,
                0.123038,
                0.908449,
                0.000588505,
                0,
                0.138065,
                0.897713,
                0.000612473,
                0,
                0.153938,
                0.885533,
                0.000625575,
                0,
                0.170657,
                0.872131,
                0.00063854,
                0,
                0.188224,
                0.857517,
                0.000647034,
                0,
                0.20664,
                0.841796,
                0.00065209,
                0,
                0.225909,
                0.824726,
                0.0006544,
                0,
                0.246035,
                0.807297,
                0.000655744,
                0,
                0.267022,
                0.789058,
                0.000646716,
                0,
                0.288878,
                0.77189,
                0.000643898,
                0,
                0.311607,
                0.753082,
                0.000629973,
                0,
                0.335216,
                0.7341,
                0.000621564,
                0,
                0.359713,
                0.714094,
                0.000605171,
                0,
                0.385103,
                0.693839,
                0.000588752,
                0,
                0.41139,
                0.673891,
                0.000573294,
                0,
                0.438576,
                0.653565,
                0.000552682,
                0,
                0.466656,
                0.633326,
                0.000533446,
                0,
                0.495617,
                0.612582,
                0.000514635,
                0,
                0.525431,
                0.59205,
                0.00049303,
                0,
                0.556041,
                0.571918,
                0.000471842,
                0,
                0.587338,
                0.551572,
                0.000451713,
                0,
                0.619048,
                0.531553,
                0.000430049,
                0,
                0.650794,
                0.51175,
                0.000410445,
                0,
                0.68254,
                0.49238,
                0.000390098,
                0,
                0.714286,
                0.473143,
                0.000370033,
                0,
                0.746032,
                0.45423,
                0.000351205,
                0,
                0.777778,
                0.435963,
                0.000332049,
                0,
                0.809524,
                0.41787,
                0.000315021,
                0,
                0.84127,
                0.400387,
                0.000297315,
                0,
                0.873016,
                0.383332,
                0.000281385,
                0,
                0.904762,
                0.366665,
                0.000265397,
                0,
                0.936508,
                0.350633,
                0.000250601,
                0,
                0.968254,
                0.334964,
                0.00023589,
                0,
                1,
                1,
                0.0000643736,
                0,
                0,
                1,
                0.000064375,
                0,
                0,
                1,
                0.0000643947,
                0,
                0,
                0.999999,
                0.000064481,
                0,
                0,
                0.999997,
                0.0000647143,
                0,
                0,
                0.999994,
                0.0000652119,
                0,
                0,
                0.999985,
                0.0000661359,
                0,
                0,
                0.999972,
                0.0000677116,
                0,
                0,
                0.999952,
                0.0000702599,
                0,
                0,
                0.999922,
                0.0000742517,
                0,
                0,
                0.99988,
                0.0000803906,
                0,
                0,
                0.99982,
                0.0000897315,
                0,
                0,
                0.999741,
                0.000103838,
                0,
                0,
                0.999629,
                0.00012496,
                0,
                0.000149024,
                0.999474,
                0.000156161,
                0,
                0.000861027,
                0.999229,
                0.000201034,
                0,
                0.00231198,
                0.998662,
                0.000259069,
                0,
                0.00458147,
                0.995299,
                0.000245439,
                0,
                0.00770895,
                0.992732,
                0.00024498,
                0,
                0.0117126,
                0.990847,
                0.000273211,
                0,
                0.0165989,
                0.988911,
                0.000316492,
                0,
                0.0223674,
                0.98654,
                0.00037161,
                0,
                0.0290135,
                0.982636,
                0.000410352,
                0,
                0.0365309,
                0.977346,
                0.000421756,
                0,
                0.0449117,
                0.972909,
                0.000475578,
                0,
                0.0541481,
                0.966821,
                0.000522482,
                0,
                0.0642326,
                0.958686,
                0.000545008,
                0,
                0.075158,
                0.949754,
                0.000589286,
                0,
                0.0869181,
                0.939184,
                0.000619995,
                0,
                0.0995074,
                0.927505,
                0.000654266,
                0,
                0.112922,
                0.916606,
                0.000682362,
                0,
                0.127157,
                0.906707,
                0.000704286,
                0,
                0.142212,
                0.895937,
                0.000725909,
                0,
                0.158085,
                0.883913,
                0.000743939,
                0,
                0.174776,
                0.870642,
                0.000755157,
                0,
                0.192287,
                0.856241,
                0.000764387,
                0,
                0.210619,
                0.84069,
                0.000771032,
                0,
                0.229775,
                0.823728,
                0.000765906,
                0,
                0.249761,
                0.806481,
                0.000767604,
                0,
                0.270582,
                0.787924,
                0.000754385,
                0,
                0.292243,
                0.770588,
                0.000749668,
                0,
                0.314753,
                0.751991,
                0.000731613,
                0,
                0.338118,
                0.733407,
                0.000717655,
                0,
                0.362347,
                0.713688,
                0.000700604,
                0,
                0.387447,
                0.693595,
                0.000678765,
                0,
                0.413424,
                0.673426,
                0.000657042,
                0,
                0.440284,
                0.65359,
                0.000635892,
                0,
                0.468027,
                0.633576,
                0.000611569,
                0,
                0.496645,
                0.613144,
                0.000586011,
                0,
                0.526122,
                0.592711,
                0.000563111,
                0,
                0.556417,
                0.572722,
                0.000537699,
                0,
                0.587451,
                0.552762,
                0.000512556,
                0,
                0.619048,
                0.532985,
                0.000489757,
                0,
                0.650794,
                0.513219,
                0.000464139,
                0,
                0.68254,
                0.493992,
                0.000442193,
                0,
                0.714286,
                0.47509,
                0.000418629,
                0,
                0.746032,
                0.456287,
                0.000397045,
                0,
                0.777778,
                0.438152,
                0.000375504,
                0,
                0.809524,
                0.420294,
                0.00035492,
                0,
                0.84127,
                0.402749,
                0.000335327,
                0,
                0.873016,
                0.385879,
                0.000316422,
                0,
                0.904762,
                0.369352,
                0.000298333,
                0,
                0.936508,
                0.353301,
                0.000281417,
                0,
                0.968254,
                0.337781,
                0.000265203,
                0,
                1,
                1,
                0.0000968267,
                0,
                0,
                1,
                0.0000968284,
                0,
                0,
                1,
                0.0000968556,
                0,
                0,
                0.999999,
                0.0000969733,
                0,
                0,
                0.999997,
                0.0000972913,
                0,
                0,
                0.999993,
                0.0000979688,
                0,
                0,
                0.999984,
                0.0000992239,
                0,
                0,
                0.999969,
                0.000101356,
                0,
                0,
                0.999946,
                0.000104784,
                0,
                0,
                0.999913,
                0.000110111,
                0,
                0,
                0.999868,
                0.000118217,
                0,
                0,
                0.999801,
                0.000130396,
                0,
                0,
                0.999712,
                0.000148523,
                0,
                0.0000124907,
                0.999589,
                0.000175233,
                0,
                0.000355405,
                0.999416,
                0.000213999,
                0,
                0.0013528,
                0.999136,
                0.000268529,
                0,
                0.00312557,
                0.998367,
                0.000333088,
                0,
                0.00573045,
                0.994701,
                0.000304757,
                0,
                0.00919397,
                0.992497,
                0.000318031,
                0,
                0.0135261,
                0.990608,
                0.000353863,
                0,
                0.0187278,
                0.988715,
                0.000409044,
                0,
                0.0247947,
                0.986241,
                0.000472967,
                0,
                0.0317196,
                0.981696,
                0.000495104,
                0,
                0.039494,
                0.977097,
                0.000532873,
                0,
                0.0481087,
                0.972583,
                0.000594447,
                0,
                0.0575549,
                0.966142,
                0.000636867,
                0,
                0.0678242,
                0.95823,
                0.000669899,
                0,
                0.0789089,
                0.949677,
                0.000719499,
                0,
                0.0908023,
                0.939226,
                0.000750584,
                0,
                0.103499,
                0.927501,
                0.000793183,
                0,
                0.116993,
                0.915199,
                0.00081995,
                0,
                0.131282,
                0.90498,
                0.000847654,
                0,
                0.146364,
                0.894243,
                0.000868929,
                0,
                0.162237,
                0.882154,
                0.000884278,
                0,
                0.178902,
                0.869161,
                0.000898108,
                0,
                0.196358,
                0.854751,
                0.000901254,
                0,
                0.21461,
                0.839368,
                0.00090679,
                0,
                0.23366,
                0.822874,
                0.000901541,
                0,
                0.253512,
                0.805514,
                0.000897297,
                0,
                0.274174,
                0.78716,
                0.000881856,
                0,
                0.29565,
                0.769061,
                0.000870032,
                0,
                0.31795,
                0.751,
                0.000851719,
                0,
                0.341081,
                0.732614,
                0.000830671,
                0,
                0.365053,
                0.713171,
                0.000806569,
                0,
                0.389874,
                0.693472,
                0.00078338,
                0,
                0.415553,
                0.673528,
                0.000756404,
                0,
                0.442098,
                0.653397,
                0.000726872,
                0,
                0.469512,
                0.633781,
                0.000700494,
                0,
                0.497794,
                0.613877,
                0.00067105,
                0,
                0.526935,
                0.593506,
                0.000640361,
                0,
                0.556908,
                0.573667,
                0.000613502,
                0,
                0.587657,
                0.553932,
                0.000583177,
                0,
                0.61906,
                0.534345,
                0.000554375,
                0,
                0.650794,
                0.515042,
                0.000527811,
                0,
                0.68254,
                0.495674,
                0.000499367,
                0,
                0.714286,
                0.477132,
                0.00047429,
                0,
                0.746032,
                0.458609,
                0.000447726,
                0,
                0.777778,
                0.440354,
                0.000424205,
                0,
                0.809524,
                0.422765,
                0.000399549,
                0,
                0.84127,
                0.405472,
                0.000378315,
                0,
                0.873016,
                0.388482,
                0.000355327,
                0,
                0.904762,
                0.372191,
                0.000336122,
                0,
                0.936508,
                0.356099,
                0.000315247,
                0,
                0.968254,
                0.340737,
                0.00029794,
                0,
                1,
                1,
                0.000143327,
                0,
                0,
                1,
                0.00014333,
                0,
                0,
                1,
                0.000143366,
                0,
                0,
                0.999999,
                0.000143524,
                0,
                0,
                0.999996,
                0.000143952,
                0,
                0,
                0.999991,
                0.000144862,
                0,
                0,
                0.999981,
                0.000146544,
                0,
                0,
                0.999966,
                0.000149391,
                0,
                0,
                0.999941,
                0.000153946,
                0,
                0,
                0.999905,
                0.000160971,
                0,
                0,
                0.999852,
                0.000171562,
                0,
                0,
                0.99978,
                0.00018729,
                0,
                0,
                0.999681,
                0.000210386,
                0,
                0.0000826239,
                0.999546,
                0.000243906,
                0,
                0.000664807,
                0.999352,
                0.000291739,
                0,
                0.00196192,
                0.999027,
                0.000357419,
                0,
                0.00405941,
                0.997886,
                0.000422349,
                0,
                0.00699664,
                0.99419,
                0.000385008,
                0,
                0.0107896,
                0.99214,
                0.000409775,
                0,
                0.0154415,
                0.990274,
                0.000456418,
                0,
                0.0209488,
                0.988455,
                0.000527008,
                0,
                0.0273037,
                0.985804,
                0.000597685,
                0,
                0.0344969,
                0.98103,
                0.000613124,
                0,
                0.0425183,
                0.976674,
                0.000668321,
                0,
                0.0513575,
                0.972021,
                0.000736985,
                0,
                0.0610046,
                0.965274,
                0.000773789,
                0,
                0.0714508,
                0.958046,
                0.000830852,
                0,
                0.0826877,
                0.949333,
                0.000875766,
                0,
                0.0947085,
                0.939135,
                0.000917088,
                0,
                0.107507,
                0.927119,
                0.000952244,
                0,
                0.121078,
                0.91469,
                0.000990626,
                0,
                0.135419,
                0.903006,
                0.00101304,
                0,
                0.150526,
                0.892368,
                0.00103834,
                0,
                0.166399,
                0.880231,
                0.00105002,
                0,
                0.183038,
                0.867432,
                0.00106331,
                0,
                0.200443,
                0.853208,
                0.00106783,
                0,
                0.218618,
                0.837956,
                0.00106458,
                0,
                0.237566,
                0.821772,
                0.00105945,
                0,
                0.257291,
                0.804328,
                0.00104685,
                0,
                0.2778,
                0.786465,
                0.00103178,
                0,
                0.2991,
                0.768004,
                0.00101077,
                0,
                0.321199,
                0.74972,
                0.000985504,
                0,
                0.344106,
                0.731682,
                0.000962893,
                0,
                0.36783,
                0.712813,
                0.000932146,
                0,
                0.392383,
                0.693139,
                0.00089871,
                0,
                0.417774,
                0.673566,
                0.000869678,
                0,
                0.444013,
                0.653483,
                0.000835525,
                0,
                0.471107,
                0.633891,
                0.000799853,
                0,
                0.49906,
                0.614433,
                0.000766838,
                0,
                0.527869,
                0.594586,
                0.000732227,
                0,
                0.557517,
                0.574769,
                0.000696442,
                0,
                0.587966,
                0.555149,
                0.000663935,
                0,
                0.61913,
                0.535898,
                0.000629826,
                0,
                0.650794,
                0.516753,
                0.000596486,
                0,
                0.68254,
                0.497816,
                0.000567078,
                0,
                0.714286,
                0.479034,
                0.000534399,
                0,
                0.746032,
                0.460975,
                0.000507013,
                0,
                0.777778,
                0.442935,
                0.000477421,
                0,
                0.809524,
                0.425263,
                0.000451101,
                0,
                0.84127,
                0.408248,
                0.000424964,
                0,
                0.873016,
                0.391339,
                0.00039993,
                0,
                0.904762,
                0.37513,
                0.000377619,
                0,
                0.936508,
                0.359172,
                0.000354418,
                0,
                0.968254,
                0.343876,
                0.000334823,
                0,
                1,
                1,
                0.000209042,
                0,
                0,
                1,
                0.000209045,
                0,
                0,
                1,
                0.000209093,
                0,
                0,
                0.999999,
                0.000209304,
                0,
                0,
                0.999996,
                0.000209871,
                0,
                0,
                0.999991,
                0.000211078,
                0,
                0,
                0.999979,
                0.000213304,
                0,
                0,
                0.999963,
                0.000217061,
                0,
                0,
                0.999933,
                0.000223042,
                0,
                0,
                0.999894,
                0.000232206,
                0,
                0,
                0.999837,
                0.000245901,
                0,
                0,
                0.999756,
                0.000266023,
                0,
                0.00000102927,
                0.999648,
                0.000295204,
                0,
                0.000233468,
                0.999499,
                0.000336958,
                0,
                0.00108237,
                0.999283,
                0.000395563,
                0,
                0.00268832,
                0.998896,
                0.000473785,
                0,
                0.00511138,
                0.997006,
                0.000520008,
                0,
                0.00837705,
                0.993819,
                0.000497261,
                0,
                0.0124928,
                0.991632,
                0.000523722,
                0,
                0.0174561,
                0.989875,
                0.000587258,
                0,
                0.0232596,
                0.988109,
                0.000676329,
                0,
                0.0298932,
                0.985155,
                0.000747701,
                0,
                0.0373453,
                0.980479,
                0.000768803,
                0,
                0.0456045,
                0.976271,
                0.000841054,
                0,
                0.0546593,
                0.971347,
                0.000911469,
                0,
                0.0644994,
                0.964528,
                0.000953057,
                0,
                0.0751152,
                0.957632,
                0.00102221,
                0,
                0.0864981,
                0.948681,
                0.00106122,
                0,
                0.0986407,
                0.938716,
                0.00111857,
                0,
                0.111537,
                0.926629,
                0.00114762,
                0,
                0.125182,
                0.914025,
                0.00118995,
                0,
                0.139571,
                0.901026,
                0.00121228,
                0,
                0.154703,
                0.890358,
                0.00123946,
                0,
                0.170576,
                0.878283,
                0.0012527,
                0,
                0.18719,
                0.865459,
                0.00125536,
                0,
                0.204547,
                0.851407,
                0.00126134,
                0,
                0.222648,
                0.836276,
                0.00124759,
                0,
                0.241498,
                0.820436,
                0.00124443,
                0,
                0.261101,
                0.803253,
                0.00122071,
                0,
                0.281465,
                0.785562,
                0.00120107,
                0,
                0.302595,
                0.76718,
                0.00117762,
                0,
                0.324501,
                0.748551,
                0.00114289,
                0,
                0.347192,
                0.730564,
                0.00110872,
                0,
                0.370679,
                0.712253,
                0.00107636,
                0,
                0.394973,
                0.692867,
                0.00103646,
                0,
                0.420085,
                0.673695,
                0.000996793,
                0,
                0.446027,
                0.653912,
                0.00095675,
                0,
                0.47281,
                0.634129,
                0.000916739,
                0,
                0.500441,
                0.615004,
                0.000874401,
                0,
                0.528921,
                0.595587,
                0.000833411,
                0,
                0.558244,
                0.575965,
                0.000794556,
                0,
                0.588384,
                0.5566,
                0.00075196,
                0,
                0.619281,
                0.537428,
                0.000716381,
                0,
                0.650795,
                0.518623,
                0.000676558,
                0,
                0.68254,
                0.499964,
                0.00064074,
                0,
                0.714286,
                0.481356,
                0.000605984,
                0,
                0.746032,
                0.463279,
                0.000570256,
                0,
                0.777778,
                0.445673,
                0.000540138,
                0,
                0.809524,
                0.428032,
                0.000507299,
                0,
                0.84127,
                0.411112,
                0.000479553,
                0,
                0.873016,
                0.394444,
                0.000450737,
                0,
                0.904762,
                0.378247,
                0.000424269,
                0,
                0.936508,
                0.362415,
                0.000399111,
                0,
                0.968254,
                0.347103,
                0.000375274,
                0,
                1,
                1,
                0.000300729,
                0,
                0,
                1,
                0.000300733,
                0,
                0,
                1,
                0.000300797,
                0,
                0,
                0.999998,
                0.000301072,
                0,
                0,
                0.999996,
                0.000301817,
                0,
                0,
                0.999989,
                0.000303398,
                0,
                0,
                0.999977,
                0.000306309,
                0,
                0,
                0.999958,
                0.000311209,
                0,
                0,
                0.999927,
                0.000318975,
                0,
                0,
                0.999884,
                0.000330804,
                0,
                0,
                0.99982,
                0.00034834,
                0,
                0,
                0.999733,
                0.000373854,
                0,
                0.0000326995,
                0.999613,
                0.000410424,
                0,
                0.000477174,
                0.999447,
                0.000462047,
                0,
                0.00161099,
                0.999204,
                0.000533322,
                0,
                0.00353153,
                0.998725,
                0.000624964,
                0,
                0.00627965,
                0.995871,
                0.000631786,
                0,
                0.0098693,
                0.993194,
                0.000632017,
                0,
                0.0143011,
                0.991541,
                0.00068923,
                0,
                0.019568,
                0.989773,
                0.000766892,
                0,
                0.0256593,
                0.987647,
                0.000863668,
                0,
                0.0325625,
                0.984193,
                0.000922089,
                0,
                0.0402647,
                0.980016,
                0.000970749,
                0,
                0.0487532,
                0.975859,
                0.00106027,
                0,
                0.058016,
                0.970514,
                0.00112239,
                0,
                0.0680419,
                0.963625,
                0.00117212,
                0,
                0.0788208,
                0.956959,
                0.00125211,
                0,
                0.0903439,
                0.947956,
                0.00129411,
                0,
                0.102604,
                0.93809,
                0.00135879,
                0,
                0.115594,
                0.92659,
                0.00139309,
                0,
                0.129309,
                0.913829,
                0.00143253,
                0,
                0.143745,
                0.90005,
                0.00145809,
                0,
                0.158901,
                0.888129,
                0.0014748,
                0,
                0.174774,
                0.87607,
                0.00148756,
                0,
                0.191365,
                0.863461,
                0.00148714,
                0,
                0.208674,
                0.849594,
                0.00148892,
                0,
                0.226705,
                0.834531,
                0.00146496,
                0,
                0.245461,
                0.81903,
                0.0014579,
                0,
                0.264947,
                0.802122,
                0.00143039,
                0,
                0.28517,
                0.78445,
                0.00139717,
                0,
                0.306137,
                0.766434,
                0.00136312,
                0,
                0.327857,
                0.747816,
                0.00132597,
                0,
                0.350341,
                0.729519,
                0.00128323,
                0,
                0.373598,
                0.711454,
                0.00123803,
                0,
                0.397642,
                0.692699,
                0.00119097,
                0,
                0.422485,
                0.673723,
                0.00114565,
                0,
                0.448139,
                0.654386,
                0.00109552,
                0,
                0.474619,
                0.634673,
                0.00104553,
                0,
                0.501933,
                0.615554,
                0.00099985,
                0,
                0.530089,
                0.596462,
                0.000948207,
                0,
                0.559087,
                0.577385,
                0.000902299,
                0,
                0.588913,
                0.558257,
                0.000856448,
                0,
                0.619525,
                0.5392,
                0.000810395,
                0,
                0.650826,
                0.520543,
                0.000768558,
                0,
                0.68254,
                0.502206,
                0.0007239,
                0,
                0.714286,
                0.48402,
                0.000685794,
                0,
                0.746032,
                0.465779,
                0.00064471,
                0,
                0.777778,
                0.448455,
                0.000609583,
                0,
                0.809524,
                0.431091,
                0.00057227,
                0,
                0.84127,
                0.414147,
                0.00054042,
                0,
                0.873016,
                0.39765,
                0.000506545,
                0,
                0.904762,
                0.381576,
                0.000477635,
                0,
                0.936508,
                0.365881,
                0.000448446,
                0,
                0.968254,
                0.350582,
                0.000421424,
                0,
                1,
                1,
                0.000427144,
                0,
                0,
                1,
                0.000427151,
                0,
                0,
                1,
                0.000427232,
                0,
                0,
                0.999998,
                0.00042759,
                0,
                0,
                0.999995,
                0.000428555,
                0,
                0,
                0.999988,
                0.000430603,
                0,
                0,
                0.999976,
                0.000434368,
                0,
                0,
                0.999952,
                0.000440688,
                0,
                0,
                0.999919,
                0.000450667,
                0,
                0,
                0.999871,
                0.00046578,
                0,
                0,
                0.999801,
                0.000488024,
                0,
                0,
                0.999704,
                0.000520092,
                0,
                0.000129791,
                0.999572,
                0.000565553,
                0,
                0.000821056,
                0.999389,
                0.000628906,
                0,
                0.00225241,
                0.999114,
                0.000714911,
                0,
                0.00449109,
                0.998488,
                0.000819218,
                0,
                0.00756249,
                0.995234,
                0.00080415,
                0,
                0.0114716,
                0.993021,
                0.000830181,
                0,
                0.0162131,
                0.991407,
                0.000902645,
                0,
                0.021776,
                0.989625,
                0.000996934,
                0,
                0.0281471,
                0.987064,
                0.00109707,
                0,
                0.0353118,
                0.983265,
                0.00114353,
                0,
                0.0432562,
                0.979535,
                0.0012272,
                0,
                0.0519665,
                0.975224,
                0.00132642,
                0,
                0.0614298,
                0.969574,
                0.00138092,
                0,
                0.0716348,
                0.963021,
                0.00145896,
                0,
                0.0825709,
                0.956046,
                0.00152834,
                0,
                0.094229,
                0.947136,
                0.00158217,
                0,
                0.106602,
                0.937313,
                0.0016347,
                0,
                0.119682,
                0.926073,
                0.00168383,
                0,
                0.133465,
                0.913121,
                0.00171627,
                0,
                0.147947,
                0.899165,
                0.00174229,
                0,
                0.163125,
                0.885891,
                0.00176137,
                0,
                0.178998,
                0.873783,
                0.00176406,
                0,
                0.195566,
                0.861331,
                0.00176156,
                0,
                0.21283,
                0.847569,
                0.00175346,
                0,
                0.230793,
                0.832785,
                0.00172753,
                0,
                0.249459,
                0.817442,
                0.00170204,
                0,
                0.268832,
                0.800613,
                0.00166576,
                0,
                0.28892,
                0.783597,
                0.00162909,
                0,
                0.30973,
                0.76571,
                0.0015826,
                0,
                0.331271,
                0.747021,
                0.00153106,
                0,
                0.353554,
                0.728593,
                0.00148036,
                0,
                0.37659,
                0.710661,
                0.00142808,
                0,
                0.400391,
                0.692426,
                0.00136906,
                0,
                0.424973,
                0.673623,
                0.00131066,
                0,
                0.450347,
                0.65494,
                0.00125569,
                0,
                0.476531,
                0.635448,
                0.00119517,
                0,
                0.503535,
                0.616221,
                0.00113828,
                0,
                0.531372,
                0.597531,
                0.0010816,
                0,
                0.560047,
                0.578795,
                0.00102673,
                0,
                0.589554,
                0.559892,
                0.000970985,
                0,
                0.619869,
                0.541307,
                0.000919773,
                0,
                0.650923,
                0.522608,
                0.000868479,
                0,
                0.68254,
                0.504484,
                0.00082137,
                0,
                0.714286,
                0.486603,
                0.000772916,
                0,
                0.746032,
                0.468802,
                0.000730353,
                0,
                0.777778,
                0.451172,
                0.000684955,
                0,
                0.809524,
                0.434348,
                0.000647565,
                0,
                0.84127,
                0.417445,
                0.000605863,
                0,
                0.873016,
                0.401077,
                0.000571885,
                0,
                0.904762,
                0.385039,
                0.000536034,
                0,
                0.936508,
                0.369483,
                0.000504227,
                0,
                0.968254,
                0.354272,
                0.000473165,
                0,
                1,
                1,
                0.000599525,
                0,
                0,
                1,
                0.000599533,
                0,
                0,
                1,
                0.000599639,
                0,
                0,
                0.999998,
                0.000600097,
                0,
                0,
                0.999994,
                0.000601336,
                0,
                0,
                0.999987,
                0.000603958,
                0,
                0,
                0.999972,
                0.000608775,
                0,
                0,
                0.999949,
                0.000616842,
                0,
                0,
                0.999912,
                0.000629534,
                0,
                0,
                0.999857,
                0.000648658,
                0,
                0,
                0.999781,
                0.000676615,
                0,
                0.00000538873,
                0.999674,
                0.000716574,
                0,
                0.000308602,
                0.999528,
                0.000772641,
                0,
                0.00127003,
                0.999326,
                0.000849806,
                0,
                0.00300783,
                0.999009,
                0.000952682,
                0,
                0.00556637,
                0.998112,
                0.00106394,
                0,
                0.00895889,
                0.994496,
                0.00102228,
                0,
                0.0131827,
                0.992806,
                0.00108586,
                0,
                0.0182277,
                0.991211,
                0.0011759,
                0,
                0.0240795,
                0.989415,
                0.00128955,
                0,
                0.030723,
                0.986499,
                0.00139038,
                0,
                0.0381418,
                0.982679,
                0.00144539,
                0,
                0.046321,
                0.978839,
                0.00153954,
                0,
                0.0552459,
                0.974295,
                0.00164417,
                0,
                0.0649034,
                0.968784,
                0.00171517,
                0,
                0.0752814,
                0.962324,
                0.00180282,
                0,
                0.0863693,
                0.954956,
                0.00186387,
                0,
                0.0981578,
                0.94624,
                0.00193817,
                0,
                0.110639,
                0.936517,
                0.00198156,
                0,
                0.123806,
                0.925186,
                0.00203042,
                0,
                0.137655,
                0.91252,
                0.0020664,
                0,
                0.15218,
                0.898441,
                0.00207822,
                0,
                0.16738,
                0.884394,
                0.0020992,
                0,
                0.183253,
                0.871273,
                0.00208748,
                0,
                0.199799,
                0.859057,
                0.00208686,
                0,
                0.21702,
                0.845243,
                0.00205519,
                0,
                0.234918,
                0.830723,
                0.00202868,
                0,
                0.253496,
                0.815801,
                0.00199501,
                0,
                0.272761,
                0.79914,
                0.00194193,
                0,
                0.292719,
                0.782372,
                0.00188824,
                0,
                0.313377,
                0.76482,
                0.00183695,
                0,
                0.334745,
                0.746586,
                0.00177418,
                0,
                0.356833,
                0.7281,
                0.00170628,
                0,
                0.379654,
                0.709842,
                0.00164063,
                0,
                0.403221,
                0.692019,
                0.00157355,
                0,
                0.427548,
                0.67364,
                0.00150262,
                0,
                0.452651,
                0.655277,
                0.00143473,
                0,
                0.478545,
                0.636438,
                0.00136371,
                0,
                0.505246,
                0.617364,
                0.00129911,
                0,
                0.532768,
                0.598603,
                0.00123014,
                0,
                0.561122,
                0.580195,
                0.00116587,
                0,
                0.590309,
                0.561786,
                0.00110398,
                0,
                0.620318,
                0.543377,
                0.00104148,
                0,
                0.651102,
                0.525093,
                0.000983984,
                0,
                0.682545,
                0.506791,
                0.00092667,
                0,
                0.714286,
                0.489291,
                0.000874326,
                0,
                0.746032,
                0.471811,
                0.000821734,
                0,
                0.777778,
                0.454435,
                0.000774698,
                0,
                0.809524,
                0.437493,
                0.000727302,
                0,
                0.84127,
                0.420977,
                0.000684039,
                0,
                0.873016,
                0.404729,
                0.00064373,
                0,
                0.904762,
                0.388756,
                0.00060285,
                0,
                0.936508,
                0.373344,
                0.00056765,
                0,
                0.968254,
                0.358191,
                0.000531929,
                0,
                1,
                1,
                0.000832169,
                0,
                0,
                1,
                0.000832178,
                0,
                0,
                1,
                0.00083231,
                0,
                0,
                0.999998,
                0.000832893,
                0,
                0,
                0.999995,
                0.000834465,
                0,
                0,
                0.999985,
                0.000837791,
                0,
                0,
                0.999969,
                0.000843893,
                0,
                0,
                0.999944,
                0.000854086,
                0,
                0,
                0.999903,
                0.000870071,
                0,
                0,
                0.999843,
                0.000894042,
                0,
                0,
                0.999759,
                0.000928865,
                0,
                0.0000531805,
                0.999643,
                0.000978242,
                0,
                0.000579365,
                0.99948,
                0.00104684,
                0,
                0.00182774,
                0.999255,
                0.00114012,
                0,
                0.00387804,
                0.998885,
                0.00126188,
                0,
                0.00675709,
                0.997405,
                0.00135888,
                0,
                0.010468,
                0.99424,
                0.00133626,
                0,
                0.0150018,
                0.992458,
                0.00140905,
                0,
                0.0203443,
                0.990929,
                0.00152305,
                0,
                0.0264786,
                0.989116,
                0.00165882,
                0,
                0.0333875,
                0.985624,
                0.00174128,
                0,
                0.0410536,
                0.982003,
                0.00182108,
                0,
                0.0494609,
                0.978336,
                0.00194498,
                0,
                0.0585941,
                0.973184,
                0.00202708,
                0,
                0.0684396,
                0.9678,
                0.00212166,
                0,
                0.0789851,
                0.961348,
                0.00221366,
                0,
                0.0902199,
                0.953841,
                0.00228219,
                0,
                0.102134,
                0.94534,
                0.00235662,
                0,
                0.114721,
                0.935552,
                0.00240572,
                0,
                0.127972,
                0.924064,
                0.00244405,
                0,
                0.141884,
                0.911827,
                0.00247557,
                0,
                0.156451,
                0.897731,
                0.00248374,
                0,
                0.171672,
                0.883409,
                0.00249863,
                0,
                0.187545,
                0.868625,
                0.00246688,
                0,
                0.20407,
                0.856529,
                0.00246523,
                0,
                0.221249,
                0.842999,
                0.00242368,
                0,
                0.239083,
                0.828505,
                0.00237354,
                0,
                0.257578,
                0.813825,
                0.00232588,
                0,
                0.276738,
                0.797813,
                0.00226731,
                0,
                0.296569,
                0.781097,
                0.00219704,
                0,
                0.31708,
                0.764038,
                0.00212394,
                0,
                0.338281,
                0.746067,
                0.00204786,
                0,
                0.360181,
                0.727687,
                0.00196728,
                0,
                0.382794,
                0.709571,
                0.00188779,
                0,
                0.406133,
                0.691503,
                0.00180532,
                0,
                0.430213,
                0.673673,
                0.00171849,
                0,
                0.45505,
                0.655732,
                0.00164147,
                0,
                0.480662,
                0.637399,
                0.00155858,
                0,
                0.507065,
                0.618616,
                0.00147641,
                0,
                0.534278,
                0.60005,
                0.00140125,
                0,
                0.562313,
                0.581713,
                0.00132441,
                0,
                0.59118,
                0.563546,
                0.00125014,
                0,
                0.620875,
                0.545605,
                0.00118249,
                0,
                0.651373,
                0.527559,
                0.0011116,
                0,
                0.682593,
                0.509764,
                0.00104979,
                0,
                0.714286,
                0.49193,
                0.000985977,
                0,
                0.746032,
                0.475011,
                0.000928592,
                0,
                0.777778,
                0.457878,
                0.000873466,
                0,
                0.809524,
                0.440979,
                0.000819585,
                0,
                0.84127,
                0.424613,
                0.000772365,
                0,
                0.873016,
                0.408549,
                0.000722195,
                0,
                0.904762,
                0.392771,
                0.000680014,
                0,
                0.936508,
                0.377317,
                0.000636797,
                0,
                0.968254,
                0.362352,
                0.000598318,
                0,
                1,
                1,
                0.00114313,
                0,
                0,
                1,
                0.00114314,
                0,
                0,
                0.999999,
                0.00114331,
                0,
                0,
                0.999998,
                0.00114404,
                0,
                0,
                0.999994,
                0.00114601,
                0,
                0,
                0.999984,
                0.00115019,
                0,
                0,
                0.999967,
                0.00115784,
                0,
                0,
                0.999937,
                0.0011706,
                0,
                0,
                0.999894,
                0.00119054,
                0,
                0,
                0.999828,
                0.00122031,
                0,
                0,
                0.999735,
                0.00126331,
                0,
                0.000169263,
                0.999606,
                0.00132382,
                0,
                0.000949167,
                0.999426,
                0.0014071,
                0,
                0.00249668,
                0.999173,
                0.00151895,
                0,
                0.00486392,
                0.99873,
                0.00166102,
                0,
                0.00806323,
                0.996243,
                0.0017023,
                0,
                0.0120895,
                0.993779,
                0.00172782,
                0,
                0.0169288,
                0.9919,
                0.0018108,
                0,
                0.0225633,
                0.990524,
                0.00196028,
                0,
                0.028974,
                0.98868,
                0.00212014,
                0,
                0.036142,
                0.984663,
                0.00217598,
                0,
                0.044049,
                0.981457,
                0.00230563,
                0,
                0.0526781,
                0.977608,
                0.00243966,
                0,
                0.0620137,
                0.972215,
                0.00251336,
                0,
                0.0720418,
                0.966798,
                0.0026285,
                0,
                0.0827499,
                0.960241,
                0.00271409,
                0,
                0.0941271,
                0.952489,
                0.00278381,
                0,
                0.106164,
                0.944127,
                0.00285399,
                0,
                0.118852,
                0.934282,
                0.00290994,
                0,
                0.132185,
                0.923271,
                0.00294558,
                0,
                0.146157,
                0.910803,
                0.00296269,
                0,
                0.160766,
                0.896705,
                0.00296803,
                0,
                0.176007,
                0.88238,
                0.00296637,
                0,
                0.19188,
                0.867116,
                0.00293163,
                0,
                0.208385,
                0.853636,
                0.00289418,
                0,
                0.225523,
                0.840469,
                0.00284663,
                0,
                0.243296,
                0.82639,
                0.00278594,
                0,
                0.261709,
                0.811759,
                0.00271618,
                0,
                0.280767,
                0.796113,
                0.00263187,
                0,
                0.300476,
                0.779518,
                0.00254589,
                0,
                0.320845,
                0.763142,
                0.00246003,
                0,
                0.341883,
                0.745464,
                0.00236529,
                0,
                0.363601,
                0.727491,
                0.00226536,
                0,
                0.386011,
                0.709414,
                0.00216375,
                0,
                0.409128,
                0.691396,
                0.00207127,
                0,
                0.432967,
                0.67368,
                0.00197106,
                0,
                0.457545,
                0.656049,
                0.00187022,
                0,
                0.482881,
                0.638188,
                0.00177605,
                0,
                0.508992,
                0.620177,
                0.00168482,
                0,
                0.535899,
                0.601506,
                0.00158909,
                0,
                0.563619,
                0.58362,
                0.00150583,
                0,
                0.592165,
                0.565496,
                0.00141791,
                0,
                0.621544,
                0.54789,
                0.00133693,
                0,
                0.651743,
                0.530323,
                0.00126038,
                0,
                0.682709,
                0.512795,
                0.00118556,
                0,
                0.714286,
                0.495199,
                0.00111527,
                0,
                0.746032,
                0.478101,
                0.0010489,
                0,
                0.777778,
                0.461511,
                0.000984264,
                0,
                0.809524,
                0.444879,
                0.00092591,
                0,
                0.84127,
                0.428424,
                0.000866582,
                0,
                0.873016,
                0.412495,
                0.000814463,
                0,
                0.904762,
                0.396975,
                0.000764498,
                0,
                0.936508,
                0.381614,
                0.000715967,
                0,
                0.968254,
                0.366732,
                0.000672483,
                0,
                1,
                1,
                0.00155501,
                0,
                0,
                1,
                0.00155503,
                0,
                0,
                1,
                0.00155524,
                0,
                0,
                0.999998,
                0.00155615,
                0,
                0,
                0.999994,
                0.0015586,
                0,
                0,
                0.999983,
                0.00156379,
                0,
                0,
                0.999963,
                0.0015733,
                0,
                0,
                0.999932,
                0.00158911,
                0,
                0,
                0.999882,
                0.00161376,
                0,
                0,
                0.99981,
                0.00165041,
                0,
                0.0000100875,
                0.999708,
                0.00170304,
                0,
                0.000367658,
                0.999565,
                0.00177658,
                0,
                0.0014234,
                0.999368,
                0.00187688,
                0,
                0.00327939,
                0.999081,
                0.00200989,
                0,
                0.00596629,
                0.99852,
                0.00217177,
                0,
                0.0094852,
                0.99549,
                0.0021745,
                0,
                0.013824,
                0.993252,
                0.00222357,
                0,
                0.0189642,
                0.991727,
                0.00235022,
                0,
                0.0248856,
                0.989951,
                0.00250561,
                0,
                0.0315669,
                0.988029,
                0.00268829,
                0,
                0.0389882,
                0.984029,
                0.0027496,
                0,
                0.0471302,
                0.980683,
                0.00289793,
                0,
                0.0559754,
                0.976554,
                0.00303315,
                0,
                0.0655081,
                0.97139,
                0.00313257,
                0,
                0.0757138,
                0.965544,
                0.00323656,
                0,
                0.08658,
                0.95912,
                0.00333432,
                0,
                0.0980954,
                0.951183,
                0.0034039,
                0,
                0.110251,
                0.942974,
                0.00347515,
                0,
                0.123038,
                0.932642,
                0.00350381,
                0,
                0.13645,
                0.922158,
                0.00354519,
                0,
                0.150482,
                0.909404,
                0.00353851,
                0,
                0.165129,
                0.896071,
                0.0035435,
                0,
                0.18039,
                0.881206,
                0.00349936,
                0,
                0.196263,
                0.866077,
                0.00347256,
                0,
                0.212748,
                0.85093,
                0.003415,
                0,
                0.229847,
                0.837703,
                0.00333367,
                0,
                0.247561,
                0.823878,
                0.003249,
                0,
                0.265895,
                0.809449,
                0.00316347,
                0,
                0.284854,
                0.794379,
                0.00306351,
                0,
                0.304445,
                0.778138,
                0.0029499,
                0,
                0.324675,
                0.761997,
                0.00284099,
                0,
                0.345555,
                0.744938,
                0.00272104,
                0,
                0.367095,
                0.727212,
                0.00260715,
                0,
                0.389309,
                0.709549,
                0.00248855,
                0,
                0.41221,
                0.691704,
                0.00236783,
                0,
                0.435814,
                0.673689,
                0.00225178,
                0,
                0.460138,
                0.656453,
                0.00213765,
                0,
                0.485203,
                0.639128,
                0.00202178,
                0,
                0.511028,
                0.621512,
                0.00191443,
                0,
                0.537634,
                0.603598,
                0.00180977,
                0,
                0.565041,
                0.58559,
                0.00170456,
                0,
                0.593268,
                0.567852,
                0.00160927,
                0,
                0.622327,
                0.5503,
                0.00151395,
                0,
                0.652217,
                0.533033,
                0.00142499,
                0,
                0.682907,
                0.515942,
                0.00133955,
                0,
                0.714296,
                0.498814,
                0.0012602,
                0,
                0.746032,
                0.481595,
                0.00118188,
                0,
                0.777778,
                0.465117,
                0.00111171,
                0,
                0.809524,
                0.448865,
                0.00104091,
                0,
                0.84127,
                0.432711,
                0.000976618,
                0,
                0.873016,
                0.416822,
                0.00091859,
                0,
                0.904762,
                0.401272,
                0.000857704,
                0,
                0.936508,
                0.386226,
                0.000807172,
                0,
                0.968254,
                0.371321,
                0.00075464,
                0,
                1,
                1,
                0.00209596,
                0,
                0,
                1,
                0.00209598,
                0,
                0,
                1,
                0.00209624,
                0,
                0,
                0.999997,
                0.00209736,
                0,
                0,
                0.999991,
                0.00210039,
                0,
                0,
                0.999979,
                0.00210678,
                0,
                0,
                0.999959,
                0.00211847,
                0,
                0,
                0.999925,
                0.0021379,
                0,
                0,
                0.99987,
                0.00216809,
                0,
                0,
                0.999791,
                0.00221281,
                0,
                0.0000681487,
                0.999677,
                0.00227669,
                0,
                0.000658161,
                0.999521,
                0.00236533,
                0,
                0.00200635,
                0.999301,
                0.00248514,
                0,
                0.0041779,
                0.998977,
                0.00264185,
                0,
                0.00718648,
                0.998191,
                0.00281695,
                0,
                0.0110239,
                0.994801,
                0.00278518,
                0,
                0.015672,
                0.993091,
                0.00288774,
                0,
                0.0211091,
                0.991571,
                0.00303931,
                0,
                0.0273123,
                0.9897,
                0.00321643,
                0,
                0.034259,
                0.987023,
                0.00337332,
                0,
                0.0419282,
                0.983289,
                0.00346146,
                0,
                0.0502998,
                0.979892,
                0.00363704,
                0,
                0.0593562,
                0.975111,
                0.00373601,
                0,
                0.069081,
                0.970351,
                0.0038842,
                0,
                0.0794598,
                0.964131,
                0.00397053,
                0,
                0.0904798,
                0.957747,
                0.00408078,
                0,
                0.10213,
                0.949536,
                0.00413533,
                0,
                0.1144,
                0.941372,
                0.00420305,
                0,
                0.127284,
                0.931049,
                0.00422815,
                0,
                0.140772,
                0.920647,
                0.00425048,
                0,
                0.154862,
                0.908033,
                0.0042281,
                0,
                0.169548,
                0.895028,
                0.00422026,
                0,
                0.184828,
                0.879968,
                0.00415042,
                0,
                0.200701,
                0.864875,
                0.00408821,
                0,
                0.217167,
                0.84918,
                0.00400909,
                0,
                0.234227,
                0.834934,
                0.00391178,
                0,
                0.251884,
                0.821397,
                0.00380066,
                0,
                0.270141,
                0.807135,
                0.00367974,
                0,
                0.289004,
                0.792363,
                0.00355172,
                0,
                0.308479,
                0.776661,
                0.003411,
                0,
                0.328575,
                0.760705,
                0.00328123,
                0,
                0.349301,
                0.744408,
                0.00314003,
                0,
                0.370668,
                0.726994,
                0.0029906,
                0,
                0.392689,
                0.709598,
                0.00285034,
                0,
                0.415379,
                0.692112,
                0.00271179,
                0,
                0.438754,
                0.674435,
                0.00257185,
                0,
                0.46283,
                0.65676,
                0.00243425,
                0,
                0.48763,
                0.639982,
                0.00230351,
                0,
                0.513173,
                0.622983,
                0.0021777,
                0,
                0.539482,
                0.605471,
                0.00204991,
                0,
                0.566579,
                0.58796,
                0.00193759,
                0,
                0.594488,
                0.570463,
                0.00181976,
                0,
                0.623226,
                0.553058,
                0.00171497,
                0,
                0.6528,
                0.535894,
                0.00161109,
                0,
                0.683198,
                0.519089,
                0.00151394,
                0,
                0.714354,
                0.502454,
                0.00142122,
                0,
                0.746032,
                0.485681,
                0.00133488,
                0,
                0.777778,
                0.468935,
                0.00124975,
                0,
                0.809524,
                0.452951,
                0.00117309,
                0,
                0.84127,
                0.437139,
                0.00110155,
                0,
                0.873016,
                0.421446,
                0.00103124,
                0,
                0.904762,
                0.405951,
                0.000966387,
                0,
                0.936508,
                0.391003,
                0.000908119,
                0,
                0.968254,
                0.376198,
                0.000848057,
                0,
                1,
                1,
                0.00280076,
                0,
                0,
                1,
                0.00280078,
                0,
                0,
                0.999999,
                0.00280109,
                0,
                0,
                0.999997,
                0.00280246,
                0,
                0,
                0.999992,
                0.00280616,
                0,
                0,
                0.999979,
                0.00281396,
                0,
                0,
                0.999956,
                0.00282822,
                0,
                0,
                0.999916,
                0.00285186,
                0,
                0,
                0.999857,
                0.0028885,
                0,
                0,
                0.999768,
                0.00294259,
                0,
                0.000196026,
                0.999645,
                0.00301946,
                0,
                0.00104842,
                0.99947,
                0.00312541,
                0,
                0.00270199,
                0.999229,
                0.00326733,
                0,
                0.00519449,
                0.998852,
                0.00344992,
                0,
                0.00852602,
                0.997558,
                0.00361052,
                0,
                0.0126804,
                0.994417,
                0.0035898,
                0,
                0.017635,
                0.992824,
                0.00372393,
                0,
                0.023365,
                0.991344,
                0.00390695,
                0,
                0.0298456,
                0.989337,
                0.00410392,
                0,
                0.0370529,
                0.985811,
                0.00420987,
                0,
                0.0449651,
                0.982772,
                0.00437488,
                0,
                0.0535615,
                0.979001,
                0.00455069,
                0,
                0.0628243,
                0.974102,
                0.00464462,
                0,
                0.0727368,
                0.969197,
                0.00480577,
                0,
                0.0832844,
                0.962759,
                0.00487818,
                0,
                0.0944545,
                0.956207,
                0.00498176,
                0,
                0.106236,
                0.947909,
                0.00503392,
                0,
                0.118619,
                0.939596,
                0.00507474,
                0,
                0.131595,
                0.929642,
                0.00509798,
                0,
                0.145159,
                0.918807,
                0.00508476,
                0,
                0.159305,
                0.906921,
                0.00505634,
                0,
                0.174028,
                0.893312,
                0.00498845,
                0,
                0.189327,
                0.878933,
                0.0049133,
                0,
                0.2052,
                0.863986,
                0.0048259,
                0,
                0.221647,
                0.847936,
                0.00470848,
                0,
                0.23867,
                0.832253,
                0.00456889,
                0,
                0.25627,
                0.818619,
                0.00442726,
                0,
                0.274453,
                0.804788,
                0.00427677,
                0,
                0.293222,
                0.790241,
                0.00411906,
                0,
                0.312585,
                0.775162,
                0.00394833,
                0,
                0.33255,
                0.759463,
                0.00377366,
                0,
                0.353126,
                0.743598,
                0.00361026,
                0,
                0.374324,
                0.72697,
                0.00343627,
                0,
                0.396158,
                0.709646,
                0.00326422,
                0,
                0.418641,
                0.69277,
                0.00309717,
                0,
                0.44179,
                0.675371,
                0.0029356,
                0,
                0.465624,
                0.657863,
                0.00277712,
                0,
                0.490163,
                0.640772,
                0.00261738,
                0,
                0.515429,
                0.624441,
                0.0024737,
                0,
                0.541445,
                0.607497,
                0.00233125,
                0,
                0.568236,
                0.590438,
                0.00218994,
                0,
                0.595828,
                0.573224,
                0.0020664,
                0,
                0.624242,
                0.556168,
                0.00193526,
                0,
                0.653496,
                0.539232,
                0.00182463,
                0,
                0.683588,
                0.522352,
                0.00170735,
                0,
                0.714482,
                0.506172,
                0.00160555,
                0,
                0.746032,
                0.489842,
                0.00150451,
                0,
                0.777778,
                0.473463,
                0.00140938,
                0,
                0.809524,
                0.457266,
                0.00132568,
                0,
                0.84127,
                0.441609,
                0.0012376,
                0,
                0.873016,
                0.426348,
                0.00116265,
                0,
                0.904762,
                0.411002,
                0.00108935,
                0,
                0.936508,
                0.396045,
                0.00101946,
                0,
                0.968254,
                0.381448,
                0.000955665,
                0,
                1,
                1,
                0.0037121,
                0,
                0,
                1,
                0.00371213,
                0,
                0,
                1,
                0.00371251,
                0,
                0,
                0.999997,
                0.00371417,
                0,
                0,
                0.99999,
                0.00371863,
                0,
                0,
                0.999977,
                0.00372807,
                0,
                0,
                0.99995,
                0.00374529,
                0,
                0,
                0.999908,
                0.0037738,
                0,
                0,
                0.999843,
                0.00381789,
                0,
                0.0000123596,
                0.999745,
                0.00388273,
                0,
                0.000407442,
                0.999608,
                0.00397443,
                0,
                0.0015447,
                0.999415,
                0.00409998,
                0,
                0.00351385,
                0.999143,
                0.00426662,
                0,
                0.0063316,
                0.9987,
                0.00447625,
                0,
                0.00998679,
                0.996363,
                0.00455323,
                0,
                0.0144569,
                0.994021,
                0.00461052,
                0,
                0.0197151,
                0.992372,
                0.00476359,
                0,
                0.0257344,
                0.991007,
                0.00499101,
                0,
                0.0324882,
                0.988767,
                0.0051972,
                0,
                0.0399517,
                0.984872,
                0.00528407,
                0,
                0.0481022,
                0.982004,
                0.00548926,
                0,
                0.0569191,
                0.977714,
                0.00564385,
                0,
                0.0663839,
                0.973076,
                0.0057693,
                0,
                0.0764801,
                0.967565,
                0.0058924,
                0,
                0.0871928,
                0.961384,
                0.00599629,
                0,
                0.0985095,
                0.954435,
                0.00605998,
                0,
                0.110419,
                0.946303,
                0.0061133,
                0,
                0.122912,
                0.937662,
                0.00612028,
                0,
                0.13598,
                0.927867,
                0.00612209,
                0,
                0.149617,
                0.916475,
                0.00604813,
                0,
                0.163817,
                0.90541,
                0.00603088,
                0,
                0.178577,
                0.891591,
                0.00592218,
                0,
                0.193894,
                0.877573,
                0.00578854,
                0,
                0.209767,
                0.862511,
                0.00566648,
                0,
                0.226196,
                0.846861,
                0.00551481,
                0,
                0.243182,
                0.83068,
                0.00533754,
                0,
                0.260728,
                0.815725,
                0.00515487,
                0,
                0.278837,
                0.802321,
                0.0049655,
                0,
                0.297515,
                0.787826,
                0.00475421,
                0,
                0.316768,
                0.773454,
                0.00456002,
                0,
                0.336605,
                0.758224,
                0.00434727,
                0,
                0.357034,
                0.74265,
                0.00414444,
                0,
                0.378067,
                0.726729,
                0.00393738,
                0,
                0.399717,
                0.710155,
                0.00373575,
                0,
                0.421998,
                0.693312,
                0.00353736,
                0,
                0.444928,
                0.67653,
                0.00334368,
                0,
                0.468523,
                0.659444,
                0.00315981,
                0,
                0.492806,
                0.642051,
                0.00297809,
                0,
                0.517798,
                0.625758,
                0.00280592,
                0,
                0.543525,
                0.609615,
                0.00264254,
                0,
                0.570012,
                0.592919,
                0.00248459,
                0,
                0.597288,
                0.576298,
                0.00233327,
                0,
                0.625379,
                0.559489,
                0.00219519,
                0,
                0.654307,
                0.542891,
                0.00205441,
                0,
                0.684084,
                0.526255,
                0.00193385,
                0,
                0.714693,
                0.509853,
                0.00180745,
                0,
                0.746044,
                0.494131,
                0.00169817,
                0,
                0.777778,
                0.478114,
                0.0015913,
                0,
                0.809524,
                0.462274,
                0.00148981,
                0,
                0.84127,
                0.446412,
                0.00139537,
                0,
                0.873016,
                0.431274,
                0.00130984,
                0,
                0.904762,
                0.41635,
                0.00122403,
                0,
                0.936508,
                0.401476,
                0.00114809,
                0,
                0.968254,
                0.386993,
                0.00107563,
                0,
                1,
                1,
                0.00488216,
                0,
                0,
                1,
                0.0048822,
                0,
                0,
                1,
                0.00488265,
                0,
                0,
                0.999997,
                0.00488463,
                0,
                0,
                0.999988,
                0.00488999,
                0,
                0,
                0.999974,
                0.00490129,
                0,
                0,
                0.999946,
                0.00492191,
                0,
                0,
                0.999897,
                0.00495598,
                0,
                0,
                0.999825,
                0.00500855,
                0,
                0.0000744791,
                0.999718,
                0.00508559,
                0,
                0.000712744,
                0.999565,
                0.005194,
                0,
                0.00215249,
                0.999352,
                0.00534147,
                0,
                0.00444576,
                0.999046,
                0.00553523,
                0,
                0.00759218,
                0.998492,
                0.00577016,
                0,
                0.0115714,
                0.995564,
                0.00578487,
                0,
                0.0163557,
                0.993339,
                0.00586414,
                0,
                0.021915,
                0.991834,
                0.00606002,
                0,
                0.0282201,
                0.990496,
                0.00633312,
                0,
                0.0352433,
                0.987826,
                0.00651941,
                0,
                0.042959,
                0.98383,
                0.00660842,
                0,
                0.0513439,
                0.98109,
                0.00685523,
                0,
                0.0603772,
                0.976131,
                0.00695778,
                0,
                0.0700402,
                0.971922,
                0.00714236,
                0,
                0.0803163,
                0.965901,
                0.00721437,
                0,
                0.0911908,
                0.959606,
                0.00732017,
                0,
                0.102651,
                0.952504,
                0.00735788,
                0,
                0.114686,
                0.944365,
                0.00738493,
                0,
                0.127286,
                0.935652,
                0.00737969,
                0,
                0.140443,
                0.925813,
                0.00733612,
                0,
                0.154151,
                0.914397,
                0.00723094,
                0,
                0.168405,
                0.903257,
                0.00714002,
                0,
                0.183201,
                0.890015,
                0.00700149,
                0,
                0.198536,
                0.876014,
                0.00682813,
                0,
                0.214409,
                0.861436,
                0.00665567,
                0,
                0.23082,
                0.845752,
                0.00644526,
                0,
                0.24777,
                0.829169,
                0.00621635,
                0,
                0.265263,
                0.813435,
                0.00597789,
                0,
                0.283301,
                0.799701,
                0.00575694,
                0,
                0.301889,
                0.785726,
                0.00549866,
                0,
                0.321035,
                0.77152,
                0.0052503,
                0,
                0.340746,
                0.75683,
                0.00499619,
                0,
                0.361032,
                0.741951,
                0.0047543,
                0,
                0.381904,
                0.726367,
                0.0045084,
                0,
                0.403374,
                0.710537,
                0.00426784,
                0,
                0.425457,
                0.693965,
                0.00403487,
                0,
                0.448169,
                0.677724,
                0.0038075,
                0,
                0.47153,
                0.66117,
                0.00359431,
                0,
                0.495561,
                0.644274,
                0.00338354,
                0,
                0.520284,
                0.627449,
                0.00318163,
                0,
                0.545725,
                0.611645,
                0.00299672,
                0,
                0.571911,
                0.595614,
                0.00281016,
                0,
                0.598873,
                0.579426,
                0.00264252,
                0,
                0.62664,
                0.563016,
                0.00247509,
                0,
                0.655239,
                0.546728,
                0.00232647,
                0,
                0.684692,
                0.530539,
                0.00217803,
                0,
                0.714999,
                0.514164,
                0.00204216,
                0,
                0.746106,
                0.498344,
                0.00191403,
                0,
                0.777778,
                0.482957,
                0.00179203,
                0,
                0.809524,
                0.467336,
                0.00167695,
                0,
                0.84127,
                0.451994,
                0.00157567,
                0,
                0.873016,
                0.436514,
                0.00147113,
                0,
                0.904762,
                0.42178,
                0.00138034,
                0,
                0.936508,
                0.407271,
                0.00129219,
                0,
                0.968254,
                0.392822,
                0.0012098,
                0,
                1,
                1,
                0.00637427,
                0,
                0,
                1,
                0.00637431,
                0,
                0,
                0.999999,
                0.00637485,
                0,
                0,
                0.999996,
                0.00637721,
                0,
                0,
                0.999987,
                0.00638357,
                0,
                0,
                0.999971,
                0.006397,
                0,
                0,
                0.999939,
                0.00642142,
                0,
                0,
                0.999888,
                0.00646177,
                0,
                0,
                0.999807,
                0.00652387,
                0,
                0.000207916,
                0.999689,
                0.00661454,
                0,
                0.00112051,
                0.99952,
                0.00674155,
                0,
                0.00287719,
                0.999283,
                0.00691313,
                0,
                0.00550145,
                0.998936,
                0.00713598,
                0,
                0.00897928,
                0.998165,
                0.00738501,
                0,
                0.0132829,
                0.994847,
                0.00734388,
                0,
                0.01838,
                0.993182,
                0.00749991,
                0,
                0.0242381,
                0.991665,
                0.0077246,
                0,
                0.030826,
                0.989708,
                0.00797579,
                0,
                0.0381152,
                0.986663,
                0.00813011,
                0,
                0.0460794,
                0.983288,
                0.00830365,
                0,
                0.0546951,
                0.980104,
                0.00853496,
                0,
                0.0639411,
                0.974855,
                0.00861045,
                0,
                0.0737988,
                0.97045,
                0.00879133,
                0,
                0.0842516,
                0.964509,
                0.00886377,
                0,
                0.0952848,
                0.957594,
                0.00890346,
                0,
                0.106886,
                0.950546,
                0.00893289,
                0,
                0.119044,
                0.942225,
                0.00890074,
                0,
                0.131749,
                0.933365,
                0.00886826,
                0,
                0.144994,
                0.923202,
                0.0087316,
                0,
                0.158772,
                0.912605,
                0.00863082,
                0,
                0.173078,
                0.901099,
                0.00847403,
                0,
                0.187908,
                0.888177,
                0.00825838,
                0,
                0.203261,
                0.873955,
                0.00801834,
                0,
                0.219134,
                0.860091,
                0.00779026,
                0,
                0.235527,
                0.84434,
                0.00752478,
                0,
                0.252443,
                0.828517,
                0.00724074,
                0,
                0.269883,
                0.81239,
                0.00693769,
                0,
                0.287851,
                0.79721,
                0.00664817,
                0,
                0.306352,
                0.783489,
                0.00634763,
                0,
                0.325393,
                0.769514,
                0.00604221,
                0,
                0.344981,
                0.755419,
                0.00573568,
                0,
                0.365126,
                0.741083,
                0.00544359,
                0,
                0.385839,
                0.726059,
                0.00515515,
                0,
                0.407132,
                0.710809,
                0.00487139,
                0,
                0.42902,
                0.695052,
                0.00459846,
                0,
                0.45152,
                0.678886,
                0.00433412,
                0,
                0.474651,
                0.663042,
                0.00407981,
                0,
                0.498433,
                0.646634,
                0.00384264,
                0,
                0.52289,
                0.630117,
                0.00360897,
                0,
                0.548048,
                0.613804,
                0.00338863,
                0,
                0.573936,
                0.598338,
                0.00318486,
                0,
                0.600584,
                0.582687,
                0.00298377,
                0,
                0.628027,
                0.566809,
                0.00280082,
                0,
                0.656295,
                0.550817,
                0.00262255,
                0,
                0.685417,
                0.534937,
                0.00245835,
                0,
                0.715406,
                0.519151,
                0.00230574,
                0,
                0.74624,
                0.503118,
                0.0021549,
                0,
                0.777778,
                0.487723,
                0.00202008,
                0,
                0.809524,
                0.472725,
                0.00189355,
                0,
                0.84127,
                0.457599,
                0.00177108,
                0,
                0.873016,
                0.442558,
                0.00165843,
                0,
                0.904762,
                0.427624,
                0.00155494,
                0,
                0.936508,
                0.413171,
                0.00145273,
                0,
                0.968254,
                0.399122,
                0.00136454,
                0,
                1,
                1,
                0.00826496,
                0,
                0,
                1,
                0.00826499,
                0,
                0,
                1,
                0.00826564,
                0,
                0,
                0.999996,
                0.00826842,
                0,
                0,
                0.999987,
                0.00827589,
                0,
                0,
                0.999967,
                0.00829167,
                0,
                0,
                0.999933,
                0.00832037,
                0,
                0,
                0.999876,
                0.00836768,
                0,
                0.0000109338,
                0.999786,
                0.00844031,
                0,
                0.000427145,
                0.999655,
                0.00854603,
                0,
                0.0016384,
                0.999468,
                0.00869337,
                0,
                0.00372392,
                0.999203,
                0.008891,
                0,
                0.00668513,
                0.998803,
                0.00914387,
                0,
                0.0104968,
                0.99748,
                0.00935838,
                0,
                0.015125,
                0.994446,
                0.00933309,
                0,
                0.0205338,
                0.99292,
                0.00953084,
                0,
                0.0266884,
                0.991414,
                0.0097893,
                0,
                0.0335565,
                0.989049,
                0.0100228,
                0,
                0.0411086,
                0.98582,
                0.0101664,
                0,
                0.0493181,
                0.982441,
                0.0103582,
                0,
                0.0581613,
                0.978595,
                0.0105292,
                0,
                0.0676169,
                0.973495,
                0.0106274,
                0,
                0.0776661,
                0.968405,
                0.0107261,
                0,
                0.0882926,
                0.962717,
                0.0108234,
                0,
                0.0994817,
                0.955478,
                0.0108102,
                0,
                0.111221,
                0.948275,
                0.0107914,
                0,
                0.123499,
                0.940006,
                0.0107161,
                0,
                0.136308,
                0.930831,
                0.0106309,
                0,
                0.149639,
                0.920648,
                0.0104083,
                0,
                0.163485,
                0.910205,
                0.0102312,
                0,
                0.177843,
                0.898445,
                0.0100051,
                0,
                0.192707,
                0.885986,
                0.00971928,
                0,
                0.208077,
                0.872204,
                0.00940747,
                0,
                0.22395,
                0.858436,
                0.0091085,
                0,
                0.240326,
                0.843454,
                0.00876595,
                0,
                0.257208,
                0.827437,
                0.00839794,
                0,
                0.274596,
                0.811488,
                0.00803692,
                0,
                0.292496,
                0.796039,
                0.00767352,
                0,
                0.310911,
                0.781083,
                0.0073097,
                0,
                0.329849,
                0.767642,
                0.00694032,
                0,
                0.349316,
                0.753901,
                0.00657476,
                0,
                0.369323,
                0.740131,
                0.00622699,
                0,
                0.38988,
                0.725845,
                0.0058838,
                0,
                0.410999,
                0.710991,
                0.00555586,
                0,
                0.432696,
                0.696002,
                0.00523089,
                0,
                0.454987,
                0.680461,
                0.00492494,
                0,
                0.47789,
                0.664875,
                0.00463464,
                0,
                0.501426,
                0.649273,
                0.00435422,
                0,
                0.52562,
                0.63302,
                0.0040875,
                0,
                0.550498,
                0.61705,
                0.00384075,
                0,
                0.576089,
                0.601154,
                0.00359557,
                0,
                0.602427,
                0.586008,
                0.00337636,
                0,
                0.629544,
                0.570699,
                0.00316019,
                0,
                0.657479,
                0.555166,
                0.00296033,
                0,
                0.686264,
                0.539645,
                0.00277552,
                0,
                0.715924,
                0.524159,
                0.00259499,
                0,
                0.746459,
                0.508682,
                0.00243257,
                0,
                0.777789,
                0.493163,
                0.00227851,
                0,
                0.809524,
                0.478004,
                0.00213083,
                0,
                0.84127,
                0.46347,
                0.00199502,
                0,
                0.873016,
                0.448778,
                0.00186967,
                0,
                0.904762,
                0.434105,
                0.00174732,
                0,
                0.936508,
                0.419576,
                0.00163861,
                0,
                0.968254,
                0.405541,
                0.00153341,
                0,
                1,
                1,
                0.0106462,
                0,
                0,
                1,
                0.0106462,
                0,
                0,
                0.999999,
                0.010647,
                0,
                0,
                0.999995,
                0.0106502,
                0,
                0,
                0.999985,
                0.0106589,
                0,
                0,
                0.999964,
                0.0106773,
                0,
                0,
                0.999925,
                0.0107106,
                0,
                0,
                0.999861,
                0.0107655,
                0,
                0.0000712986,
                0.999763,
                0.0108497,
                0,
                0.000743959,
                0.999616,
                0.0109716,
                0,
                0.00227361,
                0.999408,
                0.0111408,
                0,
                0.0046983,
                0.999112,
                0.0113659,
                0,
                0.00800158,
                0.998637,
                0.0116475,
                0,
                0.0121493,
                0.996223,
                0.0117231,
                0,
                0.0171023,
                0.994006,
                0.0118064,
                0,
                0.0228218,
                0.992444,
                0.0120254,
                0,
                0.0292711,
                0.991028,
                0.0123314,
                0,
                0.036417,
                0.98803,
                0.0124954,
                0,
                0.0442295,
                0.984816,
                0.0126538,
                0,
                0.0526815,
                0.981399,
                0.0128537,
                0,
                0.0617492,
                0.977085,
                0.0129694,
                0,
                0.0714114,
                0.972154,
                0.013091,
                0,
                0.0816495,
                0.966617,
                0.0131166,
                0,
                0.0924472,
                0.960628,
                0.0131583,
                0,
                0.10379,
                0.953295,
                0.0131094,
                0,
                0.115665,
                0.94575,
                0.0129966,
                0,
                0.128062,
                0.937654,
                0.0128796,
                0,
                0.140972,
                0.927716,
                0.0126477,
                0,
                0.154387,
                0.917932,
                0.0123889,
                0,
                0.168301,
                0.907719,
                0.012131,
                0,
                0.182709,
                0.89584,
                0.0118013,
                0,
                0.197608,
                0.883526,
                0.0114145,
                0,
                0.212994,
                0.870301,
                0.0110075,
                0,
                0.228867,
                0.856272,
                0.0106019,
                0,
                0.245227,
                0.842251,
                0.0101938,
                0,
                0.262074,
                0.826466,
                0.00973254,
                0,
                0.279412,
                0.810859,
                0.0092846,
                0,
                0.297244,
                0.795051,
                0.00883304,
                0,
                0.315575,
                0.780053,
                0.00840272,
                0,
                0.334412,
                0.76575,
                0.00796438,
                0,
                0.35376,
                0.752298,
                0.00752526,
                0,
                0.373631,
                0.739153,
                0.00711486,
                0,
                0.394034,
                0.725514,
                0.00670361,
                0,
                0.414983,
                0.711473,
                0.00632656,
                0,
                0.436491,
                0.696936,
                0.00595206,
                0,
                0.458575,
                0.682126,
                0.00559191,
                0,
                0.481253,
                0.667027,
                0.00525362,
                0,
                0.504547,
                0.651875,
                0.00493805,
                0,
                0.528481,
                0.636463,
                0.00462848,
                0,
                0.553081,
                0.620641,
                0.00433936,
                0,
                0.578377,
                0.604931,
                0.00407,
                0,
                0.604404,
                0.589549,
                0.00380864,
                0,
                0.631197,
                0.574712,
                0.00357049,
                0,
                0.658795,
                0.559775,
                0.00334466,
                0,
                0.687238,
                0.544514,
                0.00312505,
                0,
                0.716559,
                0.529555,
                0.00293199,
                0,
                0.746776,
                0.514402,
                0.00274204,
                0,
                0.777849,
                0.499302,
                0.00256647,
                0,
                0.809524,
                0.484114,
                0.00239901,
                0,
                0.84127,
                0.469308,
                0.00225148,
                0,
                0.873016,
                0.455133,
                0.00210178,
                0,
                0.904762,
                0.440939,
                0.0019727,
                0,
                0.936508,
                0.426627,
                0.00184382,
                0,
                0.968254,
                0.412509,
                0.00172548,
                0,
                1,
                1,
                0.013628,
                0,
                0,
                1,
                0.0136281,
                0,
                0,
                0.999999,
                0.0136289,
                0,
                0,
                0.999995,
                0.0136327,
                0,
                0,
                0.999983,
                0.0136427,
                0,
                0,
                0.99996,
                0.0136638,
                0,
                0,
                0.999917,
                0.0137022,
                0,
                0,
                0.999846,
                0.0137652,
                0,
                0.000204597,
                0.999736,
                0.0138615,
                0,
                0.00116837,
                0.999573,
                0.0140007,
                0,
                0.00303325,
                0.99934,
                0.0141927,
                0,
                0.00580613,
                0.999004,
                0.0144457,
                0,
                0.00945626,
                0.998407,
                0.0147489,
                0,
                0.0139421,
                0.995464,
                0.014731,
                0,
                0.0192202,
                0.993328,
                0.0148283,
                0,
                0.0252495,
                0.991799,
                0.0150797,
                0,
                0.0319921,
                0.990397,
                0.0154316,
                0,
                0.0394138,
                0.986835,
                0.0155005,
                0,
                0.0474843,
                0.983938,
                0.0157308,
                0,
                0.0561763,
                0.980154,
                0.0158753,
                0,
                0.0654661,
                0.975659,
                0.0159581,
                0,
                0.0753326,
                0.970171,
                0.0159832,
                0,
                0.0857571,
                0.964803,
                0.0160084,
                0,
                0.0967236,
                0.958366,
                0.0159484,
                0,
                0.108218,
                0.950613,
                0.0158001,
                0,
                0.120227,
                0.942874,
                0.0155845,
                0,
                0.132741,
                0.935005,
                0.0154292,
                0,
                0.145751,
                0.924991,
                0.0150742,
                0,
                0.159249,
                0.914814,
                0.0146757,
                0,
                0.17323,
                0.904743,
                0.0143097,
                0,
                0.187687,
                0.893216,
                0.0138695,
                0,
                0.202619,
                0.880769,
                0.0133706,
                0,
                0.218021,
                0.868136,
                0.0128606,
                0,
                0.233894,
                0.85469,
                0.0123403,
                0,
                0.250238,
                0.840593,
                0.0118091,
                0,
                0.267052,
                0.825808,
                0.011253,
                0,
                0.284341,
                0.81009,
                0.0107099,
                0,
                0.302106,
                0.79504,
                0.0101636,
                0,
                0.320354,
                0.779757,
                0.00964041,
                0,
                0.33909,
                0.764697,
                0.00911896,
                0,
                0.358322,
                0.750913,
                0.00859533,
                0,
                0.378059,
                0.738175,
                0.00811592,
                0,
                0.398311,
                0.725242,
                0.00764504,
                0,
                0.41909,
                0.711864,
                0.00718885,
                0,
                0.440412,
                0.698009,
                0.00675843,
                0,
                0.462292,
                0.683841,
                0.00634984,
                0,
                0.484748,
                0.669391,
                0.00595502,
                0,
                0.507802,
                0.654731,
                0.00558671,
                0,
                0.531477,
                0.639805,
                0.00523578,
                0,
                0.555802,
                0.624789,
                0.00490834,
                0,
                0.580805,
                0.609325,
                0.00459448,
                0,
                0.606522,
                0.593975,
                0.00430342,
                0,
                0.63299,
                0.578983,
                0.00403019,
                0,
                0.66025,
                0.564442,
                0.0037707,
                0,
                0.688346,
                0.549835,
                0.0035316,
                0,
                0.717319,
                0.535039,
                0.00330255,
                0,
                0.7472,
                0.520403,
                0.00308932,
                0,
                0.777982,
                0.505687,
                0.00289335,
                0,
                0.809524,
                0.490939,
                0.00270818,
                0,
                0.84127,
                0.476233,
                0.0025343,
                0,
                0.873016,
                0.461624,
                0.00237097,
                0,
                0.904762,
                0.447833,
                0.00222065,
                0,
                0.936508,
                0.433992,
                0.00207561,
                0,
                0.968254,
                0.420147,
                0.00194955,
                0,
                1,
                1,
                0.0173415,
                0,
                0,
                1,
                0.0173416,
                0,
                0,
                0.999999,
                0.0173426,
                0,
                0,
                0.999995,
                0.0173468,
                0,
                0,
                0.999983,
                0.0173582,
                0,
                0,
                0.999954,
                0.0173822,
                0,
                0,
                0.999908,
                0.0174258,
                0,
                0.00000669501,
                0.999828,
                0.0174973,
                0,
                0.000427399,
                0.999705,
                0.0176063,
                0,
                0.00171019,
                0.999524,
                0.0177631,
                0,
                0.0039248,
                0.999263,
                0.0179781,
                0,
                0.00705382,
                0.998878,
                0.018258,
                0,
                0.0110552,
                0.998012,
                0.0185551,
                0,
                0.0158812,
                0.994614,
                0.0184264,
                0,
                0.0214852,
                0.993132,
                0.0186385,
                0,
                0.0278239,
                0.991563,
                0.0189067,
                0,
                0.0348585,
                0.989298,
                0.0191577,
                0,
                0.0425544,
                0.986036,
                0.0192522,
                0,
                0.050881,
                0.982558,
                0.0194063,
                0,
                0.059811,
                0.978531,
                0.019486,
                0,
                0.0693209,
                0.974198,
                0.0195847,
                0,
                0.0793895,
                0.968148,
                0.0194749,
                0,
                0.0899984,
                0.962565,
                0.0194277,
                0,
                0.101132,
                0.956041,
                0.0192991,
                0,
                0.112775,
                0.947749,
                0.0189893,
                0,
                0.124917,
                0.94018,
                0.018704,
                0,
                0.137547,
                0.93165,
                0.0183458,
                0,
                0.150655,
                0.921798,
                0.0178775,
                0,
                0.164236,
                0.911573,
                0.0173618,
                0,
                0.178281,
                0.901569,
                0.0168482,
                0,
                0.192788,
                0.890341,
                0.016265,
                0,
                0.207752,
                0.877835,
                0.0156199,
                0,
                0.223171,
                0.865472,
                0.0149516,
                0,
                0.239044,
                0.852905,
                0.0143274,
                0,
                0.255371,
                0.838906,
                0.0136643,
                0,
                0.272153,
                0.824888,
                0.0129903,
                0,
                0.289393,
                0.809977,
                0.0123218,
                0,
                0.307093,
                0.794697,
                0.0116572,
                0,
                0.325259,
                0.780028,
                0.0110307,
                0,
                0.343896,
                0.765124,
                0.0104236,
                0,
                0.363012,
                0.750411,
                0.0098219,
                0,
                0.382617,
                0.737264,
                0.00924397,
                0,
                0.402719,
                0.724799,
                0.00868719,
                0,
                0.423332,
                0.712253,
                0.00816476,
                0,
                0.444469,
                0.699267,
                0.00767262,
                0,
                0.466146,
                0.685618,
                0.00719746,
                0,
                0.488383,
                0.671736,
                0.00673916,
                0,
                0.511199,
                0.657777,
                0.00631937,
                0,
                0.534618,
                0.643497,
                0.00592411,
                0,
                0.558668,
                0.62889,
                0.00553928,
                0,
                0.58338,
                0.614299,
                0.0051934,
                0,
                0.608787,
                0.599197,
                0.00485985,
                0,
                0.634929,
                0.584175,
                0.00454357,
                0,
                0.661849,
                0.569541,
                0.00425787,
                0,
                0.689594,
                0.555193,
                0.00397905,
                0,
                0.718211,
                0.540947,
                0.00372364,
                0,
                0.747742,
                0.526593,
                0.00348599,
                0,
                0.778205,
                0.512335,
                0.00326103,
                0,
                0.80953,
                0.498017,
                0.00305137,
                0,
                0.84127,
                0.483609,
                0.00285485,
                0,
                0.873016,
                0.469368,
                0.00267472,
                0,
                0.904762,
                0.455037,
                0.00249945,
                0,
                0.936508,
                0.441493,
                0.00234792,
                0,
                0.968254,
                0.428147,
                0.00219936,
                0,
                1,
                1,
                0.0219422,
                0,
                0,
                1,
                0.0219423,
                0,
                0,
                0.999998,
                0.0219434,
                0,
                0,
                0.999993,
                0.0219481,
                0,
                0,
                0.999981,
                0.021961,
                0,
                0,
                0.999949,
                0.0219879,
                0,
                0,
                0.999896,
                0.0220367,
                0,
                0.0000593194,
                0.999808,
                0.0221167,
                0,
                0.00075364,
                0.99967,
                0.0222383,
                0,
                0.00237884,
                0.999466,
                0.0224125,
                0,
                0.00495612,
                0.999174,
                0.0226495,
                0,
                0.00844887,
                0.998725,
                0.0229525,
                0,
                0.0128058,
                0.996979,
                0.0231123,
                0,
                0.0179742,
                0.994317,
                0.0230742,
                0,
                0.0239047,
                0.992781,
                0.0232895,
                0,
                0.0305526,
                0.991191,
                0.0235734,
                0,
                0.0378786,
                0.987787,
                0.0236152,
                0,
                0.0458475,
                0.985092,
                0.0237994,
                0,
                0.0544287,
                0.981121,
                0.0238553,
                0,
                0.0635952,
                0.976924,
                0.0238706,
                0,
                0.0733233,
                0.97218,
                0.0238704,
                0,
                0.0835922,
                0.965956,
                0.0236598,
                0,
                0.0943839,
                0.959998,
                0.0234735,
                0,
                0.105682,
                0.953245,
                0.0232277,
                0,
                0.117474,
                0.944445,
                0.0226973,
                0,
                0.129747,
                0.937087,
                0.0223527,
                0,
                0.142491,
                0.928341,
                0.0218144,
                0,
                0.155697,
                0.9184,
                0.0211516,
                0,
                0.169358,
                0.907959,
                0.0204553,
                0,
                0.183469,
                0.89808,
                0.0197673,
                0,
                0.198024,
                0.887047,
                0.0189915,
                0,
                0.21302,
                0.875221,
                0.0182082,
                0,
                0.228455,
                0.86269,
                0.0173584,
                0,
                0.244329,
                0.850735,
                0.0165718,
                0,
                0.260639,
                0.837545,
                0.0157524,
                0,
                0.277389,
                0.823639,
                0.0149482,
                0,
                0.29458,
                0.809699,
                0.0141431,
                0,
                0.312216,
                0.794797,
                0.0133527,
                0,
                0.3303,
                0.780578,
                0.0126193,
                0,
                0.34884,
                0.766019,
                0.0118914,
                0,
                0.367842,
                0.751447,
                0.0111839,
                0,
                0.387315,
                0.737275,
                0.010514,
                0,
                0.40727,
                0.724545,
                0.00987277,
                0,
                0.427717,
                0.712644,
                0.00926569,
                0,
                0.448671,
                0.700432,
                0.00869029,
                0,
                0.470149,
                0.687664,
                0.00814691,
                0,
                0.492167,
                0.674288,
                0.00763012,
                0,
                0.514746,
                0.660966,
                0.00714437,
                0,
                0.537911,
                0.647264,
                0.00668457,
                0,
                0.561688,
                0.633431,
                0.00626581,
                0,
                0.586108,
                0.619133,
                0.00585593,
                0,
                0.611206,
                0.604935,
                0.00548188,
                0,
                0.637022,
                0.590236,
                0.00513288,
                0,
                0.663599,
                0.575473,
                0.0047906,
                0,
                0.690989,
                0.561228,
                0.00448895,
                0,
                0.719242,
                0.547054,
                0.00420233,
                0,
                0.748411,
                0.533175,
                0.00392869,
                0,
                0.778531,
                0.519163,
                0.00367445,
                0,
                0.809583,
                0.505328,
                0.00344097,
                0,
                0.84127,
                0.491446,
                0.00322003,
                0,
                0.873016,
                0.477356,
                0.00301283,
                0,
                0.904762,
                0.46356,
                0.00282592,
                0,
                0.936508,
                0.449623,
                0.00264956,
                0,
                0.968254,
                0.436068,
                0.00246956,
                0,
                1,
                1,
                0.0276135,
                0,
                0,
                1,
                0.0276136,
                0,
                0,
                0.999998,
                0.0276148,
                0,
                0,
                0.999993,
                0.0276201,
                0,
                0,
                0.999976,
                0.0276342,
                0,
                0,
                0.999945,
                0.027664,
                0,
                0,
                0.999884,
                0.0277179,
                0,
                0.00018679,
                0.999784,
                0.027806,
                0,
                0.00119607,
                0.99963,
                0.0279394,
                0,
                0.00318407,
                0.999401,
                0.0281295,
                0,
                0.00613601,
                0.999066,
                0.0283858,
                0,
                0.00999963,
                0.998524,
                0.0287027,
                0,
                0.0147164,
                0.995702,
                0.0286256,
                0,
                0.0202295,
                0.993593,
                0.0286733,
                0,
                0.0264876,
                0.992067,
                0.0288989,
                0,
                0.0334452,
                0.990548,
                0.0292135,
                0,
                0.0410621,
                0.986775,
                0.0291296,
                0,
                0.0493032,
                0.984054,
                0.0293099,
                0,
                0.0581381,
                0.979481,
                0.0291881,
                0,
                0.0675397,
                0.975297,
                0.0291598,
                0,
                0.0774848,
                0.96981,
                0.028954,
                0,
                0.0879528,
                0.963524,
                0.028628,
                0,
                0.0989258,
                0.957398,
                0.0283135,
                0,
                0.110388,
                0.950088,
                0.0278469,
                0,
                0.122327,
                0.941538,
                0.0271798,
                0,
                0.134729,
                0.933332,
                0.0265388,
                0,
                0.147587,
                0.924392,
                0.0257776,
                0,
                0.160889,
                0.914581,
                0.024916,
                0,
                0.174631,
                0.904347,
                0.0240242,
                0,
                0.188806,
                0.894324,
                0.0231229,
                0,
                0.203409,
                0.883724,
                0.022153,
                0,
                0.218437,
                0.872207,
                0.0211355,
                0,
                0.233888,
                0.859927,
                0.0201048,
                0,
                0.249761,
                0.848373,
                0.0191263,
                0,
                0.266056,
                0.836023,
                0.0181306,
                0,
                0.282774,
                0.82289,
                0.0171718,
                0,
                0.299917,
                0.809324,
                0.0162196,
                0,
                0.317488,
                0.795361,
                0.0152622,
                0,
                0.335493,
                0.781253,
                0.01439,
                0,
                0.353936,
                0.767338,
                0.013533,
                0,
                0.372825,
                0.753156,
                0.0127244,
                0,
                0.392168,
                0.739122,
                0.0119454,
                0,
                0.411976,
                0.725358,
                0.0112054,
                0,
                0.432259,
                0.712949,
                0.010487,
                0,
                0.453032,
                0.701621,
                0.00984032,
                0,
                0.47431,
                0.689703,
                0.00921495,
                0,
                0.496111,
                0.677216,
                0.00862492,
                0,
                0.518456,
                0.664217,
                0.00806882,
                0,
                0.541367,
                0.65137,
                0.00755922,
                0,
                0.564872,
                0.638,
                0.00705705,
                0,
                0.589001,
                0.62453,
                0.00661266,
                0,
                0.613789,
                0.610601,
                0.00618432,
                0,
                0.639277,
                0.59676,
                0.00578033,
                0,
                0.66551,
                0.582433,
                0.00540927,
                0,
                0.692539,
                0.568026,
                0.00506104,
                0,
                0.720422,
                0.55414,
                0.0047353,
                0,
                0.749216,
                0.540178,
                0.00442889,
                0,
                0.778974,
                0.526513,
                0.00414363,
                0,
                0.809711,
                0.512954,
                0.00388237,
                0,
                0.84127,
                0.499403,
                0.00362875,
                0,
                0.873016,
                0.486026,
                0.00340827,
                0,
                0.904762,
                0.472345,
                0.00318598,
                0,
                0.936508,
                0.458828,
                0.00297635,
                0,
                0.968254,
                0.445379,
                0.00279447,
                0,
                1,
                1,
                0.0345716,
                0,
                0,
                1,
                0.0345717,
                0,
                0,
                0.999999,
                0.034573,
                0,
                0,
                0.999991,
                0.0345787,
                0,
                0,
                0.999974,
                0.0345941,
                0,
                0,
                0.999937,
                0.0346263,
                0,
                0.00000188589,
                0.999869,
                0.0346847,
                0,
                0.000409238,
                0.999757,
                0.0347798,
                0,
                0.0017674,
                0.999582,
                0.0349233,
                0,
                0.00413658,
                0.999322,
                0.0351265,
                0,
                0.00747408,
                0.998939,
                0.0353967,
                0,
                0.0117157,
                0.998219,
                0.0357018,
                0,
                0.0167966,
                0.994974,
                0.0354726,
                0,
                0.0226572,
                0.993201,
                0.0355621,
                0,
                0.0292445,
                0.991573,
                0.0357641,
                0,
                0.0365123,
                0.989301,
                0.0359252,
                0,
                0.0444203,
                0.985712,
                0.0358017,
                0,
                0.0529334,
                0.982411,
                0.0358353,
                0,
                0.0620214,
                0.977827,
                0.035617,
                0,
                0.0716574,
                0.973278,
                0.0354398,
                0,
                0.0818186,
                0.967397,
                0.0350483,
                0,
                0.0924846,
                0.960696,
                0.0344795,
                0,
                0.103638,
                0.954349,
                0.0339861,
                0,
                0.115263,
                0.946066,
                0.0331323,
                0,
                0.127348,
                0.938012,
                0.032359,
                0,
                0.13988,
                0.929413,
                0.0314413,
                0,
                0.152849,
                0.920355,
                0.0304103,
                0,
                0.166248,
                0.910586,
                0.0292785,
                0,
                0.18007,
                0.900609,
                0.0281391,
                0,
                0.194308,
                0.890093,
                0.0269103,
                0,
                0.208958,
                0.880013,
                0.0257269,
                0,
                0.224018,
                0.869001,
                0.0244671,
                0,
                0.239485,
                0.85751,
                0.0232252,
                0,
                0.255359,
                0.84582,
                0.0220117,
                0,
                0.271638,
                0.834383,
                0.0208274,
                0,
                0.288324,
                0.822158,
                0.0196628,
                0,
                0.305419,
                0.809056,
                0.0185306,
                0,
                0.322927,
                0.795832,
                0.0174174,
                0,
                0.340851,
                0.782547,
                0.0163758,
                0,
                0.359199,
                0.7689,
                0.015391,
                0,
                0.377975,
                0.755526,
                0.0144488,
                0,
                0.397189,
                0.741681,
                0.0135372,
                0,
                0.416851,
                0.728178,
                0.0126957,
                0,
                0.436971,
                0.714642,
                0.0118812,
                0,
                0.457564,
                0.702756,
                0.0111165,
                0,
                0.478644,
                0.69175,
                0.0104145,
                0,
                0.500229,
                0.680159,
                0.00974439,
                0,
                0.522339,
                0.668073,
                0.00911926,
                0,
                0.544997,
                0.655405,
                0.00851393,
                0,
                0.56823,
                0.642921,
                0.00797637,
                0,
                0.592068,
                0.629993,
                0.00745119,
                0,
                0.616546,
                0.616828,
                0.00696972,
                0,
                0.641705,
                0.603305,
                0.00652425,
                0,
                0.66759,
                0.589833,
                0.00610188,
                0,
                0.694255,
                0.575945,
                0.00570834,
                0,
                0.72176,
                0.561745,
                0.00533384,
                0,
                0.750168,
                0.548277,
                0.00500001,
                0,
                0.779545,
                0.534467,
                0.00467582,
                0,
                0.809933,
                0.521032,
                0.00438092,
                0,
                0.841272,
                0.507877,
                0.00410348,
                0,
                0.873016,
                0.494654,
                0.00383618,
                0,
                0.904762,
                0.481592,
                0.00358699,
                0,
                0.936508,
                0.468509,
                0.00337281,
                0,
                0.968254,
                0.455293,
                0.00316196,
                0,
                1,
                1,
                0.0430698,
                0,
                0,
                1,
                0.0430699,
                0,
                0,
                0.999998,
                0.0430713,
                0,
                0,
                0.999991,
                0.0430773,
                0,
                0,
                0.99997,
                0.0430936,
                0,
                0,
                0.999928,
                0.0431277,
                0,
                0.0000406396,
                0.999852,
                0.0431893,
                0,
                0.000744376,
                0.999724,
                0.0432895,
                0,
                0.0024806,
                0.999527,
                0.0434397,
                0,
                0.00524779,
                0.99923,
                0.0436507,
                0,
                0.00898164,
                0.998783,
                0.0439255,
                0,
                0.0136083,
                0.997507,
                0.0441104,
                0,
                0.0190582,
                0.994418,
                0.0438225,
                0,
                0.0252694,
                0.992864,
                0.0439396,
                0,
                0.0321879,
                0.991127,
                0.0440962,
                0,
                0.039767,
                0.987331,
                0.0438408,
                0,
                0.0479667,
                0.984819,
                0.0438991,
                0,
                0.056752,
                0.980384,
                0.0435906,
                0,
                0.0660929,
                0.975846,
                0.0432543,
                0,
                0.075963,
                0.970748,
                0.0428293,
                0,
                0.0863398,
                0.964303,
                0.042153,
                0,
                0.0972035,
                0.95772,
                0.0414111,
                0,
                0.108537,
                0.950747,
                0.0405893,
                0,
                0.120325,
                0.942533,
                0.0394887,
                0,
                0.132554,
                0.934045,
                0.0383544,
                0,
                0.145215,
                0.924942,
                0.037057,
                0,
                0.158296,
                0.915811,
                0.0356993,
                0,
                0.17179,
                0.90612,
                0.0342401,
                0,
                0.185691,
                0.896434,
                0.0328078,
                0,
                0.199993,
                0.886021,
                0.031288,
                0,
                0.214691,
                0.876081,
                0.0297776,
                0,
                0.229782,
                0.865608,
                0.0282334,
                0,
                0.245265,
                0.854924,
                0.026749,
                0,
                0.261138,
                0.843607,
                0.02526,
                0,
                0.277401,
                0.832456,
                0.0238214,
                0,
                0.294056,
                0.821342,
                0.0224682,
                0,
                0.311104,
                0.809303,
                0.0211297,
                0,
                0.328548,
                0.796468,
                0.0198387,
                0,
                0.346394,
                0.784046,
                0.0186227,
                0,
                0.364645,
                0.771262,
                0.0174561,
                0,
                0.38331,
                0.758118,
                0.0163806,
                0,
                0.402396,
                0.745075,
                0.0153287,
                0,
                0.421912,
                0.731926,
                0.0143647,
                0,
                0.44187,
                0.71863,
                0.0134363,
                0,
                0.462283,
                0.705414,
                0.0125603,
                0,
                0.483165,
                0.693792,
                0.0117508,
                0,
                0.504535,
                0.683108,
                0.0110016,
                0,
                0.52641,
                0.67183,
                0.0102757,
                0,
                0.548816,
                0.66015,
                0.00962044,
                0,
                0.571776,
                0.647907,
                0.00898031,
                0,
                0.595323,
                0.635734,
                0.00840811,
                0,
                0.619489,
                0.623208,
                0.00786211,
                0,
                0.644317,
                0.610438,
                0.00734953,
                0,
                0.669852,
                0.597345,
                0.00687688,
                0,
                0.696148,
                0.584138,
                0.00643469,
                0,
                0.723267,
                0.5707,
                0.00602236,
                0,
                0.75128,
                0.556966,
                0.0056324,
                0,
                0.780258,
                0.543607,
                0.00528277,
                0,
                0.810268,
                0.530213,
                0.00493999,
                0,
                0.841311,
                0.516912,
                0.00462265,
                0,
                0.873016,
                0.503916,
                0.0043307,
                0,
                0.904762,
                0.491146,
                0.00406858,
                0,
                0.936508,
                0.478439,
                0.00381436,
                0,
                0.968254,
                0.465834,
                0.00358003,
                0,
                1,
                1,
                0.0534039,
                0,
                0,
                1,
                0.053404,
                0,
                0,
                0.999998,
                0.0534055,
                0,
                0,
                0.999989,
                0.0534116,
                0,
                0,
                0.999968,
                0.0534283,
                0,
                0,
                0.999918,
                0.0534633,
                0,
                0.000155895,
                0.99983,
                0.0535262,
                0,
                0.00120914,
                0.999685,
                0.0536281,
                0,
                0.00334944,
                0.999461,
                0.0537799,
                0,
                0.00653077,
                0.999119,
                0.0539902,
                0,
                0.0106718,
                0.998582,
                0.0542524,
                0,
                0.0156907,
                0.995919,
                0.0540318,
                0,
                0.0215147,
                0.993735,
                0.0538914,
                0,
                0.0280801,
                0.992126,
                0.0539557,
                0,
                0.0353323,
                0.990266,
                0.0540401,
                0,
                0.0432247,
                0.986317,
                0.0536064,
                0,
                0.0517172,
                0.983213,
                0.0534425,
                0,
                0.0607754,
                0.978303,
                0.0528622,
                0,
                0.0703698,
                0.973665,
                0.0523363,
                0,
                0.0804742,
                0.968091,
                0.0516165,
                0,
                0.0910667,
                0.961026,
                0.0505434,
                0,
                0.102128,
                0.954333,
                0.049523,
                0,
                0.113641,
                0.946372,
                0.0481698,
                0,
                0.125591,
                0.938254,
                0.0467674,
                0,
                0.137965,
                0.929516,
                0.0452341,
                0,
                0.150754,
                0.920106,
                0.0435083,
                0,
                0.163947,
                0.910899,
                0.0417399,
                0,
                0.177537,
                0.901532,
                0.0399389,
                0,
                0.191516,
                0.891919,
                0.0380901,
                0,
                0.205881,
                0.882006,
                0.0362341,
                0,
                0.220626,
                0.871965,
                0.0343444,
                0,
                0.235749,
                0.862145,
                0.0324832,
                0,
                0.251248,
                0.852058,
                0.0306681,
                0,
                0.267121,
                0.84161,
                0.0289097,
                0,
                0.283368,
                0.830806,
                0.0272079,
                0,
                0.299992,
                0.820476,
                0.0256089,
                0,
                0.316992,
                0.809514,
                0.0240394,
                0,
                0.334374,
                0.797865,
                0.0225379,
                0,
                0.35214,
                0.785621,
                0.0211235,
                0,
                0.370296,
                0.773765,
                0.0197908,
                0,
                0.388849,
                0.761629,
                0.0185235,
                0,
                0.407807,
                0.748891,
                0.0173358,
                0,
                0.427178,
                0.736437,
                0.0162305,
                0,
                0.446974,
                0.723707,
                0.0151778,
                0,
                0.467207,
                0.710606,
                0.0141791,
                0,
                0.487892,
                0.698019,
                0.0132592,
                0,
                0.509046,
                0.686203,
                0.0123887,
                0,
                0.530687,
                0.675692,
                0.0115976,
                0,
                0.552839,
                0.664826,
                0.0108325,
                0,
                0.575527,
                0.65349,
                0.0101348,
                0,
                0.59878,
                0.641774,
                0.00947756,
                0,
                0.622634,
                0.629794,
                0.00886058,
                0,
                0.647128,
                0.617647,
                0.00828526,
                0,
                0.672308,
                0.60534,
                0.00775312,
                0,
                0.698231,
                0.592718,
                0.00726033,
                0,
                0.724958,
                0.579746,
                0.00679731,
                0,
                0.752563,
                0.566763,
                0.00636111,
                0,
                0.781127,
                0.553515,
                0.00595228,
                0,
                0.810733,
                0.540118,
                0.00556876,
                0,
                0.841426,
                0.527325,
                0.00523051,
                0,
                0.873016,
                0.514265,
                0.00490712,
                0,
                0.904762,
                0.501406,
                0.00460297,
                0,
                0.936508,
                0.488922,
                0.00431247,
                0,
                0.968254,
                0.476541,
                0.0040472,
                0,
                1,
                1,
                0.0659184,
                0,
                0,
                1,
                0.0659185,
                0,
                0,
                0.999998,
                0.06592,
                0,
                0,
                0.999988,
                0.0659259,
                0,
                0,
                0.999963,
                0.0659423,
                0,
                0,
                0.999907,
                0.0659764,
                0,
                0.000374198,
                0.999806,
                0.0660376,
                0,
                0.00182071,
                0.999639,
                0.0661361,
                0,
                0.0043894,
                0.999378,
                0.0662814,
                0,
                0.00800055,
                0.998985,
                0.0664779,
                0,
                0.0125594,
                0.998285,
                0.0666914,
                0,
                0.0179786,
                0.995071,
                0.0661989,
                0,
                0.0241822,
                0.993172,
                0.0660454,
                0,
                0.031106,
                0.991438,
                0.0660105,
                0,
                0.0386952,
                0.988428,
                0.0656875,
                0,
                0.0469032,
                0.985218,
                0.0652913,
                0,
                0.0556905,
                0.981128,
                0.0647107,
                0,
                0.065023,
                0.976015,
                0.0638491,
                0,
                0.0748717,
                0.97097,
                0.062993,
                0,
                0.0852112,
                0.964582,
                0.0617927,
                0,
                0.0960199,
                0.957383,
                0.0603626,
                0,
                0.107279,
                0.949969,
                0.0588128,
                0,
                0.118971,
                0.941843,
                0.0570274,
                0,
                0.131084,
                0.933624,
                0.0551885,
                0,
                0.143604,
                0.924543,
                0.053122,
                0,
                0.156521,
                0.914919,
                0.0508897,
                0,
                0.169825,
                0.905773,
                0.0486418,
                0,
                0.18351,
                0.896434,
                0.0463364,
                0,
                0.197569,
                0.887195,
                0.0440623,
                0,
                0.211997,
                0.877706,
                0.0417799,
                0,
                0.226789,
                0.867719,
                0.03945,
                0,
                0.241944,
                0.858587,
                0.037243,
                0,
                0.257458,
                0.849317,
                0.0350956,
                0,
                0.273331,
                0.839585,
                0.0329852,
                0,
                0.289563,
                0.829856,
                0.0310028,
                0,
                0.306154,
                0.819589,
                0.0290953,
                0,
                0.323108,
                0.809714,
                0.0272738,
                0,
                0.340426,
                0.79934,
                0.0255631,
                0,
                0.358113,
                0.788224,
                0.0239175,
                0,
                0.376175,
                0.776619,
                0.0223831,
                0,
                0.394616,
                0.76521,
                0.0209298,
                0,
                0.413445,
                0.753716,
                0.0195786,
                0,
                0.432671,
                0.741564,
                0.0183001,
                0,
                0.452305,
                0.729413,
                0.0171259,
                0,
                0.472358,
                0.717146,
                0.0159933,
                0,
                0.492845,
                0.70436,
                0.0149495,
                0,
                0.513783,
                0.69219,
                0.0139681,
                0,
                0.535189,
                0.680289,
                0.0130577,
                0,
                0.557087,
                0.669611,
                0.0122198,
                0,
                0.5795,
                0.659113,
                0.0114174,
                0,
                0.602459,
                0.648148,
                0.0106729,
                0,
                0.625997,
                0.636905,
                0.00998997,
                0,
                0.650154,
                0.625154,
                0.00934313,
                0,
                0.674976,
                0.613481,
                0.00874839,
                0,
                0.700518,
                0.60154,
                0.00818265,
                0,
                0.726845,
                0.58943,
                0.00766889,
                0,
                0.754032,
                0.576828,
                0.00717153,
                0,
                0.782167,
                0.564194,
                0.00672696,
                0,
                0.811344,
                0.551501,
                0.00630863,
                0,
                0.841644,
                0.538635,
                0.00592177,
                0,
                0.873016,
                0.525724,
                0.00554888,
                0,
                0.904762,
                0.513209,
                0.00520225,
                0,
                0.936508,
                0.500457,
                0.00488231,
                0,
                0.968254,
                0.48799,
                0.00457153,
                0,
                1,
                1,
                0.0810131,
                0,
                0,
                1,
                0.0810133,
                0,
                0,
                0.999997,
                0.0810145,
                0,
                0,
                0.999985,
                0.08102,
                0,
                0,
                0.999956,
                0.0810347,
                0,
                0.0000195026,
                0.999893,
                0.0810656,
                0,
                0.000719316,
                0.999777,
                0.0811205,
                0,
                0.00259774,
                0.999583,
                0.081208,
                0,
                0.00561807,
                0.999281,
                0.0813343,
                0,
                0.00967472,
                0.998813,
                0.0814969,
                0,
                0.0146627,
                0.997597,
                0.0815217,
                0,
                0.0204902,
                0.994379,
                0.0808502,
                0,
                0.0270802,
                0.992744,
                0.0806792,
                0,
                0.0343674,
                0.990745,
                0.0804589,
                0,
                0.0422974,
                0.986646,
                0.0796107,
                0,
                0.0508242,
                0.983611,
                0.0790913,
                0,
                0.0599087,
                0.978869,
                0.0780746,
                0,
                0.0695175,
                0.973475,
                0.0768218,
                0,
                0.0796223,
                0.967845,
                0.0754926,
                0,
                0.0901983,
                0.960778,
                0.0737063,
                0,
                0.101224,
                0.953333,
                0.0718052,
                0,
                0.112682,
                0.945274,
                0.0695946,
                0,
                0.124555,
                0.936955,
                0.0672492,
                0,
                0.136831,
                0.928319,
                0.0647732,
                0,
                0.149496,
                0.919075,
                0.0620947,
                0,
                0.162542,
                0.909114,
                0.0591816,
                0,
                0.175958,
                0.900137,
                0.0563917,
                0,
                0.189739,
                0.891069,
                0.0535392,
                0,
                0.203877,
                0.882262,
                0.0507642,
                0,
                0.218368,
                0.873232,
                0.0479793,
                0,
                0.233208,
                0.864042,
                0.045226,
                0,
                0.248393,
                0.855002,
                0.0425413,
                0,
                0.263923,
                0.846569,
                0.0400126,
                0,
                0.279796,
                0.837714,
                0.0375269,
                0,
                0.296012,
                0.828918,
                0.0352027,
                0,
                0.312573,
                0.819783,
                0.0330011,
                0,
                0.329479,
                0.810129,
                0.0308908,
                0,
                0.346734,
                0.800866,
                0.0289112,
                0,
                0.364342,
                0.79093,
                0.0270255,
                0,
                0.382307,
                0.780593,
                0.0252758,
                0,
                0.400637,
                0.769511,
                0.0236178,
                0,
                0.419337,
                0.758558,
                0.0220652,
                0,
                0.438418,
                0.747632,
                0.0206289,
                0,
                0.457889,
                0.736146,
                0.0192873,
                0,
                0.477761,
                0.724093,
                0.0180333,
                0,
                0.49805,
                0.71234,
                0.0168264,
                0,
                0.51877,
                0.700201,
                0.015746,
                0,
                0.53994,
                0.687949,
                0.0147027,
                0,
                0.561581,
                0.676163,
                0.0137512,
                0,
                0.583718,
                0.665001,
                0.0128655,
                0,
                0.60638,
                0.65472,
                0.0120366,
                0,
                0.629599,
                0.644213,
                0.0112604,
                0,
                0.653415,
                0.633382,
                0.0105413,
                0,
                0.677874,
                0.62212,
                0.00986498,
                0,
                0.70303,
                0.610631,
                0.00923308,
                0,
                0.728948,
                0.599078,
                0.00864206,
                0,
                0.755706,
                0.587519,
                0.00811784,
                0,
                0.783396,
                0.575505,
                0.00761237,
                0,
                0.812121,
                0.563148,
                0.00713949,
                0,
                0.841989,
                0.550828,
                0.00668379,
                0,
                0.873035,
                0.538458,
                0.00627715,
                0,
                0.904762,
                0.525905,
                0.00588336,
                0,
                0.936508,
                0.513517,
                0.00552687,
                0,
                0.968254,
                0.501395,
                0.00519681,
                0,
                1,
                1,
                0.0991506,
                0,
                0,
                1,
                0.0991504,
                0,
                0,
                0.999996,
                0.0991515,
                0,
                0,
                0.999984,
                0.0991558,
                0,
                0,
                0.999947,
                0.0991672,
                0,
                0.000114389,
                0.999874,
                0.0991912,
                0,
                0.00121503,
                0.999739,
                0.0992331,
                0,
                0.00356108,
                0.999514,
                0.0992983,
                0,
                0.00705578,
                0.999159,
                0.0993877,
                0,
                0.011574,
                0.998586,
                0.0994837,
                0,
                0.017003,
                0.995731,
                0.0988425,
                0,
                0.0232484,
                0.993384,
                0.098276,
                0,
                0.0302318,
                0.991615,
                0.0979269,
                0,
                0.0378884,
                0.989029,
                0.0973432,
                0,
                0.0461641,
                0.985373,
                0.0963539,
                0,
                0.0550136,
                0.981278,
                0.0952306,
                0,
                0.0643988,
                0.975777,
                0.0936233,
                0,
                0.0742868,
                0.970526,
                0.0920219,
                0,
                0.0846501,
                0.963755,
                0.0898912,
                0,
                0.0954644,
                0.956676,
                0.0876064,
                0,
                0.106709,
                0.948099,
                0.0847751,
                0,
                0.118367,
                0.939718,
                0.0818638,
                0,
                0.130423,
                0.931305,
                0.078857,
                0,
                0.142862,
                0.922342,
                0.0756127,
                0,
                0.155674,
                0.912842,
                0.0721473,
                0,
                0.168849,
                0.903304,
                0.0686195,
                0,
                0.182378,
                0.89411,
                0.0650589,
                0,
                0.196255,
                0.885512,
                0.0616022,
                0,
                0.210473,
                0.877193,
                0.0582434,
                0,
                0.225027,
                0.86877,
                0.0548979,
                0,
                0.239915,
                0.860267,
                0.0516095,
                0,
                0.255132,
                0.851915,
                0.048468,
                0,
                0.270678,
                0.843912,
                0.0454447,
                0,
                0.286551,
                0.83604,
                0.0425612,
                0,
                0.302751,
                0.828245,
                0.0398752,
                0,
                0.31928,
                0.820159,
                0.0373198,
                0,
                0.336138,
                0.81167,
                0.034916,
                0,
                0.35333,
                0.802659,
                0.0326402,
                0,
                0.370858,
                0.793921,
                0.0304901,
                0,
                0.388728,
                0.784713,
                0.0284857,
                0,
                0.406944,
                0.774946,
                0.0266186,
                0,
                0.425515,
                0.76448,
                0.0248593,
                0,
                0.444449,
                0.753793,
                0.0232114,
                0,
                0.463756,
                0.743506,
                0.0217039,
                0,
                0.483447,
                0.732555,
                0.0202841,
                0,
                0.503535,
                0.720965,
                0.0189648,
                0,
                0.524036,
                0.709422,
                0.0177189,
                0,
                0.544968,
                0.697756,
                0.0165626,
                0,
                0.56635,
                0.685565,
                0.015483,
                0,
                0.588208,
                0.673987,
                0.0144892,
                0,
                0.610569,
                0.66244,
                0.0135607,
                0,
                0.633466,
                0.651675,
                0.0126956,
                0,
                0.656936,
                0.641598,
                0.0118788,
                0,
                0.681025,
                0.63121,
                0.0111261,
                0,
                0.705788,
                0.620514,
                0.010437,
                0,
                0.731289,
                0.609366,
                0.00978747,
                0,
                0.757606,
                0.598137,
                0.00917257,
                0,
                0.784834,
                0.586966,
                0.00859778,
                0,
                0.813085,
                0.575549,
                0.00806803,
                0,
                0.842485,
                0.563797,
                0.00757294,
                0,
                0.87313,
                0.551758,
                0.00710592,
                0,
                0.904762,
                0.539894,
                0.0066841,
                0,
                0.936508,
                0.527901,
                0.00627901,
                0,
                0.968254,
                0.515819,
                0.00590506,
                0,
                1,
                1,
                0.120864,
                0,
                0,
                1,
                0.120864,
                0,
                0,
                0.999996,
                0.120864,
                0,
                0,
                0.99998,
                0.120867,
                0,
                0,
                0.99994,
                0.120872,
                0,
                0.000323781,
                0.999852,
                0.120884,
                0,
                0.00188693,
                0.999693,
                0.120903,
                0,
                0.00473489,
                0.999426,
                0.120929,
                0,
                0.00872704,
                0.999002,
                0.120955,
                0,
                0.0137237,
                0.998235,
                0.120918,
                0,
                0.0196068,
                0.994608,
                0.119764,
                0,
                0.0262803,
                0.992997,
                0.119265,
                0,
                0.0336657,
                0.990968,
                0.11863,
                0,
                0.0416987,
                0.987002,
                0.117261,
                0,
                0.0503261,
                0.983524,
                0.116009,
                0,
                0.0595035,
                0.97875,
                0.114252,
                0,
                0.0691935,
                0.972652,
                0.11193,
                0,
                0.0793645,
                0.966613,
                0.109555,
                0,
                0.0899894,
                0.959275,
                0.106612,
                0,
                0.101045,
                0.951272,
                0.103375,
                0,
                0.112512,
                0.942323,
                0.0996594,
                0,
                0.124372,
                0.933679,
                0.0958841,
                0,
                0.136611,
                0.924822,
                0.0919265,
                0,
                0.149216,
                0.915742,
                0.0878061,
                0,
                0.162176,
                0.906348,
                0.0834894,
                0,
                0.175482,
                0.896883,
                0.079085,
                0,
                0.189125,
                0.88774,
                0.0746745,
                0,
                0.203098,
                0.87986,
                0.0705773,
                0,
                0.217396,
                0.871998,
                0.0665005,
                0,
                0.232015,
                0.864325,
                0.0625413,
                0,
                0.24695,
                0.856685,
                0.0586781,
                0,
                0.2622,
                0.84925,
                0.0550063,
                0,
                0.277761,
                0.841719,
                0.0514727,
                0,
                0.293634,
                0.834755,
                0.0481398,
                0,
                0.309819,
                0.827853,
                0.0450172,
                0,
                0.326315,
                0.820888,
                0.0420969,
                0,
                0.343126,
                0.813616,
                0.0393702,
                0,
                0.360254,
                0.805767,
                0.0367771,
                0,
                0.377701,
                0.797338,
                0.0343274,
                0,
                0.395474,
                0.789122,
                0.0320529,
                0,
                0.413577,
                0.780601,
                0.0299485,
                0,
                0.432018,
                0.771424,
                0.0279812,
                0,
                0.450804,
                0.761502,
                0.0261054,
                0,
                0.469944,
                0.751166,
                0.0243942,
                0,
                0.489451,
                0.741276,
                0.0228087,
                0,
                0.509337,
                0.730898,
                0.0213265,
                0,
                0.529617,
                0.719878,
                0.0199307,
                0,
                0.550307,
                0.708379,
                0.0186574,
                0,
                0.571428,
                0.697165,
                0.0174446,
                0,
                0.593003,
                0.685554,
                0.0163144,
                0,
                0.615059,
                0.673631,
                0.015276,
                0,
                0.637628,
                0.662385,
                0.0143003,
                0,
                0.660746,
                0.651059,
                0.0134112,
                0,
                0.68446,
                0.640451,
                0.0125794,
                0,
                0.70882,
                0.630536,
                0.011793,
                0,
                0.733893,
                0.620316,
                0.0110547,
                0,
                0.759756,
                0.609722,
                0.0103668,
                0,
                0.786505,
                0.598804,
                0.00973009,
                0,
                0.814259,
                0.587871,
                0.00912812,
                0,
                0.843157,
                0.577121,
                0.00858916,
                0,
                0.87334,
                0.566019,
                0.00807333,
                0,
                0.904762,
                0.554664,
                0.00759687,
                0,
                0.936508,
                0.543101,
                0.00714759,
                0,
                0.968254,
                0.531558,
                0.00673418,
                0,
                1,
                1,
                0.146767,
                0,
                0,
                1,
                0.146767,
                0,
                0,
                0.999997,
                0.146767,
                0,
                0,
                0.999977,
                0.146765,
                0,
                0.00000320658,
                0.999929,
                0.146762,
                0,
                0.000682576,
                0.999823,
                0.146753,
                0,
                0.00276402,
                0.999633,
                0.146735,
                0,
                0.00614771,
                0.999314,
                0.146699,
                0,
                0.0106613,
                0.998796,
                0.14662,
                0,
                0.0161546,
                0.997124,
                0.146107,
                0,
                0.0225063,
                0.994062,
                0.144857,
                0,
                0.0296198,
                0.992154,
                0.144011,
                0,
                0.037417,
                0.989186,
                0.142712,
                0,
                0.0458348,
                0.985279,
                0.140926,
                0,
                0.0548211,
                0.980826,
                0.13885,
                0,
                0.0643326,
                0.975056,
                0.136168,
                0,
                0.074333,
                0.969005,
                0.133217,
                0,
                0.0847917,
                0.961554,
                0.12959,
                0,
                0.0956828,
                0.954206,
                0.125886,
                0,
                0.106984,
                0.945046,
                0.121335,
                0,
                0.118675,
                0.935678,
                0.116492,
                0,
                0.130741,
                0.926748,
                0.111635,
                0,
                0.143166,
                0.917764,
                0.106625,
                0,
                0.155939,
                0.908358,
                0.101325,
                0,
                0.169049,
                0.899219,
                0.0960249,
                0,
                0.182487,
                0.890089,
                0.0906527,
                0,
                0.196245,
                0.881488,
                0.0853905,
                0,
                0.210317,
                0.874031,
                0.0804177,
                0,
                0.224697,
                0.866932,
                0.0756005,
                0,
                0.23938,
                0.859976,
                0.0709019,
                0,
                0.254364,
                0.853375,
                0.0664391,
                0,
                0.269646,
                0.846971,
                0.0622012,
                0,
                0.285223,
                0.840483,
                0.058129,
                0,
                0.301096,
                0.833969,
                0.0542762,
                0,
                0.317265,
                0.82806,
                0.0507042,
                0,
                0.333729,
                0.822128,
                0.047368,
                0,
                0.350491,
                0.815989,
                0.044272,
                0,
                0.367554,
                0.809336,
                0.0413444,
                0,
                0.38492,
                0.802177,
                0.038601,
                0,
                0.402594,
                0.79441,
                0.0360227,
                0,
                0.420582,
                0.786573,
                0.0336383,
                0,
                0.438891,
                0.778619,
                0.0314321,
                0,
                0.457527,
                0.77,
                0.029362,
                0,
                0.476499,
                0.760698,
                0.0274102,
                0,
                0.49582,
                0.750932,
                0.0256146,
                0,
                0.5155,
                0.740993,
                0.023974,
                0,
                0.535555,
                0.731159,
                0.0224182,
                0,
                0.556,
                0.720836,
                0.0209889,
                0,
                0.576855,
                0.709913,
                0.0196411,
                0,
                0.598143,
                0.698415,
                0.0183824,
                0,
                0.619888,
                0.68745,
                0.0172222,
                0,
                0.642123,
                0.676154,
                0.0161509,
                0,
                0.664883,
                0.664383,
                0.0151397,
                0,
                0.688211,
                0.6533,
                0.0141873,
                0,
                0.71216,
                0.642072,
                0.0133105,
                0,
                0.736792,
                0.631412,
                0.0124932,
                0,
                0.762186,
                0.621622,
                0.0117408,
                0,
                0.788439,
                0.611681,
                0.0110358,
                0,
                0.815672,
                0.60142,
                0.0103775,
                0,
                0.844034,
                0.59083,
                0.00975623,
                0,
                0.873699,
                0.580254,
                0.00918084,
                0,
                0.904765,
                0.569841,
                0.00864721,
                0,
                0.936508,
                0.559224,
                0.00815731,
                0,
                0.968254,
                0.548315,
                0.00767924,
                0,
                1,
                1,
                0.177563,
                0,
                0,
                1,
                0.177563,
                0,
                0,
                0.999994,
                0.177562,
                0,
                0,
                0.999972,
                0.177555,
                0,
                0.0000664171,
                0.999914,
                0.177536,
                0,
                0.0012276,
                0.999787,
                0.177496,
                0,
                0.00388025,
                0.999556,
                0.17742,
                0,
                0.00783463,
                0.999165,
                0.177285,
                0,
                0.0128953,
                0.9985,
                0.177037,
                0,
                0.0189053,
                0.995388,
                0.175634,
                0,
                0.025742,
                0.993102,
                0.174375,
                0,
                0.033309,
                0.990992,
                0.173121,
                0,
                0.0415298,
                0.986932,
                0.170896,
                0,
                0.0503425,
                0.982786,
                0.16847,
                0,
                0.0596964,
                0.977592,
                0.165455,
                0,
                0.0695498,
                0.971075,
                0.161676,
                0,
                0.0798676,
                0.963967,
                0.157458,
                0,
                0.0906201,
                0.956397,
                0.152836,
                0,
                0.101783,
                0.947489,
                0.147467,
                0,
                0.113333,
                0.937564,
                0.14145,
                0,
                0.125254,
                0.928182,
                0.135383,
                0,
                0.137529,
                0.919027,
                0.129212,
                0,
                0.150144,
                0.909618,
                0.12276,
                0,
                0.163088,
                0.900492,
                0.116273,
                0,
                0.176351,
                0.891671,
                0.1098,
                0,
                0.189924,
                0.883146,
                0.103362,
                0,
                0.203799,
                0.875151,
                0.0970799,
                0,
                0.21797,
                0.868338,
                0.0911732,
                0,
                0.232433,
                0.862033,
                0.0854966,
                0,
                0.247182,
                0.856107,
                0.0800691,
                0,
                0.262216,
                0.850644,
                0.0749618,
                0,
                0.27753,
                0.845261,
                0.070079,
                0,
                0.293124,
                0.839885,
                0.0654321,
                0,
                0.308997,
                0.834609,
                0.0610975,
                0,
                0.325149,
                0.829083,
                0.0569741,
                0,
                0.341581,
                0.82404,
                0.0531736,
                0,
                0.358294,
                0.818968,
                0.049665,
                0,
                0.37529,
                0.813496,
                0.0463856,
                0,
                0.392573,
                0.807533,
                0.0433217,
                0,
                0.410148,
                0.80099,
                0.0404402,
                0,
                0.428019,
                0.793891,
                0.0377578,
                0,
                0.446192,
                0.786281,
                0.0352616,
                0,
                0.464676,
                0.778773,
                0.0329577,
                0,
                0.483478,
                0.770737,
                0.030808,
                0,
                0.502608,
                0.762094,
                0.0287964,
                0,
                0.522079,
                0.752898,
                0.0269254,
                0,
                0.541905,
                0.743306,
                0.0251926,
                0,
                0.5621,
                0.733416,
                0.023595,
                0,
                0.582684,
                0.723742,
                0.0221155,
                0,
                0.603677,
                0.713542,
                0.0207435,
                0,
                0.625106,
                0.702755,
                0.019434,
                0,
                0.646998,
                0.691484,
                0.0182046,
                0,
                0.66939,
                0.680531,
                0.0170771,
                0,
                0.692324,
                0.66953,
                0.0160339,
                0,
                0.715849,
                0.658126,
                0.0150677,
                0,
                0.740028,
                0.646933,
                0.0141551,
                0,
                0.764937,
                0.636107,
                0.0133179,
                0,
                0.790673,
                0.625271,
                0.0125284,
                0,
                0.817358,
                0.615225,
                0.0117937,
                0,
                0.84515,
                0.605678,
                0.0111181,
                0,
                0.874244,
                0.59583,
                0.0104759,
                0,
                0.904828,
                0.585704,
                0.00986672,
                0,
                0.936508,
                0.575413,
                0.00929712,
                0,
                0.968254,
                0.565373,
                0.00876713,
                0,
                1,
                1,
                0.214058,
                0,
                0,
                0.999999,
                0.214058,
                0,
                0,
                0.999994,
                0.214055,
                0,
                0,
                0.999966,
                0.214039,
                0,
                0.000259642,
                0.999893,
                0.213998,
                0,
                0.00200075,
                0.999737,
                0.21391,
                0,
                0.00527775,
                0.999449,
                0.213745,
                0,
                0.00983959,
                0.99896,
                0.213458,
                0,
                0.0154755,
                0.9979,
                0.212855,
                0,
                0.0220249,
                0.994278,
                0.210779,
                0,
                0.0293654,
                0.992254,
                0.20926,
                0,
                0.0374021,
                0.98881,
                0.206908,
                0,
                0.0460604,
                0.984715,
                0.204009,
                0,
                0.0552802,
                0.979738,
                0.200471,
                0,
                0.0650127,
                0.972884,
                0.195813,
                0,
                0.0752175,
                0.965996,
                0.190856,
                0,
                0.0858612,
                0.957974,
                0.185077,
                0,
                0.0969155,
                0.949155,
                0.17868,
                0,
                0.108356,
                0.939288,
                0.171513,
                0,
                0.120163,
                0.928996,
                0.163838,
                0,
                0.132319,
                0.919563,
                0.156246,
                0,
                0.144808,
                0.910004,
                0.148359,
                0,
                0.157618,
                0.900791,
                0.140417,
                0,
                0.170737,
                0.892135,
                0.132569,
                0,
                0.184155,
                0.883803,
                0.124741,
                0,
                0.197866,
                0.876034,
                0.117091,
                0,
                0.211861,
                0.869219,
                0.109835,
                0,
                0.226134,
                0.863062,
                0.102859,
                0,
                0.240682,
                0.857795,
                0.0962928,
                0,
                0.255499,
                0.853009,
                0.0900725,
                0,
                0.270583,
                0.848603,
                0.0842101,
                0,
                0.285931,
                0.844335,
                0.0786527,
                0,
                0.301542,
                0.840208,
                0.0734397,
                0,
                0.317415,
                0.836035,
                0.0685334,
                0,
                0.33355,
                0.83172,
                0.0639275,
                0,
                0.349948,
                0.827135,
                0.0595909,
                0,
                0.36661,
                0.822797,
                0.0556204,
                0,
                0.383539,
                0.818387,
                0.0519394,
                0,
                0.400738,
                0.813565,
                0.0485317,
                0,
                0.41821,
                0.808142,
                0.0453138,
                0,
                0.435961,
                0.802212,
                0.0423354,
                0,
                0.453997,
                0.79573,
                0.0395553,
                0,
                0.472324,
                0.788741,
                0.036988,
                0,
                0.490951,
                0.781093,
                0.0345688,
                0,
                0.509887,
                0.773597,
                0.0323297,
                0,
                0.529144,
                0.765622,
                0.0302719,
                0,
                0.548735,
                0.757083,
                0.0283477,
                0,
                0.568674,
                0.747992,
                0.0265562,
                0,
                0.588979,
                0.738591,
                0.0248844,
                0,
                0.609671,
                0.728719,
                0.0233342,
                0,
                0.630773,
                0.719146,
                0.0219081,
                0,
                0.652314,
                0.709165,
                0.0205711,
                0,
                0.674328,
                0.69875,
                0.0193248,
                0,
                0.696854,
                0.687884,
                0.0181582,
                0,
                0.719942,
                0.676818,
                0.0170746,
                0,
                0.743651,
                0.666247,
                0.0160718,
                0,
                0.768057,
                0.655284,
                0.0151262,
                0,
                0.793253,
                0.64401,
                0.0142561,
                0,
                0.819363,
                0.633353,
                0.0134327,
                0,
                0.846547,
                0.622674,
                0.012653,
                0,
                0.875017,
                0.612265,
                0.0119354,
                0,
                0.905021,
                0.602455,
                0.0112533,
                0,
                0.936508,
                0.593147,
                0.0106234,
                0,
                0.968254,
                0.583592,
                0.0100213,
                0,
                1,
                1,
                0.25717,
                0,
                0,
                1,
                0.25717,
                0,
                0,
                0.999992,
                0.257164,
                0,
                0,
                0.999958,
                0.257135,
                0,
                0.000641715,
                0.999864,
                0.25706,
                0,
                0.00305314,
                0.999666,
                0.256897,
                0,
                0.00700975,
                0.999302,
                0.256596,
                0,
                0.0122194,
                0.998663,
                0.25607,
                0,
                0.0184622,
                0.995607,
                0.254123,
                0,
                0.0255773,
                0.993094,
                0.252081,
                0,
                0.0334439,
                0.9907,
                0.249867,
                0,
                0.0419696,
                0.98594,
                0.246118,
                0,
                0.0510823,
                0.981214,
                0.242049,
                0,
                0.0607242,
                0.974966,
                0.236869,
                0,
                0.0708486,
                0.967589,
                0.230724,
                0,
                0.081417,
                0.95915,
                0.223635,
                0,
                0.0923974,
                0.950257,
                0.21596,
                0,
                0.103763,
                0.940165,
                0.207296,
                0,
                0.115491,
                0.929396,
                0.197901,
                0,
                0.127562,
                0.919288,
                0.188437,
                0,
                0.13996,
                0.909428,
                0.178762,
                0,
                0.15267,
                0.900105,
                0.169072,
                0,
                0.165679,
                0.891418,
                0.159478,
                0,
                0.178979,
                0.883347,
                0.15002,
                0,
                0.192558,
                0.875992,
                0.140813,
                0,
                0.20641,
                0.869466,
                0.13196,
                0,
                0.220529,
                0.863699,
                0.123501,
                0,
                0.234907,
                0.858553,
                0.115436,
                0,
                0.249542,
                0.854379,
                0.107901,
                0,
                0.264428,
                0.850894,
                0.10088,
                0,
                0.279564,
                0.847632,
                0.0942296,
                0,
                0.294947,
                0.844571,
                0.0879861,
                0,
                0.310575,
                0.84163,
                0.0821534,
                0,
                0.326448,
                0.838542,
                0.0766409,
                0,
                0.342566,
                0.835412,
                0.0715322,
                0,
                0.358929,
                0.831899,
                0.0666883,
                0,
                0.37554,
                0.828177,
                0.0622175,
                0,
                0.392399,
                0.82416,
                0.0580452,
                0,
                0.409511,
                0.820393,
                0.054267,
                0,
                0.426878,
                0.816068,
                0.0507172,
                0,
                0.444506,
                0.811201,
                0.0474041,
                0,
                0.4624,
                0.805785,
                0.0443174,
                0,
                0.480566,
                0.799878,
                0.0414562,
                0,
                0.499013,
                0.793469,
                0.0388147,
                0,
                0.517749,
                0.786473,
                0.0363453,
                0,
                0.536785,
                0.778874,
                0.0340225,
                0,
                0.556134,
                0.771277,
                0.0318599,
                0,
                0.575809,
                0.763426,
                0.0298859,
                0,
                0.595827,
                0.755044,
                0.0280357,
                0,
                0.616207,
                0.746161,
                0.0262979,
                0,
                0.636973,
                0.737124,
                0.0247295,
                0,
                0.65815,
                0.72761,
                0.0232514,
                0,
                0.679772,
                0.717822,
                0.0218755,
                0,
                0.701876,
                0.708279,
                0.0205942,
                0,
                0.724509,
                0.698333,
                0.0193947,
                0,
                0.74773,
                0.68802,
                0.0182717,
                0,
                0.771609,
                0.677321,
                0.0172044,
                0,
                0.79624,
                0.666504,
                0.0162122,
                0,
                0.821743,
                0.656184,
                0.0152924,
                0,
                0.84828,
                0.64556,
                0.0144326,
                0,
                0.876069,
                0.634636,
                0.0136157,
                0,
                0.905404,
                0.624124,
                0.0128612,
                0,
                0.936508,
                0.613914,
                0.0121435,
                0,
                0.968254,
                0.603589,
                0.0114887,
                0,
                1,
                1,
                0.307946,
                0,
                0,
                0.999999,
                0.307945,
                0,
                0,
                0.999988,
                0.307934,
                0,
                0.0000204479,
                0.999944,
                0.307886,
                0,
                0.00127833,
                0.999824,
                0.307756,
                0,
                0.00445047,
                0.999565,
                0.30748,
                0,
                0.00914673,
                0.999085,
                0.306966,
                0,
                0.0150498,
                0.998103,
                0.306004,
                0,
                0.0219367,
                0.994249,
                0.303028,
                0,
                0.0296485,
                0.991807,
                0.300435,
                0,
                0.038068,
                0.987773,
                0.296554,
                0,
                0.0471062,
                0.982673,
                0.2916,
                0,
                0.0566942,
                0.976623,
                0.285641,
                0,
                0.0667768,
                0.968757,
                0.27815,
                0,
                0.0773099,
                0.959849,
                0.269529,
                0,
                0.088257,
                0.950663,
                0.260248,
                0,
                0.0995879,
                0.940129,
                0.249704,
                0,
                0.111277,
                0.92895,
                0.238291,
                0,
                0.123304,
                0.917996,
                0.226501,
                0,
                0.13565,
                0.907813,
                0.214669,
                0,
                0.148299,
                0.898305,
                0.202835,
                0,
                0.161237,
                0.889626,
                0.191158,
                0,
                0.174455,
                0.88175,
                0.179695,
                0,
                0.187941,
                0.874715,
                0.168548,
                0,
                0.201687,
                0.868746,
                0.15792,
                0,
                0.215687,
                0.863703,
                0.147807,
                0,
                0.229933,
                0.859315,
                0.138149,
                0,
                0.24442,
                0.855538,
                0.128993,
                0,
                0.259145,
                0.852428,
                0.120414,
                0,
                0.274103,
                0.850168,
                0.112498,
                0,
                0.289293,
                0.848132,
                0.105054,
                0,
                0.304711,
                0.846291,
                0.0981087,
                0,
                0.320357,
                0.844431,
                0.0915942,
                0,
                0.33623,
                0.842493,
                0.0855056,
                0,
                0.35233,
                0.840368,
                0.0798204,
                0,
                0.368658,
                0.83798,
                0.0745097,
                0,
                0.385214,
                0.83523,
                0.0695424,
                0,
                0.402002,
                0.832091,
                0.0649092,
                0,
                0.419023,
                0.828667,
                0.0606291,
                0,
                0.436282,
                0.824805,
                0.0566523,
                0,
                0.453782,
                0.820988,
                0.0530229,
                0,
                0.471529,
                0.816635,
                0.0496364,
                0,
                0.489528,
                0.811725,
                0.0464658,
                0,
                0.507788,
                0.806316,
                0.0435082,
                0,
                0.526317,
                0.800469,
                0.0407873,
                0,
                0.545124,
                0.794107,
                0.038255,
                0,
                0.564221,
                0.787218,
                0.0358825,
                0,
                0.583621,
                0.779872,
                0.0336785,
                0,
                0.603341,
                0.772097,
                0.0316379,
                0,
                0.623397,
                0.764484,
                0.0297379,
                0,
                0.643812,
                0.756428,
                0.0279581,
                0,
                0.664611,
                0.748022,
                0.0263153,
                0,
                0.685824,
                0.739268,
                0.0247799,
                0,
                0.707488,
                0.73024,
                0.0233385,
                0,
                0.729646,
                0.720893,
                0.0220035,
                0,
                0.752354,
                0.71119,
                0.0207555,
                0,
                0.77568,
                0.701791,
                0.0195843,
                0,
                0.799715,
                0.692184,
                0.0184891,
                0,
                0.824574,
                0.682258,
                0.0174541,
                0,
                0.850417,
                0.67206,
                0.0164873,
                0,
                0.877466,
                0.661717,
                0.0155959,
                0,
                0.90604,
                0.651462,
                0.0147519,
                0,
                0.936528,
                0.641467,
                0.0139727,
                0,
                0.968254,
                0.631229,
                0.0132363,
                0,
                1,
                1,
                0.367573,
                0,
                0,
                0.999999,
                0.367571,
                0,
                0,
                0.999984,
                0.367553,
                0,
                0.000183382,
                0.999925,
                0.367473,
                0,
                0.00225254,
                0.999759,
                0.367259,
                0,
                0.00628165,
                0.99941,
                0.366801,
                0,
                0.0117858,
                0.998739,
                0.365946,
                0,
                0.0184359,
                0.995529,
                0.363191,
                0,
                0.0260114,
                0.992875,
                0.360171,
                0,
                0.0343581,
                0.989135,
                0.355981,
                0,
                0.0433637,
                0.984166,
                0.350401,
                0,
                0.0529438,
                0.977871,
                0.343348,
                0,
                0.0630334,
                0.96951,
                0.334341,
                0,
                0.0735805,
                0.959964,
                0.323862,
                0,
                0.0845437,
                0.950162,
                0.312521,
                0,
                0.095889,
                0.938882,
                0.299577,
                0,
                0.107588,
                0.926992,
                0.285573,
                0,
                0.119617,
                0.915589,
                0.271212,
                0,
                0.131957,
                0.904791,
                0.256611,
                0,
                0.144591,
                0.895177,
                0.242224,
                0,
                0.157503,
                0.886403,
                0.227952,
                0,
                0.170682,
                0.878957,
                0.214192,
                0,
                0.184117,
                0.872418,
                0.200795,
                0,
                0.197799,
                0.867029,
                0.188015,
                0,
                0.21172,
                0.862835,
                0.175975,
                0,
                0.225873,
                0.859411,
                0.164526,
                0,
                0.240253,
                0.856655,
                0.153693,
                0,
                0.254854,
                0.854519,
                0.14352,
                0,
                0.269673,
                0.852828,
                0.13397,
                0,
                0.284707,
                0.851412,
                0.124984,
                0,
                0.299953,
                0.850609,
                0.116748,
                0,
                0.315408,
                0.849855,
                0.10905,
                0,
                0.331073,
                0.849017,
                0.101839,
                0,
                0.346946,
                0.848079,
                0.0951359,
                0,
                0.363028,
                0.846911,
                0.0888774,
                0,
                0.379318,
                0.845445,
                0.0830375,
                0,
                0.395818,
                0.84362,
                0.0775844,
                0,
                0.41253,
                0.841411,
                0.0725054,
                0,
                0.429457,
                0.838768,
                0.0677691,
                0,
                0.446602,
                0.835801,
                0.0634016,
                0,
                0.463968,
                0.832341,
                0.0593095,
                0,
                0.481561,
                0.828424,
                0.0555121,
                0,
                0.499386,
                0.824312,
                0.052024,
                0,
                0.51745,
                0.819918,
                0.0487865,
                0,
                0.535761,
                0.815072,
                0.0457801,
                0,
                0.554328,
                0.809863,
                0.0430184,
                0,
                0.573162,
                0.804164,
                0.0404245,
                0,
                0.592275,
                0.798034,
                0.0380146,
                0,
                0.611681,
                0.791436,
                0.0357436,
                0,
                0.631398,
                0.784498,
                0.0336475,
                0,
                0.651445,
                0.777125,
                0.0316666,
                0,
                0.671845,
                0.769365,
                0.0298122,
                0,
                0.692628,
                0.761579,
                0.0281001,
                0,
                0.713827,
                0.753746,
                0.0265049,
                0,
                0.735484,
                0.745573,
                0.0250067,
                0,
                0.75765,
                0.737083,
                0.0236026,
                0,
                0.78039,
                0.728545,
                0.0223302,
                0,
                0.803789,
                0.719691,
                0.0211243,
                0,
                0.82796,
                0.710569,
                0.0199983,
                0,
                0.853056,
                0.701216,
                0.0189569,
                0,
                0.879298,
                0.692094,
                0.0179702,
                0,
                0.907014,
                0.682909,
                0.0170418,
                0,
                0.936691,
                0.673509,
                0.0161732,
                0,
                0.968254,
                0.663863,
                0.0153406,
                0,
                1,
                1,
                0.437395,
                0,
                0,
                0.999998,
                0.437394,
                0,
                0,
                0.99998,
                0.437363,
                0,
                0.000616704,
                0.999891,
                0.437232,
                0,
                0.00367925,
                0.999656,
                0.436877,
                0,
                0.00867446,
                0.999148,
                0.436121,
                0,
                0.0150679,
                0.997959,
                0.434564,
                0,
                0.022531,
                0.993464,
                0.430134,
                0,
                0.0308507,
                0.990606,
                0.426077,
                0,
                0.0398805,
                0.985027,
                0.419397,
                0,
                0.0495148,
                0.978491,
                0.41118,
                0,
                0.0596749,
                0.969643,
                0.40048,
                0,
                0.0703001,
                0.959189,
                0.38769,
                0,
                0.0813427,
                0.948223,
                0.373575,
                0,
                0.0927641,
                0.935955,
                0.357622,
                0,
                0.104533,
                0.923237,
                0.34043,
                0,
                0.116624,
                0.911074,
                0.322735,
                0,
                0.129015,
                0.899724,
                0.30479,
                0,
                0.141687,
                0.890189,
                0.287392,
                0,
                0.154626,
                0.881796,
                0.270248,
                0,
                0.167818,
                0.874781,
                0.253659,
                0,
                0.181252,
                0.869166,
                0.237786,
                0,
                0.194918,
                0.864725,
                0.222618,
                0,
                0.208807,
                0.861565,
                0.208356,
                0,
                0.222913,
                0.859284,
                0.194867,
                0,
                0.237229,
                0.857677,
                0.18212,
                0,
                0.25175,
                0.856714,
                0.17018,
                0,
                0.266473,
                0.856155,
                0.158969,
                0,
                0.281392,
                0.8558,
                0.148413,
                0,
                0.296505,
                0.855672,
                0.138578,
                0,
                0.311811,
                0.855538,
                0.129345,
                0,
                0.327306,
                0.855689,
                0.120861,
                0,
                0.342991,
                0.855767,
                0.112969,
                0,
                0.358864,
                0.855618,
                0.105593,
                0,
                0.374925,
                0.85525,
                0.0987451,
                0,
                0.391176,
                0.854583,
                0.0923727,
                0,
                0.407616,
                0.853534,
                0.0864143,
                0,
                0.424249,
                0.852061,
                0.0808338,
                0,
                0.441076,
                0.850253,
                0.0756771,
                0,
                0.4581,
                0.848004,
                0.0708612,
                0,
                0.475324,
                0.845333,
                0.0663784,
                0,
                0.492754,
                0.842376,
                0.0622631,
                0,
                0.510394,
                0.838956,
                0.0584112,
                0,
                0.528251,
                0.835121,
                0.0548328,
                0,
                0.546331,
                0.830842,
                0.0514838,
                0,
                0.564644,
                0.826212,
                0.048355,
                0,
                0.583198,
                0.821522,
                0.0454714,
                0,
                0.602005,
                0.816551,
                0.0428263,
                0,
                0.621078,
                0.811211,
                0.0403612,
                0,
                0.640434,
                0.805479,
                0.038039,
                0,
                0.660089,
                0.799409,
                0.0358739,
                0,
                0.680066,
                0.79306,
                0.0338727,
                0,
                0.70039,
                0.786395,
                0.0319985,
                0,
                0.721094,
                0.779416,
                0.030241,
                0,
                0.742215,
                0.77214,
                0.0285951,
                0,
                0.7638,
                0.764636,
                0.0270747,
                0,
                0.785912,
                0.756836,
                0.0256354,
                0,
                0.808628,
                0.749315,
                0.0243027,
                0,
                0.832055,
                0.741561,
                0.0230497,
                0,
                0.856338,
                0.733589,
                0.0218801,
                0,
                0.88169,
                0.725479,
                0.020784,
                0,
                0.908441,
                0.717255,
                0.0197702,
                0,
                0.937125,
                0.708829,
                0.0188168,
                0,
                0.968254,
                0.700191,
                0.0179113,
                0,
                1,
                1,
                0.518937,
                0,
                0,
                0.999998,
                0.518933,
                0,
                0,
                0.999967,
                0.518883,
                0,
                0.00147741,
                0.999832,
                0.51866,
                0,
                0.00573221,
                0.999466,
                0.518057,
                0,
                0.011826,
                0.998644,
                0.516752,
                0,
                0.0192116,
                0.994458,
                0.512347,
                0,
                0.027573,
                0.991223,
                0.507675,
                0,
                0.0367099,
                0.985515,
                0.500188,
                0,
                0.046487,
                0.978308,
                0.490408,
                0,
                0.0568071,
                0.968359,
                0.477357,
                0,
                0.0675984,
                0.95682,
                0.461752,
                0,
                0.0788059,
                0.943929,
                0.443796,
                0,
                0.090386,
                0.930224,
                0.423893,
                0,
                0.102304,
                0.916514,
                0.402682,
                0,
                0.114532,
                0.903653,
                0.380914,
                0,
                0.127047,
                0.892315,
                0.359212,
                0,
                0.139828,
                0.882942,
                0.338102,
                0,
                0.152861,
                0.875438,
                0.31773,
                0,
                0.16613,
                0.869642,
                0.298186,
                0,
                0.179624,
                0.865304,
                0.279491,
                0,
                0.193332,
                0.862382,
                0.261804,
                0,
                0.207247,
                0.860666,
                0.245146,
                0,
                0.22136,
                0.859788,
                0.229406,
                0,
                0.235666,
                0.859608,
                0.214605,
                0,
                0.250158,
                0.859912,
                0.200691,
                0,
                0.264832,
                0.86053,
                0.187623,
                0,
                0.279684,
                0.861368,
                0.17539,
                0,
                0.294711,
                0.862237,
                0.163901,
                0,
                0.309911,
                0.863127,
                0.153175,
                0,
                0.32528,
                0.863923,
                0.143147,
                0,
                0.340819,
                0.864567,
                0.133781,
                0,
                0.356524,
                0.865013,
                0.125042,
                0,
                0.372397,
                0.86539,
                0.116952,
                0,
                0.388438,
                0.865591,
                0.109476,
                0,
                0.404645,
                0.865517,
                0.102542,
                0,
                0.421022,
                0.865084,
                0.0960688,
                0,
                0.437569,
                0.864309,
                0.0900499,
                0,
                0.454287,
                0.863151,
                0.0844328,
                0,
                0.471181,
                0.861649,
                0.0792218,
                0,
                0.488253,
                0.859742,
                0.0743482,
                0,
                0.505507,
                0.857446,
                0.0697963,
                0,
                0.522947,
                0.854757,
                0.0655364,
                0,
                0.54058,
                0.851783,
                0.061608,
                0,
                0.558412,
                0.848516,
                0.0579701,
                0,
                0.576449,
                0.844897,
                0.0545742,
                0,
                0.594701,
                0.840956,
                0.0514167,
                0,
                0.613178,
                0.836676,
                0.0484598,
                0,
                0.631892,
                0.832075,
                0.0456934,
                0,
                0.650856,
                0.827191,
                0.0431178,
                0,
                0.670088,
                0.822295,
                0.0407718,
                0,
                0.689606,
                0.817294,
                0.0386032,
                0,
                0.709434,
                0.812013,
                0.0365675,
                0,
                0.7296,
                0.806465,
                0.0346547,
                0,
                0.750138,
                0.800691,
                0.0328717,
                0,
                0.771093,
                0.794709,
                0.031211,
                0,
                0.792519,
                0.788493,
                0.0296504,
                0,
                0.814488,
                0.782049,
                0.0281782,
                0,
                0.837097,
                0.775403,
                0.0267965,
                0,
                0.860481,
                0.76857,
                0.0255002,
                0,
                0.884842,
                0.761536,
                0.0242759,
                0,
                0.910494,
                0.754303,
                0.0231142,
                0,
                0.937985,
                0.74692,
                0.0220305,
                0,
                0.968254,
                0.739745,
                0.0210192,
                0,
                1,
                1,
                0.613914,
                0,
                0,
                0.999996,
                0.613907,
                0,
                0.0000963597,
                0.999942,
                0.613814,
                0,
                0.00301247,
                0.999704,
                0.613407,
                0,
                0.00870385,
                0.999046,
                0.612302,
                0,
                0.0160714,
                0.995516,
                0.608266,
                0,
                0.0245899,
                0.991726,
                0.602863,
                0,
                0.0339681,
                0.985157,
                0.593956,
                0,
                0.0440254,
                0.97642,
                0.581748,
                0,
                0.0546409,
                0.964404,
                0.565183,
                0,
                0.0657284,
                0.950601,
                0.545273,
                0,
                0.0772246,
                0.935158,
                0.522129,
                0,
                0.0890812,
                0.919364,
                0.496782,
                0,
                0.10126,
                0.904754,
                0.470571,
                0,
                0.113731,
                0.89176,
                0.444037,
                0,
                0.126469,
                0.881492,
                0.418322,
                0,
                0.139454,
                0.873656,
                0.393522,
                0,
                0.15267,
                0.868053,
                0.369795,
                0,
                0.166101,
                0.864336,
                0.347171,
                0,
                0.179736,
                0.862259,
                0.325737,
                0,
                0.193565,
                0.861556,
                0.305532,
                0,
                0.207578,
                0.861776,
                0.286416,
                0,
                0.221769,
                0.862661,
                0.268355,
                0,
                0.23613,
                0.864015,
                0.251334,
                0,
                0.250656,
                0.865711,
                0.235352,
                0,
                0.265343,
                0.867519,
                0.220302,
                0,
                0.280187,
                0.869351,
                0.206161,
                0,
                0.295183,
                0.871144,
                0.192908,
                0,
                0.31033,
                0.872839,
                0.180505,
                0,
                0.325624,
                0.874307,
                0.168848,
                0,
                0.341065,
                0.875667,
                0.158021,
                0,
                0.35665,
                0.876758,
                0.147877,
                0,
                0.37238,
                0.87764,
                0.138441,
                0,
                0.388253,
                0.878237,
                0.129627,
                0,
                0.404269,
                0.878563,
                0.121415,
                0,
                0.42043,
                0.878572,
                0.113741,
                0,
                0.436735,
                0.87842,
                0.106652,
                0,
                0.453187,
                0.878057,
                0.100097,
                0,
                0.469786,
                0.877413,
                0.0940128,
                0,
                0.486536,
                0.87646,
                0.0883462,
                0,
                0.503439,
                0.875233,
                0.0830924,
                0,
                0.520498,
                0.8737,
                0.0781975,
                0,
                0.537717,
                0.871873,
                0.07364,
                0,
                0.555102,
                0.86978,
                0.0694103,
                0,
                0.572657,
                0.867405,
                0.0654696,
                0,
                0.59039,
                0.864751,
                0.0617914,
                0,
                0.608307,
                0.861818,
                0.0583491,
                0,
                0.626419,
                0.858645,
                0.0551443,
                0,
                0.644733,
                0.855307,
                0.0521894,
                0,
                0.663264,
                0.851736,
                0.0494334,
                0,
                0.682025,
                0.847927,
                0.0468504,
                0,
                0.701032,
                0.843888,
                0.0444261,
                0,
                0.720308,
                0.839629,
                0.0421497,
                0,
                0.739875,
                0.835158,
                0.0400082,
                0,
                0.759764,
                0.830509,
                0.0380076,
                0,
                0.780014,
                0.825714,
                0.0361488,
                0,
                0.800673,
                0.820729,
                0.0343956,
                0,
                0.821803,
                0.815751,
                0.0327781,
                0,
                0.843492,
                0.810752,
                0.031275,
                0,
                0.86586,
                0.805587,
                0.0298542,
                0,
                0.889087,
                0.800317,
                0.0285397,
                0,
                0.913466,
                0.79489,
                0.0272948,
                0,
                0.93952,
                0.789314,
                0.0261139,
                0,
                0.96835,
                0.783593,
                0.0249938,
                0,
                1,
                1,
                0.724258,
                0,
                0,
                0.999992,
                0.724243,
                0,
                0.000726889,
                0.99987,
                0.724044,
                0,
                0.00569574,
                0.999336,
                0.72317,
                0,
                0.0131702,
                0.996271,
                0.719432,
                0,
                0.0220738,
                0.991159,
                0.712576,
                0,
                0.0319405,
                0.982465,
                0.700927,
                0,
                0.0425202,
                0.97049,
                0.684297,
                0,
                0.0536599,
                0.953973,
                0.661244,
                0,
                0.065258,
                0.935546,
                0.633804,
                0,
                0.0772427,
                0.916596,
                0.603071,
                0,
                0.0895616,
                0.899353,
                0.57105,
                0,
                0.102175,
                0.885216,
                0.539206,
                0,
                0.11505,
                0.875076,
                0.508714,
                0,
                0.128164,
                0.868334,
                0.479571,
                0,
                0.141495,
                0.864414,
                0.451796,
                0,
                0.155026,
                0.862678,
                0.425328,
                0,
                0.168745,
                0.862835,
                0.400352,
                0,
                0.182639,
                0.864067,
                0.376532,
                0,
                0.196699,
                0.866086,
                0.35391,
                0,
                0.210915,
                0.868557,
                0.332424,
                0,
                0.225282,
                0.871271,
                0.312053,
                0,
                0.239792,
                0.874058,
                0.292764,
                0,
                0.25444,
                0.8768,
                0.27453,
                0,
                0.269223,
                0.87939,
                0.257297,
                0,
                0.284135,
                0.8819,
                0.24114,
                0,
                0.299174,
                0.884187,
                0.225934,
                0,
                0.314337,
                0.886262,
                0.211669,
                0,
                0.329622,
                0.888119,
                0.198311,
                0,
                0.345026,
                0.889709,
                0.185783,
                0,
                0.360549,
                0.891054,
                0.174063,
                0,
                0.376189,
                0.892196,
                0.163143,
                0,
                0.391946,
                0.893101,
                0.152952,
                0,
                0.407819,
                0.893803,
                0.143475,
                0,
                0.423808,
                0.894277,
                0.134647,
                0,
                0.439914,
                0.894532,
                0.126434,
                0,
                0.456137,
                0.894576,
                0.1188,
                0,
                0.472479,
                0.894393,
                0.111694,
                0,
                0.48894,
                0.893976,
                0.105069,
                0,
                0.505523,
                0.893346,
                0.0989077,
                0,
                0.52223,
                0.892502,
                0.0931724,
                0,
                0.539064,
                0.891441,
                0.0878276,
                0,
                0.556028,
                0.890276,
                0.082903,
                0,
                0.573125,
                0.888972,
                0.0783505,
                0,
                0.590361,
                0.887469,
                0.0741083,
                0,
                0.607741,
                0.885785,
                0.0701633,
                0,
                0.62527,
                0.883914,
                0.0664835,
                0,
                0.642957,
                0.881872,
                0.0630567,
                0,
                0.660809,
                0.879651,
                0.0598527,
                0,
                0.678836,
                0.877267,
                0.0568615,
                0,
                0.69705,
                0.874717,
                0.05406,
                0,
                0.715465,
                0.872012,
                0.0514378,
                0,
                0.734098,
                0.869157,
                0.0489805,
                0,
                0.752968,
                0.866155,
                0.0466727,
                0,
                0.772101,
                0.863014,
                0.0445056,
                0,
                0.791529,
                0.859748,
                0.0424733,
                0,
                0.81129,
                0.856416,
                0.0405957,
                0,
                0.831438,
                0.852958,
                0.0388273,
                0,
                0.852044,
                0.849382,
                0.0371619,
                0,
                0.87321,
                0.845694,
                0.0355959,
                0,
                0.89509,
                0.841893,
                0.0341155,
                0,
                0.917932,
                0.837981,
                0.0327141,
                0,
                0.942204,
                0.833963,
                0.0313856,
                0,
                0.968981,
                0.829847,
                0.0301275,
                0,
                1,
                1,
                0.85214,
                0,
                0,
                0.999969,
                0.852095,
                0,
                0.00279627,
                0.999483,
                0.851408,
                0,
                0.0107635,
                0.994545,
                0.84579,
                0,
                0.0206454,
                0.986188,
                0.835231,
                0,
                0.0315756,
                0.969847,
                0.814687,
                0,
                0.0432021,
                0.945951,
                0.783735,
                0,
                0.0553396,
                0.91917,
                0.746074,
                0,
                0.0678766,
                0.895488,
                0.706938,
                0,
                0.0807395,
                0.878232,
                0.669534,
                0,
                0.0938767,
                0.868252,
                0.635168,
                0,
                0.10725,
                0.863873,
                0.603069,
                0,
                0.120832,
                0.863369,
                0.572514,
                0,
                0.134598,
                0.86545,
                0.543169,
                0,
                0.148533,
                0.868803,
                0.514578,
                0,
                0.16262,
                0.872794,
                0.486762,
                0,
                0.176849,
                0.87702,
                0.459811,
                0,
                0.19121,
                0.881054,
                0.433654,
                0,
                0.205694,
                0.884974,
                0.408574,
                0,
                0.220294,
                0.888587,
                0.384525,
                0,
                0.235005,
                0.891877,
                0.36156,
                0,
                0.24982,
                0.894793,
                0.339661,
                0,
                0.264737,
                0.89743,
                0.318913,
                0,
                0.279751,
                0.899796,
                0.299302,
                0,
                0.294859,
                0.901943,
                0.280843,
                0,
                0.310058,
                0.903858,
                0.263481,
                0,
                0.325346,
                0.905574,
                0.247197,
                0,
                0.340721,
                0.907069,
                0.231915,
                0,
                0.356181,
                0.908379,
                0.217614,
                0,
                0.371725,
                0.90952,
                0.20425,
                0,
                0.387353,
                0.910483,
                0.191758,
                0,
                0.403063,
                0.91128,
                0.180092,
                0,
                0.418854,
                0.911936,
                0.169222,
                0,
                0.434727,
                0.912454,
                0.159098,
                0,
                0.450682,
                0.912835,
                0.149668,
                0,
                0.466718,
                0.913078,
                0.140884,
                0,
                0.482837,
                0.913192,
                0.132709,
                0,
                0.499038,
                0.913175,
                0.125095,
                0,
                0.515324,
                0.91304,
                0.118012,
                0,
                0.531695,
                0.912781,
                0.111417,
                0,
                0.548153,
                0.91241,
                0.105281,
                0,
                0.5647,
                0.911924,
                0.0995691,
                0,
                0.581338,
                0.911331,
                0.0942531,
                0,
                0.59807,
                0.910637,
                0.0893076,
                0,
                0.6149,
                0.90984,
                0.0846998,
                0,
                0.63183,
                0.908941,
                0.0804044,
                0,
                0.648865,
                0.907944,
                0.0763984,
                0,
                0.666011,
                0.906857,
                0.0726638,
                0,
                0.683273,
                0.90568,
                0.0691783,
                0,
                0.700659,
                0.904416,
                0.0659222,
                0,
                0.718176,
                0.903067,
                0.0628782,
                0,
                0.735834,
                0.901637,
                0.0600307,
                0,
                0.753646,
                0.900128,
                0.0573647,
                0,
                0.771625,
                0.898544,
                0.0548668,
                0,
                0.78979,
                0.89689,
                0.052527,
                0,
                0.808162,
                0.895165,
                0.0503306,
                0,
                0.826771,
                0.893371,
                0.0482668,
                0,
                0.845654,
                0.891572,
                0.0463605,
                0,
                0.864863,
                0.889763,
                0.0445998,
                0,
                0.884472,
                0.887894,
                0.0429451,
                0,
                0.904592,
                0.885967,
                0.0413884,
                0,
                0.925407,
                0.883984,
                0.0399225,
                0,
                0.947271,
                0.881945,
                0.0385405,
                0,
                0.97105,
                0.879854,
                0.0372362,
                0,
                1,
                0.999804,
                0.995833,
                0,
                0,
                0.938155,
                0.933611,
                0,
                0.0158731,
                0.864755,
                0.854311,
                0,
                0.0317461,
                0.888594,
                0.865264,
                0,
                0.0476191,
                0.905575,
                0.863922,
                0,
                0.0634921,
                0.915125,
                0.850558,
                0,
                0.0793651,
                0.920665,
                0.829254,
                0,
                0.0952381,
                0.924073,
                0.802578,
                0,
                0.111111,
                0.926304,
                0.772211,
                0,
                0.126984,
                0.927829,
                0.739366,
                0,
                0.142857,
                0.928924,
                0.705033,
                0,
                0.15873,
                0.92973,
                0.670019,
                0,
                0.174603,
                0.930339,
                0.634993,
                0,
                0.190476,
                0.930811,
                0.600485,
                0,
                0.206349,
                0.931191,
                0.566897,
                0,
                0.222222,
                0.93149,
                0.534485,
                0,
                0.238095,
                0.931737,
                0.503429,
                0,
                0.253968,
                0.931939,
                0.473811,
                0,
                0.269841,
                0.932108,
                0.445668,
                0,
                0.285714,
                0.93225,
                0.418993,
                0,
                0.301587,
                0.932371,
                0.393762,
                0,
                0.31746,
                0.932474,
                0.369939,
                0,
                0.333333,
                0.932562,
                0.347479,
                0,
                0.349206,
                0.932638,
                0.326336,
                0,
                0.365079,
                0.932703,
                0.306462,
                0,
                0.380952,
                0.93276,
                0.287805,
                0,
                0.396825,
                0.932809,
                0.270313,
                0,
                0.412698,
                0.932851,
                0.253933,
                0,
                0.428571,
                0.932887,
                0.23861,
                0,
                0.444444,
                0.932917,
                0.224289,
                0,
                0.460317,
                0.932943,
                0.210917,
                0,
                0.47619,
                0.932965,
                0.19844,
                0,
                0.492063,
                0.932982,
                0.186807,
                0,
                0.507937,
                0.932995,
                0.175966,
                0,
                0.52381,
                0.933005,
                0.165869,
                0,
                0.539683,
                0.933011,
                0.156468,
                0,
                0.555556,
                0.933013,
                0.147719,
                0,
                0.571429,
                0.933013,
                0.139579,
                0,
                0.587302,
                0.93301,
                0.132007,
                0,
                0.603175,
                0.933004,
                0.124965,
                0,
                0.619048,
                0.932994,
                0.118416,
                0,
                0.634921,
                0.932982,
                0.112326,
                0,
                0.650794,
                0.932968,
                0.106663,
                0,
                0.666667,
                0.93295,
                0.101397,
                0,
                0.68254,
                0.932931,
                0.0964993,
                0,
                0.698413,
                0.932908,
                0.0919438,
                0,
                0.714286,
                0.932883,
                0.0877057,
                0,
                0.730159,
                0.932856,
                0.0837623,
                0,
                0.746032,
                0.932827,
                0.0800921,
                0,
                0.761905,
                0.932796,
                0.0766754,
                0,
                0.777778,
                0.932762,
                0.0734936,
                0,
                0.793651,
                0.932727,
                0.0705296,
                0,
                0.809524,
                0.932689,
                0.0677676,
                0,
                0.825397,
                0.93265,
                0.0651929,
                0,
                0.84127,
                0.932609,
                0.0627917,
                0,
                0.857143,
                0.932565,
                0.0605515,
                0,
                0.873016,
                0.932521,
                0.0584606,
                0,
                0.888889,
                0.932474,
                0.0565082,
                0,
                0.904762,
                0.932427,
                0.0546841,
                0,
                0.920635,
                0.932377,
                0.0529793,
                0,
                0.936508,
                0.932326,
                0.0513851,
                0,
                0.952381,
                0.932274,
                0.0498936,
                0,
                0.968254,
                0.93222,
                0.0484975,
                0,
                0.984127,
                0.932164,
                0.0471899,
                0,
                1
            ];
            var ltc_1 = new THREE.DataTexture(new Float32Array(LTC_MAT_1), 64, 64, THREE.RGBAFormat, THREE.FloatType, THREE.UVMapping, THREE.ClampToEdgeWrapping, THREE.ClampToEdgeWrapping, THREE.LinearFilter, THREE.NearestFilter, 1);
            var ltc_2 = new THREE.DataTexture(new Float32Array(LTC_MAT_2), 64, 64, THREE.RGBAFormat, THREE.FloatType, THREE.UVMapping, THREE.ClampToEdgeWrapping, THREE.ClampToEdgeWrapping, THREE.LinearFilter, THREE.NearestFilter, 1);
            THREE.UniformsLib.LTC_1 = ltc_1;
            THREE.UniformsLib.LTC_2 = ltc_2;
            var ltc = {
                ltc_1: { value: null },
                ltc_2: { value: null }
            };
            Object.assign(THREE.ShaderLib.standard.uniforms, ltc);
            Object.assign(THREE.ShaderLib.physical.uniforms, ltc);
        }
    };
    return threex.lights.RectAreaLightUniformsLib = RectAreaLightUniformsLib;
});
define('skylark-threejs-ex/lines/LineSegmentsGeometry',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var LineSegmentsGeometry = function () {
        THREE.InstancedBufferGeometry.call(this);
        this.type = 'LineSegmentsGeometry';
        var positions = [
            -1,
            2,
            0,
            1,
            2,
            0,
            -1,
            1,
            0,
            1,
            1,
            0,
            -1,
            0,
            0,
            1,
            0,
            0,
            -1,
            -1,
            0,
            1,
            -1,
            0
        ];
        var uvs = [
            -1,
            2,
            1,
            2,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            -1,
            -2,
            1,
            -2
        ];
        var index = [
            0,
            2,
            1,
            2,
            3,
            1,
            2,
            4,
            3,
            4,
            5,
            3,
            4,
            6,
            5,
            6,
            7,
            5
        ];
        this.setIndex(index);
        this.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
        this.setAttribute('uv', new THREE.Float32BufferAttribute(uvs, 2));
    };
    LineSegmentsGeometry.prototype = Object.assign(Object.create(THREE.InstancedBufferGeometry.prototype), {
        constructor: LineSegmentsGeometry,
        isLineSegmentsGeometry: true,
        applyMatrix4: function (matrix) {
            var start = this.attributes.instanceStart;
            var end = this.attributes.instanceEnd;
            if (start !== undefined) {
                start.applyMatrix4(matrix);
                end.applyMatrix4(matrix);
                start.data.needsUpdate = true;
            }
            if (this.boundingBox !== null) {
                this.computeBoundingBox();
            }
            if (this.boundingSphere !== null) {
                this.computeBoundingSphere();
            }
            return this;
        },
        setPositions: function (array) {
            var lineSegments;
            if (array instanceof Float32Array) {
                lineSegments = array;
            } else if (Array.isArray(array)) {
                lineSegments = new Float32Array(array);
            }
            var instanceBuffer = new THREE.InstancedInterleavedBuffer(lineSegments, 6, 1);
            this.setAttribute('instanceStart', new THREE.InterleavedBufferAttribute(instanceBuffer, 3, 0));
            this.setAttribute('instanceEnd', new THREE.InterleavedBufferAttribute(instanceBuffer, 3, 3));
            this.computeBoundingBox();
            this.computeBoundingSphere();
            return this;
        },
        setColors: function (array) {
            var colors;
            if (array instanceof Float32Array) {
                colors = array;
            } else if (Array.isArray(array)) {
                colors = new Float32Array(array);
            }
            var instanceColorBuffer = new THREE.InstancedInterleavedBuffer(colors, 6, 1);
            this.setAttribute('instanceColorStart', new THREE.InterleavedBufferAttribute(instanceColorBuffer, 3, 0));
            this.setAttribute('instanceColorEnd', new THREE.InterleavedBufferAttribute(instanceColorBuffer, 3, 3));
            return this;
        },
        fromWireframeGeometry: function (geometry) {
            this.setPositions(geometry.attributes.position.array);
            return this;
        },
        fromEdgesGeometry: function (geometry) {
            this.setPositions(geometry.attributes.position.array);
            return this;
        },
        fromMesh: function (mesh) {
            this.fromWireframeGeometry(new THREE.WireframeGeometry(mesh.geometry));
            return this;
        },
        fromLineSegements: function (lineSegments) {
            var geometry = lineSegments.geometry;
            if (geometry.isGeometry) {
                this.setPositions(geometry.vertices);
            } else if (geometry.isBufferGeometry) {
                this.setPositions(geometry.position.array);
            }
            return this;
        },
        computeBoundingBox: function () {
            var box = new THREE.Box3();
            return function computeBoundingBox() {
                if (this.boundingBox === null) {
                    this.boundingBox = new THREE.Box3();
                }
                var start = this.attributes.instanceStart;
                var end = this.attributes.instanceEnd;
                if (start !== undefined && end !== undefined) {
                    this.boundingBox.setFromBufferAttribute(start);
                    box.setFromBufferAttribute(end);
                    this.boundingBox.union(box);
                }
            };
        }(),
        computeBoundingSphere: function () {
            var vector = new THREE.Vector3();
            return function computeBoundingSphere() {
                if (this.boundingSphere === null) {
                    this.boundingSphere = new THREE.Sphere();
                }
                if (this.boundingBox === null) {
                    this.computeBoundingBox();
                }
                var start = this.attributes.instanceStart;
                var end = this.attributes.instanceEnd;
                if (start !== undefined && end !== undefined) {
                    var center = this.boundingSphere.center;
                    this.boundingBox.getCenter(center);
                    var maxRadiusSq = 0;
                    for (var i = 0, il = start.count; i < il; i++) {
                        vector.fromBufferAttribute(start, i);
                        maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(vector));
                        vector.fromBufferAttribute(end, i);
                        maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(vector));
                    }
                    this.boundingSphere.radius = Math.sqrt(maxRadiusSq);
                    if (isNaN(this.boundingSphere.radius)) {
                        console.error('THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.', this);
                    }
                }
            };
        }(),
        toJSON: function () {
        },
        applyMatrix: function (matrix) {
            console.warn('THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4().');
            return this.applyMatrix4(matrix);
        }
    });

    return threex.lines.LineSegmentsGeometry = LineSegmentsGeometry;
});
define('skylark-threejs-ex/lines/LineMaterial',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    THREE.UniformsLib.line = {
        linewidth: { value: 1 },
        resolution: { value: new THREE.Vector2(1, 1) },
        dashScale: { value: 1 },
        dashSize: { value: 1 },
        gapSize: { value: 1 }
    };
    THREE.ShaderLib['line'] = {
        uniforms: THREE.UniformsUtils.merge([
            THREE.UniformsLib.common,
            THREE.UniformsLib.fog,
            THREE.UniformsLib.line
        ]),
        vertexShader: `
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		varying vec2 vUv;

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;

			#endif

			float aspect = resolution.x / resolution.y;

			vUv = uv;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec2 ndcStart = clipStart.xy / clipStart.w;
			vec2 ndcEnd = clipEnd.xy / clipEnd.w;

			// direction
			vec2 dir = ndcEnd - ndcStart;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			// perpendicular to dir
			vec2 offset = vec2( dir.y, - dir.x );

			// undo aspect ratio adjustment
			dir.x /= aspect;
			offset.x /= aspect;

			// sign flip
			if ( position.x < 0.0 ) offset *= - 1.0;

			// endcaps
			if ( position.y < 0.0 ) {

				offset += - dir;

			} else if ( position.y > 1.0 ) {

				offset += dir;

			}

			// adjust for linewidth
			offset *= linewidth;

			// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
			offset /= resolution.y;

			// select end
			vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

			// back to clip space
			offset *= clip.w;

			clip.xy += offset;

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,
        fragmentShader: `
		uniform vec3 diffuse;
		uniform float opacity;

		#ifdef USE_DASH

			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		varying vec2 vUv;

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			if ( abs( vUv.y ) > 1.0 ) {

				float a = vUv.x;
				float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
				float len2 = a * a + b * b;

				if ( len2 > 1.0 ) discard;

			}

			vec4 diffuseColor = vec4( diffuse, opacity );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );

			#include <tonemapping_fragment>
			#include <encodings_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`
    };
    var LineMaterial = function (parameters) {
        THREE.ShaderMaterial.call(this, {
            type: 'LineMaterial',
            uniforms: THREE.UniformsUtils.clone(THREE.ShaderLib['line'].uniforms),
            vertexShader: THREE.ShaderLib['line'].vertexShader,
            fragmentShader: THREE.ShaderLib['line'].fragmentShader,
            clipping: true
        });
        this.dashed = false;
        Object.defineProperties(this, {
            color: {
                enumerable: true,
                get: function () {
                    return this.uniforms.diffuse.value;
                },
                set: function (value) {
                    this.uniforms.diffuse.value = value;
                }
            },
            linewidth: {
                enumerable: true,
                get: function () {
                    return this.uniforms.linewidth.value;
                },
                set: function (value) {
                    this.uniforms.linewidth.value = value;
                }
            },
            dashScale: {
                enumerable: true,
                get: function () {
                    return this.uniforms.dashScale.value;
                },
                set: function (value) {
                    this.uniforms.dashScale.value = value;
                }
            },
            dashSize: {
                enumerable: true,
                get: function () {
                    return this.uniforms.dashSize.value;
                },
                set: function (value) {
                    this.uniforms.dashSize.value = value;
                }
            },
            gapSize: {
                enumerable: true,
                get: function () {
                    return this.uniforms.gapSize.value;
                },
                set: function (value) {
                    this.uniforms.gapSize.value = value;
                }
            },
            resolution: {
                enumerable: true,
                get: function () {
                    return this.uniforms.resolution.value;
                },
                set: function (value) {
                    this.uniforms.resolution.value.copy(value);
                }
            }
        });
        this.setValues(parameters);
    };
    LineMaterial.prototype = Object.create(THREE.ShaderMaterial.prototype);
    LineMaterial.prototype.constructor = LineMaterial;
    LineMaterial.prototype.isLineMaterial = true;

    return threex.lines.LineMaterial = LineMaterial;
});
define('skylark-threejs-ex/lines/LineSegments2',[
    "skylark-threejs",
    "../threex",
    './LineSegmentsGeometry',
    './LineMaterial'
], function (
    THREE,
    threex,
    LineSegmentsGeometry, 
    LineMaterial
) {
    'use strict';
    var LineSegments2 = function (geometry, material) {
        THREE.Mesh.call(this);
        this.type = 'LineSegments2';
        this.geometry = geometry !== undefined ? geometry : new LineSegmentsGeometry();
        this.material = material !== undefined ? material : new LineMaterial({ color: Math.random() * 16777215 });
    };
    LineSegments2.prototype = Object.assign(Object.create(THREE.Mesh.prototype), {
        constructor: LineSegments2,
        isLineSegments2: true,
        computeLineDistances: function () {
            var start = new THREE.Vector3();
            var end = new THREE.Vector3();
            return function computeLineDistances() {
                var geometry = this.geometry;
                var instanceStart = geometry.attributes.instanceStart;
                var instanceEnd = geometry.attributes.instanceEnd;
                var lineDistances = new Float32Array(2 * instanceStart.data.count);
                for (var i = 0, j = 0, l = instanceStart.data.count; i < l; i++, j += 2) {
                    start.fromBufferAttribute(instanceStart, i);
                    end.fromBufferAttribute(instanceEnd, i);
                    lineDistances[j] = j === 0 ? 0 : lineDistances[j - 1];
                    lineDistances[j + 1] = lineDistances[j] + start.distanceTo(end);
                }
                var instanceDistanceBuffer = new THREE.InstancedInterleavedBuffer(lineDistances, 2, 1);
                geometry.setAttribute('instanceDistanceStart', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 0));
                geometry.setAttribute('instanceDistanceEnd', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 1));
                return this;
            };
        }(),
        raycast: function () {
            var start = new THREE.Vector4();
            var end = new THREE.Vector4();
            var ssOrigin = new THREE.Vector4();
            var ssOrigin3 = new THREE.Vector3();
            var mvMatrix = new THREE.Matrix4();
            var line = new THREE.Line3();
            var closestPoint = new THREE.Vector3();
            return function raycast(raycaster, intersects) {
                if (raycaster.camera === null) {
                    console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');
                }
                var ray = raycaster.ray;
                var camera = raycaster.camera;
                var projectionMatrix = camera.projectionMatrix;
                var geometry = this.geometry;
                var material = this.material;
                var resolution = material.resolution;
                var lineWidth = material.linewidth;
                var instanceStart = geometry.attributes.instanceStart;
                var instanceEnd = geometry.attributes.instanceEnd;
                ray.at(1, ssOrigin);
                ssOrigin.w = 1;
                ssOrigin.applyMatrix4(camera.matrixWorldInverse);
                ssOrigin.applyMatrix4(projectionMatrix);
                ssOrigin.multiplyScalar(1 / ssOrigin.w);
                ssOrigin.x *= resolution.x / 2;
                ssOrigin.y *= resolution.y / 2;
                ssOrigin.z = 0;
                ssOrigin3.copy(ssOrigin);
                var matrixWorld = this.matrixWorld;
                mvMatrix.multiplyMatrices(camera.matrixWorldInverse, matrixWorld);
                for (var i = 0, l = instanceStart.count; i < l; i++) {
                    start.fromBufferAttribute(instanceStart, i);
                    end.fromBufferAttribute(instanceEnd, i);
                    start.w = 1;
                    end.w = 1;
                    start.applyMatrix4(mvMatrix);
                    end.applyMatrix4(mvMatrix);
                    start.applyMatrix4(projectionMatrix);
                    end.applyMatrix4(projectionMatrix);
                    start.multiplyScalar(1 / start.w);
                    end.multiplyScalar(1 / end.w);
                    var isBehindCameraNear = start.z < -1 && end.z < -1;
                    var isPastCameraFar = start.z > 1 && end.z > 1;
                    if (isBehindCameraNear || isPastCameraFar) {
                        continue;
                    }
                    start.x *= resolution.x / 2;
                    start.y *= resolution.y / 2;
                    end.x *= resolution.x / 2;
                    end.y *= resolution.y / 2;
                    line.start.copy(start);
                    line.start.z = 0;
                    line.end.copy(end);
                    line.end.z = 0;
                    var param = line.closestPointToPointParameter(ssOrigin3, true);
                    line.at(param, closestPoint);
                    var zPos = THREE.MathUtils.lerp(start.z, end.z, param);
                    var isInClipSpace = zPos >= -1 && zPos <= 1;
                    var isInside = ssOrigin3.distanceTo(closestPoint) < lineWidth * 0.5;
                    if (isInClipSpace && isInside) {
                        line.start.fromBufferAttribute(instanceStart, i);
                        line.end.fromBufferAttribute(instanceEnd, i);
                        line.start.applyMatrix4(matrixWorld);
                        line.end.applyMatrix4(matrixWorld);
                        var pointOnLine = new THREE.Vector3();
                        var point = new THREE.Vector3();
                        ray.distanceSqToSegment(line.start, line.end, point, pointOnLine);
                        intersects.push({
                            point: point,
                            pointOnLine: pointOnLine,
                            distance: ray.origin.distanceTo(point),
                            object: this,
                            face: null,
                            faceIndex: i,
                            uv: null,
                            uv2: null
                        });
                    }
                }
            };
        }()
    });

    return threex.lines.LineSegments2 = LineSegments2;
});
define('skylark-threejs-ex/lines/LineGeometry',[
    "../threex",
    './LineSegmentsGeometry'
], function (
    threex,
    LineSegmentsGeometry
) {
    'use strict';
    var LineGeometry = function () {
        LineSegmentsGeometry.call(this);
        this.type = 'LineGeometry';
    };
    LineGeometry.prototype = Object.assign(Object.create(LineSegmentsGeometry.prototype), {
        constructor: LineGeometry,
        isLineGeometry: true,
        setPositions: function (array) {
            var length = array.length - 3;
            var points = new Float32Array(2 * length);
            for (var i = 0; i < length; i += 3) {
                points[2 * i] = array[i];
                points[2 * i + 1] = array[i + 1];
                points[2 * i + 2] = array[i + 2];
                points[2 * i + 3] = array[i + 3];
                points[2 * i + 4] = array[i + 4];
                points[2 * i + 5] = array[i + 5];
            }
            LineSegmentsGeometry.prototype.setPositions.call(this, points);
            return this;
        },
        setColors: function (array) {
            var length = array.length - 3;
            var colors = new Float32Array(2 * length);
            for (var i = 0; i < length; i += 3) {
                colors[2 * i] = array[i];
                colors[2 * i + 1] = array[i + 1];
                colors[2 * i + 2] = array[i + 2];
                colors[2 * i + 3] = array[i + 3];
                colors[2 * i + 4] = array[i + 4];
                colors[2 * i + 5] = array[i + 5];
            }
            LineSegmentsGeometry.prototype.setColors.call(this, colors);
            return this;
        },
        fromLine: function (line) {
            var geometry = line.geometry;
            if (geometry.isGeometry) {
                this.setPositions(geometry.vertices);
            } else if (geometry.isBufferGeometry) {
                this.setPositions(geometry.position.array);
            }
            return this;
        },
        copy: function () {
            return this;
        }
    });
    
    return threex.lines.LineGeometry = LineGeometry;
});
define('skylark-threejs-ex/lines/Line2',[
    "../threex",
    './LineSegments2',
    './LineGeometry',
    './LineMaterial'
], function (
    threex,
    LineSegments2, 
    LineGeometry, 
    LineMaterial
) {
    'use strict';
    var Line2 = function (geometry, material) {
        LineSegments2.call(this);
        this.type = 'Line2';
        this.geometry = geometry !== undefined ? geometry : new LineGeometry();
        this.material = material !== undefined ? material : new LineMaterial({ color: Math.random() * 16777215 });
    };
    Line2.prototype = Object.assign(Object.create(LineSegments2.prototype), {
        constructor: Line2,
        isLine2: true
    });

    return threex.lines.Line2 = Line2;
});
define('skylark-threejs-ex/lines/Wireframe',[
    "skylark-threejs",
    "../threex",
    './LineSegmentsGeometry',
    './LineMaterial'
], function (
    THREE, 
    threex,
    LineSegmentsGeometry, 
    LineMaterial
) {
    'use strict';
    var Wireframe = function (geometry, material) {
        THREE.Mesh.call(this);
        this.type = 'Wireframe';
        this.geometry = geometry !== undefined ? geometry : new LineSegmentsGeometry();
        this.material = material !== undefined ? material : new LineMaterial({ color: Math.random() * 16777215 });
    };
    Wireframe.prototype = Object.assign(Object.create(THREE.Mesh.prototype), {
        constructor: Wireframe,
        isWireframe: true,
        computeLineDistances: function () {
            var start = new THREE.Vector3();
            var end = new THREE.Vector3();
            return function computeLineDistances() {
                var geometry = this.geometry;
                var instanceStart = geometry.attributes.instanceStart;
                var instanceEnd = geometry.attributes.instanceEnd;
                var lineDistances = new Float32Array(2 * instanceStart.data.count);
                for (var i = 0, j = 0, l = instanceStart.data.count; i < l; i++, j += 2) {
                    start.fromBufferAttribute(instanceStart, i);
                    end.fromBufferAttribute(instanceEnd, i);
                    lineDistances[j] = j === 0 ? 0 : lineDistances[j - 1];
                    lineDistances[j + 1] = lineDistances[j] + start.distanceTo(end);
                }
                var instanceDistanceBuffer = new THREE.InstancedInterleavedBuffer(lineDistances, 2, 1);
                geometry.setAttribute('instanceDistanceStart', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 0));
                geometry.setAttribute('instanceDistanceEnd', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 1));
                return this;
            };
        }()
    });
    return threex.lines.Wireframe = Wireframe;
});
define('skylark-threejs-ex/lines/WireframeGeometry2',[
    "skylark-threejs",
    "../threex",
    './LineSegmentsGeometry'
], function (
    THREE,
    threex,
    LineSegmentsGeometry
) {
    'use strict';
    var WireframeGeometry2 = function (geometry) {
        LineSegmentsGeometry.call(this);
        this.type = 'WireframeGeometry2';
        this.fromWireframeGeometry(new THREE.WireframeGeometry(geometry));
    };
    WireframeGeometry2.prototype = Object.assign(Object.create(LineSegmentsGeometry.prototype), {
        constructor: WireframeGeometry2,
        isWireframeGeometry2: true
    });
    return threex.lines.WireframeGeometry2 = WireframeGeometry2;
});
define('skylark-threejs-ex/loaders/TTFLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var TTFLoader = function (manager) {
        THREE.Loader.call(this, manager);
        this.reversed = false;
    };
    TTFLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: TTFLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var loader = new THREE.FileLoader(this.manager);
            loader.setPath(this.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (buffer) {
                onLoad(scope.parse(buffer));
            }, onProgress, onError);
        },
        parse: function (arraybuffer) {
            function convert(font, reversed) {
                var round = Math.round;
                var glyphs = {};
                var scale = 100000 / ((font.unitsPerEm || 2048) * 72);
                var glyphIndexMap = font.encoding.cmap.glyphIndexMap;
                var unicodes = Object.keys(glyphIndexMap);
                for (var i = 0; i < unicodes.length; i++) {
                    var unicode = unicodes[i];
                    var glyph = font.glyphs.glyphs[glyphIndexMap[unicode]];
                    if (unicode !== undefined) {
                        var token = {
                            ha: round(glyph.advanceWidth * scale),
                            x_min: round(glyph.xMin * scale),
                            x_max: round(glyph.xMax * scale),
                            o: ''
                        };
                        if (reversed) {
                            glyph.path.commands = reverseCommands(glyph.path.commands);
                        }
                        glyph.path.commands.forEach(function (command) {
                            if (command.type.toLowerCase() === 'c') {
                                command.type = 'b';
                            }
                            token.o += command.type.toLowerCase() + ' ';
                            if (command.x !== undefined && command.y !== undefined) {
                                token.o += round(command.x * scale) + ' ' + round(command.y * scale) + ' ';
                            }
                            if (command.x1 !== undefined && command.y1 !== undefined) {
                                token.o += round(command.x1 * scale) + ' ' + round(command.y1 * scale) + ' ';
                            }
                            if (command.x2 !== undefined && command.y2 !== undefined) {
                                token.o += round(command.x2 * scale) + ' ' + round(command.y2 * scale) + ' ';
                            }
                        });
                        glyphs[String.fromCodePoint(glyph.unicode)] = token;
                    }
                }
                return {
                    glyphs: glyphs,
                    familyName: font.getEnglishName('fullName'),
                    ascender: round(font.ascender * scale),
                    descender: round(font.descender * scale),
                    underlinePosition: font.tables.post.underlinePosition,
                    underlineThickness: font.tables.post.underlineThickness,
                    boundingBox: {
                        xMin: font.tables.head.xMin,
                        xMax: font.tables.head.xMax,
                        yMin: font.tables.head.yMin,
                        yMax: font.tables.head.yMax
                    },
                    resolution: 1000,
                    original_font_information: font.tables.name
                };
            }
            function reverseCommands(commands) {
                var paths = [];
                var path;
                commands.forEach(function (c) {
                    if (c.type.toLowerCase() === 'm') {
                        path = [c];
                        paths.push(path);
                    } else if (c.type.toLowerCase() !== 'z') {
                        path.push(c);
                    }
                });
                var reversed = [];
                paths.forEach(function (p) {
                    var result = {
                        type: 'm',
                        x: p[p.length - 1].x,
                        y: p[p.length - 1].y
                    };
                    reversed.push(result);
                    for (var i = p.length - 1; i > 0; i--) {
                        var command = p[i];
                        var result = { type: command.type };
                        if (command.x2 !== undefined && command.y2 !== undefined) {
                            result.x1 = command.x2;
                            result.y1 = command.y2;
                            result.x2 = command.x1;
                            result.y2 = command.y1;
                        } else if (command.x1 !== undefined && command.y1 !== undefined) {
                            result.x1 = command.x1;
                            result.y1 = command.y1;
                        }
                        result.x = p[i - 1].x;
                        result.y = p[i - 1].y;
                        reversed.push(result);
                    }
                });
                return reversed;
            }
            if (typeof opentype === 'undefined') {
                console.warn("THREE.TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader.");
                return null;
            }
            return convert(opentype.parse(arraybuffer), this.reversed);
        }
    });
    return threex.loaders.TTFLoader = TTFLoader;
});
define('skylark-threejs-ex/loaders/3MFLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ThreeMFLoader = function (manager) {
        THREE.Loader.call(this, manager);
        this.availableExtensions = [];
    };
    ThreeMFLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: ThreeMFLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var loader = new THREE.FileLoader(scope.manager);
            loader.setPath(scope.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (buffer) {
                onLoad(scope.parse(buffer));
            }, onProgress, onError);
        },
        parse: function (data) {
            var scope = this;
            var textureLoader = new THREE.TextureLoader(this.manager);
            function loadDocument(data) {
                var zip = null;
                var file = null;
                var relsName;
                var modelRelsName;
                var modelPartNames = [];
                var printTicketPartNames = [];
                var texturesPartNames = [];
                var otherPartNames = [];
                var rels;
                var modelRels;
                var modelParts = {};
                var printTicketParts = {};
                var texturesParts = {};
                var otherParts = {};
                try {
                    zip = new JSZip(data);
                } catch (e) {
                    if (e instanceof ReferenceError) {
                        console.error('THREE.3MFLoader: jszip missing and file is compressed.');
                        return null;
                    }
                }
                for (file in zip.files) {
                    if (file.match(/\_rels\/.rels$/)) {
                        relsName = file;
                    } else if (file.match(/3D\/_rels\/.*\.model\.rels$/)) {
                        modelRelsName = file;
                    } else if (file.match(/^3D\/.*\.model$/)) {
                        modelPartNames.push(file);
                    } else if (file.match(/^3D\/Metadata\/.*\.xml$/)) {
                        printTicketPartNames.push(file);
                    } else if (file.match(/^3D\/Textures?\/.*/)) {
                        texturesPartNames.push(file);
                    } else if (file.match(/^3D\/Other\/.*/)) {
                        otherPartNames.push(file);
                    }
                }
                var relsView = new Uint8Array(zip.file(relsName).asArrayBuffer());
                var relsFileText = THREE.LoaderUtils.decodeText(relsView);
                rels = parseRelsXml(relsFileText);
                if (modelRelsName) {
                    var relsView = new Uint8Array(zip.file(modelRelsName).asArrayBuffer());
                    var relsFileText = THREE.LoaderUtils.decodeText(relsView);
                    modelRels = parseRelsXml(relsFileText);
                }
                for (var i = 0; i < modelPartNames.length; i++) {
                    var modelPart = modelPartNames[i];
                    var view = new Uint8Array(zip.file(modelPart).asArrayBuffer());
                    var fileText = THREE.LoaderUtils.decodeText(view);
                    var xmlData = new DOMParser().parseFromString(fileText, 'application/xml');
                    if (xmlData.documentElement.nodeName.toLowerCase() !== 'model') {
                        console.error('THREE.3MFLoader: Error loading 3MF - no 3MF document found: ', modelPart);
                    }
                    var modelNode = xmlData.querySelector('model');
                    var extensions = {};
                    for (var i = 0; i < modelNode.attributes.length; i++) {
                        var attr = modelNode.attributes[i];
                        if (attr.name.match(/^xmlns:(.+)$/)) {
                            extensions[attr.value] = RegExp.$1;
                        }
                    }
                    var modelData = parseModelNode(modelNode);
                    modelData['xml'] = modelNode;
                    if (0 < Object.keys(extensions).length) {
                        modelData['extensions'] = extensions;
                    }
                    modelParts[modelPart] = modelData;
                }
                for (var i = 0; i < texturesPartNames.length; i++) {
                    var texturesPartName = texturesPartNames[i];
                    texturesParts[texturesPartName] = zip.file(texturesPartName).asArrayBuffer();
                }
                return {
                    rels: rels,
                    modelRels: modelRels,
                    model: modelParts,
                    printTicket: printTicketParts,
                    texture: texturesParts,
                    other: otherParts
                };
            }
            function parseRelsXml(relsFileText) {
                var relationships = [];
                var relsXmlData = new DOMParser().parseFromString(relsFileText, 'application/xml');
                var relsNodes = relsXmlData.querySelectorAll('Relationship');
                for (var i = 0; i < relsNodes.length; i++) {
                    var relsNode = relsNodes[i];
                    var relationship = {
                        target: relsNode.getAttribute('Target'),
                        id: relsNode.getAttribute('Id'),
                        type: relsNode.getAttribute('Type')
                    };
                    relationships.push(relationship);
                }
                return relationships;
            }
            function parseMetadataNodes(metadataNodes) {
                var metadataData = {};
                for (var i = 0; i < metadataNodes.length; i++) {
                    var metadataNode = metadataNodes[i];
                    var name = metadataNode.getAttribute('name');
                    var validNames = [
                        'Title',
                        'Designer',
                        'Description',
                        'Copyright',
                        'LicenseTerms',
                        'Rating',
                        'CreationDate',
                        'ModificationDate'
                    ];
                    if (0 <= validNames.indexOf(name)) {
                        metadataData[name] = metadataNode.textContent;
                    }
                }
                return metadataData;
            }
            function parseBasematerialsNode(basematerialsNode) {
                var basematerialsData = {
                    id: basematerialsNode.getAttribute('id'),
                    basematerials: []
                };
                var basematerialNodes = basematerialsNode.querySelectorAll('base');
                for (var i = 0; i < basematerialNodes.length; i++) {
                    var basematerialNode = basematerialNodes[i];
                    var basematerialData = parseBasematerialNode(basematerialNode);
                    basematerialData.index = i;
                    basematerialsData.basematerials.push(basematerialData);
                }
                return basematerialsData;
            }
            function parseTexture2DNode(texture2DNode) {
                var texture2dData = {
                    id: texture2DNode.getAttribute('id'),
                    path: texture2DNode.getAttribute('path'),
                    contenttype: texture2DNode.getAttribute('contenttype'),
                    tilestyleu: texture2DNode.getAttribute('tilestyleu'),
                    tilestylev: texture2DNode.getAttribute('tilestylev'),
                    filter: texture2DNode.getAttribute('filter')
                };
                return texture2dData;
            }
            function parseTextures2DGroupNode(texture2DGroupNode) {
                var texture2DGroupData = {
                    id: texture2DGroupNode.getAttribute('id'),
                    texid: texture2DGroupNode.getAttribute('texid'),
                    displaypropertiesid: texture2DGroupNode.getAttribute('displaypropertiesid')
                };
                var tex2coordNodes = texture2DGroupNode.querySelectorAll('tex2coord');
                var uvs = [];
                for (var i = 0; i < tex2coordNodes.length; i++) {
                    var tex2coordNode = tex2coordNodes[i];
                    var u = tex2coordNode.getAttribute('u');
                    var v = tex2coordNode.getAttribute('v');
                    uvs.push(parseFloat(u), parseFloat(v));
                }
                texture2DGroupData['uvs'] = new Float32Array(uvs);
                return texture2DGroupData;
            }
            function parseColorGroupNode(colorGroupNode) {
                var colorGroupData = {
                    id: colorGroupNode.getAttribute('id'),
                    displaypropertiesid: colorGroupNode.getAttribute('displaypropertiesid')
                };
                var colorNodes = colorGroupNode.querySelectorAll('color');
                var colors = [];
                var colorObject = new THREE.Color();
                for (var i = 0; i < colorNodes.length; i++) {
                    var colorNode = colorNodes[i];
                    var color = colorNode.getAttribute('color');
                    colorObject.setStyle(color.substring(0, 7));
                    colorObject.convertSRGBToLinear();
                    colors.push(colorObject.r, colorObject.g, colorObject.b);
                }
                colorGroupData['colors'] = new Float32Array(colors);
                return colorGroupData;
            }
            function parseMetallicDisplaypropertiesNode(metallicDisplaypropetiesNode) {
                var metallicDisplaypropertiesData = { id: metallicDisplaypropetiesNode.getAttribute('id') };
                var metallicNodes = metallicDisplaypropetiesNode.querySelectorAll('pbmetallic');
                var metallicData = [];
                for (var i = 0; i < metallicNodes.length; i++) {
                    var metallicNode = metallicNodes[i];
                    metallicData.push({
                        name: metallicNode.getAttribute('name'),
                        metallicness: parseFloat(metallicNode.getAttribute('metallicness')),
                        roughness: parseFloat(metallicNode.getAttribute('roughness'))
                    });
                }
                metallicDisplaypropertiesData.data = metallicData;
                return metallicDisplaypropertiesData;
            }
            function parseBasematerialNode(basematerialNode) {
                var basematerialData = {};
                basematerialData['name'] = basematerialNode.getAttribute('name');
                basematerialData['displaycolor'] = basematerialNode.getAttribute('displaycolor');
                basematerialData['displaypropertiesid'] = basematerialNode.getAttribute('displaypropertiesid');
                return basematerialData;
            }
            function parseMeshNode(meshNode) {
                var meshData = {};
                var vertices = [];
                var vertexNodes = meshNode.querySelectorAll('vertices vertex');
                for (var i = 0; i < vertexNodes.length; i++) {
                    var vertexNode = vertexNodes[i];
                    var x = vertexNode.getAttribute('x');
                    var y = vertexNode.getAttribute('y');
                    var z = vertexNode.getAttribute('z');
                    vertices.push(parseFloat(x), parseFloat(y), parseFloat(z));
                }
                meshData['vertices'] = new Float32Array(vertices);
                var triangleProperties = [];
                var triangles = [];
                var triangleNodes = meshNode.querySelectorAll('triangles triangle');
                for (var i = 0; i < triangleNodes.length; i++) {
                    var triangleNode = triangleNodes[i];
                    var v1 = triangleNode.getAttribute('v1');
                    var v2 = triangleNode.getAttribute('v2');
                    var v3 = triangleNode.getAttribute('v3');
                    var p1 = triangleNode.getAttribute('p1');
                    var p2 = triangleNode.getAttribute('p2');
                    var p3 = triangleNode.getAttribute('p3');
                    var pid = triangleNode.getAttribute('pid');
                    var triangleProperty = {};
                    triangleProperty['v1'] = parseInt(v1, 10);
                    triangleProperty['v2'] = parseInt(v2, 10);
                    triangleProperty['v3'] = parseInt(v3, 10);
                    triangles.push(triangleProperty['v1'], triangleProperty['v2'], triangleProperty['v3']);
                    if (p1) {
                        triangleProperty['p1'] = parseInt(p1, 10);
                    }
                    if (p2) {
                        triangleProperty['p2'] = parseInt(p2, 10);
                    }
                    if (p3) {
                        triangleProperty['p3'] = parseInt(p3, 10);
                    }
                    if (pid) {
                        triangleProperty['pid'] = pid;
                    }
                    if (0 < Object.keys(triangleProperty).length) {
                        triangleProperties.push(triangleProperty);
                    }
                }
                meshData['triangleProperties'] = triangleProperties;
                meshData['triangles'] = new Uint32Array(triangles);
                return meshData;
            }
            function parseComponentsNode(componentsNode) {
                var components = [];
                var componentNodes = componentsNode.querySelectorAll('component');
                for (var i = 0; i < componentNodes.length; i++) {
                    var componentNode = componentNodes[i];
                    var componentData = parseComponentNode(componentNode);
                    components.push(componentData);
                }
                return components;
            }
            function parseComponentNode(componentNode) {
                var componentData = {};
                componentData['objectId'] = componentNode.getAttribute('objectid');
                var transform = componentNode.getAttribute('transform');
                if (transform) {
                    componentData['transform'] = parseTransform(transform);
                }
                return componentData;
            }
            function parseTransform(transform) {
                var t = [];
                transform.split(' ').forEach(function (s) {
                    t.push(parseFloat(s));
                });
                var matrix = new THREE.Matrix4();
                matrix.set(t[0], t[3], t[6], t[9], t[1], t[4], t[7], t[10], t[2], t[5], t[8], t[11], 0, 0, 0, 1);
                return matrix;
            }
            function parseObjectNode(objectNode) {
                var objectData = { type: objectNode.getAttribute('type') };
                var id = objectNode.getAttribute('id');
                if (id) {
                    objectData['id'] = id;
                }
                var pid = objectNode.getAttribute('pid');
                if (pid) {
                    objectData['pid'] = pid;
                }
                var pindex = objectNode.getAttribute('pindex');
                if (pindex) {
                    objectData['pindex'] = pindex;
                }
                var thumbnail = objectNode.getAttribute('thumbnail');
                if (thumbnail) {
                    objectData['thumbnail'] = thumbnail;
                }
                var partnumber = objectNode.getAttribute('partnumber');
                if (partnumber) {
                    objectData['partnumber'] = partnumber;
                }
                var name = objectNode.getAttribute('name');
                if (name) {
                    objectData['name'] = name;
                }
                var meshNode = objectNode.querySelector('mesh');
                if (meshNode) {
                    objectData['mesh'] = parseMeshNode(meshNode);
                }
                var componentsNode = objectNode.querySelector('components');
                if (componentsNode) {
                    objectData['components'] = parseComponentsNode(componentsNode);
                }
                return objectData;
            }
            function parseResourcesNode(resourcesNode) {
                var resourcesData = {};
                resourcesData['basematerials'] = {};
                var basematerialsNodes = resourcesNode.querySelectorAll('basematerials');
                for (var i = 0; i < basematerialsNodes.length; i++) {
                    var basematerialsNode = basematerialsNodes[i];
                    var basematerialsData = parseBasematerialsNode(basematerialsNode);
                    resourcesData['basematerials'][basematerialsData['id']] = basematerialsData;
                }
                resourcesData['texture2d'] = {};
                var textures2DNodes = resourcesNode.querySelectorAll('texture2d');
                for (var i = 0; i < textures2DNodes.length; i++) {
                    var textures2DNode = textures2DNodes[i];
                    var texture2DData = parseTexture2DNode(textures2DNode);
                    resourcesData['texture2d'][texture2DData['id']] = texture2DData;
                }
                resourcesData['colorgroup'] = {};
                var colorGroupNodes = resourcesNode.querySelectorAll('colorgroup');
                for (var i = 0; i < colorGroupNodes.length; i++) {
                    var colorGroupNode = colorGroupNodes[i];
                    var colorGroupData = parseColorGroupNode(colorGroupNode);
                    resourcesData['colorgroup'][colorGroupData['id']] = colorGroupData;
                }
                resourcesData['pbmetallicdisplayproperties'] = {};
                var pbmetallicdisplaypropertiesNodes = resourcesNode.querySelectorAll('pbmetallicdisplayproperties');
                for (var i = 0; i < pbmetallicdisplaypropertiesNodes.length; i++) {
                    var pbmetallicdisplaypropertiesNode = pbmetallicdisplaypropertiesNodes[i];
                    var pbmetallicdisplaypropertiesData = parseMetallicDisplaypropertiesNode(pbmetallicdisplaypropertiesNode);
                    resourcesData['pbmetallicdisplayproperties'][pbmetallicdisplaypropertiesData['id']] = pbmetallicdisplaypropertiesData;
                }
                resourcesData['texture2dgroup'] = {};
                var textures2DGroupNodes = resourcesNode.querySelectorAll('texture2dgroup');
                for (var i = 0; i < textures2DGroupNodes.length; i++) {
                    var textures2DGroupNode = textures2DGroupNodes[i];
                    var textures2DGroupData = parseTextures2DGroupNode(textures2DGroupNode);
                    resourcesData['texture2dgroup'][textures2DGroupData['id']] = textures2DGroupData;
                }
                resourcesData['object'] = {};
                var objectNodes = resourcesNode.querySelectorAll('object');
                for (var i = 0; i < objectNodes.length; i++) {
                    var objectNode = objectNodes[i];
                    var objectData = parseObjectNode(objectNode);
                    resourcesData['object'][objectData['id']] = objectData;
                }
                return resourcesData;
            }
            function parseBuildNode(buildNode) {
                var buildData = [];
                var itemNodes = buildNode.querySelectorAll('item');
                for (var i = 0; i < itemNodes.length; i++) {
                    var itemNode = itemNodes[i];
                    var buildItem = { objectId: itemNode.getAttribute('objectid') };
                    var transform = itemNode.getAttribute('transform');
                    if (transform) {
                        buildItem['transform'] = parseTransform(transform);
                    }
                    buildData.push(buildItem);
                }
                return buildData;
            }
            function parseModelNode(modelNode) {
                var modelData = { unit: modelNode.getAttribute('unit') || 'millimeter' };
                var metadataNodes = modelNode.querySelectorAll('metadata');
                if (metadataNodes) {
                    modelData['metadata'] = parseMetadataNodes(metadataNodes);
                }
                var resourcesNode = modelNode.querySelector('resources');
                if (resourcesNode) {
                    modelData['resources'] = parseResourcesNode(resourcesNode);
                }
                var buildNode = modelNode.querySelector('build');
                if (buildNode) {
                    modelData['build'] = parseBuildNode(buildNode);
                }
                return modelData;
            }
            function buildTexture(texture2dgroup, objects, modelData, textureData) {
                var texid = texture2dgroup.texid;
                var texture2ds = modelData.resources.texture2d;
                var texture2d = texture2ds[texid];
                if (texture2d) {
                    var data = textureData[texture2d.path];
                    var type = texture2d.contenttype;
                    var blob = new Blob([data], { type: type });
                    var sourceURI = URL.createObjectURL(blob);
                    var texture = textureLoader.load(sourceURI, function () {
                        URL.revokeObjectURL(sourceURI);
                    });
                    texture.encoding = THREE.sRGBEncoding;
                    switch (texture2d.tilestyleu) {
                    case 'wrap':
                        texture.wrapS = THREE.RepeatWrapping;
                        break;
                    case 'mirror':
                        texture.wrapS = THREE.MirroredRepeatWrapping;
                        break;
                    case 'none':
                    case 'clamp':
                        texture.wrapS = THREE.ClampToEdgeWrapping;
                        break;
                    default:
                        texture.wrapS = THREE.RepeatWrapping;
                    }
                    switch (texture2d.tilestylev) {
                    case 'wrap':
                        texture.wrapT = THREE.RepeatWrapping;
                        break;
                    case 'mirror':
                        texture.wrapT = THREE.MirroredRepeatWrapping;
                        break;
                    case 'none':
                    case 'clamp':
                        texture.wrapT = THREE.ClampToEdgeWrapping;
                        break;
                    default:
                        texture.wrapT = THREE.RepeatWrapping;
                    }
                    switch (texture2d.filter) {
                    case 'auto':
                        texture.magFilter = THREE.LinearFilter;
                        texture.minFilter = THREE.LinearMipmapLinearFilter;
                        break;
                    case 'linear':
                        texture.magFilter = THREE.LinearFilter;
                        texture.minFilter = THREE.LinearFilter;
                        break;
                    case 'nearest':
                        texture.magFilter = THREE.NearestFilter;
                        texture.minFilter = THREE.NearestFilter;
                        break;
                    default:
                        texture.magFilter = THREE.LinearFilter;
                        texture.minFilter = THREE.LinearMipmapLinearFilter;
                    }
                    return texture;
                } else {
                    return null;
                }
            }
            function buildBasematerialsMeshes(basematerials, triangleProperties, modelData, meshData, textureData, objectData) {
                var objectPindex = objectData.pindex;
                var materialMap = {};
                for (var i = 0, l = triangleProperties.length; i < l; i++) {
                    var triangleProperty = triangleProperties[i];
                    var pindex = triangleProperty.p1 !== undefined ? triangleProperty.p1 : objectPindex;
                    if (materialMap[pindex] === undefined)
                        materialMap[pindex] = [];
                    materialMap[pindex].push(triangleProperty);
                }
                var keys = Object.keys(materialMap);
                var meshes = [];
                for (var i = 0, l = keys.length; i < l; i++) {
                    var materialIndex = keys[i];
                    var trianglePropertiesProps = materialMap[materialIndex];
                    var basematerialData = basematerials.basematerials[materialIndex];
                    var material = getBuild(basematerialData, objects, modelData, textureData, objectData, buildBasematerial);
                    var geometry = new THREE.BufferGeometry();
                    var positionData = [];
                    var vertices = meshData.vertices;
                    for (var j = 0, jl = trianglePropertiesProps.length; j < jl; j++) {
                        var triangleProperty = trianglePropertiesProps[j];
                        positionData.push(vertices[triangleProperty.v1 * 3 + 0]);
                        positionData.push(vertices[triangleProperty.v1 * 3 + 1]);
                        positionData.push(vertices[triangleProperty.v1 * 3 + 2]);
                        positionData.push(vertices[triangleProperty.v2 * 3 + 0]);
                        positionData.push(vertices[triangleProperty.v2 * 3 + 1]);
                        positionData.push(vertices[triangleProperty.v2 * 3 + 2]);
                        positionData.push(vertices[triangleProperty.v3 * 3 + 0]);
                        positionData.push(vertices[triangleProperty.v3 * 3 + 1]);
                        positionData.push(vertices[triangleProperty.v3 * 3 + 2]);
                    }
                    geometry.setAttribute('position', new THREE.Float32BufferAttribute(positionData, 3));
                    var mesh = new THREE.Mesh(geometry, material);
                    meshes.push(mesh);
                }
                return meshes;
            }
            function buildTexturedMesh(texture2dgroup, triangleProperties, modelData, meshData, textureData, objectData) {
                var geometry = new THREE.BufferGeometry();
                var positionData = [];
                var uvData = [];
                var vertices = meshData.vertices;
                var uvs = texture2dgroup.uvs;
                for (var i = 0, l = triangleProperties.length; i < l; i++) {
                    var triangleProperty = triangleProperties[i];
                    positionData.push(vertices[triangleProperty.v1 * 3 + 0]);
                    positionData.push(vertices[triangleProperty.v1 * 3 + 1]);
                    positionData.push(vertices[triangleProperty.v1 * 3 + 2]);
                    positionData.push(vertices[triangleProperty.v2 * 3 + 0]);
                    positionData.push(vertices[triangleProperty.v2 * 3 + 1]);
                    positionData.push(vertices[triangleProperty.v2 * 3 + 2]);
                    positionData.push(vertices[triangleProperty.v3 * 3 + 0]);
                    positionData.push(vertices[triangleProperty.v3 * 3 + 1]);
                    positionData.push(vertices[triangleProperty.v3 * 3 + 2]);
                    uvData.push(uvs[triangleProperty.p1 * 2 + 0]);
                    uvData.push(uvs[triangleProperty.p1 * 2 + 1]);
                    uvData.push(uvs[triangleProperty.p2 * 2 + 0]);
                    uvData.push(uvs[triangleProperty.p2 * 2 + 1]);
                    uvData.push(uvs[triangleProperty.p3 * 2 + 0]);
                    uvData.push(uvs[triangleProperty.p3 * 2 + 1]);
                }
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(positionData, 3));
                geometry.setAttribute('uv', new THREE.Float32BufferAttribute(uvData, 2));
                var texture = getBuild(texture2dgroup, objects, modelData, textureData, objectData, buildTexture);
                var material = new THREE.MeshPhongMaterial({
                    map: texture,
                    flatShading: true
                });
                var mesh = new THREE.Mesh(geometry, material);
                return mesh;
            }
            function buildVertexColorMesh(colorgroup, triangleProperties, modelData, meshData) {
                var geometry = new THREE.BufferGeometry();
                var positionData = [];
                var colorData = [];
                var vertices = meshData.vertices;
                var colors = colorgroup.colors;
                for (var i = 0, l = triangleProperties.length; i < l; i++) {
                    var triangleProperty = triangleProperties[i];
                    var v1 = triangleProperty.v1;
                    var v2 = triangleProperty.v2;
                    var v3 = triangleProperty.v3;
                    positionData.push(vertices[v1 * 3 + 0]);
                    positionData.push(vertices[v1 * 3 + 1]);
                    positionData.push(vertices[v1 * 3 + 2]);
                    positionData.push(vertices[v2 * 3 + 0]);
                    positionData.push(vertices[v2 * 3 + 1]);
                    positionData.push(vertices[v2 * 3 + 2]);
                    positionData.push(vertices[v3 * 3 + 0]);
                    positionData.push(vertices[v3 * 3 + 1]);
                    positionData.push(vertices[v3 * 3 + 2]);
                    var p1 = triangleProperty.p1;
                    var p2 = triangleProperty.p2;
                    var p3 = triangleProperty.p3;
                    colorData.push(colors[p1 * 3 + 0]);
                    colorData.push(colors[p1 * 3 + 1]);
                    colorData.push(colors[p1 * 3 + 2]);
                    colorData.push(colors[(p2 || p1) * 3 + 0]);
                    colorData.push(colors[(p2 || p1) * 3 + 1]);
                    colorData.push(colors[(p2 || p1) * 3 + 2]);
                    colorData.push(colors[(p3 || p1) * 3 + 0]);
                    colorData.push(colors[(p3 || p1) * 3 + 1]);
                    colorData.push(colors[(p3 || p1) * 3 + 2]);
                }
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(positionData, 3));
                geometry.setAttribute('color', new THREE.Float32BufferAttribute(colorData, 3));
                var material = new THREE.MeshPhongMaterial({
                    vertexColors: true,
                    flatShading: true
                });
                var mesh = new THREE.Mesh(geometry, material);
                return mesh;
            }
            function buildDefaultMesh(meshData) {
                var geometry = new THREE.BufferGeometry();
                geometry.setIndex(new THREE.BufferAttribute(meshData['triangles'], 1));
                geometry.setAttribute('position', new THREE.BufferAttribute(meshData['vertices'], 3));
                var material = new THREE.MeshPhongMaterial({
                    color: 11184895,
                    flatShading: true
                });
                var mesh = new THREE.Mesh(geometry, material);
                return mesh;
            }
            function buildMeshes(resourceMap, modelData, meshData, textureData, objectData) {
                var keys = Object.keys(resourceMap);
                var meshes = [];
                for (var i = 0, il = keys.length; i < il; i++) {
                    var resourceId = keys[i];
                    var triangleProperties = resourceMap[resourceId];
                    var resourceType = getResourceType(resourceId, modelData);
                    switch (resourceType) {
                    case 'material':
                        var basematerials = modelData.resources.basematerials[resourceId];
                        var newMeshes = buildBasematerialsMeshes(basematerials, triangleProperties, modelData, meshData, textureData, objectData);
                        for (var j = 0, jl = newMeshes.length; j < jl; j++) {
                            meshes.push(newMeshes[j]);
                        }
                        break;
                    case 'texture':
                        var texture2dgroup = modelData.resources.texture2dgroup[resourceId];
                        meshes.push(buildTexturedMesh(texture2dgroup, triangleProperties, modelData, meshData, textureData, objectData));
                        break;
                    case 'vertexColors':
                        var colorgroup = modelData.resources.colorgroup[resourceId];
                        meshes.push(buildVertexColorMesh(colorgroup, triangleProperties, modelData, meshData));
                        break;
                    case 'default':
                        meshes.push(buildDefaultMesh(meshData));
                        break;
                    default:
                        console.error('THREE.3MFLoader: Unsupported resource type.');
                    }
                }
                return meshes;
            }
            function getResourceType(pid, modelData) {
                if (modelData.resources.texture2dgroup[pid] !== undefined) {
                    return 'texture';
                } else if (modelData.resources.basematerials[pid] !== undefined) {
                    return 'material';
                } else if (modelData.resources.colorgroup[pid] !== undefined) {
                    return 'vertexColors';
                } else if (pid === 'default') {
                    return 'default';
                } else {
                    return undefined;
                }
            }
            function analyzeObject(modelData, meshData, objectData) {
                var resourceMap = {};
                var triangleProperties = meshData['triangleProperties'];
                var objectPid = objectData.pid;
                for (var i = 0, l = triangleProperties.length; i < l; i++) {
                    var triangleProperty = triangleProperties[i];
                    var pid = triangleProperty.pid !== undefined ? triangleProperty.pid : objectPid;
                    if (pid === undefined)
                        pid = 'default';
                    if (resourceMap[pid] === undefined)
                        resourceMap[pid] = [];
                    resourceMap[pid].push(triangleProperty);
                }
                return resourceMap;
            }
            function buildGroup(meshData, objects, modelData, textureData, objectData) {
                var group = new THREE.Group();
                var resourceMap = analyzeObject(modelData, meshData, objectData);
                var meshes = buildMeshes(resourceMap, modelData, meshData, textureData, objectData);
                for (var i = 0, l = meshes.length; i < l; i++) {
                    group.add(meshes[i]);
                }
                return group;
            }
            function applyExtensions(extensions, meshData, modelXml) {
                if (!extensions) {
                    return;
                }
                var availableExtensions = [];
                var keys = Object.keys(extensions);
                for (var i = 0; i < keys.length; i++) {
                    var ns = keys[i];
                    for (var j = 0; j < scope.availableExtensions.length; j++) {
                        var extension = scope.availableExtensions[j];
                        if (extension.ns === ns) {
                            availableExtensions.push(extension);
                        }
                    }
                }
                for (var i = 0; i < availableExtensions.length; i++) {
                    var extension = availableExtensions[i];
                    extension.apply(modelXml, extensions[extension['ns']], meshData);
                }
            }
            function getBuild(data, objects, modelData, textureData, objectData, builder) {
                if (data.build !== undefined)
                    return data.build;
                data.build = builder(data, objects, modelData, textureData, objectData);
                return data.build;
            }
            function buildBasematerial(materialData, objects, modelData) {
                var material;
                var displaypropertiesid = materialData.displaypropertiesid;
                var pbmetallicdisplayproperties = modelData.resources.pbmetallicdisplayproperties;
                if (displaypropertiesid !== null && pbmetallicdisplayproperties[displaypropertiesid] !== undefined) {
                    var pbmetallicdisplayproperty = pbmetallicdisplayproperties[displaypropertiesid];
                    var metallicData = pbmetallicdisplayproperty.data[materialData.index];
                    material = new THREE.MeshStandardMaterial({
                        flatShading: true,
                        roughness: metallicData.roughness,
                        metalness: metallicData.metallicness
                    });
                } else {
                    material = new THREE.MeshPhongMaterial({ flatShading: true });
                }
                material.name = materialData.name;
                var displaycolor = materialData.displaycolor;
                var color = displaycolor.substring(0, 7);
                material.color.setStyle(color);
                material.color.convertSRGBToLinear();
                if (displaycolor.length === 9) {
                    material.opacity = parseInt(displaycolor.charAt(7) + displaycolor.charAt(8), 16) / 255;
                }
                return material;
            }
            function buildComposite(compositeData, objects, modelData, textureData) {
                var composite = new THREE.Group();
                for (var j = 0; j < compositeData.length; j++) {
                    var component = compositeData[j];
                    var build = objects[component.objectId];
                    if (build === undefined) {
                        buildObject(component.objectId, objects, modelData, textureData);
                        build = objects[component.objectId];
                    }
                    var object3D = build.clone();
                    var transform = component.transform;
                    if (transform) {
                        object3D.applyMatrix4(transform);
                    }
                    composite.add(object3D);
                }
                return composite;
            }
            function buildObject(objectId, objects, modelData, textureData) {
                var objectData = modelData['resources']['object'][objectId];
                if (objectData['mesh']) {
                    var meshData = objectData['mesh'];
                    var extensions = modelData['extensions'];
                    var modelXml = modelData['xml'];
                    applyExtensions(extensions, meshData, modelXml);
                    objects[objectData.id] = getBuild(meshData, objects, modelData, textureData, objectData, buildGroup);
                } else {
                    var compositeData = objectData['components'];
                    objects[objectData.id] = getBuild(compositeData, objects, modelData, textureData, objectData, buildComposite);
                }
            }
            function buildObjects(data3mf) {
                var modelsData = data3mf.model;
                var modelRels = data3mf.modelRels;
                var objects = {};
                var modelsKeys = Object.keys(modelsData);
                var textureData = {};
                if (modelRels) {
                    for (var i = 0, l = modelRels.length; i < l; i++) {
                        var modelRel = modelRels[i];
                        var textureKey = modelRel.target.substring(1);
                        if (data3mf.texture[textureKey]) {
                            textureData[modelRel.target] = data3mf.texture[textureKey];
                        }
                    }
                }
                for (var i = 0; i < modelsKeys.length; i++) {
                    var modelsKey = modelsKeys[i];
                    var modelData = modelsData[modelsKey];
                    var objectIds = Object.keys(modelData['resources']['object']);
                    for (var j = 0; j < objectIds.length; j++) {
                        var objectId = objectIds[j];
                        buildObject(objectId, objects, modelData, textureData);
                    }
                }
                return objects;
            }
            function build(objects, data3mf) {
                var group = new THREE.Group();
                var relationship = data3mf['rels'][0];
                var buildData = data3mf.model[relationship['target'].substring(1)]['build'];
                for (var i = 0; i < buildData.length; i++) {
                    var buildItem = buildData[i];
                    var object3D = objects[buildItem['objectId']];
                    var transform = buildItem['transform'];
                    if (transform) {
                        object3D.applyMatrix4(transform);
                    }
                    group.add(object3D);
                }
                return group;
            }
            var data3mf = loadDocument(data);
            var objects = buildObjects(data3mf);
            return build(objects, data3mf);
        },
        addExtension: function (extension) {
            this.availableExtensions.push(extension);
        }
    });

    return threex.loaders.ThreeMFLoader = ThreeMFLoader;
});
define('skylark-threejs-ex/loaders/AMFLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var AMFLoader = function (manager) {
        THREE.Loader.call(this, manager);
    };
    AMFLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: AMFLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var loader = new THREE.FileLoader(scope.manager);
            loader.setPath(scope.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (text) {
                onLoad(scope.parse(text));
            }, onProgress, onError);
        },
        parse: function (data) {
            function loadDocument(data) {
                var view = new DataView(data);
                var magic = String.fromCharCode(view.getUint8(0), view.getUint8(1));
                if (magic === 'PK') {
                    var zip = null;
                    var file = null;
                    console.log('THREE.AMFLoader: Loading Zip');
                    try {
                        zip = new JSZip(data);
                    } catch (e) {
                        if (e instanceof ReferenceError) {
                            console.log('THREE.AMFLoader: jszip missing and file is compressed.');
                            return null;
                        }
                    }
                    for (file in zip.files) {
                        if (file.toLowerCase().substr(-4) === '.amf') {
                            break;
                        }
                    }
                    console.log('THREE.AMFLoader: Trying to load file asset: ' + file);
                    view = new DataView(zip.file(file).asArrayBuffer());
                }
                var fileText = THREE.LoaderUtils.decodeText(view);
                var xmlData = new DOMParser().parseFromString(fileText, 'application/xml');
                if (xmlData.documentElement.nodeName.toLowerCase() !== 'amf') {
                    console.log('THREE.AMFLoader: Error loading AMF - no AMF document found.');
                    return null;
                }
                return xmlData;
            }
            function loadDocumentScale(node) {
                var scale = 1;
                var unit = 'millimeter';
                if (node.documentElement.attributes.unit !== undefined) {
                    unit = node.documentElement.attributes.unit.value.toLowerCase();
                }
                var scaleUnits = {
                    millimeter: 1,
                    inch: 25.4,
                    feet: 304.8,
                    meter: 1000,
                    micron: 0.001
                };
                if (scaleUnits[unit] !== undefined) {
                    scale = scaleUnits[unit];
                }
                console.log('THREE.AMFLoader: Unit scale: ' + scale);
                return scale;
            }
            function loadMaterials(node) {
                var matName = 'AMF Material';
                var matId = node.attributes.id.textContent;
                var color = {
                    r: 1,
                    g: 1,
                    b: 1,
                    a: 1
                };
                var loadedMaterial = null;
                for (var i = 0; i < node.childNodes.length; i++) {
                    var matChildEl = node.childNodes[i];
                    if (matChildEl.nodeName === 'metadata' && matChildEl.attributes.type !== undefined) {
                        if (matChildEl.attributes.type.value === 'name') {
                            matName = matChildEl.textContent;
                        }
                    } else if (matChildEl.nodeName === 'color') {
                        color = loadColor(matChildEl);
                    }
                }
                loadedMaterial = new THREE.MeshPhongMaterial({
                    flatShading: true,
                    color: new THREE.Color(color.r, color.g, color.b),
                    name: matName
                });
                if (color.a !== 1) {
                    loadedMaterial.transparent = true;
                    loadedMaterial.opacity = color.a;
                }
                return {
                    id: matId,
                    material: loadedMaterial
                };
            }
            function loadColor(node) {
                var color = {
                    r: 1,
                    g: 1,
                    b: 1,
                    a: 1
                };
                for (var i = 0; i < node.childNodes.length; i++) {
                    var matColor = node.childNodes[i];
                    if (matColor.nodeName === 'r') {
                        color.r = matColor.textContent;
                    } else if (matColor.nodeName === 'g') {
                        color.g = matColor.textContent;
                    } else if (matColor.nodeName === 'b') {
                        color.b = matColor.textContent;
                    } else if (matColor.nodeName === 'a') {
                        color.a = matColor.textContent;
                    }
                }
                return color;
            }
            function loadMeshVolume(node) {
                var volume = {
                    name: '',
                    triangles: [],
                    materialid: null
                };
                var currVolumeNode = node.firstElementChild;
                if (node.attributes.materialid !== undefined) {
                    volume.materialId = node.attributes.materialid.nodeValue;
                }
                while (currVolumeNode) {
                    if (currVolumeNode.nodeName === 'metadata') {
                        if (currVolumeNode.attributes.type !== undefined) {
                            if (currVolumeNode.attributes.type.value === 'name') {
                                volume.name = currVolumeNode.textContent;
                            }
                        }
                    } else if (currVolumeNode.nodeName === 'triangle') {
                        var v1 = currVolumeNode.getElementsByTagName('v1')[0].textContent;
                        var v2 = currVolumeNode.getElementsByTagName('v2')[0].textContent;
                        var v3 = currVolumeNode.getElementsByTagName('v3')[0].textContent;
                        volume.triangles.push(v1, v2, v3);
                    }
                    currVolumeNode = currVolumeNode.nextElementSibling;
                }
                return volume;
            }
            function loadMeshVertices(node) {
                var vertArray = [];
                var normalArray = [];
                var currVerticesNode = node.firstElementChild;
                while (currVerticesNode) {
                    if (currVerticesNode.nodeName === 'vertex') {
                        var vNode = currVerticesNode.firstElementChild;
                        while (vNode) {
                            if (vNode.nodeName === 'coordinates') {
                                var x = vNode.getElementsByTagName('x')[0].textContent;
                                var y = vNode.getElementsByTagName('y')[0].textContent;
                                var z = vNode.getElementsByTagName('z')[0].textContent;
                                vertArray.push(x, y, z);
                            } else if (vNode.nodeName === 'normal') {
                                var nx = vNode.getElementsByTagName('nx')[0].textContent;
                                var ny = vNode.getElementsByTagName('ny')[0].textContent;
                                var nz = vNode.getElementsByTagName('nz')[0].textContent;
                                normalArray.push(nx, ny, nz);
                            }
                            vNode = vNode.nextElementSibling;
                        }
                    }
                    currVerticesNode = currVerticesNode.nextElementSibling;
                }
                return {
                    'vertices': vertArray,
                    'normals': normalArray
                };
            }
            function loadObject(node) {
                var objId = node.attributes.id.textContent;
                var loadedObject = {
                    name: 'amfobject',
                    meshes: []
                };
                var currColor = null;
                var currObjNode = node.firstElementChild;
                while (currObjNode) {
                    if (currObjNode.nodeName === 'metadata') {
                        if (currObjNode.attributes.type !== undefined) {
                            if (currObjNode.attributes.type.value === 'name') {
                                loadedObject.name = currObjNode.textContent;
                            }
                        }
                    } else if (currObjNode.nodeName === 'color') {
                        currColor = loadColor(currObjNode);
                    } else if (currObjNode.nodeName === 'mesh') {
                        var currMeshNode = currObjNode.firstElementChild;
                        var mesh = {
                            vertices: [],
                            normals: [],
                            volumes: [],
                            color: currColor
                        };
                        while (currMeshNode) {
                            if (currMeshNode.nodeName === 'vertices') {
                                var loadedVertices = loadMeshVertices(currMeshNode);
                                mesh.normals = mesh.normals.concat(loadedVertices.normals);
                                mesh.vertices = mesh.vertices.concat(loadedVertices.vertices);
                            } else if (currMeshNode.nodeName === 'volume') {
                                mesh.volumes.push(loadMeshVolume(currMeshNode));
                            }
                            currMeshNode = currMeshNode.nextElementSibling;
                        }
                        loadedObject.meshes.push(mesh);
                    }
                    currObjNode = currObjNode.nextElementSibling;
                }
                return {
                    'id': objId,
                    'obj': loadedObject
                };
            }
            var xmlData = loadDocument(data);
            var amfName = '';
            var amfAuthor = '';
            var amfScale = loadDocumentScale(xmlData);
            var amfMaterials = {};
            var amfObjects = {};
            var childNodes = xmlData.documentElement.childNodes;
            var i, j;
            for (i = 0; i < childNodes.length; i++) {
                var child = childNodes[i];
                if (child.nodeName === 'metadata') {
                    if (child.attributes.type !== undefined) {
                        if (child.attributes.type.value === 'name') {
                            amfName = child.textContent;
                        } else if (child.attributes.type.value === 'author') {
                            amfAuthor = child.textContent;
                        }
                    }
                } else if (child.nodeName === 'material') {
                    var loadedMaterial = loadMaterials(child);
                    amfMaterials[loadedMaterial.id] = loadedMaterial.material;
                } else if (child.nodeName === 'object') {
                    var loadedObject = loadObject(child);
                    amfObjects[loadedObject.id] = loadedObject.obj;
                }
            }
            var sceneObject = new THREE.Group();
            var defaultMaterial = new THREE.MeshPhongMaterial({
                color: 11184895,
                flatShading: true
            });
            sceneObject.name = amfName;
            sceneObject.userData.author = amfAuthor;
            sceneObject.userData.loader = 'AMF';
            for (var id in amfObjects) {
                var part = amfObjects[id];
                var meshes = part.meshes;
                var newObject = new THREE.Group();
                newObject.name = part.name || '';
                for (i = 0; i < meshes.length; i++) {
                    var objDefaultMaterial = defaultMaterial;
                    var mesh = meshes[i];
                    var vertices = new THREE.Float32BufferAttribute(mesh.vertices, 3);
                    var normals = null;
                    if (mesh.normals.length) {
                        normals = new THREE.Float32BufferAttribute(mesh.normals, 3);
                    }
                    if (mesh.color) {
                        var color = mesh.color;
                        objDefaultMaterial = defaultMaterial.clone();
                        objDefaultMaterial.color = new THREE.Color(color.r, color.g, color.b);
                        if (color.a !== 1) {
                            objDefaultMaterial.transparent = true;
                            objDefaultMaterial.opacity = color.a;
                        }
                    }
                    var volumes = mesh.volumes;
                    for (j = 0; j < volumes.length; j++) {
                        var volume = volumes[j];
                        var newGeometry = new THREE.BufferGeometry();
                        var material = objDefaultMaterial;
                        newGeometry.setIndex(volume.triangles);
                        newGeometry.setAttribute('position', vertices.clone());
                        if (normals) {
                            newGeometry.setAttribute('normal', normals.clone());
                        }
                        if (amfMaterials[volume.materialId] !== undefined) {
                            material = amfMaterials[volume.materialId];
                        }
                        newGeometry.scale(amfScale, amfScale, amfScale);
                        newObject.add(new THREE.Mesh(newGeometry, material.clone()));
                    }
                }
                sceneObject.add(newObject);
            }
            return sceneObject;
        }
    });

    return threex.loaders.AMFLoader = AMFLoader;
});
define('skylark-threejs-ex/loaders/AssimpJSONLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {

	/**
	 * @author Alexander Gessler / http://www.greentoken.de/
	 * https://github.com/acgessler
	 *
	 * Loader for models imported with Open Asset Import Library (http://assimp.sf.net)
	 * through assimp2json (https://github.com/acgessler/assimp2json).
	 *
	 * Supports any input format that assimp supports, including 3ds, obj, dae, blend,
	 * fbx, x, ms3d, lwo (and many more).
	 *
	 * See webgl_loader_assimp2json example.
	 */

	function AssimpJSONLoader( manager ) {

		this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;

	};

	AssimpJSONLoader.prototype = {

		constructor: AssimpJSONLoader,

		crossOrigin: 'anonymous',

		load: function ( url, onLoad, onProgress, onError ) {

			var scope = this;

			var path = ( scope.path === undefined ) ? THREE.LoaderUtils.extractUrlBase( url ) : scope.path;

			var loader = new THREE.FileLoader( this.manager );
			loader.setPath( scope.path );
			loader.load( url, function ( text ) {

				var json = JSON.parse( text );
				var metadata = json.__metadata__;

				// check if __metadata__ meta header is present
				// this header is used to disambiguate between different JSON-based file formats

				if ( typeof metadata !== 'undefined' ) {

					// check if assimp2json at all

					if ( metadata.format !== 'assimp2json' ) {

						onError( 'AssimpJSONLoader: Not an assimp2json scene.' );
						return;

						// check major format version

					} else if ( metadata.version < 100 && metadata.version >= 200 ) {

						onError( 'AssimpJSONLoader: Unsupported assimp2json file format version.' );
						return;

					}

				}

				onLoad( scope.parse( json, path ) );

			}, onProgress, onError );

		},

		setPath: function ( value ) {

			this.path = value;
			return this;

		},

		setResourcePath: function ( value ) {

			this.resourcePath = value;
			return this;

		},

		setCrossOrigin: function ( value ) {

			this.crossOrigin = value;
			return this;

		},

		parse: function ( json, path ) {

			function parseList( json, handler ) {

				var meshes = new Array( json.length );

				for ( var i = 0; i < json.length; ++ i ) {

					meshes[ i ] = handler.call( this, json[ i ] );

				}

				return meshes;

			}

			function parseMesh( json ) {

				var geometry = new THREE.BufferGeometry();

				var i, l, face;

				var indices = [];

				var vertices = json.vertices || [];
				var normals = json.normals || [];
				var uvs = json.texturecoords || [];
				var colors = json.colors || [];

				uvs = uvs[ 0 ] || []; // only support for a single set of uvs

				for ( i = 0, l = json.faces.length; i < l; i ++ ) {

					face = json.faces[ i ];
					indices.push( face[ 0 ], face[ 1 ], face[ 2 ] );

				}

				geometry.setIndex( indices );
				geometry.addAttribute( 'position', new THREE.Float32BufferAttribute( vertices, 3 ) );

				if ( normals.length > 0 ) {

					geometry.addAttribute( 'normal', new THREE.Float32BufferAttribute( normals, 3 ) );

				}

				if ( uvs.length > 0 ) {

					geometry.addAttribute( 'uv', new THREE.Float32BufferAttribute( uvs, 2 ) );

				}

				if ( colors.length > 0 ) {

					geometry.addAttribute( 'color', new THREE.Float32BufferAttribute( colors, 3 ) );

				}

				geometry.computeBoundingSphere();

				return geometry;

			}

			function parseMaterial( json ) {

				var material = new THREE.MeshPhongMaterial();

				for ( var i in json.properties ) {

					var property = json.properties[ i ];
					var key = property.key;
					var value = property.value;

					switch ( key ) {

						case '$tex.file': {

							var semantic = property.semantic;

							// prop.semantic gives the type of the texture
							// 1: diffuse
							// 2: specular map
							// 4: emissive map
							// 5: height map (bumps)
							// 6: normal map
							// more values (i.e. environment, etc) are known by assimp and may be relevant

							if ( semantic === 1 || semantic === 2 || semantic === 4 || semantic === 5 || semantic === 6 ) {

								var keyname;

								switch ( semantic ) {

									case 1:
										keyname = 'map';
										break;
									case 2:
										keyname = 'specularMap';
										break;
									case 4:
										keyname = 'emissiveMap';
										break;
									case 5:
										keyname = 'bumpMap';
										break;
									case 6:
										keyname = 'normalMap';
										break;

								}

								var texture = textureLoader.load( value );

								// TODO: read texture settings from assimp.
								// Wrapping is the default, though.

								texture.wrapS = texture.wrapT = THREE.RepeatWrapping;

								material[ keyname ] = texture;

							}

							break;

						}

						case '?mat.name':
							material.name = value;
							break;

						case '$clr.diffuse':
							material.color.fromArray( value );
							break;

						case '$clr.specular':
							material.specular.fromArray( value );
							break;

						case '$clr.emissive':
							material.emissive.fromArray( value );
							break;

						case '$mat.shininess':
							material.shininess = value;
							break;

						case '$mat.shadingm':
							// aiShadingMode_Flat
							material.flatShading = ( value === 1 ) ? true : false;
							break;

						case '$mat.opacity':
							if ( value < 1 ) {

								material.opacity = value;
								material.transparent = true;

							}
							break;

					}

				}

				return material;

			}

			function parseObject( json, node, meshes, materials ) {

				var obj = new THREE.Object3D(),	i, idx;

				obj.name = node.name || '';
				obj.matrix = new THREE.Matrix4().fromArray( node.transformation ).transpose();
				obj.matrix.decompose( obj.position, obj.quaternion, obj.scale );

				for ( i = 0; node.meshes && i < node.meshes.length; i ++ ) {

					idx = node.meshes[ i ];
					obj.add( new THREE.Mesh( meshes[ idx ], materials[ json.meshes[ idx ].materialindex ] ) );

				}

				for ( i = 0; node.children && i < node.children.length; i ++ ) {

					obj.add( parseObject( json, node.children[ i ], meshes, materials ) );

				}

				return obj;

			}

			var textureLoader = new THREE.TextureLoader( this.manager );
			textureLoader.setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );

			var meshes = parseList( json.meshes, parseMesh );
			var materials = parseList( json.materials, parseMaterial );
			return parseObject( json, json.rootnode, meshes, materials );

		}

	};
	
	return threex.loaders.AssimpJSONLoader = AssimpJSONLoader;
});
define('skylark-threejs-ex/loaders/AssimpLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var AssimpLoader = function (manager) {
        THREE.Loader.call(this, manager);
    };
    AssimpLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: AssimpLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var path = scope.path === '' ? THREE.LoaderUtils.extractUrlBase(url) : scope.path;
            var loader = new THREE.FileLoader(this.manager);
            loader.setPath(scope.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (buffer) {
                onLoad(scope.parse(buffer, path));
            }, onProgress, onError);
        },
        parse: function (buffer, path) {
            var textureLoader = new THREE.TextureLoader(this.manager);
            textureLoader.setPath(this.resourcePath || path).setCrossOrigin(this.crossOrigin);
            var Virtulous = {};
            Virtulous.KeyFrame = function (time, matrix) {
                this.time = time;
                this.matrix = matrix.clone();
                this.position = new THREE.Vector3();
                this.quaternion = new THREE.Quaternion();
                this.scale = new THREE.Vector3(1, 1, 1);
                this.matrix.decompose(this.position, this.quaternion, this.scale);
                this.clone = function () {
                    var n = new Virtulous.KeyFrame(this.time, this.matrix);
                    return n;
                };
                this.lerp = function (nextKey, time) {
                    time -= this.time;
                    var dist = nextKey.time - this.time;
                    var l = time / dist;
                    var l2 = 1 - l;
                    var keypos = this.position;
                    var keyrot = this.quaternion;
                    var key2pos = nextKey.position;
                    var key2rot = nextKey.quaternion;
                    Virtulous.KeyFrame.tempAniPos.x = keypos.x * l2 + key2pos.x * l;
                    Virtulous.KeyFrame.tempAniPos.y = keypos.y * l2 + key2pos.y * l;
                    Virtulous.KeyFrame.tempAniPos.z = keypos.z * l2 + key2pos.z * l;
                    Virtulous.KeyFrame.tempAniQuat.set(keyrot.x, keyrot.y, keyrot.z, keyrot.w);
                    Virtulous.KeyFrame.tempAniQuat.slerp(key2rot, l);
                    return Virtulous.KeyFrame.tempAniMatrix.compose(Virtulous.KeyFrame.tempAniPos, Virtulous.KeyFrame.tempAniQuat, Virtulous.KeyFrame.tempAniScale);
                };
            };
            Virtulous.KeyFrame.tempAniPos = new THREE.Vector3();
            Virtulous.KeyFrame.tempAniQuat = new THREE.Quaternion();
            Virtulous.KeyFrame.tempAniScale = new THREE.Vector3(1, 1, 1);
            Virtulous.KeyFrame.tempAniMatrix = new THREE.Matrix4();
            Virtulous.KeyFrameTrack = function () {
                this.keys = [];
                this.target = null;
                this.time = 0;
                this.length = 0;
                this._accelTable = {};
                this.fps = 20;
                this.addKey = function (key) {
                    this.keys.push(key);
                };
                this.init = function () {
                    this.sortKeys();
                    if (this.keys.length > 0)
                        this.length = this.keys[this.keys.length - 1].time;
                    else
                        this.length = 0;
                    if (!this.fps)
                        return;
                    for (var j = 0; j < this.length * this.fps; j++) {
                        for (var i = 0; i < this.keys.length; i++) {
                            if (this.keys[i].time == j) {
                                this._accelTable[j] = i;
                                break;
                            } else if (this.keys[i].time < j / this.fps && this.keys[i + 1] && this.keys[i + 1].time >= j / this.fps) {
                                this._accelTable[j] = i;
                                break;
                            }
                        }
                    }
                };
                this.parseFromThree = function (data) {
                    var fps = data.fps;
                    this.target = data.node;
                    var track = data.hierarchy[0].keys;
                    for (var i = 0; i < track.length; i++) {
                        this.addKey(new Virtulous.KeyFrame(i / fps || track[i].time, track[i].targets[0].data));
                    }
                    this.init();
                };
                this.parseFromCollada = function (data) {
                    var track = data.keys;
                    var fps = this.fps;
                    for (var i = 0; i < track.length; i++) {
                        this.addKey(new Virtulous.KeyFrame(i / fps || track[i].time, track[i].matrix));
                    }
                    this.init();
                };
                this.sortKeys = function () {
                    this.keys.sort(this.keySortFunc);
                };
                this.keySortFunc = function (a, b) {
                    return a.time - b.time;
                };
                this.clone = function () {
                    var t = new Virtulous.KeyFrameTrack();
                    t.target = this.target;
                    t.time = this.time;
                    t.length = this.length;
                    for (var i = 0; i < this.keys.length; i++) {
                        t.addKey(this.keys[i].clone());
                    }
                    t.init();
                    return t;
                };
                this.reTarget = function (root, compareitor) {
                    if (!compareitor)
                        compareitor = Virtulous.TrackTargetNodeNameCompare;
                    this.target = compareitor(root, this.target);
                };
                this.keySearchAccel = function (time) {
                    time *= this.fps;
                    time = Math.floor(time);
                    return this._accelTable[time] || 0;
                };
                this.setTime = function (time) {
                    time = Math.abs(time);
                    if (this.length)
                        time = time % this.length + 0.05;
                    var key0 = null;
                    var key1 = null;
                    for (var i = this.keySearchAccel(time); i < this.keys.length; i++) {
                        if (this.keys[i].time == time) {
                            key0 = this.keys[i];
                            key1 = this.keys[i];
                            break;
                        } else if (this.keys[i].time < time && this.keys[i + 1] && this.keys[i + 1].time > time) {
                            key0 = this.keys[i];
                            key1 = this.keys[i + 1];
                            break;
                        } else if (this.keys[i].time < time && i == this.keys.length - 1) {
                            key0 = this.keys[i];
                            key1 = this.keys[0].clone();
                            key1.time += this.length + 0.05;
                            break;
                        }
                    }
                    if (key0 && key1 && key0 !== key1) {
                        this.target.matrixAutoUpdate = false;
                        this.target.matrix.copy(key0.lerp(key1, time));
                        this.target.matrixWorldNeedsUpdate = true;
                        return;
                    }
                    if (key0 && key1 && key0 == key1) {
                        this.target.matrixAutoUpdate = false;
                        this.target.matrix.copy(key0.matrix);
                        this.target.matrixWorldNeedsUpdate = true;
                        return;
                    }
                };
            };
            Virtulous.TrackTargetNodeNameCompare = function (root, target) {
                function find(node, name) {
                    if (node.name == name)
                        return node;
                    for (var i = 0; i < node.children.length; i++) {
                        var r = find(node.children[i], name);
                        if (r)
                            return r;
                    }
                    return null;
                }
                return find(root, target.name);
            };
            Virtulous.Animation = function () {
                this.tracks = [];
                this.length = 0;
                this.addTrack = function (track) {
                    this.tracks.push(track);
                    this.length = Math.max(track.length, this.length);
                };
                this.setTime = function (time) {
                    this.time = time;
                    for (var i = 0; i < this.tracks.length; i++)
                        this.tracks[i].setTime(time);
                };
                this.clone = function (target, compareitor) {
                    if (!compareitor)
                        compareitor = Virtulous.TrackTargetNodeNameCompare;
                    var n = new Virtulous.Animation();
                    n.target = target;
                    for (var i = 0; i < this.tracks.length; i++) {
                        var track = this.tracks[i].clone();
                        track.reTarget(target, compareitor);
                        n.addTrack(track);
                    }
                    return n;
                };
            };
            var ASSBIN_CHUNK_AICAMERA = 4660;
            var ASSBIN_CHUNK_AILIGHT = 4661;
            var ASSBIN_CHUNK_AITEXTURE = 4662;
            var ASSBIN_CHUNK_AIMESH = 4663;
            var ASSBIN_CHUNK_AINODEANIM = 4664;
            var ASSBIN_CHUNK_AISCENE = 4665;
            var ASSBIN_CHUNK_AIBONE = 4666;
            var ASSBIN_CHUNK_AIANIMATION = 4667;
            var ASSBIN_CHUNK_AINODE = 4668;
            var ASSBIN_CHUNK_AIMATERIAL = 4669;
            var ASSBIN_CHUNK_AIMATERIALPROPERTY = 4670;
            var ASSBIN_MESH_HAS_POSITIONS = 1;
            var ASSBIN_MESH_HAS_NORMALS = 2;
            var ASSBIN_MESH_HAS_TANGENTS_AND_BITANGENTS = 4;
            var ASSBIN_MESH_HAS_TEXCOORD_BASE = 256;
            var ASSBIN_MESH_HAS_COLOR_BASE = 65536;
            var AI_MAX_NUMBER_OF_COLOR_SETS = 1;
            var AI_MAX_NUMBER_OF_TEXTURECOORDS = 4;
            var aiLightSource_DIRECTIONAL = 1;
            var aiLightSource_SPOT = 3;
            var aiTextureType_DIFFUSE = 1;
            var aiTextureType_NORMALS = 6;
            var aiTextureType_OPACITY = 8;
            var aiTextureType_LIGHTMAP = 10;
            var BONESPERVERT = 4;
            function ASSBIN_MESH_HAS_TEXCOORD(n) {
                return ASSBIN_MESH_HAS_TEXCOORD_BASE << n;
            }
            function ASSBIN_MESH_HAS_COLOR(n) {
                return ASSBIN_MESH_HAS_COLOR_BASE << n;
            }
            function markBones(scene) {
                for (var i in scene.mMeshes) {
                    var mesh = scene.mMeshes[i];
                    for (var k in mesh.mBones) {
                        var boneNode = scene.findNode(mesh.mBones[k].mName);
                        if (boneNode)
                            boneNode.isBone = true;
                    }
                }
            }
            function cloneTreeToBones(root, scene) {
                var rootBone = new THREE.Bone();
                rootBone.matrix.copy(root.matrix);
                rootBone.matrixWorld.copy(root.matrixWorld);
                rootBone.position.copy(root.position);
                rootBone.quaternion.copy(root.quaternion);
                rootBone.scale.copy(root.scale);
                scene.nodeCount++;
                rootBone.name = 'bone_' + root.name + scene.nodeCount.toString();
                if (!scene.nodeToBoneMap[root.name])
                    scene.nodeToBoneMap[root.name] = [];
                scene.nodeToBoneMap[root.name].push(rootBone);
                for (var i in root.children) {
                    var child = cloneTreeToBones(root.children[i], scene);
                    rootBone.add(child);
                }
                return rootBone;
            }
            function sortWeights(indexes, weights) {
                var pairs = [];
                for (var i = 0; i < indexes.length; i++) {
                    pairs.push({
                        i: indexes[i],
                        w: weights[i]
                    });
                }
                pairs.sort(function (a, b) {
                    return b.w - a.w;
                });
                while (pairs.length < 4) {
                    pairs.push({
                        i: 0,
                        w: 0
                    });
                }
                if (pairs.length > 4)
                    pairs.length = 4;
                var sum = 0;
                for (var i = 0; i < 4; i++) {
                    sum += pairs[i].w * pairs[i].w;
                }
                sum = Math.sqrt(sum);
                for (var i = 0; i < 4; i++) {
                    pairs[i].w = pairs[i].w / sum;
                    indexes[i] = pairs[i].i;
                    weights[i] = pairs[i].w;
                }
            }
            function findMatchingBone(root, name) {
                if (root.name.indexOf('bone_' + name) == 0)
                    return root;
                for (var i in root.children) {
                    var ret = findMatchingBone(root.children[i], name);
                    if (ret)
                        return ret;
                }
                return undefined;
            }
            function aiMesh() {
                this.mPrimitiveTypes = 0;
                this.mNumVertices = 0;
                this.mNumFaces = 0;
                this.mNumBones = 0;
                this.mMaterialIndex = 0;
                this.mVertices = [];
                this.mNormals = [];
                this.mTangents = [];
                this.mBitangents = [];
                this.mColors = [[]];
                this.mTextureCoords = [[]];
                this.mFaces = [];
                this.mBones = [];
                this.hookupSkeletons = function (scene) {
                    if (this.mBones.length == 0)
                        return;
                    var allBones = [];
                    var offsetMatrix = [];
                    var skeletonRoot = scene.findNode(this.mBones[0].mName);
                    while (skeletonRoot.mParent && skeletonRoot.mParent.isBone) {
                        skeletonRoot = skeletonRoot.mParent;
                    }
                    var threeSkeletonRoot = skeletonRoot.toTHREE(scene);
                    var threeSkeletonRootBone = cloneTreeToBones(threeSkeletonRoot, scene);
                    this.threeNode.add(threeSkeletonRootBone);
                    for (var i = 0; i < this.mBones.length; i++) {
                        var bone = findMatchingBone(threeSkeletonRootBone, this.mBones[i].mName);
                        if (bone) {
                            var tbone = bone;
                            allBones.push(tbone);
                            offsetMatrix.push(this.mBones[i].mOffsetMatrix.toTHREE());
                        } else {
                            var skeletonRoot = scene.findNode(this.mBones[i].mName);
                            if (!skeletonRoot)
                                return;
                            var threeSkeletonRoot = skeletonRoot.toTHREE(scene);
                            var threeSkeletonRootBone = cloneTreeToBones(threeSkeletonRoot, scene);
                            this.threeNode.add(threeSkeletonRootBone);
                            var bone = findMatchingBone(threeSkeletonRootBone, this.mBones[i].mName);
                            var tbone = bone;
                            allBones.push(tbone);
                            offsetMatrix.push(this.mBones[i].mOffsetMatrix.toTHREE());
                        }
                    }
                    var skeleton = new THREE.Skeleton(allBones, offsetMatrix);
                    this.threeNode.bind(skeleton, new THREE.Matrix4());
                    this.threeNode.material.skinning = true;
                };
                this.toTHREE = function (scene) {
                    if (this.threeNode)
                        return this.threeNode;
                    var geometry = new THREE.BufferGeometry();
                    var mat;
                    if (scene.mMaterials[this.mMaterialIndex])
                        mat = scene.mMaterials[this.mMaterialIndex].toTHREE(scene);
                    else
                        mat = new THREE.MeshLambertMaterial();
                    geometry.setIndex(new THREE.BufferAttribute(new Uint32Array(this.mIndexArray), 1));
                    geometry.setAttribute('position', new THREE.BufferAttribute(this.mVertexBuffer, 3));
                    if (this.mNormalBuffer && this.mNormalBuffer.length > 0)
                        geometry.setAttribute('normal', new THREE.BufferAttribute(this.mNormalBuffer, 3));
                    if (this.mColorBuffer && this.mColorBuffer.length > 0)
                        geometry.setAttribute('color', new THREE.BufferAttribute(this.mColorBuffer, 4));
                    if (this.mTexCoordsBuffers[0] && this.mTexCoordsBuffers[0].length > 0)
                        geometry.setAttribute('uv', new THREE.BufferAttribute(new Float32Array(this.mTexCoordsBuffers[0]), 2));
                    if (this.mTexCoordsBuffers[1] && this.mTexCoordsBuffers[1].length > 0)
                        geometry.setAttribute('uv1', new THREE.BufferAttribute(new Float32Array(this.mTexCoordsBuffers[1]), 2));
                    if (this.mTangentBuffer && this.mTangentBuffer.length > 0)
                        geometry.setAttribute('tangents', new THREE.BufferAttribute(this.mTangentBuffer, 3));
                    if (this.mBitangentBuffer && this.mBitangentBuffer.length > 0)
                        geometry.setAttribute('bitangents', new THREE.BufferAttribute(this.mBitangentBuffer, 3));
                    if (this.mBones.length > 0) {
                        var weights = [];
                        var bones = [];
                        for (var i = 0; i < this.mBones.length; i++) {
                            for (var j = 0; j < this.mBones[i].mWeights.length; j++) {
                                var weight = this.mBones[i].mWeights[j];
                                if (weight) {
                                    if (!weights[weight.mVertexId])
                                        weights[weight.mVertexId] = [];
                                    if (!bones[weight.mVertexId])
                                        bones[weight.mVertexId] = [];
                                    weights[weight.mVertexId].push(weight.mWeight);
                                    bones[weight.mVertexId].push(parseInt(i));
                                }
                            }
                        }
                        for (var i in bones) {
                            sortWeights(bones[i], weights[i]);
                        }
                        var _weights = [];
                        var _bones = [];
                        for (var i = 0; i < weights.length; i++) {
                            for (var j = 0; j < 4; j++) {
                                if (weights[i] && bones[i]) {
                                    _weights.push(weights[i][j]);
                                    _bones.push(bones[i][j]);
                                } else {
                                    _weights.push(0);
                                    _bones.push(0);
                                }
                            }
                        }
                        geometry.setAttribute('skinWeight', new THREE.BufferAttribute(new Float32Array(_weights), BONESPERVERT));
                        geometry.setAttribute('skinIndex', new THREE.BufferAttribute(new Float32Array(_bones), BONESPERVERT));
                    }
                    var mesh;
                    if (this.mBones.length == 0)
                        mesh = new THREE.Mesh(geometry, mat);
                    if (this.mBones.length > 0) {
                        mesh = new THREE.SkinnedMesh(geometry, mat);
                        mesh.normalizeSkinWeights();
                    }
                    this.threeNode = mesh;
                    return mesh;
                };
            }
            function aiFace() {
                this.mNumIndices = 0;
                this.mIndices = [];
            }
            function aiVector3D() {
                this.x = 0;
                this.y = 0;
                this.z = 0;
                this.toTHREE = function () {
                    return new THREE.Vector3(this.x, this.y, this.z);
                };
            }
            function aiColor3D() {
                this.r = 0;
                this.g = 0;
                this.b = 0;
                this.a = 0;
                this.toTHREE = function () {
                    return new THREE.Color(this.r, this.g, this.b);
                };
            }
            function aiQuaternion() {
                this.x = 0;
                this.y = 0;
                this.z = 0;
                this.w = 0;
                this.toTHREE = function () {
                    return new THREE.Quaternion(this.x, this.y, this.z, this.w);
                };
            }
            function aiVertexWeight() {
                this.mVertexId = 0;
                this.mWeight = 0;
            }
            function aiString() {
                this.data = [];
                this.toString = function () {
                    var str = '';
                    this.data.forEach(function (i) {
                        str += String.fromCharCode(i);
                    });
                    return str.replace(/[^\x20-\x7E]+/g, '');
                };
            }
            function aiVectorKey() {
                this.mTime = 0;
                this.mValue = null;
            }
            function aiQuatKey() {
                this.mTime = 0;
                this.mValue = null;
            }
            function aiNode() {
                this.mName = '';
                this.mTransformation = [];
                this.mNumChildren = 0;
                this.mNumMeshes = 0;
                this.mMeshes = [];
                this.mChildren = [];
                this.toTHREE = function (scene) {
                    if (this.threeNode)
                        return this.threeNode;
                    var o = new THREE.Object3D();
                    o.name = this.mName;
                    o.matrix = this.mTransformation.toTHREE();
                    for (var i = 0; i < this.mChildren.length; i++) {
                        o.add(this.mChildren[i].toTHREE(scene));
                    }
                    for (var i = 0; i < this.mMeshes.length; i++) {
                        o.add(scene.mMeshes[this.mMeshes[i]].toTHREE(scene));
                    }
                    this.threeNode = o;
                    o.matrix.decompose(o.position, o.quaternion, o.scale);
                    return o;
                };
            }
            function aiBone() {
                this.mName = '';
                this.mNumWeights = 0;
                this.mOffsetMatrix = 0;
            }
            function aiMaterialProperty() {
                this.mKey = '';
                this.mSemantic = 0;
                this.mIndex = 0;
                this.mData = [];
                this.mDataLength = 0;
                this.mType = 0;
                this.dataAsColor = function () {
                    var array = new Uint8Array(this.mData).buffer;
                    var reader = new DataView(array);
                    var r = reader.getFloat32(0, true);
                    var g = reader.getFloat32(4, true);
                    var b = reader.getFloat32(8, true);
                    return new THREE.Color(r, g, b);
                };
                this.dataAsFloat = function () {
                    var array = new Uint8Array(this.mData).buffer;
                    var reader = new DataView(array);
                    var r = reader.getFloat32(0, true);
                    return r;
                };
                this.dataAsBool = function () {
                    var array = new Uint8Array(this.mData).buffer;
                    var reader = new DataView(array);
                    var r = reader.getFloat32(0, true);
                    return !!r;
                };
                this.dataAsString = function () {
                    var s = new aiString();
                    s.data = this.mData;
                    return s.toString();
                };
                this.dataAsMap = function () {
                    var s = new aiString();
                    s.data = this.mData;
                    var path = s.toString();
                    path = path.replace(/\\/g, '/');
                    if (path.indexOf('/') != -1) {
                        path = path.substr(path.lastIndexOf('/') + 1);
                    }
                    return textureLoader.load(path);
                };
            }
            var namePropMapping = {
                '?mat.name': 'name',
                '$mat.shadingm': 'shading',
                '$mat.twosided': 'twoSided',
                '$mat.wireframe': 'wireframe',
                '$clr.ambient': 'ambient',
                '$clr.diffuse': 'color',
                '$clr.specular': 'specular',
                '$clr.emissive': 'emissive',
                '$clr.transparent': 'transparent',
                '$clr.reflective': 'reflect',
                '$mat.shininess': 'shininess',
                '$mat.reflectivity': 'reflectivity',
                '$mat.refracti': 'refraction',
                '$tex.file': 'map'
            };
            var nameTypeMapping = {
                '?mat.name': 'string',
                '$mat.shadingm': 'bool',
                '$mat.twosided': 'bool',
                '$mat.wireframe': 'bool',
                '$clr.ambient': 'color',
                '$clr.diffuse': 'color',
                '$clr.specular': 'color',
                '$clr.emissive': 'color',
                '$clr.transparent': 'color',
                '$clr.reflective': 'color',
                '$mat.shininess': 'float',
                '$mat.reflectivity': 'float',
                '$mat.refracti': 'float',
                '$tex.file': 'map'
            };
            function aiMaterial() {
                this.mNumAllocated = 0;
                this.mNumProperties = 0;
                this.mProperties = [];
                this.toTHREE = function () {
                    var mat = new THREE.MeshPhongMaterial();
                    for (var i = 0; i < this.mProperties.length; i++) {
                        if (nameTypeMapping[this.mProperties[i].mKey] == 'float')
                            mat[namePropMapping[this.mProperties[i].mKey]] = this.mProperties[i].dataAsFloat();
                        if (nameTypeMapping[this.mProperties[i].mKey] == 'color')
                            mat[namePropMapping[this.mProperties[i].mKey]] = this.mProperties[i].dataAsColor();
                        if (nameTypeMapping[this.mProperties[i].mKey] == 'bool')
                            mat[namePropMapping[this.mProperties[i].mKey]] = this.mProperties[i].dataAsBool();
                        if (nameTypeMapping[this.mProperties[i].mKey] == 'string')
                            mat[namePropMapping[this.mProperties[i].mKey]] = this.mProperties[i].dataAsString();
                        if (nameTypeMapping[this.mProperties[i].mKey] == 'map') {
                            var prop = this.mProperties[i];
                            if (prop.mSemantic == aiTextureType_DIFFUSE)
                                mat.map = this.mProperties[i].dataAsMap();
                            if (prop.mSemantic == aiTextureType_NORMALS)
                                mat.normalMap = this.mProperties[i].dataAsMap();
                            if (prop.mSemantic == aiTextureType_LIGHTMAP)
                                mat.lightMap = this.mProperties[i].dataAsMap();
                            if (prop.mSemantic == aiTextureType_OPACITY)
                                mat.alphaMap = this.mProperties[i].dataAsMap();
                        }
                    }
                    mat.ambient.r = 0.53;
                    mat.ambient.g = 0.53;
                    mat.ambient.b = 0.53;
                    mat.color.r = 1;
                    mat.color.g = 1;
                    mat.color.b = 1;
                    return mat;
                };
            }
            function veclerp(v1, v2, l) {
                var v = new THREE.Vector3();
                var lm1 = 1 - l;
                v.x = v1.x * l + v2.x * lm1;
                v.y = v1.y * l + v2.y * lm1;
                v.z = v1.z * l + v2.z * lm1;
                return v;
            }
            function quatlerp(q1, q2, l) {
                return q1.clone().slerp(q2, 1 - l);
            }
            function sampleTrack(keys, time, lne, lerp) {
                if (keys.length == 1)
                    return keys[0].mValue.toTHREE();
                var dist = Infinity;
                var key = null;
                var nextKey = null;
                for (var i = 0; i < keys.length; i++) {
                    var timeDist = Math.abs(keys[i].mTime - time);
                    if (timeDist < dist && keys[i].mTime <= time) {
                        dist = timeDist;
                        key = keys[i];
                        nextKey = keys[i + 1];
                    }
                }
                if (!key) {
                    return null;
                } else if (nextKey) {
                    var dT = nextKey.mTime - key.mTime;
                    var T = key.mTime - time;
                    var l = T / dT;
                    return lerp(key.mValue.toTHREE(), nextKey.mValue.toTHREE(), l);
                } else {
                    nextKey = keys[0].clone();
                    nextKey.mTime += lne;
                    var dT = nextKey.mTime - key.mTime;
                    var T = key.mTime - time;
                    var l = T / dT;
                    return lerp(key.mValue.toTHREE(), nextKey.mValue.toTHREE(), l);
                }
            }
            function aiNodeAnim() {
                this.mNodeName = '';
                this.mNumPositionKeys = 0;
                this.mNumRotationKeys = 0;
                this.mNumScalingKeys = 0;
                this.mPositionKeys = [];
                this.mRotationKeys = [];
                this.mScalingKeys = [];
                this.mPreState = '';
                this.mPostState = '';
                this.init = function (tps) {
                    if (!tps)
                        tps = 1;
                    function t(t) {
                        t.mTime /= tps;
                    }
                    this.mPositionKeys.forEach(t);
                    this.mRotationKeys.forEach(t);
                    this.mScalingKeys.forEach(t);
                };
                this.sortKeys = function () {
                    function comp(a, b) {
                        return a.mTime - b.mTime;
                    }
                    this.mPositionKeys.sort(comp);
                    this.mRotationKeys.sort(comp);
                    this.mScalingKeys.sort(comp);
                };
                this.getLength = function () {
                    return Math.max(Math.max.apply(null, this.mPositionKeys.map(function (a) {
                        return a.mTime;
                    })), Math.max.apply(null, this.mRotationKeys.map(function (a) {
                        return a.mTime;
                    })), Math.max.apply(null, this.mScalingKeys.map(function (a) {
                        return a.mTime;
                    })));
                };
                this.toTHREE = function (o) {
                    this.sortKeys();
                    var length = this.getLength();
                    var track = new Virtulous.KeyFrameTrack();
                    for (var i = 0; i < length; i += 0.05) {
                        var matrix = new THREE.Matrix4();
                        var time = i;
                        var pos = sampleTrack(this.mPositionKeys, time, length, veclerp);
                        var scale = sampleTrack(this.mScalingKeys, time, length, veclerp);
                        var rotation = sampleTrack(this.mRotationKeys, time, length, quatlerp);
                        matrix.compose(pos, rotation, scale);
                        var key = new Virtulous.KeyFrame(time, matrix);
                        track.addKey(key);
                    }
                    track.target = o.findNode(this.mNodeName).toTHREE();
                    var tracks = [track];
                    if (o.nodeToBoneMap[this.mNodeName]) {
                        for (var i = 0; i < o.nodeToBoneMap[this.mNodeName].length; i++) {
                            var t2 = track.clone();
                            t2.target = o.nodeToBoneMap[this.mNodeName][i];
                            tracks.push(t2);
                        }
                    }
                    return tracks;
                };
            }
            function aiAnimation() {
                this.mName = '';
                this.mDuration = 0;
                this.mTicksPerSecond = 0;
                this.mNumChannels = 0;
                this.mChannels = [];
                this.toTHREE = function (root) {
                    var animationHandle = new Virtulous.Animation();
                    for (var i in this.mChannels) {
                        this.mChannels[i].init(this.mTicksPerSecond);
                        var tracks = this.mChannels[i].toTHREE(root);
                        for (var j in tracks) {
                            tracks[j].init();
                            animationHandle.addTrack(tracks[j]);
                        }
                    }
                    animationHandle.length = Math.max.apply(null, animationHandle.tracks.map(function (e) {
                        return e.length;
                    }));
                    return animationHandle;
                };
            }
            function aiTexture() {
                this.mWidth = 0;
                this.mHeight = 0;
                this.texAchFormatHint = [];
                this.pcData = [];
            }
            function aiLight() {
                this.mName = '';
                this.mType = 0;
                this.mAttenuationConstant = 0;
                this.mAttenuationLinear = 0;
                this.mAttenuationQuadratic = 0;
                this.mAngleInnerCone = 0;
                this.mAngleOuterCone = 0;
                this.mColorDiffuse = null;
                this.mColorSpecular = null;
                this.mColorAmbient = null;
            }
            function aiCamera() {
                this.mName = '';
                this.mPosition = null;
                this.mLookAt = null;
                this.mUp = null;
                this.mHorizontalFOV = 0;
                this.mClipPlaneNear = 0;
                this.mClipPlaneFar = 0;
                this.mAspect = 0;
            }
            function aiScene() {
                this.versionMajor = 0;
                this.versionMinor = 0;
                this.versionRevision = 0;
                this.compileFlags = 0;
                this.mFlags = 0;
                this.mNumMeshes = 0;
                this.mNumMaterials = 0;
                this.mNumAnimations = 0;
                this.mNumTextures = 0;
                this.mNumLights = 0;
                this.mNumCameras = 0;
                this.mRootNode = null;
                this.mMeshes = [];
                this.mMaterials = [];
                this.mAnimations = [];
                this.mLights = [];
                this.mCameras = [];
                this.nodeToBoneMap = {};
                this.findNode = function (name, root) {
                    if (!root) {
                        root = this.mRootNode;
                    }
                    if (root.mName == name) {
                        return root;
                    }
                    for (var i = 0; i < root.mChildren.length; i++) {
                        var ret = this.findNode(name, root.mChildren[i]);
                        if (ret)
                            return ret;
                    }
                    return null;
                };
                this.toTHREE = function () {
                    this.nodeCount = 0;
                    markBones(this);
                    var o = this.mRootNode.toTHREE(this);
                    for (var i in this.mMeshes)
                        this.mMeshes[i].hookupSkeletons(this);
                    if (this.mAnimations.length > 0) {
                        var a = this.mAnimations[0].toTHREE(this);
                    }
                    return {
                        object: o,
                        animation: a
                    };
                };
            }
            function aiMatrix4() {
                this.elements = [
                    [],
                    [],
                    [],
                    []
                ];
                this.toTHREE = function () {
                    var m = new THREE.Matrix4();
                    for (var i = 0; i < 4; ++i) {
                        for (var i2 = 0; i2 < 4; ++i2) {
                            m.elements[i * 4 + i2] = this.elements[i2][i];
                        }
                    }
                    return m;
                };
            }
            var littleEndian = true;
            function readFloat(dataview) {
                var val = dataview.getFloat32(dataview.readOffset, littleEndian);
                dataview.readOffset += 4;
                return val;
            }
            function Read_double(dataview) {
                var val = dataview.getFloat64(dataview.readOffset, littleEndian);
                dataview.readOffset += 8;
                return val;
            }
            function Read_uint8_t(dataview) {
                var val = dataview.getUint8(dataview.readOffset);
                dataview.readOffset += 1;
                return val;
            }
            function Read_uint16_t(dataview) {
                var val = dataview.getUint16(dataview.readOffset, littleEndian);
                dataview.readOffset += 2;
                return val;
            }
            function Read_unsigned_int(dataview) {
                var val = dataview.getUint32(dataview.readOffset, littleEndian);
                dataview.readOffset += 4;
                return val;
            }
            function Read_uint32_t(dataview) {
                var val = dataview.getUint32(dataview.readOffset, littleEndian);
                dataview.readOffset += 4;
                return val;
            }
            function Read_aiVector3D(stream) {
                var v = new aiVector3D();
                v.x = readFloat(stream);
                v.y = readFloat(stream);
                v.z = readFloat(stream);
                return v;
            }
            function Read_aiColor3D(stream) {
                var c = new aiColor3D();
                c.r = readFloat(stream);
                c.g = readFloat(stream);
                c.b = readFloat(stream);
                return c;
            }
            function Read_aiQuaternion(stream) {
                var v = new aiQuaternion();
                v.w = readFloat(stream);
                v.x = readFloat(stream);
                v.y = readFloat(stream);
                v.z = readFloat(stream);
                return v;
            }
            function Read_aiString(stream) {
                var s = new aiString();
                var stringlengthbytes = Read_unsigned_int(stream);
                stream.ReadBytes(s.data, 1, stringlengthbytes);
                return s.toString();
            }
            function Read_aiVertexWeight(stream) {
                var w = new aiVertexWeight();
                w.mVertexId = Read_unsigned_int(stream);
                w.mWeight = readFloat(stream);
                return w;
            }
            function Read_aiMatrix4x4(stream) {
                var m = new aiMatrix4();
                for (var i = 0; i < 4; ++i) {
                    for (var i2 = 0; i2 < 4; ++i2) {
                        m.elements[i][i2] = readFloat(stream);
                    }
                }
                return m;
            }
            function Read_aiVectorKey(stream) {
                var v = new aiVectorKey();
                v.mTime = Read_double(stream);
                v.mValue = Read_aiVector3D(stream);
                return v;
            }
            function Read_aiQuatKey(stream) {
                var v = new aiQuatKey();
                v.mTime = Read_double(stream);
                v.mValue = Read_aiQuaternion(stream);
                return v;
            }
            function ReadArray_aiVertexWeight(stream, data, size) {
                for (var i = 0; i < size; i++)
                    data[i] = Read_aiVertexWeight(stream);
            }
            function ReadArray_aiVectorKey(stream, data, size) {
                for (var i = 0; i < size; i++)
                    data[i] = Read_aiVectorKey(stream);
            }
            function ReadArray_aiQuatKey(stream, data, size) {
                for (var i = 0; i < size; i++)
                    data[i] = Read_aiQuatKey(stream);
            }
            function ReadBounds(stream, T, n) {
                return stream.Seek(sizeof(T) * n, aiOrigin_CUR);
            }
            function ai_assert(bool) {
                if (!bool)
                    throw 'asset failed';
            }
            function ReadBinaryNode(stream, parent, depth) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AINODE);
                Read_uint32_t(stream);
                var node = new aiNode();
                node.mParent = parent;
                node.mDepth = depth;
                node.mName = Read_aiString(stream);
                node.mTransformation = Read_aiMatrix4x4(stream);
                node.mNumChildren = Read_unsigned_int(stream);
                node.mNumMeshes = Read_unsigned_int(stream);
                if (node.mNumMeshes) {
                    node.mMeshes = [];
                    for (var i = 0; i < node.mNumMeshes; ++i) {
                        node.mMeshes[i] = Read_unsigned_int(stream);
                    }
                }
                if (node.mNumChildren) {
                    node.mChildren = [];
                    for (var i = 0; i < node.mNumChildren; ++i) {
                        var node2 = ReadBinaryNode(stream, node, depth++);
                        node.mChildren[i] = node2;
                    }
                }
                return node;
            }
            function ReadBinaryBone(stream, b) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AIBONE);
                Read_uint32_t(stream);
                b.mName = Read_aiString(stream);
                b.mNumWeights = Read_unsigned_int(stream);
                b.mOffsetMatrix = Read_aiMatrix4x4(stream);
                if (shortened) {
                    ReadBounds(stream, b.mWeights, b.mNumWeights);
                } else {
                    b.mWeights = [];
                    ReadArray_aiVertexWeight(stream, b.mWeights, b.mNumWeights);
                }
                return b;
            }
            function ReadBinaryMesh(stream, mesh) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AIMESH);
                Read_uint32_t(stream);
                mesh.mPrimitiveTypes = Read_unsigned_int(stream);
                mesh.mNumVertices = Read_unsigned_int(stream);
                mesh.mNumFaces = Read_unsigned_int(stream);
                mesh.mNumBones = Read_unsigned_int(stream);
                mesh.mMaterialIndex = Read_unsigned_int(stream);
                mesh.mNumUVComponents = [];
                var c = Read_unsigned_int(stream);
                if (c & ASSBIN_MESH_HAS_POSITIONS) {
                    if (shortened) {
                        ReadBounds(stream, mesh.mVertices, mesh.mNumVertices);
                    } else {
                        mesh.mVertices = [];
                        mesh.mVertexBuffer = stream.subArray32(stream.readOffset, stream.readOffset + mesh.mNumVertices * 3 * 4);
                        stream.Seek(mesh.mNumVertices * 3 * 4, aiOrigin_CUR);
                    }
                }
                if (c & ASSBIN_MESH_HAS_NORMALS) {
                    if (shortened) {
                        ReadBounds(stream, mesh.mNormals, mesh.mNumVertices);
                    } else {
                        mesh.mNormals = [];
                        mesh.mNormalBuffer = stream.subArray32(stream.readOffset, stream.readOffset + mesh.mNumVertices * 3 * 4);
                        stream.Seek(mesh.mNumVertices * 3 * 4, aiOrigin_CUR);
                    }
                }
                if (c & ASSBIN_MESH_HAS_TANGENTS_AND_BITANGENTS) {
                    if (shortened) {
                        ReadBounds(stream, mesh.mTangents, mesh.mNumVertices);
                        ReadBounds(stream, mesh.mBitangents, mesh.mNumVertices);
                    } else {
                        mesh.mTangents = [];
                        mesh.mTangentBuffer = stream.subArray32(stream.readOffset, stream.readOffset + mesh.mNumVertices * 3 * 4);
                        stream.Seek(mesh.mNumVertices * 3 * 4, aiOrigin_CUR);
                        mesh.mBitangents = [];
                        mesh.mBitangentBuffer = stream.subArray32(stream.readOffset, stream.readOffset + mesh.mNumVertices * 3 * 4);
                        stream.Seek(mesh.mNumVertices * 3 * 4, aiOrigin_CUR);
                    }
                }
                for (var n = 0; n < AI_MAX_NUMBER_OF_COLOR_SETS; ++n) {
                    if (!(c & ASSBIN_MESH_HAS_COLOR(n)))
                        break;
                    if (shortened) {
                        ReadBounds(stream, mesh.mColors[n], mesh.mNumVertices);
                    } else {
                        mesh.mColors[n] = [];
                        mesh.mColorBuffer = stream.subArray32(stream.readOffset, stream.readOffset + mesh.mNumVertices * 4 * 4);
                        stream.Seek(mesh.mNumVertices * 4 * 4, aiOrigin_CUR);
                    }
                }
                mesh.mTexCoordsBuffers = [];
                for (var n = 0; n < AI_MAX_NUMBER_OF_TEXTURECOORDS; ++n) {
                    if (!(c & ASSBIN_MESH_HAS_TEXCOORD(n)))
                        break;
                    mesh.mNumUVComponents[n] = Read_unsigned_int(stream);
                    if (shortened) {
                        ReadBounds(stream, mesh.mTextureCoords[n], mesh.mNumVertices);
                    } else {
                        mesh.mTextureCoords[n] = [];
                        mesh.mTexCoordsBuffers[n] = [];
                        for (var uv = 0; uv < mesh.mNumVertices; uv++) {
                            mesh.mTexCoordsBuffers[n].push(readFloat(stream));
                            mesh.mTexCoordsBuffers[n].push(readFloat(stream));
                            readFloat(stream);
                        }
                    }
                }
                if (shortened) {
                    Read_unsigned_int(stream);
                } else {
                    mesh.mFaces = [];
                    mesh.mIndexArray = [];
                    for (var i = 0; i < mesh.mNumFaces; ++i) {
                        var f = mesh.mFaces[i] = new aiFace();
                        f.mNumIndices = Read_uint16_t(stream);
                        f.mIndices = [];
                        for (var a = 0; a < f.mNumIndices; ++a) {
                            if (mesh.mNumVertices < 1 << 16) {
                                f.mIndices[a] = Read_uint16_t(stream);
                            } else {
                                f.mIndices[a] = Read_unsigned_int(stream);
                            }
                        }
                        if (f.mNumIndices === 3) {
                            mesh.mIndexArray.push(f.mIndices[0]);
                            mesh.mIndexArray.push(f.mIndices[1]);
                            mesh.mIndexArray.push(f.mIndices[2]);
                        } else if (f.mNumIndices === 4) {
                            mesh.mIndexArray.push(f.mIndices[0]);
                            mesh.mIndexArray.push(f.mIndices[1]);
                            mesh.mIndexArray.push(f.mIndices[2]);
                            mesh.mIndexArray.push(f.mIndices[2]);
                            mesh.mIndexArray.push(f.mIndices[3]);
                            mesh.mIndexArray.push(f.mIndices[0]);
                        } else {
                            throw new Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.");
                        }
                    }
                }
                if (mesh.mNumBones) {
                    mesh.mBones = [];
                    for (var a = 0; a < mesh.mNumBones; ++a) {
                        mesh.mBones[a] = new aiBone();
                        ReadBinaryBone(stream, mesh.mBones[a]);
                    }
                }
            }
            function ReadBinaryMaterialProperty(stream, prop) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AIMATERIALPROPERTY);
                Read_uint32_t(stream);
                prop.mKey = Read_aiString(stream);
                prop.mSemantic = Read_unsigned_int(stream);
                prop.mIndex = Read_unsigned_int(stream);
                prop.mDataLength = Read_unsigned_int(stream);
                prop.mType = Read_unsigned_int(stream);
                prop.mData = [];
                stream.ReadBytes(prop.mData, 1, prop.mDataLength);
            }
            function ReadBinaryMaterial(stream, mat) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AIMATERIAL);
                Read_uint32_t(stream);
                mat.mNumAllocated = mat.mNumProperties = Read_unsigned_int(stream);
                if (mat.mNumProperties) {
                    if (mat.mProperties) {
                        delete mat.mProperties;
                    }
                    mat.mProperties = [];
                    for (var i = 0; i < mat.mNumProperties; ++i) {
                        mat.mProperties[i] = new aiMaterialProperty();
                        ReadBinaryMaterialProperty(stream, mat.mProperties[i]);
                    }
                }
            }
            function ReadBinaryNodeAnim(stream, nd) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AINODEANIM);
                Read_uint32_t(stream);
                nd.mNodeName = Read_aiString(stream);
                nd.mNumPositionKeys = Read_unsigned_int(stream);
                nd.mNumRotationKeys = Read_unsigned_int(stream);
                nd.mNumScalingKeys = Read_unsigned_int(stream);
                nd.mPreState = Read_unsigned_int(stream);
                nd.mPostState = Read_unsigned_int(stream);
                if (nd.mNumPositionKeys) {
                    if (shortened) {
                        ReadBounds(stream, nd.mPositionKeys, nd.mNumPositionKeys);
                    } else {
                        nd.mPositionKeys = [];
                        ReadArray_aiVectorKey(stream, nd.mPositionKeys, nd.mNumPositionKeys);
                    }
                }
                if (nd.mNumRotationKeys) {
                    if (shortened) {
                        ReadBounds(stream, nd.mRotationKeys, nd.mNumRotationKeys);
                    } else {
                        nd.mRotationKeys = [];
                        ReadArray_aiQuatKey(stream, nd.mRotationKeys, nd.mNumRotationKeys);
                    }
                }
                if (nd.mNumScalingKeys) {
                    if (shortened) {
                        ReadBounds(stream, nd.mScalingKeys, nd.mNumScalingKeys);
                    } else {
                        nd.mScalingKeys = [];
                        ReadArray_aiVectorKey(stream, nd.mScalingKeys, nd.mNumScalingKeys);
                    }
                }
            }
            function ReadBinaryAnim(stream, anim) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AIANIMATION);
                Read_uint32_t(stream);
                anim.mName = Read_aiString(stream);
                anim.mDuration = Read_double(stream);
                anim.mTicksPerSecond = Read_double(stream);
                anim.mNumChannels = Read_unsigned_int(stream);
                if (anim.mNumChannels) {
                    anim.mChannels = [];
                    for (var a = 0; a < anim.mNumChannels; ++a) {
                        anim.mChannels[a] = new aiNodeAnim();
                        ReadBinaryNodeAnim(stream, anim.mChannels[a]);
                    }
                }
            }
            function ReadBinaryTexture(stream, tex) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AITEXTURE);
                Read_uint32_t(stream);
                tex.mWidth = Read_unsigned_int(stream);
                tex.mHeight = Read_unsigned_int(stream);
                stream.ReadBytes(tex.achFormatHint, 1, 4);
                if (!shortened) {
                    if (!tex.mHeight) {
                        tex.pcData = [];
                        stream.ReadBytes(tex.pcData, 1, tex.mWidth);
                    } else {
                        tex.pcData = [];
                        stream.ReadBytes(tex.pcData, 1, tex.mWidth * tex.mHeight * 4);
                    }
                }
            }
            function ReadBinaryLight(stream, l) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AILIGHT);
                Read_uint32_t(stream);
                l.mName = Read_aiString(stream);
                l.mType = Read_unsigned_int(stream);
                if (l.mType != aiLightSource_DIRECTIONAL) {
                    l.mAttenuationConstant = readFloat(stream);
                    l.mAttenuationLinear = readFloat(stream);
                    l.mAttenuationQuadratic = readFloat(stream);
                }
                l.mColorDiffuse = Read_aiColor3D(stream);
                l.mColorSpecular = Read_aiColor3D(stream);
                l.mColorAmbient = Read_aiColor3D(stream);
                if (l.mType == aiLightSource_SPOT) {
                    l.mAngleInnerCone = readFloat(stream);
                    l.mAngleOuterCone = readFloat(stream);
                }
            }
            function ReadBinaryCamera(stream, cam) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AICAMERA);
                Read_uint32_t(stream);
                cam.mName = Read_aiString(stream);
                cam.mPosition = Read_aiVector3D(stream);
                cam.mLookAt = Read_aiVector3D(stream);
                cam.mUp = Read_aiVector3D(stream);
                cam.mHorizontalFOV = readFloat(stream);
                cam.mClipPlaneNear = readFloat(stream);
                cam.mClipPlaneFar = readFloat(stream);
                cam.mAspect = readFloat(stream);
            }
            function ReadBinaryScene(stream, scene) {
                var chunkID = Read_uint32_t(stream);
                ai_assert(chunkID == ASSBIN_CHUNK_AISCENE);
                Read_uint32_t(stream);
                scene.mFlags = Read_unsigned_int(stream);
                scene.mNumMeshes = Read_unsigned_int(stream);
                scene.mNumMaterials = Read_unsigned_int(stream);
                scene.mNumAnimations = Read_unsigned_int(stream);
                scene.mNumTextures = Read_unsigned_int(stream);
                scene.mNumLights = Read_unsigned_int(stream);
                scene.mNumCameras = Read_unsigned_int(stream);
                scene.mRootNode = new aiNode();
                scene.mRootNode = ReadBinaryNode(stream, null, 0);
                if (scene.mNumMeshes) {
                    scene.mMeshes = [];
                    for (var i = 0; i < scene.mNumMeshes; ++i) {
                        scene.mMeshes[i] = new aiMesh();
                        ReadBinaryMesh(stream, scene.mMeshes[i]);
                    }
                }
                if (scene.mNumMaterials) {
                    scene.mMaterials = [];
                    for (var i = 0; i < scene.mNumMaterials; ++i) {
                        scene.mMaterials[i] = new aiMaterial();
                        ReadBinaryMaterial(stream, scene.mMaterials[i]);
                    }
                }
                if (scene.mNumAnimations) {
                    scene.mAnimations = [];
                    for (var i = 0; i < scene.mNumAnimations; ++i) {
                        scene.mAnimations[i] = new aiAnimation();
                        ReadBinaryAnim(stream, scene.mAnimations[i]);
                    }
                }
                if (scene.mNumTextures) {
                    scene.mTextures = [];
                    for (var i = 0; i < scene.mNumTextures; ++i) {
                        scene.mTextures[i] = new aiTexture();
                        ReadBinaryTexture(stream, scene.mTextures[i]);
                    }
                }
                if (scene.mNumLights) {
                    scene.mLights = [];
                    for (var i = 0; i < scene.mNumLights; ++i) {
                        scene.mLights[i] = new aiLight();
                        ReadBinaryLight(stream, scene.mLights[i]);
                    }
                }
                if (scene.mNumCameras) {
                    scene.mCameras = [];
                    for (var i = 0; i < scene.mNumCameras; ++i) {
                        scene.mCameras[i] = new aiCamera();
                        ReadBinaryCamera(stream, scene.mCameras[i]);
                    }
                }
            }
            var aiOrigin_CUR = 0;
            var aiOrigin_BEG = 1;
            function extendStream(stream) {
                stream.readOffset = 0;
                stream.Seek = function (off, ori) {
                    if (ori == aiOrigin_CUR) {
                        stream.readOffset += off;
                    }
                    if (ori == aiOrigin_BEG) {
                        stream.readOffset = off;
                    }
                };
                stream.ReadBytes = function (buff, size, n) {
                    var bytes = size * n;
                    for (var i = 0; i < bytes; i++)
                        buff[i] = Read_uint8_t(this);
                };
                stream.subArray32 = function (start, end) {
                    var buff = this.buffer;
                    var newbuff = buff.slice(start, end);
                    return new Float32Array(newbuff);
                };
                stream.subArrayUint16 = function (start, end) {
                    var buff = this.buffer;
                    var newbuff = buff.slice(start, end);
                    return new Uint16Array(newbuff);
                };
                stream.subArrayUint8 = function (start, end) {
                    var buff = this.buffer;
                    var newbuff = buff.slice(start, end);
                    return new Uint8Array(newbuff);
                };
                stream.subArrayUint32 = function (start, end) {
                    var buff = this.buffer;
                    var newbuff = buff.slice(start, end);
                    return new Uint32Array(newbuff);
                };
            }
            var shortened, compressed;
            function InternReadFile(pFiledata) {
                var pScene = new aiScene();
                var stream = new DataView(pFiledata);
                extendStream(stream);
                stream.Seek(44, aiOrigin_CUR);
                pScene.versionMajor = Read_unsigned_int(stream);
                pScene.versionMinor = Read_unsigned_int(stream);
                pScene.versionRevision = Read_unsigned_int(stream);
                pScene.compileFlags = Read_unsigned_int(stream);
                shortened = Read_uint16_t(stream) > 0;
                compressed = Read_uint16_t(stream) > 0;
                if (shortened)
                    throw 'Shortened binaries are not supported!';
                stream.Seek(256, aiOrigin_CUR);
                stream.Seek(128, aiOrigin_CUR);
                stream.Seek(64, aiOrigin_CUR);
                if (compressed) {
                    var uncompressedSize = Read_uint32_t(stream);
                    var compressedSize = stream.FileSize() - stream.Tell();
                    var compressedData = [];
                    stream.Read(compressedData, 1, compressedSize);
                    var uncompressedData = [];
                    uncompress(uncompressedData, uncompressedSize, compressedData, compressedSize);
                    var buff = new ArrayBuffer(uncompressedData);
                    ReadBinaryScene(buff, pScene);
                } else {
                    ReadBinaryScene(stream, pScene);
                }
                return pScene.toTHREE();
            }
            return InternReadFile(buffer);
        }
    });

    return threex.loaders.AssimpLoader = AssimpLoader;
});
define('skylark-threejs-ex/loaders/AWDLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var AWDLoader = function () {
        var AWD_FIELD_INT8 = 1, AWD_FIELD_INT16 = 2, AWD_FIELD_INT32 = 3, AWD_FIELD_UINT8 = 4, AWD_FIELD_UINT16 = 5, AWD_FIELD_UINT32 = 6, AWD_FIELD_FLOAT32 = 7, AWD_FIELD_FLOAT64 = 8, AWD_FIELD_BOOL = 21, AWD_FIELD_BADDR = 23, AWD_FIELD_VECTOR2x1 = 41, AWD_FIELD_VECTOR3x1 = 42, AWD_FIELD_VECTOR4x1 = 43, AWD_FIELD_MTX3x2 = 44, AWD_FIELD_MTX3x3 = 45, AWD_FIELD_MTX4x3 = 46, AWD_FIELD_MTX4x4 = 47, BOOL = 21, BADDR = 23, UINT8 = 4, UINT16 = 5, FLOAT32 = 7, FLOAT64 = 8;
        var littleEndian = true;
        function Block() {
            this.id = 0;
            this.data = null;
            this.namespace = 0;
            this.flags = 0;
        }
        function AWDProperties() {
        }
        AWDProperties.prototype = {
            set: function (key, value) {
                this[key] = value;
            },
            get: function (key, fallback) {
                if (this.hasOwnProperty(key)) {
                    return this[key];
                } else {
                    return fallback;
                }
            }
        };
        var AWDLoader = function (manager) {
            THREE.Loader.call(this, manager);
            this.trunk = new THREE.Object3D();
            this.materialFactory = undefined;
            this._url = '';
            this._baseDir = '';
            this._data = undefined;
            this._ptr = 0;
            this._version = [];
            this._streaming = false;
            this._optimized_for_accuracy = false;
            this._compression = 0;
            this._bodylen = 4294967295;
            this._blocks = [new Block()];
            this._accuracyMatrix = false;
            this._accuracyGeo = false;
            this._accuracyProps = false;
        };
        AWDLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
            constructor: AWDLoader,
            load: function (url, onLoad, onProgress, onError) {
                var scope = this;
                this._url = url;
                this._baseDir = url.substr(0, url.lastIndexOf('/') + 1);
                var loader = new THREE.FileLoader(this.manager);
                loader.setPath(this.path);
                loader.setResponseType('arraybuffer');
                loader.load(url, function (text) {
                    onLoad(scope.parse(text));
                }, onProgress, onError);
            },
            parse: function (data) {
                var blen = data.byteLength;
                this._ptr = 0;
                this._data = new DataView(data);
                this._parseHeader();
                if (this._compression != 0) {
                    console.error('compressed AWD not supported');
                }
                if (!this._streaming && this._bodylen != data.byteLength - this._ptr) {
                    console.error('AWDLoader: body len does not match file length', this._bodylen, blen - this._ptr);
                }
                while (this._ptr < blen) {
                    this.parseNextBlock();
                }
                return this.trunk;
            },
            parseNextBlock: function () {
                var assetData, block, blockId = this.readU32(), ns = this.readU8(), type = this.readU8(), flags = this.readU8(), len = this.readU32();
                switch (type) {
                case 1:
                    assetData = this.parseMeshData();
                    break;
                case 22:
                    assetData = this.parseContainer();
                    break;
                case 23:
                    assetData = this.parseMeshInstance();
                    break;
                case 81:
                    assetData = this.parseMaterial();
                    break;
                case 82:
                    assetData = this.parseTexture();
                    break;
                case 101:
                    assetData = this.parseSkeleton();
                    break;
                case 112:
                    assetData = this.parseMeshPoseAnimation(false);
                    break;
                case 113:
                    assetData = this.parseVertexAnimationSet();
                    break;
                case 102:
                    assetData = this.parseSkeletonPose();
                    break;
                case 103:
                    assetData = this.parseSkeletonAnimation();
                    break;
                case 122:
                    assetData = this.parseAnimatorSet();
                    break;
                default:
                    this._ptr += len;
                    break;
                }
                this._blocks[blockId] = block = new Block();
                block.data = assetData;
                block.id = blockId;
                block.namespace = ns;
                block.flags = flags;
            },
            _parseHeader: function () {
                var version = this._version, awdmagic = this.readU8() << 16 | this.readU8() << 8 | this.readU8();
                if (awdmagic != 4282180)
                    throw new Error('AWDLoader - bad magic');
                version[0] = this.readU8();
                version[1] = this.readU8();
                var flags = this.readU16();
                this._streaming = (flags & 1) == 1;
                if (version[0] === 2 && version[1] === 1) {
                    this._accuracyMatrix = (flags & 2) === 2;
                    this._accuracyGeo = (flags & 4) === 4;
                    this._accuracyProps = (flags & 8) === 8;
                }
                this._geoNrType = this._accuracyGeo ? FLOAT64 : FLOAT32;
                this._matrixNrType = this._accuracyMatrix ? FLOAT64 : FLOAT32;
                this._propsNrType = this._accuracyProps ? FLOAT64 : FLOAT32;
                this._optimized_for_accuracy = (flags & 2) === 2;
                this._compression = this.readU8();
                this._bodylen = this.readU32();
            },
            parseContainer: function () {
                var parent, ctr = new THREE.Object3D(), par_id = this.readU32(), mtx = this.parseMatrix4();
                ctr.name = this.readUTF();
                ctr.applyMatrix4(mtx);
                parent = this._blocks[par_id].data || this.trunk;
                parent.add(ctr);
                this.parseProperties({
                    1: this._matrixNrType,
                    2: this._matrixNrType,
                    3: this._matrixNrType,
                    4: UINT8
                });
                ctr.extra = this.parseUserAttributes();
                return ctr;
            },
            parseMeshInstance: function () {
                var name, mesh, geometries, meshLen, meshes, par_id, data_id, mtx, materials, mat, mat_id, num_materials, parent, i;
                par_id = this.readU32();
                mtx = this.parseMatrix4();
                name = this.readUTF();
                data_id = this.readU32();
                num_materials = this.readU16();
                geometries = this.getBlock(data_id);
                materials = [];
                for (i = 0; i < num_materials; i++) {
                    mat_id = this.readU32();
                    mat = this.getBlock(mat_id);
                    materials.push(mat);
                }
                meshLen = geometries.length;
                meshes = [];
                if (meshLen > 1) {
                    mesh = new THREE.Object3D();
                    for (i = 0; i < meshLen; i++) {
                        var sm = new THREE.Mesh(geometries[i]);
                        meshes.push(sm);
                        mesh.add(sm);
                    }
                } else {
                    mesh = new THREE.Mesh(geometries[0]);
                    meshes.push(mesh);
                }
                mesh.applyMatrix4(mtx);
                mesh.name = name;
                parent = this.getBlock(par_id) || this.trunk;
                parent.add(mesh);
                var matLen = materials.length;
                var maxLen = Math.max(meshLen, matLen);
                for (i = 0; i < maxLen; i++)
                    meshes[i % meshLen].material = materials[i % matLen];
                this.parseProperties(null);
                mesh.extra = this.parseUserAttributes();
                return mesh;
            },
            parseMaterial: function () {
                var name, type, props, mat, attributes, num_methods, methods_parsed;
                name = this.readUTF();
                type = this.readU8();
                num_methods = this.readU8();
                props = this.parseProperties({
                    1: AWD_FIELD_INT32,
                    2: AWD_FIELD_BADDR,
                    11: AWD_FIELD_BOOL,
                    12: AWD_FIELD_FLOAT32,
                    13: AWD_FIELD_BOOL
                });
                methods_parsed = 0;
                while (methods_parsed < num_methods) {
                    this.readU16();
                    this.parseProperties(null);
                    this.parseUserAttributes();
                }
                attributes = this.parseUserAttributes();
                if (this.materialFactory !== undefined) {
                    mat = this.materialFactory(name);
                    if (mat)
                        return mat;
                }
                mat = new THREE.MeshPhongMaterial();
                if (type === 1) {
                    mat.color.setHex(props.get(1, 13421772));
                } else if (type === 2) {
                    var tex_addr = props.get(2, 0);
                    mat.map = this.getBlock(tex_addr);
                }
                mat.extra = attributes;
                mat.alphaThreshold = props.get(12, 0);
                mat.repeat = props.get(13, false);
                return mat;
            },
            parseTexture: function () {
                var name = this.readUTF(), type = this.readU8(), asset, data_len;
                if (type === 0) {
                    data_len = this.readU32();
                    var url = this.readUTFBytes(data_len);
                    console.log(url);
                    asset = this.loadTexture(url);
                    asset.userData = {};
                    asset.userData.name = name;
                } else {
                }
                this.parseProperties(null);
                this.parseUserAttributes();
                return asset;
            },
            loadTexture: function (url) {
                var tex = new THREE.Texture();
                var loader = new THREE.ImageLoader(this.manager);
                loader.load(this._baseDir + url, function (image) {
                    tex.image = image;
                    tex.needsUpdate = true;
                });
                return tex;
            },
            parseSkeleton: function () {
                this.readUTF();
                var num_joints = this.readU16(), skeleton = [], joints_parsed = 0;
                this.parseProperties(null);
                while (joints_parsed < num_joints) {
                    var joint, ibp;
                    this.readU16();
                    joint = new THREE.Bone();
                    joint.parent = this.readU16() - 1;
                    joint.name = this.readUTF();
                    ibp = this.parseMatrix4();
                    joint.skinMatrix = ibp;
                    this.parseProperties(null);
                    this.parseUserAttributes();
                    skeleton.push(joint);
                    joints_parsed++;
                }
                this.parseUserAttributes();
                return skeleton;
            },
            parseSkeletonPose: function () {
                var name = this.readUTF();
                var num_joints = this.readU16();
                this.parseProperties(null);
                var pose = [];
                var joints_parsed = 0;
                while (joints_parsed < num_joints) {
                    var has_transform;
                    var mtx_data;
                    has_transform = this.readU8();
                    if (has_transform === 1) {
                        mtx_data = this.parseMatrix4();
                    } else {
                        mtx_data = new THREE.Matrix4();
                    }
                    pose[joints_parsed] = mtx_data;
                    joints_parsed++;
                }
                this.parseUserAttributes();
                return pose;
            },
            parseSkeletonAnimation: function () {
                var frame_dur;
                var pose_addr;
                var pose;
                var name = this.readUTF();
                var clip = [];
                var num_frames = this.readU16();
                this.parseProperties(null);
                var frames_parsed = 0;
                while (frames_parsed < num_frames) {
                    pose_addr = this.readU32();
                    frame_dur = this.readU16();
                    pose = this._blocks[pose_addr].data;
                    clip.push({
                        pose: pose,
                        duration: frame_dur
                    });
                    frames_parsed++;
                }
                if (clip.length === 0) {
                    return;
                }
                this.parseUserAttributes();
                return clip;
            },
            parseVertexAnimationSet: function () {
                var poseBlockAdress, name = this.readUTF(), num_frames = this.readU16(), props = this.parseProperties({ 1: UINT16 }), frames_parsed = 0, skeletonFrames = [];
                while (frames_parsed < num_frames) {
                    poseBlockAdress = this.readU32();
                    skeletonFrames.push(this._blocks[poseBlockAdress].data);
                    frames_parsed++;
                }
                this.parseUserAttributes();
                return skeletonFrames;
            },
            parseAnimatorSet: function () {
                var animSetBlockAdress;
                var targetAnimationSet;
                var name = this.readUTF();
                var type = this.readU16();
                var props = this.parseProperties({ 1: BADDR });
                animSetBlockAdress = this.readU32();
                var targetMeshLength = this.readU16();
                var meshAdresses = [];
                for (var i = 0; i < targetMeshLength; i++)
                    meshAdresses.push(this.readU32());
                var activeState = this.readU16();
                var autoplay = Boolean(this.readU8());
                this.parseUserAttributes();
                this.parseUserAttributes();
                var targetMeshes = [];
                for (i = 0; i < meshAdresses.length; i++) {
                    targetMeshes.push(this._blocks[meshAdresses[i]].data);
                }
                targetAnimationSet = this._blocks[animSetBlockAdress].data;
                var thisAnimator;
                if (type == 1) {
                    thisAnimator = {
                        animationSet: targetAnimationSet,
                        skeleton: this._blocks[props.get(1, 0)].data
                    };
                } else if (type == 2) {
                }
                for (i = 0; i < targetMeshes.length; i++) {
                    targetMeshes[i].animator = thisAnimator;
                }
                return thisAnimator;
            },
            parseMeshData: function () {
                var name = this.readUTF(), num_subs = this.readU16(), geom, subs_parsed = 0, buffer, geometries = [];
                this.parseProperties({
                    1: this._geoNrType,
                    2: this._geoNrType
                });
                while (subs_parsed < num_subs) {
                    var sm_len, sm_end, attrib;
                    geom = new THREE.BufferGeometry();
                    geom.name = name;
                    geometries.push(geom);
                    sm_len = this.readU32();
                    sm_end = this._ptr + sm_len;
                    this.parseProperties({
                        1: this._geoNrType,
                        2: this._geoNrType
                    });
                    while (this._ptr < sm_end) {
                        var idx = 0, str_type = this.readU8(), str_ftype = this.readU8(), str_len = this.readU32(), str_end = str_len + this._ptr;
                        if (str_type === 1) {
                            buffer = new Float32Array(str_len / 12 * 3);
                            attrib = new THREE.BufferAttribute(buffer, 3);
                            geom.setAttribute('position', attrib);
                            idx = 0;
                            while (this._ptr < str_end) {
                                buffer[idx] = -this.readF32();
                                buffer[idx + 1] = this.readF32();
                                buffer[idx + 2] = this.readF32();
                                idx += 3;
                            }
                        } else if (str_type === 2) {
                            buffer = new Uint16Array(str_len / 2);
                            attrib = new THREE.BufferAttribute(buffer, 1);
                            geom.setIndex(attrib);
                            idx = 0;
                            while (this._ptr < str_end) {
                                buffer[idx + 1] = this.readU16();
                                buffer[idx] = this.readU16();
                                buffer[idx + 2] = this.readU16();
                                idx += 3;
                            }
                        } else if (str_type === 3) {
                            buffer = new Float32Array(str_len / 8 * 2);
                            attrib = new THREE.BufferAttribute(buffer, 2);
                            geom.setAttribute('uv', attrib);
                            idx = 0;
                            while (this._ptr < str_end) {
                                buffer[idx] = this.readF32();
                                buffer[idx + 1] = 1 - this.readF32();
                                idx += 2;
                            }
                        } else if (str_type === 4) {
                            buffer = new Float32Array(str_len / 12 * 3);
                            attrib = new THREE.BufferAttribute(buffer, 3);
                            geom.setAttribute('normal', attrib);
                            idx = 0;
                            while (this._ptr < str_end) {
                                buffer[idx] = -this.readF32();
                                buffer[idx + 1] = this.readF32();
                                buffer[idx + 2] = this.readF32();
                                idx += 3;
                            }
                        } else {
                            this._ptr = str_end;
                        }
                    }
                    this.parseUserAttributes();
                    geom.computeBoundingSphere();
                    subs_parsed++;
                }
                this.parseUserAttributes();
                return geometries;
            },
            parseMeshPoseAnimation: function (poseOnly) {
                var num_frames = 1, num_submeshes, frames_parsed, subMeshParsed, str_len, str_end, geom, idx = 0, clip = {}, num_Streams, streamsParsed, streamtypes = [], props, name = this.readUTF(), geoAdress = this.readU32();
                var mesh = this.getBlock(geoAdress);
                if (mesh === null) {
                    console.log('parseMeshPoseAnimation target mesh not found at:', geoAdress);
                    return;
                }
                geom = mesh.geometry;
                geom.morphTargets = [];
                if (!poseOnly)
                    num_frames = this.readU16();
                num_submeshes = this.readU16();
                num_Streams = this.readU16();
                streamsParsed = 0;
                while (streamsParsed < num_Streams) {
                    streamtypes.push(this.readU16());
                    streamsParsed++;
                }
                props = this.parseProperties({
                    1: BOOL,
                    2: BOOL
                });
                clip.looping = props.get(1, true);
                clip.stitchFinalFrame = props.get(2, false);
                frames_parsed = 0;
                while (frames_parsed < num_frames) {
                    this.readU16();
                    subMeshParsed = 0;
                    while (subMeshParsed < num_submeshes) {
                        streamsParsed = 0;
                        str_len = this.readU32();
                        str_end = this._ptr + str_len;
                        while (streamsParsed < num_Streams) {
                            if (streamtypes[streamsParsed] === 1) {
                                var buffer = new Float32Array(str_len / 4);
                                geom.morphTargets.push({ array: buffer });
                                idx = 0;
                                while (this._ptr < str_end) {
                                    buffer[idx] = this.readF32();
                                    buffer[idx + 1] = this.readF32();
                                    buffer[idx + 2] = this.readF32();
                                    idx += 3;
                                }
                                subMeshParsed++;
                            } else
                                this._ptr = str_end;
                            streamsParsed++;
                        }
                    }
                    frames_parsed++;
                }
                this.parseUserAttributes();
                return null;
            },
            getBlock: function (id) {
                return this._blocks[id].data;
            },
            parseMatrix4: function () {
                var mtx = new THREE.Matrix4();
                var e = mtx.elements;
                e[0] = this.readF32();
                e[1] = this.readF32();
                e[2] = this.readF32();
                e[3] = 0;
                e[4] = this.readF32();
                e[5] = this.readF32();
                e[6] = this.readF32();
                e[7] = 0;
                e[8] = this.readF32();
                e[9] = this.readF32();
                e[10] = this.readF32();
                e[11] = 0;
                e[12] = -this.readF32();
                e[13] = this.readF32();
                e[14] = this.readF32();
                e[15] = 1;
                return mtx;
            },
            parseProperties: function (expected) {
                var list_len = this.readU32();
                var list_end = this._ptr + list_len;
                var props = new AWDProperties();
                if (expected) {
                    while (this._ptr < list_end) {
                        var key = this.readU16();
                        var len = this.readU32();
                        var type;
                        if (expected.hasOwnProperty(key)) {
                            type = expected[key];
                            props.set(key, this.parseAttrValue(type, len));
                        } else {
                            this._ptr += len;
                        }
                    }
                }
                return props;
            },
            parseUserAttributes: function () {
                this._ptr = this.readU32() + this._ptr;
                return null;
            },
            parseAttrValue: function (type, len) {
                var elem_len;
                var read_func;
                switch (type) {
                case AWD_FIELD_INT8:
                    elem_len = 1;
                    read_func = this.readI8;
                    break;
                case AWD_FIELD_INT16:
                    elem_len = 2;
                    read_func = this.readI16;
                    break;
                case AWD_FIELD_INT32:
                    elem_len = 4;
                    read_func = this.readI32;
                    break;
                case AWD_FIELD_BOOL:
                case AWD_FIELD_UINT8:
                    elem_len = 1;
                    read_func = this.readU8;
                    break;
                case AWD_FIELD_UINT16:
                    elem_len = 2;
                    read_func = this.readU16;
                    break;
                case AWD_FIELD_UINT32:
                case AWD_FIELD_BADDR:
                    elem_len = 4;
                    read_func = this.readU32;
                    break;
                case AWD_FIELD_FLOAT32:
                    elem_len = 4;
                    read_func = this.readF32;
                    break;
                case AWD_FIELD_FLOAT64:
                    elem_len = 8;
                    read_func = this.readF64;
                    break;
                case AWD_FIELD_VECTOR2x1:
                case AWD_FIELD_VECTOR3x1:
                case AWD_FIELD_VECTOR4x1:
                case AWD_FIELD_MTX3x2:
                case AWD_FIELD_MTX3x3:
                case AWD_FIELD_MTX4x3:
                case AWD_FIELD_MTX4x4:
                    elem_len = 8;
                    read_func = this.readF64;
                    break;
                }
                if (elem_len < len) {
                    var list;
                    var num_read;
                    var num_elems;
                    list = [];
                    num_read = 0;
                    num_elems = len / elem_len;
                    while (num_read < num_elems) {
                        list.push(read_func.call(this));
                        num_read++;
                    }
                    return list;
                } else {
                    return read_func.call(this);
                }
            },
            readU8: function () {
                return this._data.getUint8(this._ptr++);
            },
            readI8: function () {
                return this._data.getInt8(this._ptr++);
            },
            readU16: function () {
                var a = this._data.getUint16(this._ptr, littleEndian);
                this._ptr += 2;
                return a;
            },
            readI16: function () {
                var a = this._data.getInt16(this._ptr, littleEndian);
                this._ptr += 2;
                return a;
            },
            readU32: function () {
                var a = this._data.getUint32(this._ptr, littleEndian);
                this._ptr += 4;
                return a;
            },
            readI32: function () {
                var a = this._data.getInt32(this._ptr, littleEndian);
                this._ptr += 4;
                return a;
            },
            readF32: function () {
                var a = this._data.getFloat32(this._ptr, littleEndian);
                this._ptr += 4;
                return a;
            },
            readF64: function () {
                var a = this._data.getFloat64(this._ptr, littleEndian);
                this._ptr += 8;
                return a;
            },
            readUTF: function () {
                var len = this.readU16();
                return this.readUTFBytes(len);
            },
            readUTFBytes: function (len) {
                var out = [], c = 0;
                while (out.length < len) {
                    var c1 = this._data.getUint8(this._ptr++, littleEndian);
                    if (c1 < 128) {
                        out[c++] = String.fromCharCode(c1);
                    } else if (c1 > 191 && c1 < 224) {
                        var c2 = this._data.getUint8(this._ptr++, littleEndian);
                        out[c++] = String.fromCharCode((c1 & 31) << 6 | c2 & 63);
                    } else {
                        var c2 = this._data.getUint8(this._ptr++, littleEndian);
                        var c3 = this._data.getUint8(this._ptr++, littleEndian);
                        out[c++] = String.fromCharCode((c1 & 15) << 12 | (c2 & 63) << 6 | c3 & 63);
                    }
                }
                return out.join('');
            }
        });
        return AWDLoader;
    }();

    return threex.loaders.AWDLoader = AWDLoader;
});
define('skylark-threejs-ex/loaders/BabylonLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {

	/**
	 * @author mrdoob / http://mrdoob.com/
	 * @author Mugen87 / https://github.com/Mugen87
	 */

	 function BabylonLoader( manager ) {

		this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;

	};

	BabylonLoader.prototype = {

		constructor: BabylonLoader,

		load: function ( url, onLoad, onProgress, onError ) {

			var scope = this;

			var loader = new THREE.FileLoader( scope.manager );
			loader.setPath( scope.path );
			loader.load( url, function ( text ) {

				onLoad( scope.parse( JSON.parse( text ) ) );

			}, onProgress, onError );

		},

		setPath: function ( value ) {

			this.path = value;
			return this;

		},

		parse: function ( json ) {

			function parseMaterials( json ) {

				var materials = {};

				for ( var i = 0, l = json.materials.length; i < l; i ++ ) {

					var data = json.materials[ i ];

					var material = new THREE.MeshPhongMaterial();
					material.name = data.name;
					material.color.fromArray( data.diffuse );
					material.emissive.fromArray( data.emissive );
					material.specular.fromArray( data.specular );
					material.shininess = data.specularPower;
					material.opacity = data.alpha;

					materials[ data.id ] = material;

				}

				if ( json.multiMaterials ) {

					for ( var i = 0, l = json.multiMaterials.length; i < l; i ++ ) {

						var data = json.multiMaterials[ i ];

						console.warn( 'BabylonLoader: Multi materials not yet supported.' );

						materials[ data.id ] = new THREE.MeshPhongMaterial();

					}

				}

				return materials;

			}

			function parseGeometry( json ) {

				var geometry = new THREE.BufferGeometry();

				var indices = json.indices;
				var positions = json.positions;
				var normals = json.normals;
				var uvs = json.uvs;

				// indices

				geometry.setIndex( indices );

				// positions

				for ( var j = 2, jl = positions.length; j < jl; j += 3 ) {

					positions[ j ] = - positions[ j ];

				}

				geometry.addAttribute( 'position', new THREE.Float32BufferAttribute( positions, 3 ) );

				// normals

				if ( normals ) {

					for ( var j = 2, jl = normals.length; j < jl; j += 3 ) {

						normals[ j ] = - normals[ j ];

					}

					geometry.addAttribute( 'normal', new THREE.Float32BufferAttribute( normals, 3 ) );

				}

				// uvs

				if ( uvs ) {

					geometry.addAttribute( 'uv', new THREE.Float32BufferAttribute( uvs, 2 ) );

				}

				// offsets

				var subMeshes = json.subMeshes;

				if ( subMeshes ) {

					for ( var j = 0, jl = subMeshes.length; j < jl; j ++ ) {

						var subMesh = subMeshes[ j ];

						geometry.addGroup( subMesh.indexStart, subMesh.indexCount );

					}

				}

				return geometry;

			}

			function parseObjects( json, materials ) {

				var objects = {};
				var scene = new THREE.Scene();

				var cameras = json.cameras;

				for ( var i = 0, l = cameras.length; i < l; i ++ ) {

					var data = cameras[ i ];

					var camera = new THREE.PerspectiveCamera( ( data.fov / Math.PI ) * 180, 1.33, data.minZ, data.maxZ );

					camera.name = data.name;
					camera.position.fromArray( data.position );
					if ( data.rotation ) camera.rotation.fromArray( data.rotation );

					objects[ data.id ] = camera;

				}

				var lights = json.lights;

				for ( var i = 0, l = lights.length; i < l; i ++ ) {

					var data = lights[ i ];

					var light;

					switch ( data.type ) {

						case 0:
							light = new THREE.PointLight();
							break;

						case 1:
							light = new THREE.DirectionalLight();
							break;

						case 2:
							light = new THREE.SpotLight();
							break;

						case 3:
							light = new THREE.HemisphereLight();
							break;

					}

					light.name = data.name;
					if ( data.position ) light.position.set( data.position[ 0 ], data.position[ 1 ], - data.position[ 2 ] );
					light.color.fromArray( data.diffuse );
					if ( data.groundColor ) light.groundColor.fromArray( data.groundColor );
					if ( data.intensity ) light.intensity = data.intensity;

					objects[ data.id ] = light;

					scene.add( light );

				}

				var meshes = json.meshes;

				for ( var i = 0, l = meshes.length; i < l; i ++ ) {

					var data = meshes[ i ];

					var object;

					if ( data.indices ) {

						var geometry = parseGeometry( data );

						object = new THREE.Mesh( geometry, materials[ data.materialId ] );

					} else {

						object = new THREE.Group();

					}

					object.name = data.name;
					object.position.set( data.position[ 0 ], data.position[ 1 ], - data.position[ 2 ] );
					object.rotation.fromArray( data.rotation );
					if ( data.rotationQuaternion ) object.quaternion.fromArray( data.rotationQuaternion );
					object.scale.fromArray( data.scaling );
					// object.visible = data.isVisible;

					if ( data.parentId ) {

						objects[ data.parentId ].add( object );

					} else {

						scene.add( object );

					}

					objects[ data.id ] = object;

				}

				return scene;

			}

			var materials = parseMaterials( json );
			var scene = parseObjects( json, materials );

			return scene;

		}

	};
	
	return threex.loaders.BabylonLoader = BabylonLoader;
});
define('skylark-threejs-ex/loaders/TGALoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var TGALoader = function (manager) {
        THREE.Loader.call(this, manager);
    };
    TGALoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: TGALoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var texture = new THREE.Texture();
            var loader = new THREE.FileLoader(this.manager);
            loader.setResponseType('arraybuffer');
            loader.setPath(this.path);
            loader.load(url, function (buffer) {
                texture.image = scope.parse(buffer);
                texture.needsUpdate = true;
                if (onLoad !== undefined) {
                    onLoad(texture);
                }
            }, onProgress, onError);
            return texture;
        },
        parse: function (buffer) {
            function tgaCheckHeader(header) {
                switch (header.image_type) {
                case TGA_TYPE_INDEXED:
                case TGA_TYPE_RLE_INDEXED:
                    if (header.colormap_length > 256 || header.colormap_size !== 24 || header.colormap_type !== 1) {
                        console.error('THREE.TGALoader: Invalid type colormap data for indexed type.');
                    }
                    break;
                case TGA_TYPE_RGB:
                case TGA_TYPE_GREY:
                case TGA_TYPE_RLE_RGB:
                case TGA_TYPE_RLE_GREY:
                    if (header.colormap_type) {
                        console.error('THREE.TGALoader: Invalid type colormap data for colormap type.');
                    }
                    break;
                case TGA_TYPE_NO_DATA:
                    console.error('THREE.TGALoader: No data.');
                default:
                    console.error('THREE.TGALoader: Invalid type "%s".', header.image_type);
                }
                if (header.width <= 0 || header.height <= 0) {
                    console.error('THREE.TGALoader: Invalid image size.');
                }
                if (header.pixel_size !== 8 && header.pixel_size !== 16 && header.pixel_size !== 24 && header.pixel_size !== 32) {
                    console.error('THREE.TGALoader: Invalid pixel size "%s".', header.pixel_size);
                }
            }
            function tgaParse(use_rle, use_pal, header, offset, data) {
                var pixel_data, pixel_size, pixel_total, palettes;
                pixel_size = header.pixel_size >> 3;
                pixel_total = header.width * header.height * pixel_size;
                if (use_pal) {
                    palettes = data.subarray(offset, offset += header.colormap_length * (header.colormap_size >> 3));
                }
                if (use_rle) {
                    pixel_data = new Uint8Array(pixel_total);
                    var c, count, i;
                    var shift = 0;
                    var pixels = new Uint8Array(pixel_size);
                    while (shift < pixel_total) {
                        c = data[offset++];
                        count = (c & 127) + 1;
                        if (c & 128) {
                            for (i = 0; i < pixel_size; ++i) {
                                pixels[i] = data[offset++];
                            }
                            for (i = 0; i < count; ++i) {
                                pixel_data.set(pixels, shift + i * pixel_size);
                            }
                            shift += pixel_size * count;
                        } else {
                            count *= pixel_size;
                            for (i = 0; i < count; ++i) {
                                pixel_data[shift + i] = data[offset++];
                            }
                            shift += count;
                        }
                    }
                } else {
                    pixel_data = data.subarray(offset, offset += use_pal ? header.width * header.height : pixel_total);
                }
                return {
                    pixel_data: pixel_data,
                    palettes: palettes
                };
            }
            function tgaGetImageData8bits(imageData, y_start, y_step, y_end, x_start, x_step, x_end, image, palettes) {
                var colormap = palettes;
                var color, i = 0, x, y;
                var width = header.width;
                for (y = y_start; y !== y_end; y += y_step) {
                    for (x = x_start; x !== x_end; x += x_step, i++) {
                        color = image[i];
                        imageData[(x + width * y) * 4 + 3] = 255;
                        imageData[(x + width * y) * 4 + 2] = colormap[color * 3 + 0];
                        imageData[(x + width * y) * 4 + 1] = colormap[color * 3 + 1];
                        imageData[(x + width * y) * 4 + 0] = colormap[color * 3 + 2];
                    }
                }
                return imageData;
            }
            function tgaGetImageData16bits(imageData, y_start, y_step, y_end, x_start, x_step, x_end, image) {
                var color, i = 0, x, y;
                var width = header.width;
                for (y = y_start; y !== y_end; y += y_step) {
                    for (x = x_start; x !== x_end; x += x_step, i += 2) {
                        color = image[i + 0] + (image[i + 1] << 8);
                        imageData[(x + width * y) * 4 + 0] = (color & 31744) >> 7;
                        imageData[(x + width * y) * 4 + 1] = (color & 992) >> 2;
                        imageData[(x + width * y) * 4 + 2] = (color & 31) >> 3;
                        imageData[(x + width * y) * 4 + 3] = color & 32768 ? 0 : 255;
                    }
                }
                return imageData;
            }
            function tgaGetImageData24bits(imageData, y_start, y_step, y_end, x_start, x_step, x_end, image) {
                var i = 0, x, y;
                var width = header.width;
                for (y = y_start; y !== y_end; y += y_step) {
                    for (x = x_start; x !== x_end; x += x_step, i += 3) {
                        imageData[(x + width * y) * 4 + 3] = 255;
                        imageData[(x + width * y) * 4 + 2] = image[i + 0];
                        imageData[(x + width * y) * 4 + 1] = image[i + 1];
                        imageData[(x + width * y) * 4 + 0] = image[i + 2];
                    }
                }
                return imageData;
            }
            function tgaGetImageData32bits(imageData, y_start, y_step, y_end, x_start, x_step, x_end, image) {
                var i = 0, x, y;
                var width = header.width;
                for (y = y_start; y !== y_end; y += y_step) {
                    for (x = x_start; x !== x_end; x += x_step, i += 4) {
                        imageData[(x + width * y) * 4 + 2] = image[i + 0];
                        imageData[(x + width * y) * 4 + 1] = image[i + 1];
                        imageData[(x + width * y) * 4 + 0] = image[i + 2];
                        imageData[(x + width * y) * 4 + 3] = image[i + 3];
                    }
                }
                return imageData;
            }
            function tgaGetImageDataGrey8bits(imageData, y_start, y_step, y_end, x_start, x_step, x_end, image) {
                var color, i = 0, x, y;
                var width = header.width;
                for (y = y_start; y !== y_end; y += y_step) {
                    for (x = x_start; x !== x_end; x += x_step, i++) {
                        color = image[i];
                        imageData[(x + width * y) * 4 + 0] = color;
                        imageData[(x + width * y) * 4 + 1] = color;
                        imageData[(x + width * y) * 4 + 2] = color;
                        imageData[(x + width * y) * 4 + 3] = 255;
                    }
                }
                return imageData;
            }
            function tgaGetImageDataGrey16bits(imageData, y_start, y_step, y_end, x_start, x_step, x_end, image) {
                var i = 0, x, y;
                var width = header.width;
                for (y = y_start; y !== y_end; y += y_step) {
                    for (x = x_start; x !== x_end; x += x_step, i += 2) {
                        imageData[(x + width * y) * 4 + 0] = image[i + 0];
                        imageData[(x + width * y) * 4 + 1] = image[i + 0];
                        imageData[(x + width * y) * 4 + 2] = image[i + 0];
                        imageData[(x + width * y) * 4 + 3] = image[i + 1];
                    }
                }
                return imageData;
            }
            function getTgaRGBA(data, width, height, image, palette) {
                var x_start, y_start, x_step, y_step, x_end, y_end;
                switch ((header.flags & TGA_ORIGIN_MASK) >> TGA_ORIGIN_SHIFT) {
                default:
                case TGA_ORIGIN_UL:
                    x_start = 0;
                    x_step = 1;
                    x_end = width;
                    y_start = 0;
                    y_step = 1;
                    y_end = height;
                    break;
                case TGA_ORIGIN_BL:
                    x_start = 0;
                    x_step = 1;
                    x_end = width;
                    y_start = height - 1;
                    y_step = -1;
                    y_end = -1;
                    break;
                case TGA_ORIGIN_UR:
                    x_start = width - 1;
                    x_step = -1;
                    x_end = -1;
                    y_start = 0;
                    y_step = 1;
                    y_end = height;
                    break;
                case TGA_ORIGIN_BR:
                    x_start = width - 1;
                    x_step = -1;
                    x_end = -1;
                    y_start = height - 1;
                    y_step = -1;
                    y_end = -1;
                    break;
                }
                if (use_grey) {
                    switch (header.pixel_size) {
                    case 8:
                        tgaGetImageDataGrey8bits(data, y_start, y_step, y_end, x_start, x_step, x_end, image);
                        break;
                    case 16:
                        tgaGetImageDataGrey16bits(data, y_start, y_step, y_end, x_start, x_step, x_end, image);
                        break;
                    default:
                        console.error('THREE.TGALoader: Format not supported.');
                        break;
                    }
                } else {
                    switch (header.pixel_size) {
                    case 8:
                        tgaGetImageData8bits(data, y_start, y_step, y_end, x_start, x_step, x_end, image, palette);
                        break;
                    case 16:
                        tgaGetImageData16bits(data, y_start, y_step, y_end, x_start, x_step, x_end, image);
                        break;
                    case 24:
                        tgaGetImageData24bits(data, y_start, y_step, y_end, x_start, x_step, x_end, image);
                        break;
                    case 32:
                        tgaGetImageData32bits(data, y_start, y_step, y_end, x_start, x_step, x_end, image);
                        break;
                    default:
                        console.error('THREE.TGALoader: Format not supported.');
                        break;
                    }
                }
                return data;
            }
            var TGA_TYPE_NO_DATA = 0, TGA_TYPE_INDEXED = 1, TGA_TYPE_RGB = 2, TGA_TYPE_GREY = 3, TGA_TYPE_RLE_INDEXED = 9, TGA_TYPE_RLE_RGB = 10, TGA_TYPE_RLE_GREY = 11, TGA_ORIGIN_MASK = 48, TGA_ORIGIN_SHIFT = 4, TGA_ORIGIN_BL = 0, TGA_ORIGIN_BR = 1, TGA_ORIGIN_UL = 2, TGA_ORIGIN_UR = 3;
            if (buffer.length < 19)
                console.error('THREE.TGALoader: Not enough data to contain header.');
            var content = new Uint8Array(buffer), offset = 0, header = {
                    id_length: content[offset++],
                    colormap_type: content[offset++],
                    image_type: content[offset++],
                    colormap_index: content[offset++] | content[offset++] << 8,
                    colormap_length: content[offset++] | content[offset++] << 8,
                    colormap_size: content[offset++],
                    origin: [
                        content[offset++] | content[offset++] << 8,
                        content[offset++] | content[offset++] << 8
                    ],
                    width: content[offset++] | content[offset++] << 8,
                    height: content[offset++] | content[offset++] << 8,
                    pixel_size: content[offset++],
                    flags: content[offset++]
                };
            tgaCheckHeader(header);
            if (header.id_length + offset > buffer.length) {
                console.error('THREE.TGALoader: No data.');
            }
            offset += header.id_length;
            var use_rle = false, use_pal = false, use_grey = false;
            switch (header.image_type) {
            case TGA_TYPE_RLE_INDEXED:
                use_rle = true;
                use_pal = true;
                break;
            case TGA_TYPE_INDEXED:
                use_pal = true;
                break;
            case TGA_TYPE_RLE_RGB:
                use_rle = true;
                break;
            case TGA_TYPE_RGB:
                break;
            case TGA_TYPE_RLE_GREY:
                use_rle = true;
                use_grey = true;
                break;
            case TGA_TYPE_GREY:
                use_grey = true;
                break;
            }
            var useOffscreen = typeof OffscreenCanvas !== 'undefined';
            var canvas = useOffscreen ? new OffscreenCanvas(header.width, header.height) : document.createElement('canvas');
            canvas.width = header.width;
            canvas.height = header.height;
            var context = canvas.getContext('2d');
            var imageData = context.createImageData(header.width, header.height);
            var result = tgaParse(use_rle, use_pal, header, offset, content);
            var rgbaData = getTgaRGBA(imageData.data, header.width, header.height, result.pixel_data, result.palettes);
            context.putImageData(imageData, 0, 0);
            return useOffscreen ? canvas.transferToImageBitmap() : canvas;
        }
    });
    return  threex.loaders.TGALoader = TGALoader;
});
define('skylark-threejs-ex/loaders/ColladaLoader',[
    "skylark-threejs",
    "../threex",
    '../loaders/TGALoader'
], function (
    THREE,
    threex, 
    TGALoader
) {
    'use strict';
    var ColladaLoader = function (manager) {
        THREE.Loader.call(this, manager);
    };
    ColladaLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: ColladaLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var path = scope.path === '' ? THREE.LoaderUtils.extractUrlBase(url) : scope.path;
            var loader = new THREE.FileLoader(scope.manager);
            loader.setPath(scope.path);
            loader.load(url, function (text) {
                onLoad(scope.parse(text, path));
            }, onProgress, onError);
        },
        options: {
            set convertUpAxis(value) {
                console.warn('THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.');
            }
        },
        parse: function (text, path) {
            function getElementsByTagName(xml, name) {
                var array = [];
                var childNodes = xml.childNodes;
                for (var i = 0, l = childNodes.length; i < l; i++) {
                    var child = childNodes[i];
                    if (child.nodeName === name) {
                        array.push(child);
                    }
                }
                return array;
            }
            function parseStrings(text) {
                if (text.length === 0)
                    return [];
                var parts = text.trim().split(/\s+/);
                var array = new Array(parts.length);
                for (var i = 0, l = parts.length; i < l; i++) {
                    array[i] = parts[i];
                }
                return array;
            }
            function parseFloats(text) {
                if (text.length === 0)
                    return [];
                var parts = text.trim().split(/\s+/);
                var array = new Array(parts.length);
                for (var i = 0, l = parts.length; i < l; i++) {
                    array[i] = parseFloat(parts[i]);
                }
                return array;
            }
            function parseInts(text) {
                if (text.length === 0)
                    return [];
                var parts = text.trim().split(/\s+/);
                var array = new Array(parts.length);
                for (var i = 0, l = parts.length; i < l; i++) {
                    array[i] = parseInt(parts[i]);
                }
                return array;
            }
            function parseId(text) {
                return text.substring(1);
            }
            function generateId() {
                return 'three_default_' + count++;
            }
            function isEmpty(object) {
                return Object.keys(object).length === 0;
            }
            function parseAsset(xml) {
                return {
                    unit: parseAssetUnit(getElementsByTagName(xml, 'unit')[0]),
                    upAxis: parseAssetUpAxis(getElementsByTagName(xml, 'up_axis')[0])
                };
            }
            function parseAssetUnit(xml) {
                if (xml !== undefined && xml.hasAttribute('meter') === true) {
                    return parseFloat(xml.getAttribute('meter'));
                } else {
                    return 1;
                }
            }
            function parseAssetUpAxis(xml) {
                return xml !== undefined ? xml.textContent : 'Y_UP';
            }
            function parseLibrary(xml, libraryName, nodeName, parser) {
                var library = getElementsByTagName(xml, libraryName)[0];
                if (library !== undefined) {
                    var elements = getElementsByTagName(library, nodeName);
                    for (var i = 0; i < elements.length; i++) {
                        parser(elements[i]);
                    }
                }
            }
            function buildLibrary(data, builder) {
                for (var name in data) {
                    var object = data[name];
                    object.build = builder(data[name]);
                }
            }
            function getBuild(data, builder) {
                if (data.build !== undefined)
                    return data.build;
                data.build = builder(data);
                return data.build;
            }
            function parseAnimation(xml) {
                var data = {
                    sources: {},
                    samplers: {},
                    channels: {}
                };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    var id;
                    switch (child.nodeName) {
                    case 'source':
                        id = child.getAttribute('id');
                        data.sources[id] = parseSource(child);
                        break;
                    case 'sampler':
                        id = child.getAttribute('id');
                        data.samplers[id] = parseAnimationSampler(child);
                        break;
                    case 'channel':
                        id = child.getAttribute('target');
                        data.channels[id] = parseAnimationChannel(child);
                        break;
                    default:
                        console.log(child);
                    }
                }
                library.animations[xml.getAttribute('id')] = data;
            }
            function parseAnimationSampler(xml) {
                var data = { inputs: {} };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'input':
                        var id = parseId(child.getAttribute('source'));
                        var semantic = child.getAttribute('semantic');
                        data.inputs[semantic] = id;
                        break;
                    }
                }
                return data;
            }
            function parseAnimationChannel(xml) {
                var data = {};
                var target = xml.getAttribute('target');
                var parts = target.split('/');
                var id = parts.shift();
                var sid = parts.shift();
                var arraySyntax = sid.indexOf('(') !== -1;
                var memberSyntax = sid.indexOf('.') !== -1;
                if (memberSyntax) {
                    parts = sid.split('.');
                    sid = parts.shift();
                    data.member = parts.shift();
                } else if (arraySyntax) {
                    var indices = sid.split('(');
                    sid = indices.shift();
                    for (var i = 0; i < indices.length; i++) {
                        indices[i] = parseInt(indices[i].replace(/\)/, ''));
                    }
                    data.indices = indices;
                }
                data.id = id;
                data.sid = sid;
                data.arraySyntax = arraySyntax;
                data.memberSyntax = memberSyntax;
                data.sampler = parseId(xml.getAttribute('source'));
                return data;
            }
            function buildAnimation(data) {
                var tracks = [];
                var channels = data.channels;
                var samplers = data.samplers;
                var sources = data.sources;
                for (var target in channels) {
                    if (channels.hasOwnProperty(target)) {
                        var channel = channels[target];
                        var sampler = samplers[channel.sampler];
                        var inputId = sampler.inputs.INPUT;
                        var outputId = sampler.inputs.OUTPUT;
                        var inputSource = sources[inputId];
                        var outputSource = sources[outputId];
                        var animation = buildAnimationChannel(channel, inputSource, outputSource);
                        createKeyframeTracks(animation, tracks);
                    }
                }
                return tracks;
            }
            function getAnimation(id) {
                return getBuild(library.animations[id], buildAnimation);
            }
            function buildAnimationChannel(channel, inputSource, outputSource) {
                var node = library.nodes[channel.id];
                var object3D = getNode(node.id);
                var transform = node.transforms[channel.sid];
                var defaultMatrix = node.matrix.clone().transpose();
                var time, stride;
                var i, il, j, jl;
                var data = {};
                switch (transform) {
                case 'matrix':
                    for (i = 0, il = inputSource.array.length; i < il; i++) {
                        time = inputSource.array[i];
                        stride = i * outputSource.stride;
                        if (data[time] === undefined)
                            data[time] = {};
                        if (channel.arraySyntax === true) {
                            var value = outputSource.array[stride];
                            var index = channel.indices[0] + 4 * channel.indices[1];
                            data[time][index] = value;
                        } else {
                            for (j = 0, jl = outputSource.stride; j < jl; j++) {
                                data[time][j] = outputSource.array[stride + j];
                            }
                        }
                    }
                    break;
                case 'translate':
                    console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.', transform);
                    break;
                case 'rotate':
                    console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.', transform);
                    break;
                case 'scale':
                    console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.', transform);
                    break;
                }
                var keyframes = prepareAnimationData(data, defaultMatrix);
                var animation = {
                    name: object3D.uuid,
                    keyframes: keyframes
                };
                return animation;
            }
            function prepareAnimationData(data, defaultMatrix) {
                var keyframes = [];
                for (var time in data) {
                    keyframes.push({
                        time: parseFloat(time),
                        value: data[time]
                    });
                }
                keyframes.sort(ascending);
                for (var i = 0; i < 16; i++) {
                    transformAnimationData(keyframes, i, defaultMatrix.elements[i]);
                }
                return keyframes;
                function ascending(a, b) {
                    return a.time - b.time;
                }
            }
            var position = new THREE.Vector3();
            var scale = new THREE.Vector3();
            var quaternion = new THREE.Quaternion();
            function createKeyframeTracks(animation, tracks) {
                var keyframes = animation.keyframes;
                var name = animation.name;
                var times = [];
                var positionData = [];
                var quaternionData = [];
                var scaleData = [];
                for (var i = 0, l = keyframes.length; i < l; i++) {
                    var keyframe = keyframes[i];
                    var time = keyframe.time;
                    var value = keyframe.value;
                    matrix.fromArray(value).transpose();
                    matrix.decompose(position, quaternion, scale);
                    times.push(time);
                    positionData.push(position.x, position.y, position.z);
                    quaternionData.push(quaternion.x, quaternion.y, quaternion.z, quaternion.w);
                    scaleData.push(scale.x, scale.y, scale.z);
                }
                if (positionData.length > 0)
                    tracks.push(new THREE.VectorKeyframeTrack(name + '.position', times, positionData));
                if (quaternionData.length > 0)
                    tracks.push(new THREE.QuaternionKeyframeTrack(name + '.quaternion', times, quaternionData));
                if (scaleData.length > 0)
                    tracks.push(new THREE.VectorKeyframeTrack(name + '.scale', times, scaleData));
                return tracks;
            }
            function transformAnimationData(keyframes, property, defaultValue) {
                var keyframe;
                var empty = true;
                var i, l;
                for (i = 0, l = keyframes.length; i < l; i++) {
                    keyframe = keyframes[i];
                    if (keyframe.value[property] === undefined) {
                        keyframe.value[property] = null;
                    } else {
                        empty = false;
                    }
                }
                if (empty === true) {
                    for (i = 0, l = keyframes.length; i < l; i++) {
                        keyframe = keyframes[i];
                        keyframe.value[property] = defaultValue;
                    }
                } else {
                    createMissingKeyframes(keyframes, property);
                }
            }
            function createMissingKeyframes(keyframes, property) {
                var prev, next;
                for (var i = 0, l = keyframes.length; i < l; i++) {
                    var keyframe = keyframes[i];
                    if (keyframe.value[property] === null) {
                        prev = getPrev(keyframes, i, property);
                        next = getNext(keyframes, i, property);
                        if (prev === null) {
                            keyframe.value[property] = next.value[property];
                            continue;
                        }
                        if (next === null) {
                            keyframe.value[property] = prev.value[property];
                            continue;
                        }
                        interpolate(keyframe, prev, next, property);
                    }
                }
            }
            function getPrev(keyframes, i, property) {
                while (i >= 0) {
                    var keyframe = keyframes[i];
                    if (keyframe.value[property] !== null)
                        return keyframe;
                    i--;
                }
                return null;
            }
            function getNext(keyframes, i, property) {
                while (i < keyframes.length) {
                    var keyframe = keyframes[i];
                    if (keyframe.value[property] !== null)
                        return keyframe;
                    i++;
                }
                return null;
            }
            function interpolate(key, prev, next, property) {
                if (next.time - prev.time === 0) {
                    key.value[property] = prev.value[property];
                    return;
                }
                key.value[property] = (key.time - prev.time) * (next.value[property] - prev.value[property]) / (next.time - prev.time) + prev.value[property];
            }
            function parseAnimationClip(xml) {
                var data = {
                    name: xml.getAttribute('id') || 'default',
                    start: parseFloat(xml.getAttribute('start') || 0),
                    end: parseFloat(xml.getAttribute('end') || 0),
                    animations: []
                };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'instance_animation':
                        data.animations.push(parseId(child.getAttribute('url')));
                        break;
                    }
                }
                library.clips[xml.getAttribute('id')] = data;
            }
            function buildAnimationClip(data) {
                var tracks = [];
                var name = data.name;
                var duration = data.end - data.start || -1;
                var animations = data.animations;
                for (var i = 0, il = animations.length; i < il; i++) {
                    var animationTracks = getAnimation(animations[i]);
                    for (var j = 0, jl = animationTracks.length; j < jl; j++) {
                        tracks.push(animationTracks[j]);
                    }
                }
                return new THREE.AnimationClip(name, duration, tracks);
            }
            function getAnimationClip(id) {
                return getBuild(library.clips[id], buildAnimationClip);
            }
            function parseController(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'skin':
                        data.id = parseId(child.getAttribute('source'));
                        data.skin = parseSkin(child);
                        break;
                    case 'morph':
                        data.id = parseId(child.getAttribute('source'));
                        console.warn('THREE.ColladaLoader: Morph target animation not supported yet.');
                        break;
                    }
                }
                library.controllers[xml.getAttribute('id')] = data;
            }
            function parseSkin(xml) {
                var data = { sources: {} };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'bind_shape_matrix':
                        data.bindShapeMatrix = parseFloats(child.textContent);
                        break;
                    case 'source':
                        var id = child.getAttribute('id');
                        data.sources[id] = parseSource(child);
                        break;
                    case 'joints':
                        data.joints = parseJoints(child);
                        break;
                    case 'vertex_weights':
                        data.vertexWeights = parseVertexWeights(child);
                        break;
                    }
                }
                return data;
            }
            function parseJoints(xml) {
                var data = { inputs: {} };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'input':
                        var semantic = child.getAttribute('semantic');
                        var id = parseId(child.getAttribute('source'));
                        data.inputs[semantic] = id;
                        break;
                    }
                }
                return data;
            }
            function parseVertexWeights(xml) {
                var data = { inputs: {} };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'input':
                        var semantic = child.getAttribute('semantic');
                        var id = parseId(child.getAttribute('source'));
                        var offset = parseInt(child.getAttribute('offset'));
                        data.inputs[semantic] = {
                            id: id,
                            offset: offset
                        };
                        break;
                    case 'vcount':
                        data.vcount = parseInts(child.textContent);
                        break;
                    case 'v':
                        data.v = parseInts(child.textContent);
                        break;
                    }
                }
                return data;
            }
            function buildController(data) {
                var build = { id: data.id };
                var geometry = library.geometries[build.id];
                if (data.skin !== undefined) {
                    build.skin = buildSkin(data.skin);
                    geometry.sources.skinIndices = build.skin.indices;
                    geometry.sources.skinWeights = build.skin.weights;
                }
                return build;
            }
            function buildSkin(data) {
                var BONE_LIMIT = 4;
                var build = {
                    joints: [],
                    indices: {
                        array: [],
                        stride: BONE_LIMIT
                    },
                    weights: {
                        array: [],
                        stride: BONE_LIMIT
                    }
                };
                var sources = data.sources;
                var vertexWeights = data.vertexWeights;
                var vcount = vertexWeights.vcount;
                var v = vertexWeights.v;
                var jointOffset = vertexWeights.inputs.JOINT.offset;
                var weightOffset = vertexWeights.inputs.WEIGHT.offset;
                var jointSource = data.sources[data.joints.inputs.JOINT];
                var inverseSource = data.sources[data.joints.inputs.INV_BIND_MATRIX];
                var weights = sources[vertexWeights.inputs.WEIGHT.id].array;
                var stride = 0;
                var i, j, l;
                for (i = 0, l = vcount.length; i < l; i++) {
                    var jointCount = vcount[i];
                    var vertexSkinData = [];
                    for (j = 0; j < jointCount; j++) {
                        var skinIndex = v[stride + jointOffset];
                        var weightId = v[stride + weightOffset];
                        var skinWeight = weights[weightId];
                        vertexSkinData.push({
                            index: skinIndex,
                            weight: skinWeight
                        });
                        stride += 2;
                    }
                    vertexSkinData.sort(descending);
                    for (j = 0; j < BONE_LIMIT; j++) {
                        var d = vertexSkinData[j];
                        if (d !== undefined) {
                            build.indices.array.push(d.index);
                            build.weights.array.push(d.weight);
                        } else {
                            build.indices.array.push(0);
                            build.weights.array.push(0);
                        }
                    }
                }
                if (data.bindShapeMatrix) {
                    build.bindMatrix = new THREE.Matrix4().fromArray(data.bindShapeMatrix).transpose();
                } else {
                    build.bindMatrix = new THREE.Matrix4().identity();
                }
                for (i = 0, l = jointSource.array.length; i < l; i++) {
                    var name = jointSource.array[i];
                    var boneInverse = new THREE.Matrix4().fromArray(inverseSource.array, i * inverseSource.stride).transpose();
                    build.joints.push({
                        name: name,
                        boneInverse: boneInverse
                    });
                }
                return build;
                function descending(a, b) {
                    return b.weight - a.weight;
                }
            }
            function getController(id) {
                return getBuild(library.controllers[id], buildController);
            }
            function parseImage(xml) {
                var data = { init_from: getElementsByTagName(xml, 'init_from')[0].textContent };
                library.images[xml.getAttribute('id')] = data;
            }
            function buildImage(data) {
                if (data.build !== undefined)
                    return data.build;
                return data.init_from;
            }
            function getImage(id) {
                var data = library.images[id];
                if (data !== undefined) {
                    return getBuild(data, buildImage);
                }
                console.warn("THREE.ColladaLoader: Couldn't find image with ID:", id);
                return null;
            }
            function parseEffect(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'profile_COMMON':
                        data.profile = parseEffectProfileCOMMON(child);
                        break;
                    }
                }
                library.effects[xml.getAttribute('id')] = data;
            }
            function parseEffectProfileCOMMON(xml) {
                var data = {
                    surfaces: {},
                    samplers: {}
                };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'newparam':
                        parseEffectNewparam(child, data);
                        break;
                    case 'technique':
                        data.technique = parseEffectTechnique(child);
                        break;
                    case 'extra':
                        data.extra = parseEffectExtra(child);
                        break;
                    }
                }
                return data;
            }
            function parseEffectNewparam(xml, data) {
                var sid = xml.getAttribute('sid');
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'surface':
                        data.surfaces[sid] = parseEffectSurface(child);
                        break;
                    case 'sampler2D':
                        data.samplers[sid] = parseEffectSampler(child);
                        break;
                    }
                }
            }
            function parseEffectSurface(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'init_from':
                        data.init_from = child.textContent;
                        break;
                    }
                }
                return data;
            }
            function parseEffectSampler(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'source':
                        data.source = child.textContent;
                        break;
                    }
                }
                return data;
            }
            function parseEffectTechnique(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'constant':
                    case 'lambert':
                    case 'blinn':
                    case 'phong':
                        data.type = child.nodeName;
                        data.parameters = parseEffectParameters(child);
                        break;
                    }
                }
                return data;
            }
            function parseEffectParameters(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'emission':
                    case 'diffuse':
                    case 'specular':
                    case 'bump':
                    case 'ambient':
                    case 'shininess':
                    case 'transparency':
                        data[child.nodeName] = parseEffectParameter(child);
                        break;
                    case 'transparent':
                        data[child.nodeName] = {
                            opaque: child.getAttribute('opaque'),
                            data: parseEffectParameter(child)
                        };
                        break;
                    }
                }
                return data;
            }
            function parseEffectParameter(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'color':
                        data[child.nodeName] = parseFloats(child.textContent);
                        break;
                    case 'float':
                        data[child.nodeName] = parseFloat(child.textContent);
                        break;
                    case 'texture':
                        data[child.nodeName] = {
                            id: child.getAttribute('texture'),
                            extra: parseEffectParameterTexture(child)
                        };
                        break;
                    }
                }
                return data;
            }
            function parseEffectParameterTexture(xml) {
                var data = { technique: {} };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'extra':
                        parseEffectParameterTextureExtra(child, data);
                        break;
                    }
                }
                return data;
            }
            function parseEffectParameterTextureExtra(xml, data) {
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'technique':
                        parseEffectParameterTextureExtraTechnique(child, data);
                        break;
                    }
                }
            }
            function parseEffectParameterTextureExtraTechnique(xml, data) {
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'repeatU':
                    case 'repeatV':
                    case 'offsetU':
                    case 'offsetV':
                        data.technique[child.nodeName] = parseFloat(child.textContent);
                        break;
                    case 'wrapU':
                    case 'wrapV':
                        if (child.textContent.toUpperCase() === 'TRUE') {
                            data.technique[child.nodeName] = 1;
                        } else if (child.textContent.toUpperCase() === 'FALSE') {
                            data.technique[child.nodeName] = 0;
                        } else {
                            data.technique[child.nodeName] = parseInt(child.textContent);
                        }
                        break;
                    }
                }
            }
            function parseEffectExtra(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'technique':
                        data.technique = parseEffectExtraTechnique(child);
                        break;
                    }
                }
                return data;
            }
            function parseEffectExtraTechnique(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'double_sided':
                        data[child.nodeName] = parseInt(child.textContent);
                        break;
                    }
                }
                return data;
            }
            function buildEffect(data) {
                return data;
            }
            function getEffect(id) {
                return getBuild(library.effects[id], buildEffect);
            }
            function parseMaterial(xml) {
                var data = { name: xml.getAttribute('name') };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'instance_effect':
                        data.url = parseId(child.getAttribute('url'));
                        break;
                    }
                }
                library.materials[xml.getAttribute('id')] = data;
            }
            function getTextureLoader(image) {
                var loader;
                var extension = image.slice((image.lastIndexOf('.') - 1 >>> 0) + 2);
                extension = extension.toLowerCase();
                switch (extension) {
                case 'tga':
                    loader = tgaLoader;
                    break;
                default:
                    loader = textureLoader;
                }
                return loader;
            }
            function buildMaterial(data) {
                var effect = getEffect(data.url);
                var technique = effect.profile.technique;
                var extra = effect.profile.extra;
                var material;
                switch (technique.type) {
                case 'phong':
                case 'blinn':
                    material = new THREE.MeshPhongMaterial();
                    break;
                case 'lambert':
                    material = new THREE.MeshLambertMaterial();
                    break;
                default:
                    material = new THREE.MeshBasicMaterial();
                    break;
                }
                material.name = data.name || '';
                function getTexture(textureObject) {
                    var sampler = effect.profile.samplers[textureObject.id];
                    var image = null;
                    if (sampler !== undefined) {
                        var surface = effect.profile.surfaces[sampler.source];
                        image = getImage(surface.init_from);
                    } else {
                        console.warn('THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530).');
                        image = getImage(textureObject.id);
                    }
                    if (image !== null) {
                        var loader = getTextureLoader(image);
                        if (loader !== undefined) {
                            var texture = loader.load(image);
                            var extra = textureObject.extra;
                            if (extra !== undefined && extra.technique !== undefined && isEmpty(extra.technique) === false) {
                                var technique = extra.technique;
                                texture.wrapS = technique.wrapU ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;
                                texture.wrapT = technique.wrapV ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;
                                texture.offset.set(technique.offsetU || 0, technique.offsetV || 0);
                                texture.repeat.set(technique.repeatU || 1, technique.repeatV || 1);
                            } else {
                                texture.wrapS = THREE.RepeatWrapping;
                                texture.wrapT = THREE.RepeatWrapping;
                            }
                            return texture;
                        } else {
                            console.warn('THREE.ColladaLoader: Loader for texture %s not found.', image);
                            return null;
                        }
                    } else {
                        console.warn("THREE.ColladaLoader: Couldn't create texture with ID:", textureObject.id);
                        return null;
                    }
                }
                var parameters = technique.parameters;
                for (var key in parameters) {
                    var parameter = parameters[key];
                    switch (key) {
                    case 'diffuse':
                        if (parameter.color)
                            material.color.fromArray(parameter.color);
                        if (parameter.texture)
                            material.map = getTexture(parameter.texture);
                        break;
                    case 'specular':
                        if (parameter.color && material.specular)
                            material.specular.fromArray(parameter.color);
                        if (parameter.texture)
                            material.specularMap = getTexture(parameter.texture);
                        break;
                    case 'bump':
                        if (parameter.texture)
                            material.normalMap = getTexture(parameter.texture);
                        break;
                    case 'ambient':
                        if (parameter.texture)
                            material.lightMap = getTexture(parameter.texture);
                        break;
                    case 'shininess':
                        if (parameter.float && material.shininess)
                            material.shininess = parameter.float;
                        break;
                    case 'emission':
                        if (parameter.color && material.emissive)
                            material.emissive.fromArray(parameter.color);
                        if (parameter.texture)
                            material.emissiveMap = getTexture(parameter.texture);
                        break;
                    }
                }
                var transparent = parameters['transparent'];
                var transparency = parameters['transparency'];
                if (transparency === undefined && transparent) {
                    transparency = { float: 1 };
                }
                if (transparent === undefined && transparency) {
                    transparent = {
                        opaque: 'A_ONE',
                        data: {
                            color: [
                                1,
                                1,
                                1,
                                1
                            ]
                        }
                    };
                }
                if (transparent && transparency) {
                    if (transparent.data.texture) {
                        material.transparent = true;
                    } else {
                        var color = transparent.data.color;
                        switch (transparent.opaque) {
                        case 'A_ONE':
                            material.opacity = color[3] * transparency.float;
                            break;
                        case 'RGB_ZERO':
                            material.opacity = 1 - color[0] * transparency.float;
                            break;
                        case 'A_ZERO':
                            material.opacity = 1 - color[3] * transparency.float;
                            break;
                        case 'RGB_ONE':
                            material.opacity = color[0] * transparency.float;
                            break;
                        default:
                            console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.', transparent.opaque);
                        }
                        if (material.opacity < 1)
                            material.transparent = true;
                    }
                }
                if (extra !== undefined && extra.technique !== undefined && extra.technique.double_sided === 1) {
                    material.side = THREE.DoubleSide;
                }
                return material;
            }
            function getMaterial(id) {
                return getBuild(library.materials[id], buildMaterial);
            }
            function parseCamera(xml) {
                var data = { name: xml.getAttribute('name') };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'optics':
                        data.optics = parseCameraOptics(child);
                        break;
                    }
                }
                library.cameras[xml.getAttribute('id')] = data;
            }
            function parseCameraOptics(xml) {
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    switch (child.nodeName) {
                    case 'technique_common':
                        return parseCameraTechnique(child);
                    }
                }
                return {};
            }
            function parseCameraTechnique(xml) {
                var data = {};
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    switch (child.nodeName) {
                    case 'perspective':
                    case 'orthographic':
                        data.technique = child.nodeName;
                        data.parameters = parseCameraParameters(child);
                        break;
                    }
                }
                return data;
            }
            function parseCameraParameters(xml) {
                var data = {};
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    switch (child.nodeName) {
                    case 'xfov':
                    case 'yfov':
                    case 'xmag':
                    case 'ymag':
                    case 'znear':
                    case 'zfar':
                    case 'aspect_ratio':
                        data[child.nodeName] = parseFloat(child.textContent);
                        break;
                    }
                }
                return data;
            }
            function buildCamera(data) {
                var camera;
                switch (data.optics.technique) {
                case 'perspective':
                    camera = new THREE.PerspectiveCamera(data.optics.parameters.yfov, data.optics.parameters.aspect_ratio, data.optics.parameters.znear, data.optics.parameters.zfar);
                    break;
                case 'orthographic':
                    var ymag = data.optics.parameters.ymag;
                    var xmag = data.optics.parameters.xmag;
                    var aspectRatio = data.optics.parameters.aspect_ratio;
                    xmag = xmag === undefined ? ymag * aspectRatio : xmag;
                    ymag = ymag === undefined ? xmag / aspectRatio : ymag;
                    xmag *= 0.5;
                    ymag *= 0.5;
                    camera = new THREE.OrthographicCamera(-xmag, xmag, ymag, -ymag, data.optics.parameters.znear, data.optics.parameters.zfar);
                    break;
                default:
                    camera = new THREE.PerspectiveCamera();
                    break;
                }
                camera.name = data.name || '';
                return camera;
            }
            function getCamera(id) {
                var data = library.cameras[id];
                if (data !== undefined) {
                    return getBuild(data, buildCamera);
                }
                console.warn("THREE.ColladaLoader: Couldn't find camera with ID:", id);
                return null;
            }
            function parseLight(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'technique_common':
                        data = parseLightTechnique(child);
                        break;
                    }
                }
                library.lights[xml.getAttribute('id')] = data;
            }
            function parseLightTechnique(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'directional':
                    case 'point':
                    case 'spot':
                    case 'ambient':
                        data.technique = child.nodeName;
                        data.parameters = parseLightParameters(child);
                    }
                }
                return data;
            }
            function parseLightParameters(xml) {
                var data = {};
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'color':
                        var array = parseFloats(child.textContent);
                        data.color = new THREE.Color().fromArray(array);
                        break;
                    case 'falloff_angle':
                        data.falloffAngle = parseFloat(child.textContent);
                        break;
                    case 'quadratic_attenuation':
                        var f = parseFloat(child.textContent);
                        data.distance = f ? Math.sqrt(1 / f) : 0;
                        break;
                    }
                }
                return data;
            }
            function buildLight(data) {
                var light;
                switch (data.technique) {
                case 'directional':
                    light = new THREE.DirectionalLight();
                    break;
                case 'point':
                    light = new THREE.PointLight();
                    break;
                case 'spot':
                    light = new THREE.SpotLight();
                    break;
                case 'ambient':
                    light = new THREE.AmbientLight();
                    break;
                }
                if (data.parameters.color)
                    light.color.copy(data.parameters.color);
                if (data.parameters.distance)
                    light.distance = data.parameters.distance;
                return light;
            }
            function getLight(id) {
                var data = library.lights[id];
                if (data !== undefined) {
                    return getBuild(data, buildLight);
                }
                console.warn("THREE.ColladaLoader: Couldn't find light with ID:", id);
                return null;
            }
            function parseGeometry(xml) {
                var data = {
                    name: xml.getAttribute('name'),
                    sources: {},
                    vertices: {},
                    primitives: []
                };
                var mesh = getElementsByTagName(xml, 'mesh')[0];
                if (mesh === undefined)
                    return;
                for (var i = 0; i < mesh.childNodes.length; i++) {
                    var child = mesh.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    var id = child.getAttribute('id');
                    switch (child.nodeName) {
                    case 'source':
                        data.sources[id] = parseSource(child);
                        break;
                    case 'vertices':
                        data.vertices = parseGeometryVertices(child);
                        break;
                    case 'polygons':
                        console.warn('THREE.ColladaLoader: Unsupported primitive type: ', child.nodeName);
                        break;
                    case 'lines':
                    case 'linestrips':
                    case 'polylist':
                    case 'triangles':
                        data.primitives.push(parseGeometryPrimitive(child));
                        break;
                    default:
                        console.log(child);
                    }
                }
                library.geometries[xml.getAttribute('id')] = data;
            }
            function parseSource(xml) {
                var data = {
                    array: [],
                    stride: 3
                };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'float_array':
                        data.array = parseFloats(child.textContent);
                        break;
                    case 'Name_array':
                        data.array = parseStrings(child.textContent);
                        break;
                    case 'technique_common':
                        var accessor = getElementsByTagName(child, 'accessor')[0];
                        if (accessor !== undefined) {
                            data.stride = parseInt(accessor.getAttribute('stride'));
                        }
                        break;
                    }
                }
                return data;
            }
            function parseGeometryVertices(xml) {
                var data = {};
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    data[child.getAttribute('semantic')] = parseId(child.getAttribute('source'));
                }
                return data;
            }
            function parseGeometryPrimitive(xml) {
                var primitive = {
                    type: xml.nodeName,
                    material: xml.getAttribute('material'),
                    count: parseInt(xml.getAttribute('count')),
                    inputs: {},
                    stride: 0,
                    hasUV: false
                };
                for (var i = 0, l = xml.childNodes.length; i < l; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'input':
                        var id = parseId(child.getAttribute('source'));
                        var semantic = child.getAttribute('semantic');
                        var offset = parseInt(child.getAttribute('offset'));
                        var set = parseInt(child.getAttribute('set'));
                        var inputname = set > 0 ? semantic + set : semantic;
                        primitive.inputs[inputname] = {
                            id: id,
                            offset: offset
                        };
                        primitive.stride = Math.max(primitive.stride, offset + 1);
                        if (semantic === 'TEXCOORD')
                            primitive.hasUV = true;
                        break;
                    case 'vcount':
                        primitive.vcount = parseInts(child.textContent);
                        break;
                    case 'p':
                        primitive.p = parseInts(child.textContent);
                        break;
                    }
                }
                return primitive;
            }
            function groupPrimitives(primitives) {
                var build = {};
                for (var i = 0; i < primitives.length; i++) {
                    var primitive = primitives[i];
                    if (build[primitive.type] === undefined)
                        build[primitive.type] = [];
                    build[primitive.type].push(primitive);
                }
                return build;
            }
            function checkUVCoordinates(primitives) {
                var count = 0;
                for (var i = 0, l = primitives.length; i < l; i++) {
                    var primitive = primitives[i];
                    if (primitive.hasUV === true) {
                        count++;
                    }
                }
                if (count > 0 && count < primitives.length) {
                    primitives.uvsNeedsFix = true;
                }
            }
            function buildGeometry(data) {
                var build = {};
                var sources = data.sources;
                var vertices = data.vertices;
                var primitives = data.primitives;
                if (primitives.length === 0)
                    return {};
                var groupedPrimitives = groupPrimitives(primitives);
                for (var type in groupedPrimitives) {
                    var primitiveType = groupedPrimitives[type];
                    checkUVCoordinates(primitiveType);
                    build[type] = buildGeometryType(primitiveType, sources, vertices);
                }
                return build;
            }
            function buildGeometryType(primitives, sources, vertices) {
                var build = {};
                var position = {
                    array: [],
                    stride: 0
                };
                var normal = {
                    array: [],
                    stride: 0
                };
                var uv = {
                    array: [],
                    stride: 0
                };
                var uv2 = {
                    array: [],
                    stride: 0
                };
                var color = {
                    array: [],
                    stride: 0
                };
                var skinIndex = {
                    array: [],
                    stride: 4
                };
                var skinWeight = {
                    array: [],
                    stride: 4
                };
                var geometry = new THREE.BufferGeometry();
                var materialKeys = [];
                var start = 0;
                for (var p = 0; p < primitives.length; p++) {
                    var primitive = primitives[p];
                    var inputs = primitive.inputs;
                    var count = 0;
                    switch (primitive.type) {
                    case 'lines':
                    case 'linestrips':
                        count = primitive.count * 2;
                        break;
                    case 'triangles':
                        count = primitive.count * 3;
                        break;
                    case 'polylist':
                        for (var g = 0; g < primitive.count; g++) {
                            var vc = primitive.vcount[g];
                            switch (vc) {
                            case 3:
                                count += 3;
                                break;
                            case 4:
                                count += 6;
                                break;
                            default:
                                count += (vc - 2) * 3;
                                break;
                            }
                        }
                        break;
                    default:
                        console.warn('THREE.ColladaLoader: Unknow primitive type:', primitive.type);
                    }
                    geometry.addGroup(start, count, p);
                    start += count;
                    if (primitive.material) {
                        materialKeys.push(primitive.material);
                    }
                    for (var name in inputs) {
                        var input = inputs[name];
                        switch (name) {
                        case 'VERTEX':
                            for (var key in vertices) {
                                var id = vertices[key];
                                switch (key) {
                                case 'POSITION':
                                    var prevLength = position.array.length;
                                    buildGeometryData(primitive, sources[id], input.offset, position.array);
                                    position.stride = sources[id].stride;
                                    if (sources.skinWeights && sources.skinIndices) {
                                        buildGeometryData(primitive, sources.skinIndices, input.offset, skinIndex.array);
                                        buildGeometryData(primitive, sources.skinWeights, input.offset, skinWeight.array);
                                    }
                                    if (primitive.hasUV === false && primitives.uvsNeedsFix === true) {
                                        var count = (position.array.length - prevLength) / position.stride;
                                        for (var i = 0; i < count; i++) {
                                            uv.array.push(0, 0);
                                        }
                                    }
                                    break;
                                case 'NORMAL':
                                    buildGeometryData(primitive, sources[id], input.offset, normal.array);
                                    normal.stride = sources[id].stride;
                                    break;
                                case 'COLOR':
                                    buildGeometryData(primitive, sources[id], input.offset, color.array);
                                    color.stride = sources[id].stride;
                                    break;
                                case 'TEXCOORD':
                                    buildGeometryData(primitive, sources[id], input.offset, uv.array);
                                    uv.stride = sources[id].stride;
                                    break;
                                case 'TEXCOORD1':
                                    buildGeometryData(primitive, sources[id], input.offset, uv2.array);
                                    uv.stride = sources[id].stride;
                                    break;
                                default:
                                    console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.', key);
                                }
                            }
                            break;
                        case 'NORMAL':
                            buildGeometryData(primitive, sources[input.id], input.offset, normal.array);
                            normal.stride = sources[input.id].stride;
                            break;
                        case 'COLOR':
                            buildGeometryData(primitive, sources[input.id], input.offset, color.array);
                            color.stride = sources[input.id].stride;
                            break;
                        case 'TEXCOORD':
                            buildGeometryData(primitive, sources[input.id], input.offset, uv.array);
                            uv.stride = sources[input.id].stride;
                            break;
                        case 'TEXCOORD1':
                            buildGeometryData(primitive, sources[input.id], input.offset, uv2.array);
                            uv2.stride = sources[input.id].stride;
                            break;
                        }
                    }
                }
                if (position.array.length > 0)
                    geometry.setAttribute('position', new THREE.Float32BufferAttribute(position.array, position.stride));
                if (normal.array.length > 0)
                    geometry.setAttribute('normal', new THREE.Float32BufferAttribute(normal.array, normal.stride));
                if (color.array.length > 0)
                    geometry.setAttribute('color', new THREE.Float32BufferAttribute(color.array, color.stride));
                if (uv.array.length > 0)
                    geometry.setAttribute('uv', new THREE.Float32BufferAttribute(uv.array, uv.stride));
                if (uv2.array.length > 0)
                    geometry.setAttribute('uv2', new THREE.Float32BufferAttribute(uv2.array, uv2.stride));
                if (skinIndex.array.length > 0)
                    geometry.setAttribute('skinIndex', new THREE.Float32BufferAttribute(skinIndex.array, skinIndex.stride));
                if (skinWeight.array.length > 0)
                    geometry.setAttribute('skinWeight', new THREE.Float32BufferAttribute(skinWeight.array, skinWeight.stride));
                build.data = geometry;
                build.type = primitives[0].type;
                build.materialKeys = materialKeys;
                return build;
            }
            function buildGeometryData(primitive, source, offset, array) {
                var indices = primitive.p;
                var stride = primitive.stride;
                var vcount = primitive.vcount;
                function pushVector(i) {
                    var index = indices[i + offset] * sourceStride;
                    var length = index + sourceStride;
                    for (; index < length; index++) {
                        array.push(sourceArray[index]);
                    }
                }
                var sourceArray = source.array;
                var sourceStride = source.stride;
                if (primitive.vcount !== undefined) {
                    var index = 0;
                    for (var i = 0, l = vcount.length; i < l; i++) {
                        var count = vcount[i];
                        if (count === 4) {
                            var a = index + stride * 0;
                            var b = index + stride * 1;
                            var c = index + stride * 2;
                            var d = index + stride * 3;
                            pushVector(a);
                            pushVector(b);
                            pushVector(d);
                            pushVector(b);
                            pushVector(c);
                            pushVector(d);
                        } else if (count === 3) {
                            var a = index + stride * 0;
                            var b = index + stride * 1;
                            var c = index + stride * 2;
                            pushVector(a);
                            pushVector(b);
                            pushVector(c);
                        } else if (count > 4) {
                            for (var k = 1, kl = count - 2; k <= kl; k++) {
                                var a = index + stride * 0;
                                var b = index + stride * k;
                                var c = index + stride * (k + 1);
                                pushVector(a);
                                pushVector(b);
                                pushVector(c);
                            }
                        }
                        index += stride * count;
                    }
                } else {
                    for (var i = 0, l = indices.length; i < l; i += stride) {
                        pushVector(i);
                    }
                }
            }
            function getGeometry(id) {
                return getBuild(library.geometries[id], buildGeometry);
            }
            function parseKinematicsModel(xml) {
                var data = {
                    name: xml.getAttribute('name') || '',
                    joints: {},
                    links: []
                };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'technique_common':
                        parseKinematicsTechniqueCommon(child, data);
                        break;
                    }
                }
                library.kinematicsModels[xml.getAttribute('id')] = data;
            }
            function buildKinematicsModel(data) {
                if (data.build !== undefined)
                    return data.build;
                return data;
            }
            function getKinematicsModel(id) {
                return getBuild(library.kinematicsModels[id], buildKinematicsModel);
            }
            function parseKinematicsTechniqueCommon(xml, data) {
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'joint':
                        data.joints[child.getAttribute('sid')] = parseKinematicsJoint(child);
                        break;
                    case 'link':
                        data.links.push(parseKinematicsLink(child));
                        break;
                    }
                }
            }
            function parseKinematicsJoint(xml) {
                var data;
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'prismatic':
                    case 'revolute':
                        data = parseKinematicsJointParameter(child);
                        break;
                    }
                }
                return data;
            }
            function parseKinematicsJointParameter(xml, data) {
                var data = {
                    sid: xml.getAttribute('sid'),
                    name: xml.getAttribute('name') || '',
                    axis: new THREE.Vector3(),
                    limits: {
                        min: 0,
                        max: 0
                    },
                    type: xml.nodeName,
                    static: false,
                    zeroPosition: 0,
                    middlePosition: 0
                };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'axis':
                        var array = parseFloats(child.textContent);
                        data.axis.fromArray(array);
                        break;
                    case 'limits':
                        var max = child.getElementsByTagName('max')[0];
                        var min = child.getElementsByTagName('min')[0];
                        data.limits.max = parseFloat(max.textContent);
                        data.limits.min = parseFloat(min.textContent);
                        break;
                    }
                }
                if (data.limits.min >= data.limits.max) {
                    data.static = true;
                }
                data.middlePosition = (data.limits.min + data.limits.max) / 2;
                return data;
            }
            function parseKinematicsLink(xml) {
                var data = {
                    sid: xml.getAttribute('sid'),
                    name: xml.getAttribute('name') || '',
                    attachments: [],
                    transforms: []
                };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'attachment_full':
                        data.attachments.push(parseKinematicsAttachment(child));
                        break;
                    case 'matrix':
                    case 'translate':
                    case 'rotate':
                        data.transforms.push(parseKinematicsTransform(child));
                        break;
                    }
                }
                return data;
            }
            function parseKinematicsAttachment(xml) {
                var data = {
                    joint: xml.getAttribute('joint').split('/').pop(),
                    transforms: [],
                    links: []
                };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'link':
                        data.links.push(parseKinematicsLink(child));
                        break;
                    case 'matrix':
                    case 'translate':
                    case 'rotate':
                        data.transforms.push(parseKinematicsTransform(child));
                        break;
                    }
                }
                return data;
            }
            function parseKinematicsTransform(xml) {
                var data = { type: xml.nodeName };
                var array = parseFloats(xml.textContent);
                switch (data.type) {
                case 'matrix':
                    data.obj = new THREE.Matrix4();
                    data.obj.fromArray(array).transpose();
                    break;
                case 'translate':
                    data.obj = new THREE.Vector3();
                    data.obj.fromArray(array);
                    break;
                case 'rotate':
                    data.obj = new THREE.Vector3();
                    data.obj.fromArray(array);
                    data.angle = THREE.MathUtils.degToRad(array[3]);
                    break;
                }
                return data;
            }
            function parsePhysicsModel(xml) {
                var data = {
                    name: xml.getAttribute('name') || '',
                    rigidBodies: {}
                };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'rigid_body':
                        data.rigidBodies[child.getAttribute('name')] = {};
                        parsePhysicsRigidBody(child, data.rigidBodies[child.getAttribute('name')]);
                        break;
                    }
                }
                library.physicsModels[xml.getAttribute('id')] = data;
            }
            function parsePhysicsRigidBody(xml, data) {
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'technique_common':
                        parsePhysicsTechniqueCommon(child, data);
                        break;
                    }
                }
            }
            function parsePhysicsTechniqueCommon(xml, data) {
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'inertia':
                        data.inertia = parseFloats(child.textContent);
                        break;
                    case 'mass':
                        data.mass = parseFloats(child.textContent)[0];
                        break;
                    }
                }
            }
            function parseKinematicsScene(xml) {
                var data = { bindJointAxis: [] };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'bind_joint_axis':
                        data.bindJointAxis.push(parseKinematicsBindJointAxis(child));
                        break;
                    }
                }
                library.kinematicsScenes[parseId(xml.getAttribute('url'))] = data;
            }
            function parseKinematicsBindJointAxis(xml) {
                var data = { target: xml.getAttribute('target').split('/').pop() };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'axis':
                        var param = child.getElementsByTagName('param')[0];
                        data.axis = param.textContent;
                        var tmpJointIndex = data.axis.split('inst_').pop().split('axis')[0];
                        data.jointIndex = tmpJointIndex.substr(0, tmpJointIndex.length - 1);
                        break;
                    }
                }
                return data;
            }
            function buildKinematicsScene(data) {
                if (data.build !== undefined)
                    return data.build;
                return data;
            }
            function getKinematicsScene(id) {
                return getBuild(library.kinematicsScenes[id], buildKinematicsScene);
            }
            function setupKinematics() {
                var kinematicsModelId = Object.keys(library.kinematicsModels)[0];
                var kinematicsSceneId = Object.keys(library.kinematicsScenes)[0];
                var visualSceneId = Object.keys(library.visualScenes)[0];
                if (kinematicsModelId === undefined || kinematicsSceneId === undefined)
                    return;
                var kinematicsModel = getKinematicsModel(kinematicsModelId);
                var kinematicsScene = getKinematicsScene(kinematicsSceneId);
                var visualScene = getVisualScene(visualSceneId);
                var bindJointAxis = kinematicsScene.bindJointAxis;
                var jointMap = {};
                for (var i = 0, l = bindJointAxis.length; i < l; i++) {
                    var axis = bindJointAxis[i];
                    var targetElement = collada.querySelector('[sid="' + axis.target + '"]');
                    if (targetElement) {
                        var parentVisualElement = targetElement.parentElement;
                        connect(axis.jointIndex, parentVisualElement);
                    }
                }
                function connect(jointIndex, visualElement) {
                    var visualElementName = visualElement.getAttribute('name');
                    var joint = kinematicsModel.joints[jointIndex];
                    visualScene.traverse(function (object) {
                        if (object.name === visualElementName) {
                            jointMap[jointIndex] = {
                                object: object,
                                transforms: buildTransformList(visualElement),
                                joint: joint,
                                position: joint.zeroPosition
                            };
                        }
                    });
                }
                var m0 = new THREE.Matrix4();
                kinematics = {
                    joints: kinematicsModel && kinematicsModel.joints,
                    getJointValue: function (jointIndex) {
                        var jointData = jointMap[jointIndex];
                        if (jointData) {
                            return jointData.position;
                        } else {
                            console.warn('THREE.ColladaLoader: Joint ' + jointIndex + " doesn't exist.");
                        }
                    },
                    setJointValue: function (jointIndex, value) {
                        var jointData = jointMap[jointIndex];
                        if (jointData) {
                            var joint = jointData.joint;
                            if (value > joint.limits.max || value < joint.limits.min) {
                                console.warn('THREE.ColladaLoader: Joint ' + jointIndex + ' value ' + value + ' outside of limits (min: ' + joint.limits.min + ', max: ' + joint.limits.max + ').');
                            } else if (joint.static) {
                                console.warn('THREE.ColladaLoader: Joint ' + jointIndex + ' is static.');
                            } else {
                                var object = jointData.object;
                                var axis = joint.axis;
                                var transforms = jointData.transforms;
                                matrix.identity();
                                for (var i = 0; i < transforms.length; i++) {
                                    var transform = transforms[i];
                                    if (transform.sid && transform.sid.indexOf(jointIndex) !== -1) {
                                        switch (joint.type) {
                                        case 'revolute':
                                            matrix.multiply(m0.makeRotationAxis(axis, THREE.MathUtils.degToRad(value)));
                                            break;
                                        case 'prismatic':
                                            matrix.multiply(m0.makeTranslation(axis.x * value, axis.y * value, axis.z * value));
                                            break;
                                        default:
                                            console.warn('THREE.ColladaLoader: Unknown joint type: ' + joint.type);
                                            break;
                                        }
                                    } else {
                                        switch (transform.type) {
                                        case 'matrix':
                                            matrix.multiply(transform.obj);
                                            break;
                                        case 'translate':
                                            matrix.multiply(m0.makeTranslation(transform.obj.x, transform.obj.y, transform.obj.z));
                                            break;
                                        case 'scale':
                                            matrix.scale(transform.obj);
                                            break;
                                        case 'rotate':
                                            matrix.multiply(m0.makeRotationAxis(transform.obj, transform.angle));
                                            break;
                                        }
                                    }
                                }
                                object.matrix.copy(matrix);
                                object.matrix.decompose(object.position, object.quaternion, object.scale);
                                jointMap[jointIndex].position = value;
                            }
                        } else {
                            console.log('THREE.ColladaLoader: ' + jointIndex + ' does not exist.');
                        }
                    }
                };
            }
            function buildTransformList(node) {
                var transforms = [];
                var xml = collada.querySelector('[id="' + node.id + '"]');
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'matrix':
                        var array = parseFloats(child.textContent);
                        var matrix = new THREE.Matrix4().fromArray(array).transpose();
                        transforms.push({
                            sid: child.getAttribute('sid'),
                            type: child.nodeName,
                            obj: matrix
                        });
                        break;
                    case 'translate':
                    case 'scale':
                        var array = parseFloats(child.textContent);
                        var vector = new THREE.Vector3().fromArray(array);
                        transforms.push({
                            sid: child.getAttribute('sid'),
                            type: child.nodeName,
                            obj: vector
                        });
                        break;
                    case 'rotate':
                        var array = parseFloats(child.textContent);
                        var vector = new THREE.Vector3().fromArray(array);
                        var angle = THREE.MathUtils.degToRad(array[3]);
                        transforms.push({
                            sid: child.getAttribute('sid'),
                            type: child.nodeName,
                            obj: vector,
                            angle: angle
                        });
                        break;
                    }
                }
                return transforms;
            }
            function prepareNodes(xml) {
                var elements = xml.getElementsByTagName('node');
                for (var i = 0; i < elements.length; i++) {
                    var element = elements[i];
                    if (element.hasAttribute('id') === false) {
                        element.setAttribute('id', generateId());
                    }
                }
            }
            var matrix = new THREE.Matrix4();
            var vector = new THREE.Vector3();
            function parseNode(xml) {
                var data = {
                    name: xml.getAttribute('name') || '',
                    type: xml.getAttribute('type'),
                    id: xml.getAttribute('id'),
                    sid: xml.getAttribute('sid'),
                    matrix: new THREE.Matrix4(),
                    nodes: [],
                    instanceCameras: [],
                    instanceControllers: [],
                    instanceLights: [],
                    instanceGeometries: [],
                    instanceNodes: [],
                    transforms: {}
                };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    if (child.nodeType !== 1)
                        continue;
                    switch (child.nodeName) {
                    case 'node':
                        data.nodes.push(child.getAttribute('id'));
                        parseNode(child);
                        break;
                    case 'instance_camera':
                        data.instanceCameras.push(parseId(child.getAttribute('url')));
                        break;
                    case 'instance_controller':
                        data.instanceControllers.push(parseNodeInstance(child));
                        break;
                    case 'instance_light':
                        data.instanceLights.push(parseId(child.getAttribute('url')));
                        break;
                    case 'instance_geometry':
                        data.instanceGeometries.push(parseNodeInstance(child));
                        break;
                    case 'instance_node':
                        data.instanceNodes.push(parseId(child.getAttribute('url')));
                        break;
                    case 'matrix':
                        var array = parseFloats(child.textContent);
                        data.matrix.multiply(matrix.fromArray(array).transpose());
                        data.transforms[child.getAttribute('sid')] = child.nodeName;
                        break;
                    case 'translate':
                        var array = parseFloats(child.textContent);
                        vector.fromArray(array);
                        data.matrix.multiply(matrix.makeTranslation(vector.x, vector.y, vector.z));
                        data.transforms[child.getAttribute('sid')] = child.nodeName;
                        break;
                    case 'rotate':
                        var array = parseFloats(child.textContent);
                        var angle = THREE.MathUtils.degToRad(array[3]);
                        data.matrix.multiply(matrix.makeRotationAxis(vector.fromArray(array), angle));
                        data.transforms[child.getAttribute('sid')] = child.nodeName;
                        break;
                    case 'scale':
                        var array = parseFloats(child.textContent);
                        data.matrix.scale(vector.fromArray(array));
                        data.transforms[child.getAttribute('sid')] = child.nodeName;
                        break;
                    case 'extra':
                        break;
                    default:
                        console.log(child);
                    }
                }
                if (hasNode(data.id)) {
                    console.warn('THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.', data.id);
                } else {
                    library.nodes[data.id] = data;
                }
                return data;
            }
            function parseNodeInstance(xml) {
                var data = {
                    id: parseId(xml.getAttribute('url')),
                    materials: {},
                    skeletons: []
                };
                for (var i = 0; i < xml.childNodes.length; i++) {
                    var child = xml.childNodes[i];
                    switch (child.nodeName) {
                    case 'bind_material':
                        var instances = child.getElementsByTagName('instance_material');
                        for (var j = 0; j < instances.length; j++) {
                            var instance = instances[j];
                            var symbol = instance.getAttribute('symbol');
                            var target = instance.getAttribute('target');
                            data.materials[symbol] = parseId(target);
                        }
                        break;
                    case 'skeleton':
                        data.skeletons.push(parseId(child.textContent));
                        break;
                    default:
                        break;
                    }
                }
                return data;
            }
            function buildSkeleton(skeletons, joints) {
                var boneData = [];
                var sortedBoneData = [];
                var i, j, data;
                for (i = 0; i < skeletons.length; i++) {
                    var skeleton = skeletons[i];
                    var root;
                    if (hasNode(skeleton)) {
                        root = getNode(skeleton);
                        buildBoneHierarchy(root, joints, boneData);
                    } else if (hasVisualScene(skeleton)) {
                        var visualScene = library.visualScenes[skeleton];
                        var children = visualScene.children;
                        for (var j = 0; j < children.length; j++) {
                            var child = children[j];
                            if (child.type === 'JOINT') {
                                var root = getNode(child.id);
                                buildBoneHierarchy(root, joints, boneData);
                            }
                        }
                    } else {
                        console.error('THREE.ColladaLoader: Unable to find root bone of skeleton with ID:', skeleton);
                    }
                }
                for (i = 0; i < joints.length; i++) {
                    for (j = 0; j < boneData.length; j++) {
                        data = boneData[j];
                        if (data.bone.name === joints[i].name) {
                            sortedBoneData[i] = data;
                            data.processed = true;
                            break;
                        }
                    }
                }
                for (i = 0; i < boneData.length; i++) {
                    data = boneData[i];
                    if (data.processed === false) {
                        sortedBoneData.push(data);
                        data.processed = true;
                    }
                }
                var bones = [];
                var boneInverses = [];
                for (i = 0; i < sortedBoneData.length; i++) {
                    data = sortedBoneData[i];
                    bones.push(data.bone);
                    boneInverses.push(data.boneInverse);
                }
                return new THREE.Skeleton(bones, boneInverses);
            }
            function buildBoneHierarchy(root, joints, boneData) {
                root.traverse(function (object) {
                    if (object.isBone === true) {
                        var boneInverse;
                        for (var i = 0; i < joints.length; i++) {
                            var joint = joints[i];
                            if (joint.name === object.name) {
                                boneInverse = joint.boneInverse;
                                break;
                            }
                        }
                        if (boneInverse === undefined) {
                            boneInverse = new THREE.Matrix4();
                        }
                        boneData.push({
                            bone: object,
                            boneInverse: boneInverse,
                            processed: false
                        });
                    }
                });
            }
            function buildNode(data) {
                var objects = [];
                var matrix = data.matrix;
                var nodes = data.nodes;
                var type = data.type;
                var instanceCameras = data.instanceCameras;
                var instanceControllers = data.instanceControllers;
                var instanceLights = data.instanceLights;
                var instanceGeometries = data.instanceGeometries;
                var instanceNodes = data.instanceNodes;
                for (var i = 0, l = nodes.length; i < l; i++) {
                    objects.push(getNode(nodes[i]));
                }
                for (var i = 0, l = instanceCameras.length; i < l; i++) {
                    var instanceCamera = getCamera(instanceCameras[i]);
                    if (instanceCamera !== null) {
                        objects.push(instanceCamera.clone());
                    }
                }
                for (var i = 0, l = instanceControllers.length; i < l; i++) {
                    var instance = instanceControllers[i];
                    var controller = getController(instance.id);
                    var geometries = getGeometry(controller.id);
                    var newObjects = buildObjects(geometries, instance.materials);
                    var skeletons = instance.skeletons;
                    var joints = controller.skin.joints;
                    var skeleton = buildSkeleton(skeletons, joints);
                    for (var j = 0, jl = newObjects.length; j < jl; j++) {
                        var object = newObjects[j];
                        if (object.isSkinnedMesh) {
                            object.bind(skeleton, controller.skin.bindMatrix);
                            object.normalizeSkinWeights();
                        }
                        objects.push(object);
                    }
                }
                for (var i = 0, l = instanceLights.length; i < l; i++) {
                    var instanceLight = getLight(instanceLights[i]);
                    if (instanceLight !== null) {
                        objects.push(instanceLight.clone());
                    }
                }
                for (var i = 0, l = instanceGeometries.length; i < l; i++) {
                    var instance = instanceGeometries[i];
                    var geometries = getGeometry(instance.id);
                    var newObjects = buildObjects(geometries, instance.materials);
                    for (var j = 0, jl = newObjects.length; j < jl; j++) {
                        objects.push(newObjects[j]);
                    }
                }
                for (var i = 0, l = instanceNodes.length; i < l; i++) {
                    objects.push(getNode(instanceNodes[i]).clone());
                }
                var object;
                if (nodes.length === 0 && objects.length === 1) {
                    object = objects[0];
                } else {
                    object = type === 'JOINT' ? new THREE.Bone() : new THREE.Group();
                    for (var i = 0; i < objects.length; i++) {
                        object.add(objects[i]);
                    }
                }
                if (object.name === '') {
                    object.name = type === 'JOINT' ? data.sid : data.name;
                }
                object.matrix.copy(matrix);
                object.matrix.decompose(object.position, object.quaternion, object.scale);
                return object;
            }
            var fallbackMaterial = new THREE.MeshBasicMaterial({ color: 16711935 });
            function resolveMaterialBinding(keys, instanceMaterials) {
                var materials = [];
                for (var i = 0, l = keys.length; i < l; i++) {
                    var id = instanceMaterials[keys[i]];
                    if (id === undefined) {
                        console.warn('THREE.ColladaLoader: Material with key %s not found. Apply fallback material.', keys[i]);
                        materials.push(fallbackMaterial);
                    } else {
                        materials.push(getMaterial(id));
                    }
                }
                return materials;
            }
            function buildObjects(geometries, instanceMaterials) {
                var objects = [];
                for (var type in geometries) {
                    var geometry = geometries[type];
                    var materials = resolveMaterialBinding(geometry.materialKeys, instanceMaterials);
                    if (materials.length === 0) {
                        if (type === 'lines' || type === 'linestrips') {
                            materials.push(new THREE.LineBasicMaterial());
                        } else {
                            materials.push(new THREE.MeshPhongMaterial());
                        }
                    }
                    var skinning = geometry.data.attributes.skinIndex !== undefined;
                    if (skinning) {
                        for (var i = 0, l = materials.length; i < l; i++) {
                            materials[i].skinning = true;
                        }
                    }
                    var material = materials.length === 1 ? materials[0] : materials;
                    var object;
                    switch (type) {
                    case 'lines':
                        object = new THREE.LineSegments(geometry.data, material);
                        break;
                    case 'linestrips':
                        object = new THREE.Line(geometry.data, material);
                        break;
                    case 'triangles':
                    case 'polylist':
                        if (skinning) {
                            object = new THREE.SkinnedMesh(geometry.data, material);
                        } else {
                            object = new THREE.Mesh(geometry.data, material);
                        }
                        break;
                    }
                    objects.push(object);
                }
                return objects;
            }
            function hasNode(id) {
                return library.nodes[id] !== undefined;
            }
            function getNode(id) {
                return getBuild(library.nodes[id], buildNode);
            }
            function parseVisualScene(xml) {
                var data = {
                    name: xml.getAttribute('name'),
                    children: []
                };
                prepareNodes(xml);
                var elements = getElementsByTagName(xml, 'node');
                for (var i = 0; i < elements.length; i++) {
                    data.children.push(parseNode(elements[i]));
                }
                library.visualScenes[xml.getAttribute('id')] = data;
            }
            function buildVisualScene(data) {
                var group = new THREE.Group();
                group.name = data.name;
                var children = data.children;
                for (var i = 0; i < children.length; i++) {
                    var child = children[i];
                    group.add(getNode(child.id));
                }
                return group;
            }
            function hasVisualScene(id) {
                return library.visualScenes[id] !== undefined;
            }
            function getVisualScene(id) {
                return getBuild(library.visualScenes[id], buildVisualScene);
            }
            function parseScene(xml) {
                var instance = getElementsByTagName(xml, 'instance_visual_scene')[0];
                return getVisualScene(parseId(instance.getAttribute('url')));
            }
            function setupAnimations() {
                var clips = library.clips;
                if (isEmpty(clips) === true) {
                    if (isEmpty(library.animations) === false) {
                        var tracks = [];
                        for (var id in library.animations) {
                            var animationTracks = getAnimation(id);
                            for (var i = 0, l = animationTracks.length; i < l; i++) {
                                tracks.push(animationTracks[i]);
                            }
                        }
                        animations.push(new THREE.AnimationClip('default', -1, tracks));
                    }
                } else {
                    for (var id in clips) {
                        animations.push(getAnimationClip(id));
                    }
                }
            }
            function parserErrorToText(parserError) {
                var result = '';
                var stack = [parserError];
                while (stack.length) {
                    var node = stack.shift();
                    if (node.nodeType === Node.TEXT_NODE) {
                        result += node.textContent;
                    } else {
                        result += '\n';
                        stack.push.apply(stack, node.childNodes);
                    }
                }
                return result.trim();
            }
            if (text.length === 0) {
                return { scene: new THREE.Scene() };
            }
            var xml = new DOMParser().parseFromString(text, 'application/xml');
            var collada = getElementsByTagName(xml, 'COLLADA')[0];
            var parserError = xml.getElementsByTagName('parsererror')[0];
            if (parserError !== undefined) {
                var errorElement = getElementsByTagName(parserError, 'div')[0];
                var errorText;
                if (errorElement) {
                    errorText = errorElement.textContent;
                } else {
                    errorText = parserErrorToText(parserError);
                }
                console.error('THREE.ColladaLoader: Failed to parse collada file.\n', errorText);
                return null;
            }
            var version = collada.getAttribute('version');
            console.log('THREE.ColladaLoader: File version', version);
            var asset = parseAsset(getElementsByTagName(collada, 'asset')[0]);
            var textureLoader = new THREE.TextureLoader(this.manager);
            textureLoader.setPath(this.resourcePath || path).setCrossOrigin(this.crossOrigin);
            var tgaLoader;
            if (TGALoader) {
                tgaLoader = new TGALoader(this.manager);
                tgaLoader.setPath(this.resourcePath || path);
            }
            var animations = [];
            var kinematics = {};
            var count = 0;
            var library = {
                animations: {},
                clips: {},
                controllers: {},
                images: {},
                effects: {},
                materials: {},
                cameras: {},
                lights: {},
                geometries: {},
                nodes: {},
                visualScenes: {},
                kinematicsModels: {},
                physicsModels: {},
                kinematicsScenes: {}
            };
            parseLibrary(collada, 'library_animations', 'animation', parseAnimation);
            parseLibrary(collada, 'library_animation_clips', 'animation_clip', parseAnimationClip);
            parseLibrary(collada, 'library_controllers', 'controller', parseController);
            parseLibrary(collada, 'library_images', 'image', parseImage);
            parseLibrary(collada, 'library_effects', 'effect', parseEffect);
            parseLibrary(collada, 'library_materials', 'material', parseMaterial);
            parseLibrary(collada, 'library_cameras', 'camera', parseCamera);
            parseLibrary(collada, 'library_lights', 'light', parseLight);
            parseLibrary(collada, 'library_geometries', 'geometry', parseGeometry);
            parseLibrary(collada, 'library_nodes', 'node', parseNode);
            parseLibrary(collada, 'library_visual_scenes', 'visual_scene', parseVisualScene);
            parseLibrary(collada, 'library_kinematics_models', 'kinematics_model', parseKinematicsModel);
            parseLibrary(collada, 'library_physics_models', 'physics_model', parsePhysicsModel);
            parseLibrary(collada, 'scene', 'instance_kinematics_scene', parseKinematicsScene);
            buildLibrary(library.animations, buildAnimation);
            buildLibrary(library.clips, buildAnimationClip);
            buildLibrary(library.controllers, buildController);
            buildLibrary(library.images, buildImage);
            buildLibrary(library.effects, buildEffect);
            buildLibrary(library.materials, buildMaterial);
            buildLibrary(library.cameras, buildCamera);
            buildLibrary(library.lights, buildLight);
            buildLibrary(library.geometries, buildGeometry);
            buildLibrary(library.visualScenes, buildVisualScene);
            setupAnimations();
            setupKinematics();
            var scene = parseScene(getElementsByTagName(collada, 'scene')[0]);
            if (asset.upAxis === 'Z_UP') {
                scene.quaternion.setFromEuler(new THREE.Euler(-Math.PI / 2, 0, 0));
            }
            scene.scale.multiplyScalar(asset.unit);
            return {
                animations: animations,
                kinematics: kinematics,
                library: library,
                scene: scene
            };
        }
    });

    return threex.loaders.ColladaLoader = ColladaLoader;
});
define('skylark-threejs-ex/loaders/DRACOLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var DRACOLoader = function (manager) {
        THREE.Loader.call(this, manager);
        this.decoderPath = '';
        this.decoderConfig = {};
        this.decoderBinary = null;
        this.decoderPending = null;
        this.workerLimit = 4;
        this.workerPool = [];
        this.workerNextTaskID = 1;
        this.workerSourceURL = '';
        this.defaultAttributeIDs = {
            position: 'POSITION',
            normal: 'NORMAL',
            color: 'COLOR',
            uv: 'TEX_COORD'
        };
        this.defaultAttributeTypes = {
            position: 'Float32Array',
            normal: 'Float32Array',
            color: 'Float32Array',
            uv: 'Float32Array'
        };
    };
    DRACOLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: DRACOLoader,
        setDecoderPath: function (path) {
            this.decoderPath = path;
            return this;
        },
        setDecoderConfig: function (config) {
            this.decoderConfig = config;
            return this;
        },
        setWorkerLimit: function (workerLimit) {
            this.workerLimit = workerLimit;
            return this;
        },
        setVerbosity: function () {
            console.warn('THREE.DRACOLoader: The .setVerbosity() method has been removed.');
        },
        setDrawMode: function () {
            console.warn('THREE.DRACOLoader: The .setDrawMode() method has been removed.');
        },
        setSkipDequantization: function () {
            console.warn('THREE.DRACOLoader: The .setSkipDequantization() method has been removed.');
        },
        load: function (url, onLoad, onProgress, onError) {
            var loader = new THREE.FileLoader(this.manager);
            loader.setPath(this.path);
            loader.setResponseType('arraybuffer');
            if (this.crossOrigin === 'use-credentials') {
                loader.setWithCredentials(true);
            }
            loader.load(url, buffer => {
                var taskConfig = {
                    attributeIDs: this.defaultAttributeIDs,
                    attributeTypes: this.defaultAttributeTypes,
                    useUniqueIDs: false
                };
                this.decodeGeometry(buffer, taskConfig).then(onLoad).catch(onError);
            }, onProgress, onError);
        },
        decodeDracoFile: function (buffer, callback, attributeIDs, attributeTypes) {
            var taskConfig = {
                attributeIDs: attributeIDs || this.defaultAttributeIDs,
                attributeTypes: attributeTypes || this.defaultAttributeTypes,
                useUniqueIDs: !!attributeIDs
            };
            this.decodeGeometry(buffer, taskConfig).then(callback);
        },
        decodeGeometry: function (buffer, taskConfig) {
            for (var attribute in taskConfig.attributeTypes) {
                var type = taskConfig.attributeTypes[attribute];
                if (type.BYTES_PER_ELEMENT !== undefined) {
                    taskConfig.attributeTypes[attribute] = type.name;
                }
            }
            var taskKey = JSON.stringify(taskConfig);
            if (DRACOLoader.taskCache.has(buffer)) {
                var cachedTask = DRACOLoader.taskCache.get(buffer);
                if (cachedTask.key === taskKey) {
                    return cachedTask.promise;
                } else if (buffer.byteLength === 0) {
                    throw new Error('THREE.DRACOLoader: Unable to re-decode a buffer with different ' + 'settings. Buffer has already been transferred.');
                }
            }
            var worker;
            var taskID = this.workerNextTaskID++;
            var taskCost = buffer.byteLength;
            var geometryPending = this._getWorker(taskID, taskCost).then(_worker => {
                worker = _worker;
                return new Promise((resolve, reject) => {
                    worker._callbacks[taskID] = {
                        resolve,
                        reject
                    };
                    worker.postMessage({
                        type: 'decode',
                        id: taskID,
                        taskConfig,
                        buffer
                    }, [buffer]);
                });
            }).then(message => this._createGeometry(message.geometry));
            geometryPending.finally(() => {
                if (worker && taskID) {
                    this._releaseTask(worker, taskID);
                }
            });
            DRACOLoader.taskCache.set(buffer, {
                key: taskKey,
                promise: geometryPending
            });
            return geometryPending;
        },
        _createGeometry: function (geometryData) {
            var geometry = new THREE.BufferGeometry();
            if (geometryData.index) {
                geometry.setIndex(new THREE.BufferAttribute(geometryData.index.array, 1));
            }
            for (var i = 0; i < geometryData.attributes.length; i++) {
                var attribute = geometryData.attributes[i];
                var name = attribute.name;
                var array = attribute.array;
                var itemSize = attribute.itemSize;
                geometry.setAttribute(name, new THREE.BufferAttribute(array, itemSize));
            }
            return geometry;
        },
        _loadLibrary: function (url, responseType) {
            var loader = new THREE.FileLoader(this.manager);
            loader.setPath(this.decoderPath);
            loader.setResponseType(responseType);
            return new Promise((resolve, reject) => {
                loader.load(url, resolve, undefined, reject);
            });
        },
        preload: function () {
            this._initDecoder();
            return this;
        },
        _initDecoder: function () {
            if (this.decoderPending)
                return this.decoderPending;
            var useJS = typeof WebAssembly !== 'object' || this.decoderConfig.type === 'js';
            var librariesPending = [];
            if (useJS) {
                librariesPending.push(this._loadLibrary('draco_decoder', 'text'));
            } else {
                librariesPending.push(this._loadLibrary('draco_wasm_wrapper', 'text'));
                librariesPending.push(this._loadLibrary('draco_decoder.wasm', 'arraybuffer'));
            }
            this.decoderPending = Promise.all(librariesPending).then(libraries => {
                var jsContent = libraries[0];
                if (!useJS) {
                    this.decoderConfig.wasmBinary = libraries[1];
                }
                var fn = DRACOLoader.DRACOWorker.toString();
                var body = [
                    '/* draco decoder */',
                    jsContent,
                    '',
                    '/* worker */',
                    fn.substring(fn.indexOf('{') + 1, fn.lastIndexOf('}'))
                ].join('\n');
                this.workerSourceURL = URL.createObjectURL(new Blob([body]));
            });
            return this.decoderPending;
        },
        _getWorker: function (taskID, taskCost) {
            return this._initDecoder().then(() => {
                if (this.workerPool.length < this.workerLimit) {
                    var worker = new Worker(this.workerSourceURL);
                    worker._callbacks = {};
                    worker._taskCosts = {};
                    worker._taskLoad = 0;
                    worker.postMessage({
                        type: 'init',
                        decoderConfig: this.decoderConfig
                    });
                    worker.onmessage = function (e) {
                        var message = e.data;
                        switch (message.type) {
                        case 'decode':
                            worker._callbacks[message.id].resolve(message);
                            break;
                        case 'error':
                            worker._callbacks[message.id].reject(message);
                            break;
                        default:
                            console.error('THREE.DRACOLoader: Unexpected message, "' + message.type + '"');
                        }
                    };
                    this.workerPool.push(worker);
                } else {
                    this.workerPool.sort(function (a, b) {
                        return a._taskLoad > b._taskLoad ? -1 : 1;
                    });
                }
                var worker = this.workerPool[this.workerPool.length - 1];
                worker._taskCosts[taskID] = taskCost;
                worker._taskLoad += taskCost;
                return worker;
            });
        },
        _releaseTask: function (worker, taskID) {
            worker._taskLoad -= worker._taskCosts[taskID];
            delete worker._callbacks[taskID];
            delete worker._taskCosts[taskID];
        },
        debug: function () {
            console.log('Task load: ', this.workerPool.map(worker => worker._taskLoad));
        },
        dispose: function () {
            for (var i = 0; i < this.workerPool.length; ++i) {
                this.workerPool[i].terminate();
            }
            this.workerPool.length = 0;
            return this;
        }
    });
    DRACOLoader.DRACOWorker = function () {
        var decoderConfig;
        var decoderPending;
        onmessage = function (e) {
            var message = e.data;
            switch (message.type) {
            case 'init':
                decoderConfig = message.decoderConfig;
                decoderPending = new Promise(function (resolve) {
                    decoderConfig.onModuleLoaded = function (draco) {
                        resolve({ draco: draco });
                    };
                    DracoDecoderModule(decoderConfig);
                });
                break;
            case 'decode':
                var buffer = message.buffer;
                var taskConfig = message.taskConfig;
                decoderPending.then(module => {
                    var draco = module.draco;
                    var decoder = new draco.Decoder();
                    var decoderBuffer = new draco.DecoderBuffer();
                    decoderBuffer.Init(new Int8Array(buffer), buffer.byteLength);
                    try {
                        var geometry = decodeGeometry(draco, decoder, decoderBuffer, taskConfig);
                        var buffers = geometry.attributes.map(attr => attr.array.buffer);
                        if (geometry.index)
                            buffers.push(geometry.index.array.buffer);
                        self.postMessage({
                            type: 'decode',
                            id: message.id,
                            geometry
                        }, buffers);
                    } catch (error) {
                        console.error(error);
                        self.postMessage({
                            type: 'error',
                            id: message.id,
                            error: error.message
                        });
                    } finally {
                        draco.destroy(decoderBuffer);
                        draco.destroy(decoder);
                    }
                });
                break;
            }
        };
        function decodeGeometry(draco, decoder, decoderBuffer, taskConfig) {
            var attributeIDs = taskConfig.attributeIDs;
            var attributeTypes = taskConfig.attributeTypes;
            var dracoGeometry;
            var decodingStatus;
            var geometryType = decoder.GetEncodedGeometryType(decoderBuffer);
            if (geometryType === draco.TRIANGULAR_MESH) {
                dracoGeometry = new draco.Mesh();
                decodingStatus = decoder.DecodeBufferToMesh(decoderBuffer, dracoGeometry);
            } else if (geometryType === draco.POINT_CLOUD) {
                dracoGeometry = new draco.PointCloud();
                decodingStatus = decoder.DecodeBufferToPointCloud(decoderBuffer, dracoGeometry);
            } else {
                throw new Error('THREE.DRACOLoader: Unexpected geometry type.');
            }
            if (!decodingStatus.ok() || dracoGeometry.ptr === 0) {
                throw new Error('THREE.DRACOLoader: Decoding failed: ' + decodingStatus.error_msg());
            }
            var geometry = {
                index: null,
                attributes: []
            };
            for (var attributeName in attributeIDs) {
                var attributeType = self[attributeTypes[attributeName]];
                var attribute;
                var attributeID;
                if (taskConfig.useUniqueIDs) {
                    attributeID = attributeIDs[attributeName];
                    attribute = decoder.GetAttributeByUniqueId(dracoGeometry, attributeID);
                } else {
                    attributeID = decoder.GetAttributeId(dracoGeometry, draco[attributeIDs[attributeName]]);
                    if (attributeID === -1)
                        continue;
                    attribute = decoder.GetAttribute(dracoGeometry, attributeID);
                }
                geometry.attributes.push(decodeAttribute(draco, decoder, dracoGeometry, attributeName, attributeType, attribute));
            }
            if (geometryType === draco.TRIANGULAR_MESH) {
                var numFaces = dracoGeometry.num_faces();
                var numIndices = numFaces * 3;
                var index = new Uint32Array(numIndices);
                var indexArray = new draco.DracoInt32Array();
                for (var i = 0; i < numFaces; ++i) {
                    decoder.GetFaceFromMesh(dracoGeometry, i, indexArray);
                    for (var j = 0; j < 3; ++j) {
                        index[i * 3 + j] = indexArray.GetValue(j);
                    }
                }
                geometry.index = {
                    array: index,
                    itemSize: 1
                };
                draco.destroy(indexArray);
            }
            draco.destroy(dracoGeometry);
            return geometry;
        }
        function decodeAttribute(draco, decoder, dracoGeometry, attributeName, attributeType, attribute) {
            var numComponents = attribute.num_components();
            var numPoints = dracoGeometry.num_points();
            var numValues = numPoints * numComponents;
            var dracoArray;
            var array;
            switch (attributeType) {
            case Float32Array:
                dracoArray = new draco.DracoFloat32Array();
                decoder.GetAttributeFloatForAllPoints(dracoGeometry, attribute, dracoArray);
                array = new Float32Array(numValues);
                break;
            case Int8Array:
                dracoArray = new draco.DracoInt8Array();
                decoder.GetAttributeInt8ForAllPoints(dracoGeometry, attribute, dracoArray);
                array = new Int8Array(numValues);
                break;
            case Int16Array:
                dracoArray = new draco.DracoInt16Array();
                decoder.GetAttributeInt16ForAllPoints(dracoGeometry, attribute, dracoArray);
                array = new Int16Array(numValues);
                break;
            case Int32Array:
                dracoArray = new draco.DracoInt32Array();
                decoder.GetAttributeInt32ForAllPoints(dracoGeometry, attribute, dracoArray);
                array = new Int32Array(numValues);
                break;
            case Uint8Array:
                dracoArray = new draco.DracoUInt8Array();
                decoder.GetAttributeUInt8ForAllPoints(dracoGeometry, attribute, dracoArray);
                array = new Uint8Array(numValues);
                break;
            case Uint16Array:
                dracoArray = new draco.DracoUInt16Array();
                decoder.GetAttributeUInt16ForAllPoints(dracoGeometry, attribute, dracoArray);
                array = new Uint16Array(numValues);
                break;
            case Uint32Array:
                dracoArray = new draco.DracoUInt32Array();
                decoder.GetAttributeUInt32ForAllPoints(dracoGeometry, attribute, dracoArray);
                array = new Uint32Array(numValues);
                break;
            default:
                throw new Error('THREE.DRACOLoader: Unexpected attribute type.');
            }
            for (var i = 0; i < numValues; i++) {
                array[i] = dracoArray.GetValue(i);
            }
            draco.destroy(dracoArray);
            return {
                name: attributeName,
                array: array,
                itemSize: numComponents
            };
        }
    };
    DRACOLoader.taskCache = new WeakMap();
    DRACOLoader.setDecoderPath = function () {
        console.warn('THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.');
    };
    DRACOLoader.setDecoderConfig = function () {
        console.warn('THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.');
    };
    DRACOLoader.releaseDecoderModule = function () {
        console.warn('THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.');
    };
    DRACOLoader.getDecoderModule = function () {
        console.warn('THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.');
    };

    return threex.loaders.DRACOLoader = DRACOLoader;
});
define('skylark-threejs-ex/loaders/FBXLoader',[
    "skylark-threejs",
    "../threex",
    'skylark-zlib/Inflate',
    '../curves/NURBSCurve'
], function (
    THREE, 
    threex,
    Inflate, 
    NURBSCurve
) {
    'use strict';
    var FBXLoader = function () {
        var fbxTree;
        var connections;
        var sceneGraph;
        function FBXLoader(manager) {
            THREE.Loader.call(this, manager);
        }
        FBXLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
            constructor: FBXLoader,
            load: function (url, onLoad, onProgress, onError) {
                var self = this;
                var path = self.path === '' ? THREE.LoaderUtils.extractUrlBase(url) : self.path;
                var loader = new THREE.FileLoader(this.manager);
                loader.setPath(self.path);
                loader.setResponseType('arraybuffer');
                loader.load(url, function (buffer) {
                    try {
                        onLoad(self.parse(buffer, path));
                    } catch (error) {
                        setTimeout(function () {
                            if (onError)
                                onError(error);
                            self.manager.itemError(url);
                        }, 0);
                    }
                }, onProgress, onError);
            },
            parse: function (FBXBuffer, path) {
                if (isFbxFormatBinary(FBXBuffer)) {
                    fbxTree = new BinaryParser().parse(FBXBuffer);
                } else {
                    var FBXText = convertArrayBufferToString(FBXBuffer);
                    if (!isFbxFormatASCII(FBXText)) {
                        throw new Error('THREE.FBXLoader: Unknown format.');
                    }
                    if (getFbxVersion(FBXText) < 7000) {
                        throw new Error('THREE.FBXLoader: FBX version not supported, FileVersion: ' + getFbxVersion(FBXText));
                    }
                    fbxTree = new TextParser().parse(FBXText);
                }
                var textureLoader = new THREE.TextureLoader(this.manager).setPath(this.resourcePath || path).setCrossOrigin(this.crossOrigin);
                return new FBXTreeParser(textureLoader, this.manager).parse(fbxTree);
            }
        });
        function FBXTreeParser(textureLoader, manager) {
            this.textureLoader = textureLoader;
            this.manager = manager;
        }
        FBXTreeParser.prototype = {
            constructor: FBXTreeParser,
            parse: function () {
                connections = this.parseConnections();
                var images = this.parseImages();
                var textures = this.parseTextures(images);
                var materials = this.parseMaterials(textures);
                var deformers = this.parseDeformers();
                var geometryMap = new GeometryParser().parse(deformers);
                this.parseScene(deformers, geometryMap, materials);
                return sceneGraph;
            },
            parseConnections: function () {
                var connectionMap = new Map();
                if ('Connections' in fbxTree) {
                    var rawConnections = fbxTree.Connections.connections;
                    rawConnections.forEach(function (rawConnection) {
                        var fromID = rawConnection[0];
                        var toID = rawConnection[1];
                        var relationship = rawConnection[2];
                        if (!connectionMap.has(fromID)) {
                            connectionMap.set(fromID, {
                                parents: [],
                                children: []
                            });
                        }
                        var parentRelationship = {
                            ID: toID,
                            relationship: relationship
                        };
                        connectionMap.get(fromID).parents.push(parentRelationship);
                        if (!connectionMap.has(toID)) {
                            connectionMap.set(toID, {
                                parents: [],
                                children: []
                            });
                        }
                        var childRelationship = {
                            ID: fromID,
                            relationship: relationship
                        };
                        connectionMap.get(toID).children.push(childRelationship);
                    });
                }
                return connectionMap;
            },
            parseImages: function () {
                var images = {};
                var blobs = {};
                if ('Video' in fbxTree.Objects) {
                    var videoNodes = fbxTree.Objects.Video;
                    for (var nodeID in videoNodes) {
                        var videoNode = videoNodes[nodeID];
                        var id = parseInt(nodeID);
                        images[id] = videoNode.RelativeFilename || videoNode.Filename;
                        if ('Content' in videoNode) {
                            var arrayBufferContent = videoNode.Content instanceof ArrayBuffer && videoNode.Content.byteLength > 0;
                            var base64Content = typeof videoNode.Content === 'string' && videoNode.Content !== '';
                            if (arrayBufferContent || base64Content) {
                                var image = this.parseImage(videoNodes[nodeID]);
                                blobs[videoNode.RelativeFilename || videoNode.Filename] = image;
                            }
                        }
                    }
                }
                for (var id in images) {
                    var filename = images[id];
                    if (blobs[filename] !== undefined)
                        images[id] = blobs[filename];
                    else
                        images[id] = images[id].split('\\').pop();
                }
                return images;
            },
            parseImage: function (videoNode) {
                var content = videoNode.Content;
                var fileName = videoNode.RelativeFilename || videoNode.Filename;
                var extension = fileName.slice(fileName.lastIndexOf('.') + 1).toLowerCase();
                var type;
                switch (extension) {
                case 'bmp':
                    type = 'image/bmp';
                    break;
                case 'jpg':
                case 'jpeg':
                    type = 'image/jpeg';
                    break;
                case 'png':
                    type = 'image/png';
                    break;
                case 'tif':
                    type = 'image/tiff';
                    break;
                case 'tga':
                    if (this.manager.getHandler('.tga') === null) {
                        console.warn('FBXLoader: TGA loader not found, skipping ', fileName);
                    }
                    type = 'image/tga';
                    break;
                default:
                    console.warn('FBXLoader: Image type "' + extension + '" is not supported.');
                    return;
                }
                if (typeof content === 'string') {
                    return 'data:' + type + ';base64,' + content;
                } else {
                    var array = new Uint8Array(content);
                    return window.URL.createObjectURL(new Blob([array], { type: type }));
                }
            },
            parseTextures: function (images) {
                var textureMap = new Map();
                if ('Texture' in fbxTree.Objects) {
                    var textureNodes = fbxTree.Objects.undefined;
                    for (var nodeID in textureNodes) {
                        var texture = this.parseTexture(textureNodes[nodeID], images);
                        textureMap.set(parseInt(nodeID), texture);
                    }
                }
                return textureMap;
            },
            parseTexture: function (textureNode, images) {
                var texture = this.loadTexture(textureNode, images);
                texture.ID = textureNode.id;
                texture.name = textureNode.attrName;
                var wrapModeU = textureNode.WrapModeU;
                var wrapModeV = textureNode.WrapModeV;
                var valueU = wrapModeU !== undefined ? wrapModeU.value : 0;
                var valueV = wrapModeV !== undefined ? wrapModeV.value : 0;
                texture.wrapS = valueU === 0 ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;
                texture.wrapT = valueV === 0 ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;
                if ('Scaling' in textureNode) {
                    var values = textureNode.Scaling.value;
                    texture.repeat.x = values[0];
                    texture.repeat.y = values[1];
                }
                return texture;
            },
            loadTexture: function (textureNode, images) {
                var fileName;
                var currentPath = this.textureLoader.path;
                var children = connections.get(textureNode.id).children;
                if (children !== undefined && children.length > 0 && images[children[0].ID] !== undefined) {
                    fileName = images[children[0].ID];
                    if (fileName.indexOf('blob:') === 0 || fileName.indexOf('data:') === 0) {
                        this.textureLoader.setPath(undefined);
                    }
                }
                var texture;
                var extension = textureNode.FileName.slice(-3).toLowerCase();
                if (extension === 'tga') {
                    var loader = this.manager.getHandler('.tga');
                    if (loader === null) {
                        console.warn('FBXLoader: TGA loader not found, creating placeholder texture for', textureNode.RelativeFilename);
                        texture = new THREE.Texture();
                    } else {
                        texture = loader.load(fileName);
                    }
                } else if (extension === 'psd') {
                    console.warn('FBXLoader: PSD textures are not supported, creating placeholder texture for', textureNode.RelativeFilename);
                    texture = new THREE.Texture();
                } else {
                    texture = this.textureLoader.load(fileName);
                }
                this.textureLoader.setPath(currentPath);
                return texture;
            },
            parseMaterials: function (textureMap) {
                var materialMap = new Map();
                if ('Material' in fbxTree.Objects) {
                    var materialNodes = fbxTree.Objects.Material;
                    for (var nodeID in materialNodes) {
                        var material = this.parseMaterial(materialNodes[nodeID], textureMap);
                        if (material !== null)
                            materialMap.set(parseInt(nodeID), material);
                    }
                }
                return materialMap;
            },
            parseMaterial: function (materialNode, textureMap) {
                var ID = materialNode.id;
                var name = materialNode.attrName;
                var type = materialNode.ShadingModel;
                if (typeof type === 'object') {
                    type = type.value;
                }
                if (!connections.has(ID))
                    return null;
                var parameters = this.parseParameters(materialNode, textureMap, ID);
                var material;
                switch (type.toLowerCase()) {
                case 'phong':
                    material = new THREE.MeshPhongMaterial();
                    break;
                case 'lambert':
                    material = new THREE.MeshLambertMaterial();
                    break;
                default:
                    console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.', type);
                    material = new THREE.MeshPhongMaterial();
                    break;
                }
                material.setValues(parameters);
                material.name = name;
                return material;
            },
            parseParameters: function (materialNode, textureMap, ID) {
                var parameters = {};
                if (materialNode.BumpFactor) {
                    parameters.bumpScale = materialNode.BumpFactor.value;
                }
                if (materialNode.Diffuse) {
                    parameters.color = new THREE.Color().fromArray(materialNode.Diffuse.value);
                } else if (materialNode.DiffuseColor && materialNode.DiffuseColor.type === 'Color') {
                    parameters.color = new THREE.Color().fromArray(materialNode.DiffuseColor.value);
                }
                if (materialNode.DisplacementFactor) {
                    parameters.displacementScale = materialNode.DisplacementFactor.value;
                }
                if (materialNode.Emissive) {
                    parameters.emissive = new THREE.Color().fromArray(materialNode.Emissive.value);
                } else if (materialNode.EmissiveColor && materialNode.EmissiveColor.type === 'Color') {
                    parameters.emissive = new THREE.Color().fromArray(materialNode.EmissiveColor.value);
                }
                if (materialNode.EmissiveFactor) {
                    parameters.emissiveIntensity = parseFloat(materialNode.EmissiveFactor.value);
                }
                if (materialNode.Opacity) {
                    parameters.opacity = parseFloat(materialNode.Opacity.value);
                }
                if (parameters.opacity < 1) {
                    parameters.transparent = true;
                }
                if (materialNode.ReflectionFactor) {
                    parameters.reflectivity = materialNode.ReflectionFactor.value;
                }
                if (materialNode.Shininess) {
                    parameters.shininess = materialNode.Shininess.value;
                }
                if (materialNode.Specular) {
                    parameters.specular = new THREE.Color().fromArray(materialNode.Specular.value);
                } else if (materialNode.SpecularColor && materialNode.SpecularColor.type === 'Color') {
                    parameters.specular = new THREE.Color().fromArray(materialNode.SpecularColor.value);
                }
                var self = this;
                connections.get(ID).children.forEach(function (child) {
                    var type = child.relationship;
                    switch (type) {
                    case 'Bump':
                        parameters.bumpMap = self.getTexture(textureMap, child.ID);
                        break;
                    case 'Maya|TEX_ao_map':
                        parameters.aoMap = self.getTexture(textureMap, child.ID);
                        break;
                    case 'DiffuseColor':
                    case 'Maya|TEX_color_map':
                        parameters.map = self.getTexture(textureMap, child.ID);
                        parameters.map.encoding = THREE.sRGBEncoding;
                        break;
                    case 'DisplacementColor':
                        parameters.displacementMap = self.getTexture(textureMap, child.ID);
                        break;
                    case 'EmissiveColor':
                        parameters.emissiveMap = self.getTexture(textureMap, child.ID);
                        parameters.emissiveMap.encoding = THREE.sRGBEncoding;
                        break;
                    case 'NormalMap':
                    case 'Maya|TEX_normal_map':
                        parameters.normalMap = self.getTexture(textureMap, child.ID);
                        break;
                    case 'ReflectionColor':
                        parameters.envMap = self.getTexture(textureMap, child.ID);
                        parameters.envMap.mapping = THREE.EquirectangularReflectionMapping;
                        parameters.envMap.encoding = THREE.sRGBEncoding;
                        break;
                    case 'SpecularColor':
                        parameters.specularMap = self.getTexture(textureMap, child.ID);
                        parameters.specularMap.encoding = THREE.sRGBEncoding;
                        break;
                    case 'TransparentColor':
                        parameters.alphaMap = self.getTexture(textureMap, child.ID);
                        parameters.transparent = true;
                        break;
                    case 'AmbientColor':
                    case 'ShininessExponent':
                    case 'SpecularFactor':
                    case 'VectorDisplacementColor':
                    default:
                        console.warn('THREE.FBXLoader: %s map is not supported in three.js, skipping texture.', type);
                        break;
                    }
                });
                return parameters;
            },
            getTexture: function (textureMap, id) {
                if ('LayeredTexture' in fbxTree.Objects && id in fbxTree.Objects.LayeredTexture) {
                    console.warn('THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.');
                    id = connections.get(id).children[0].ID;
                }
                return textureMap.get(id);
            },
            parseDeformers: function () {
                var skeletons = {};
                var morphTargets = {};
                if ('Deformer' in fbxTree.Objects) {
                    var DeformerNodes = fbxTree.Objects.Deformer;
                    for (var nodeID in DeformerNodes) {
                        var deformerNode = DeformerNodes[nodeID];
                        var relationships = connections.get(parseInt(nodeID));
                        if (deformerNode.attrType === 'Skin') {
                            var skeleton = this.parseSkeleton(relationships, DeformerNodes);
                            skeleton.ID = nodeID;
                            if (relationships.parents.length > 1)
                                console.warn('THREE.FBXLoader: skeleton attached to more than one geometry is not supported.');
                            skeleton.geometryID = relationships.parents[0].ID;
                            skeletons[nodeID] = skeleton;
                        } else if (deformerNode.attrType === 'BlendShape') {
                            var morphTarget = { id: nodeID };
                            morphTarget.rawTargets = this.parseMorphTargets(relationships, DeformerNodes);
                            morphTarget.id = nodeID;
                            if (relationships.parents.length > 1)
                                console.warn('THREE.FBXLoader: morph target attached to more than one geometry is not supported.');
                            morphTargets[nodeID] = morphTarget;
                        }
                    }
                }
                return {
                    skeletons: skeletons,
                    morphTargets: morphTargets
                };
            },
            parseSkeleton: function (relationships, deformerNodes) {
                var rawBones = [];
                relationships.children.forEach(function (child) {
                    var boneNode = deformerNodes[child.ID];
                    if (boneNode.attrType !== 'Cluster')
                        return;
                    var rawBone = {
                        ID: child.ID,
                        indices: [],
                        weights: [],
                        transformLink: new THREE.Matrix4().fromArray(boneNode.TransformLink.a)
                    };
                    if ('Indexes' in boneNode) {
                        rawBone.indices = boneNode.Indexes.a;
                        rawBone.weights = boneNode.Weights.a;
                    }
                    rawBones.push(rawBone);
                });
                return {
                    rawBones: rawBones,
                    bones: []
                };
            },
            parseMorphTargets: function (relationships, deformerNodes) {
                var rawMorphTargets = [];
                for (var i = 0; i < relationships.children.length; i++) {
                    var child = relationships.children[i];
                    var morphTargetNode = deformerNodes[child.ID];
                    var rawMorphTarget = {
                        name: morphTargetNode.attrName,
                        initialWeight: morphTargetNode.DeformPercent,
                        id: morphTargetNode.id,
                        fullWeights: morphTargetNode.FullWeights.a
                    };
                    if (morphTargetNode.attrType !== 'BlendShapeChannel')
                        return;
                    rawMorphTarget.geoID = connections.get(parseInt(child.ID)).children.filter(function (child) {
                        return child.relationship === undefined;
                    })[0].ID;
                    rawMorphTargets.push(rawMorphTarget);
                }
                return rawMorphTargets;
            },
            parseScene: function (deformers, geometryMap, materialMap) {
                sceneGraph = new THREE.Group();
                var modelMap = this.parseModels(deformers.skeletons, geometryMap, materialMap);
                var modelNodes = fbxTree.Objects.Model;
                var self = this;
                modelMap.forEach(function (model) {
                    var modelNode = modelNodes[model.ID];
                    self.setLookAtProperties(model, modelNode);
                    var parentConnections = connections.get(model.ID).parents;
                    parentConnections.forEach(function (connection) {
                        var parent = modelMap.get(connection.ID);
                        if (parent !== undefined)
                            parent.add(model);
                    });
                    if (model.parent === null) {
                        sceneGraph.add(model);
                    }
                });
                this.bindSkeleton(deformers.skeletons, geometryMap, modelMap);
                this.createAmbientLight();
                this.setupMorphMaterials();
                sceneGraph.traverse(function (node) {
                    if (node.userData.transformData) {
                        if (node.parent)
                            node.userData.transformData.parentMatrixWorld = node.parent.matrix;
                        var transform = generateTransform(node.userData.transformData);
                        node.applyMatrix4(transform);
                    }
                });
                var animations = new AnimationParser().parse();
                if (sceneGraph.children.length === 1 && sceneGraph.children[0].isGroup) {
                    sceneGraph.children[0].animations = animations;
                    sceneGraph = sceneGraph.children[0];
                }
                sceneGraph.animations = animations;
            },
            parseModels: function (skeletons, geometryMap, materialMap) {
                var modelMap = new Map();
                var modelNodes = fbxTree.Objects.Model;
                for (var nodeID in modelNodes) {
                    var id = parseInt(nodeID);
                    var node = modelNodes[nodeID];
                    var relationships = connections.get(id);
                    var model = this.buildSkeleton(relationships, skeletons, id, node.attrName);
                    if (!model) {
                        switch (node.attrType) {
                        case 'Camera':
                            model = this.createCamera(relationships);
                            break;
                        case 'Light':
                            model = this.createLight(relationships);
                            break;
                        case 'Mesh':
                            model = this.createMesh(relationships, geometryMap, materialMap);
                            break;
                        case 'NurbsCurve':
                            model = this.createCurve(relationships, geometryMap);
                            break;
                        case 'LimbNode':
                        case 'Root':
                            model = new THREE.Bone();
                            break;
                        case 'Null':
                        default:
                            model = new THREE.Group();
                            break;
                        }
                        model.name = node.attrName ? THREE.PropertyBinding.sanitizeNodeName(node.attrName) : '';
                        model.ID = id;
                    }
                    this.getTransformData(model, node);
                    modelMap.set(id, model);
                }
                return modelMap;
            },
            buildSkeleton: function (relationships, skeletons, id, name) {
                var bone = null;
                relationships.parents.forEach(function (parent) {
                    for (var ID in skeletons) {
                        var skeleton = skeletons[ID];
                        skeleton.rawBones.forEach(function (rawBone, i) {
                            if (rawBone.ID === parent.ID) {
                                var subBone = bone;
                                bone = new THREE.Bone();
                                bone.matrixWorld.copy(rawBone.transformLink);
                                bone.name = name ? THREE.PropertyBinding.sanitizeNodeName(name) : '';
                                bone.ID = id;
                                skeleton.bones[i] = bone;
                                if (subBone !== null) {
                                    bone.add(subBone);
                                }
                            }
                        });
                    }
                });
                return bone;
            },
            createCamera: function (relationships) {
                var model;
                var cameraAttribute;
                relationships.children.forEach(function (child) {
                    var attr = fbxTree.Objects.NodeAttribute[child.ID];
                    if (attr !== undefined) {
                        cameraAttribute = attr;
                    }
                });
                if (cameraAttribute === undefined) {
                    model = new THREE.Object3D();
                } else {
                    var type = 0;
                    if (cameraAttribute.CameraProjectionType !== undefined && cameraAttribute.CameraProjectionType.value === 1) {
                        type = 1;
                    }
                    var nearClippingPlane = 1;
                    if (cameraAttribute.NearPlane !== undefined) {
                        nearClippingPlane = cameraAttribute.NearPlane.value / 1000;
                    }
                    var farClippingPlane = 1000;
                    if (cameraAttribute.FarPlane !== undefined) {
                        farClippingPlane = cameraAttribute.FarPlane.value / 1000;
                    }
                    var width = window.innerWidth;
                    var height = window.innerHeight;
                    if (cameraAttribute.AspectWidth !== undefined && cameraAttribute.AspectHeight !== undefined) {
                        width = cameraAttribute.AspectWidth.value;
                        height = cameraAttribute.AspectHeight.value;
                    }
                    var aspect = width / height;
                    var fov = 45;
                    if (cameraAttribute.FieldOfView !== undefined) {
                        fov = cameraAttribute.FieldOfView.value;
                    }
                    var focalLength = cameraAttribute.FocalLength ? cameraAttribute.FocalLength.value : null;
                    switch (type) {
                    case 0:
                        model = new THREE.PerspectiveCamera(fov, aspect, nearClippingPlane, farClippingPlane);
                        if (focalLength !== null)
                            model.setFocalLength(focalLength);
                        break;
                    case 1:
                        model = new THREE.OrthographicCamera(-width / 2, width / 2, height / 2, -height / 2, nearClippingPlane, farClippingPlane);
                        break;
                    default:
                        console.warn('THREE.FBXLoader: Unknown camera type ' + type + '.');
                        model = new THREE.Object3D();
                        break;
                    }
                }
                return model;
            },
            createLight: function (relationships) {
                var model;
                var lightAttribute;
                relationships.children.forEach(function (child) {
                    var attr = fbxTree.Objects.NodeAttribute[child.ID];
                    if (attr !== undefined) {
                        lightAttribute = attr;
                    }
                });
                if (lightAttribute === undefined) {
                    model = new THREE.Object3D();
                } else {
                    var type;
                    if (lightAttribute.LightType === undefined) {
                        type = 0;
                    } else {
                        type = lightAttribute.LightType.value;
                    }
                    var color = 16777215;
                    if (lightAttribute.undefined !== undefined) {
                        color = new THREE.Color().fromArray(lightAttribute.undefined.value);
                    }
                    var intensity = lightAttribute.Intensity === undefined ? 1 : lightAttribute.Intensity.value / 100;
                    if (lightAttribute.CastLightOnObject !== undefined && lightAttribute.CastLightOnObject.value === 0) {
                        intensity = 0;
                    }
                    var distance = 0;
                    if (lightAttribute.FarAttenuationEnd !== undefined) {
                        if (lightAttribute.EnableFarAttenuation !== undefined && lightAttribute.EnableFarAttenuation.value === 0) {
                            distance = 0;
                        } else {
                            distance = lightAttribute.FarAttenuationEnd.value;
                        }
                    }
                    var decay = 1;
                    switch (type) {
                    case 0:
                        model = new THREE.PointLight(color, intensity, distance, decay);
                        break;
                    case 1:
                        model = new THREE.DirectionalLight(color, intensity);
                        break;
                    case 2:
                        var angle = Math.PI / 3;
                        if (lightAttribute.InnerAngle !== undefined) {
                            angle = THREE.MathUtils.degToRad(lightAttribute.InnerAngle.value);
                        }
                        var penumbra = 0;
                        if (lightAttribute.OuterAngle !== undefined) {
                            penumbra = THREE.MathUtils.degToRad(lightAttribute.OuterAngle.value);
                            penumbra = Math.max(penumbra, 1);
                        }
                        model = new THREE.SpotLight(color, intensity, distance, angle, penumbra, decay);
                        break;
                    default:
                        console.warn('THREE.FBXLoader: Unknown light type ' + lightAttribute.LightType.value + ', defaulting to a PointLight.');
                        model = new THREE.PointLight(color, intensity);
                        break;
                    }
                    if (lightAttribute.CastShadows !== undefined && lightAttribute.CastShadows.value === 1) {
                        model.castShadow = true;
                    }
                }
                return model;
            },
            createMesh: function (relationships, geometryMap, materialMap) {
                var model;
                var geometry = null;
                var material = null;
                var materials = [];
                relationships.children.forEach(function (child) {
                    if (geometryMap.has(child.ID)) {
                        geometry = geometryMap.get(child.ID);
                    }
                    if (materialMap.has(child.ID)) {
                        materials.push(materialMap.get(child.ID));
                    }
                });
                if (materials.length > 1) {
                    material = materials;
                } else if (materials.length > 0) {
                    material = materials[0];
                } else {
                    material = new THREE.MeshPhongMaterial({ color: 13421772 });
                    materials.push(material);
                }
                if ('color' in geometry.attributes) {
                    materials.forEach(function (material) {
                        material.vertexColors = true;
                    });
                }
                if (geometry.FBX_Deformer) {
                    materials.forEach(function (material) {
                        material.skinning = true;
                    });
                    model = new THREE.SkinnedMesh(geometry, material);
                    model.normalizeSkinWeights();
                } else {
                    model = new THREE.Mesh(geometry, material);
                }
                return model;
            },
            createCurve: function (relationships, geometryMap) {
                var geometry = relationships.children.reduce(function (geo, child) {
                    if (geometryMap.has(child.ID))
                        geo = geometryMap.get(child.ID);
                    return geo;
                }, null);
                var material = new THREE.LineBasicMaterial({
                    color: 3342591,
                    linewidth: 1
                });
                return new THREE.Line(geometry, material);
            },
            getTransformData: function (model, modelNode) {
                var transformData = {};
                if ('InheritType' in modelNode)
                    transformData.inheritType = parseInt(modelNode.InheritType.value);
                if ('RotationOrder' in modelNode)
                    transformData.eulerOrder = getEulerOrder(modelNode.RotationOrder.value);
                else
                    transformData.eulerOrder = 'ZYX';
                if ('Lcl_Translation' in modelNode)
                    transformData.translation = modelNode.Lcl_Translation.value;
                if ('PreRotation' in modelNode)
                    transformData.preRotation = modelNode.PreRotation.value;
                if ('Lcl_Rotation' in modelNode)
                    transformData.rotation = modelNode.Lcl_Rotation.value;
                if ('PostRotation' in modelNode)
                    transformData.postRotation = modelNode.PostRotation.value;
                if ('Lcl_Scaling' in modelNode)
                    transformData.scale = modelNode.Lcl_Scaling.value;
                if ('ScalingOffset' in modelNode)
                    transformData.scalingOffset = modelNode.ScalingOffset.value;
                if ('ScalingPivot' in modelNode)
                    transformData.scalingPivot = modelNode.ScalingPivot.value;
                if ('RotationOffset' in modelNode)
                    transformData.rotationOffset = modelNode.RotationOffset.value;
                if ('RotationPivot' in modelNode)
                    transformData.rotationPivot = modelNode.RotationPivot.value;
                model.userData.transformData = transformData;
            },
            setLookAtProperties: function (model, modelNode) {
                if ('LookAtProperty' in modelNode) {
                    var children = connections.get(model.ID).children;
                    children.forEach(function (child) {
                        if (child.relationship === 'LookAtProperty') {
                            var lookAtTarget = fbxTree.Objects.Model[child.ID];
                            if ('Lcl_Translation' in lookAtTarget) {
                                var pos = lookAtTarget.Lcl_Translation.value;
                                if (model.target !== undefined) {
                                    model.target.position.fromArray(pos);
                                    sceneGraph.add(model.target);
                                } else {
                                    model.lookAt(new THREE.Vector3().fromArray(pos));
                                }
                            }
                        }
                    });
                }
            },
            bindSkeleton: function (skeletons, geometryMap, modelMap) {
                var bindMatrices = this.parsePoseNodes();
                for (var ID in skeletons) {
                    var skeleton = skeletons[ID];
                    var parents = connections.get(parseInt(skeleton.ID)).parents;
                    parents.forEach(function (parent) {
                        if (geometryMap.has(parent.ID)) {
                            var geoID = parent.ID;
                            var geoRelationships = connections.get(geoID);
                            geoRelationships.parents.forEach(function (geoConnParent) {
                                if (modelMap.has(geoConnParent.ID)) {
                                    var model = modelMap.get(geoConnParent.ID);
                                    model.bind(new THREE.Skeleton(skeleton.bones), bindMatrices[geoConnParent.ID]);
                                }
                            });
                        }
                    });
                }
            },
            parsePoseNodes: function () {
                var bindMatrices = {};
                if ('Pose' in fbxTree.Objects) {
                    var BindPoseNode = fbxTree.Objects.Pose;
                    for (var nodeID in BindPoseNode) {
                        if (BindPoseNode[nodeID].attrType === 'BindPose') {
                            var poseNodes = BindPoseNode[nodeID].PoseNode;
                            if (Array.isArray(poseNodes)) {
                                poseNodes.forEach(function (poseNode) {
                                    bindMatrices[poseNode.Node] = new THREE.Matrix4().fromArray(poseNode.Matrix.a);
                                });
                            } else {
                                bindMatrices[poseNodes.Node] = new THREE.Matrix4().fromArray(poseNodes.Matrix.a);
                            }
                        }
                    }
                }
                return bindMatrices;
            },
            createAmbientLight: function () {
                if ('GlobalSettings' in fbxTree && 'AmbientColor' in fbxTree.GlobalSettings) {
                    var ambientColor = fbxTree.GlobalSettings.AmbientColor.value;
                    var r = ambientColor[0];
                    var g = ambientColor[1];
                    var b = ambientColor[2];
                    if (r !== 0 || g !== 0 || b !== 0) {
                        var color = new THREE.Color(r, g, b);
                        sceneGraph.add(new THREE.AmbientLight(color, 1));
                    }
                }
            },
            setupMorphMaterials: function () {
                var self = this;
                sceneGraph.traverse(function (child) {
                    if (child.isMesh) {
                        if (child.geometry.morphAttributes.position && child.geometry.morphAttributes.position.length) {
                            if (Array.isArray(child.material)) {
                                child.material.forEach(function (material, i) {
                                    self.setupMorphMaterial(child, material, i);
                                });
                            } else {
                                self.setupMorphMaterial(child, child.material);
                            }
                        }
                    }
                });
            },
            setupMorphMaterial: function (child, material, index) {
                var uuid = child.uuid;
                var matUuid = material.uuid;
                var sharedMat = false;
                sceneGraph.traverse(function (node) {
                    if (node.isMesh) {
                        if (Array.isArray(node.material)) {
                            node.material.forEach(function (mat) {
                                if (mat.uuid === matUuid && node.uuid !== uuid)
                                    sharedMat = true;
                            });
                        } else if (node.material.uuid === matUuid && node.uuid !== uuid)
                            sharedMat = true;
                    }
                });
                if (sharedMat === true) {
                    var clonedMat = material.clone();
                    clonedMat.morphTargets = true;
                    if (index === undefined)
                        child.material = clonedMat;
                    else
                        child.material[index] = clonedMat;
                } else
                    material.morphTargets = true;
            }
        };
        function GeometryParser() {
        }
        GeometryParser.prototype = {
            constructor: GeometryParser,
            parse: function (deformers) {
                var geometryMap = new Map();
                if ('Geometry' in fbxTree.Objects) {
                    var geoNodes = fbxTree.Objects.Geometry;
                    for (var nodeID in geoNodes) {
                        var relationships = connections.get(parseInt(nodeID));
                        var geo = this.parseGeometry(relationships, geoNodes[nodeID], deformers);
                        geometryMap.set(parseInt(nodeID), geo);
                    }
                }
                return geometryMap;
            },
            parseGeometry: function (relationships, geoNode, deformers) {
                switch (geoNode.attrType) {
                case 'Mesh':
                    return this.parseMeshGeometry(relationships, geoNode, deformers);
                    break;
                case 'NurbsCurve':
                    return this.parseNurbsGeometry(geoNode);
                    break;
                }
            },
            parseMeshGeometry: function (relationships, geoNode, deformers) {
                var skeletons = deformers.skeletons;
                var morphTargets = [];
                var modelNodes = relationships.parents.map(function (parent) {
                    return fbxTree.Objects.Model[parent.ID];
                });
                if (modelNodes.length === 0)
                    return;
                var skeleton = relationships.children.reduce(function (skeleton, child) {
                    if (skeletons[child.ID] !== undefined)
                        skeleton = skeletons[child.ID];
                    return skeleton;
                }, null);
                relationships.children.forEach(function (child) {
                    if (deformers.morphTargets[child.ID] !== undefined) {
                        morphTargets.push(deformers.morphTargets[child.ID]);
                    }
                });
                var modelNode = modelNodes[0];
                var transformData = {};
                if ('RotationOrder' in modelNode)
                    transformData.eulerOrder = getEulerOrder(modelNode.RotationOrder.value);
                if ('InheritType' in modelNode)
                    transformData.inheritType = parseInt(modelNode.InheritType.value);
                if ('GeometricTranslation' in modelNode)
                    transformData.translation = modelNode.GeometricTranslation.value;
                if ('GeometricRotation' in modelNode)
                    transformData.rotation = modelNode.GeometricRotation.value;
                if ('GeometricScaling' in modelNode)
                    transformData.scale = modelNode.GeometricScaling.value;
                var transform = generateTransform(transformData);
                return this.genGeometry(geoNode, skeleton, morphTargets, transform);
            },
            genGeometry: function (geoNode, skeleton, morphTargets, preTransform) {
                var geo = new THREE.BufferGeometry();
                if (geoNode.attrName)
                    geo.name = geoNode.attrName;
                var geoInfo = this.parseGeoNode(geoNode, skeleton);
                var buffers = this.genBuffers(geoInfo);
                var positionAttribute = new THREE.Float32BufferAttribute(buffers.vertex, 3);
                positionAttribute.applyMatrix4(preTransform);
                geo.setAttribute('position', positionAttribute);
                if (buffers.colors.length > 0) {
                    geo.setAttribute('color', new THREE.Float32BufferAttribute(buffers.colors, 3));
                }
                if (skeleton) {
                    geo.setAttribute('skinIndex', new THREE.Uint16BufferAttribute(buffers.weightsIndices, 4));
                    geo.setAttribute('skinWeight', new THREE.Float32BufferAttribute(buffers.vertexWeights, 4));
                    geo.FBX_Deformer = skeleton;
                }
                if (buffers.normal.length > 0) {
                    var normalMatrix = new THREE.Matrix3().getNormalMatrix(preTransform);
                    var normalAttribute = new THREE.Float32BufferAttribute(buffers.normal, 3);
                    normalAttribute.applyNormalMatrix(normalMatrix);
                    geo.setAttribute('normal', normalAttribute);
                }
                buffers.uvs.forEach(function (uvBuffer, i) {
                    var name = 'uv' + (i + 1).toString();
                    if (i === 0) {
                        name = 'uv';
                    }
                    geo.setAttribute(name, new THREE.Float32BufferAttribute(buffers.uvs[i], 2));
                });
                if (geoInfo.material && geoInfo.material.mappingType !== 'AllSame') {
                    var prevMaterialIndex = buffers.materialIndex[0];
                    var startIndex = 0;
                    buffers.materialIndex.forEach(function (currentIndex, i) {
                        if (currentIndex !== prevMaterialIndex) {
                            geo.addGroup(startIndex, i - startIndex, prevMaterialIndex);
                            prevMaterialIndex = currentIndex;
                            startIndex = i;
                        }
                    });
                    if (geo.groups.length > 0) {
                        var lastGroup = geo.groups[geo.groups.length - 1];
                        var lastIndex = lastGroup.start + lastGroup.count;
                        if (lastIndex !== buffers.materialIndex.length) {
                            geo.addGroup(lastIndex, buffers.materialIndex.length - lastIndex, prevMaterialIndex);
                        }
                    }
                    if (geo.groups.length === 0) {
                        geo.addGroup(0, buffers.materialIndex.length, buffers.materialIndex[0]);
                    }
                }
                this.addMorphTargets(geo, geoNode, morphTargets, preTransform);
                return geo;
            },
            parseGeoNode: function (geoNode, skeleton) {
                var geoInfo = {};
                geoInfo.vertexPositions = geoNode.Vertices !== undefined ? geoNode.Vertices.a : [];
                geoInfo.vertexIndices = geoNode.PolygonVertexIndex !== undefined ? geoNode.PolygonVertexIndex.a : [];
                if (geoNode.LayerElementColor) {
                    geoInfo.color = this.parseVertexColors(geoNode.LayerElementColor[0]);
                }
                if (geoNode.LayerElementMaterial) {
                    geoInfo.material = this.parseMaterialIndices(geoNode.LayerElementMaterial[0]);
                }
                if (geoNode.LayerElementNormal) {
                    geoInfo.normal = this.parseNormals(geoNode.LayerElementNormal[0]);
                }
                if (geoNode.LayerElementUV) {
                    geoInfo.uv = [];
                    var i = 0;
                    while (geoNode.LayerElementUV[i]) {
                        geoInfo.uv.push(this.parseUVs(geoNode.LayerElementUV[i]));
                        i++;
                    }
                }
                geoInfo.weightTable = {};
                if (skeleton !== null) {
                    geoInfo.skeleton = skeleton;
                    skeleton.rawBones.forEach(function (rawBone, i) {
                        rawBone.indices.forEach(function (index, j) {
                            if (geoInfo.weightTable[index] === undefined)
                                geoInfo.weightTable[index] = [];
                            geoInfo.weightTable[index].push({
                                id: i,
                                weight: rawBone.weights[j]
                            });
                        });
                    });
                }
                return geoInfo;
            },
            genBuffers: function (geoInfo) {
                var buffers = {
                    vertex: [],
                    normal: [],
                    colors: [],
                    uvs: [],
                    materialIndex: [],
                    vertexWeights: [],
                    weightsIndices: []
                };
                var polygonIndex = 0;
                var faceLength = 0;
                var displayedWeightsWarning = false;
                var facePositionIndexes = [];
                var faceNormals = [];
                var faceColors = [];
                var faceUVs = [];
                var faceWeights = [];
                var faceWeightIndices = [];
                var self = this;
                geoInfo.vertexIndices.forEach(function (vertexIndex, polygonVertexIndex) {
                    var endOfFace = false;
                    if (vertexIndex < 0) {
                        vertexIndex = vertexIndex ^ -1;
                        endOfFace = true;
                    }
                    var weightIndices = [];
                    var weights = [];
                    facePositionIndexes.push(vertexIndex * 3, vertexIndex * 3 + 1, vertexIndex * 3 + 2);
                    if (geoInfo.color) {
                        var data = getData(polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.color);
                        faceColors.push(data[0], data[1], data[2]);
                    }
                    if (geoInfo.skeleton) {
                        if (geoInfo.weightTable[vertexIndex] !== undefined) {
                            geoInfo.weightTable[vertexIndex].forEach(function (wt) {
                                weights.push(wt.weight);
                                weightIndices.push(wt.id);
                            });
                        }
                        if (weights.length > 4) {
                            if (!displayedWeightsWarning) {
                                console.warn('THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.');
                                displayedWeightsWarning = true;
                            }
                            var wIndex = [
                                0,
                                0,
                                0,
                                0
                            ];
                            var Weight = [
                                0,
                                0,
                                0,
                                0
                            ];
                            weights.forEach(function (weight, weightIndex) {
                                var currentWeight = weight;
                                var currentIndex = weightIndices[weightIndex];
                                Weight.forEach(function (comparedWeight, comparedWeightIndex, comparedWeightArray) {
                                    if (currentWeight > comparedWeight) {
                                        comparedWeightArray[comparedWeightIndex] = currentWeight;
                                        currentWeight = comparedWeight;
                                        var tmp = wIndex[comparedWeightIndex];
                                        wIndex[comparedWeightIndex] = currentIndex;
                                        currentIndex = tmp;
                                    }
                                });
                            });
                            weightIndices = wIndex;
                            weights = Weight;
                        }
                        while (weights.length < 4) {
                            weights.push(0);
                            weightIndices.push(0);
                        }
                        for (var i = 0; i < 4; ++i) {
                            faceWeights.push(weights[i]);
                            faceWeightIndices.push(weightIndices[i]);
                        }
                    }
                    if (geoInfo.normal) {
                        var data = getData(polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.normal);
                        faceNormals.push(data[0], data[1], data[2]);
                    }
                    if (geoInfo.material && geoInfo.material.mappingType !== 'AllSame') {
                        var materialIndex = getData(polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.material)[0];
                    }
                    if (geoInfo.uv) {
                        geoInfo.uv.forEach(function (uv, i) {
                            var data = getData(polygonVertexIndex, polygonIndex, vertexIndex, uv);
                            if (faceUVs[i] === undefined) {
                                faceUVs[i] = [];
                            }
                            faceUVs[i].push(data[0]);
                            faceUVs[i].push(data[1]);
                        });
                    }
                    faceLength++;
                    if (endOfFace) {
                        self.genFace(buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength);
                        polygonIndex++;
                        faceLength = 0;
                        facePositionIndexes = [];
                        faceNormals = [];
                        faceColors = [];
                        faceUVs = [];
                        faceWeights = [];
                        faceWeightIndices = [];
                    }
                });
                return buffers;
            },
            genFace: function (buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength) {
                for (var i = 2; i < faceLength; i++) {
                    buffers.vertex.push(geoInfo.vertexPositions[facePositionIndexes[0]]);
                    buffers.vertex.push(geoInfo.vertexPositions[facePositionIndexes[1]]);
                    buffers.vertex.push(geoInfo.vertexPositions[facePositionIndexes[2]]);
                    buffers.vertex.push(geoInfo.vertexPositions[facePositionIndexes[(i - 1) * 3]]);
                    buffers.vertex.push(geoInfo.vertexPositions[facePositionIndexes[(i - 1) * 3 + 1]]);
                    buffers.vertex.push(geoInfo.vertexPositions[facePositionIndexes[(i - 1) * 3 + 2]]);
                    buffers.vertex.push(geoInfo.vertexPositions[facePositionIndexes[i * 3]]);
                    buffers.vertex.push(geoInfo.vertexPositions[facePositionIndexes[i * 3 + 1]]);
                    buffers.vertex.push(geoInfo.vertexPositions[facePositionIndexes[i * 3 + 2]]);
                    if (geoInfo.skeleton) {
                        buffers.vertexWeights.push(faceWeights[0]);
                        buffers.vertexWeights.push(faceWeights[1]);
                        buffers.vertexWeights.push(faceWeights[2]);
                        buffers.vertexWeights.push(faceWeights[3]);
                        buffers.vertexWeights.push(faceWeights[(i - 1) * 4]);
                        buffers.vertexWeights.push(faceWeights[(i - 1) * 4 + 1]);
                        buffers.vertexWeights.push(faceWeights[(i - 1) * 4 + 2]);
                        buffers.vertexWeights.push(faceWeights[(i - 1) * 4 + 3]);
                        buffers.vertexWeights.push(faceWeights[i * 4]);
                        buffers.vertexWeights.push(faceWeights[i * 4 + 1]);
                        buffers.vertexWeights.push(faceWeights[i * 4 + 2]);
                        buffers.vertexWeights.push(faceWeights[i * 4 + 3]);
                        buffers.weightsIndices.push(faceWeightIndices[0]);
                        buffers.weightsIndices.push(faceWeightIndices[1]);
                        buffers.weightsIndices.push(faceWeightIndices[2]);
                        buffers.weightsIndices.push(faceWeightIndices[3]);
                        buffers.weightsIndices.push(faceWeightIndices[(i - 1) * 4]);
                        buffers.weightsIndices.push(faceWeightIndices[(i - 1) * 4 + 1]);
                        buffers.weightsIndices.push(faceWeightIndices[(i - 1) * 4 + 2]);
                        buffers.weightsIndices.push(faceWeightIndices[(i - 1) * 4 + 3]);
                        buffers.weightsIndices.push(faceWeightIndices[i * 4]);
                        buffers.weightsIndices.push(faceWeightIndices[i * 4 + 1]);
                        buffers.weightsIndices.push(faceWeightIndices[i * 4 + 2]);
                        buffers.weightsIndices.push(faceWeightIndices[i * 4 + 3]);
                    }
                    if (geoInfo.color) {
                        buffers.colors.push(faceColors[0]);
                        buffers.colors.push(faceColors[1]);
                        buffers.colors.push(faceColors[2]);
                        buffers.colors.push(faceColors[(i - 1) * 3]);
                        buffers.colors.push(faceColors[(i - 1) * 3 + 1]);
                        buffers.colors.push(faceColors[(i - 1) * 3 + 2]);
                        buffers.colors.push(faceColors[i * 3]);
                        buffers.colors.push(faceColors[i * 3 + 1]);
                        buffers.colors.push(faceColors[i * 3 + 2]);
                    }
                    if (geoInfo.material && geoInfo.material.mappingType !== 'AllSame') {
                        buffers.materialIndex.push(materialIndex);
                        buffers.materialIndex.push(materialIndex);
                        buffers.materialIndex.push(materialIndex);
                    }
                    if (geoInfo.normal) {
                        buffers.normal.push(faceNormals[0]);
                        buffers.normal.push(faceNormals[1]);
                        buffers.normal.push(faceNormals[2]);
                        buffers.normal.push(faceNormals[(i - 1) * 3]);
                        buffers.normal.push(faceNormals[(i - 1) * 3 + 1]);
                        buffers.normal.push(faceNormals[(i - 1) * 3 + 2]);
                        buffers.normal.push(faceNormals[i * 3]);
                        buffers.normal.push(faceNormals[i * 3 + 1]);
                        buffers.normal.push(faceNormals[i * 3 + 2]);
                    }
                    if (geoInfo.uv) {
                        geoInfo.uv.forEach(function (uv, j) {
                            if (buffers.uvs[j] === undefined)
                                buffers.uvs[j] = [];
                            buffers.uvs[j].push(faceUVs[j][0]);
                            buffers.uvs[j].push(faceUVs[j][1]);
                            buffers.uvs[j].push(faceUVs[j][(i - 1) * 2]);
                            buffers.uvs[j].push(faceUVs[j][(i - 1) * 2 + 1]);
                            buffers.uvs[j].push(faceUVs[j][i * 2]);
                            buffers.uvs[j].push(faceUVs[j][i * 2 + 1]);
                        });
                    }
                }
            },
            addMorphTargets: function (parentGeo, parentGeoNode, morphTargets, preTransform) {
                if (morphTargets.length === 0)
                    return;
                parentGeo.morphTargetsRelative = true;
                parentGeo.morphAttributes.position = [];
                var self = this;
                morphTargets.forEach(function (morphTarget) {
                    morphTarget.rawTargets.forEach(function (rawTarget) {
                        var morphGeoNode = fbxTree.Objects.Geometry[rawTarget.geoID];
                        if (morphGeoNode !== undefined) {
                            self.genMorphGeometry(parentGeo, parentGeoNode, morphGeoNode, preTransform, rawTarget.name);
                        }
                    });
                });
            },
            genMorphGeometry: function (parentGeo, parentGeoNode, morphGeoNode, preTransform, name) {
                var vertexIndices = parentGeoNode.PolygonVertexIndex !== undefined ? parentGeoNode.PolygonVertexIndex.a : [];
                var morphPositionsSparse = morphGeoNode.Vertices !== undefined ? morphGeoNode.Vertices.a : [];
                var indices = morphGeoNode.Indexes !== undefined ? morphGeoNode.Indexes.a : [];
                var length = parentGeo.attributes.position.count * 3;
                var morphPositions = new Float32Array(length);
                for (var i = 0; i < indices.length; i++) {
                    var morphIndex = indices[i] * 3;
                    morphPositions[morphIndex] = morphPositionsSparse[i * 3];
                    morphPositions[morphIndex + 1] = morphPositionsSparse[i * 3 + 1];
                    morphPositions[morphIndex + 2] = morphPositionsSparse[i * 3 + 2];
                }
                var morphGeoInfo = {
                    vertexIndices: vertexIndices,
                    vertexPositions: morphPositions
                };
                var morphBuffers = this.genBuffers(morphGeoInfo);
                var positionAttribute = new THREE.Float32BufferAttribute(morphBuffers.vertex, 3);
                positionAttribute.name = name || morphGeoNode.attrName;
                positionAttribute.applyMatrix4(preTransform);
                parentGeo.morphAttributes.position.push(positionAttribute);
            },
            parseNormals: function (NormalNode) {
                var mappingType = NormalNode.MappingInformationType;
                var referenceType = NormalNode.ReferenceInformationType;
                var buffer = NormalNode.Normals.a;
                var indexBuffer = [];
                if (referenceType === 'IndexToDirect') {
                    if ('NormalIndex' in NormalNode) {
                        indexBuffer = NormalNode.NormalIndex.a;
                    } else if ('NormalsIndex' in NormalNode) {
                        indexBuffer = NormalNode.NormalsIndex.a;
                    }
                }
                return {
                    dataSize: 3,
                    buffer: buffer,
                    indices: indexBuffer,
                    mappingType: mappingType,
                    referenceType: referenceType
                };
            },
            parseUVs: function (UVNode) {
                var mappingType = UVNode.MappingInformationType;
                var referenceType = UVNode.ReferenceInformationType;
                var buffer = UVNode.UV.a;
                var indexBuffer = [];
                if (referenceType === 'IndexToDirect') {
                    indexBuffer = UVNode.UVIndex.a;
                }
                return {
                    dataSize: 2,
                    buffer: buffer,
                    indices: indexBuffer,
                    mappingType: mappingType,
                    referenceType: referenceType
                };
            },
            parseVertexColors: function (ColorNode) {
                var mappingType = ColorNode.MappingInformationType;
                var referenceType = ColorNode.ReferenceInformationType;
                var buffer = ColorNode.Colors.a;
                var indexBuffer = [];
                if (referenceType === 'IndexToDirect') {
                    indexBuffer = ColorNode.ColorIndex.a;
                }
                return {
                    dataSize: 4,
                    buffer: buffer,
                    indices: indexBuffer,
                    mappingType: mappingType,
                    referenceType: referenceType
                };
            },
            parseMaterialIndices: function (MaterialNode) {
                var mappingType = MaterialNode.MappingInformationType;
                var referenceType = MaterialNode.ReferenceInformationType;
                if (mappingType === 'NoMappingInformation') {
                    return {
                        dataSize: 1,
                        buffer: [0],
                        indices: [0],
                        mappingType: 'AllSame',
                        referenceType: referenceType
                    };
                }
                var materialIndexBuffer = MaterialNode.Materials.a;
                var materialIndices = [];
                for (var i = 0; i < materialIndexBuffer.length; ++i) {
                    materialIndices.push(i);
                }
                return {
                    dataSize: 1,
                    buffer: materialIndexBuffer,
                    indices: materialIndices,
                    mappingType: mappingType,
                    referenceType: referenceType
                };
            },
            parseNurbsGeometry: function (geoNode) {
                if (c.NURBSCurve === undefined) {
                    console.error('THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry.');
                    return new THREE.BufferGeometry();
                }
                var order = parseInt(geoNode.Order);
                if (isNaN(order)) {
                    console.error('THREE.FBXLoader: Invalid Order %s given for geometry ID: %s', geoNode.Order, geoNode.id);
                    return new THREE.BufferGeometry();
                }
                var degree = order - 1;
                var knots = geoNode.KnotVector.a;
                var controlPoints = [];
                var pointsValues = geoNode.Points.a;
                for (var i = 0, l = pointsValues.length; i < l; i += 4) {
                    controlPoints.push(new THREE.Vector4().fromArray(pointsValues, i));
                }
                var startKnot, endKnot;
                if (geoNode.Form === 'Closed') {
                    controlPoints.push(controlPoints[0]);
                } else if (geoNode.Form === 'Periodic') {
                    startKnot = degree;
                    endKnot = knots.length - 1 - startKnot;
                    for (var i = 0; i < degree; ++i) {
                        controlPoints.push(controlPoints[i]);
                    }
                }
                var curve = new NURBSCurve(degree, knots, controlPoints, startKnot, endKnot);
                var vertices = curve.getPoints(controlPoints.length * 7);
                var positions = new Float32Array(vertices.length * 3);
                vertices.forEach(function (vertex, i) {
                    vertex.toArray(positions, i * 3);
                });
                var geometry = new THREE.BufferGeometry();
                geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                return geometry;
            }
        };
        function AnimationParser() {
        }
        AnimationParser.prototype = {
            constructor: AnimationParser,
            parse: function () {
                var animationClips = [];
                var rawClips = this.parseClips();
                if (rawClips !== undefined) {
                    for (var key in rawClips) {
                        var rawClip = rawClips[key];
                        var clip = this.addClip(rawClip);
                        animationClips.push(clip);
                    }
                }
                return animationClips;
            },
            parseClips: function () {
                if (fbxTree.Objects.AnimationCurve === undefined)
                    return undefined;
                var curveNodesMap = this.parseAnimationCurveNodes();
                this.parseAnimationCurves(curveNodesMap);
                var layersMap = this.parseAnimationLayers(curveNodesMap);
                var rawClips = this.parseAnimStacks(layersMap);
                return rawClips;
            },
            parseAnimationCurveNodes: function () {
                var rawCurveNodes = fbxTree.Objects.AnimationCurveNode;
                var curveNodesMap = new Map();
                for (var nodeID in rawCurveNodes) {
                    var rawCurveNode = rawCurveNodes[nodeID];
                    if (rawCurveNode.attrName.match(/S|R|T|DeformPercent/) !== null) {
                        var curveNode = {
                            id: rawCurveNode.id,
                            attr: rawCurveNode.attrName,
                            curves: {}
                        };
                        curveNodesMap.set(curveNode.id, curveNode);
                    }
                }
                return curveNodesMap;
            },
            parseAnimationCurves: function (curveNodesMap) {
                var rawCurves = fbxTree.Objects.AnimationCurve;
                for (var nodeID in rawCurves) {
                    var animationCurve = {
                        id: rawCurves[nodeID].id,
                        times: rawCurves[nodeID].KeyTime.a.map(convertFBXTimeToSeconds),
                        values: rawCurves[nodeID].KeyValueFloat.a
                    };
                    var relationships = connections.get(animationCurve.id);
                    if (relationships !== undefined) {
                        var animationCurveID = relationships.parents[0].ID;
                        var animationCurveRelationship = relationships.parents[0].relationship;
                        if (animationCurveRelationship.match(/X/)) {
                            curveNodesMap.get(animationCurveID).curves['x'] = animationCurve;
                        } else if (animationCurveRelationship.match(/Y/)) {
                            curveNodesMap.get(animationCurveID).curves['y'] = animationCurve;
                        } else if (animationCurveRelationship.match(/Z/)) {
                            curveNodesMap.get(animationCurveID).curves['z'] = animationCurve;
                        } else if (animationCurveRelationship.match(/d|DeformPercent/) && curveNodesMap.has(animationCurveID)) {
                            curveNodesMap.get(animationCurveID).curves['morph'] = animationCurve;
                        }
                    }
                }
            },
            parseAnimationLayers: function (curveNodesMap) {
                var rawLayers = fbxTree.Objects.AnimationLayer;
                var layersMap = new Map();
                for (var nodeID in rawLayers) {
                    var layerCurveNodes = [];
                    var connection = connections.get(parseInt(nodeID));
                    if (connection !== undefined) {
                        var children = connection.children;
                        children.forEach(function (child, i) {
                            if (curveNodesMap.has(child.ID)) {
                                var curveNode = curveNodesMap.get(child.ID);
                                if (curveNode.curves.x !== undefined || curveNode.curves.y !== undefined || curveNode.curves.z !== undefined) {
                                    if (layerCurveNodes[i] === undefined) {
                                        var modelID = connections.get(child.ID).parents.filter(function (parent) {
                                            return parent.relationship !== undefined;
                                        })[0].ID;
                                        if (modelID !== undefined) {
                                            var rawModel = fbxTree.Objects.Model[modelID.toString()];
                                            var node = {
                                                modelName: rawModel.attrName ? THREE.PropertyBinding.sanitizeNodeName(rawModel.attrName) : '',
                                                ID: rawModel.id,
                                                initialPosition: [
                                                    0,
                                                    0,
                                                    0
                                                ],
                                                initialRotation: [
                                                    0,
                                                    0,
                                                    0
                                                ],
                                                initialScale: [
                                                    1,
                                                    1,
                                                    1
                                                ]
                                            };
                                            sceneGraph.traverse(function (child) {
                                                if (child.ID === rawModel.id) {
                                                    node.transform = child.matrix;
                                                    if (child.userData.transformData)
                                                        node.eulerOrder = child.userData.transformData.eulerOrder;
                                                }
                                            });
                                            if (!node.transform)
                                                node.transform = new THREE.Matrix4();
                                            if ('PreRotation' in rawModel)
                                                node.preRotation = rawModel.PreRotation.value;
                                            if ('PostRotation' in rawModel)
                                                node.postRotation = rawModel.PostRotation.value;
                                            layerCurveNodes[i] = node;
                                        }
                                    }
                                    if (layerCurveNodes[i])
                                        layerCurveNodes[i][curveNode.attr] = curveNode;
                                } else if (curveNode.curves.morph !== undefined) {
                                    if (layerCurveNodes[i] === undefined) {
                                        var deformerID = connections.get(child.ID).parents.filter(function (parent) {
                                            return parent.relationship !== undefined;
                                        })[0].ID;
                                        var morpherID = connections.get(deformerID).parents[0].ID;
                                        var geoID = connections.get(morpherID).parents[0].ID;
                                        var modelID = connections.get(geoID).parents[0].ID;
                                        var rawModel = fbxTree.Objects.Model[modelID];
                                        var node = {
                                            modelName: rawModel.attrName ? THREE.PropertyBinding.sanitizeNodeName(rawModel.attrName) : '',
                                            morphName: fbxTree.Objects.Deformer[deformerID].attrName
                                        };
                                        layerCurveNodes[i] = node;
                                    }
                                    layerCurveNodes[i][curveNode.attr] = curveNode;
                                }
                            }
                        });
                        layersMap.set(parseInt(nodeID), layerCurveNodes);
                    }
                }
                return layersMap;
            },
            parseAnimStacks: function (layersMap) {
                var rawStacks = fbxTree.Objects.AnimationStack;
                var rawClips = {};
                for (var nodeID in rawStacks) {
                    var children = connections.get(parseInt(nodeID)).children;
                    if (children.length > 1) {
                        console.warn('THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.');
                    }
                    var layer = layersMap.get(children[0].ID);
                    rawClips[nodeID] = {
                        name: rawStacks[nodeID].attrName,
                        layer: layer
                    };
                }
                return rawClips;
            },
            addClip: function (rawClip) {
                var tracks = [];
                var self = this;
                rawClip.layer.forEach(function (rawTracks) {
                    tracks = tracks.concat(self.generateTracks(rawTracks));
                });
                return new THREE.AnimationClip(rawClip.name, -1, tracks);
            },
            generateTracks: function (rawTracks) {
                var tracks = [];
                var initialPosition = new THREE.Vector3();
                var initialRotation = new THREE.Quaternion();
                var initialScale = new THREE.Vector3();
                if (rawTracks.transform)
                    rawTracks.transform.decompose(initialPosition, initialRotation, initialScale);
                initialPosition = initialPosition.toArray();
                initialRotation = new THREE.Euler().setFromQuaternion(initialRotation, rawTracks.eulerOrder).toArray();
                initialScale = initialScale.toArray();
                if (rawTracks.T !== undefined && Object.keys(rawTracks.T.curves).length > 0) {
                    var positionTrack = this.generateVectorTrack(rawTracks.modelName, rawTracks.T.curves, initialPosition, 'position');
                    if (positionTrack !== undefined)
                        tracks.push(positionTrack);
                }
                if (rawTracks.R !== undefined && Object.keys(rawTracks.R.curves).length > 0) {
                    var rotationTrack = this.generateRotationTrack(rawTracks.modelName, rawTracks.R.curves, initialRotation, rawTracks.preRotation, rawTracks.postRotation, rawTracks.eulerOrder);
                    if (rotationTrack !== undefined)
                        tracks.push(rotationTrack);
                }
                if (rawTracks.S !== undefined && Object.keys(rawTracks.S.curves).length > 0) {
                    var scaleTrack = this.generateVectorTrack(rawTracks.modelName, rawTracks.S.curves, initialScale, 'scale');
                    if (scaleTrack !== undefined)
                        tracks.push(scaleTrack);
                }
                if (rawTracks.DeformPercent !== undefined) {
                    var morphTrack = this.generateMorphTrack(rawTracks);
                    if (morphTrack !== undefined)
                        tracks.push(morphTrack);
                }
                return tracks;
            },
            generateVectorTrack: function (modelName, curves, initialValue, type) {
                var times = this.getTimesForAllAxes(curves);
                var values = this.getKeyframeTrackValues(times, curves, initialValue);
                return new THREE.VectorKeyframeTrack(modelName + '.' + type, times, values);
            },
            generateRotationTrack: function (modelName, curves, initialValue, preRotation, postRotation, eulerOrder) {
                if (curves.x !== undefined) {
                    this.interpolateRotations(curves.x);
                    curves.x.values = curves.x.values.map(THREE.MathUtils.degToRad);
                }
                if (curves.y !== undefined) {
                    this.interpolateRotations(curves.y);
                    curves.y.values = curves.y.values.map(THREE.MathUtils.degToRad);
                }
                if (curves.z !== undefined) {
                    this.interpolateRotations(curves.z);
                    curves.z.values = curves.z.values.map(THREE.MathUtils.degToRad);
                }
                var times = this.getTimesForAllAxes(curves);
                var values = this.getKeyframeTrackValues(times, curves, initialValue);
                if (preRotation !== undefined) {
                    preRotation = preRotation.map(THREE.MathUtils.degToRad);
                    preRotation.push(eulerOrder);
                    preRotation = new THREE.Euler().fromArray(preRotation);
                    preRotation = new THREE.Quaternion().setFromEuler(preRotation);
                }
                if (postRotation !== undefined) {
                    postRotation = postRotation.map(THREE.MathUtils.degToRad);
                    postRotation.push(eulerOrder);
                    postRotation = new THREE.Euler().fromArray(postRotation);
                    postRotation = new THREE.Quaternion().setFromEuler(postRotation).inverse();
                }
                var quaternion = new THREE.Quaternion();
                var euler = new THREE.Euler();
                var quaternionValues = [];
                for (var i = 0; i < values.length; i += 3) {
                    euler.set(values[i], values[i + 1], values[i + 2], eulerOrder);
                    quaternion.setFromEuler(euler);
                    if (preRotation !== undefined)
                        quaternion.premultiply(preRotation);
                    if (postRotation !== undefined)
                        quaternion.multiply(postRotation);
                    quaternion.toArray(quaternionValues, i / 3 * 4);
                }
                return new THREE.QuaternionKeyframeTrack(modelName + '.quaternion', times, quaternionValues);
            },
            generateMorphTrack: function (rawTracks) {
                var curves = rawTracks.DeformPercent.curves.morph;
                var values = curves.values.map(function (val) {
                    return val / 100;
                });
                var morphNum = sceneGraph.getObjectByName(rawTracks.modelName).morphTargetDictionary[rawTracks.morphName];
                return new THREE.NumberKeyframeTrack(rawTracks.modelName + '.morphTargetInfluences[' + morphNum + ']', curves.times, values);
            },
            getTimesForAllAxes: function (curves) {
                var times = [];
                if (curves.x !== undefined)
                    times = times.concat(curves.x.times);
                if (curves.y !== undefined)
                    times = times.concat(curves.y.times);
                if (curves.z !== undefined)
                    times = times.concat(curves.z.times);
                times = times.sort(function (a, b) {
                    return a - b;
                }).filter(function (elem, index, array) {
                    return array.indexOf(elem) == index;
                });
                return times;
            },
            getKeyframeTrackValues: function (times, curves, initialValue) {
                var prevValue = initialValue;
                var values = [];
                var xIndex = -1;
                var yIndex = -1;
                var zIndex = -1;
                times.forEach(function (time) {
                    if (curves.x)
                        xIndex = curves.x.times.indexOf(time);
                    if (curves.y)
                        yIndex = curves.y.times.indexOf(time);
                    if (curves.z)
                        zIndex = curves.z.times.indexOf(time);
                    if (xIndex !== -1) {
                        var xValue = curves.x.values[xIndex];
                        values.push(xValue);
                        prevValue[0] = xValue;
                    } else {
                        values.push(prevValue[0]);
                    }
                    if (yIndex !== -1) {
                        var yValue = curves.y.values[yIndex];
                        values.push(yValue);
                        prevValue[1] = yValue;
                    } else {
                        values.push(prevValue[1]);
                    }
                    if (zIndex !== -1) {
                        var zValue = curves.z.values[zIndex];
                        values.push(zValue);
                        prevValue[2] = zValue;
                    } else {
                        values.push(prevValue[2]);
                    }
                });
                return values;
            },
            interpolateRotations: function (curve) {
                for (var i = 1; i < curve.values.length; i++) {
                    var initialValue = curve.values[i - 1];
                    var valuesSpan = curve.values[i] - initialValue;
                    var absoluteSpan = Math.abs(valuesSpan);
                    if (absoluteSpan >= 180) {
                        var numSubIntervals = absoluteSpan / 180;
                        var step = valuesSpan / numSubIntervals;
                        var nextValue = initialValue + step;
                        var initialTime = curve.times[i - 1];
                        var timeSpan = curve.times[i] - initialTime;
                        var interval = timeSpan / numSubIntervals;
                        var nextTime = initialTime + interval;
                        var interpolatedTimes = [];
                        var interpolatedValues = [];
                        while (nextTime < curve.times[i]) {
                            interpolatedTimes.push(nextTime);
                            nextTime += interval;
                            interpolatedValues.push(nextValue);
                            nextValue += step;
                        }
                        curve.times = inject(curve.times, i, interpolatedTimes);
                        curve.values = inject(curve.values, i, interpolatedValues);
                    }
                }
            }
        };
        function TextParser() {
        }
        TextParser.prototype = {
            constructor: TextParser,
            getPrevNode: function () {
                return this.nodeStack[this.currentIndent - 2];
            },
            getCurrentNode: function () {
                return this.nodeStack[this.currentIndent - 1];
            },
            getCurrentProp: function () {
                return this.currentProp;
            },
            pushStack: function (node) {
                this.nodeStack.push(node);
                this.currentIndent += 1;
            },
            popStack: function () {
                this.nodeStack.pop();
                this.currentIndent -= 1;
            },
            setCurrentProp: function (val, name) {
                this.currentProp = val;
                this.currentPropName = name;
            },
            parse: function (text) {
                this.currentIndent = 0;
                this.allNodes = new FBXTree();
                this.nodeStack = [];
                this.currentProp = [];
                this.currentPropName = '';
                var self = this;
                var split = text.split(/[\r\n]+/);
                split.forEach(function (line, i) {
                    var matchComment = line.match(/^[\s\t]*;/);
                    var matchEmpty = line.match(/^[\s\t]*$/);
                    if (matchComment || matchEmpty)
                        return;
                    var matchBeginning = line.match('^\\t{' + self.currentIndent + '}(\\w+):(.*){', '');
                    var matchProperty = line.match('^\\t{' + self.currentIndent + '}(\\w+):[\\s\\t\\r\\n](.*)');
                    var matchEnd = line.match('^\\t{' + (self.currentIndent - 1) + '}}');
                    if (matchBeginning) {
                        self.parseNodeBegin(line, matchBeginning);
                    } else if (matchProperty) {
                        self.parseNodeProperty(line, matchProperty, split[++i]);
                    } else if (matchEnd) {
                        self.popStack();
                    } else if (line.match(/^[^\s\t}]/)) {
                        self.parseNodePropertyContinued(line);
                    }
                });
                return this.allNodes;
            },
            parseNodeBegin: function (line, property) {
                var nodeName = property[1].trim().replace(/^"/, '').replace(/"$/, '');
                var nodeAttrs = property[2].split(',').map(function (attr) {
                    return attr.trim().replace(/^"/, '').replace(/"$/, '');
                });
                var node = { name: nodeName };
                var attrs = this.parseNodeAttr(nodeAttrs);
                var currentNode = this.getCurrentNode();
                if (this.currentIndent === 0) {
                    this.allNodes.add(nodeName, node);
                } else {
                    if (nodeName in currentNode) {
                        if (nodeName === 'PoseNode') {
                            currentNode.PoseNode.push(node);
                        } else if (currentNode[nodeName].id !== undefined) {
                            currentNode[nodeName] = {};
                            currentNode[nodeName][currentNode[nodeName].id] = currentNode[nodeName];
                        }
                        if (attrs.id !== '')
                            currentNode[nodeName][attrs.id] = node;
                    } else if (typeof attrs.id === 'number') {
                        currentNode[nodeName] = {};
                        currentNode[nodeName][attrs.id] = node;
                    } else if (nodeName !== 'Properties70') {
                        if (nodeName === 'PoseNode')
                            currentNode[nodeName] = [node];
                        else
                            currentNode[nodeName] = node;
                    }
                }
                if (typeof attrs.id === 'number')
                    node.id = attrs.id;
                if (attrs.name !== '')
                    node.attrName = attrs.name;
                if (attrs.type !== '')
                    node.attrType = attrs.type;
                this.pushStack(node);
            },
            parseNodeAttr: function (attrs) {
                var id = attrs[0];
                if (attrs[0] !== '') {
                    id = parseInt(attrs[0]);
                    if (isNaN(id)) {
                        id = attrs[0];
                    }
                }
                var name = '', type = '';
                if (attrs.length > 1) {
                    name = attrs[1].replace(/^(\w+)::/, '');
                    type = attrs[2];
                }
                return {
                    id: id,
                    name: name,
                    type: type
                };
            },
            parseNodeProperty: function (line, property, contentLine) {
                var propName = property[1].replace(/^"/, '').replace(/"$/, '').trim();
                var propValue = property[2].replace(/^"/, '').replace(/"$/, '').trim();
                if (propName === 'Content' && propValue === ',') {
                    propValue = contentLine.replace(/"/g, '').replace(/,$/, '').trim();
                }
                var currentNode = this.getCurrentNode();
                var parentName = currentNode.name;
                if (parentName === 'Properties70') {
                    this.parseNodeSpecialProperty(line, propName, propValue);
                    return;
                }
                if (propName === 'C') {
                    var connProps = propValue.split(',').slice(1);
                    var from = parseInt(connProps[0]);
                    var to = parseInt(connProps[1]);
                    var rest = propValue.split(',').slice(3);
                    rest = rest.map(function (elem) {
                        return elem.trim().replace(/^"/, '');
                    });
                    propName = 'connections';
                    propValue = [
                        from,
                        to
                    ];
                    append(propValue, rest);
                    if (currentNode[propName] === undefined) {
                        currentNode[propName] = [];
                    }
                }
                if (propName === 'Node')
                    currentNode.id = propValue;
                if (propName in currentNode && Array.isArray(currentNode[propName])) {
                    currentNode[propName].push(propValue);
                } else {
                    if (propName !== 'a')
                        currentNode[propName] = propValue;
                    else
                        currentNode.a = propValue;
                }
                this.setCurrentProp(currentNode, propName);
                if (propName === 'a' && propValue.slice(-1) !== ',') {
                    currentNode.a = parseNumberArray(propValue);
                }
            },
            parseNodePropertyContinued: function (line) {
                var currentNode = this.getCurrentNode();
                currentNode.a += line;
                if (line.slice(-1) !== ',') {
                    currentNode.a = parseNumberArray(currentNode.a);
                }
            },
            parseNodeSpecialProperty: function (line, propName, propValue) {
                var props = propValue.split('",').map(function (prop) {
                    return prop.trim().replace(/^\"/, '').replace(/\s/, '_');
                });
                var innerPropName = props[0];
                var innerPropType1 = props[1];
                var innerPropType2 = props[2];
                var innerPropFlag = props[3];
                var innerPropValue = props[4];
                switch (innerPropType1) {
                case 'int':
                case 'enum':
                case 'bool':
                case 'ULongLong':
                case 'double':
                case 'Number':
                case 'FieldOfView':
                    innerPropValue = parseFloat(innerPropValue);
                    break;
                case 'Color':
                case 'ColorRGB':
                case 'Vector3D':
                case 'Lcl_Translation':
                case 'Lcl_Rotation':
                case 'Lcl_Scaling':
                    innerPropValue = parseNumberArray(innerPropValue);
                    break;
                }
                this.getPrevNode()[innerPropName] = {
                    'type': innerPropType1,
                    'type2': innerPropType2,
                    'flag': innerPropFlag,
                    'value': innerPropValue
                };
                this.setCurrentProp(this.getPrevNode(), innerPropName);
            }
        };
        function BinaryParser() {
        }
        BinaryParser.prototype = {
            constructor: BinaryParser,
            parse: function (buffer) {
                var reader = new BinaryReader(buffer);
                reader.skip(23);
                var version = reader.getUint32();
                console.log('THREE.FBXLoader: FBX binary version: ' + version);
                var allNodes = new FBXTree();
                while (!this.endOfContent(reader)) {
                    var node = this.parseNode(reader, version);
                    if (node !== null)
                        allNodes.add(node.name, node);
                }
                return allNodes;
            },
            endOfContent: function (reader) {
                if (reader.size() % 16 === 0) {
                    return (reader.getOffset() + 160 + 16 & ~15) >= reader.size();
                } else {
                    return reader.getOffset() + 160 + 16 >= reader.size();
                }
            },
            parseNode: function (reader, version) {
                var node = {};
                var endOffset = version >= 7500 ? reader.getUint64() : reader.getUint32();
                var numProperties = version >= 7500 ? reader.getUint64() : reader.getUint32();
                var propertyListLen = version >= 7500 ? reader.getUint64() : reader.getUint32();
                var nameLen = reader.getUint8();
                var name = reader.getString(nameLen);
                if (endOffset === 0)
                    return null;
                var propertyList = [];
                for (var i = 0; i < numProperties; i++) {
                    propertyList.push(this.parseProperty(reader));
                }
                var id = propertyList.length > 0 ? propertyList[0] : '';
                var attrName = propertyList.length > 1 ? propertyList[1] : '';
                var attrType = propertyList.length > 2 ? propertyList[2] : '';
                node.singleProperty = numProperties === 1 && reader.getOffset() === endOffset ? true : false;
                while (endOffset > reader.getOffset()) {
                    var subNode = this.parseNode(reader, version);
                    if (subNode !== null)
                        this.parseSubNode(name, node, subNode);
                }
                node.propertyList = propertyList;
                if (typeof id === 'number')
                    node.id = id;
                if (attrName !== '')
                    node.attrName = attrName;
                if (attrType !== '')
                    node.attrType = attrType;
                if (name !== '')
                    node.name = name;
                return node;
            },
            parseSubNode: function (name, node, subNode) {
                if (subNode.singleProperty === true) {
                    var value = subNode.propertyList[0];
                    if (Array.isArray(value)) {
                        node[subNode.name] = subNode;
                        subNode.a = value;
                    } else {
                        node[subNode.name] = value;
                    }
                } else if (name === 'Connections' && subNode.name === 'C') {
                    var array = [];
                    subNode.propertyList.forEach(function (property, i) {
                        if (i !== 0)
                            array.push(property);
                    });
                    if (node.connections === undefined) {
                        node.connections = [];
                    }
                    node.connections.push(array);
                } else if (subNode.name === 'Properties70') {
                    var keys = Object.keys(subNode);
                    keys.forEach(function (key) {
                        node[key] = subNode[key];
                    });
                } else if (name === 'Properties70' && subNode.name === 'P') {
                    var innerPropName = subNode.propertyList[0];
                    var innerPropType1 = subNode.propertyList[1];
                    var innerPropType2 = subNode.propertyList[2];
                    var innerPropFlag = subNode.propertyList[3];
                    var innerPropValue;
                    if (innerPropName.indexOf('Lcl ') === 0)
                        innerPropName = innerPropName.replace('Lcl ', 'Lcl_');
                    if (innerPropType1.indexOf('Lcl ') === 0)
                        innerPropType1 = innerPropType1.replace('Lcl ', 'Lcl_');
                    if (innerPropType1 === 'Color' || innerPropType1 === 'ColorRGB' || innerPropType1 === 'Vector' || innerPropType1 === 'Vector3D' || innerPropType1.indexOf('Lcl_') === 0) {
                        innerPropValue = [
                            subNode.propertyList[4],
                            subNode.propertyList[5],
                            subNode.propertyList[6]
                        ];
                    } else {
                        innerPropValue = subNode.propertyList[4];
                    }
                    node[innerPropName] = {
                        'type': innerPropType1,
                        'type2': innerPropType2,
                        'flag': innerPropFlag,
                        'value': innerPropValue
                    };
                } else if (node[subNode.name] === undefined) {
                    if (typeof subNode.id === 'number') {
                        node[subNode.name] = {};
                        node[subNode.name][subNode.id] = subNode;
                    } else {
                        node[subNode.name] = subNode;
                    }
                } else {
                    if (subNode.name === 'PoseNode') {
                        if (!Array.isArray(node[subNode.name])) {
                            node[subNode.name] = [node[subNode.name]];
                        }
                        node[subNode.name].push(subNode);
                    } else if (node[subNode.name][subNode.id] === undefined) {
                        node[subNode.name][subNode.id] = subNode;
                    }
                }
            },
            parseProperty: function (reader) {
                var type = reader.getString(1);
                switch (type) {
                case 'C':
                    return reader.getBoolean();
                case 'D':
                    return reader.getFloat64();
                case 'F':
                    return reader.getFloat32();
                case 'I':
                    return reader.getInt32();
                case 'L':
                    return reader.getInt64();
                case 'R':
                    var length = reader.getUint32();
                    return reader.getArrayBuffer(length);
                case 'S':
                    var length = reader.getUint32();
                    return reader.getString(length);
                case 'Y':
                    return reader.getInt16();
                case 'b':
                case 'c':
                case 'd':
                case 'f':
                case 'i':
                case 'l':
                    var arrayLength = reader.getUint32();
                    var encoding = reader.getUint32();
                    var compressedLength = reader.getUint32();
                    if (encoding === 0) {
                        switch (type) {
                        case 'b':
                        case 'c':
                            return reader.getBooleanArray(arrayLength);
                        case 'd':
                            return reader.getFloat64Array(arrayLength);
                        case 'f':
                            return reader.getFloat32Array(arrayLength);
                        case 'i':
                            return reader.getInt32Array(arrayLength);
                        case 'l':
                            return reader.getInt64Array(arrayLength);
                        }
                    }
                    //if (typeof b.Zlib === 'undefined') {
                    //    console.error('THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib');
                    //}
                    var inflate = new Inflate(new Uint8Array(reader.getArrayBuffer(compressedLength)));
                    var reader2 = new BinaryReader(inflate.decompress().buffer);
                    switch (type) {
                    case 'b':
                    case 'c':
                        return reader2.getBooleanArray(arrayLength);
                    case 'd':
                        return reader2.getFloat64Array(arrayLength);
                    case 'f':
                        return reader2.getFloat32Array(arrayLength);
                    case 'i':
                        return reader2.getInt32Array(arrayLength);
                    case 'l':
                        return reader2.getInt64Array(arrayLength);
                    }
                default:
                    throw new Error('THREE.FBXLoader: Unknown property type ' + type);
                }
            }
        };
        function BinaryReader(buffer, littleEndian) {
            this.dv = new DataView(buffer);
            this.offset = 0;
            this.littleEndian = littleEndian !== undefined ? littleEndian : true;
        }
        BinaryReader.prototype = {
            constructor: BinaryReader,
            getOffset: function () {
                return this.offset;
            },
            size: function () {
                return this.dv.buffer.byteLength;
            },
            skip: function (length) {
                this.offset += length;
            },
            getBoolean: function () {
                return (this.getUint8() & 1) === 1;
            },
            getBooleanArray: function (size) {
                var a = [];
                for (var i = 0; i < size; i++) {
                    a.push(this.getBoolean());
                }
                return a;
            },
            getUint8: function () {
                var value = this.dv.getUint8(this.offset);
                this.offset += 1;
                return value;
            },
            getInt16: function () {
                var value = this.dv.getInt16(this.offset, this.littleEndian);
                this.offset += 2;
                return value;
            },
            getInt32: function () {
                var value = this.dv.getInt32(this.offset, this.littleEndian);
                this.offset += 4;
                return value;
            },
            getInt32Array: function (size) {
                var a = [];
                for (var i = 0; i < size; i++) {
                    a.push(this.getInt32());
                }
                return a;
            },
            getUint32: function () {
                var value = this.dv.getUint32(this.offset, this.littleEndian);
                this.offset += 4;
                return value;
            },
            getInt64: function () {
                var low, high;
                if (this.littleEndian) {
                    low = this.getUint32();
                    high = this.getUint32();
                } else {
                    high = this.getUint32();
                    low = this.getUint32();
                }
                if (high & 2147483648) {
                    high = ~high & 4294967295;
                    low = ~low & 4294967295;
                    if (low === 4294967295)
                        high = high + 1 & 4294967295;
                    low = low + 1 & 4294967295;
                    return -(high * 4294967296 + low);
                }
                return high * 4294967296 + low;
            },
            getInt64Array: function (size) {
                var a = [];
                for (var i = 0; i < size; i++) {
                    a.push(this.getInt64());
                }
                return a;
            },
            getUint64: function () {
                var low, high;
                if (this.littleEndian) {
                    low = this.getUint32();
                    high = this.getUint32();
                } else {
                    high = this.getUint32();
                    low = this.getUint32();
                }
                return high * 4294967296 + low;
            },
            getFloat32: function () {
                var value = this.dv.getFloat32(this.offset, this.littleEndian);
                this.offset += 4;
                return value;
            },
            getFloat32Array: function (size) {
                var a = [];
                for (var i = 0; i < size; i++) {
                    a.push(this.getFloat32());
                }
                return a;
            },
            getFloat64: function () {
                var value = this.dv.getFloat64(this.offset, this.littleEndian);
                this.offset += 8;
                return value;
            },
            getFloat64Array: function (size) {
                var a = [];
                for (var i = 0; i < size; i++) {
                    a.push(this.getFloat64());
                }
                return a;
            },
            getArrayBuffer: function (size) {
                var value = this.dv.buffer.slice(this.offset, this.offset + size);
                this.offset += size;
                return value;
            },
            getString: function (size) {
                var a = [];
                for (var i = 0; i < size; i++) {
                    a[i] = this.getUint8();
                }
                var nullByte = a.indexOf(0);
                if (nullByte >= 0)
                    a = a.slice(0, nullByte);
                return THREE.LoaderUtils.decodeText(new Uint8Array(a));
            }
        };
        function FBXTree() {
        }
        FBXTree.prototype = {
            constructor: FBXTree,
            add: function (key, val) {
                this[key] = val;
            }
        };
        function isFbxFormatBinary(buffer) {
            var CORRECT = 'Kaydara FBX Binary  \0';
            return buffer.byteLength >= CORRECT.length && CORRECT === convertArrayBufferToString(buffer, 0, CORRECT.length);
        }
        function isFbxFormatASCII(text) {
            var CORRECT = [
                'K',
                'a',
                'y',
                'd',
                'a',
                'r',
                'a',
                '\\',
                'F',
                'B',
                'X',
                '\\',
                'B',
                'i',
                'n',
                'a',
                'r',
                'y',
                '\\',
                '\\'
            ];
            var cursor = 0;
            function read(offset) {
                var result = text[offset - 1];
                text = text.slice(cursor + offset);
                cursor++;
                return result;
            }
            for (var i = 0; i < CORRECT.length; ++i) {
                var num = read(1);
                if (num === CORRECT[i]) {
                    return false;
                }
            }
            return true;
        }
        function getFbxVersion(text) {
            var versionRegExp = /FBXVersion: (\d+)/;
            var match = text.match(versionRegExp);
            if (match) {
                var version = parseInt(match[1]);
                return version;
            }
            throw new Error('THREE.FBXLoader: Cannot find the version number for the file given.');
        }
        function convertFBXTimeToSeconds(time) {
            return time / 46186158000;
        }
        var dataArray = [];
        function getData(polygonVertexIndex, polygonIndex, vertexIndex, infoObject) {
            var index;
            switch (infoObject.mappingType) {
            case 'ByPolygonVertex':
                index = polygonVertexIndex;
                break;
            case 'ByPolygon':
                index = polygonIndex;
                break;
            case 'ByVertice':
                index = vertexIndex;
                break;
            case 'AllSame':
                index = infoObject.indices[0];
                break;
            default:
                console.warn('THREE.FBXLoader: unknown attribute mapping type ' + infoObject.mappingType);
            }
            if (infoObject.referenceType === 'IndexToDirect')
                index = infoObject.indices[index];
            var from = index * infoObject.dataSize;
            var to = from + infoObject.dataSize;
            return slice(dataArray, infoObject.buffer, from, to);
        }
        var tempEuler = new THREE.Euler();
        var tempVec = new THREE.Vector3();
        function generateTransform(transformData) {
            var lTranslationM = new THREE.Matrix4();
            var lPreRotationM = new THREE.Matrix4();
            var lRotationM = new THREE.Matrix4();
            var lPostRotationM = new THREE.Matrix4();
            var lScalingM = new THREE.Matrix4();
            var lScalingPivotM = new THREE.Matrix4();
            var lScalingOffsetM = new THREE.Matrix4();
            var lRotationOffsetM = new THREE.Matrix4();
            var lRotationPivotM = new THREE.Matrix4();
            var lParentGX = new THREE.Matrix4();
            var lGlobalT = new THREE.Matrix4();
            var inheritType = transformData.inheritType ? transformData.inheritType : 0;
            if (transformData.translation)
                lTranslationM.setPosition(tempVec.fromArray(transformData.translation));
            if (transformData.preRotation) {
                var array = transformData.preRotation.map(THREE.MathUtils.degToRad);
                array.push(transformData.eulerOrder);
                lPreRotationM.makeRotationFromEuler(tempEuler.fromArray(array));
            }
            if (transformData.rotation) {
                var array = transformData.rotation.map(THREE.MathUtils.degToRad);
                array.push(transformData.eulerOrder);
                lRotationM.makeRotationFromEuler(tempEuler.fromArray(array));
            }
            if (transformData.postRotation) {
                var array = transformData.postRotation.map(THREE.MathUtils.degToRad);
                array.push(transformData.eulerOrder);
                lPostRotationM.makeRotationFromEuler(tempEuler.fromArray(array));
            }
            if (transformData.scale)
                lScalingM.scale(tempVec.fromArray(transformData.scale));
            if (transformData.scalingOffset)
                lScalingOffsetM.setPosition(tempVec.fromArray(transformData.scalingOffset));
            if (transformData.scalingPivot)
                lScalingPivotM.setPosition(tempVec.fromArray(transformData.scalingPivot));
            if (transformData.rotationOffset)
                lRotationOffsetM.setPosition(tempVec.fromArray(transformData.rotationOffset));
            if (transformData.rotationPivot)
                lRotationPivotM.setPosition(tempVec.fromArray(transformData.rotationPivot));
            if (transformData.parentMatrixWorld)
                lParentGX = transformData.parentMatrixWorld;
            var lLRM = lPreRotationM.multiply(lRotationM).multiply(lPostRotationM);
            var lParentGRM = new THREE.Matrix4();
            lParentGX.extractRotation(lParentGRM);
            var lParentTM = new THREE.Matrix4();
            var lLSM;
            var lParentGSM;
            var lParentGRSM;
            lParentTM.copyPosition(lParentGX);
            lParentGRSM = lParentTM.getInverse(lParentTM).multiply(lParentGX);
            lParentGSM = lParentGRM.getInverse(lParentGRM).multiply(lParentGRSM);
            lLSM = lScalingM;
            var lGlobalRS;
            if (inheritType === 0) {
                lGlobalRS = lParentGRM.multiply(lLRM).multiply(lParentGSM).multiply(lLSM);
            } else if (inheritType === 1) {
                lGlobalRS = lParentGRM.multiply(lParentGSM).multiply(lLRM).multiply(lLSM);
            } else {
                var lParentLSM = new THREE.Matrix4().copy(lScalingM);
                var lParentGSM_noLocal = lParentGSM.multiply(lParentLSM.getInverse(lParentLSM));
                lGlobalRS = lParentGRM.multiply(lLRM).multiply(lParentGSM_noLocal).multiply(lLSM);
            }
            var lTransform = lTranslationM.multiply(lRotationOffsetM).multiply(lRotationPivotM).multiply(lPreRotationM).multiply(lRotationM).multiply(lPostRotationM).multiply(lRotationPivotM.getInverse(lRotationPivotM)).multiply(lScalingOffsetM).multiply(lScalingPivotM).multiply(lScalingM).multiply(lScalingPivotM.getInverse(lScalingPivotM));
            var lLocalTWithAllPivotAndOffsetInfo = new THREE.Matrix4().copyPosition(lTransform);
            var lGlobalTranslation = lParentGX.multiply(lLocalTWithAllPivotAndOffsetInfo);
            lGlobalT.copyPosition(lGlobalTranslation);
            lTransform = lGlobalT.multiply(lGlobalRS);
            return lTransform;
        }
        function getEulerOrder(order) {
            order = order || 0;
            var enums = [
                'ZYX',
                'YZX',
                'XZY',
                'ZXY',
                'YXZ',
                'XYZ'
            ];
            if (order === 6) {
                console.warn('THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.');
                return enums[0];
            }
            return enums[order];
        }
        function parseNumberArray(value) {
            var array = value.split(',').map(function (val) {
                return parseFloat(val);
            });
            return array;
        }
        function convertArrayBufferToString(buffer, from, to) {
            if (from === undefined)
                from = 0;
            if (to === undefined)
                to = buffer.byteLength;
            return THREE.LoaderUtils.decodeText(new Uint8Array(buffer, from, to));
        }
        function append(a, b) {
            for (var i = 0, j = a.length, l = b.length; i < l; i++, j++) {
                a[j] = b[i];
            }
        }
        function slice(a, b, from, to) {
            for (var i = from, j = 0; i < to; i++, j++) {
                a[j] = b[i];
            }
            return a;
        }
        function inject(a1, index, a2) {
            return a1.slice(0, index).concat(a2).concat(a1.slice(index));
        }
        return FBXLoader;
    }();
    return threex.loaders.FBXLoader = FBXLoader;
});
define('skylark-threejs-ex/loaders/GCodeLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var GCodeLoader = function (manager) {
        THREE.Loader.call(this, manager);
        this.splitLayer = false;
    };
    GCodeLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: GCodeLoader,
        load: function (url, onLoad, onProgress, onError) {
            var self = this;
            var loader = new THREE.FileLoader(self.manager);
            loader.setPath(self.path);
            loader.load(url, function (text) {
                onLoad(self.parse(text));
            }, onProgress, onError);
        },
        parse: function (data) {
            var state = {
                x: 0,
                y: 0,
                z: 0,
                e: 0,
                f: 0,
                extruding: false,
                relative: false
            };
            var layers = [];
            var currentLayer = undefined;
            var pathMaterial = new THREE.LineBasicMaterial({ color: 16711680 });
            pathMaterial.name = 'path';
            var extrudingMaterial = new THREE.LineBasicMaterial({ color: 65280 });
            extrudingMaterial.name = 'extruded';
            function newLayer(line) {
                currentLayer = {
                    vertex: [],
                    pathVertex: [],
                    z: line.z
                };
                layers.push(currentLayer);
            }
            function addSegment(p1, p2) {
                if (currentLayer === undefined) {
                    newLayer(p1);
                }
                if (line.extruding) {
                    currentLayer.vertex.push(p1.x, p1.y, p1.z);
                    currentLayer.vertex.push(p2.x, p2.y, p2.z);
                } else {
                    currentLayer.pathVertex.push(p1.x, p1.y, p1.z);
                    currentLayer.pathVertex.push(p2.x, p2.y, p2.z);
                }
            }
            function delta(v1, v2) {
                return state.relative ? v2 : v2 - v1;
            }
            function absolute(v1, v2) {
                return state.relative ? v1 + v2 : v2;
            }
            var lines = data.replace(/;.+/g, '').split('\n');
            for (var i = 0; i < lines.length; i++) {
                var tokens = lines[i].split(' ');
                var cmd = tokens[0].toUpperCase();
                var args = {};
                tokens.splice(1).forEach(function (token) {
                    if (token[0] !== undefined) {
                        var key = token[0].toLowerCase();
                        var value = parseFloat(token.substring(1));
                        args[key] = value;
                    }
                });
                if (cmd === 'G0' || cmd === 'G1') {
                    var line = {
                        x: args.x !== undefined ? absolute(state.x, args.x) : state.x,
                        y: args.y !== undefined ? absolute(state.y, args.y) : state.y,
                        z: args.z !== undefined ? absolute(state.z, args.z) : state.z,
                        e: args.e !== undefined ? absolute(state.e, args.e) : state.e,
                        f: args.f !== undefined ? absolute(state.f, args.f) : state.f
                    };
                    if (delta(state.e, line.e) > 0) {
                        line.extruding = delta(state.e, line.e) > 0;
                        if (currentLayer == undefined || line.z != currentLayer.z) {
                            newLayer(line);
                        }
                    }
                    addSegment(state, line);
                    state = line;
                } else if (cmd === 'G2' || cmd === 'G3') {
                } else if (cmd === 'G90') {
                    state.relative = false;
                } else if (cmd === 'G91') {
                    state.relative = true;
                } else if (cmd === 'G92') {
                    var line = state;
                    line.x = args.x !== undefined ? args.x : line.x;
                    line.y = args.y !== undefined ? args.y : line.y;
                    line.z = args.z !== undefined ? args.z : line.z;
                    line.e = args.e !== undefined ? args.e : line.e;
                    state = line;
                } else {
                }
            }
            function addObject(vertex, extruding) {
                var geometry = new THREE.BufferGeometry();
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertex, 3));
                var segments = new THREE.LineSegments(geometry, extruding ? extrudingMaterial : pathMaterial);
                segments.name = 'layer' + i;
                object.add(segments);
            }
            var object = new THREE.Group();
            object.name = 'gcode';
            if (this.splitLayer) {
                for (var i = 0; i < layers.length; i++) {
                    var layer = layers[i];
                    addObject(layer.vertex, true);
                    addObject(layer.pathVertex, false);
                }
            } else {
                var vertex = [], pathVertex = [];
                for (var i = 0; i < layers.length; i++) {
                    var layer = layers[i];
                    vertex = vertex.concat(layer.vertex);
                    pathVertex = pathVertex.concat(layer.pathVertex);
                }
                addObject(vertex, true);
                addObject(pathVertex, false);
            }
            object.quaternion.setFromEuler(new THREE.Euler(-Math.PI / 2, 0, 0));
            return object;
        }
    });
    return threex.loaders.GCodeLoader = GCodeLoader;
});
define('skylark-threejs-ex/loaders/GLTFLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var GLTFLoader = function () {
        function GLTFLoader(manager) {
            THREE.Loader.call(this, manager);
            this.dracoLoader = null;
            this.ddsLoader = null;
        }
        GLTFLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
            constructor: GLTFLoader,
            load: function (url, onLoad, onProgress, onError) {
                var scope = this;
                var resourcePath;
                if (this.resourcePath !== '') {
                    resourcePath = this.resourcePath;
                } else if (this.path !== '') {
                    resourcePath = this.path;
                } else {
                    resourcePath = THREE.LoaderUtils.extractUrlBase(url);
                }
                scope.manager.itemStart(url);
                var _onError = function (e) {
                    if (onError) {
                        onError(e);
                    } else {
                        console.error(e);
                    }
                    scope.manager.itemError(url);
                    scope.manager.itemEnd(url);
                };
                var loader = new THREE.FileLoader(scope.manager);
                loader.setPath(this.path);
                loader.setResponseType('arraybuffer');
                if (scope.crossOrigin === 'use-credentials') {
                    loader.setWithCredentials(true);
                }
                loader.load(url, function (data) {
                    try {
                        scope.parse(data, resourcePath, function (gltf) {
                            onLoad(gltf);
                            scope.manager.itemEnd(url);
                        }, _onError);
                    } catch (e) {
                        _onError(e);
                    }
                }, onProgress, _onError);
            },
            setDRACOLoader: function (dracoLoader) {
                this.dracoLoader = dracoLoader;
                return this;
            },
            setDDSLoader: function (ddsLoader) {
                this.ddsLoader = ddsLoader;
                return this;
            },
            parse: function (data, path, onLoad, onError) {
                var content;
                var extensions = {};
                if (typeof data === 'string') {
                    content = data;
                } else {
                    var magic = THREE.LoaderUtils.decodeText(new Uint8Array(data, 0, 4));
                    if (magic === BINARY_EXTENSION_HEADER_MAGIC) {
                        try {
                            extensions[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(data);
                        } catch (error) {
                            if (onError)
                                onError(error);
                            return;
                        }
                        content = extensions[EXTENSIONS.KHR_BINARY_GLTF].content;
                    } else {
                        content = THREE.LoaderUtils.decodeText(new Uint8Array(data));
                    }
                }
                var json = JSON.parse(content);
                if (json.asset === undefined || json.asset.version[0] < 2) {
                    if (onError)
                        onError(new Error('THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.'));
                    return;
                }
                if (json.extensionsUsed) {
                    for (var i = 0; i < json.extensionsUsed.length; ++i) {
                        var extensionName = json.extensionsUsed[i];
                        var extensionsRequired = json.extensionsRequired || [];
                        switch (extensionName) {
                        case EXTENSIONS.KHR_LIGHTS_PUNCTUAL:
                            extensions[extensionName] = new GLTFLightsExtension(json);
                            break;
                        case EXTENSIONS.KHR_MATERIALS_CLEARCOAT:
                            extensions[extensionName] = new GLTFMaterialsClearcoatExtension();
                            break;
                        case EXTENSIONS.KHR_MATERIALS_UNLIT:
                            extensions[extensionName] = new GLTFMaterialsUnlitExtension();
                            break;
                        case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:
                            extensions[extensionName] = new GLTFMaterialsPbrSpecularGlossinessExtension();
                            break;
                        case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:
                            extensions[extensionName] = new GLTFDracoMeshCompressionExtension(json, this.dracoLoader);
                            break;
                        case EXTENSIONS.MSFT_TEXTURE_DDS:
                            extensions[extensionName] = new GLTFTextureDDSExtension(this.ddsLoader);
                            break;
                        case EXTENSIONS.KHR_TEXTURE_TRANSFORM:
                            extensions[extensionName] = new GLTFTextureTransformExtension();
                            break;
                        case EXTENSIONS.KHR_MESH_QUANTIZATION:
                            extensions[extensionName] = new GLTFMeshQuantizationExtension();
                            break;
                        default:
                            if (extensionsRequired.indexOf(extensionName) >= 0) {
                                console.warn('THREE.GLTFLoader: Unknown extension "' + extensionName + '".');
                            }
                        }
                    }
                }
                var parser = new GLTFParser(json, extensions, {
                    path: path || this.resourcePath || '',
                    crossOrigin: this.crossOrigin,
                    manager: this.manager
                });
                parser.parse(onLoad, onError);
            }
        });
        function GLTFRegistry() {
            var objects = {};
            return {
                get: function (key) {
                    return objects[key];
                },
                add: function (key, object) {
                    objects[key] = object;
                },
                remove: function (key) {
                    delete objects[key];
                },
                removeAll: function () {
                    objects = {};
                }
            };
        }
        var EXTENSIONS = {
            KHR_BINARY_GLTF: 'KHR_binary_glTF',
            KHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',
            KHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',
            KHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',
            KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',
            KHR_MATERIALS_UNLIT: 'KHR_materials_unlit',
            KHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',
            KHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',
            MSFT_TEXTURE_DDS: 'MSFT_texture_dds'
        };
        function GLTFTextureDDSExtension(ddsLoader) {
            if (!ddsLoader) {
                throw new Error('THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader');
            }
            this.name = EXTENSIONS.MSFT_TEXTURE_DDS;
            this.ddsLoader = ddsLoader;
        }
        function GLTFLightsExtension(json) {
            this.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;
            var extension = json.extensions && json.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL] || {};
            this.lightDefs = extension.lights || [];
        }
        GLTFLightsExtension.prototype.loadLight = function (lightIndex) {
            var lightDef = this.lightDefs[lightIndex];
            var lightNode;
            var color = new THREE.Color(16777215);
            if (lightDef.color !== undefined)
                color.fromArray(lightDef.color);
            var range = lightDef.range !== undefined ? lightDef.range : 0;
            switch (lightDef.type) {
            case 'directional':
                lightNode = new THREE.DirectionalLight(color);
                lightNode.target.position.set(0, 0, -1);
                lightNode.add(lightNode.target);
                break;
            case 'point':
                lightNode = new THREE.PointLight(color);
                lightNode.distance = range;
                break;
            case 'spot':
                lightNode = new THREE.SpotLight(color);
                lightNode.distance = range;
                lightDef.spot = lightDef.spot || {};
                lightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;
                lightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4;
                lightNode.angle = lightDef.spot.outerConeAngle;
                lightNode.penumbra = 1 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;
                lightNode.target.position.set(0, 0, -1);
                lightNode.add(lightNode.target);
                break;
            default:
                throw new Error('THREE.GLTFLoader: Unexpected light type, "' + lightDef.type + '".');
            }
            lightNode.position.set(0, 0, 0);
            lightNode.decay = 2;
            if (lightDef.intensity !== undefined)
                lightNode.intensity = lightDef.intensity;
            lightNode.name = lightDef.name || 'light_' + lightIndex;
            return Promise.resolve(lightNode);
        };
        function GLTFMaterialsUnlitExtension() {
            this.name = EXTENSIONS.KHR_MATERIALS_UNLIT;
        }
        GLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {
            return THREE.MeshBasicMaterial;
        };
        GLTFMaterialsUnlitExtension.prototype.extendParams = function (materialParams, materialDef, parser) {
            var pending = [];
            materialParams.color = new THREE.Color(1, 1, 1);
            materialParams.opacity = 1;
            var metallicRoughness = materialDef.pbrMetallicRoughness;
            if (metallicRoughness) {
                if (Array.isArray(metallicRoughness.baseColorFactor)) {
                    var array = metallicRoughness.baseColorFactor;
                    materialParams.color.fromArray(array);
                    materialParams.opacity = array[3];
                }
                if (metallicRoughness.baseColorTexture !== undefined) {
                    pending.push(parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture));
                }
            }
            return Promise.all(pending);
        };
        function GLTFMaterialsClearcoatExtension() {
            this.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;
        }
        GLTFMaterialsClearcoatExtension.prototype.getMaterialType = function () {
            return THREE.MeshPhysicalMaterial;
        };
        GLTFMaterialsClearcoatExtension.prototype.extendParams = function (materialParams, materialDef, parser) {
            var pending = [];
            var extension = materialDef.extensions[this.name];
            if (extension.clearcoatFactor !== undefined) {
                materialParams.clearcoat = extension.clearcoatFactor;
            }
            if (extension.clearcoatTexture !== undefined) {
                pending.push(parser.assignTexture(materialParams, 'clearcoatMap', extension.clearcoatTexture));
            }
            if (extension.clearcoatRoughnessFactor !== undefined) {
                materialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;
            }
            if (extension.clearcoatRoughnessTexture !== undefined) {
                pending.push(parser.assignTexture(materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture));
            }
            if (extension.clearcoatNormalTexture !== undefined) {
                pending.push(parser.assignTexture(materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture));
                if (extension.clearcoatNormalTexture.scale !== undefined) {
                    var scale = extension.clearcoatNormalTexture.scale;
                    materialParams.clearcoatNormalScale = new THREE.Vector2(scale, scale);
                }
            }
            return Promise.all(pending);
        };
        var BINARY_EXTENSION_HEADER_MAGIC = 'glTF';
        var BINARY_EXTENSION_HEADER_LENGTH = 12;
        var BINARY_EXTENSION_CHUNK_TYPES = {
            JSON: 1313821514,
            BIN: 5130562
        };
        function GLTFBinaryExtension(data) {
            this.name = EXTENSIONS.KHR_BINARY_GLTF;
            this.content = null;
            this.body = null;
            var headerView = new DataView(data, 0, BINARY_EXTENSION_HEADER_LENGTH);
            this.header = {
                magic: THREE.LoaderUtils.decodeText(new Uint8Array(data.slice(0, 4))),
                version: headerView.getUint32(4, true),
                length: headerView.getUint32(8, true)
            };
            if (this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC) {
                throw new Error('THREE.GLTFLoader: Unsupported glTF-Binary header.');
            } else if (this.header.version < 2) {
                throw new Error('THREE.GLTFLoader: Legacy binary file detected.');
            }
            var chunkView = new DataView(data, BINARY_EXTENSION_HEADER_LENGTH);
            var chunkIndex = 0;
            while (chunkIndex < chunkView.byteLength) {
                var chunkLength = chunkView.getUint32(chunkIndex, true);
                chunkIndex += 4;
                var chunkType = chunkView.getUint32(chunkIndex, true);
                chunkIndex += 4;
                if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON) {
                    var contentArray = new Uint8Array(data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength);
                    this.content = THREE.LoaderUtils.decodeText(contentArray);
                } else if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN) {
                    var byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;
                    this.body = data.slice(byteOffset, byteOffset + chunkLength);
                }
                chunkIndex += chunkLength;
            }
            if (this.content === null) {
                throw new Error('THREE.GLTFLoader: JSON content not found.');
            }
        }
        function GLTFDracoMeshCompressionExtension(json, dracoLoader) {
            if (!dracoLoader) {
                throw new Error('THREE.GLTFLoader: No DRACOLoader instance provided.');
            }
            this.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;
            this.json = json;
            this.dracoLoader = dracoLoader;
            this.dracoLoader.preload();
        }
        GLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function (primitive, parser) {
            var json = this.json;
            var dracoLoader = this.dracoLoader;
            var bufferViewIndex = primitive.extensions[this.name].bufferView;
            var gltfAttributeMap = primitive.extensions[this.name].attributes;
            var threeAttributeMap = {};
            var attributeNormalizedMap = {};
            var attributeTypeMap = {};
            for (var attributeName in gltfAttributeMap) {
                var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();
                threeAttributeMap[threeAttributeName] = gltfAttributeMap[attributeName];
            }
            for (attributeName in primitive.attributes) {
                var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();
                if (gltfAttributeMap[attributeName] !== undefined) {
                    var accessorDef = json.accessors[primitive.attributes[attributeName]];
                    var componentType = WEBGL_COMPONENT_TYPES[accessorDef.componentType];
                    attributeTypeMap[threeAttributeName] = componentType;
                    attributeNormalizedMap[threeAttributeName] = accessorDef.normalized === true;
                }
            }
            return parser.getDependency('bufferView', bufferViewIndex).then(function (bufferView) {
                return new Promise(function (resolve) {
                    dracoLoader.decodeDracoFile(bufferView, function (geometry) {
                        for (var attributeName in geometry.attributes) {
                            var attribute = geometry.attributes[attributeName];
                            var normalized = attributeNormalizedMap[attributeName];
                            if (normalized !== undefined)
                                attribute.normalized = normalized;
                        }
                        resolve(geometry);
                    }, threeAttributeMap, attributeTypeMap);
                });
            });
        };
        function GLTFTextureTransformExtension() {
            this.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;
        }
        GLTFTextureTransformExtension.prototype.extendTexture = function (texture, transform) {
            texture = texture.clone();
            if (transform.offset !== undefined) {
                texture.offset.fromArray(transform.offset);
            }
            if (transform.rotation !== undefined) {
                texture.rotation = transform.rotation;
            }
            if (transform.scale !== undefined) {
                texture.repeat.fromArray(transform.scale);
            }
            if (transform.texCoord !== undefined) {
                console.warn('THREE.GLTFLoader: Custom UV sets in "' + this.name + '" extension not yet supported.');
            }
            texture.needsUpdate = true;
            return texture;
        };
        function GLTFMeshStandardSGMaterial(params) {
            THREE.MeshStandardMaterial.call(this);
            this.isGLTFSpecularGlossinessMaterial = true;
            var specularMapParsFragmentChunk = [
                '#ifdef USE_SPECULARMAP',
                '\tuniform sampler2D specularMap;',
                '#endif'
            ].join('\n');
            var glossinessMapParsFragmentChunk = [
                '#ifdef USE_GLOSSINESSMAP',
                '\tuniform sampler2D glossinessMap;',
                '#endif'
            ].join('\n');
            var specularMapFragmentChunk = [
                'vec3 specularFactor = specular;',
                '#ifdef USE_SPECULARMAP',
                '\tvec4 texelSpecular = texture2D( specularMap, vUv );',
                '\ttexelSpecular = sRGBToLinear( texelSpecular );',
                '\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',
                '\tspecularFactor *= texelSpecular.rgb;',
                '#endif'
            ].join('\n');
            var glossinessMapFragmentChunk = [
                'float glossinessFactor = glossiness;',
                '#ifdef USE_GLOSSINESSMAP',
                '\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',
                '\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',
                '\tglossinessFactor *= texelGlossiness.a;',
                '#endif'
            ].join('\n');
            var lightPhysicalFragmentChunk = [
                'PhysicalMaterial material;',
                'material.diffuseColor = diffuseColor.rgb;',
                'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',
                'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',
                'material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.',
                'material.specularRoughness += geometryRoughness;',
                'material.specularRoughness = min( material.specularRoughness, 1.0 );',
                'material.specularColor = specularFactor.rgb;'
            ].join('\n');
            var uniforms = {
                specular: { value: new THREE.Color().setHex(16777215) },
                glossiness: { value: 1 },
                specularMap: { value: null },
                glossinessMap: { value: null }
            };
            this._extraUniforms = uniforms;
            this.onBeforeCompile = function (shader) {
                for (var uniformName in uniforms) {
                    shader.uniforms[uniformName] = uniforms[uniformName];
                }
                shader.fragmentShader = shader.fragmentShader.replace('uniform float roughness;', 'uniform vec3 specular;');
                shader.fragmentShader = shader.fragmentShader.replace('uniform float metalness;', 'uniform float glossiness;');
                shader.fragmentShader = shader.fragmentShader.replace('#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk);
                shader.fragmentShader = shader.fragmentShader.replace('#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk);
                shader.fragmentShader = shader.fragmentShader.replace('#include <roughnessmap_fragment>', specularMapFragmentChunk);
                shader.fragmentShader = shader.fragmentShader.replace('#include <metalnessmap_fragment>', glossinessMapFragmentChunk);
                shader.fragmentShader = shader.fragmentShader.replace('#include <lights_physical_fragment>', lightPhysicalFragmentChunk);
            };
            Object.defineProperties(this, {
                specular: {
                    get: function () {
                        return uniforms.specular.value;
                    },
                    set: function (v) {
                        uniforms.specular.value = v;
                    }
                },
                specularMap: {
                    get: function () {
                        return uniforms.specularMap.value;
                    },
                    set: function (v) {
                        uniforms.specularMap.value = v;
                    }
                },
                glossiness: {
                    get: function () {
                        return uniforms.glossiness.value;
                    },
                    set: function (v) {
                        uniforms.glossiness.value = v;
                    }
                },
                glossinessMap: {
                    get: function () {
                        return uniforms.glossinessMap.value;
                    },
                    set: function (v) {
                        uniforms.glossinessMap.value = v;
                        if (v) {
                            this.defines.USE_GLOSSINESSMAP = '';
                            this.defines.USE_ROUGHNESSMAP = '';
                        } else {
                            delete this.defines.USE_ROUGHNESSMAP;
                            delete this.defines.USE_GLOSSINESSMAP;
                        }
                    }
                }
            });
            delete this.metalness;
            delete this.roughness;
            delete this.metalnessMap;
            delete this.roughnessMap;
            this.setValues(params);
        }
        GLTFMeshStandardSGMaterial.prototype = Object.create(THREE.MeshStandardMaterial.prototype);
        GLTFMeshStandardSGMaterial.prototype.constructor = GLTFMeshStandardSGMaterial;
        GLTFMeshStandardSGMaterial.prototype.copy = function (source) {
            THREE.MeshStandardMaterial.prototype.copy.call(this, source);
            this.specularMap = source.specularMap;
            this.specular.copy(source.specular);
            this.glossinessMap = source.glossinessMap;
            this.glossiness = source.glossiness;
            delete this.metalness;
            delete this.roughness;
            delete this.metalnessMap;
            delete this.roughnessMap;
            return this;
        };
        function GLTFMaterialsPbrSpecularGlossinessExtension() {
            return {
                name: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,
                specularGlossinessParams: [
                    'color',
                    'map',
                    'lightMap',
                    'lightMapIntensity',
                    'aoMap',
                    'aoMapIntensity',
                    'emissive',
                    'emissiveIntensity',
                    'emissiveMap',
                    'bumpMap',
                    'bumpScale',
                    'normalMap',
                    'normalMapType',
                    'displacementMap',
                    'displacementScale',
                    'displacementBias',
                    'specularMap',
                    'specular',
                    'glossinessMap',
                    'glossiness',
                    'alphaMap',
                    'envMap',
                    'envMapIntensity',
                    'refractionRatio'
                ],
                getMaterialType: function () {
                    return GLTFMeshStandardSGMaterial;
                },
                extendParams: function (materialParams, materialDef, parser) {
                    var pbrSpecularGlossiness = materialDef.extensions[this.name];
                    materialParams.color = new THREE.Color(1, 1, 1);
                    materialParams.opacity = 1;
                    var pending = [];
                    if (Array.isArray(pbrSpecularGlossiness.diffuseFactor)) {
                        var array = pbrSpecularGlossiness.diffuseFactor;
                        materialParams.color.fromArray(array);
                        materialParams.opacity = array[3];
                    }
                    if (pbrSpecularGlossiness.diffuseTexture !== undefined) {
                        pending.push(parser.assignTexture(materialParams, 'map', pbrSpecularGlossiness.diffuseTexture));
                    }
                    materialParams.emissive = new THREE.Color(0, 0, 0);
                    materialParams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1;
                    materialParams.specular = new THREE.Color(1, 1, 1);
                    if (Array.isArray(pbrSpecularGlossiness.specularFactor)) {
                        materialParams.specular.fromArray(pbrSpecularGlossiness.specularFactor);
                    }
                    if (pbrSpecularGlossiness.specularGlossinessTexture !== undefined) {
                        var specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;
                        pending.push(parser.assignTexture(materialParams, 'glossinessMap', specGlossMapDef));
                        pending.push(parser.assignTexture(materialParams, 'specularMap', specGlossMapDef));
                    }
                    return Promise.all(pending);
                },
                createMaterial: function (materialParams) {
                    var material = new GLTFMeshStandardSGMaterial(materialParams);
                    material.fog = true;
                    material.color = materialParams.color;
                    material.map = materialParams.map === undefined ? null : materialParams.map;
                    material.lightMap = null;
                    material.lightMapIntensity = 1;
                    material.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;
                    material.aoMapIntensity = 1;
                    material.emissive = materialParams.emissive;
                    material.emissiveIntensity = 1;
                    material.emissiveMap = materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;
                    material.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;
                    material.bumpScale = 1;
                    material.normalMap = materialParams.normalMap === undefined ? null : materialParams.normalMap;
                    material.normalMapType = THREE.TangentSpaceNormalMap;
                    if (materialParams.normalScale)
                        material.normalScale = materialParams.normalScale;
                    material.displacementMap = null;
                    material.displacementScale = 1;
                    material.displacementBias = 0;
                    material.specularMap = materialParams.specularMap === undefined ? null : materialParams.specularMap;
                    material.specular = materialParams.specular;
                    material.glossinessMap = materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;
                    material.glossiness = materialParams.glossiness;
                    material.alphaMap = null;
                    material.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;
                    material.envMapIntensity = 1;
                    material.refractionRatio = 0.98;
                    return material;
                }
            };
        }
        function GLTFMeshQuantizationExtension() {
            this.name = EXTENSIONS.KHR_MESH_QUANTIZATION;
        }
        function GLTFCubicSplineInterpolant(parameterPositions, sampleValues, sampleSize, resultBuffer) {
            THREE.Interpolant.call(this, parameterPositions, sampleValues, sampleSize, resultBuffer);
        }
        GLTFCubicSplineInterpolant.prototype = Object.create(THREE.Interpolant.prototype);
        GLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;
        GLTFCubicSplineInterpolant.prototype.copySampleValue_ = function (index) {
            var result = this.resultBuffer, values = this.sampleValues, valueSize = this.valueSize, offset = index * valueSize * 3 + valueSize;
            for (var i = 0; i !== valueSize; i++) {
                result[i] = values[offset + i];
            }
            return result;
        };
        GLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;
        GLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;
        GLTFCubicSplineInterpolant.prototype.interpolate_ = function (i1, t0, t, t1) {
            var result = this.resultBuffer;
            var values = this.sampleValues;
            var stride = this.valueSize;
            var stride2 = stride * 2;
            var stride3 = stride * 3;
            var td = t1 - t0;
            var p = (t - t0) / td;
            var pp = p * p;
            var ppp = pp * p;
            var offset1 = i1 * stride3;
            var offset0 = offset1 - stride3;
            var s2 = -2 * ppp + 3 * pp;
            var s3 = ppp - pp;
            var s0 = 1 - s2;
            var s1 = s3 - pp + p;
            for (var i = 0; i !== stride; i++) {
                var p0 = values[offset0 + i + stride];
                var m0 = values[offset0 + i + stride2] * td;
                var p1 = values[offset1 + i + stride];
                var m1 = values[offset1 + i] * td;
                result[i] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;
            }
            return result;
        };
        var WEBGL_CONSTANTS = {
            FLOAT: 5126,
            FLOAT_MAT3: 35675,
            FLOAT_MAT4: 35676,
            FLOAT_VEC2: 35664,
            FLOAT_VEC3: 35665,
            FLOAT_VEC4: 35666,
            LINEAR: 9729,
            REPEAT: 10497,
            SAMPLER_2D: 35678,
            POINTS: 0,
            LINES: 1,
            LINE_LOOP: 2,
            LINE_STRIP: 3,
            TRIANGLES: 4,
            TRIANGLE_STRIP: 5,
            TRIANGLE_FAN: 6,
            UNSIGNED_BYTE: 5121,
            UNSIGNED_SHORT: 5123
        };
        var WEBGL_COMPONENT_TYPES = {
            5120: Int8Array,
            5121: Uint8Array,
            5122: Int16Array,
            5123: Uint16Array,
            5125: Uint32Array,
            5126: Float32Array
        };
        var WEBGL_FILTERS = {
            9728: THREE.NearestFilter,
            9729: THREE.LinearFilter,
            9984: THREE.NearestMipmapNearestFilter,
            9985: THREE.LinearMipmapNearestFilter,
            9986: THREE.NearestMipmapLinearFilter,
            9987: THREE.LinearMipmapLinearFilter
        };
        var WEBGL_WRAPPINGS = {
            33071: THREE.ClampToEdgeWrapping,
            33648: THREE.MirroredRepeatWrapping,
            10497: THREE.RepeatWrapping
        };
        var WEBGL_TYPE_SIZES = {
            'SCALAR': 1,
            'VEC2': 2,
            'VEC3': 3,
            'VEC4': 4,
            'MAT2': 4,
            'MAT3': 9,
            'MAT4': 16
        };
        var ATTRIBUTES = {
            POSITION: 'position',
            NORMAL: 'normal',
            TANGENT: 'tangent',
            TEXCOORD_0: 'uv',
            TEXCOORD_1: 'uv2',
            COLOR_0: 'color',
            WEIGHTS_0: 'skinWeight',
            JOINTS_0: 'skinIndex'
        };
        var PATH_PROPERTIES = {
            scale: 'scale',
            translation: 'position',
            rotation: 'quaternion',
            weights: 'morphTargetInfluences'
        };
        var INTERPOLATION = {
            CUBICSPLINE: undefined,
            LINEAR: THREE.InterpolateLinear,
            STEP: THREE.InterpolateDiscrete
        };
        var ALPHA_MODES = {
            OPAQUE: 'OPAQUE',
            MASK: 'MASK',
            BLEND: 'BLEND'
        };
        var MIME_TYPE_FORMATS = {
            'image/png': THREE.RGBAFormat,
            'image/jpeg': THREE.RGBFormat
        };
        function resolveURL(url, path) {
            if (typeof url !== 'string' || url === '')
                return '';
            if (/^https?:\/\//i.test(path) && /^\//.test(url)) {
                path = path.replace(/(^https?:\/\/[^\/]+).*/i, '$1');
            }
            if (/^(https?:)?\/\//i.test(url))
                return url;
            if (/^data:.*,.*$/i.test(url))
                return url;
            if (/^blob:.*$/i.test(url))
                return url;
            return path + url;
        }
        function createDefaultMaterial(cache) {
            if (cache['DefaultMaterial'] === undefined) {
                cache['DefaultMaterial'] = new THREE.MeshStandardMaterial({
                    color: 16777215,
                    emissive: 0,
                    metalness: 1,
                    roughness: 1,
                    transparent: false,
                    depthTest: true,
                    side: THREE.FrontSide
                });
            }
            return cache['DefaultMaterial'];
        }
        function addUnknownExtensionsToUserData(knownExtensions, object, objectDef) {
            for (var name in objectDef.extensions) {
                if (knownExtensions[name] === undefined) {
                    object.userData.gltfExtensions = object.userData.gltfExtensions || {};
                    object.userData.gltfExtensions[name] = objectDef.extensions[name];
                }
            }
        }
        function assignExtrasToUserData(object, gltfDef) {
            if (gltfDef.extras !== undefined) {
                if (typeof gltfDef.extras === 'object') {
                    Object.assign(object.userData, gltfDef.extras);
                } else {
                    console.warn('THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras);
                }
            }
        }
        function addMorphTargets(geometry, targets, parser) {
            var hasMorphPosition = false;
            var hasMorphNormal = false;
            for (var i = 0, il = targets.length; i < il; i++) {
                var target = targets[i];
                if (target.POSITION !== undefined)
                    hasMorphPosition = true;
                if (target.NORMAL !== undefined)
                    hasMorphNormal = true;
                if (hasMorphPosition && hasMorphNormal)
                    break;
            }
            if (!hasMorphPosition && !hasMorphNormal)
                return Promise.resolve(geometry);
            var pendingPositionAccessors = [];
            var pendingNormalAccessors = [];
            for (var i = 0, il = targets.length; i < il; i++) {
                var target = targets[i];
                if (hasMorphPosition) {
                    var pendingAccessor = target.POSITION !== undefined ? parser.getDependency('accessor', target.POSITION) : geometry.attributes.position;
                    pendingPositionAccessors.push(pendingAccessor);
                }
                if (hasMorphNormal) {
                    var pendingAccessor = target.NORMAL !== undefined ? parser.getDependency('accessor', target.NORMAL) : geometry.attributes.normal;
                    pendingNormalAccessors.push(pendingAccessor);
                }
            }
            return Promise.all([
                Promise.all(pendingPositionAccessors),
                Promise.all(pendingNormalAccessors)
            ]).then(function (accessors) {
                var morphPositions = accessors[0];
                var morphNormals = accessors[1];
                if (hasMorphPosition)
                    geometry.morphAttributes.position = morphPositions;
                if (hasMorphNormal)
                    geometry.morphAttributes.normal = morphNormals;
                geometry.morphTargetsRelative = true;
                return geometry;
            });
        }
        function updateMorphTargets(mesh, meshDef) {
            mesh.updateMorphTargets();
            if (meshDef.weights !== undefined) {
                for (var i = 0, il = meshDef.weights.length; i < il; i++) {
                    mesh.morphTargetInfluences[i] = meshDef.weights[i];
                }
            }
            if (meshDef.extras && Array.isArray(meshDef.extras.targetNames)) {
                var targetNames = meshDef.extras.targetNames;
                if (mesh.morphTargetInfluences.length === targetNames.length) {
                    mesh.morphTargetDictionary = {};
                    for (var i = 0, il = targetNames.length; i < il; i++) {
                        mesh.morphTargetDictionary[targetNames[i]] = i;
                    }
                } else {
                    console.warn('THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.');
                }
            }
        }
        function createPrimitiveKey(primitiveDef) {
            var dracoExtension = primitiveDef.extensions && primitiveDef.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];
            var geometryKey;
            if (dracoExtension) {
                geometryKey = 'draco:' + dracoExtension.bufferView + ':' + dracoExtension.indices + ':' + createAttributesKey(dracoExtension.attributes);
            } else {
                geometryKey = primitiveDef.indices + ':' + createAttributesKey(primitiveDef.attributes) + ':' + primitiveDef.mode;
            }
            return geometryKey;
        }
        function createAttributesKey(attributes) {
            var attributesKey = '';
            var keys = Object.keys(attributes).sort();
            for (var i = 0, il = keys.length; i < il; i++) {
                attributesKey += keys[i] + ':' + attributes[keys[i]] + ';';
            }
            return attributesKey;
        }
        function GLTFParser(json, extensions, options) {
            this.json = json || {};
            this.extensions = extensions || {};
            this.options = options || {};
            this.cache = new GLTFRegistry();
            this.primitiveCache = {};
            this.textureLoader = new THREE.TextureLoader(this.options.manager);
            this.textureLoader.setCrossOrigin(this.options.crossOrigin);
            this.fileLoader = new THREE.FileLoader(this.options.manager);
            this.fileLoader.setResponseType('arraybuffer');
            if (this.options.crossOrigin === 'use-credentials') {
                this.fileLoader.setWithCredentials(true);
            }
        }
        GLTFParser.prototype.parse = function (onLoad, onError) {
            var parser = this;
            var json = this.json;
            var extensions = this.extensions;
            this.cache.removeAll();
            this.markDefs();
            Promise.all([
                this.getDependencies('scene'),
                this.getDependencies('animation'),
                this.getDependencies('camera')
            ]).then(function (dependencies) {
                var result = {
                    scene: dependencies[0][json.scene || 0],
                    scenes: dependencies[0],
                    animations: dependencies[1],
                    cameras: dependencies[2],
                    asset: json.asset,
                    parser: parser,
                    userData: {}
                };
                addUnknownExtensionsToUserData(extensions, result, json);
                assignExtrasToUserData(result, json);
                onLoad(result);
            }).catch(onError);
        };
        GLTFParser.prototype.markDefs = function () {
            var nodeDefs = this.json.nodes || [];
            var skinDefs = this.json.skins || [];
            var meshDefs = this.json.meshes || [];
            var meshReferences = {};
            var meshUses = {};
            for (var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex++) {
                var joints = skinDefs[skinIndex].joints;
                for (var i = 0, il = joints.length; i < il; i++) {
                    nodeDefs[joints[i]].isBone = true;
                }
            }
            for (var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex++) {
                var nodeDef = nodeDefs[nodeIndex];
                if (nodeDef.mesh !== undefined) {
                    if (meshReferences[nodeDef.mesh] === undefined) {
                        meshReferences[nodeDef.mesh] = meshUses[nodeDef.mesh] = 0;
                    }
                    meshReferences[nodeDef.mesh]++;
                    if (nodeDef.skin !== undefined) {
                        meshDefs[nodeDef.mesh].isSkinnedMesh = true;
                    }
                }
            }
            this.json.meshReferences = meshReferences;
            this.json.meshUses = meshUses;
        };
        GLTFParser.prototype.getDependency = function (type, index) {
            var cacheKey = type + ':' + index;
            var dependency = this.cache.get(cacheKey);
            if (!dependency) {
                switch (type) {
                case 'scene':
                    dependency = this.loadScene(index);
                    break;
                case 'node':
                    dependency = this.loadNode(index);
                    break;
                case 'mesh':
                    dependency = this.loadMesh(index);
                    break;
                case 'accessor':
                    dependency = this.loadAccessor(index);
                    break;
                case 'bufferView':
                    dependency = this.loadBufferView(index);
                    break;
                case 'buffer':
                    dependency = this.loadBuffer(index);
                    break;
                case 'material':
                    dependency = this.loadMaterial(index);
                    break;
                case 'texture':
                    dependency = this.loadTexture(index);
                    break;
                case 'skin':
                    dependency = this.loadSkin(index);
                    break;
                case 'animation':
                    dependency = this.loadAnimation(index);
                    break;
                case 'camera':
                    dependency = this.loadCamera(index);
                    break;
                case 'light':
                    dependency = this.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].loadLight(index);
                    break;
                default:
                    throw new Error('Unknown type: ' + type);
                }
                this.cache.add(cacheKey, dependency);
            }
            return dependency;
        };
        GLTFParser.prototype.getDependencies = function (type) {
            var dependencies = this.cache.get(type);
            if (!dependencies) {
                var parser = this;
                var defs = this.json[type + (type === 'mesh' ? 'es' : 's')] || [];
                dependencies = Promise.all(defs.map(function (def, index) {
                    return parser.getDependency(type, index);
                }));
                this.cache.add(type, dependencies);
            }
            return dependencies;
        };
        GLTFParser.prototype.loadBuffer = function (bufferIndex) {
            var bufferDef = this.json.buffers[bufferIndex];
            var loader = this.fileLoader;
            if (bufferDef.type && bufferDef.type !== 'arraybuffer') {
                throw new Error('THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.');
            }
            if (bufferDef.uri === undefined && bufferIndex === 0) {
                return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);
            }
            var options = this.options;
            return new Promise(function (resolve, reject) {
                loader.load(resolveURL(bufferDef.uri, options.path), resolve, undefined, function () {
                    reject(new Error('THREE.GLTFLoader: Failed to load buffer "' + bufferDef.uri + '".'));
                });
            });
        };
        GLTFParser.prototype.loadBufferView = function (bufferViewIndex) {
            var bufferViewDef = this.json.bufferViews[bufferViewIndex];
            return this.getDependency('buffer', bufferViewDef.buffer).then(function (buffer) {
                var byteLength = bufferViewDef.byteLength || 0;
                var byteOffset = bufferViewDef.byteOffset || 0;
                return buffer.slice(byteOffset, byteOffset + byteLength);
            });
        };
        GLTFParser.prototype.loadAccessor = function (accessorIndex) {
            var parser = this;
            var json = this.json;
            var accessorDef = this.json.accessors[accessorIndex];
            if (accessorDef.bufferView === undefined && accessorDef.sparse === undefined) {
                return Promise.resolve(null);
            }
            var pendingBufferViews = [];
            if (accessorDef.bufferView !== undefined) {
                pendingBufferViews.push(this.getDependency('bufferView', accessorDef.bufferView));
            } else {
                pendingBufferViews.push(null);
            }
            if (accessorDef.sparse !== undefined) {
                pendingBufferViews.push(this.getDependency('bufferView', accessorDef.sparse.indices.bufferView));
                pendingBufferViews.push(this.getDependency('bufferView', accessorDef.sparse.values.bufferView));
            }
            return Promise.all(pendingBufferViews).then(function (bufferViews) {
                var bufferView = bufferViews[0];
                var itemSize = WEBGL_TYPE_SIZES[accessorDef.type];
                var TypedArray = WEBGL_COMPONENT_TYPES[accessorDef.componentType];
                var elementBytes = TypedArray.BYTES_PER_ELEMENT;
                var itemBytes = elementBytes * itemSize;
                var byteOffset = accessorDef.byteOffset || 0;
                var byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[accessorDef.bufferView].byteStride : undefined;
                var normalized = accessorDef.normalized === true;
                var array, bufferAttribute;
                if (byteStride && byteStride !== itemBytes) {
                    var ibSlice = Math.floor(byteOffset / byteStride);
                    var ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;
                    var ib = parser.cache.get(ibCacheKey);
                    if (!ib) {
                        array = new TypedArray(bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes);
                        ib = new THREE.InterleavedBuffer(array, byteStride / elementBytes);
                        parser.cache.add(ibCacheKey, ib);
                    }
                    bufferAttribute = new THREE.InterleavedBufferAttribute(ib, itemSize, byteOffset % byteStride / elementBytes, normalized);
                } else {
                    if (bufferView === null) {
                        array = new TypedArray(accessorDef.count * itemSize);
                    } else {
                        array = new TypedArray(bufferView, byteOffset, accessorDef.count * itemSize);
                    }
                    bufferAttribute = new THREE.BufferAttribute(array, itemSize, normalized);
                }
                if (accessorDef.sparse !== undefined) {
                    var itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;
                    var TypedArrayIndices = WEBGL_COMPONENT_TYPES[accessorDef.sparse.indices.componentType];
                    var byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;
                    var byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;
                    var sparseIndices = new TypedArrayIndices(bufferViews[1], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices);
                    var sparseValues = new TypedArray(bufferViews[2], byteOffsetValues, accessorDef.sparse.count * itemSize);
                    if (bufferView !== null) {
                        bufferAttribute = new THREE.BufferAttribute(bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized);
                    }
                    for (var i = 0, il = sparseIndices.length; i < il; i++) {
                        var index = sparseIndices[i];
                        bufferAttribute.setX(index, sparseValues[i * itemSize]);
                        if (itemSize >= 2)
                            bufferAttribute.setY(index, sparseValues[i * itemSize + 1]);
                        if (itemSize >= 3)
                            bufferAttribute.setZ(index, sparseValues[i * itemSize + 2]);
                        if (itemSize >= 4)
                            bufferAttribute.setW(index, sparseValues[i * itemSize + 3]);
                        if (itemSize >= 5)
                            throw new Error('THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.');
                    }
                }
                return bufferAttribute;
            });
        };
        GLTFParser.prototype.loadTexture = function (textureIndex) {
            var parser = this;
            var json = this.json;
            var options = this.options;
            var textureLoader = this.textureLoader;
            var URL = self.URL || self.webkitURL;
            var textureDef = json.textures[textureIndex];
            var textureExtensions = textureDef.extensions || {};
            var source;
            if (textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]) {
                source = json.images[textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS].source];
            } else {
                source = json.images[textureDef.source];
            }
            var sourceURI = source.uri;
            var isObjectURL = false;
            if (source.bufferView !== undefined) {
                sourceURI = parser.getDependency('bufferView', source.bufferView).then(function (bufferView) {
                    isObjectURL = true;
                    var blob = new Blob([bufferView], { type: source.mimeType });
                    sourceURI = URL.createObjectURL(blob);
                    return sourceURI;
                });
            }
            return Promise.resolve(sourceURI).then(function (sourceURI) {
                var loader = options.manager.getHandler(sourceURI);
                if (!loader) {
                    loader = textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS] ? parser.extensions[EXTENSIONS.MSFT_TEXTURE_DDS].ddsLoader : textureLoader;
                }
                return new Promise(function (resolve, reject) {
                    loader.load(resolveURL(sourceURI, options.path), resolve, undefined, reject);
                });
            }).then(function (texture) {
                if (isObjectURL === true) {
                    URL.revokeObjectURL(sourceURI);
                }
                texture.flipY = false;
                if (textureDef.name)
                    texture.name = textureDef.name;
                if (source.mimeType in MIME_TYPE_FORMATS) {
                    texture.format = MIME_TYPE_FORMATS[source.mimeType];
                }
                var samplers = json.samplers || {};
                var sampler = samplers[textureDef.sampler] || {};
                texture.magFilter = WEBGL_FILTERS[sampler.magFilter] || THREE.LinearFilter;
                texture.minFilter = WEBGL_FILTERS[sampler.minFilter] || THREE.LinearMipmapLinearFilter;
                texture.wrapS = WEBGL_WRAPPINGS[sampler.wrapS] || THREE.RepeatWrapping;
                texture.wrapT = WEBGL_WRAPPINGS[sampler.wrapT] || THREE.RepeatWrapping;
                return texture;
            });
        };
        GLTFParser.prototype.assignTexture = function (materialParams, mapName, mapDef) {
            var parser = this;
            return this.getDependency('texture', mapDef.index).then(function (texture) {
                if (!texture.isCompressedTexture) {
                    switch (mapName) {
                    case 'aoMap':
                    case 'emissiveMap':
                    case 'metalnessMap':
                    case 'normalMap':
                    case 'roughnessMap':
                        texture.format = THREE.RGBFormat;
                        break;
                    }
                }
                if (mapDef.texCoord !== undefined && mapDef.texCoord != 0 && !(mapName === 'aoMap' && mapDef.texCoord == 1)) {
                    console.warn('THREE.GLTFLoader: Custom UV set ' + mapDef.texCoord + ' for texture ' + mapName + ' not yet supported.');
                }
                if (parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]) {
                    var transform = mapDef.extensions !== undefined ? mapDef.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM] : undefined;
                    if (transform) {
                        texture = parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(texture, transform);
                    }
                }
                materialParams[mapName] = texture;
            });
        };
        GLTFParser.prototype.assignFinalMaterial = function (mesh) {
            var geometry = mesh.geometry;
            var material = mesh.material;
            var useVertexTangents = geometry.attributes.tangent !== undefined;
            var useVertexColors = geometry.attributes.color !== undefined;
            var useFlatShading = geometry.attributes.normal === undefined;
            var useSkinning = mesh.isSkinnedMesh === true;
            var useMorphTargets = Object.keys(geometry.morphAttributes).length > 0;
            var useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;
            if (mesh.isPoints) {
                var cacheKey = 'PointsMaterial:' + material.uuid;
                var pointsMaterial = this.cache.get(cacheKey);
                if (!pointsMaterial) {
                    pointsMaterial = new THREE.PointsMaterial();
                    THREE.Material.prototype.copy.call(pointsMaterial, material);
                    pointsMaterial.color.copy(material.color);
                    pointsMaterial.map = material.map;
                    pointsMaterial.sizeAttenuation = false;
                    this.cache.add(cacheKey, pointsMaterial);
                }
                material = pointsMaterial;
            } else if (mesh.isLine) {
                var cacheKey = 'LineBasicMaterial:' + material.uuid;
                var lineMaterial = this.cache.get(cacheKey);
                if (!lineMaterial) {
                    lineMaterial = new THREE.LineBasicMaterial();
                    THREE.Material.prototype.copy.call(lineMaterial, material);
                    lineMaterial.color.copy(material.color);
                    this.cache.add(cacheKey, lineMaterial);
                }
                material = lineMaterial;
            }
            if (useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets) {
                var cacheKey = 'ClonedMaterial:' + material.uuid + ':';
                if (material.isGLTFSpecularGlossinessMaterial)
                    cacheKey += 'specular-glossiness:';
                if (useSkinning)
                    cacheKey += 'skinning:';
                if (useVertexTangents)
                    cacheKey += 'vertex-tangents:';
                if (useVertexColors)
                    cacheKey += 'vertex-colors:';
                if (useFlatShading)
                    cacheKey += 'flat-shading:';
                if (useMorphTargets)
                    cacheKey += 'morph-targets:';
                if (useMorphNormals)
                    cacheKey += 'morph-normals:';
                var cachedMaterial = this.cache.get(cacheKey);
                if (!cachedMaterial) {
                    cachedMaterial = material.clone();
                    if (useSkinning)
                        cachedMaterial.skinning = true;
                    if (useVertexTangents)
                        cachedMaterial.vertexTangents = true;
                    if (useVertexColors)
                        cachedMaterial.vertexColors = true;
                    if (useFlatShading)
                        cachedMaterial.flatShading = true;
                    if (useMorphTargets)
                        cachedMaterial.morphTargets = true;
                    if (useMorphNormals)
                        cachedMaterial.morphNormals = true;
                    this.cache.add(cacheKey, cachedMaterial);
                }
                material = cachedMaterial;
            }
            if (material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined) {
                geometry.setAttribute('uv2', new THREE.BufferAttribute(geometry.attributes.uv.array, 2));
            }
            if (material.normalScale && !useVertexTangents) {
                material.normalScale.y = -material.normalScale.y;
            }
            if (material.clearcoatNormalScale && !useVertexTangents) {
                material.clearcoatNormalScale.y = -material.clearcoatNormalScale.y;
            }
            mesh.material = material;
        };
        GLTFParser.prototype.loadMaterial = function (materialIndex) {
            var parser = this;
            var json = this.json;
            var extensions = this.extensions;
            var materialDef = json.materials[materialIndex];
            var materialType;
            var materialParams = {};
            var materialExtensions = materialDef.extensions || {};
            var pending = [];
            if (materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {
                var sgExtension = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];
                materialType = sgExtension.getMaterialType();
                pending.push(sgExtension.extendParams(materialParams, materialDef, parser));
            } else if (materialExtensions[EXTENSIONS.KHR_MATERIALS_UNLIT]) {
                var kmuExtension = extensions[EXTENSIONS.KHR_MATERIALS_UNLIT];
                materialType = kmuExtension.getMaterialType();
                pending.push(kmuExtension.extendParams(materialParams, materialDef, parser));
            } else {
                materialType = THREE.MeshStandardMaterial;
                var metallicRoughness = materialDef.pbrMetallicRoughness || {};
                materialParams.color = new THREE.Color(1, 1, 1);
                materialParams.opacity = 1;
                if (Array.isArray(metallicRoughness.baseColorFactor)) {
                    var array = metallicRoughness.baseColorFactor;
                    materialParams.color.fromArray(array);
                    materialParams.opacity = array[3];
                }
                if (metallicRoughness.baseColorTexture !== undefined) {
                    pending.push(parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture));
                }
                materialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1;
                materialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1;
                if (metallicRoughness.metallicRoughnessTexture !== undefined) {
                    pending.push(parser.assignTexture(materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture));
                    pending.push(parser.assignTexture(materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture));
                }
            }
            if (materialDef.doubleSided === true) {
                materialParams.side = THREE.DoubleSide;
            }
            var alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;
            if (alphaMode === ALPHA_MODES.BLEND) {
                materialParams.transparent = true;
                materialParams.depthWrite = false;
            } else {
                materialParams.transparent = false;
                if (alphaMode === ALPHA_MODES.MASK) {
                    materialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;
                }
            }
            if (materialDef.normalTexture !== undefined && materialType !== THREE.MeshBasicMaterial) {
                pending.push(parser.assignTexture(materialParams, 'normalMap', materialDef.normalTexture));
                materialParams.normalScale = new THREE.Vector2(1, 1);
                if (materialDef.normalTexture.scale !== undefined) {
                    materialParams.normalScale.set(materialDef.normalTexture.scale, materialDef.normalTexture.scale);
                }
            }
            if (materialDef.occlusionTexture !== undefined && materialType !== THREE.MeshBasicMaterial) {
                pending.push(parser.assignTexture(materialParams, 'aoMap', materialDef.occlusionTexture));
                if (materialDef.occlusionTexture.strength !== undefined) {
                    materialParams.aoMapIntensity = materialDef.occlusionTexture.strength;
                }
            }
            if (materialDef.emissiveFactor !== undefined && materialType !== THREE.MeshBasicMaterial) {
                materialParams.emissive = new THREE.Color().fromArray(materialDef.emissiveFactor);
            }
            if (materialDef.emissiveTexture !== undefined && materialType !== THREE.MeshBasicMaterial) {
                pending.push(parser.assignTexture(materialParams, 'emissiveMap', materialDef.emissiveTexture));
            }
            if (materialExtensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT]) {
                var clearcoatExtension = extensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT];
                materialType = clearcoatExtension.getMaterialType();
                pending.push(clearcoatExtension.extendParams(materialParams, { extensions: materialExtensions }, parser));
            }
            return Promise.all(pending).then(function () {
                var material;
                if (materialType === GLTFMeshStandardSGMaterial) {
                    material = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(materialParams);
                } else {
                    material = new materialType(materialParams);
                }
                if (materialDef.name)
                    material.name = materialDef.name;
                if (material.map)
                    material.map.encoding = THREE.sRGBEncoding;
                if (material.emissiveMap)
                    material.emissiveMap.encoding = THREE.sRGBEncoding;
                assignExtrasToUserData(material, materialDef);
                if (materialDef.extensions)
                    addUnknownExtensionsToUserData(extensions, material, materialDef);
                return material;
            });
        };
        function computeBounds(geometry, primitiveDef, parser) {
            var attributes = primitiveDef.attributes;
            var box = new THREE.Box3();
            if (attributes.POSITION !== undefined) {
                var accessor = parser.json.accessors[attributes.POSITION];
                var min = accessor.min;
                var max = accessor.max;
                if (min !== undefined && max !== undefined) {
                    box.set(new THREE.Vector3(min[0], min[1], min[2]), new THREE.Vector3(max[0], max[1], max[2]));
                } else {
                    console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');
                    return;
                }
            } else {
                return;
            }
            var targets = primitiveDef.targets;
            if (targets !== undefined) {
                var maxDisplacement = new THREE.Vector3();
                var vector = new THREE.Vector3();
                for (var i = 0, il = targets.length; i < il; i++) {
                    var target = targets[i];
                    if (target.POSITION !== undefined) {
                        var accessor = parser.json.accessors[target.POSITION];
                        var min = accessor.min;
                        var max = accessor.max;
                        if (min !== undefined && max !== undefined) {
                            vector.setX(Math.max(Math.abs(min[0]), Math.abs(max[0])));
                            vector.setY(Math.max(Math.abs(min[1]), Math.abs(max[1])));
                            vector.setZ(Math.max(Math.abs(min[2]), Math.abs(max[2])));
                            maxDisplacement.max(vector);
                        } else {
                            console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');
                        }
                    }
                }
                box.expandByVector(maxDisplacement);
            }
            geometry.boundingBox = box;
            var sphere = new THREE.Sphere();
            box.getCenter(sphere.center);
            sphere.radius = box.min.distanceTo(box.max) / 2;
            geometry.boundingSphere = sphere;
        }
        function addPrimitiveAttributes(geometry, primitiveDef, parser) {
            var attributes = primitiveDef.attributes;
            var pending = [];
            function assignAttributeAccessor(accessorIndex, attributeName) {
                return parser.getDependency('accessor', accessorIndex).then(function (accessor) {
                    geometry.setAttribute(attributeName, accessor);
                });
            }
            for (var gltfAttributeName in attributes) {
                var threeAttributeName = ATTRIBUTES[gltfAttributeName] || gltfAttributeName.toLowerCase();
                if (threeAttributeName in geometry.attributes)
                    continue;
                pending.push(assignAttributeAccessor(attributes[gltfAttributeName], threeAttributeName));
            }
            if (primitiveDef.indices !== undefined && !geometry.index) {
                var accessor = parser.getDependency('accessor', primitiveDef.indices).then(function (accessor) {
                    geometry.setIndex(accessor);
                });
                pending.push(accessor);
            }
            assignExtrasToUserData(geometry, primitiveDef);
            computeBounds(geometry, primitiveDef, parser);
            return Promise.all(pending).then(function () {
                return primitiveDef.targets !== undefined ? addMorphTargets(geometry, primitiveDef.targets, parser) : geometry;
            });
        }
        function toTrianglesDrawMode(geometry, drawMode) {
            var index = geometry.getIndex();
            if (index === null) {
                var indices = [];
                var position = geometry.getAttribute('position');
                if (position !== undefined) {
                    for (var i = 0; i < position.count; i++) {
                        indices.push(i);
                    }
                    geometry.setIndex(indices);
                    index = geometry.getIndex();
                } else {
                    console.error('THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.');
                    return geometry;
                }
            }
            var numberOfTriangles = index.count - 2;
            var newIndices = [];
            if (drawMode === THREE.TriangleFanDrawMode) {
                for (var i = 1; i <= numberOfTriangles; i++) {
                    newIndices.push(index.getX(0));
                    newIndices.push(index.getX(i));
                    newIndices.push(index.getX(i + 1));
                }
            } else {
                for (var i = 0; i < numberOfTriangles; i++) {
                    if (i % 2 === 0) {
                        newIndices.push(index.getX(i));
                        newIndices.push(index.getX(i + 1));
                        newIndices.push(index.getX(i + 2));
                    } else {
                        newIndices.push(index.getX(i + 2));
                        newIndices.push(index.getX(i + 1));
                        newIndices.push(index.getX(i));
                    }
                }
            }
            if (newIndices.length / 3 !== numberOfTriangles) {
                console.error('THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.');
            }
            var newGeometry = geometry.clone();
            newGeometry.setIndex(newIndices);
            return newGeometry;
        }
        GLTFParser.prototype.loadGeometries = function (primitives) {
            var parser = this;
            var extensions = this.extensions;
            var cache = this.primitiveCache;
            function createDracoPrimitive(primitive) {
                return extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(primitive, parser).then(function (geometry) {
                    return addPrimitiveAttributes(geometry, primitive, parser);
                });
            }
            var pending = [];
            for (var i = 0, il = primitives.length; i < il; i++) {
                var primitive = primitives[i];
                var cacheKey = createPrimitiveKey(primitive);
                var cached = cache[cacheKey];
                if (cached) {
                    pending.push(cached.promise);
                } else {
                    var geometryPromise;
                    if (primitive.extensions && primitive.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]) {
                        geometryPromise = createDracoPrimitive(primitive);
                    } else {
                        geometryPromise = addPrimitiveAttributes(new THREE.BufferGeometry(), primitive, parser);
                    }
                    cache[cacheKey] = {
                        primitive: primitive,
                        promise: geometryPromise
                    };
                    pending.push(geometryPromise);
                }
            }
            return Promise.all(pending);
        };
        GLTFParser.prototype.loadMesh = function (meshIndex) {
            var parser = this;
            var json = this.json;
            var meshDef = json.meshes[meshIndex];
            var primitives = meshDef.primitives;
            var pending = [];
            for (var i = 0, il = primitives.length; i < il; i++) {
                var material = primitives[i].material === undefined ? createDefaultMaterial(this.cache) : this.getDependency('material', primitives[i].material);
                pending.push(material);
            }
            pending.push(parser.loadGeometries(primitives));
            return Promise.all(pending).then(function (results) {
                var materials = results.slice(0, results.length - 1);
                var geometries = results[results.length - 1];
                var meshes = [];
                for (var i = 0, il = geometries.length; i < il; i++) {
                    var geometry = geometries[i];
                    var primitive = primitives[i];
                    var mesh;
                    var material = materials[i];
                    if (primitive.mode === WEBGL_CONSTANTS.TRIANGLES || primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP || primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN || primitive.mode === undefined) {
                        mesh = meshDef.isSkinnedMesh === true ? new THREE.SkinnedMesh(geometry, material) : new THREE.Mesh(geometry, material);
                        if (mesh.isSkinnedMesh === true && !mesh.geometry.attributes.skinWeight.normalized) {
                            mesh.normalizeSkinWeights();
                        }
                        if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP) {
                            mesh.geometry = toTrianglesDrawMode(mesh.geometry, THREE.TriangleStripDrawMode);
                        } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN) {
                            mesh.geometry = toTrianglesDrawMode(mesh.geometry, THREE.TriangleFanDrawMode);
                        }
                    } else if (primitive.mode === WEBGL_CONSTANTS.LINES) {
                        mesh = new THREE.LineSegments(geometry, material);
                    } else if (primitive.mode === WEBGL_CONSTANTS.LINE_STRIP) {
                        mesh = new THREE.Line(geometry, material);
                    } else if (primitive.mode === WEBGL_CONSTANTS.LINE_LOOP) {
                        mesh = new THREE.LineLoop(geometry, material);
                    } else if (primitive.mode === WEBGL_CONSTANTS.POINTS) {
                        mesh = new THREE.Points(geometry, material);
                    } else {
                        throw new Error('THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode);
                    }
                    if (Object.keys(mesh.geometry.morphAttributes).length > 0) {
                        updateMorphTargets(mesh, meshDef);
                    }
                    mesh.name = meshDef.name || 'mesh_' + meshIndex;
                    if (geometries.length > 1)
                        mesh.name += '_' + i;
                    assignExtrasToUserData(mesh, meshDef);
                    parser.assignFinalMaterial(mesh);
                    meshes.push(mesh);
                }
                if (meshes.length === 1) {
                    return meshes[0];
                }
                var group = new THREE.Group();
                for (var i = 0, il = meshes.length; i < il; i++) {
                    group.add(meshes[i]);
                }
                return group;
            });
        };
        GLTFParser.prototype.loadCamera = function (cameraIndex) {
            var camera;
            var cameraDef = this.json.cameras[cameraIndex];
            var params = cameraDef[cameraDef.type];
            if (!params) {
                console.warn('THREE.GLTFLoader: Missing camera parameters.');
                return;
            }
            if (cameraDef.type === 'perspective') {
                camera = new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(params.yfov), params.aspectRatio || 1, params.znear || 1, params.zfar || 2000000);
            } else if (cameraDef.type === 'orthographic') {
                camera = new THREE.OrthographicCamera(params.xmag / -2, params.xmag / 2, params.ymag / 2, params.ymag / -2, params.znear, params.zfar);
            }
            if (cameraDef.name)
                camera.name = cameraDef.name;
            assignExtrasToUserData(camera, cameraDef);
            return Promise.resolve(camera);
        };
        GLTFParser.prototype.loadSkin = function (skinIndex) {
            var skinDef = this.json.skins[skinIndex];
            var skinEntry = { joints: skinDef.joints };
            if (skinDef.inverseBindMatrices === undefined) {
                return Promise.resolve(skinEntry);
            }
            return this.getDependency('accessor', skinDef.inverseBindMatrices).then(function (accessor) {
                skinEntry.inverseBindMatrices = accessor;
                return skinEntry;
            });
        };
        GLTFParser.prototype.loadAnimation = function (animationIndex) {
            var json = this.json;
            var animationDef = json.animations[animationIndex];
            var pendingNodes = [];
            var pendingInputAccessors = [];
            var pendingOutputAccessors = [];
            var pendingSamplers = [];
            var pendingTargets = [];
            for (var i = 0, il = animationDef.channels.length; i < il; i++) {
                var channel = animationDef.channels[i];
                var sampler = animationDef.samplers[channel.sampler];
                var target = channel.target;
                var name = target.node !== undefined ? target.node : target.id;
                var input = animationDef.parameters !== undefined ? animationDef.parameters[sampler.input] : sampler.input;
                var output = animationDef.parameters !== undefined ? animationDef.parameters[sampler.output] : sampler.output;
                pendingNodes.push(this.getDependency('node', name));
                pendingInputAccessors.push(this.getDependency('accessor', input));
                pendingOutputAccessors.push(this.getDependency('accessor', output));
                pendingSamplers.push(sampler);
                pendingTargets.push(target);
            }
            return Promise.all([
                Promise.all(pendingNodes),
                Promise.all(pendingInputAccessors),
                Promise.all(pendingOutputAccessors),
                Promise.all(pendingSamplers),
                Promise.all(pendingTargets)
            ]).then(function (dependencies) {
                var nodes = dependencies[0];
                var inputAccessors = dependencies[1];
                var outputAccessors = dependencies[2];
                var samplers = dependencies[3];
                var targets = dependencies[4];
                var tracks = [];
                for (var i = 0, il = nodes.length; i < il; i++) {
                    var node = nodes[i];
                    var inputAccessor = inputAccessors[i];
                    var outputAccessor = outputAccessors[i];
                    var sampler = samplers[i];
                    var target = targets[i];
                    if (node === undefined)
                        continue;
                    node.updateMatrix();
                    node.matrixAutoUpdate = true;
                    var TypedKeyframeTrack;
                    switch (PATH_PROPERTIES[target.path]) {
                    case PATH_PROPERTIES.weights:
                        TypedKeyframeTrack = THREE.NumberKeyframeTrack;
                        break;
                    case PATH_PROPERTIES.rotation:
                        TypedKeyframeTrack = THREE.QuaternionKeyframeTrack;
                        break;
                    case PATH_PROPERTIES.position:
                    case PATH_PROPERTIES.scale:
                    default:
                        TypedKeyframeTrack = THREE.VectorKeyframeTrack;
                        break;
                    }
                    var targetName = node.name ? node.name : node.uuid;
                    var interpolation = sampler.interpolation !== undefined ? INTERPOLATION[sampler.interpolation] : THREE.InterpolateLinear;
                    var targetNames = [];
                    if (PATH_PROPERTIES[target.path] === PATH_PROPERTIES.weights) {
                        node.traverse(function (object) {
                            if (object.isMesh === true && object.morphTargetInfluences) {
                                targetNames.push(object.name ? object.name : object.uuid);
                            }
                        });
                    } else {
                        targetNames.push(targetName);
                    }
                    var outputArray = outputAccessor.array;
                    if (outputAccessor.normalized) {
                        var scale;
                        if (outputArray.constructor === Int8Array) {
                            scale = 1 / 127;
                        } else if (outputArray.constructor === Uint8Array) {
                            scale = 1 / 255;
                        } else if (outputArray.constructor == Int16Array) {
                            scale = 1 / 32767;
                        } else if (outputArray.constructor === Uint16Array) {
                            scale = 1 / 65535;
                        } else {
                            throw new Error('THREE.GLTFLoader: Unsupported output accessor component type.');
                        }
                        var scaled = new Float32Array(outputArray.length);
                        for (var j = 0, jl = outputArray.length; j < jl; j++) {
                            scaled[j] = outputArray[j] * scale;
                        }
                        outputArray = scaled;
                    }
                    for (var j = 0, jl = targetNames.length; j < jl; j++) {
                        var track = new TypedKeyframeTrack(targetNames[j] + '.' + PATH_PROPERTIES[target.path], inputAccessor.array, outputArray, interpolation);
                        if (sampler.interpolation === 'CUBICSPLINE') {
                            track.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline(result) {
                                return new GLTFCubicSplineInterpolant(this.times, this.values, this.getValueSize() / 3, result);
                            };
                            track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;
                        }
                        tracks.push(track);
                    }
                }
                var name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;
                return new THREE.AnimationClip(name, undefined, tracks);
            });
        };
        GLTFParser.prototype.loadNode = function (nodeIndex) {
            var json = this.json;
            var extensions = this.extensions;
            var parser = this;
            var meshReferences = json.meshReferences;
            var meshUses = json.meshUses;
            var nodeDef = json.nodes[nodeIndex];
            return function () {
                var pending = [];
                if (nodeDef.mesh !== undefined) {
                    pending.push(parser.getDependency('mesh', nodeDef.mesh).then(function (mesh) {
                        var node;
                        if (meshReferences[nodeDef.mesh] > 1) {
                            var instanceNum = meshUses[nodeDef.mesh]++;
                            node = mesh.clone();
                            node.name += '_instance_' + instanceNum;
                        } else {
                            node = mesh;
                        }
                        if (nodeDef.weights !== undefined) {
                            node.traverse(function (o) {
                                if (!o.isMesh)
                                    return;
                                for (var i = 0, il = nodeDef.weights.length; i < il; i++) {
                                    o.morphTargetInfluences[i] = nodeDef.weights[i];
                                }
                            });
                        }
                        return node;
                    }));
                }
                if (nodeDef.camera !== undefined) {
                    pending.push(parser.getDependency('camera', nodeDef.camera));
                }
                if (nodeDef.extensions && nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL] && nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light !== undefined) {
                    pending.push(parser.getDependency('light', nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light));
                }
                return Promise.all(pending);
            }().then(function (objects) {
                var node;
                if (nodeDef.isBone === true) {
                    node = new THREE.Bone();
                } else if (objects.length > 1) {
                    node = new THREE.Group();
                } else if (objects.length === 1) {
                    node = objects[0];
                } else {
                    node = new THREE.Object3D();
                }
                if (node !== objects[0]) {
                    for (var i = 0, il = objects.length; i < il; i++) {
                        node.add(objects[i]);
                    }
                }
                if (nodeDef.name) {
                    node.userData.name = nodeDef.name;
                    node.name = THREE.PropertyBinding.sanitizeNodeName(nodeDef.name);
                }
                assignExtrasToUserData(node, nodeDef);
                if (nodeDef.extensions)
                    addUnknownExtensionsToUserData(extensions, node, nodeDef);
                if (nodeDef.matrix !== undefined) {
                    var matrix = new THREE.Matrix4();
                    matrix.fromArray(nodeDef.matrix);
                    node.applyMatrix4(matrix);
                } else {
                    if (nodeDef.translation !== undefined) {
                        node.position.fromArray(nodeDef.translation);
                    }
                    if (nodeDef.rotation !== undefined) {
                        node.quaternion.fromArray(nodeDef.rotation);
                    }
                    if (nodeDef.scale !== undefined) {
                        node.scale.fromArray(nodeDef.scale);
                    }
                }
                return node;
            });
        };
        GLTFParser.prototype.loadScene = function () {
            function buildNodeHierachy(nodeId, parentObject, json, parser) {
                var nodeDef = json.nodes[nodeId];
                return parser.getDependency('node', nodeId).then(function (node) {
                    if (nodeDef.skin === undefined)
                        return node;
                    var skinEntry;
                    return parser.getDependency('skin', nodeDef.skin).then(function (skin) {
                        skinEntry = skin;
                        var pendingJoints = [];
                        for (var i = 0, il = skinEntry.joints.length; i < il; i++) {
                            pendingJoints.push(parser.getDependency('node', skinEntry.joints[i]));
                        }
                        return Promise.all(pendingJoints);
                    }).then(function (jointNodes) {
                        node.traverse(function (mesh) {
                            if (!mesh.isMesh)
                                return;
                            var bones = [];
                            var boneInverses = [];
                            for (var j = 0, jl = jointNodes.length; j < jl; j++) {
                                var jointNode = jointNodes[j];
                                if (jointNode) {
                                    bones.push(jointNode);
                                    var mat = new THREE.Matrix4();
                                    if (skinEntry.inverseBindMatrices !== undefined) {
                                        mat.fromArray(skinEntry.inverseBindMatrices.array, j * 16);
                                    }
                                    boneInverses.push(mat);
                                } else {
                                    console.warn('THREE.GLTFLoader: Joint "%s" could not be found.', skinEntry.joints[j]);
                                }
                            }
                            mesh.bind(new THREE.Skeleton(bones, boneInverses), mesh.matrixWorld);
                        });
                        return node;
                    });
                }).then(function (node) {
                    parentObject.add(node);
                    var pending = [];
                    if (nodeDef.children) {
                        var children = nodeDef.children;
                        for (var i = 0, il = children.length; i < il; i++) {
                            var child = children[i];
                            pending.push(buildNodeHierachy(child, node, json, parser));
                        }
                    }
                    return Promise.all(pending);
                });
            }
            return function loadScene(sceneIndex) {
                var json = this.json;
                var extensions = this.extensions;
                var sceneDef = this.json.scenes[sceneIndex];
                var parser = this;
                var scene = new THREE.Group();
                if (sceneDef.name)
                    scene.name = sceneDef.name;
                assignExtrasToUserData(scene, sceneDef);
                if (sceneDef.extensions)
                    addUnknownExtensionsToUserData(extensions, scene, sceneDef);
                var nodeIds = sceneDef.nodes || [];
                var pending = [];
                for (var i = 0, il = nodeIds.length; i < il; i++) {
                    pending.push(buildNodeHierachy(nodeIds[i], scene, json, parser));
                }
                return Promise.all(pending).then(function () {
                    return scene;
                });
            };
        }();
        return GLTFLoader;
    }();
    
    return threex.loaders.GLTFLoader = GLTFLoader;
});
define('skylark-threejs-ex/loaders/MTLLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var MTLLoader = function (manager) {
        THREE.Loader.call(this, manager);
    };
    MTLLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: MTLLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var path = this.path === '' ? THREE.LoaderUtils.extractUrlBase(url) : this.path;
            var loader = new THREE.FileLoader(this.manager);
            loader.setPath(this.path);
            loader.load(url, function (text) {
                onLoad(scope.parse(text, path));
            }, onProgress, onError);
        },
        setMaterialOptions: function (value) {
            this.materialOptions = value;
            return this;
        },
        parse: function (text, path) {
            var lines = text.split('\n');
            var info = {};
            var delimiter_pattern = /\s+/;
            var materialsInfo = {};
            for (var i = 0; i < lines.length; i++) {
                var line = lines[i];
                line = line.trim();
                if (line.length === 0 || line.charAt(0) === '#') {
                    continue;
                }
                var pos = line.indexOf(' ');
                var key = pos >= 0 ? line.substring(0, pos) : line;
                key = key.toLowerCase();
                var value = pos >= 0 ? line.substring(pos + 1) : '';
                value = value.trim();
                if (key === 'newmtl') {
                    info = { name: value };
                    materialsInfo[value] = info;
                } else {
                    if (key === 'ka' || key === 'kd' || key === 'ks' || key === 'ke') {
                        var ss = value.split(delimiter_pattern, 3);
                        info[key] = [
                            parseFloat(ss[0]),
                            parseFloat(ss[1]),
                            parseFloat(ss[2])
                        ];
                    } else {
                        info[key] = value;
                    }
                }
            }
            var materialCreator = new MTLLoader.MaterialCreator(this.resourcePath || path, this.materialOptions);
            materialCreator.setCrossOrigin(this.crossOrigin);
            materialCreator.setManager(this.manager);
            materialCreator.setMaterials(materialsInfo);
            return materialCreator;
        }
    });
    MTLLoader.MaterialCreator = function (baseUrl, options) {
        this.baseUrl = baseUrl || '';
        this.options = options;
        this.materialsInfo = {};
        this.materials = {};
        this.materialsArray = [];
        this.nameLookup = {};
        this.side = this.options && this.options.side ? this.options.side : THREE.FrontSide;
        this.wrap = this.options && this.options.wrap ? this.options.wrap : THREE.RepeatWrapping;
    };
    MTLLoader.MaterialCreator.prototype = {
        constructor: MTLLoader.MaterialCreator,
        crossOrigin: 'anonymous',
        setCrossOrigin: function (value) {
            this.crossOrigin = value;
            return this;
        },
        setManager: function (value) {
            this.manager = value;
        },
        setMaterials: function (materialsInfo) {
            this.materialsInfo = this.convert(materialsInfo);
            this.materials = {};
            this.materialsArray = [];
            this.nameLookup = {};
        },
        convert: function (materialsInfo) {
            if (!this.options)
                return materialsInfo;
            var converted = {};
            for (var mn in materialsInfo) {
                var mat = materialsInfo[mn];
                var covmat = {};
                converted[mn] = covmat;
                for (var prop in mat) {
                    var save = true;
                    var value = mat[prop];
                    var lprop = prop.toLowerCase();
                    switch (lprop) {
                    case 'kd':
                    case 'ka':
                    case 'ks':
                        if (this.options && this.options.normalizeRGB) {
                            value = [
                                value[0] / 255,
                                value[1] / 255,
                                value[2] / 255
                            ];
                        }
                        if (this.options && this.options.ignoreZeroRGBs) {
                            if (value[0] === 0 && value[1] === 0 && value[2] === 0) {
                                save = false;
                            }
                        }
                        break;
                    default:
                        break;
                    }
                    if (save) {
                        covmat[lprop] = value;
                    }
                }
            }
            return converted;
        },
        preload: function () {
            for (var mn in this.materialsInfo) {
                this.create(mn);
            }
        },
        getIndex: function (materialName) {
            return this.nameLookup[materialName];
        },
        getAsArray: function () {
            var index = 0;
            for (var mn in this.materialsInfo) {
                this.materialsArray[index] = this.create(mn);
                this.nameLookup[mn] = index;
                index++;
            }
            return this.materialsArray;
        },
        create: function (materialName) {
            if (this.materials[materialName] === undefined) {
                this.createMaterial_(materialName);
            }
            return this.materials[materialName];
        },
        createMaterial_: function (materialName) {
            var scope = this;
            var mat = this.materialsInfo[materialName];
            var params = {
                name: materialName,
                side: this.side
            };
            function resolveURL(baseUrl, url) {
                if (typeof url !== 'string' || url === '')
                    return '';
                if (/^https?:\/\//i.test(url))
                    return url;
                return baseUrl + url;
            }
            function setMapForType(mapType, value) {
                if (params[mapType])
                    return;
                var texParams = scope.getTextureParams(value, params);
                var map = scope.loadTexture(resolveURL(scope.baseUrl, texParams.url));
                map.repeat.copy(texParams.scale);
                map.offset.copy(texParams.offset);
                map.wrapS = scope.wrap;
                map.wrapT = scope.wrap;
                params[mapType] = map;
            }
            for (var prop in mat) {
                var value = mat[prop];
                var n;
                if (value === '')
                    continue;
                switch (prop.toLowerCase()) {
                case 'kd':
                    params.color = new THREE.Color().fromArray(value);
                    break;
                case 'ks':
                    params.specular = new THREE.Color().fromArray(value);
                    break;
                case 'ke':
                    params.emissive = new THREE.Color().fromArray(value);
                    break;
                case 'map_kd':
                    setMapForType('map', value);
                    break;
                case 'map_ks':
                    setMapForType('specularMap', value);
                    break;
                case 'map_ke':
                    setMapForType('emissiveMap', value);
                    break;
                case 'norm':
                    setMapForType('normalMap', value);
                    break;
                case 'map_bump':
                case 'bump':
                    setMapForType('bumpMap', value);
                    break;
                case 'map_d':
                    setMapForType('alphaMap', value);
                    params.transparent = true;
                    break;
                case 'ns':
                    params.shininess = parseFloat(value);
                    break;
                case 'd':
                    n = parseFloat(value);
                    if (n < 1) {
                        params.opacity = n;
                        params.transparent = true;
                    }
                    break;
                case 'tr':
                    n = parseFloat(value);
                    if (this.options && this.options.invertTrProperty)
                        n = 1 - n;
                    if (n > 0) {
                        params.opacity = 1 - n;
                        params.transparent = true;
                    }
                    break;
                default:
                    break;
                }
            }
            this.materials[materialName] = new THREE.MeshPhongMaterial(params);
            return this.materials[materialName];
        },
        getTextureParams: function (value, matParams) {
            var texParams = {
                scale: new THREE.Vector2(1, 1),
                offset: new THREE.Vector2(0, 0)
            };
            var items = value.split(/\s+/);
            var pos;
            pos = items.indexOf('-bm');
            if (pos >= 0) {
                matParams.bumpScale = parseFloat(items[pos + 1]);
                items.splice(pos, 2);
            }
            pos = items.indexOf('-s');
            if (pos >= 0) {
                texParams.scale.set(parseFloat(items[pos + 1]), parseFloat(items[pos + 2]));
                items.splice(pos, 4);
            }
            pos = items.indexOf('-o');
            if (pos >= 0) {
                texParams.offset.set(parseFloat(items[pos + 1]), parseFloat(items[pos + 2]));
                items.splice(pos, 4);
            }
            texParams.url = items.join(' ').trim();
            return texParams;
        },
        loadTexture: function (url, mapping, onLoad, onProgress, onError) {
            var texture;
            var manager = this.manager !== undefined ? this.manager : THREE.DefaultLoadingManager;
            var loader = manager.getHandler(url);
            if (loader === null) {
                loader = new THREE.TextureLoader(manager);
            }
            if (loader.setCrossOrigin)
                loader.setCrossOrigin(this.crossOrigin);
            texture = loader.load(url, onLoad, onProgress, onError);
            if (mapping !== undefined)
                texture.mapping = mapping;
            return texture;
        }
    };
    return threex.loaders.MTLLoader = MTLLoader;
});
define('skylark-threejs-ex/loaders/OBJLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var OBJLoader = function () {
        var object_pattern = /^[og]\s*(.+)?/;
        var material_library_pattern = /^mtllib /;
        var material_use_pattern = /^usemtl /;
        var map_use_pattern = /^usemap /;
        function ParserState() {
            var state = {
                objects: [],
                object: {},
                vertices: [],
                normals: [],
                colors: [],
                uvs: [],
                materials: {},
                materialLibraries: [],
                startObject: function (name, fromDeclaration) {
                    if (this.object && this.object.fromDeclaration === false) {
                        this.object.name = name;
                        this.object.fromDeclaration = fromDeclaration !== false;
                        return;
                    }
                    var previousMaterial = this.object && typeof this.object.currentMaterial === 'function' ? this.object.currentMaterial() : undefined;
                    if (this.object && typeof this.object._finalize === 'function') {
                        this.object._finalize(true);
                    }
                    this.object = {
                        name: name || '',
                        fromDeclaration: fromDeclaration !== false,
                        geometry: {
                            vertices: [],
                            normals: [],
                            colors: [],
                            uvs: []
                        },
                        materials: [],
                        smooth: true,
                        startMaterial: function (name, libraries) {
                            var previous = this._finalize(false);
                            if (previous && (previous.inherited || previous.groupCount <= 0)) {
                                this.materials.splice(previous.index, 1);
                            }
                            var material = {
                                index: this.materials.length,
                                name: name || '',
                                mtllib: Array.isArray(libraries) && libraries.length > 0 ? libraries[libraries.length - 1] : '',
                                smooth: previous !== undefined ? previous.smooth : this.smooth,
                                groupStart: previous !== undefined ? previous.groupEnd : 0,
                                groupEnd: -1,
                                groupCount: -1,
                                inherited: false,
                                clone: function (index) {
                                    var cloned = {
                                        index: typeof index === 'number' ? index : this.index,
                                        name: this.name,
                                        mtllib: this.mtllib,
                                        smooth: this.smooth,
                                        groupStart: 0,
                                        groupEnd: -1,
                                        groupCount: -1,
                                        inherited: false
                                    };
                                    cloned.clone = this.clone.bind(cloned);
                                    return cloned;
                                }
                            };
                            this.materials.push(material);
                            return material;
                        },
                        currentMaterial: function () {
                            if (this.materials.length > 0) {
                                return this.materials[this.materials.length - 1];
                            }
                            return undefined;
                        },
                        _finalize: function (end) {
                            var lastMultiMaterial = this.currentMaterial();
                            if (lastMultiMaterial && lastMultiMaterial.groupEnd === -1) {
                                lastMultiMaterial.groupEnd = this.geometry.vertices.length / 3;
                                lastMultiMaterial.groupCount = lastMultiMaterial.groupEnd - lastMultiMaterial.groupStart;
                                lastMultiMaterial.inherited = false;
                            }
                            if (end && this.materials.length > 1) {
                                for (var mi = this.materials.length - 1; mi >= 0; mi--) {
                                    if (this.materials[mi].groupCount <= 0) {
                                        this.materials.splice(mi, 1);
                                    }
                                }
                            }
                            if (end && this.materials.length === 0) {
                                this.materials.push({
                                    name: '',
                                    smooth: this.smooth
                                });
                            }
                            return lastMultiMaterial;
                        }
                    };
                    if (previousMaterial && previousMaterial.name && typeof previousMaterial.clone === 'function') {
                        var declared = previousMaterial.clone(0);
                        declared.inherited = true;
                        this.object.materials.push(declared);
                    }
                    this.objects.push(this.object);
                },
                finalize: function () {
                    if (this.object && typeof this.object._finalize === 'function') {
                        this.object._finalize(true);
                    }
                },
                parseVertexIndex: function (value, len) {
                    var index = parseInt(value, 10);
                    return (index >= 0 ? index - 1 : index + len / 3) * 3;
                },
                parseNormalIndex: function (value, len) {
                    var index = parseInt(value, 10);
                    return (index >= 0 ? index - 1 : index + len / 3) * 3;
                },
                parseUVIndex: function (value, len) {
                    var index = parseInt(value, 10);
                    return (index >= 0 ? index - 1 : index + len / 2) * 2;
                },
                addVertex: function (a, b, c) {
                    var src = this.vertices;
                    var dst = this.object.geometry.vertices;
                    dst.push(src[a + 0], src[a + 1], src[a + 2]);
                    dst.push(src[b + 0], src[b + 1], src[b + 2]);
                    dst.push(src[c + 0], src[c + 1], src[c + 2]);
                },
                addVertexPoint: function (a) {
                    var src = this.vertices;
                    var dst = this.object.geometry.vertices;
                    dst.push(src[a + 0], src[a + 1], src[a + 2]);
                },
                addVertexLine: function (a) {
                    var src = this.vertices;
                    var dst = this.object.geometry.vertices;
                    dst.push(src[a + 0], src[a + 1], src[a + 2]);
                },
                addNormal: function (a, b, c) {
                    var src = this.normals;
                    var dst = this.object.geometry.normals;
                    dst.push(src[a + 0], src[a + 1], src[a + 2]);
                    dst.push(src[b + 0], src[b + 1], src[b + 2]);
                    dst.push(src[c + 0], src[c + 1], src[c + 2]);
                },
                addColor: function (a, b, c) {
                    var src = this.colors;
                    var dst = this.object.geometry.colors;
                    dst.push(src[a + 0], src[a + 1], src[a + 2]);
                    dst.push(src[b + 0], src[b + 1], src[b + 2]);
                    dst.push(src[c + 0], src[c + 1], src[c + 2]);
                },
                addUV: function (a, b, c) {
                    var src = this.uvs;
                    var dst = this.object.geometry.uvs;
                    dst.push(src[a + 0], src[a + 1]);
                    dst.push(src[b + 0], src[b + 1]);
                    dst.push(src[c + 0], src[c + 1]);
                },
                addUVLine: function (a) {
                    var src = this.uvs;
                    var dst = this.object.geometry.uvs;
                    dst.push(src[a + 0], src[a + 1]);
                },
                addFace: function (a, b, c, ua, ub, uc, na, nb, nc) {
                    var vLen = this.vertices.length;
                    var ia = this.parseVertexIndex(a, vLen);
                    var ib = this.parseVertexIndex(b, vLen);
                    var ic = this.parseVertexIndex(c, vLen);
                    this.addVertex(ia, ib, ic);
                    if (this.colors.length > 0) {
                        this.addColor(ia, ib, ic);
                    }
                    if (ua !== undefined && ua !== '') {
                        var uvLen = this.uvs.length;
                        ia = this.parseUVIndex(ua, uvLen);
                        ib = this.parseUVIndex(ub, uvLen);
                        ic = this.parseUVIndex(uc, uvLen);
                        this.addUV(ia, ib, ic);
                    }
                    if (na !== undefined && na !== '') {
                        var nLen = this.normals.length;
                        ia = this.parseNormalIndex(na, nLen);
                        ib = na === nb ? ia : this.parseNormalIndex(nb, nLen);
                        ic = na === nc ? ia : this.parseNormalIndex(nc, nLen);
                        this.addNormal(ia, ib, ic);
                    }
                },
                addPointGeometry: function (vertices) {
                    this.object.geometry.type = 'Points';
                    var vLen = this.vertices.length;
                    for (var vi = 0, l = vertices.length; vi < l; vi++) {
                        this.addVertexPoint(this.parseVertexIndex(vertices[vi], vLen));
                    }
                },
                addLineGeometry: function (vertices, uvs) {
                    this.object.geometry.type = 'Line';
                    var vLen = this.vertices.length;
                    var uvLen = this.uvs.length;
                    for (var vi = 0, l = vertices.length; vi < l; vi++) {
                        this.addVertexLine(this.parseVertexIndex(vertices[vi], vLen));
                    }
                    for (var uvi = 0, l = uvs.length; uvi < l; uvi++) {
                        this.addUVLine(this.parseUVIndex(uvs[uvi], uvLen));
                    }
                }
            };
            state.startObject('', false);
            return state;
        }
        function OBJLoader(manager) {
            THREE.Loader.call(this, manager);
            this.materials = null;
        }
        OBJLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
            constructor: OBJLoader,
            load: function (url, onLoad, onProgress, onError) {
                var scope = this;
                var loader = new THREE.FileLoader(scope.manager);
                loader.setPath(this.path);
                loader.load(url, function (text) {
                    onLoad(scope.parse(text));
                }, onProgress, onError);
            },
            setMaterials: function (materials) {
                this.materials = materials;
                return this;
            },
            parse: function (text) {
                var state = new ParserState();
                if (text.indexOf('\r\n') !== -1) {
                    text = text.replace(/\r\n/g, '\n');
                }
                if (text.indexOf('\\\n') !== -1) {
                    text = text.replace(/\\\n/g, '');
                }
                var lines = text.split('\n');
                var line = '', lineFirstChar = '';
                var lineLength = 0;
                var result = [];
                var trimLeft = typeof ''.trimLeft === 'function';
                for (var i = 0, l = lines.length; i < l; i++) {
                    line = lines[i];
                    line = trimLeft ? line.trimLeft() : line.trim();
                    lineLength = line.length;
                    if (lineLength === 0)
                        continue;
                    lineFirstChar = line.charAt(0);
                    if (lineFirstChar === '#')
                        continue;
                    if (lineFirstChar === 'v') {
                        var data = line.split(/\s+/);
                        switch (data[0]) {
                        case 'v':
                            state.vertices.push(parseFloat(data[1]), parseFloat(data[2]), parseFloat(data[3]));
                            if (data.length >= 7) {
                                state.colors.push(parseFloat(data[4]), parseFloat(data[5]), parseFloat(data[6]));
                            }
                            break;
                        case 'vn':
                            state.normals.push(parseFloat(data[1]), parseFloat(data[2]), parseFloat(data[3]));
                            break;
                        case 'vt':
                            state.uvs.push(parseFloat(data[1]), parseFloat(data[2]));
                            break;
                        }
                    } else if (lineFirstChar === 'f') {
                        var lineData = line.substr(1).trim();
                        var vertexData = lineData.split(/\s+/);
                        var faceVertices = [];
                        for (var j = 0, jl = vertexData.length; j < jl; j++) {
                            var vertex = vertexData[j];
                            if (vertex.length > 0) {
                                var vertexParts = vertex.split('/');
                                faceVertices.push(vertexParts);
                            }
                        }
                        var v1 = faceVertices[0];
                        for (var j = 1, jl = faceVertices.length - 1; j < jl; j++) {
                            var v2 = faceVertices[j];
                            var v3 = faceVertices[j + 1];
                            state.addFace(v1[0], v2[0], v3[0], v1[1], v2[1], v3[1], v1[2], v2[2], v3[2]);
                        }
                    } else if (lineFirstChar === 'l') {
                        var lineParts = line.substring(1).trim().split(' ');
                        var lineVertices = [], lineUVs = [];
                        if (line.indexOf('/') === -1) {
                            lineVertices = lineParts;
                        } else {
                            for (var li = 0, llen = lineParts.length; li < llen; li++) {
                                var parts = lineParts[li].split('/');
                                if (parts[0] !== '')
                                    lineVertices.push(parts[0]);
                                if (parts[1] !== '')
                                    lineUVs.push(parts[1]);
                            }
                        }
                        state.addLineGeometry(lineVertices, lineUVs);
                    } else if (lineFirstChar === 'p') {
                        var lineData = line.substr(1).trim();
                        var pointData = lineData.split(' ');
                        state.addPointGeometry(pointData);
                    } else if ((result = object_pattern.exec(line)) !== null) {
                        var name = (' ' + result[0].substr(1).trim()).substr(1);
                        state.startObject(name);
                    } else if (material_use_pattern.test(line)) {
                        state.object.startMaterial(line.substring(7).trim(), state.materialLibraries);
                    } else if (material_library_pattern.test(line)) {
                        state.materialLibraries.push(line.substring(7).trim());
                    } else if (map_use_pattern.test(line)) {
                        console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');
                    } else if (lineFirstChar === 's') {
                        result = line.split(' ');
                        if (result.length > 1) {
                            var value = result[1].trim().toLowerCase();
                            state.object.smooth = value !== '0' && value !== 'off';
                        } else {
                            state.object.smooth = true;
                        }
                        var material = state.object.currentMaterial();
                        if (material)
                            material.smooth = state.object.smooth;
                    } else {
                        if (line === '\0')
                            continue;
                        console.warn('THREE.OBJLoader: Unexpected line: "' + line + '"');
                    }
                }
                state.finalize();
                var container = new THREE.Group();
                container.materialLibraries = [].concat(state.materialLibraries);
                for (var i = 0, l = state.objects.length; i < l; i++) {
                    var object = state.objects[i];
                    var geometry = object.geometry;
                    var materials = object.materials;
                    var isLine = geometry.type === 'Line';
                    var isPoints = geometry.type === 'Points';
                    var hasVertexColors = false;
                    if (geometry.vertices.length === 0)
                        continue;
                    var buffergeometry = new THREE.BufferGeometry();
                    buffergeometry.setAttribute('position', new THREE.Float32BufferAttribute(geometry.vertices, 3));
                    if (geometry.normals.length > 0) {
                        buffergeometry.setAttribute('normal', new THREE.Float32BufferAttribute(geometry.normals, 3));
                    } else {
                        buffergeometry.computeVertexNormals();
                    }
                    if (geometry.colors.length > 0) {
                        hasVertexColors = true;
                        buffergeometry.setAttribute('color', new THREE.Float32BufferAttribute(geometry.colors, 3));
                    }
                    if (geometry.uvs.length > 0) {
                        buffergeometry.setAttribute('uv', new THREE.Float32BufferAttribute(geometry.uvs, 2));
                    }
                    var createdMaterials = [];
                    for (var mi = 0, miLen = materials.length; mi < miLen; mi++) {
                        var sourceMaterial = materials[mi];
                        var materialHash = sourceMaterial.name + '_' + sourceMaterial.smooth + '_' + hasVertexColors;
                        var material = state.materials[materialHash];
                        if (this.materials !== null) {
                            material = this.materials.create(sourceMaterial.name);
                            if (isLine && material && !(material instanceof THREE.LineBasicMaterial)) {
                                var materialLine = new THREE.LineBasicMaterial();
                                THREE.Material.prototype.copy.call(materialLine, material);
                                materialLine.color.copy(material.color);
                                material = materialLine;
                            } else if (isPoints && material && !(material instanceof THREE.PointsMaterial)) {
                                var materialPoints = new THREE.PointsMaterial({
                                    size: 10,
                                    sizeAttenuation: false
                                });
                                THREE.Material.prototype.copy.call(materialPoints, material);
                                materialPoints.color.copy(material.color);
                                materialPoints.map = material.map;
                                material = materialPoints;
                            }
                        }
                        if (material === undefined) {
                            if (isLine) {
                                material = new THREE.LineBasicMaterial();
                            } else if (isPoints) {
                                material = new THREE.PointsMaterial({
                                    size: 1,
                                    sizeAttenuation: false
                                });
                            } else {
                                material = new THREE.MeshPhongMaterial();
                            }
                            material.name = sourceMaterial.name;
                            material.flatShading = sourceMaterial.smooth ? false : true;
                            material.vertexColors = hasVertexColors;
                            state.materials[materialHash] = material;
                        }
                        createdMaterials.push(material);
                    }
                    var mesh;
                    if (createdMaterials.length > 1) {
                        for (var mi = 0, miLen = materials.length; mi < miLen; mi++) {
                            var sourceMaterial = materials[mi];
                            buffergeometry.addGroup(sourceMaterial.groupStart, sourceMaterial.groupCount, mi);
                        }
                        if (isLine) {
                            mesh = new THREE.LineSegments(buffergeometry, createdMaterials);
                        } else if (isPoints) {
                            mesh = new THREE.Points(buffergeometry, createdMaterials);
                        } else {
                            mesh = new THREE.Mesh(buffergeometry, createdMaterials);
                        }
                    } else {
                        if (isLine) {
                            mesh = new THREE.LineSegments(buffergeometry, createdMaterials[0]);
                        } else if (isPoints) {
                            mesh = new THREE.Points(buffergeometry, createdMaterials[0]);
                        } else {
                            mesh = new THREE.Mesh(buffergeometry, createdMaterials[0]);
                        }
                    }
                    mesh.name = object.name;
                    container.add(mesh);
                }
                return container;
            }
        });
        return threex.loaders.OBJLoader = OBJLoader;
    }();
    return OBJLoader;
});
define('skylark-threejs-ex/loaders/obj2/OBJLoader2Parser',[],function () {
    'use strict';
    const OBJLoader2Parser = function () {
        this.logging = {
            enabled: false,
            debug: false
        };
        let scope = this;
        this.callbacks = {
            onProgress: function (text) {
                scope._onProgress(text);
            },
            onAssetAvailable: function (payload) {
                scope._onAssetAvailable(payload);
            },
            onError: function (errorMessage) {
                scope._onError(errorMessage);
            },
            onLoad: function (object3d, message) {
                scope._onLoad(object3d, message);
            }
        };
        this.contentRef = null;
        this.legacyMode = false;
        this.materials = {};
        this.materialPerSmoothingGroup = false;
        this.useOAsMesh = false;
        this.useIndices = false;
        this.disregardNormals = false;
        this.vertices = [];
        this.colors = [];
        this.normals = [];
        this.uvs = [];
        this.rawMesh = {
            objectName: '',
            groupName: '',
            activeMtlName: '',
            mtllibName: '',
            faceType: -1,
            subGroups: [],
            subGroupInUse: null,
            smoothingGroup: {
                splitMaterials: false,
                normalized: -1,
                real: -1
            },
            counts: {
                doubleIndicesCount: 0,
                faceCount: 0,
                mtlCount: 0,
                smoothingGroupCount: 0
            }
        };
        this.inputObjectCount = 1;
        this.outputObjectCount = 1;
        this.globalCounts = {
            vertices: 0,
            faces: 0,
            doubleIndicesCount: 0,
            lineByte: 0,
            currentByte: 0,
            totalBytes: 0
        };
    };
    OBJLoader2Parser.prototype = {
        constructor: OBJLoader2Parser,
        _resetRawMesh: function () {
            this.rawMesh.subGroups = [];
            this.rawMesh.subGroupInUse = null;
            this.rawMesh.smoothingGroup.normalized = -1;
            this.rawMesh.smoothingGroup.real = -1;
            this._pushSmoothingGroup(1);
            this.rawMesh.counts.doubleIndicesCount = 0;
            this.rawMesh.counts.faceCount = 0;
            this.rawMesh.counts.mtlCount = 0;
            this.rawMesh.counts.smoothingGroupCount = 0;
        },
        setMaterialPerSmoothingGroup: function (materialPerSmoothingGroup) {
            this.materialPerSmoothingGroup = materialPerSmoothingGroup === true;
            return this;
        },
        setUseOAsMesh: function (useOAsMesh) {
            this.useOAsMesh = useOAsMesh === true;
            return this;
        },
        setUseIndices: function (useIndices) {
            this.useIndices = useIndices === true;
            return this;
        },
        setDisregardNormals: function (disregardNormals) {
            this.disregardNormals = disregardNormals === true;
            return this;
        },
        setMaterials: function (materials) {
            this.materials = Object.assign({}, materials);
        },
        setCallbackOnAssetAvailable: function (onAssetAvailable) {
            if (onAssetAvailable !== null && onAssetAvailable !== undefined && onAssetAvailable instanceof Function) {
                this.callbacks.onAssetAvailable = onAssetAvailable;
            }
            return this;
        },
        setCallbackOnProgress: function (onProgress) {
            if (onProgress !== null && onProgress !== undefined && onProgress instanceof Function) {
                this.callbacks.onProgress = onProgress;
            }
            return this;
        },
        setCallbackOnError: function (onError) {
            if (onError !== null && onError !== undefined && onError instanceof Function) {
                this.callbacks.onError = onError;
            }
            return this;
        },
        setCallbackOnLoad: function (onLoad) {
            if (onLoad !== null && onLoad !== undefined && onLoad instanceof Function) {
                this.callbacks.onLoad = onLoad;
            }
            return this;
        },
        _onProgress: function (text) {
            let message = text ? text : '';
            if (this.logging.enabled && this.logging.debug) {
                console.log(message);
            }
        },
        _onError: function (errorMessage) {
            if (this.logging.enabled && this.logging.debug) {
                console.error(errorMessage);
            }
        },
        _onAssetAvailable: function (payload) {
            let errorMessage = 'OBJLoader2Parser does not provide implementation for onAssetAvailable. Aborting...';
            this.callbacks.onError(errorMessage);
            throw errorMessage;
        },
        _onLoad: function (object3d, message) {
            console.log('You reached parser default onLoad callback: ' + message);
        },
        setLogging: function (enabled, debug) {
            this.logging.enabled = enabled === true;
            this.logging.debug = debug === true;
            return this;
        },
        _configure: function () {
            this._pushSmoothingGroup(1);
            if (this.logging.enabled) {
                let matKeys = Object.keys(this.materials);
                let matNames = matKeys.length > 0 ? '\n\tmaterialNames:\n\t\t- ' + matKeys.join('\n\t\t- ') : '\n\tmaterialNames: None';
                let printedConfig = 'OBJLoader.Parser configuration:' + matNames + '\n\tmaterialPerSmoothingGroup: ' + this.materialPerSmoothingGroup + '\n\tuseOAsMesh: ' + this.useOAsMesh + '\n\tuseIndices: ' + this.useIndices + '\n\tdisregardNormals: ' + this.disregardNormals;
                printedConfig += '\n\tcallbacks.onProgress: ' + this.callbacks.onProgress.name;
                printedConfig += '\n\tcallbacks.onAssetAvailable: ' + this.callbacks.onAssetAvailable.name;
                printedConfig += '\n\tcallbacks.onError: ' + this.callbacks.onError.name;
                console.info(printedConfig);
            }
        },
        execute: function (arrayBuffer) {
            if (this.logging.enabled)
                console.time('OBJLoader2Parser.execute');
            this._configure();
            let arrayBufferView = new Uint8Array(arrayBuffer);
            this.contentRef = arrayBufferView;
            let length = arrayBufferView.byteLength;
            this.globalCounts.totalBytes = length;
            let buffer = new Array(128);
            for (let code, word = '', bufferPointer = 0, slashesCount = 0, i = 0; i < length; i++) {
                code = arrayBufferView[i];
                switch (code) {
                case 32:
                    if (word.length > 0)
                        buffer[bufferPointer++] = word;
                    word = '';
                    break;
                case 47:
                    if (word.length > 0)
                        buffer[bufferPointer++] = word;
                    slashesCount++;
                    word = '';
                    break;
                case 10:
                    if (word.length > 0)
                        buffer[bufferPointer++] = word;
                    word = '';
                    this.globalCounts.lineByte = this.globalCounts.currentByte;
                    this.globalCounts.currentByte = i;
                    this._processLine(buffer, bufferPointer, slashesCount);
                    bufferPointer = 0;
                    slashesCount = 0;
                    break;
                case 13:
                    break;
                default:
                    word += String.fromCharCode(code);
                    break;
                }
            }
            this._finalizeParsing();
            if (this.logging.enabled)
                console.timeEnd('OBJLoader2Parser.execute');
        },
        executeLegacy: function (text) {
            if (this.logging.enabled)
                console.time('OBJLoader2Parser.executeLegacy');
            this._configure();
            this.legacyMode = true;
            this.contentRef = text;
            let length = text.length;
            this.globalCounts.totalBytes = length;
            let buffer = new Array(128);
            for (let char, word = '', bufferPointer = 0, slashesCount = 0, i = 0; i < length; i++) {
                char = text[i];
                switch (char) {
                case ' ':
                    if (word.length > 0)
                        buffer[bufferPointer++] = word;
                    word = '';
                    break;
                case '/':
                    if (word.length > 0)
                        buffer[bufferPointer++] = word;
                    slashesCount++;
                    word = '';
                    break;
                case '\n':
                    if (word.length > 0)
                        buffer[bufferPointer++] = word;
                    word = '';
                    this.globalCounts.lineByte = this.globalCounts.currentByte;
                    this.globalCounts.currentByte = i;
                    this._processLine(buffer, bufferPointer, slashesCount);
                    bufferPointer = 0;
                    slashesCount = 0;
                    break;
                case '\r':
                    break;
                default:
                    word += char;
                }
            }
            this._finalizeParsing();
            if (this.logging.enabled)
                console.timeEnd('OBJLoader2Parser.executeLegacy');
        },
        _processLine: function (buffer, bufferPointer, slashesCount) {
            if (bufferPointer < 1)
                return;
            let reconstructString = function (content, legacyMode, start, stop) {
                let line = '';
                if (stop > start) {
                    let i;
                    if (legacyMode) {
                        for (i = start; i < stop; i++)
                            line += content[i];
                    } else {
                        for (i = start; i < stop; i++)
                            line += String.fromCharCode(content[i]);
                    }
                    line = line.trim();
                }
                return line;
            };
            let bufferLength, length, i, lineDesignation;
            lineDesignation = buffer[0];
            switch (lineDesignation) {
            case 'v':
                this.vertices.push(parseFloat(buffer[1]));
                this.vertices.push(parseFloat(buffer[2]));
                this.vertices.push(parseFloat(buffer[3]));
                if (bufferPointer > 4) {
                    this.colors.push(parseFloat(buffer[4]));
                    this.colors.push(parseFloat(buffer[5]));
                    this.colors.push(parseFloat(buffer[6]));
                }
                break;
            case 'vt':
                this.uvs.push(parseFloat(buffer[1]));
                this.uvs.push(parseFloat(buffer[2]));
                break;
            case 'vn':
                this.normals.push(parseFloat(buffer[1]));
                this.normals.push(parseFloat(buffer[2]));
                this.normals.push(parseFloat(buffer[3]));
                break;
            case 'f':
                bufferLength = bufferPointer - 1;
                if (slashesCount === 0) {
                    this._checkFaceType(0);
                    for (i = 2, length = bufferLength; i < length; i++) {
                        this._buildFace(buffer[1]);
                        this._buildFace(buffer[i]);
                        this._buildFace(buffer[i + 1]);
                    }
                } else if (bufferLength === slashesCount * 2) {
                    this._checkFaceType(1);
                    for (i = 3, length = bufferLength - 2; i < length; i += 2) {
                        this._buildFace(buffer[1], buffer[2]);
                        this._buildFace(buffer[i], buffer[i + 1]);
                        this._buildFace(buffer[i + 2], buffer[i + 3]);
                    }
                } else if (bufferLength * 2 === slashesCount * 3) {
                    this._checkFaceType(2);
                    for (i = 4, length = bufferLength - 3; i < length; i += 3) {
                        this._buildFace(buffer[1], buffer[2], buffer[3]);
                        this._buildFace(buffer[i], buffer[i + 1], buffer[i + 2]);
                        this._buildFace(buffer[i + 3], buffer[i + 4], buffer[i + 5]);
                    }
                } else {
                    this._checkFaceType(3);
                    for (i = 3, length = bufferLength - 2; i < length; i += 2) {
                        this._buildFace(buffer[1], undefined, buffer[2]);
                        this._buildFace(buffer[i], undefined, buffer[i + 1]);
                        this._buildFace(buffer[i + 2], undefined, buffer[i + 3]);
                    }
                }
                break;
            case 'l':
            case 'p':
                bufferLength = bufferPointer - 1;
                if (bufferLength === slashesCount * 2) {
                    this._checkFaceType(4);
                    for (i = 1, length = bufferLength + 1; i < length; i += 2)
                        this._buildFace(buffer[i], buffer[i + 1]);
                } else {
                    this._checkFaceType(lineDesignation === 'l' ? 5 : 6);
                    for (i = 1, length = bufferLength + 1; i < length; i++)
                        this._buildFace(buffer[i]);
                }
                break;
            case 's':
                this._pushSmoothingGroup(buffer[1]);
                break;
            case 'g':
                this._processCompletedMesh();
                this.rawMesh.groupName = reconstructString(this.contentRef, this.legacyMode, this.globalCounts.lineByte + 2, this.globalCounts.currentByte);
                break;
            case 'o':
                if (this.useOAsMesh)
                    this._processCompletedMesh();
                this.rawMesh.objectName = reconstructString(this.contentRef, this.legacyMode, this.globalCounts.lineByte + 2, this.globalCounts.currentByte);
                break;
            case 'mtllib':
                this.rawMesh.mtllibName = reconstructString(this.contentRef, this.legacyMode, this.globalCounts.lineByte + 7, this.globalCounts.currentByte);
                break;
            case 'usemtl':
                let mtlName = reconstructString(this.contentRef, this.legacyMode, this.globalCounts.lineByte + 7, this.globalCounts.currentByte);
                if (mtlName !== '' && this.rawMesh.activeMtlName !== mtlName) {
                    this.rawMesh.activeMtlName = mtlName;
                    this.rawMesh.counts.mtlCount++;
                    this._checkSubGroup();
                }
                break;
            default:
                break;
            }
        },
        _pushSmoothingGroup: function (smoothingGroup) {
            let smoothingGroupInt = parseInt(smoothingGroup);
            if (isNaN(smoothingGroupInt)) {
                smoothingGroupInt = smoothingGroup === 'off' ? 0 : 1;
            }
            let smoothCheck = this.rawMesh.smoothingGroup.normalized;
            this.rawMesh.smoothingGroup.normalized = this.rawMesh.smoothingGroup.splitMaterials ? smoothingGroupInt : smoothingGroupInt === 0 ? 0 : 1;
            this.rawMesh.smoothingGroup.real = smoothingGroupInt;
            if (smoothCheck !== smoothingGroupInt) {
                this.rawMesh.counts.smoothingGroupCount++;
                this._checkSubGroup();
            }
        },
        _checkFaceType: function (faceType) {
            if (this.rawMesh.faceType !== faceType) {
                this._processCompletedMesh();
                this.rawMesh.faceType = faceType;
                this._checkSubGroup();
            }
        },
        _checkSubGroup: function () {
            let index = this.rawMesh.activeMtlName + '|' + this.rawMesh.smoothingGroup.normalized;
            this.rawMesh.subGroupInUse = this.rawMesh.subGroups[index];
            if (this.rawMesh.subGroupInUse === undefined || this.rawMesh.subGroupInUse === null) {
                this.rawMesh.subGroupInUse = {
                    index: index,
                    objectName: this.rawMesh.objectName,
                    groupName: this.rawMesh.groupName,
                    materialName: this.rawMesh.activeMtlName,
                    smoothingGroup: this.rawMesh.smoothingGroup.normalized,
                    vertices: [],
                    indexMappingsCount: 0,
                    indexMappings: [],
                    indices: [],
                    colors: [],
                    uvs: [],
                    normals: []
                };
                this.rawMesh.subGroups[index] = this.rawMesh.subGroupInUse;
            }
        },
        _buildFace: function (faceIndexV, faceIndexU, faceIndexN) {
            let subGroupInUse = this.rawMesh.subGroupInUse;
            let scope = this;
            let updateSubGroupInUse = function () {
                let faceIndexVi = parseInt(faceIndexV);
                let indexPointerV = 3 * (faceIndexVi > 0 ? faceIndexVi - 1 : faceIndexVi + scope.vertices.length / 3);
                let indexPointerC = scope.colors.length > 0 ? indexPointerV : null;
                let vertices = subGroupInUse.vertices;
                vertices.push(scope.vertices[indexPointerV++]);
                vertices.push(scope.vertices[indexPointerV++]);
                vertices.push(scope.vertices[indexPointerV]);
                if (indexPointerC !== null) {
                    let colors = subGroupInUse.colors;
                    colors.push(scope.colors[indexPointerC++]);
                    colors.push(scope.colors[indexPointerC++]);
                    colors.push(scope.colors[indexPointerC]);
                }
                if (faceIndexU) {
                    let faceIndexUi = parseInt(faceIndexU);
                    let indexPointerU = 2 * (faceIndexUi > 0 ? faceIndexUi - 1 : faceIndexUi + scope.uvs.length / 2);
                    let uvs = subGroupInUse.uvs;
                    uvs.push(scope.uvs[indexPointerU++]);
                    uvs.push(scope.uvs[indexPointerU]);
                }
                if (faceIndexN && !scope.disregardNormals) {
                    let faceIndexNi = parseInt(faceIndexN);
                    let indexPointerN = 3 * (faceIndexNi > 0 ? faceIndexNi - 1 : faceIndexNi + scope.normals.length / 3);
                    let normals = subGroupInUse.normals;
                    normals.push(scope.normals[indexPointerN++]);
                    normals.push(scope.normals[indexPointerN++]);
                    normals.push(scope.normals[indexPointerN]);
                }
            };
            if (this.useIndices) {
                if (this.disregardNormals)
                    faceIndexN = undefined;
                let mappingName = faceIndexV + (faceIndexU ? '_' + faceIndexU : '_n') + (faceIndexN ? '_' + faceIndexN : '_n');
                let indicesPointer = subGroupInUse.indexMappings[mappingName];
                if (indicesPointer === undefined || indicesPointer === null) {
                    indicesPointer = this.rawMesh.subGroupInUse.vertices.length / 3;
                    updateSubGroupInUse();
                    subGroupInUse.indexMappings[mappingName] = indicesPointer;
                    subGroupInUse.indexMappingsCount++;
                } else {
                    this.rawMesh.counts.doubleIndicesCount++;
                }
                subGroupInUse.indices.push(indicesPointer);
            } else {
                updateSubGroupInUse();
            }
            this.rawMesh.counts.faceCount++;
        },
        _createRawMeshReport: function (inputObjectCount) {
            return 'Input Object number: ' + inputObjectCount + '\n\tObject name: ' + this.rawMesh.objectName + '\n\tGroup name: ' + this.rawMesh.groupName + '\n\tMtllib name: ' + this.rawMesh.mtllibName + '\n\tVertex count: ' + this.vertices.length / 3 + '\n\tNormal count: ' + this.normals.length / 3 + '\n\tUV count: ' + this.uvs.length / 2 + '\n\tSmoothingGroup count: ' + this.rawMesh.counts.smoothingGroupCount + '\n\tMaterial count: ' + this.rawMesh.counts.mtlCount + '\n\tReal MeshOutputGroup count: ' + this.rawMesh.subGroups.length;
        },
        _finalizeRawMesh: function () {
            let meshOutputGroupTemp = [];
            let meshOutputGroup;
            let absoluteVertexCount = 0;
            let absoluteIndexMappingsCount = 0;
            let absoluteIndexCount = 0;
            let absoluteColorCount = 0;
            let absoluteNormalCount = 0;
            let absoluteUvCount = 0;
            let indices;
            for (let name in this.rawMesh.subGroups) {
                meshOutputGroup = this.rawMesh.subGroups[name];
                if (meshOutputGroup.vertices.length > 0) {
                    indices = meshOutputGroup.indices;
                    if (indices.length > 0 && absoluteIndexMappingsCount > 0) {
                        for (let i = 0; i < indices.length; i++) {
                            indices[i] = indices[i] + absoluteIndexMappingsCount;
                        }
                    }
                    meshOutputGroupTemp.push(meshOutputGroup);
                    absoluteVertexCount += meshOutputGroup.vertices.length;
                    absoluteIndexMappingsCount += meshOutputGroup.indexMappingsCount;
                    absoluteIndexCount += meshOutputGroup.indices.length;
                    absoluteColorCount += meshOutputGroup.colors.length;
                    absoluteUvCount += meshOutputGroup.uvs.length;
                    absoluteNormalCount += meshOutputGroup.normals.length;
                }
            }
            let result = null;
            if (meshOutputGroupTemp.length > 0) {
                result = {
                    name: this.rawMesh.groupName !== '' ? this.rawMesh.groupName : this.rawMesh.objectName,
                    subGroups: meshOutputGroupTemp,
                    absoluteVertexCount: absoluteVertexCount,
                    absoluteIndexCount: absoluteIndexCount,
                    absoluteColorCount: absoluteColorCount,
                    absoluteNormalCount: absoluteNormalCount,
                    absoluteUvCount: absoluteUvCount,
                    faceCount: this.rawMesh.counts.faceCount,
                    doubleIndicesCount: this.rawMesh.counts.doubleIndicesCount
                };
            }
            return result;
        },
        _processCompletedMesh: function () {
            let result = this._finalizeRawMesh();
            let haveMesh = result !== null;
            if (haveMesh) {
                if (this.colors.length > 0 && this.colors.length !== this.vertices.length) {
                    this.callbacks.onError('Vertex Colors were detected, but vertex count and color count do not match!');
                }
                if (this.logging.enabled && this.logging.debug)
                    console.debug(this._createRawMeshReport(this.inputObjectCount));
                this.inputObjectCount++;
                this._buildMesh(result);
                let progressBytesPercent = this.globalCounts.currentByte / this.globalCounts.totalBytes;
                this._onProgress('Completed [o: ' + this.rawMesh.objectName + ' g:' + this.rawMesh.groupName + '' + '] Total progress: ' + (progressBytesPercent * 100).toFixed(2) + '%');
                this._resetRawMesh();
            }
            return haveMesh;
        },
        _buildMesh: function (result) {
            let meshOutputGroups = result.subGroups;
            let vertexFA = new Float32Array(result.absoluteVertexCount);
            this.globalCounts.vertices += result.absoluteVertexCount / 3;
            this.globalCounts.faces += result.faceCount;
            this.globalCounts.doubleIndicesCount += result.doubleIndicesCount;
            let indexUA = result.absoluteIndexCount > 0 ? new Uint32Array(result.absoluteIndexCount) : null;
            let colorFA = result.absoluteColorCount > 0 ? new Float32Array(result.absoluteColorCount) : null;
            let normalFA = result.absoluteNormalCount > 0 ? new Float32Array(result.absoluteNormalCount) : null;
            let uvFA = result.absoluteUvCount > 0 ? new Float32Array(result.absoluteUvCount) : null;
            let haveVertexColors = colorFA !== null;
            let meshOutputGroup;
            let materialNames = [];
            let createMultiMaterial = meshOutputGroups.length > 1;
            let materialIndex = 0;
            let materialIndexMapping = [];
            let selectedMaterialIndex;
            let materialGroup;
            let materialGroups = [];
            let vertexFAOffset = 0;
            let indexUAOffset = 0;
            let colorFAOffset = 0;
            let normalFAOffset = 0;
            let uvFAOffset = 0;
            let materialGroupOffset = 0;
            let materialGroupLength = 0;
            let materialOrg, material, materialName, materialNameOrg;
            for (let oodIndex in meshOutputGroups) {
                if (!meshOutputGroups.hasOwnProperty(oodIndex))
                    continue;
                meshOutputGroup = meshOutputGroups[oodIndex];
                materialNameOrg = meshOutputGroup.materialName;
                if (this.rawMesh.faceType < 4) {
                    materialName = materialNameOrg + (haveVertexColors ? '_vertexColor' : '') + (meshOutputGroup.smoothingGroup === 0 ? '_flat' : '');
                } else {
                    materialName = this.rawMesh.faceType === 6 ? 'defaultPointMaterial' : 'defaultLineMaterial';
                }
                materialOrg = this.materials[materialNameOrg];
                material = this.materials[materialName];
                if ((materialOrg === undefined || materialOrg === null) && (material === undefined || material === null)) {
                    materialName = haveVertexColors ? 'defaultVertexColorMaterial' : 'defaultMaterial';
                    material = this.materials[materialName];
                    if (this.logging.enabled) {
                        console.info('object_group "' + meshOutputGroup.objectName + '_' + meshOutputGroup.groupName + '" was defined with unresolvable material "' + materialNameOrg + '"! Assigning "' + materialName + '".');
                    }
                }
                if (material === undefined || material === null) {
                    let materialCloneInstructions = {
                        materialNameOrg: materialNameOrg,
                        materialName: materialName,
                        materialProperties: {
                            vertexColors: haveVertexColors ? 2 : 0,
                            flatShading: meshOutputGroup.smoothingGroup === 0
                        }
                    };
                    let payload = {
                        cmd: 'assetAvailable',
                        type: 'material',
                        materials: { materialCloneInstructions: materialCloneInstructions }
                    };
                    this.callbacks.onAssetAvailable(payload);
                    let matCheck = this.materials[materialName];
                    if (matCheck === undefined || matCheck === null) {
                        this.materials[materialName] = materialCloneInstructions;
                    }
                }
                if (createMultiMaterial) {
                    selectedMaterialIndex = materialIndexMapping[materialName];
                    if (!selectedMaterialIndex) {
                        selectedMaterialIndex = materialIndex;
                        materialIndexMapping[materialName] = materialIndex;
                        materialNames.push(materialName);
                        materialIndex++;
                    }
                    materialGroupLength = this.useIndices ? meshOutputGroup.indices.length : meshOutputGroup.vertices.length / 3;
                    materialGroup = {
                        start: materialGroupOffset,
                        count: materialGroupLength,
                        index: selectedMaterialIndex
                    };
                    materialGroups.push(materialGroup);
                    materialGroupOffset += materialGroupLength;
                } else {
                    materialNames.push(materialName);
                }
                vertexFA.set(meshOutputGroup.vertices, vertexFAOffset);
                vertexFAOffset += meshOutputGroup.vertices.length;
                if (indexUA) {
                    indexUA.set(meshOutputGroup.indices, indexUAOffset);
                    indexUAOffset += meshOutputGroup.indices.length;
                }
                if (colorFA) {
                    colorFA.set(meshOutputGroup.colors, colorFAOffset);
                    colorFAOffset += meshOutputGroup.colors.length;
                }
                if (normalFA) {
                    normalFA.set(meshOutputGroup.normals, normalFAOffset);
                    normalFAOffset += meshOutputGroup.normals.length;
                }
                if (uvFA) {
                    uvFA.set(meshOutputGroup.uvs, uvFAOffset);
                    uvFAOffset += meshOutputGroup.uvs.length;
                }
                if (this.logging.enabled && this.logging.debug) {
                    let materialIndexLine = selectedMaterialIndex === undefined || selectedMaterialIndex === null ? '' : '\n\t\tmaterialIndex: ' + selectedMaterialIndex;
                    let createdReport = '\tOutput Object no.: ' + this.outputObjectCount + '\n\t\tgroupName: ' + meshOutputGroup.groupName + '\n\t\tIndex: ' + meshOutputGroup.index + '\n\t\tfaceType: ' + this.rawMesh.faceType + '\n\t\tmaterialName: ' + meshOutputGroup.materialName + '\n\t\tsmoothingGroup: ' + meshOutputGroup.smoothingGroup + materialIndexLine + '\n\t\tobjectName: ' + meshOutputGroup.objectName + '\n\t\t#vertices: ' + meshOutputGroup.vertices.length / 3 + '\n\t\t#indices: ' + meshOutputGroup.indices.length + '\n\t\t#colors: ' + meshOutputGroup.colors.length / 3 + '\n\t\t#uvs: ' + meshOutputGroup.uvs.length / 2 + '\n\t\t#normals: ' + meshOutputGroup.normals.length / 3;
                    console.debug(createdReport);
                }
            }
            this.outputObjectCount++;
            this.callbacks.onAssetAvailable({
                cmd: 'assetAvailable',
                type: 'mesh',
                progress: { numericalValue: this.globalCounts.currentByte / this.globalCounts.totalBytes },
                params: { meshName: result.name },
                materials: {
                    multiMaterial: createMultiMaterial,
                    materialNames: materialNames,
                    materialGroups: materialGroups
                },
                buffers: {
                    vertices: vertexFA,
                    indices: indexUA,
                    colors: colorFA,
                    normals: normalFA,
                    uvs: uvFA
                },
                geometryType: this.rawMesh.faceType < 4 ? 0 : this.rawMesh.faceType === 6 ? 2 : 1
            }, [vertexFA.buffer], indexUA !== null ? [indexUA.buffer] : null, colorFA !== null ? [colorFA.buffer] : null, normalFA !== null ? [normalFA.buffer] : null, uvFA !== null ? [uvFA.buffer] : null);
        },
        _finalizeParsing: function () {
            if (this.logging.enabled)
                console.info('Global output object count: ' + this.outputObjectCount);
            if (this._processCompletedMesh() && this.logging.enabled) {
                let parserFinalReport = 'Overall counts: ' + '\n\tVertices: ' + this.globalCounts.vertices + '\n\tFaces: ' + this.globalCounts.faces + '\n\tMultiple definitions: ' + this.globalCounts.doubleIndicesCount;
                console.info(parserFinalReport);
            }
        }
    };

    return OBJLoader2Parser;
});
define('skylark-threejs-ex/loaders/obj2/shared/MeshReceiver',[
    'skylark-threejs'
], function (THREE) {
    'use strict';
    const MeshReceiver = function (materialHandler) {
        this.logging = {
            enabled: false,
            debug: false
        };
        this.callbacks = {
            onProgress: null,
            onMeshAlter: null
        };
        this.materialHandler = materialHandler;
    };
    MeshReceiver.prototype = {
        constructor: MeshReceiver,
        setLogging: function (enabled, debug) {
            this.logging.enabled = enabled === true;
            this.logging.debug = debug === true;
        },
        _setCallbacks: function (onProgress, onMeshAlter) {
            if (onProgress !== null && onProgress !== undefined && onProgress instanceof Function) {
                this.callbacks.onProgress = onProgress;
            }
            if (onMeshAlter !== null && onMeshAlter !== undefined && onMeshAlter instanceof Function) {
                this.callbacks.onMeshAlter = onMeshAlter;
            }
        },
        buildMeshes: function (meshPayload) {
            let meshName = meshPayload.params.meshName;
            let buffers = meshPayload.buffers;
            let bufferGeometry = new THREE.BufferGeometry();
            if (buffers.vertices !== undefined && buffers.vertices !== null) {
                bufferGeometry.setAttribute('position', new THREE.BufferAttribute(new Float32Array(buffers.vertices), 3));
            }
            if (buffers.indices !== undefined && buffers.indices !== null) {
                bufferGeometry.setIndex(new THREE.BufferAttribute(new Uint32Array(buffers.indices), 1));
            }
            if (buffers.colors !== undefined && buffers.colors !== null) {
                bufferGeometry.setAttribute('color', new THREE.BufferAttribute(new Float32Array(buffers.colors), 3));
            }
            if (buffers.normals !== undefined && buffers.normals !== null) {
                bufferGeometry.setAttribute('normal', new THREE.BufferAttribute(new Float32Array(buffers.normals), 3));
            } else {
                bufferGeometry.computeVertexNormals();
            }
            if (buffers.uvs !== undefined && buffers.uvs !== null) {
                bufferGeometry.setAttribute('uv', new THREE.BufferAttribute(new Float32Array(buffers.uvs), 2));
            }
            if (buffers.skinIndex !== undefined && buffers.skinIndex !== null) {
                bufferGeometry.setAttribute('skinIndex', new THREE.BufferAttribute(new Uint16Array(buffers.skinIndex), 4));
            }
            if (buffers.skinWeight !== undefined && buffers.skinWeight !== null) {
                bufferGeometry.setAttribute('skinWeight', new THREE.BufferAttribute(new Float32Array(buffers.skinWeight), 4));
            }
            let material, materialName, key;
            let materialNames = meshPayload.materials.materialNames;
            let createMultiMaterial = meshPayload.materials.multiMaterial;
            let multiMaterials = [];
            for (key in materialNames) {
                materialName = materialNames[key];
                material = this.materialHandler.getMaterial(materialName);
                if (createMultiMaterial)
                    multiMaterials.push(material);
            }
            if (createMultiMaterial) {
                material = multiMaterials;
                let materialGroups = meshPayload.materials.materialGroups;
                let materialGroup;
                for (key in materialGroups) {
                    materialGroup = materialGroups[key];
                    bufferGeometry.addGroup(materialGroup.start, materialGroup.count, materialGroup.index);
                }
            }
            let meshes = [];
            let mesh;
            let callbackOnMeshAlterResult;
            let useOrgMesh = true;
            let geometryType = meshPayload.geometryType === null ? 0 : meshPayload.geometryType;
            if (this.callbacks.onMeshAlter) {
                callbackOnMeshAlterResult = this.callbacks.onMeshAlter({
                    detail: {
                        meshName: meshName,
                        bufferGeometry: bufferGeometry,
                        material: material,
                        geometryType: geometryType
                    }
                });
            }
            if (callbackOnMeshAlterResult) {
                if (callbackOnMeshAlterResult.isDisregardMesh()) {
                    useOrgMesh = false;
                } else if (callbackOnMeshAlterResult.providesAlteredMeshes()) {
                    for (let i in callbackOnMeshAlterResult.meshes) {
                        meshes.push(callbackOnMeshAlterResult.meshes[i]);
                    }
                    useOrgMesh = false;
                }
            }
            if (useOrgMesh) {
                if (meshPayload.computeBoundingSphere)
                    bufferGeometry.computeBoundingSphere();
                if (geometryType === 0) {
                    mesh = new THREE.Mesh(bufferGeometry, material);
                } else if (geometryType === 1) {
                    mesh = new THREE.LineSegments(bufferGeometry, material);
                } else {
                    mesh = new THREE.Points(bufferGeometry, material);
                }
                mesh.name = meshName;
                meshes.push(mesh);
            }
            let progressMessage = meshPayload.params.meshName;
            if (meshes.length > 0) {
                let meshNames = [];
                for (let i in meshes) {
                    mesh = meshes[i];
                    meshNames[i] = mesh.name;
                }
                progressMessage += ': Adding mesh(es) (' + meshNames.length + ': ' + meshNames + ') from input mesh: ' + meshName;
                progressMessage += ' (' + (meshPayload.progress.numericalValue * 100).toFixed(2) + '%)';
            } else {
                progressMessage += ': Not adding mesh: ' + meshName;
                progressMessage += ' (' + (meshPayload.progress.numericalValue * 100).toFixed(2) + '%)';
            }
            if (this.callbacks.onProgress) {
                this.callbacks.onProgress('progress', progressMessage, meshPayload.progress.numericalValue);
            }
            return meshes;
        }
    };

    return  MeshReceiver;
});
define('skylark-threejs-ex/loaders/obj2/shared/MaterialHandler',[
    'skylark-threejs'
], function (THREE) {
    'use strict';
    const MaterialHandler = function () {
        this.logging = {
            enabled: false,
            debug: false
        };
        this.callbacks = { onLoadMaterials: null };
        this.materials = {};
    };
    MaterialHandler.prototype = {
        constructor: MaterialHandler,
        setLogging: function (enabled, debug) {
            this.logging.enabled = enabled === true;
            this.logging.debug = debug === true;
        },
        _setCallbacks: function (onLoadMaterials) {
            if (onLoadMaterials !== undefined && onLoadMaterials !== null && onLoadMaterials instanceof Function) {
                this.callbacks.onLoadMaterials = onLoadMaterials;
            }
        },
        createDefaultMaterials: function (overrideExisting) {
            let defaultMaterial = new THREE.MeshStandardMaterial({ color: 14479871 });
            defaultMaterial.name = 'defaultMaterial';
            let defaultVertexColorMaterial = new THREE.MeshStandardMaterial({ color: 14479871 });
            defaultVertexColorMaterial.name = 'defaultVertexColorMaterial';
            defaultVertexColorMaterial.vertexColors = THREE.VertexColors;
            let defaultLineMaterial = new THREE.LineBasicMaterial();
            defaultLineMaterial.name = 'defaultLineMaterial';
            let defaultPointMaterial = new THREE.PointsMaterial({ size: 0.1 });
            defaultPointMaterial.name = 'defaultPointMaterial';
            let runtimeMaterials = {};
            runtimeMaterials[defaultMaterial.name] = defaultMaterial;
            runtimeMaterials[defaultVertexColorMaterial.name] = defaultVertexColorMaterial;
            runtimeMaterials[defaultLineMaterial.name] = defaultLineMaterial;
            runtimeMaterials[defaultPointMaterial.name] = defaultPointMaterial;
            this.addMaterials(runtimeMaterials, overrideExisting);
        },
        addPayloadMaterials: function (materialPayload) {
            let material, materialName;
            let materialCloneInstructions = materialPayload.materials.materialCloneInstructions;
            let newMaterials = {};
            if (materialCloneInstructions !== undefined && materialCloneInstructions !== null) {
                let materialNameOrg = materialCloneInstructions.materialNameOrg;
                materialNameOrg = materialNameOrg !== undefined && materialNameOrg !== null ? materialNameOrg : '';
                let materialOrg = this.materials[materialNameOrg];
                if (materialOrg) {
                    material = materialOrg.clone();
                    materialName = materialCloneInstructions.materialName;
                    material.name = materialName;
                    Object.assign(material, materialCloneInstructions.materialProperties);
                    this.materials[materialName] = material;
                    newMaterials[materialName] = material;
                } else {
                    if (this.logging.enabled) {
                        console.info('Requested material "' + materialNameOrg + '" is not available!');
                    }
                }
            }
            let materials = materialPayload.materials.serializedMaterials;
            if (materials !== undefined && materials !== null && Object.keys(materials).length > 0) {
                let loader = new THREE.MaterialLoader();
                let materialJson;
                for (materialName in materials) {
                    materialJson = materials[materialName];
                    if (materialJson !== undefined && materialJson !== null) {
                        material = loader.parse(materialJson);
                        if (this.logging.enabled) {
                            console.info('De-serialized material with name "' + materialName + '" will be added.');
                        }
                        this.materials[materialName] = material;
                        newMaterials[materialName] = material;
                    }
                }
            }
            materials = materialPayload.materials.runtimeMaterials;
            newMaterials = this.addMaterials(materials, true, newMaterials);
            return newMaterials;
        },
        addMaterials: function (materials, overrideExisting, newMaterials) {
            if (newMaterials === undefined || newMaterials === null) {
                newMaterials = {};
            }
            if (materials !== undefined && materials !== null && Object.keys(materials).length > 0) {
                let material;
                let existingMaterial;
                let add;
                for (let materialName in materials) {
                    material = materials[materialName];
                    add = overrideExisting === true;
                    if (!add) {
                        existingMaterial = this.materials[materialName];
                        add = existingMaterial === null || existingMaterial === undefined;
                    }
                    if (add) {
                        this.materials[materialName] = material;
                        newMaterials[materialName] = material;
                    }
                    if (this.logging.enabled && this.logging.debug) {
                        console.info('Material with name "' + materialName + '" was added.');
                    }
                }
            }
            if (this.callbacks.onLoadMaterials) {
                this.callbacks.onLoadMaterials(newMaterials);
            }
            return newMaterials;
        },
        getMaterials: function () {
            return this.materials;
        },
        getMaterial: function (materialName) {
            return this.materials[materialName];
        },
        getMaterialsJSON: function () {
            let materialsJSON = {};
            let material;
            for (let materialName in this.materials) {
                material = this.materials[materialName];
                materialsJSON[materialName] = material.toJSON();
            }
            return materialsJSON;
        },
        clearMaterials: function () {
            this.materials = {};
        }
    };
    return MaterialHandler;
});
define('skylark-threejs-ex/loaders/OBJLoader2',[
    "skylark-threejs",
    "../threex",
    './obj2/OBJLoader2Parser',
    './obj2/shared/MeshReceiver',
    './obj2/shared/MaterialHandler'
], function (
    THREE,
    threex, 
    OBJLoader2Parser, 
    MeshReceiver, 
    MaterialHandler
) {
    'use strict';
    const OBJLoader2 = function (manager) {
        THREE.Loader.call(this, manager);
        this.parser = new OBJLoader2Parser();
        this.modelName = '';
        this.instanceNo = 0;
        this.baseObject3d = new THREE.Object3D();
        this.materialHandler = new MaterialHandler();
        this.meshReceiver = new MeshReceiver(this.materialHandler);
        let scope = this;
        let defaultOnAssetAvailable = function (payload) {
            scope._onAssetAvailable(payload);
        };
        this.parser.setCallbackOnAssetAvailable(defaultOnAssetAvailable);
    };
    OBJLoader2.OBJLOADER2_VERSION = '3.2.0';
    console.info('Using OBJLoader2 version: ' + OBJLoader2.OBJLOADER2_VERSION);
    OBJLoader2.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: OBJLoader2,
        setLogging: function (enabled, debug) {
            this.parser.setLogging(enabled, debug);
            return this;
        },
        setMaterialPerSmoothingGroup: function (materialPerSmoothingGroup) {
            this.parser.setMaterialPerSmoothingGroup(materialPerSmoothingGroup);
            return this;
        },
        setUseOAsMesh: function (useOAsMesh) {
            this.parser.setUseOAsMesh(useOAsMesh);
            return this;
        },
        setUseIndices: function (useIndices) {
            this.parser.setUseIndices(useIndices);
            return this;
        },
        setDisregardNormals: function (disregardNormals) {
            this.parser.setDisregardNormals(disregardNormals);
            return this;
        },
        setModelName: function (modelName) {
            this.modelName = modelName ? modelName : this.modelName;
            return this;
        },
        setBaseObject3d: function (baseObject3d) {
            this.baseObject3d = baseObject3d === undefined || baseObject3d === null ? this.baseObject3d : baseObject3d;
            return this;
        },
        addMaterials: function (materials, overrideExisting) {
            this.materialHandler.addMaterials(materials, overrideExisting);
            return this;
        },
        setCallbackOnAssetAvailable: function (onAssetAvailable) {
            this.parser.setCallbackOnAssetAvailable(onAssetAvailable);
            return this;
        },
        setCallbackOnProgress: function (onProgress) {
            this.parser.setCallbackOnProgress(onProgress);
            return this;
        },
        setCallbackOnError: function (onError) {
            this.parser.setCallbackOnError(onError);
            return this;
        },
        setCallbackOnLoad: function (onLoad) {
            this.parser.setCallbackOnLoad(onLoad);
            return this;
        },
        setCallbackOnMeshAlter: function (onMeshAlter) {
            this.meshReceiver._setCallbacks(this.parser.callbacks.onProgress, onMeshAlter);
            return this;
        },
        setCallbackOnLoadMaterials: function (onLoadMaterials) {
            this.materialHandler._setCallbacks(onLoadMaterials);
            return this;
        },
        load: function (url, onLoad, onFileLoadProgress, onError, onMeshAlter) {
            let scope = this;
            if (onLoad === null || onLoad === undefined || !(onLoad instanceof Function)) {
                let errorMessage = 'onLoad is not a function! Aborting...';
                scope.parser.callbacks.onError(errorMessage);
                throw errorMessage;
            } else {
                this.parser.setCallbackOnLoad(onLoad);
            }
            if (onError === null || onError === undefined || !(onError instanceof Function)) {
                onError = function (event) {
                    let errorMessage = event;
                    if (event.currentTarget && event.currentTarget.statusText !== null) {
                        errorMessage = 'Error occurred while downloading!\nurl: ' + event.currentTarget.responseURL + '\nstatus: ' + event.currentTarget.statusText;
                    }
                    scope.parser.callbacks.onError(errorMessage);
                };
            }
            if (!url) {
                onError('An invalid url was provided. Unable to continue!');
            }
            let urlFull = new URL(url, window.location.href).href;
            let filename = urlFull;
            let urlParts = urlFull.split('/');
            if (urlParts.length > 2) {
                filename = urlParts[urlParts.length - 1];
                this.path = urlParts.slice(0, urlParts.length - 1).join('/') + '/';
            }
            if (onFileLoadProgress === null || onFileLoadProgress === undefined || !(onFileLoadProgress instanceof Function)) {
                let numericalValueRef = 0;
                let numericalValue = 0;
                onFileLoadProgress = function (event) {
                    if (!event.lengthComputable)
                        return;
                    numericalValue = event.loaded / event.total;
                    if (numericalValue > numericalValueRef) {
                        numericalValueRef = numericalValue;
                        let output = 'Download of "' + url + '": ' + (numericalValue * 100).toFixed(2) + '%';
                        scope.parser.callbacks.onProgress('progressLoad', output, numericalValue);
                    }
                };
            }
            this.setCallbackOnMeshAlter(onMeshAlter);
            let fileLoaderOnLoad = function (content) {
                scope.parser.callbacks.onLoad(scope.parse(content), 'OBJLoader2#load: Parsing completed');
            };
            let fileLoader = new THREE.FileLoader(this.manager);
            fileLoader.setPath(this.path || this.resourcePath);
            fileLoader.setResponseType('arraybuffer');
            fileLoader.load(filename, fileLoaderOnLoad, onFileLoadProgress, onError);
        },
        parse: function (content) {
            if (content === null || content === undefined) {
                throw 'Provided content is not a valid ArrayBuffer or String. Unable to continue parsing';
            }
            if (this.parser.logging.enabled) {
                console.time('OBJLoader parse: ' + this.modelName);
            }
            this.materialHandler.createDefaultMaterials(false);
            this.parser.setMaterials(this.materialHandler.getMaterials());
            if (content instanceof ArrayBuffer || content instanceof Uint8Array) {
                if (this.parser.logging.enabled)
                    console.info('Parsing arrayBuffer...');
                this.parser.execute(content);
            } else if (typeof content === 'string' || content instanceof String) {
                if (this.parser.logging.enabled)
                    console.info('Parsing text...');
                this.parser.executeLegacy(content);
            } else {
                this.parser.callbacks.onError('Provided content was neither of type String nor Uint8Array! Aborting...');
            }
            if (this.parser.logging.enabled) {
                console.timeEnd('OBJLoader parse: ' + this.modelName);
            }
            return this.baseObject3d;
        },
        _onAssetAvailable: function (payload) {
            if (payload.cmd !== 'assetAvailable')
                return;
            if (payload.type === 'mesh') {
                let meshes = this.meshReceiver.buildMeshes(payload);
                for (let mesh of meshes) {
                    this.baseObject3d.add(mesh);
                }
            } else if (payload.type === 'material') {
                this.materialHandler.addPayloadMaterials(payload);
            }
        }
    });
    return threex.loaders.OBJLoader2 = OBJLoader2;
});
define('skylark-threejs-ex/loaders/PCDLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var PCDLoader = function (manager) {
        THREE.Loader.call(this, manager);
        this.littleEndian = true;
    };
    PCDLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: PCDLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var loader = new THREE.FileLoader(scope.manager);
            loader.setPath(scope.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (data) {
                try {
                    onLoad(scope.parse(data, url));
                } catch (e) {
                    if (onError) {
                        onError(e);
                    } else {
                        throw e;
                    }
                }
            }, onProgress, onError);
        },
        parse: function (data, url) {
            function decompressLZF(inData, outLength) {
                var inLength = inData.length;
                var outData = new Uint8Array(outLength);
                var inPtr = 0;
                var outPtr = 0;
                var ctrl;
                var len;
                var ref;
                do {
                    ctrl = inData[inPtr++];
                    if (ctrl < 1 << 5) {
                        ctrl++;
                        if (outPtr + ctrl > outLength)
                            throw new Error('Output buffer is not large enough');
                        if (inPtr + ctrl > inLength)
                            throw new Error('Invalid compressed data');
                        do {
                            outData[outPtr++] = inData[inPtr++];
                        } while (--ctrl);
                    } else {
                        len = ctrl >> 5;
                        ref = outPtr - ((ctrl & 31) << 8) - 1;
                        if (inPtr >= inLength)
                            throw new Error('Invalid compressed data');
                        if (len === 7) {
                            len += inData[inPtr++];
                            if (inPtr >= inLength)
                                throw new Error('Invalid compressed data');
                        }
                        ref -= inData[inPtr++];
                        if (outPtr + len + 2 > outLength)
                            throw new Error('Output buffer is not large enough');
                        if (ref < 0)
                            throw new Error('Invalid compressed data');
                        if (ref >= outPtr)
                            throw new Error('Invalid compressed data');
                        do {
                            outData[outPtr++] = outData[ref++];
                        } while (--len + 2);
                    }
                } while (inPtr < inLength);
                return outData;
            }
            function parseHeader(data) {
                var PCDheader = {};
                var result1 = data.search(/[\r\n]DATA\s(\S*)\s/i);
                var result2 = /[\r\n]DATA\s(\S*)\s/i.exec(data.substr(result1 - 1));
                PCDheader.data = result2[1];
                PCDheader.headerLen = result2[0].length + result1;
                PCDheader.str = data.substr(0, PCDheader.headerLen);
                PCDheader.str = PCDheader.str.replace(/\#.*/gi, '');
                PCDheader.version = /VERSION (.*)/i.exec(PCDheader.str);
                PCDheader.fields = /FIELDS (.*)/i.exec(PCDheader.str);
                PCDheader.size = /SIZE (.*)/i.exec(PCDheader.str);
                PCDheader.type = /TYPE (.*)/i.exec(PCDheader.str);
                PCDheader.count = /COUNT (.*)/i.exec(PCDheader.str);
                PCDheader.width = /WIDTH (.*)/i.exec(PCDheader.str);
                PCDheader.height = /HEIGHT (.*)/i.exec(PCDheader.str);
                PCDheader.viewpoint = /VIEWPOINT (.*)/i.exec(PCDheader.str);
                PCDheader.points = /POINTS (.*)/i.exec(PCDheader.str);
                if (PCDheader.version !== null)
                    PCDheader.version = parseFloat(PCDheader.version[1]);
                if (PCDheader.fields !== null)
                    PCDheader.fields = PCDheader.fields[1].split(' ');
                if (PCDheader.type !== null)
                    PCDheader.type = PCDheader.type[1].split(' ');
                if (PCDheader.width !== null)
                    PCDheader.width = parseInt(PCDheader.width[1]);
                if (PCDheader.height !== null)
                    PCDheader.height = parseInt(PCDheader.height[1]);
                if (PCDheader.viewpoint !== null)
                    PCDheader.viewpoint = PCDheader.viewpoint[1];
                if (PCDheader.points !== null)
                    PCDheader.points = parseInt(PCDheader.points[1], 10);
                if (PCDheader.points === null)
                    PCDheader.points = PCDheader.width * PCDheader.height;
                if (PCDheader.size !== null) {
                    PCDheader.size = PCDheader.size[1].split(' ').map(function (x) {
                        return parseInt(x, 10);
                    });
                }
                if (PCDheader.count !== null) {
                    PCDheader.count = PCDheader.count[1].split(' ').map(function (x) {
                        return parseInt(x, 10);
                    });
                } else {
                    PCDheader.count = [];
                    for (var i = 0, l = PCDheader.fields.length; i < l; i++) {
                        PCDheader.count.push(1);
                    }
                }
                PCDheader.offset = {};
                var sizeSum = 0;
                for (var i = 0, l = PCDheader.fields.length; i < l; i++) {
                    if (PCDheader.data === 'ascii') {
                        PCDheader.offset[PCDheader.fields[i]] = i;
                    } else {
                        PCDheader.offset[PCDheader.fields[i]] = sizeSum;
                        sizeSum += PCDheader.size[i];
                    }
                }
                PCDheader.rowSize = sizeSum;
                return PCDheader;
            }
            var textData = THREE.LoaderUtils.decodeText(new Uint8Array(data));
            var PCDheader = parseHeader(textData);
            var position = [];
            var normal = [];
            var color = [];
            if (PCDheader.data === 'ascii') {
                var offset = PCDheader.offset;
                var pcdData = textData.substr(PCDheader.headerLen);
                var lines = pcdData.split('\n');
                for (var i = 0, l = lines.length; i < l; i++) {
                    if (lines[i] === '')
                        continue;
                    var line = lines[i].split(' ');
                    if (offset.x !== undefined) {
                        position.push(parseFloat(line[offset.x]));
                        position.push(parseFloat(line[offset.y]));
                        position.push(parseFloat(line[offset.z]));
                    }
                    if (offset.rgb !== undefined) {
                        var rgb = parseFloat(line[offset.rgb]);
                        var r = rgb >> 16 & 255;
                        var g = rgb >> 8 & 255;
                        var b = rgb >> 0 & 255;
                        color.push(r / 255, g / 255, b / 255);
                    }
                    if (offset.normal_x !== undefined) {
                        normal.push(parseFloat(line[offset.normal_x]));
                        normal.push(parseFloat(line[offset.normal_y]));
                        normal.push(parseFloat(line[offset.normal_z]));
                    }
                }
            }
            if (PCDheader.data === 'binary_compressed') {
                var sizes = new Uint32Array(data.slice(PCDheader.headerLen, PCDheader.headerLen + 8));
                var compressedSize = sizes[0];
                var decompressedSize = sizes[1];
                var decompressed = decompressLZF(new Uint8Array(data, PCDheader.headerLen + 8, compressedSize), decompressedSize);
                var dataview = new DataView(decompressed.buffer);
                var offset = PCDheader.offset;
                for (var i = 0; i < PCDheader.points; i++) {
                    if (offset.x !== undefined) {
                        position.push(dataview.getFloat32(PCDheader.points * offset.x + PCDheader.size[0] * i, this.littleEndian));
                        position.push(dataview.getFloat32(PCDheader.points * offset.y + PCDheader.size[1] * i, this.littleEndian));
                        position.push(dataview.getFloat32(PCDheader.points * offset.z + PCDheader.size[2] * i, this.littleEndian));
                    }
                    if (offset.rgb !== undefined) {
                        color.push(dataview.getUint8(PCDheader.points * offset.rgb + PCDheader.size[3] * i + 0) / 255);
                        color.push(dataview.getUint8(PCDheader.points * offset.rgb + PCDheader.size[3] * i + 1) / 255);
                        color.push(dataview.getUint8(PCDheader.points * offset.rgb + PCDheader.size[3] * i + 2) / 255);
                    }
                    if (offset.normal_x !== undefined) {
                        normal.push(dataview.getFloat32(PCDheader.points * offset.normal_x + PCDheader.size[4] * i, this.littleEndian));
                        normal.push(dataview.getFloat32(PCDheader.points * offset.normal_y + PCDheader.size[5] * i, this.littleEndian));
                        normal.push(dataview.getFloat32(PCDheader.points * offset.normal_z + PCDheader.size[6] * i, this.littleEndian));
                    }
                }
            }
            if (PCDheader.data === 'binary') {
                var dataview = new DataView(data, PCDheader.headerLen);
                var offset = PCDheader.offset;
                for (var i = 0, row = 0; i < PCDheader.points; i++, row += PCDheader.rowSize) {
                    if (offset.x !== undefined) {
                        position.push(dataview.getFloat32(row + offset.x, this.littleEndian));
                        position.push(dataview.getFloat32(row + offset.y, this.littleEndian));
                        position.push(dataview.getFloat32(row + offset.z, this.littleEndian));
                    }
                    if (offset.rgb !== undefined) {
                        color.push(dataview.getUint8(row + offset.rgb + 2) / 255);
                        color.push(dataview.getUint8(row + offset.rgb + 1) / 255);
                        color.push(dataview.getUint8(row + offset.rgb + 0) / 255);
                    }
                    if (offset.normal_x !== undefined) {
                        normal.push(dataview.getFloat32(row + offset.normal_x, this.littleEndian));
                        normal.push(dataview.getFloat32(row + offset.normal_y, this.littleEndian));
                        normal.push(dataview.getFloat32(row + offset.normal_z, this.littleEndian));
                    }
                }
            }
            var geometry = new THREE.BufferGeometry();
            if (position.length > 0)
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(position, 3));
            if (normal.length > 0)
                geometry.setAttribute('normal', new THREE.Float32BufferAttribute(normal, 3));
            if (color.length > 0)
                geometry.setAttribute('color', new THREE.Float32BufferAttribute(color, 3));
            geometry.computeBoundingSphere();
            var material = new THREE.PointsMaterial({ size: 0.005 });
            if (color.length > 0) {
                material.vertexColors = true;
            } else {
                material.color.setHex(Math.random() * 16777215);
            }
            var mesh = new THREE.Points(geometry, material);
            var name = url.split('').reverse().join('');
            name = /([^\/]*)/.exec(name);
            name = name[1].split('').reverse().join('');
            mesh.name = name;
            return mesh;
        }
    });

    return threex.loaders.PCDLoader = PCDLoader;
});
define('skylark-threejs-ex/loaders/PLYLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var PLYLoader = function (manager) {
        THREE.Loader.call(this, manager);
        this.propertyNameMapping = {};
    };
    PLYLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: PLYLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var loader = new THREE.FileLoader(this.manager);
            loader.setPath(this.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (text) {
                onLoad(scope.parse(text));
            }, onProgress, onError);
        },
        setPropertyNameMapping: function (mapping) {
            this.propertyNameMapping = mapping;
        },
        parse: function (data) {
            function parseHeader(data) {
                var patternHeader = /ply([\s\S]*)end_header\r?\n/;
                var headerText = '';
                var headerLength = 0;
                var result = patternHeader.exec(data);
                if (result !== null) {
                    headerText = result[1];
                    headerLength = result[0].length;
                }
                var header = {
                    comments: [],
                    elements: [],
                    headerLength: headerLength
                };
                var lines = headerText.split('\n');
                var currentElement;
                var lineType, lineValues;
                function make_ply_element_property(propertValues, propertyNameMapping) {
                    var property = { type: propertValues[0] };
                    if (property.type === 'list') {
                        property.name = propertValues[3];
                        property.countType = propertValues[1];
                        property.itemType = propertValues[2];
                    } else {
                        property.name = propertValues[1];
                    }
                    if (property.name in propertyNameMapping) {
                        property.name = propertyNameMapping[property.name];
                    }
                    return property;
                }
                for (var i = 0; i < lines.length; i++) {
                    var line = lines[i];
                    line = line.trim();
                    if (line === '')
                        continue;
                    lineValues = line.split(/\s+/);
                    lineType = lineValues.shift();
                    line = lineValues.join(' ');
                    switch (lineType) {
                    case 'format':
                        header.format = lineValues[0];
                        header.version = lineValues[1];
                        break;
                    case 'comment':
                        header.comments.push(line);
                        break;
                    case 'element':
                        if (currentElement !== undefined) {
                            header.elements.push(currentElement);
                        }
                        currentElement = {};
                        currentElement.name = lineValues[0];
                        currentElement.count = parseInt(lineValues[1]);
                        currentElement.properties = [];
                        break;
                    case 'property':
                        currentElement.properties.push(make_ply_element_property(lineValues, scope.propertyNameMapping));
                        break;
                    default:
                        console.log('unhandled', lineType, lineValues);
                    }
                }
                if (currentElement !== undefined) {
                    header.elements.push(currentElement);
                }
                return header;
            }
            function parseASCIINumber(n, type) {
                switch (type) {
                case 'char':
                case 'uchar':
                case 'short':
                case 'ushort':
                case 'int':
                case 'uint':
                case 'int8':
                case 'uint8':
                case 'int16':
                case 'uint16':
                case 'int32':
                case 'uint32':
                    return parseInt(n);
                case 'float':
                case 'double':
                case 'float32':
                case 'float64':
                    return parseFloat(n);
                }
            }
            function parseASCIIElement(properties, line) {
                var values = line.split(/\s+/);
                var element = {};
                for (var i = 0; i < properties.length; i++) {
                    if (properties[i].type === 'list') {
                        var list = [];
                        var n = parseASCIINumber(values.shift(), properties[i].countType);
                        for (var j = 0; j < n; j++) {
                            list.push(parseASCIINumber(values.shift(), properties[i].itemType));
                        }
                        element[properties[i].name] = list;
                    } else {
                        element[properties[i].name] = parseASCIINumber(values.shift(), properties[i].type);
                    }
                }
                return element;
            }
            function parseASCII(data, header) {
                var buffer = {
                    indices: [],
                    vertices: [],
                    normals: [],
                    uvs: [],
                    faceVertexUvs: [],
                    colors: []
                };
                var result;
                var patternBody = /end_header\s([\s\S]*)$/;
                var body = '';
                if ((result = patternBody.exec(data)) !== null) {
                    body = result[1];
                }
                var lines = body.split('\n');
                var currentElement = 0;
                var currentElementCount = 0;
                for (var i = 0; i < lines.length; i++) {
                    var line = lines[i];
                    line = line.trim();
                    if (line === '') {
                        continue;
                    }
                    if (currentElementCount >= header.elements[currentElement].count) {
                        currentElement++;
                        currentElementCount = 0;
                    }
                    var element = parseASCIIElement(header.elements[currentElement].properties, line);
                    handleElement(buffer, header.elements[currentElement].name, element);
                    currentElementCount++;
                }
                return postProcess(buffer);
            }
            function postProcess(buffer) {
                var geometry = new THREE.BufferGeometry();
                if (buffer.indices.length > 0) {
                    geometry.setIndex(buffer.indices);
                }
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(buffer.vertices, 3));
                if (buffer.normals.length > 0) {
                    geometry.setAttribute('normal', new THREE.Float32BufferAttribute(buffer.normals, 3));
                }
                if (buffer.uvs.length > 0) {
                    geometry.setAttribute('uv', new THREE.Float32BufferAttribute(buffer.uvs, 2));
                }
                if (buffer.colors.length > 0) {
                    geometry.setAttribute('color', new THREE.Float32BufferAttribute(buffer.colors, 3));
                }
                if (buffer.faceVertexUvs.length > 0) {
                    geometry = geometry.toNonIndexed();
                    geometry.setAttribute('uv', new THREE.Float32BufferAttribute(buffer.faceVertexUvs, 2));
                }
                geometry.computeBoundingSphere();
                return geometry;
            }
            function handleElement(buffer, elementName, element) {
                if (elementName === 'vertex') {
                    buffer.vertices.push(element.x, element.y, element.z);
                    if ('nx' in element && 'ny' in element && 'nz' in element) {
                        buffer.normals.push(element.nx, element.ny, element.nz);
                    }
                    if ('s' in element && 't' in element) {
                        buffer.uvs.push(element.s, element.t);
                    }
                    if ('red' in element && 'green' in element && 'blue' in element) {
                        buffer.colors.push(element.red / 255, element.green / 255, element.blue / 255);
                    }
                } else if (elementName === 'face') {
                    var vertex_indices = element.vertex_indices || element.vertex_index;
                    var texcoord = element.texcoord;
                    if (vertex_indices.length === 3) {
                        buffer.indices.push(vertex_indices[0], vertex_indices[1], vertex_indices[2]);
                        if (texcoord && texcoord.length === 6) {
                            buffer.faceVertexUvs.push(texcoord[0], texcoord[1]);
                            buffer.faceVertexUvs.push(texcoord[2], texcoord[3]);
                            buffer.faceVertexUvs.push(texcoord[4], texcoord[5]);
                        }
                    } else if (vertex_indices.length === 4) {
                        buffer.indices.push(vertex_indices[0], vertex_indices[1], vertex_indices[3]);
                        buffer.indices.push(vertex_indices[1], vertex_indices[2], vertex_indices[3]);
                    }
                }
            }
            function binaryRead(dataview, at, type, little_endian) {
                switch (type) {
                case 'int8':
                case 'char':
                    return [
                        dataview.getInt8(at),
                        1
                    ];
                case 'uint8':
                case 'uchar':
                    return [
                        dataview.getUint8(at),
                        1
                    ];
                case 'int16':
                case 'short':
                    return [
                        dataview.getInt16(at, little_endian),
                        2
                    ];
                case 'uint16':
                case 'ushort':
                    return [
                        dataview.getUint16(at, little_endian),
                        2
                    ];
                case 'int32':
                case 'int':
                    return [
                        dataview.getInt32(at, little_endian),
                        4
                    ];
                case 'uint32':
                case 'uint':
                    return [
                        dataview.getUint32(at, little_endian),
                        4
                    ];
                case 'float32':
                case 'float':
                    return [
                        dataview.getFloat32(at, little_endian),
                        4
                    ];
                case 'float64':
                case 'double':
                    return [
                        dataview.getFloat64(at, little_endian),
                        8
                    ];
                }
            }
            function binaryReadElement(dataview, at, properties, little_endian) {
                var element = {};
                var result, read = 0;
                for (var i = 0; i < properties.length; i++) {
                    if (properties[i].type === 'list') {
                        var list = [];
                        result = binaryRead(dataview, at + read, properties[i].countType, little_endian);
                        var n = result[0];
                        read += result[1];
                        for (var j = 0; j < n; j++) {
                            result = binaryRead(dataview, at + read, properties[i].itemType, little_endian);
                            list.push(result[0]);
                            read += result[1];
                        }
                        element[properties[i].name] = list;
                    } else {
                        result = binaryRead(dataview, at + read, properties[i].type, little_endian);
                        element[properties[i].name] = result[0];
                        read += result[1];
                    }
                }
                return [
                    element,
                    read
                ];
            }
            function parseBinary(data, header) {
                var buffer = {
                    indices: [],
                    vertices: [],
                    normals: [],
                    uvs: [],
                    faceVertexUvs: [],
                    colors: []
                };
                var little_endian = header.format === 'binary_little_endian';
                var body = new DataView(data, header.headerLength);
                var result, loc = 0;
                for (var currentElement = 0; currentElement < header.elements.length; currentElement++) {
                    for (var currentElementCount = 0; currentElementCount < header.elements[currentElement].count; currentElementCount++) {
                        result = binaryReadElement(body, loc, header.elements[currentElement].properties, little_endian);
                        loc += result[1];
                        var element = result[0];
                        handleElement(buffer, header.elements[currentElement].name, element);
                    }
                }
                return postProcess(buffer);
            }
            var geometry;
            var scope = this;
            if (data instanceof ArrayBuffer) {
                var text = THREE.LoaderUtils.decodeText(new Uint8Array(data));
                var header = parseHeader(text);
                geometry = header.format === 'ascii' ? parseASCII(text, header) : parseBinary(data, header);
            } else {
                geometry = parseASCII(data, parseHeader(data));
            }
            return geometry;
        }
    });
    return threex.loaders.PLYLoader = PLYLoader;
});
define('skylark-threejs-ex/loaders/PRWMLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var PRWMLoader = function () {
        var bigEndianPlatform = null;
        function isBigEndianPlatform() {
            if (bigEndianPlatform === null) {
                var buffer = new ArrayBuffer(2), uint8Array = new Uint8Array(buffer), uint16Array = new Uint16Array(buffer);
                uint8Array[0] = 170;
                uint8Array[1] = 187;
                bigEndianPlatform = uint16Array[0] === 43707;
            }
            return bigEndianPlatform;
        }
        var InvertedEncodingTypes = [
            null,
            Float32Array,
            null,
            Int8Array,
            Int16Array,
            null,
            Int32Array,
            Uint8Array,
            Uint16Array,
            null,
            Uint32Array
        ];
        var getMethods = {
            Uint16Array: 'getUint16',
            Uint32Array: 'getUint32',
            Int16Array: 'getInt16',
            Int32Array: 'getInt32',
            Float32Array: 'getFloat32',
            Float64Array: 'getFloat64'
        };
        function copyFromBuffer(sourceArrayBuffer, viewType, position, length, fromBigEndian) {
            var bytesPerElement = viewType.BYTES_PER_ELEMENT, result;
            if (fromBigEndian === isBigEndianPlatform() || bytesPerElement === 1) {
                result = new viewType(sourceArrayBuffer, position, length);
            } else {
                var readView = new DataView(sourceArrayBuffer, position, length * bytesPerElement), getMethod = getMethods[viewType.name], littleEndian = !fromBigEndian, i = 0;
                result = new viewType(length);
                for (; i < length; i++) {
                    result[i] = readView[getMethod](i * bytesPerElement, littleEndian);
                }
            }
            return result;
        }
        function decodePrwm(buffer) {
            var array = new Uint8Array(buffer), version = array[0], flags = array[1], indexedGeometry = !!(flags >> 7 & 1), indicesType = flags >> 6 & 1, bigEndian = (flags >> 5 & 1) === 1, attributesNumber = flags & 31, valuesNumber = 0, indicesNumber = 0;
            if (bigEndian) {
                valuesNumber = (array[2] << 16) + (array[3] << 8) + array[4];
                indicesNumber = (array[5] << 16) + (array[6] << 8) + array[7];
            } else {
                valuesNumber = array[2] + (array[3] << 8) + (array[4] << 16);
                indicesNumber = array[5] + (array[6] << 8) + (array[7] << 16);
            }
            if (version === 0) {
                throw new Error('PRWM decoder: Invalid format version: 0');
            } else if (version !== 1) {
                throw new Error('PRWM decoder: Unsupported format version: ' + version);
            }
            if (!indexedGeometry) {
                if (indicesType !== 0) {
                    throw new Error('PRWM decoder: Indices type must be set to 0 for non-indexed geometries');
                } else if (indicesNumber !== 0) {
                    throw new Error('PRWM decoder: Number of indices must be set to 0 for non-indexed geometries');
                }
            }
            var pos = 8;
            var attributes = {}, attributeName, char, attributeType, cardinality, encodingType, arrayType, values, indices, i;
            for (i = 0; i < attributesNumber; i++) {
                attributeName = '';
                while (pos < array.length) {
                    char = array[pos];
                    pos++;
                    if (char === 0) {
                        break;
                    } else {
                        attributeName += String.fromCharCode(char);
                    }
                }
                flags = array[pos];
                attributeType = flags >> 7 & 1;
                cardinality = (flags >> 4 & 3) + 1;
                encodingType = flags & 15;
                arrayType = InvertedEncodingTypes[encodingType];
                pos++;
                pos = Math.ceil(pos / 4) * 4;
                values = copyFromBuffer(buffer, arrayType, pos, cardinality * valuesNumber, bigEndian);
                pos += arrayType.BYTES_PER_ELEMENT * cardinality * valuesNumber;
                attributes[attributeName] = {
                    type: attributeType,
                    cardinality: cardinality,
                    values: values
                };
            }
            pos = Math.ceil(pos / 4) * 4;
            indices = null;
            if (indexedGeometry) {
                indices = copyFromBuffer(buffer, indicesType === 1 ? Uint32Array : Uint16Array, pos, indicesNumber, bigEndian);
            }
            return {
                version: version,
                attributes: attributes,
                indices: indices
            };
        }
        function PRWMLoader(manager) {
            THREE.Loader.call(this, manager);
        }
        PRWMLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
            constructor: PRWMLoader,
            load: function (url, onLoad, onProgress, onError) {
                var scope = this;
                var loader = new THREE.FileLoader(scope.manager);
                loader.setPath(scope.path);
                loader.setResponseType('arraybuffer');
                url = url.replace(/\*/g, isBigEndianPlatform() ? 'be' : 'le');
                loader.load(url, function (arrayBuffer) {
                    onLoad(scope.parse(arrayBuffer));
                }, onProgress, onError);
            },
            parse: function (arrayBuffer) {
                var data = decodePrwm(arrayBuffer), attributesKey = Object.keys(data.attributes), bufferGeometry = new THREE.BufferGeometry(), attribute, i;
                for (i = 0; i < attributesKey.length; i++) {
                    attribute = data.attributes[attributesKey[i]];
                    bufferGeometry.setAttribute(attributesKey[i], new THREE.BufferAttribute(attribute.values, attribute.cardinality, attribute.normalized));
                }
                if (data.indices !== null) {
                    bufferGeometry.setIndex(new THREE.BufferAttribute(data.indices, 1));
                }
                return bufferGeometry;
            }
        });
        PRWMLoader.isBigEndianPlatform = function () {
            return isBigEndianPlatform();
        };
        return PRWMLoader;
    }();

    return threex.loaders.PRWMLoader = PRWMLoader;
});
define('skylark-threejs-ex/loaders/STLLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var STLLoader = function (manager) {
        THREE.Loader.call(this, manager);
    };
    STLLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: STLLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var loader = new THREE.FileLoader(scope.manager);
            loader.setPath(scope.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (text) {
                try {
                    onLoad(scope.parse(text));
                } catch (exception) {
                    if (onError) {
                        onError(exception);
                    }
                }
            }, onProgress, onError);
        },
        parse: function (data) {
            function isBinary(data) {
                var expect, face_size, n_faces, reader;
                reader = new DataView(data);
                face_size = 32 / 8 * 3 + 32 / 8 * 3 * 3 + 16 / 8;
                n_faces = reader.getUint32(80, true);
                expect = 80 + 32 / 8 + n_faces * face_size;
                if (expect === reader.byteLength) {
                    return true;
                }
                var solid = [
                    115,
                    111,
                    108,
                    105,
                    100
                ];
                for (var off = 0; off < 5; off++) {
                    if (matchDataViewAt(solid, reader, off))
                        return false;
                }
                return true;
            }
            function matchDataViewAt(query, reader, offset) {
                for (var i = 0, il = query.length; i < il; i++) {
                    if (query[i] !== reader.getUint8(offset + i, false))
                        return false;
                }
                return true;
            }
            function parseBinary(data) {
                var reader = new DataView(data);
                var faces = reader.getUint32(80, true);
                var r, g, b, hasColors = false, colors;
                var defaultR, defaultG, defaultB, alpha;
                for (var index = 0; index < 80 - 10; index++) {
                    if (reader.getUint32(index, false) == 1129270351 && reader.getUint8(index + 4) == 82 && reader.getUint8(index + 5) == 61) {
                        hasColors = true;
                        colors = new Float32Array(faces * 3 * 3);
                        defaultR = reader.getUint8(index + 6) / 255;
                        defaultG = reader.getUint8(index + 7) / 255;
                        defaultB = reader.getUint8(index + 8) / 255;
                        alpha = reader.getUint8(index + 9) / 255;
                    }
                }
                var dataOffset = 84;
                var faceLength = 12 * 4 + 2;
                var geometry = new THREE.BufferGeometry();
                var vertices = new Float32Array(faces * 3 * 3);
                var normals = new Float32Array(faces * 3 * 3);
                for (var face = 0; face < faces; face++) {
                    var start = dataOffset + face * faceLength;
                    var normalX = reader.getFloat32(start, true);
                    var normalY = reader.getFloat32(start + 4, true);
                    var normalZ = reader.getFloat32(start + 8, true);
                    if (hasColors) {
                        var packedColor = reader.getUint16(start + 48, true);
                        if ((packedColor & 32768) === 0) {
                            r = (packedColor & 31) / 31;
                            g = (packedColor >> 5 & 31) / 31;
                            b = (packedColor >> 10 & 31) / 31;
                        } else {
                            r = defaultR;
                            g = defaultG;
                            b = defaultB;
                        }
                    }
                    for (var i = 1; i <= 3; i++) {
                        var vertexstart = start + i * 12;
                        var componentIdx = face * 3 * 3 + (i - 1) * 3;
                        vertices[componentIdx] = reader.getFloat32(vertexstart, true);
                        vertices[componentIdx + 1] = reader.getFloat32(vertexstart + 4, true);
                        vertices[componentIdx + 2] = reader.getFloat32(vertexstart + 8, true);
                        normals[componentIdx] = normalX;
                        normals[componentIdx + 1] = normalY;
                        normals[componentIdx + 2] = normalZ;
                        if (hasColors) {
                            colors[componentIdx] = r;
                            colors[componentIdx + 1] = g;
                            colors[componentIdx + 2] = b;
                        }
                    }
                }
                geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
                geometry.setAttribute('normal', new THREE.BufferAttribute(normals, 3));
                if (hasColors) {
                    geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
                    geometry.hasColors = true;
                    geometry.alpha = alpha;
                }
                return geometry;
            }
            function parseASCII(data) {
                var geometry = new THREE.BufferGeometry();
                var patternSolid = /solid([\s\S]*?)endsolid/g;
                var patternFace = /facet([\s\S]*?)endfacet/g;
                var faceCounter = 0;
                var patternFloat = /[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source;
                var patternVertex = new RegExp('vertex' + patternFloat + patternFloat + patternFloat, 'g');
                var patternNormal = new RegExp('normal' + patternFloat + patternFloat + patternFloat, 'g');
                var vertices = [];
                var normals = [];
                var normal = new THREE.Vector3();
                var result;
                var groupCount = 0;
                var startVertex = 0;
                var endVertex = 0;
                while ((result = patternSolid.exec(data)) !== null) {
                    startVertex = endVertex;
                    var solid = result[0];
                    while ((result = patternFace.exec(solid)) !== null) {
                        var vertexCountPerFace = 0;
                        var normalCountPerFace = 0;
                        var text = result[0];
                        while ((result = patternNormal.exec(text)) !== null) {
                            normal.x = parseFloat(result[1]);
                            normal.y = parseFloat(result[2]);
                            normal.z = parseFloat(result[3]);
                            normalCountPerFace++;
                        }
                        while ((result = patternVertex.exec(text)) !== null) {
                            vertices.push(parseFloat(result[1]), parseFloat(result[2]), parseFloat(result[3]));
                            normals.push(normal.x, normal.y, normal.z);
                            vertexCountPerFace++;
                            endVertex++;
                        }
                        if (normalCountPerFace !== 1) {
                            console.error("THREE.STLLoader: Something isn't right with the normal of face number " + faceCounter);
                        }
                        if (vertexCountPerFace !== 3) {
                            console.error("THREE.STLLoader: Something isn't right with the vertices of face number " + faceCounter);
                        }
                        faceCounter++;
                    }
                    var start = startVertex;
                    var count = endVertex - startVertex;
                    geometry.addGroup(start, count, groupCount);
                    groupCount++;
                }
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
                geometry.setAttribute('normal', new THREE.Float32BufferAttribute(normals, 3));
                return geometry;
            }
            function ensureString(buffer) {
                if (typeof buffer !== 'string') {
                    return THREE.LoaderUtils.decodeText(new Uint8Array(buffer));
                }
                return buffer;
            }
            function ensureBinary(buffer) {
                if (typeof buffer === 'string') {
                    var array_buffer = new Uint8Array(buffer.length);
                    for (var i = 0; i < buffer.length; i++) {
                        array_buffer[i] = buffer.charCodeAt(i) & 255;
                    }
                    return array_buffer.buffer || array_buffer;
                } else {
                    return buffer;
                }
            }
            var binData = ensureBinary(data);
            return isBinary(binData) ? parseBinary(binData) : parseASCII(ensureString(data));
        }
    });

    return threex.loaders.STLLoader = STLLoader;
});
define('skylark-threejs-ex/loaders/SVGLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var SVGLoader = function (manager) {
        THREE.Loader.call(this, manager);
        this.defaultDPI = 90;
        this.defaultUnit = 'px';
    };
    SVGLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: SVGLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var loader = new THREE.FileLoader(scope.manager);
            loader.setPath(scope.path);
            loader.load(url, function (text) {
                onLoad(scope.parse(text));
            }, onProgress, onError);
        },
        parse: function (text) {
            var scope = this;
            function parseNode(node, style) {
                if (node.nodeType !== 1)
                    return;
                var transform = getNodeTransform(node);
                var path = null;
                switch (node.nodeName) {
                case 'svg':
                    break;
                case 'g':
                    style = parseStyle(node, style);
                    break;
                case 'path':
                    style = parseStyle(node, style);
                    if (node.hasAttribute('d'))
                        path = parsePathNode(node);
                    break;
                case 'rect':
                    style = parseStyle(node, style);
                    path = parseRectNode(node);
                    break;
                case 'polygon':
                    style = parseStyle(node, style);
                    path = parsePolygonNode(node);
                    break;
                case 'polyline':
                    style = parseStyle(node, style);
                    path = parsePolylineNode(node);
                    break;
                case 'circle':
                    style = parseStyle(node, style);
                    path = parseCircleNode(node);
                    break;
                case 'ellipse':
                    style = parseStyle(node, style);
                    path = parseEllipseNode(node);
                    break;
                case 'line':
                    style = parseStyle(node, style);
                    path = parseLineNode(node);
                    break;
                default:
                    console.log(node);
                }
                if (path) {
                    if (style.fill !== undefined && style.fill !== 'none') {
                        path.color.setStyle(style.fill);
                    }
                    transformPath(path, currentTransform);
                    paths.push(path);
                    path.userData = {
                        node: node,
                        style: style
                    };
                }
                var nodes = node.childNodes;
                for (var i = 0; i < nodes.length; i++) {
                    parseNode(nodes[i], style);
                }
                if (transform) {
                    transformStack.pop();
                    if (transformStack.length > 0) {
                        currentTransform.copy(transformStack[transformStack.length - 1]);
                    } else {
                        currentTransform.identity();
                    }
                }
            }
            function parsePathNode(node) {
                var path = new THREE.ShapePath();
                var point = new THREE.Vector2();
                var control = new THREE.Vector2();
                var firstPoint = new THREE.Vector2();
                var isFirstPoint = true;
                var doSetFirstPoint = false;
                var d = node.getAttribute('d');
                var commands = d.match(/[a-df-z][^a-df-z]*/ig);
                for (var i = 0, l = commands.length; i < l; i++) {
                    var command = commands[i];
                    var type = command.charAt(0);
                    var data = command.substr(1).trim();
                    if (isFirstPoint === true) {
                        doSetFirstPoint = true;
                        isFirstPoint = false;
                    }
                    switch (type) {
                    case 'M':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 2) {
                            point.x = numbers[j + 0];
                            point.y = numbers[j + 1];
                            control.x = point.x;
                            control.y = point.y;
                            if (j === 0) {
                                path.moveTo(point.x, point.y);
                            } else {
                                path.lineTo(point.x, point.y);
                            }
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'H':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j++) {
                            point.x = numbers[j];
                            control.x = point.x;
                            control.y = point.y;
                            path.lineTo(point.x, point.y);
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'V':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j++) {
                            point.y = numbers[j];
                            control.x = point.x;
                            control.y = point.y;
                            path.lineTo(point.x, point.y);
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'L':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 2) {
                            point.x = numbers[j + 0];
                            point.y = numbers[j + 1];
                            control.x = point.x;
                            control.y = point.y;
                            path.lineTo(point.x, point.y);
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'C':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 6) {
                            path.bezierCurveTo(numbers[j + 0], numbers[j + 1], numbers[j + 2], numbers[j + 3], numbers[j + 4], numbers[j + 5]);
                            control.x = numbers[j + 2];
                            control.y = numbers[j + 3];
                            point.x = numbers[j + 4];
                            point.y = numbers[j + 5];
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'S':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 4) {
                            path.bezierCurveTo(getReflection(point.x, control.x), getReflection(point.y, control.y), numbers[j + 0], numbers[j + 1], numbers[j + 2], numbers[j + 3]);
                            control.x = numbers[j + 0];
                            control.y = numbers[j + 1];
                            point.x = numbers[j + 2];
                            point.y = numbers[j + 3];
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'Q':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 4) {
                            path.quadraticCurveTo(numbers[j + 0], numbers[j + 1], numbers[j + 2], numbers[j + 3]);
                            control.x = numbers[j + 0];
                            control.y = numbers[j + 1];
                            point.x = numbers[j + 2];
                            point.y = numbers[j + 3];
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'T':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 2) {
                            var rx = getReflection(point.x, control.x);
                            var ry = getReflection(point.y, control.y);
                            path.quadraticCurveTo(rx, ry, numbers[j + 0], numbers[j + 1]);
                            control.x = rx;
                            control.y = ry;
                            point.x = numbers[j + 0];
                            point.y = numbers[j + 1];
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'A':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 7) {
                            var start = point.clone();
                            point.x = numbers[j + 5];
                            point.y = numbers[j + 6];
                            control.x = point.x;
                            control.y = point.y;
                            parseArcCommand(path, numbers[j], numbers[j + 1], numbers[j + 2], numbers[j + 3], numbers[j + 4], start, point);
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'm':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 2) {
                            point.x += numbers[j + 0];
                            point.y += numbers[j + 1];
                            control.x = point.x;
                            control.y = point.y;
                            if (j === 0) {
                                path.moveTo(point.x, point.y);
                            } else {
                                path.lineTo(point.x, point.y);
                            }
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'h':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j++) {
                            point.x += numbers[j];
                            control.x = point.x;
                            control.y = point.y;
                            path.lineTo(point.x, point.y);
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'v':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j++) {
                            point.y += numbers[j];
                            control.x = point.x;
                            control.y = point.y;
                            path.lineTo(point.x, point.y);
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'l':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 2) {
                            point.x += numbers[j + 0];
                            point.y += numbers[j + 1];
                            control.x = point.x;
                            control.y = point.y;
                            path.lineTo(point.x, point.y);
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'c':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 6) {
                            path.bezierCurveTo(point.x + numbers[j + 0], point.y + numbers[j + 1], point.x + numbers[j + 2], point.y + numbers[j + 3], point.x + numbers[j + 4], point.y + numbers[j + 5]);
                            control.x = point.x + numbers[j + 2];
                            control.y = point.y + numbers[j + 3];
                            point.x += numbers[j + 4];
                            point.y += numbers[j + 5];
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 's':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 4) {
                            path.bezierCurveTo(getReflection(point.x, control.x), getReflection(point.y, control.y), point.x + numbers[j + 0], point.y + numbers[j + 1], point.x + numbers[j + 2], point.y + numbers[j + 3]);
                            control.x = point.x + numbers[j + 0];
                            control.y = point.y + numbers[j + 1];
                            point.x += numbers[j + 2];
                            point.y += numbers[j + 3];
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'q':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 4) {
                            path.quadraticCurveTo(point.x + numbers[j + 0], point.y + numbers[j + 1], point.x + numbers[j + 2], point.y + numbers[j + 3]);
                            control.x = point.x + numbers[j + 0];
                            control.y = point.y + numbers[j + 1];
                            point.x += numbers[j + 2];
                            point.y += numbers[j + 3];
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 't':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 2) {
                            var rx = getReflection(point.x, control.x);
                            var ry = getReflection(point.y, control.y);
                            path.quadraticCurveTo(rx, ry, point.x + numbers[j + 0], point.y + numbers[j + 1]);
                            control.x = rx;
                            control.y = ry;
                            point.x = point.x + numbers[j + 0];
                            point.y = point.y + numbers[j + 1];
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'a':
                        var numbers = parseFloats(data);
                        for (var j = 0, jl = numbers.length; j < jl; j += 7) {
                            var start = point.clone();
                            point.x += numbers[j + 5];
                            point.y += numbers[j + 6];
                            control.x = point.x;
                            control.y = point.y;
                            parseArcCommand(path, numbers[j], numbers[j + 1], numbers[j + 2], numbers[j + 3], numbers[j + 4], start, point);
                            if (j === 0 && doSetFirstPoint === true)
                                firstPoint.copy(point);
                        }
                        break;
                    case 'Z':
                    case 'z':
                        path.currentPath.autoClose = true;
                        if (path.currentPath.curves.length > 0) {
                            point.copy(firstPoint);
                            path.currentPath.currentPoint.copy(point);
                            isFirstPoint = true;
                        }
                        break;
                    default:
                        console.warn(command);
                    }
                    doSetFirstPoint = false;
                }
                return path;
            }
            function parseArcCommand(path, rx, ry, x_axis_rotation, large_arc_flag, sweep_flag, start, end) {
                x_axis_rotation = x_axis_rotation * Math.PI / 180;
                rx = Math.abs(rx);
                ry = Math.abs(ry);
                var dx2 = (start.x - end.x) / 2;
                var dy2 = (start.y - end.y) / 2;
                var x1p = Math.cos(x_axis_rotation) * dx2 + Math.sin(x_axis_rotation) * dy2;
                var y1p = -Math.sin(x_axis_rotation) * dx2 + Math.cos(x_axis_rotation) * dy2;
                var rxs = rx * rx;
                var rys = ry * ry;
                var x1ps = x1p * x1p;
                var y1ps = y1p * y1p;
                var cr = x1ps / rxs + y1ps / rys;
                if (cr > 1) {
                    var s = Math.sqrt(cr);
                    rx = s * rx;
                    ry = s * ry;
                    rxs = rx * rx;
                    rys = ry * ry;
                }
                var dq = rxs * y1ps + rys * x1ps;
                var pq = (rxs * rys - dq) / dq;
                var q = Math.sqrt(Math.max(0, pq));
                if (large_arc_flag === sweep_flag)
                    q = -q;
                var cxp = q * rx * y1p / ry;
                var cyp = -q * ry * x1p / rx;
                var cx = Math.cos(x_axis_rotation) * cxp - Math.sin(x_axis_rotation) * cyp + (start.x + end.x) / 2;
                var cy = Math.sin(x_axis_rotation) * cxp + Math.cos(x_axis_rotation) * cyp + (start.y + end.y) / 2;
                var theta = svgAngle(1, 0, (x1p - cxp) / rx, (y1p - cyp) / ry);
                var delta = svgAngle((x1p - cxp) / rx, (y1p - cyp) / ry, (-x1p - cxp) / rx, (-y1p - cyp) / ry) % (Math.PI * 2);
                path.currentPath.absellipse(cx, cy, rx, ry, theta, theta + delta, sweep_flag === 0, x_axis_rotation);
            }
            function svgAngle(ux, uy, vx, vy) {
                var dot = ux * vx + uy * vy;
                var len = Math.sqrt(ux * ux + uy * uy) * Math.sqrt(vx * vx + vy * vy);
                var ang = Math.acos(Math.max(-1, Math.min(1, dot / len)));
                if (ux * vy - uy * vx < 0)
                    ang = -ang;
                return ang;
            }
            function parseRectNode(node) {
                var x = parseFloatWithUnits(node.getAttribute('x') || 0);
                var y = parseFloatWithUnits(node.getAttribute('y') || 0);
                var rx = parseFloatWithUnits(node.getAttribute('rx') || 0);
                var ry = parseFloatWithUnits(node.getAttribute('ry') || 0);
                var w = parseFloatWithUnits(node.getAttribute('width'));
                var h = parseFloatWithUnits(node.getAttribute('height'));
                var path = new THREE.ShapePath();
                path.moveTo(x + 2 * rx, y);
                path.lineTo(x + w - 2 * rx, y);
                if (rx !== 0 || ry !== 0)
                    path.bezierCurveTo(x + w, y, x + w, y, x + w, y + 2 * ry);
                path.lineTo(x + w, y + h - 2 * ry);
                if (rx !== 0 || ry !== 0)
                    path.bezierCurveTo(x + w, y + h, x + w, y + h, x + w - 2 * rx, y + h);
                path.lineTo(x + 2 * rx, y + h);
                if (rx !== 0 || ry !== 0) {
                    path.bezierCurveTo(x, y + h, x, y + h, x, y + h - 2 * ry);
                }
                path.lineTo(x, y + 2 * ry);
                if (rx !== 0 || ry !== 0) {
                    path.bezierCurveTo(x, y, x, y, x + 2 * rx, y);
                }
                return path;
            }
            function parsePolygonNode(node) {
                function iterator(match, a, b) {
                    var x = parseFloatWithUnits(a);
                    var y = parseFloatWithUnits(b);
                    if (index === 0) {
                        path.moveTo(x, y);
                    } else {
                        path.lineTo(x, y);
                    }
                    index++;
                }
                var regex = /(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g;
                var path = new THREE.ShapePath();
                var index = 0;
                node.getAttribute('points').replace(regex, iterator);
                path.currentPath.autoClose = true;
                return path;
            }
            function parsePolylineNode(node) {
                function iterator(match, a, b) {
                    var x = parseFloatWithUnits(a);
                    var y = parseFloatWithUnits(b);
                    if (index === 0) {
                        path.moveTo(x, y);
                    } else {
                        path.lineTo(x, y);
                    }
                    index++;
                }
                var regex = /(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g;
                var path = new THREE.ShapePath();
                var index = 0;
                node.getAttribute('points').replace(regex, iterator);
                path.currentPath.autoClose = false;
                return path;
            }
            function parseCircleNode(node) {
                var x = parseFloatWithUnits(node.getAttribute('cx'));
                var y = parseFloatWithUnits(node.getAttribute('cy'));
                var r = parseFloatWithUnits(node.getAttribute('r'));
                var subpath = new THREE.Path();
                subpath.absarc(x, y, r, 0, Math.PI * 2);
                var path = new THREE.ShapePath();
                path.subPaths.push(subpath);
                return path;
            }
            function parseEllipseNode(node) {
                var x = parseFloatWithUnits(node.getAttribute('cx'));
                var y = parseFloatWithUnits(node.getAttribute('cy'));
                var rx = parseFloatWithUnits(node.getAttribute('rx'));
                var ry = parseFloatWithUnits(node.getAttribute('ry'));
                var subpath = new THREE.Path();
                subpath.absellipse(x, y, rx, ry, 0, Math.PI * 2);
                var path = new THREE.ShapePath();
                path.subPaths.push(subpath);
                return path;
            }
            function parseLineNode(node) {
                var x1 = parseFloatWithUnits(node.getAttribute('x1'));
                var y1 = parseFloatWithUnits(node.getAttribute('y1'));
                var x2 = parseFloatWithUnits(node.getAttribute('x2'));
                var y2 = parseFloatWithUnits(node.getAttribute('y2'));
                var path = new THREE.ShapePath();
                path.moveTo(x1, y1);
                path.lineTo(x2, y2);
                path.currentPath.autoClose = false;
                return path;
            }
            function parseStyle(node, style) {
                style = Object.assign({}, style);
                function addStyle(svgName, jsName, adjustFunction) {
                    if (adjustFunction === undefined)
                        adjustFunction = function copy(v) {
                            return v;
                        };
                    if (node.hasAttribute(svgName))
                        style[jsName] = adjustFunction(node.getAttribute(svgName));
                    if (node.style && node.style[svgName] !== '')
                        style[jsName] = adjustFunction(node.style[svgName]);
                }
                function clamp(v) {
                    return Math.max(0, Math.min(1, parseFloatWithUnits(v)));
                }
                function positive(v) {
                    return Math.max(0, parseFloatWithUnits(v));
                }
                addStyle('fill', 'fill');
                addStyle('fill-opacity', 'fillOpacity', clamp);
                addStyle('stroke', 'stroke');
                addStyle('stroke-opacity', 'strokeOpacity', clamp);
                addStyle('stroke-width', 'strokeWidth', positive);
                addStyle('stroke-linejoin', 'strokeLineJoin');
                addStyle('stroke-linecap', 'strokeLineCap');
                addStyle('stroke-miterlimit', 'strokeMiterLimit', positive);
                return style;
            }
            function getReflection(a, b) {
                return a - (b - a);
            }
            function parseFloats(string) {
                var array = string.split(/[\s,]+|(?=\s?[+\-])/);
                for (var i = 0; i < array.length; i++) {
                    var number = array[i];
                    if (number.indexOf('.') !== number.lastIndexOf('.')) {
                        var split = number.split('.');
                        for (var s = 2; s < split.length; s++) {
                            array.splice(i + s - 1, 0, '0.' + split[s]);
                        }
                    }
                    array[i] = parseFloatWithUnits(number);
                }
                return array;
            }
            var units = [
                'mm',
                'cm',
                'in',
                'pt',
                'pc',
                'px'
            ];
            var unitConversion = {
                'mm': {
                    'mm': 1,
                    'cm': 0.1,
                    'in': 1 / 25.4,
                    'pt': 72 / 25.4,
                    'pc': 6 / 25.4,
                    'px': -1
                },
                'cm': {
                    'mm': 10,
                    'cm': 1,
                    'in': 1 / 2.54,
                    'pt': 72 / 2.54,
                    'pc': 6 / 2.54,
                    'px': -1
                },
                'in': {
                    'mm': 25.4,
                    'cm': 2.54,
                    'in': 1,
                    'pt': 72,
                    'pc': 6,
                    'px': -1
                },
                'pt': {
                    'mm': 25.4 / 72,
                    'cm': 2.54 / 72,
                    'in': 1 / 72,
                    'pt': 1,
                    'pc': 6 / 72,
                    'px': -1
                },
                'pc': {
                    'mm': 25.4 / 6,
                    'cm': 2.54 / 6,
                    'in': 1 / 6,
                    'pt': 72 / 6,
                    'pc': 1,
                    'px': -1
                },
                'px': { 'px': 1 }
            };
            function parseFloatWithUnits(string) {
                var theUnit = 'px';
                if (typeof string === 'string' || string instanceof String) {
                    for (var i = 0, n = units.length; i < n; i++) {
                        var u = units[i];
                        if (string.endsWith(u)) {
                            theUnit = u;
                            string = string.substring(0, string.length - u.length);
                            break;
                        }
                    }
                }
                var scale = undefined;
                if (theUnit === 'px' && scope.defaultUnit !== 'px') {
                    scale = unitConversion['in'][scope.defaultUnit] / scope.defaultDPI;
                } else {
                    scale = unitConversion[theUnit][scope.defaultUnit];
                    if (scale < 0) {
                        scale = unitConversion[theUnit]['in'] * scope.defaultDPI;
                    }
                }
                return scale * parseFloat(string);
            }
            function getNodeTransform(node) {
                if (!node.hasAttribute('transform')) {
                    return null;
                }
                var transform = parseNodeTransform(node);
                if (transformStack.length > 0) {
                    transform.premultiply(transformStack[transformStack.length - 1]);
                }
                currentTransform.copy(transform);
                transformStack.push(transform);
                return transform;
            }
            function parseNodeTransform(node) {
                var transform = new THREE.Matrix3();
                var currentTransform = tempTransform0;
                var transformsTexts = node.getAttribute('transform').split(')');
                for (var tIndex = transformsTexts.length - 1; tIndex >= 0; tIndex--) {
                    var transformText = transformsTexts[tIndex].trim();
                    if (transformText === '')
                        continue;
                    var openParPos = transformText.indexOf('(');
                    var closeParPos = transformText.length;
                    if (openParPos > 0 && openParPos < closeParPos) {
                        var transformType = transformText.substr(0, openParPos);
                        var array = parseFloats(transformText.substr(openParPos + 1, closeParPos - openParPos - 1));
                        currentTransform.identity();
                        switch (transformType) {
                        case 'translate':
                            if (array.length >= 1) {
                                var tx = array[0];
                                var ty = tx;
                                if (array.length >= 2) {
                                    ty = array[1];
                                }
                                currentTransform.translate(tx, ty);
                            }
                            break;
                        case 'rotate':
                            if (array.length >= 1) {
                                var angle = 0;
                                var cx = 0;
                                var cy = 0;
                                angle = -array[0] * Math.PI / 180;
                                if (array.length >= 3) {
                                    cx = array[1];
                                    cy = array[2];
                                }
                                tempTransform1.identity().translate(-cx, -cy);
                                tempTransform2.identity().rotate(angle);
                                tempTransform3.multiplyMatrices(tempTransform2, tempTransform1);
                                tempTransform1.identity().translate(cx, cy);
                                currentTransform.multiplyMatrices(tempTransform1, tempTransform3);
                            }
                            break;
                        case 'scale':
                            if (array.length >= 1) {
                                var scaleX = array[0];
                                var scaleY = scaleX;
                                if (array.length >= 2) {
                                    scaleY = array[1];
                                }
                                currentTransform.scale(scaleX, scaleY);
                            }
                            break;
                        case 'skewX':
                            if (array.length === 1) {
                                currentTransform.set(1, Math.tan(array[0] * Math.PI / 180), 0, 0, 1, 0, 0, 0, 1);
                            }
                            break;
                        case 'skewY':
                            if (array.length === 1) {
                                currentTransform.set(1, 0, 0, Math.tan(array[0] * Math.PI / 180), 1, 0, 0, 0, 1);
                            }
                            break;
                        case 'matrix':
                            if (array.length === 6) {
                                currentTransform.set(array[0], array[2], array[4], array[1], array[3], array[5], 0, 0, 1);
                            }
                            break;
                        }
                    }
                    transform.premultiply(currentTransform);
                }
                return transform;
            }
            function transformPath(path, m) {
                function transfVec2(v2) {
                    tempV3.set(v2.x, v2.y, 1).applyMatrix3(m);
                    v2.set(tempV3.x, tempV3.y);
                }
                var isRotated = isTransformRotated(m);
                var subPaths = path.subPaths;
                for (var i = 0, n = subPaths.length; i < n; i++) {
                    var subPath = subPaths[i];
                    var curves = subPath.curves;
                    for (var j = 0; j < curves.length; j++) {
                        var curve = curves[j];
                        if (curve.isLineCurve) {
                            transfVec2(curve.v1);
                            transfVec2(curve.v2);
                        } else if (curve.isCubicBezierCurve) {
                            transfVec2(curve.v0);
                            transfVec2(curve.v1);
                            transfVec2(curve.v2);
                            transfVec2(curve.v3);
                        } else if (curve.isQuadraticBezierCurve) {
                            transfVec2(curve.v0);
                            transfVec2(curve.v1);
                            transfVec2(curve.v2);
                        } else if (curve.isEllipseCurve) {
                            if (isRotated) {
                                console.warn('SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented.');
                            }
                            tempV2.set(curve.aX, curve.aY);
                            transfVec2(tempV2);
                            curve.aX = tempV2.x;
                            curve.aY = tempV2.y;
                            curve.xRadius *= getTransformScaleX(m);
                            curve.yRadius *= getTransformScaleY(m);
                        }
                    }
                }
            }
            function isTransformRotated(m) {
                return m.elements[1] !== 0 || m.elements[3] !== 0;
            }
            function getTransformScaleX(m) {
                var te = m.elements;
                return Math.sqrt(te[0] * te[0] + te[1] * te[1]);
            }
            function getTransformScaleY(m) {
                var te = m.elements;
                return Math.sqrt(te[3] * te[3] + te[4] * te[4]);
            }
            var paths = [];
            var transformStack = [];
            var tempTransform0 = new THREE.Matrix3();
            var tempTransform1 = new THREE.Matrix3();
            var tempTransform2 = new THREE.Matrix3();
            var tempTransform3 = new THREE.Matrix3();
            var tempV2 = new THREE.Vector2();
            var tempV3 = new THREE.Vector3();
            var currentTransform = new THREE.Matrix3();
            var xml = new DOMParser().parseFromString(text, 'image/svg+xml');
            parseNode(xml.documentElement, {
                fill: '#000',
                fillOpacity: 1,
                strokeOpacity: 1,
                strokeWidth: 1,
                strokeLineJoin: 'miter',
                strokeLineCap: 'butt',
                strokeMiterLimit: 4
            });
            var data = {
                paths: paths,
                xml: xml.documentElement
            };
            return data;
        }
    });
    SVGLoader.getStrokeStyle = function (width, color, lineJoin, lineCap, miterLimit) {
        width = width !== undefined ? width : 1;
        color = color !== undefined ? color : '#000';
        lineJoin = lineJoin !== undefined ? lineJoin : 'miter';
        lineCap = lineCap !== undefined ? lineCap : 'butt';
        miterLimit = miterLimit !== undefined ? miterLimit : 4;
        return {
            strokeColor: color,
            strokeWidth: width,
            strokeLineJoin: lineJoin,
            strokeLineCap: lineCap,
            strokeMiterLimit: miterLimit
        };
    };
    SVGLoader.pointsToStroke = function (points, style, arcDivisions, minDistance) {
        var vertices = [];
        var normals = [];
        var uvs = [];
        if (SVGLoader.pointsToStrokeWithBuffers(points, style, arcDivisions, minDistance, vertices, normals, uvs) === 0) {
            return null;
        }
        var geometry = new THREE.BufferGeometry();
        geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
        geometry.setAttribute('normal', new THREE.Float32BufferAttribute(normals, 3));
        geometry.setAttribute('uv', new THREE.Float32BufferAttribute(uvs, 2));
        return geometry;
    };
    SVGLoader.pointsToStrokeWithBuffers = function () {
        var tempV2_1 = new THREE.Vector2();
        var tempV2_2 = new THREE.Vector2();
        var tempV2_3 = new THREE.Vector2();
        var tempV2_4 = new THREE.Vector2();
        var tempV2_5 = new THREE.Vector2();
        var tempV2_6 = new THREE.Vector2();
        var tempV2_7 = new THREE.Vector2();
        var lastPointL = new THREE.Vector2();
        var lastPointR = new THREE.Vector2();
        var point0L = new THREE.Vector2();
        var point0R = new THREE.Vector2();
        var currentPointL = new THREE.Vector2();
        var currentPointR = new THREE.Vector2();
        var nextPointL = new THREE.Vector2();
        var nextPointR = new THREE.Vector2();
        var innerPoint = new THREE.Vector2();
        var outerPoint = new THREE.Vector2();
        return function (points, style, arcDivisions, minDistance, vertices, normals, uvs, vertexOffset) {
            arcDivisions = arcDivisions !== undefined ? arcDivisions : 12;
            minDistance = minDistance !== undefined ? minDistance : 0.001;
            vertexOffset = vertexOffset !== undefined ? vertexOffset : 0;
            points = removeDuplicatedPoints(points);
            var numPoints = points.length;
            if (numPoints < 2)
                return 0;
            var isClosed = points[0].equals(points[numPoints - 1]);
            var currentPoint;
            var previousPoint = points[0];
            var nextPoint;
            var strokeWidth2 = style.strokeWidth / 2;
            var deltaU = 1 / (numPoints - 1);
            var u0 = 0;
            var innerSideModified;
            var joinIsOnLeftSide;
            var isMiter;
            var initialJoinIsOnLeftSide = false;
            var numVertices = 0;
            var currentCoordinate = vertexOffset * 3;
            var currentCoordinateUV = vertexOffset * 2;
            getNormal(points[0], points[1], tempV2_1).multiplyScalar(strokeWidth2);
            lastPointL.copy(points[0]).sub(tempV2_1);
            lastPointR.copy(points[0]).add(tempV2_1);
            point0L.copy(lastPointL);
            point0R.copy(lastPointR);
            for (var iPoint = 1; iPoint < numPoints; iPoint++) {
                currentPoint = points[iPoint];
                if (iPoint === numPoints - 1) {
                    if (isClosed) {
                        nextPoint = points[1];
                    } else
                        nextPoint = undefined;
                } else {
                    nextPoint = points[iPoint + 1];
                }
                var normal1 = tempV2_1;
                getNormal(previousPoint, currentPoint, normal1);
                tempV2_3.copy(normal1).multiplyScalar(strokeWidth2);
                currentPointL.copy(currentPoint).sub(tempV2_3);
                currentPointR.copy(currentPoint).add(tempV2_3);
                var u1 = u0 + deltaU;
                innerSideModified = false;
                if (nextPoint !== undefined) {
                    getNormal(currentPoint, nextPoint, tempV2_2);
                    tempV2_3.copy(tempV2_2).multiplyScalar(strokeWidth2);
                    nextPointL.copy(currentPoint).sub(tempV2_3);
                    nextPointR.copy(currentPoint).add(tempV2_3);
                    joinIsOnLeftSide = true;
                    tempV2_3.subVectors(nextPoint, previousPoint);
                    if (normal1.dot(tempV2_3) < 0) {
                        joinIsOnLeftSide = false;
                    }
                    if (iPoint === 1)
                        initialJoinIsOnLeftSide = joinIsOnLeftSide;
                    tempV2_3.subVectors(nextPoint, currentPoint);
                    tempV2_3.normalize();
                    var dot = Math.abs(normal1.dot(tempV2_3));
                    if (dot !== 0) {
                        var miterSide = strokeWidth2 / dot;
                        tempV2_3.multiplyScalar(-miterSide);
                        tempV2_4.subVectors(currentPoint, previousPoint);
                        tempV2_5.copy(tempV2_4).setLength(miterSide).add(tempV2_3);
                        innerPoint.copy(tempV2_5).negate();
                        var miterLength2 = tempV2_5.length();
                        var segmentLengthPrev = tempV2_4.length();
                        tempV2_4.divideScalar(segmentLengthPrev);
                        tempV2_6.subVectors(nextPoint, currentPoint);
                        var segmentLengthNext = tempV2_6.length();
                        tempV2_6.divideScalar(segmentLengthNext);
                        if (tempV2_4.dot(innerPoint) < segmentLengthPrev && tempV2_6.dot(innerPoint) < segmentLengthNext) {
                            innerSideModified = true;
                        }
                        outerPoint.copy(tempV2_5).add(currentPoint);
                        innerPoint.add(currentPoint);
                        isMiter = false;
                        if (innerSideModified) {
                            if (joinIsOnLeftSide) {
                                nextPointR.copy(innerPoint);
                                currentPointR.copy(innerPoint);
                            } else {
                                nextPointL.copy(innerPoint);
                                currentPointL.copy(innerPoint);
                            }
                        } else {
                            makeSegmentTriangles();
                        }
                        switch (style.strokeLineJoin) {
                        case 'bevel':
                            makeSegmentWithBevelJoin(joinIsOnLeftSide, innerSideModified, u1);
                            break;
                        case 'round':
                            createSegmentTrianglesWithMiddleSection(joinIsOnLeftSide, innerSideModified);
                            if (joinIsOnLeftSide) {
                                makeCircularSector(currentPoint, currentPointL, nextPointL, u1, 0);
                            } else {
                                makeCircularSector(currentPoint, nextPointR, currentPointR, u1, 1);
                            }
                            break;
                        case 'miter':
                        case 'miter-clip':
                        default:
                            var miterFraction = strokeWidth2 * style.strokeMiterLimit / miterLength2;
                            if (miterFraction < 1) {
                                if (style.strokeLineJoin !== 'miter-clip') {
                                    makeSegmentWithBevelJoin(joinIsOnLeftSide, innerSideModified, u1);
                                    break;
                                } else {
                                    createSegmentTrianglesWithMiddleSection(joinIsOnLeftSide, innerSideModified);
                                    if (joinIsOnLeftSide) {
                                        tempV2_6.subVectors(outerPoint, currentPointL).multiplyScalar(miterFraction).add(currentPointL);
                                        tempV2_7.subVectors(outerPoint, nextPointL).multiplyScalar(miterFraction).add(nextPointL);
                                        addVertex(currentPointL, u1, 0);
                                        addVertex(tempV2_6, u1, 0);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(tempV2_6, u1, 0);
                                        addVertex(tempV2_7, u1, 0);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(tempV2_7, u1, 0);
                                        addVertex(nextPointL, u1, 0);
                                    } else {
                                        tempV2_6.subVectors(outerPoint, currentPointR).multiplyScalar(miterFraction).add(currentPointR);
                                        tempV2_7.subVectors(outerPoint, nextPointR).multiplyScalar(miterFraction).add(nextPointR);
                                        addVertex(currentPointR, u1, 1);
                                        addVertex(tempV2_6, u1, 1);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(tempV2_6, u1, 1);
                                        addVertex(tempV2_7, u1, 1);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(tempV2_7, u1, 1);
                                        addVertex(nextPointR, u1, 1);
                                    }
                                }
                            } else {
                                if (innerSideModified) {
                                    if (joinIsOnLeftSide) {
                                        addVertex(lastPointR, u0, 1);
                                        addVertex(lastPointL, u0, 0);
                                        addVertex(outerPoint, u1, 0);
                                        addVertex(lastPointR, u0, 1);
                                        addVertex(outerPoint, u1, 0);
                                        addVertex(innerPoint, u1, 1);
                                    } else {
                                        addVertex(lastPointR, u0, 1);
                                        addVertex(lastPointL, u0, 0);
                                        addVertex(outerPoint, u1, 1);
                                        addVertex(lastPointL, u0, 0);
                                        addVertex(innerPoint, u1, 0);
                                        addVertex(outerPoint, u1, 1);
                                    }
                                    if (joinIsOnLeftSide) {
                                        nextPointL.copy(outerPoint);
                                    } else {
                                        nextPointR.copy(outerPoint);
                                    }
                                } else {
                                    if (joinIsOnLeftSide) {
                                        addVertex(currentPointL, u1, 0);
                                        addVertex(outerPoint, u1, 0);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(outerPoint, u1, 0);
                                        addVertex(nextPointL, u1, 0);
                                    } else {
                                        addVertex(currentPointR, u1, 1);
                                        addVertex(outerPoint, u1, 1);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(currentPoint, u1, 0.5);
                                        addVertex(outerPoint, u1, 1);
                                        addVertex(nextPointR, u1, 1);
                                    }
                                }
                                isMiter = true;
                            }
                            break;
                        }
                    } else {
                        makeSegmentTriangles();
                    }
                } else {
                    makeSegmentTriangles();
                }
                if (!isClosed && iPoint === numPoints - 1) {
                    addCapGeometry(points[0], point0L, point0R, joinIsOnLeftSide, true, u0);
                }
                u0 = u1;
                previousPoint = currentPoint;
                lastPointL.copy(nextPointL);
                lastPointR.copy(nextPointR);
            }
            if (!isClosed) {
                addCapGeometry(currentPoint, currentPointL, currentPointR, joinIsOnLeftSide, false, u1);
            } else if (innerSideModified && vertices) {
                var lastOuter = outerPoint;
                var lastInner = innerPoint;
                if (initialJoinIsOnLeftSide !== joinIsOnLeftSide) {
                    lastOuter = innerPoint;
                    lastInner = outerPoint;
                }
                if (joinIsOnLeftSide) {
                    if (isMiter || initialJoinIsOnLeftSide) {
                        lastInner.toArray(vertices, 0 * 3);
                        lastInner.toArray(vertices, 3 * 3);
                        if (isMiter) {
                            lastOuter.toArray(vertices, 1 * 3);
                        }
                    }
                } else {
                    if (isMiter || !initialJoinIsOnLeftSide) {
                        lastInner.toArray(vertices, 1 * 3);
                        lastInner.toArray(vertices, 3 * 3);
                        if (isMiter) {
                            lastOuter.toArray(vertices, 0 * 3);
                        }
                    }
                }
            }
            return numVertices;
            function getNormal(p1, p2, result) {
                result.subVectors(p2, p1);
                return result.set(-result.y, result.x).normalize();
            }
            function addVertex(position, u, v) {
                if (vertices) {
                    vertices[currentCoordinate] = position.x;
                    vertices[currentCoordinate + 1] = position.y;
                    vertices[currentCoordinate + 2] = 0;
                    if (normals) {
                        normals[currentCoordinate] = 0;
                        normals[currentCoordinate + 1] = 0;
                        normals[currentCoordinate + 2] = 1;
                    }
                    currentCoordinate += 3;
                    if (uvs) {
                        uvs[currentCoordinateUV] = u;
                        uvs[currentCoordinateUV + 1] = v;
                        currentCoordinateUV += 2;
                    }
                }
                numVertices += 3;
            }
            function makeCircularSector(center, p1, p2, u, v) {
                tempV2_1.copy(p1).sub(center).normalize();
                tempV2_2.copy(p2).sub(center).normalize();
                var angle = Math.PI;
                var dot = tempV2_1.dot(tempV2_2);
                if (Math.abs(dot) < 1)
                    angle = Math.abs(Math.acos(dot));
                angle /= arcDivisions;
                tempV2_3.copy(p1);
                for (var i = 0, il = arcDivisions - 1; i < il; i++) {
                    tempV2_4.copy(tempV2_3).rotateAround(center, angle);
                    addVertex(tempV2_3, u, v);
                    addVertex(tempV2_4, u, v);
                    addVertex(center, u, 0.5);
                    tempV2_3.copy(tempV2_4);
                }
                addVertex(tempV2_4, u, v);
                addVertex(p2, u, v);
                addVertex(center, u, 0.5);
            }
            function makeSegmentTriangles() {
                addVertex(lastPointR, u0, 1);
                addVertex(lastPointL, u0, 0);
                addVertex(currentPointL, u1, 0);
                addVertex(lastPointR, u0, 1);
                addVertex(currentPointL, u1, 1);
                addVertex(currentPointR, u1, 0);
            }
            function makeSegmentWithBevelJoin(joinIsOnLeftSide, innerSideModified, u) {
                if (innerSideModified) {
                    if (joinIsOnLeftSide) {
                        addVertex(lastPointR, u0, 1);
                        addVertex(lastPointL, u0, 0);
                        addVertex(currentPointL, u1, 0);
                        addVertex(lastPointR, u0, 1);
                        addVertex(currentPointL, u1, 0);
                        addVertex(innerPoint, u1, 1);
                        addVertex(currentPointL, u, 0);
                        addVertex(nextPointL, u, 0);
                        addVertex(innerPoint, u, 0.5);
                    } else {
                        addVertex(lastPointR, u0, 1);
                        addVertex(lastPointL, u0, 0);
                        addVertex(currentPointR, u1, 1);
                        addVertex(lastPointL, u0, 0);
                        addVertex(innerPoint, u1, 0);
                        addVertex(currentPointR, u1, 1);
                        addVertex(currentPointR, u, 1);
                        addVertex(nextPointR, u, 0);
                        addVertex(innerPoint, u, 0.5);
                    }
                } else {
                    if (joinIsOnLeftSide) {
                        addVertex(currentPointL, u, 0);
                        addVertex(nextPointL, u, 0);
                        addVertex(currentPoint, u, 0.5);
                    } else {
                        addVertex(currentPointR, u, 1);
                        addVertex(nextPointR, u, 0);
                        addVertex(currentPoint, u, 0.5);
                    }
                }
            }
            function createSegmentTrianglesWithMiddleSection(joinIsOnLeftSide, innerSideModified) {
                if (innerSideModified) {
                    if (joinIsOnLeftSide) {
                        addVertex(lastPointR, u0, 1);
                        addVertex(lastPointL, u0, 0);
                        addVertex(currentPointL, u1, 0);
                        addVertex(lastPointR, u0, 1);
                        addVertex(currentPointL, u1, 0);
                        addVertex(innerPoint, u1, 1);
                        addVertex(currentPointL, u0, 0);
                        addVertex(currentPoint, u1, 0.5);
                        addVertex(innerPoint, u1, 1);
                        addVertex(currentPoint, u1, 0.5);
                        addVertex(nextPointL, u0, 0);
                        addVertex(innerPoint, u1, 1);
                    } else {
                        addVertex(lastPointR, u0, 1);
                        addVertex(lastPointL, u0, 0);
                        addVertex(currentPointR, u1, 1);
                        addVertex(lastPointL, u0, 0);
                        addVertex(innerPoint, u1, 0);
                        addVertex(currentPointR, u1, 1);
                        addVertex(currentPointR, u0, 1);
                        addVertex(innerPoint, u1, 0);
                        addVertex(currentPoint, u1, 0.5);
                        addVertex(currentPoint, u1, 0.5);
                        addVertex(innerPoint, u1, 0);
                        addVertex(nextPointR, u0, 1);
                    }
                }
            }
            function addCapGeometry(center, p1, p2, joinIsOnLeftSide, start, u) {
                switch (style.strokeLineCap) {
                case 'round':
                    if (start) {
                        makeCircularSector(center, p2, p1, u, 0.5);
                    } else {
                        makeCircularSector(center, p1, p2, u, 0.5);
                    }
                    break;
                case 'square':
                    if (start) {
                        tempV2_1.subVectors(p1, center);
                        tempV2_2.set(tempV2_1.y, -tempV2_1.x);
                        tempV2_3.addVectors(tempV2_1, tempV2_2).add(center);
                        tempV2_4.subVectors(tempV2_2, tempV2_1).add(center);
                        if (joinIsOnLeftSide) {
                            tempV2_3.toArray(vertices, 1 * 3);
                            tempV2_4.toArray(vertices, 0 * 3);
                            tempV2_4.toArray(vertices, 3 * 3);
                        } else {
                            tempV2_3.toArray(vertices, 1 * 3);
                            tempV2_3.toArray(vertices, 3 * 3);
                            tempV2_4.toArray(vertices, 0 * 3);
                        }
                    } else {
                        tempV2_1.subVectors(p2, center);
                        tempV2_2.set(tempV2_1.y, -tempV2_1.x);
                        tempV2_3.addVectors(tempV2_1, tempV2_2).add(center);
                        tempV2_4.subVectors(tempV2_2, tempV2_1).add(center);
                        var vl = vertices.length;
                        if (joinIsOnLeftSide) {
                            tempV2_3.toArray(vertices, vl - 1 * 3);
                            tempV2_4.toArray(vertices, vl - 2 * 3);
                            tempV2_4.toArray(vertices, vl - 4 * 3);
                        } else {
                            tempV2_3.toArray(vertices, vl - 2 * 3);
                            tempV2_4.toArray(vertices, vl - 1 * 3);
                            tempV2_4.toArray(vertices, vl - 4 * 3);
                        }
                    }
                    break;
                case 'butt':
                default:
                    break;
                }
            }
            function removeDuplicatedPoints(points) {
                var dupPoints = false;
                for (var i = 1, n = points.length - 1; i < n; i++) {
                    if (points[i].distanceTo(points[i + 1]) < minDistance) {
                        dupPoints = true;
                        break;
                    }
                }
                if (!dupPoints)
                    return points;
                var newPoints = [];
                newPoints.push(points[0]);
                for (var i = 1, n = points.length - 1; i < n; i++) {
                    if (points[i].distanceTo(points[i + 1]) >= minDistance) {
                        newPoints.push(points[i]);
                    }
                }
                newPoints.push(points[points.length - 1]);
                return newPoints;
            }
        };
    }();
    return threex.loaders.SVGLoader = SVGLoader;
});
define('skylark-threejs-ex/loaders/TDSLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var TDSLoader = function (manager) {
        THREE.Loader.call(this, manager);
        this.debug = false;
        this.group = null;
        this.position = 0;
        this.materials = [];
        this.meshes = [];
    };
    TDSLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: TDSLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var path = scope.path === '' ? THREE.LoaderUtils.extractUrlBase(url) : scope.path;
            var loader = new THREE.FileLoader(this.manager);
            loader.setPath(this.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (data) {
                onLoad(scope.parse(data, path));
            }, onProgress, onError);
        },
        parse: function (arraybuffer, path) {
            this.group = new THREE.Group();
            this.position = 0;
            this.materials = [];
            this.meshes = [];
            this.readFile(arraybuffer, path);
            for (var i = 0; i < this.meshes.length; i++) {
                this.group.add(this.meshes[i]);
            }
            return this.group;
        },
        readFile: function (arraybuffer, path) {
            var data = new DataView(arraybuffer);
            var chunk = this.readChunk(data);
            if (chunk.id === MLIBMAGIC || chunk.id === CMAGIC || chunk.id === M3DMAGIC) {
                var next = this.nextChunk(data, chunk);
                while (next !== 0) {
                    if (next === M3D_VERSION) {
                        var version = this.readDWord(data);
                        this.debugMessage('3DS file version: ' + version);
                    } else if (next === MDATA) {
                        this.resetPosition(data);
                        this.readMeshData(data, path);
                    } else {
                        this.debugMessage('Unknown main chunk: ' + next.toString(16));
                    }
                    next = this.nextChunk(data, chunk);
                }
            }
            this.debugMessage('Parsed ' + this.meshes.length + ' meshes');
        },
        readMeshData: function (data, path) {
            var chunk = this.readChunk(data);
            var next = this.nextChunk(data, chunk);
            while (next !== 0) {
                if (next === MESH_VERSION) {
                    var version = +this.readDWord(data);
                    this.debugMessage('Mesh Version: ' + version);
                } else if (next === MASTER_SCALE) {
                    var scale = this.readFloat(data);
                    this.debugMessage('Master scale: ' + scale);
                    this.group.scale.set(scale, scale, scale);
                } else if (next === NAMED_OBJECT) {
                    this.debugMessage('Named Object');
                    this.resetPosition(data);
                    this.readNamedObject(data);
                } else if (next === MAT_ENTRY) {
                    this.debugMessage('Material');
                    this.resetPosition(data);
                    this.readMaterialEntry(data, path);
                } else {
                    this.debugMessage('Unknown MDATA chunk: ' + next.toString(16));
                }
                next = this.nextChunk(data, chunk);
            }
        },
        readNamedObject: function (data) {
            var chunk = this.readChunk(data);
            var name = this.readString(data, 64);
            chunk.cur = this.position;
            var next = this.nextChunk(data, chunk);
            while (next !== 0) {
                if (next === N_TRI_OBJECT) {
                    this.resetPosition(data);
                    var mesh = this.readMesh(data);
                    mesh.name = name;
                    this.meshes.push(mesh);
                } else {
                    this.debugMessage('Unknown named object chunk: ' + next.toString(16));
                }
                next = this.nextChunk(data, chunk);
            }
            this.endChunk(chunk);
        },
        readMaterialEntry: function (data, path) {
            var chunk = this.readChunk(data);
            var next = this.nextChunk(data, chunk);
            var material = new THREE.MeshPhongMaterial();
            while (next !== 0) {
                if (next === MAT_NAME) {
                    material.name = this.readString(data, 64);
                    this.debugMessage('   Name: ' + material.name);
                } else if (next === MAT_WIRE) {
                    this.debugMessage('   Wireframe');
                    material.wireframe = true;
                } else if (next === MAT_WIRE_SIZE) {
                    var value = this.readByte(data);
                    material.wireframeLinewidth = value;
                    this.debugMessage('   Wireframe Thickness: ' + value);
                } else if (next === MAT_TWO_SIDE) {
                    material.side = THREE.DoubleSide;
                    this.debugMessage('   DoubleSided');
                } else if (next === MAT_ADDITIVE) {
                    this.debugMessage('   Additive Blending');
                    material.blending = THREE.AdditiveBlending;
                } else if (next === MAT_DIFFUSE) {
                    this.debugMessage('   Diffuse Color');
                    material.color = this.readColor(data);
                } else if (next === MAT_SPECULAR) {
                    this.debugMessage('   Specular Color');
                    material.specular = this.readColor(data);
                } else if (next === MAT_AMBIENT) {
                    this.debugMessage('   Ambient color');
                    material.color = this.readColor(data);
                } else if (next === MAT_SHININESS) {
                    var shininess = this.readWord(data);
                    material.shininess = shininess;
                    this.debugMessage('   Shininess : ' + shininess);
                } else if (next === MAT_TRANSPARENCY) {
                    var opacity = this.readWord(data);
                    material.opacity = opacity * 0.01;
                    this.debugMessage('  Opacity : ' + opacity);
                    material.transparent = opacity < 100 ? true : false;
                } else if (next === MAT_TEXMAP) {
                    this.debugMessage('   ColorMap');
                    this.resetPosition(data);
                    material.map = this.readMap(data, path);
                } else if (next === MAT_BUMPMAP) {
                    this.debugMessage('   BumpMap');
                    this.resetPosition(data);
                    material.bumpMap = this.readMap(data, path);
                } else if (next === MAT_OPACMAP) {
                    this.debugMessage('   OpacityMap');
                    this.resetPosition(data);
                    material.alphaMap = this.readMap(data, path);
                } else if (next === MAT_SPECMAP) {
                    this.debugMessage('   SpecularMap');
                    this.resetPosition(data);
                    material.specularMap = this.readMap(data, path);
                } else {
                    this.debugMessage('   Unknown material chunk: ' + next.toString(16));
                }
                next = this.nextChunk(data, chunk);
            }
            this.endChunk(chunk);
            this.materials[material.name] = material;
        },
        readMesh: function (data) {
            var chunk = this.readChunk(data);
            var next = this.nextChunk(data, chunk);
            var geometry = new THREE.BufferGeometry();
            var uvs = [];
            var material = new THREE.MeshPhongMaterial();
            var mesh = new THREE.Mesh(geometry, material);
            mesh.name = 'mesh';
            while (next !== 0) {
                if (next === POINT_ARRAY) {
                    var points = this.readWord(data);
                    this.debugMessage('   Vertex: ' + points);
                    var vertices = [];
                    for (var i = 0; i < points; i++) {
                        vertices.push(this.readFloat(data));
                        vertices.push(this.readFloat(data));
                        vertices.push(this.readFloat(data));
                    }
                    geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
                } else if (next === FACE_ARRAY) {
                    this.resetPosition(data);
                    this.readFaceArray(data, mesh);
                } else if (next === TEX_VERTS) {
                    var texels = this.readWord(data);
                    this.debugMessage('   UV: ' + texels);
                    var uvs = [];
                    for (var i = 0; i < texels; i++) {
                        uvs.push(this.readFloat(data));
                        uvs.push(this.readFloat(data));
                    }
                    geometry.setAttribute('uv', new THREE.Float32BufferAttribute(uvs, 2));
                } else if (next === MESH_MATRIX) {
                    this.debugMessage('   Tranformation Matrix (TODO)');
                    var values = [];
                    for (var i = 0; i < 12; i++) {
                        values[i] = this.readFloat(data);
                    }
                    var matrix = new THREE.Matrix4();
                    matrix.elements[0] = values[0];
                    matrix.elements[1] = values[6];
                    matrix.elements[2] = values[3];
                    matrix.elements[3] = values[9];
                    matrix.elements[4] = values[2];
                    matrix.elements[5] = values[8];
                    matrix.elements[6] = values[5];
                    matrix.elements[7] = values[11];
                    matrix.elements[8] = values[1];
                    matrix.elements[9] = values[7];
                    matrix.elements[10] = values[4];
                    matrix.elements[11] = values[10];
                    matrix.elements[12] = 0;
                    matrix.elements[13] = 0;
                    matrix.elements[14] = 0;
                    matrix.elements[15] = 1;
                    matrix.transpose();
                    var inverse = new THREE.Matrix4();
                    inverse.getInverse(matrix);
                    geometry.applyMatrix4(inverse);
                    matrix.decompose(mesh.position, mesh.quaternion, mesh.scale);
                } else {
                    this.debugMessage('   Unknown mesh chunk: ' + next.toString(16));
                }
                next = this.nextChunk(data, chunk);
            }
            this.endChunk(chunk);
            geometry.computeVertexNormals();
            return mesh;
        },
        readFaceArray: function (data, mesh) {
            var chunk = this.readChunk(data);
            var faces = this.readWord(data);
            this.debugMessage('   Faces: ' + faces);
            var index = [];
            for (var i = 0; i < faces; ++i) {
                index.push(this.readWord(data), this.readWord(data), this.readWord(data));
                this.readWord(data);
            }
            mesh.geometry.setIndex(index);
            while (this.position < chunk.end) {
                var chunk = this.readChunk(data);
                if (chunk.id === MSH_MAT_GROUP) {
                    this.debugMessage('      Material Group');
                    this.resetPosition(data);
                    var group = this.readMaterialGroup(data);
                    var material = this.materials[group.name];
                    if (material !== undefined) {
                        mesh.material = material;
                        if (material.name === '') {
                            material.name = mesh.name;
                        }
                    }
                } else {
                    this.debugMessage('      Unknown face array chunk: ' + chunk.toString(16));
                }
                this.endChunk(chunk);
            }
            this.endChunk(chunk);
        },
        readMap: function (data, path) {
            var chunk = this.readChunk(data);
            var next = this.nextChunk(data, chunk);
            var texture = {};
            var loader = new THREE.TextureLoader(this.manager);
            loader.setPath(this.resourcePath || path).setCrossOrigin(this.crossOrigin);
            while (next !== 0) {
                if (next === MAT_MAPNAME) {
                    var name = this.readString(data, 128);
                    texture = loader.load(name);
                    this.debugMessage('      File: ' + path + name);
                } else if (next === MAT_MAP_UOFFSET) {
                    texture.offset.x = this.readFloat(data);
                    this.debugMessage('      OffsetX: ' + texture.offset.x);
                } else if (next === MAT_MAP_VOFFSET) {
                    texture.offset.y = this.readFloat(data);
                    this.debugMessage('      OffsetY: ' + texture.offset.y);
                } else if (next === MAT_MAP_USCALE) {
                    texture.repeat.x = this.readFloat(data);
                    this.debugMessage('      RepeatX: ' + texture.repeat.x);
                } else if (next === MAT_MAP_VSCALE) {
                    texture.repeat.y = this.readFloat(data);
                    this.debugMessage('      RepeatY: ' + texture.repeat.y);
                } else {
                    this.debugMessage('      Unknown map chunk: ' + next.toString(16));
                }
                next = this.nextChunk(data, chunk);
            }
            this.endChunk(chunk);
            return texture;
        },
        readMaterialGroup: function (data) {
            this.readChunk(data);
            var name = this.readString(data, 64);
            var numFaces = this.readWord(data);
            this.debugMessage('         Name: ' + name);
            this.debugMessage('         Faces: ' + numFaces);
            var index = [];
            for (var i = 0; i < numFaces; ++i) {
                index.push(this.readWord(data));
            }
            return {
                name: name,
                index: index
            };
        },
        readColor: function (data) {
            var chunk = this.readChunk(data);
            var color = new THREE.Color();
            if (chunk.id === COLOR_24 || chunk.id === LIN_COLOR_24) {
                var r = this.readByte(data);
                var g = this.readByte(data);
                var b = this.readByte(data);
                color.setRGB(r / 255, g / 255, b / 255);
                this.debugMessage('      Color: ' + color.r + ', ' + color.g + ', ' + color.b);
            } else if (chunk.id === COLOR_F || chunk.id === LIN_COLOR_F) {
                var r = this.readFloat(data);
                var g = this.readFloat(data);
                var b = this.readFloat(data);
                color.setRGB(r, g, b);
                this.debugMessage('      Color: ' + color.r + ', ' + color.g + ', ' + color.b);
            } else {
                this.debugMessage('      Unknown color chunk: ' + chunk.toString(16));
            }
            this.endChunk(chunk);
            return color;
        },
        readChunk: function (data) {
            var chunk = {};
            chunk.cur = this.position;
            chunk.id = this.readWord(data);
            chunk.size = this.readDWord(data);
            chunk.end = chunk.cur + chunk.size;
            chunk.cur += 6;
            return chunk;
        },
        endChunk: function (chunk) {
            this.position = chunk.end;
        },
        nextChunk: function (data, chunk) {
            if (chunk.cur >= chunk.end) {
                return 0;
            }
            this.position = chunk.cur;
            try {
                var next = this.readChunk(data);
                chunk.cur += next.size;
                return next.id;
            } catch (e) {
                this.debugMessage('Unable to read chunk at ' + this.position);
                return 0;
            }
        },
        resetPosition: function () {
            this.position -= 6;
        },
        readByte: function (data) {
            var v = data.getUint8(this.position, true);
            this.position += 1;
            return v;
        },
        readFloat: function (data) {
            try {
                var v = data.getFloat32(this.position, true);
                this.position += 4;
                return v;
            } catch (e) {
                this.debugMessage(e + ' ' + this.position + ' ' + data.byteLength);
            }
        },
        readInt: function (data) {
            var v = data.getInt32(this.position, true);
            this.position += 4;
            return v;
        },
        readShort: function (data) {
            var v = data.getInt16(this.position, true);
            this.position += 2;
            return v;
        },
        readDWord: function (data) {
            var v = data.getUint32(this.position, true);
            this.position += 4;
            return v;
        },
        readWord: function (data) {
            var v = data.getUint16(this.position, true);
            this.position += 2;
            return v;
        },
        readString: function (data, maxLength) {
            var s = '';
            for (var i = 0; i < maxLength; i++) {
                var c = this.readByte(data);
                if (!c) {
                    break;
                }
                s += String.fromCharCode(c);
            }
            return s;
        },
        debugMessage: function (message) {
            if (this.debug) {
                console.log(message);
            }
        }
    });
    var M3DMAGIC = 19789;
    var MLIBMAGIC = 15786;
    var CMAGIC = 49725;
    var M3D_VERSION = 2;
    var COLOR_F = 16;
    var COLOR_24 = 17;
    var LIN_COLOR_24 = 18;
    var LIN_COLOR_F = 19;
    var MDATA = 15677;
    var MESH_VERSION = 15678;
    var MASTER_SCALE = 256;
    var MAT_ENTRY = 45055;
    var MAT_NAME = 40960;
    var MAT_AMBIENT = 40976;
    var MAT_DIFFUSE = 40992;
    var MAT_SPECULAR = 41008;
    var MAT_SHININESS = 41024;
    var MAT_TRANSPARENCY = 41040;
    var MAT_TWO_SIDE = 41089;
    var MAT_ADDITIVE = 41091;
    var MAT_WIRE = 41093;
    var MAT_WIRE_SIZE = 41095;
    var MAT_TEXMAP = 41472;
    var MAT_OPACMAP = 41488;
    var MAT_BUMPMAP = 41520;
    var MAT_SPECMAP = 41476;
    var MAT_MAPNAME = 41728;
    var MAT_MAP_USCALE = 41812;
    var MAT_MAP_VSCALE = 41814;
    var MAT_MAP_UOFFSET = 41816;
    var MAT_MAP_VOFFSET = 41818;
    var NAMED_OBJECT = 16384;
    var N_TRI_OBJECT = 16640;
    var POINT_ARRAY = 16656;
    var FACE_ARRAY = 16672;
    var MSH_MAT_GROUP = 16688;
    var TEX_VERTS = 16704;
    var MESH_MATRIX = 16736;

    return threex.loaders.TDSLoader = TDSLoader;
});
define('skylark-threejs-ex/loaders/VRMLLoader',[
    "skylark-threejs",
    "../threex",
//    '../libs/chevrotain.module.min'
], function (
    THREE, 
    threex,
    chevrotain
) {
    'use strict';
    var VRMLLoader = function () {
        if (typeof chevrotain === 'undefined') {
            throw Error('THREE.VRMLLoader: External library chevrotain.min.js required.');
        }
        function VRMLLoader(manager) {
            THREE.Loader.call(this, manager);
        }
        VRMLLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
            constructor: VRMLLoader,
            load: function (url, onLoad, onProgress, onError) {
                var scope = this;
                var path = scope.path === '' ? THREE.LoaderUtils.extractUrlBase(url) : scope.path;
                var loader = new THREE.FileLoader(this.manager);
                loader.setPath(scope.path);
                loader.load(url, function (text) {
                    onLoad(scope.parse(text, path));
                }, onProgress, onError);
            },
            parse: function (data, path) {
                var nodeMap = {};
                function generateVRMLTree(data) {
                    var tokenData = createTokens();
                    var lexer = new VRMLLexer(tokenData.tokens);
                    var parser = new VRMLParser(tokenData.tokenVocabulary);
                    var visitor = createVisitor(parser.getBaseCstVisitorConstructor());
                    var lexingResult = lexer.lex(data);
                    parser.input = lexingResult.tokens;
                    var cstOutput = parser.vrml();
                    if (parser.errors.length > 0) {
                        console.error(parser.errors);
                        throw Error('THREE.VRMLLoader: Parsing errors detected.');
                    }
                    var ast = visitor.visit(cstOutput);
                    return ast;
                }
                function createTokens() {
                    var createToken = chevrotain.createToken;
                    var RouteIdentifier = createToken({
                        name: 'RouteIdentifier',
                        pattern: /[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*[\.][^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/
                    });
                    var Identifier = createToken({
                        name: 'Identifier',
                        pattern: /[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/,
                        longer_alt: RouteIdentifier
                    });
                    var nodeTypes = [
                        'Anchor',
                        'Billboard',
                        'Collision',
                        'Group',
                        'Transform',
                        'Inline',
                        'LOD',
                        'Switch',
                        'AudioClip',
                        'DirectionalLight',
                        'PointLight',
                        'Script',
                        'Shape',
                        'Sound',
                        'SpotLight',
                        'WorldInfo',
                        'CylinderSensor',
                        'PlaneSensor',
                        'ProximitySensor',
                        'SphereSensor',
                        'TimeSensor',
                        'TouchSensor',
                        'VisibilitySensor',
                        'Box',
                        'Cone',
                        'Cylinder',
                        'ElevationGrid',
                        'Extrusion',
                        'IndexedFaceSet',
                        'IndexedLineSet',
                        'PointSet',
                        'Sphere',
                        'Color',
                        'Coordinate',
                        'Normal',
                        'TextureCoordinate',
                        'Appearance',
                        'FontStyle',
                        'ImageTexture',
                        'Material',
                        'MovieTexture',
                        'PixelTexture',
                        'TextureTransform',
                        'ColorInterpolator',
                        'CoordinateInterpolator',
                        'NormalInterpolator',
                        'OrientationInterpolator',
                        'PositionInterpolator',
                        'ScalarInterpolator',
                        'Background',
                        'Fog',
                        'NavigationInfo',
                        'Viewpoint',
                        'Text'
                    ];
                    var Version = createToken({
                        name: 'Version',
                        pattern: /#VRML.*/,
                        longer_alt: Identifier
                    });
                    var NodeName = createToken({
                        name: 'NodeName',
                        pattern: new RegExp(nodeTypes.join('|')),
                        longer_alt: Identifier
                    });
                    var DEF = createToken({
                        name: 'DEF',
                        pattern: /DEF/,
                        longer_alt: Identifier
                    });
                    var USE = createToken({
                        name: 'USE',
                        pattern: /USE/,
                        longer_alt: Identifier
                    });
                    var ROUTE = createToken({
                        name: 'ROUTE',
                        pattern: /ROUTE/,
                        longer_alt: Identifier
                    });
                    var TO = createToken({
                        name: 'TO',
                        pattern: /TO/,
                        longer_alt: Identifier
                    });
                    var StringLiteral = createToken({
                        name: 'StringLiteral',
                        pattern: /"(:?[^\\"\n\r]+|\\(:?[bfnrtv"\\/]|u[0-9a-fA-F]{4}))*"/
                    });
                    var HexLiteral = createToken({
                        name: 'HexLiteral',
                        pattern: /0[xX][0-9a-fA-F]+/
                    });
                    var NumberLiteral = createToken({
                        name: 'NumberLiteral',
                        pattern: /[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/
                    });
                    var TrueLiteral = createToken({
                        name: 'TrueLiteral',
                        pattern: /TRUE/
                    });
                    var FalseLiteral = createToken({
                        name: 'FalseLiteral',
                        pattern: /FALSE/
                    });
                    var NullLiteral = createToken({
                        name: 'NullLiteral',
                        pattern: /NULL/
                    });
                    var LSquare = createToken({
                        name: 'LSquare',
                        pattern: /\[/
                    });
                    var RSquare = createToken({
                        name: 'RSquare',
                        pattern: /]/
                    });
                    var LCurly = createToken({
                        name: 'LCurly',
                        pattern: /{/
                    });
                    var RCurly = createToken({
                        name: 'RCurly',
                        pattern: /}/
                    });
                    var Comment = createToken({
                        name: 'Comment',
                        pattern: /#.*/,
                        group: chevrotain.Lexer.SKIPPED
                    });
                    var WhiteSpace = createToken({
                        name: 'WhiteSpace',
                        pattern: /[ ,\s]/,
                        group: chevrotain.Lexer.SKIPPED
                    });
                    var tokens = [
                        WhiteSpace,
                        NodeName,
                        DEF,
                        USE,
                        ROUTE,
                        TO,
                        TrueLiteral,
                        FalseLiteral,
                        NullLiteral,
                        Version,
                        Identifier,
                        RouteIdentifier,
                        StringLiteral,
                        HexLiteral,
                        NumberLiteral,
                        LSquare,
                        RSquare,
                        LCurly,
                        RCurly,
                        Comment
                    ];
                    var tokenVocabulary = {};
                    for (var i = 0, l = tokens.length; i < l; i++) {
                        var token = tokens[i];
                        tokenVocabulary[token.name] = token;
                    }
                    return {
                        tokens: tokens,
                        tokenVocabulary: tokenVocabulary
                    };
                }
                function createVisitor(BaseVRMLVisitor) {
                    function VRMLToASTVisitor() {
                        BaseVRMLVisitor.call(this);
                        this.validateVisitor();
                    }
                    VRMLToASTVisitor.prototype = Object.assign(Object.create(BaseVRMLVisitor.prototype), {
                        constructor: VRMLToASTVisitor,
                        vrml: function (ctx) {
                            var data = {
                                version: this.visit(ctx.version),
                                nodes: [],
                                routes: []
                            };
                            for (var i = 0, l = ctx.node.length; i < l; i++) {
                                var node = ctx.node[i];
                                data.nodes.push(this.visit(node));
                            }
                            if (ctx.route) {
                                for (var i = 0, l = ctx.route.length; i < l; i++) {
                                    var route = ctx.route[i];
                                    data.routes.push(this.visit(route));
                                }
                            }
                            return data;
                        },
                        version: function (ctx) {
                            return ctx.Version[0].image;
                        },
                        node: function (ctx) {
                            var data = {
                                name: ctx.NodeName[0].image,
                                fields: []
                            };
                            if (ctx.field) {
                                for (var i = 0, l = ctx.field.length; i < l; i++) {
                                    var field = ctx.field[i];
                                    data.fields.push(this.visit(field));
                                }
                            }
                            if (ctx.def) {
                                data.DEF = this.visit(ctx.def[0]);
                            }
                            return data;
                        },
                        field: function (ctx) {
                            var data = {
                                name: ctx.Identifier[0].image,
                                type: null,
                                values: null
                            };
                            var result;
                            if (ctx.singleFieldValue) {
                                result = this.visit(ctx.singleFieldValue[0]);
                            }
                            if (ctx.multiFieldValue) {
                                result = this.visit(ctx.multiFieldValue[0]);
                            }
                            data.type = result.type;
                            data.values = result.values;
                            return data;
                        },
                        def: function (ctx) {
                            return ctx.Identifier[0].image;
                        },
                        use: function (ctx) {
                            return { USE: ctx.Identifier[0].image };
                        },
                        singleFieldValue: function (ctx) {
                            return processField(this, ctx);
                        },
                        multiFieldValue: function (ctx) {
                            return processField(this, ctx);
                        },
                        route: function (ctx) {
                            var data = {
                                FROM: ctx.RouteIdentifier[0].image,
                                TO: ctx.RouteIdentifier[1].image
                            };
                            return data;
                        }
                    });
                    function processField(scope, ctx) {
                        var field = {
                            type: null,
                            values: []
                        };
                        if (ctx.node) {
                            field.type = 'node';
                            for (var i = 0, l = ctx.node.length; i < l; i++) {
                                var node = ctx.node[i];
                                field.values.push(scope.visit(node));
                            }
                        }
                        if (ctx.use) {
                            field.type = 'use';
                            for (var i = 0, l = ctx.use.length; i < l; i++) {
                                var use = ctx.use[i];
                                field.values.push(scope.visit(use));
                            }
                        }
                        if (ctx.StringLiteral) {
                            field.type = 'string';
                            for (var i = 0, l = ctx.StringLiteral.length; i < l; i++) {
                                var stringLiteral = ctx.StringLiteral[i];
                                field.values.push(stringLiteral.image.replace(/'|"/g, ''));
                            }
                        }
                        if (ctx.NumberLiteral) {
                            field.type = 'number';
                            for (var i = 0, l = ctx.NumberLiteral.length; i < l; i++) {
                                var numberLiteral = ctx.NumberLiteral[i];
                                field.values.push(parseFloat(numberLiteral.image));
                            }
                        }
                        if (ctx.HexLiteral) {
                            field.type = 'hex';
                            for (var i = 0, l = ctx.HexLiteral.length; i < l; i++) {
                                var hexLiteral = ctx.HexLiteral[i];
                                field.values.push(hexLiteral.image);
                            }
                        }
                        if (ctx.TrueLiteral) {
                            field.type = 'boolean';
                            for (var i = 0, l = ctx.TrueLiteral.length; i < l; i++) {
                                var trueLiteral = ctx.TrueLiteral[i];
                                if (trueLiteral.image === 'TRUE')
                                    field.values.push(true);
                            }
                        }
                        if (ctx.FalseLiteral) {
                            field.type = 'boolean';
                            for (var i = 0, l = ctx.FalseLiteral.length; i < l; i++) {
                                var falseLiteral = ctx.FalseLiteral[i];
                                if (falseLiteral.image === 'FALSE')
                                    field.values.push(false);
                            }
                        }
                        if (ctx.NullLiteral) {
                            field.type = 'null';
                            ctx.NullLiteral.forEach(function () {
                                field.values.push(null);
                            });
                        }
                        return field;
                    }
                    return new VRMLToASTVisitor();
                }
                function parseTree(tree) {
                    var nodes = tree.nodes;
                    var scene = new THREE.Scene();
                    for (var i = 0, l = nodes.length; i < l; i++) {
                        var node = nodes[i];
                        buildNodeMap(node);
                    }
                    for (var i = 0, l = nodes.length; i < l; i++) {
                        var node = nodes[i];
                        var object = getNode(node);
                        if (object instanceof THREE.Object3D)
                            scene.add(object);
                    }
                    return scene;
                }
                function buildNodeMap(node) {
                    if (node.DEF) {
                        nodeMap[node.DEF] = node;
                    }
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        if (field.type === 'node') {
                            var fieldValues = field.values;
                            for (var j = 0, jl = fieldValues.length; j < jl; j++) {
                                buildNodeMap(fieldValues[j]);
                            }
                        }
                    }
                }
                function getNode(node) {
                    if (node.USE) {
                        return resolveUSE(node.USE);
                    }
                    if (node.build !== undefined)
                        return node.build;
                    node.build = buildNode(node);
                    return node.build;
                }
                function buildNode(node) {
                    var nodeName = node.name;
                    var build;
                    switch (nodeName) {
                    case 'Group':
                    case 'Transform':
                        build = buildGroupingNode(node);
                        break;
                    case 'Background':
                        build = buildBackgroundNode(node);
                        break;
                    case 'Shape':
                        build = buildShapeNode(node);
                        break;
                    case 'Appearance':
                        build = buildAppearanceNode(node);
                        break;
                    case 'Material':
                        build = buildMaterialNode(node);
                        break;
                    case 'ImageTexture':
                        build = buildImageTextureNode(node);
                        break;
                    case 'PixelTexture':
                        build = buildPixelTextureNode(node);
                        break;
                    case 'TextureTransform':
                        build = buildTextureTransformNode(node);
                        break;
                    case 'IndexedFaceSet':
                        build = buildIndexedFaceSetNode(node);
                        break;
                    case 'IndexedLineSet':
                        build = buildIndexedLineSetNode(node);
                        break;
                    case 'PointSet':
                        build = buildPointSetNode(node);
                        break;
                    case 'Box':
                        build = buildBoxNode(node);
                        break;
                    case 'Cone':
                        build = buildConeNode(node);
                        break;
                    case 'Cylinder':
                        build = buildCylinderNode(node);
                        break;
                    case 'Sphere':
                        build = buildSphereNode(node);
                        break;
                    case 'Color':
                    case 'Coordinate':
                    case 'Normal':
                    case 'TextureCoordinate':
                        build = buildGeometricNode(node);
                        break;
                    case 'Anchor':
                    case 'Billboard':
                    case 'Collision':
                    case 'Inline':
                    case 'LOD':
                    case 'Switch':
                    case 'AudioClip':
                    case 'DirectionalLight':
                    case 'PointLight':
                    case 'Script':
                    case 'Sound':
                    case 'SpotLight':
                    case 'WorldInfo':
                    case 'CylinderSensor':
                    case 'PlaneSensor':
                    case 'ProximitySensor':
                    case 'SphereSensor':
                    case 'TimeSensor':
                    case 'TouchSensor':
                    case 'VisibilitySensor':
                    case 'ElevationGrid':
                    case 'Extrusion':
                    case 'Text':
                    case 'FontStyle':
                    case 'MovieTexture':
                    case 'ColorInterpolator':
                    case 'CoordinateInterpolator':
                    case 'NormalInterpolator':
                    case 'OrientationInterpolator':
                    case 'PositionInterpolator':
                    case 'ScalarInterpolator':
                    case 'Fog':
                    case 'NavigationInfo':
                    case 'Viewpoint':
                        break;
                    default:
                        console.warn('THREE.VRMLLoader: Unknown node:', nodeName);
                        break;
                    }
                    return build;
                }
                function buildGroupingNode(node) {
                    var object = new THREE.Group();
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'center':
                            break;
                        case 'children':
                            parseFieldChildren(fieldValues, object);
                            break;
                        case 'rotation':
                            var axis = new THREE.Vector3(fieldValues[0], fieldValues[1], fieldValues[2]);
                            var angle = fieldValues[3];
                            object.quaternion.setFromAxisAngle(axis, angle);
                            break;
                        case 'scale':
                            object.scale.set(fieldValues[0], fieldValues[1], fieldValues[2]);
                            break;
                        case 'scaleOrientation':
                            break;
                        case 'translation':
                            object.position.set(fieldValues[0], fieldValues[1], fieldValues[2]);
                            break;
                        case 'bboxCenter':
                            break;
                        case 'bboxSize':
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    return object;
                }
                function buildBackgroundNode(node) {
                    var group = new THREE.Group();
                    var groundAngle, groundColor;
                    var skyAngle, skyColor;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'groundAngle':
                            groundAngle = fieldValues;
                            break;
                        case 'groundColor':
                            groundColor = fieldValues;
                            break;
                        case 'backUrl':
                            break;
                        case 'bottomUrl':
                            break;
                        case 'frontUrl':
                            break;
                        case 'leftUrl':
                            break;
                        case 'rightUrl':
                            break;
                        case 'topUrl':
                            break;
                        case 'skyAngle':
                            skyAngle = fieldValues;
                            break;
                        case 'skyColor':
                            skyColor = fieldValues;
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    var radius = 10000;
                    if (skyColor) {
                        var skyGeometry = new THREE.SphereBufferGeometry(radius, 32, 16);
                        var skyMaterial = new THREE.MeshBasicMaterial({
                            fog: false,
                            side: THREE.BackSide,
                            depthWrite: false,
                            depthTest: false
                        });
                        if (skyColor.length > 3) {
                            paintFaces(skyGeometry, radius, skyAngle, toColorArray(skyColor), true);
                            skyMaterial.vertexColors = true;
                        } else {
                            skyMaterial.color.setRGB(skyColor[0], skyColor[1], skyColor[2]);
                        }
                        var sky = new THREE.Mesh(skyGeometry, skyMaterial);
                        group.add(sky);
                    }
                    if (groundColor) {
                        if (groundColor.length > 0) {
                            var groundGeometry = new THREE.SphereBufferGeometry(radius, 32, 16, 0, 2 * Math.PI, 0.5 * Math.PI, 1.5 * Math.PI);
                            var groundMaterial = new THREE.MeshBasicMaterial({
                                fog: false,
                                side: THREE.BackSide,
                                vertexColors: true,
                                depthWrite: false,
                                depthTest: false
                            });
                            paintFaces(groundGeometry, radius, groundAngle, toColorArray(groundColor), false);
                            var ground = new THREE.Mesh(groundGeometry, groundMaterial);
                            group.add(ground);
                        }
                    }
                    group.renderOrder = -Infinity;
                    return group;
                }
                function buildShapeNode(node) {
                    var fields = node.fields;
                    var material = new THREE.MeshBasicMaterial({ color: 0 });
                    var geometry;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'appearance':
                            if (fieldValues[0] !== null) {
                                material = getNode(fieldValues[0]);
                            }
                            break;
                        case 'geometry':
                            if (fieldValues[0] !== null) {
                                geometry = getNode(fieldValues[0]);
                            }
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    var object;
                    if (geometry && geometry.attributes.position) {
                        var type = geometry._type;
                        if (type === 'points') {
                            var pointsMaterial = new THREE.PointsMaterial({ color: 16777215 });
                            if (geometry.attributes.color !== undefined) {
                                pointsMaterial.vertexColors = true;
                            } else {
                                if (material.isMeshPhongMaterial) {
                                    pointsMaterial.color.copy(material.emissive);
                                }
                            }
                            object = new THREE.Points(geometry, pointsMaterial);
                        } else if (type === 'line') {
                            var lineMaterial = new THREE.LineBasicMaterial({ color: 16777215 });
                            if (geometry.attributes.color !== undefined) {
                                lineMaterial.vertexColors = true;
                            } else {
                                if (material.isMeshPhongMaterial) {
                                    lineMaterial.color.copy(material.emissive);
                                }
                            }
                            object = new THREE.LineSegments(geometry, lineMaterial);
                        } else {
                            if (geometry._solid !== undefined) {
                                material.side = geometry._solid ? THREE.FrontSide : THREE.DoubleSide;
                            }
                            if (geometry.attributes.color !== undefined) {
                                material.vertexColors = true;
                            }
                            object = new THREE.Mesh(geometry, material);
                        }
                    } else {
                        object = new THREE.Object3D();
                        object.visible = false;
                    }
                    return object;
                }
                function buildAppearanceNode(node) {
                    var material = new THREE.MeshPhongMaterial();
                    var transformData;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'material':
                            if (fieldValues[0] !== null) {
                                var materialData = getNode(fieldValues[0]);
                                if (materialData.diffuseColor)
                                    material.color.copy(materialData.diffuseColor);
                                if (materialData.emissiveColor)
                                    material.emissive.copy(materialData.emissiveColor);
                                if (materialData.shininess)
                                    material.shininess = materialData.shininess;
                                if (materialData.specularColor)
                                    material.specular.copy(materialData.specularColor);
                                if (materialData.transparency)
                                    material.opacity = 1 - materialData.transparency;
                                if (materialData.transparency > 0)
                                    material.transparent = true;
                            } else {
                                material = new THREE.MeshBasicMaterial({ color: 0 });
                            }
                            break;
                        case 'texture':
                            var textureNode = fieldValues[0];
                            if (textureNode !== null) {
                                if (textureNode.name === 'ImageTexture' || textureNode.name === 'PixelTexture') {
                                    material.map = getNode(textureNode);
                                } else {
                                }
                            }
                            break;
                        case 'textureTransform':
                            if (fieldValues[0] !== null) {
                                transformData = getNode(fieldValues[0]);
                            }
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    if (material.map) {
                        if (material.map.__type) {
                            switch (material.map.__type) {
                            case TEXTURE_TYPE.INTENSITY_ALPHA:
                                material.opacity = 1;
                                break;
                            case TEXTURE_TYPE.RGB:
                                material.color.set(16777215);
                                break;
                            case TEXTURE_TYPE.RGBA:
                                material.color.set(16777215);
                                material.opacity = 1;
                                break;
                            default:
                            }
                            delete material.map.__type;
                        }
                        if (transformData) {
                            material.map.center.copy(transformData.center);
                            material.map.rotation = transformData.rotation;
                            material.map.repeat.copy(transformData.scale);
                            material.map.offset.copy(transformData.translation);
                        }
                    }
                    return material;
                }
                function buildMaterialNode(node) {
                    var materialData = {};
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'ambientIntensity':
                            break;
                        case 'diffuseColor':
                            materialData.diffuseColor = new THREE.Color(fieldValues[0], fieldValues[1], fieldValues[2]);
                            break;
                        case 'emissiveColor':
                            materialData.emissiveColor = new THREE.Color(fieldValues[0], fieldValues[1], fieldValues[2]);
                            break;
                        case 'shininess':
                            materialData.shininess = fieldValues[0];
                            break;
                        case 'specularColor':
                            materialData.emissiveColor = new THREE.Color(fieldValues[0], fieldValues[1], fieldValues[2]);
                            break;
                        case 'transparency':
                            materialData.transparency = fieldValues[0];
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    return materialData;
                }
                function parseHexColor(hex, textureType, color) {
                    switch (textureType) {
                    case TEXTURE_TYPE.INTENSITY:
                        var value = parseInt(hex);
                        color.r = value;
                        color.g = value;
                        color.b = value;
                        break;
                    case TEXTURE_TYPE.INTENSITY_ALPHA:
                        var value = parseInt('0x' + hex.substring(2, 4));
                        color.r = value;
                        color.g = value;
                        color.b = value;
                        color.a = parseInt('0x' + hex.substring(4, 6));
                        break;
                    case TEXTURE_TYPE.RGB:
                        color.r = parseInt('0x' + hex.substring(2, 4));
                        color.g = parseInt('0x' + hex.substring(4, 6));
                        color.b = parseInt('0x' + hex.substring(6, 8));
                        break;
                    case TEXTURE_TYPE.RGBA:
                        color.r = parseInt('0x' + hex.substring(2, 4));
                        color.g = parseInt('0x' + hex.substring(4, 6));
                        color.b = parseInt('0x' + hex.substring(6, 8));
                        color.a = parseInt('0x' + hex.substring(8, 10));
                        break;
                    default:
                    }
                }
                function getTextureType(num_components) {
                    var type;
                    switch (num_components) {
                    case 1:
                        type = TEXTURE_TYPE.INTENSITY;
                        break;
                    case 2:
                        type = TEXTURE_TYPE.INTENSITY_ALPHA;
                        break;
                    case 3:
                        type = TEXTURE_TYPE.RGB;
                        break;
                    case 4:
                        type = TEXTURE_TYPE.RGBA;
                        break;
                    default:
                    }
                    return type;
                }
                function buildPixelTextureNode(node) {
                    var texture;
                    var wrapS = THREE.RepeatWrapping;
                    var wrapT = THREE.RepeatWrapping;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'image':
                            var width = fieldValues[0];
                            var height = fieldValues[1];
                            var num_components = fieldValues[2];
                            var useAlpha = num_components === 2 || num_components === 4;
                            var textureType = getTextureType(num_components);
                            var size = (useAlpha === true ? 4 : 3) * (width * height);
                            var data = new Uint8Array(size);
                            var color = {
                                r: 0,
                                g: 0,
                                b: 0,
                                a: 0
                            };
                            for (var j = 3, k = 0, jl = fieldValues.length; j < jl; j++, k++) {
                                parseHexColor(fieldValues[j], textureType, color);
                                if (useAlpha === true) {
                                    var stride = k * 4;
                                    data[stride + 0] = color.r;
                                    data[stride + 1] = color.g;
                                    data[stride + 2] = color.b;
                                    data[stride + 3] = color.a;
                                } else {
                                    var stride = k * 3;
                                    data[stride + 0] = color.r;
                                    data[stride + 1] = color.g;
                                    data[stride + 2] = color.b;
                                }
                            }
                            texture = new THREE.DataTexture(data, width, height, useAlpha === true ? THREE.RGBAFormat : THREE.RGBFormat);
                            texture.__type = textureType;
                            break;
                        case 'repeatS':
                            if (fieldValues[0] === false)
                                wrapS = THREE.ClampToEdgeWrapping;
                            break;
                        case 'repeatT':
                            if (fieldValues[0] === false)
                                wrapT = THREE.ClampToEdgeWrapping;
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    if (texture) {
                        texture.wrapS = wrapS;
                        texture.wrapT = wrapT;
                    }
                    return texture;
                }
                function buildImageTextureNode(node) {
                    var texture;
                    var wrapS = THREE.RepeatWrapping;
                    var wrapT = THREE.RepeatWrapping;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'url':
                            var url = fieldValues[0];
                            if (url)
                                texture = textureLoader.load(url);
                            break;
                        case 'repeatS':
                            if (fieldValues[0] === false)
                                wrapS = THREE.ClampToEdgeWrapping;
                            break;
                        case 'repeatT':
                            if (fieldValues[0] === false)
                                wrapT = THREE.ClampToEdgeWrapping;
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    if (texture) {
                        texture.wrapS = wrapS;
                        texture.wrapT = wrapT;
                    }
                    return texture;
                }
                function buildTextureTransformNode(node) {
                    var transformData = {
                        center: new THREE.Vector2(),
                        rotation: new THREE.Vector2(),
                        scale: new THREE.Vector2(),
                        translation: new THREE.Vector2()
                    };
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'center':
                            transformData.center.set(fieldValues[0], fieldValues[1]);
                            break;
                        case 'rotation':
                            transformData.rotation = fieldValues[0];
                            break;
                        case 'scale':
                            transformData.scale.set(fieldValues[0], fieldValues[1]);
                            break;
                        case 'translation':
                            transformData.translation.set(fieldValues[0], fieldValues[1]);
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    return transformData;
                }
                function buildGeometricNode(node) {
                    return node.fields[0].values;
                }
                function buildIndexedFaceSetNode(node) {
                    var color, coord, normal, texCoord;
                    var ccw = true, solid = true, creaseAngle = 0;
                    var colorIndex, coordIndex, normalIndex, texCoordIndex;
                    var colorPerVertex = true, normalPerVertex = true;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'color':
                            var colorNode = fieldValues[0];
                            if (colorNode !== null) {
                                color = getNode(colorNode);
                            }
                            break;
                        case 'coord':
                            var coordNode = fieldValues[0];
                            if (coordNode !== null) {
                                coord = getNode(coordNode);
                            }
                            break;
                        case 'normal':
                            var normalNode = fieldValues[0];
                            if (normalNode !== null) {
                                normal = getNode(normalNode);
                            }
                            break;
                        case 'texCoord':
                            var texCoordNode = fieldValues[0];
                            if (texCoordNode !== null) {
                                texCoord = getNode(texCoordNode);
                            }
                            break;
                        case 'ccw':
                            ccw = fieldValues[0];
                            break;
                        case 'colorIndex':
                            colorIndex = fieldValues;
                            break;
                        case 'colorPerVertex':
                            colorPerVertex = fieldValues[0];
                            break;
                        case 'convex':
                            break;
                        case 'coordIndex':
                            coordIndex = fieldValues;
                            break;
                        case 'creaseAngle':
                            creaseAngle = fieldValues[0];
                            break;
                        case 'normalIndex':
                            normalIndex = fieldValues;
                            break;
                        case 'normalPerVertex':
                            normalPerVertex = fieldValues[0];
                            break;
                        case 'solid':
                            solid = fieldValues[0];
                            break;
                        case 'texCoordIndex':
                            texCoordIndex = fieldValues;
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    if (coordIndex === undefined) {
                        console.warn('THREE.VRMLLoader: Missing coordIndex.');
                        return new THREE.BufferGeometry();
                    }
                    var triangulatedCoordIndex = triangulateFaceIndex(coordIndex, ccw);
                    var positionAttribute;
                    var colorAttribute;
                    var normalAttribute;
                    var uvAttribute;
                    if (color) {
                        if (colorPerVertex === true) {
                            if (colorIndex && colorIndex.length > 0) {
                                var triangulatedColorIndex = triangulateFaceIndex(colorIndex, ccw);
                                colorAttribute = computeAttributeFromIndexedData(triangulatedCoordIndex, triangulatedColorIndex, color, 3);
                            } else {
                                colorAttribute = toNonIndexedAttribute(triangulatedCoordIndex, new THREE.Float32BufferAttribute(color, 3));
                            }
                        } else {
                            if (colorIndex && colorIndex.length > 0) {
                                var flattenFaceColors = flattenData(color, colorIndex);
                                var triangulatedFaceColors = triangulateFaceData(flattenFaceColors, coordIndex);
                                colorAttribute = computeAttributeFromFaceData(triangulatedCoordIndex, triangulatedFaceColors);
                            } else {
                                var triangulatedFaceColors = triangulateFaceData(color, coordIndex);
                                colorAttribute = computeAttributeFromFaceData(triangulatedCoordIndex, triangulatedFaceColors);
                            }
                        }
                    }
                    if (normal) {
                        if (normalPerVertex === true) {
                            if (normalIndex && normalIndex.length > 0) {
                                var triangulatedNormalIndex = triangulateFaceIndex(normalIndex, ccw);
                                normalAttribute = computeAttributeFromIndexedData(triangulatedCoordIndex, triangulatedNormalIndex, normal, 3);
                            } else {
                                normalAttribute = toNonIndexedAttribute(triangulatedCoordIndex, new THREE.Float32BufferAttribute(normal, 3));
                            }
                        } else {
                            if (normalIndex && normalIndex.length > 0) {
                                var flattenFaceNormals = flattenData(normal, normalIndex);
                                var triangulatedFaceNormals = triangulateFaceData(flattenFaceNormals, coordIndex);
                                normalAttribute = computeAttributeFromFaceData(triangulatedCoordIndex, triangulatedFaceNormals);
                            } else {
                                var triangulatedFaceNormals = triangulateFaceData(normal, coordIndex);
                                normalAttribute = computeAttributeFromFaceData(triangulatedCoordIndex, triangulatedFaceNormals);
                            }
                        }
                    } else {
                        normalAttribute = computeNormalAttribute(triangulatedCoordIndex, coord, creaseAngle);
                    }
                    if (texCoord) {
                        if (texCoordIndex && texCoordIndex.length > 0) {
                            var triangulatedTexCoordIndex = triangulateFaceIndex(texCoordIndex, ccw);
                            uvAttribute = computeAttributeFromIndexedData(triangulatedCoordIndex, triangulatedTexCoordIndex, texCoord, 2);
                        } else {
                            uvAttribute = toNonIndexedAttribute(triangulatedCoordIndex, new THREE.Float32BufferAttribute(texCoord, 2));
                        }
                    }
                    var geometry = new THREE.BufferGeometry();
                    positionAttribute = toNonIndexedAttribute(triangulatedCoordIndex, new THREE.Float32BufferAttribute(coord, 3));
                    geometry.setAttribute('position', positionAttribute);
                    geometry.setAttribute('normal', normalAttribute);
                    if (colorAttribute)
                        geometry.setAttribute('color', colorAttribute);
                    if (uvAttribute)
                        geometry.setAttribute('uv', uvAttribute);
                    geometry._solid = solid;
                    geometry._type = 'mesh';
                    return geometry;
                }
                function buildIndexedLineSetNode(node) {
                    var color, coord;
                    var colorIndex, coordIndex;
                    var colorPerVertex = true;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'color':
                            var colorNode = fieldValues[0];
                            if (colorNode !== null) {
                                color = getNode(colorNode);
                            }
                            break;
                        case 'coord':
                            var coordNode = fieldValues[0];
                            if (coordNode !== null) {
                                coord = getNode(coordNode);
                            }
                            break;
                        case 'colorIndex':
                            colorIndex = fieldValues;
                            break;
                        case 'colorPerVertex':
                            colorPerVertex = fieldValues[0];
                            break;
                        case 'coordIndex':
                            coordIndex = fieldValues;
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    var colorAttribute;
                    var expandedLineIndex = expandLineIndex(coordIndex);
                    if (color) {
                        if (colorPerVertex === true) {
                            if (colorIndex.length > 0) {
                                var expandedColorIndex = expandLineIndex(colorIndex);
                                colorAttribute = computeAttributeFromIndexedData(expandedLineIndex, expandedColorIndex, color, 3);
                            } else {
                                colorAttribute = toNonIndexedAttribute(expandedLineIndex, new THREE.Float32BufferAttribute(color, 3));
                            }
                        } else {
                            if (colorIndex.length > 0) {
                                var flattenLineColors = flattenData(color, colorIndex);
                                var expandedLineColors = expandLineData(flattenLineColors, coordIndex);
                                colorAttribute = computeAttributeFromLineData(expandedLineIndex, expandedLineColors);
                            } else {
                                var expandedLineColors = expandLineData(color, coordIndex);
                                colorAttribute = computeAttributeFromLineData(expandedLineIndex, expandedLineColors);
                            }
                        }
                    }
                    var geometry = new THREE.BufferGeometry();
                    var positionAttribute = toNonIndexedAttribute(expandedLineIndex, new THREE.Float32BufferAttribute(coord, 3));
                    geometry.setAttribute('position', positionAttribute);
                    if (colorAttribute)
                        geometry.setAttribute('color', colorAttribute);
                    geometry._type = 'line';
                    return geometry;
                }
                function buildPointSetNode(node) {
                    var geometry;
                    var color, coord;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'color':
                            var colorNode = fieldValues[0];
                            if (colorNode !== null) {
                                color = getNode(colorNode);
                            }
                            break;
                        case 'coord':
                            var coordNode = fieldValues[0];
                            if (coordNode !== null) {
                                coord = getNode(coordNode);
                            }
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    var geometry = new THREE.BufferGeometry();
                    geometry.setAttribute('position', new THREE.Float32BufferAttribute(coord, 3));
                    if (color)
                        geometry.setAttribute('color', new THREE.Float32BufferAttribute(color, 3));
                    geometry._type = 'points';
                    return geometry;
                }
                function buildBoxNode(node) {
                    var size = new THREE.Vector3(2, 2, 2);
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'size':
                            size.x = fieldValues[0];
                            size.y = fieldValues[1];
                            size.z = fieldValues[2];
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    var geometry = new THREE.BoxBufferGeometry(size.x, size.y, size.z);
                    return geometry;
                }
                function buildConeNode(node) {
                    var radius = 1, height = 2, openEnded = false;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'bottom':
                            openEnded = !fieldValues[0];
                            break;
                        case 'bottomRadius':
                            radius = fieldValues[0];
                            break;
                        case 'height':
                            height = fieldValues[0];
                            break;
                        case 'side':
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    var geometry = new THREE.ConeBufferGeometry(radius, height, 16, 1, openEnded);
                    return geometry;
                }
                function buildCylinderNode(node) {
                    var radius = 1, height = 2;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'bottom':
                            break;
                        case 'radius':
                            radius = fieldValues[0];
                            break;
                        case 'height':
                            height = fieldValues[0];
                            break;
                        case 'side':
                            break;
                        case 'top':
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    var geometry = new THREE.CylinderBufferGeometry(radius, radius, height, 16, 1);
                    return geometry;
                }
                function buildSphereNode(node) {
                    var radius = 1;
                    var fields = node.fields;
                    for (var i = 0, l = fields.length; i < l; i++) {
                        var field = fields[i];
                        var fieldName = field.name;
                        var fieldValues = field.values;
                        switch (fieldName) {
                        case 'radius':
                            radius = fieldValues[0];
                            break;
                        default:
                            console.warn('THREE.VRMLLoader: Unknown field:', fieldName);
                            break;
                        }
                    }
                    var geometry = new THREE.SphereBufferGeometry(radius, 16, 16);
                    return geometry;
                }
                function resolveUSE(identifier) {
                    var node = nodeMap[identifier];
                    var build = getNode(node);
                    return build.isObject3D || build.isMaterial ? build.clone() : build;
                }
                function parseFieldChildren(children, owner) {
                    for (var i = 0, l = children.length; i < l; i++) {
                        var object = getNode(children[i]);
                        if (object instanceof THREE.Object3D)
                            owner.add(object);
                    }
                }
                function triangulateFaceIndex(index, ccw) {
                    var indices = [];
                    var start = 0;
                    for (var i = 0, l = index.length; i < l; i++) {
                        var i1 = index[start];
                        var i2 = index[i + (ccw ? 1 : 2)];
                        var i3 = index[i + (ccw ? 2 : 1)];
                        indices.push(i1, i2, i3);
                        if (index[i + 3] === -1 || i + 3 >= l) {
                            i += 3;
                            start = i + 1;
                        }
                    }
                    return indices;
                }
                function triangulateFaceData(data, index) {
                    var triangulatedData = [];
                    var start = 0;
                    for (var i = 0, l = index.length; i < l; i++) {
                        var stride = start * 3;
                        var x = data[stride];
                        var y = data[stride + 1];
                        var z = data[stride + 2];
                        triangulatedData.push(x, y, z);
                        if (index[i + 3] === -1 || i + 3 >= l) {
                            i += 3;
                            start++;
                        }
                    }
                    return triangulatedData;
                }
                function flattenData(data, index) {
                    var flattenData = [];
                    for (var i = 0, l = index.length; i < l; i++) {
                        var i1 = index[i];
                        var stride = i1 * 3;
                        var x = data[stride];
                        var y = data[stride + 1];
                        var z = data[stride + 2];
                        flattenData.push(x, y, z);
                    }
                    return flattenData;
                }
                function expandLineIndex(index) {
                    var indices = [];
                    for (var i = 0, l = index.length; i < l; i++) {
                        var i1 = index[i];
                        var i2 = index[i + 1];
                        indices.push(i1, i2);
                        if (index[i + 2] === -1 || i + 2 >= l) {
                            i += 2;
                        }
                    }
                    return indices;
                }
                function expandLineData(data, index) {
                    var triangulatedData = [];
                    var start = 0;
                    for (var i = 0, l = index.length; i < l; i++) {
                        var stride = start * 3;
                        var x = data[stride];
                        var y = data[stride + 1];
                        var z = data[stride + 2];
                        triangulatedData.push(x, y, z);
                        if (index[i + 2] === -1 || i + 2 >= l) {
                            i += 2;
                            start++;
                        }
                    }
                    return triangulatedData;
                }
                var vA = new THREE.Vector3();
                var vB = new THREE.Vector3();
                var vC = new THREE.Vector3();
                var uvA = new THREE.Vector2();
                var uvB = new THREE.Vector2();
                var uvC = new THREE.Vector2();
                function computeAttributeFromIndexedData(coordIndex, index, data, itemSize) {
                    var array = [];
                    for (var i = 0, l = coordIndex.length; i < l; i += 3) {
                        var a = index[i];
                        var b = index[i + 1];
                        var c = index[i + 2];
                        if (itemSize === 2) {
                            uvA.fromArray(data, a * itemSize);
                            uvB.fromArray(data, b * itemSize);
                            uvC.fromArray(data, c * itemSize);
                            array.push(uvA.x, uvA.y);
                            array.push(uvB.x, uvB.y);
                            array.push(uvC.x, uvC.y);
                        } else {
                            vA.fromArray(data, a * itemSize);
                            vB.fromArray(data, b * itemSize);
                            vC.fromArray(data, c * itemSize);
                            array.push(vA.x, vA.y, vA.z);
                            array.push(vB.x, vB.y, vB.z);
                            array.push(vC.x, vC.y, vC.z);
                        }
                    }
                    return new THREE.Float32BufferAttribute(array, itemSize);
                }
                function computeAttributeFromFaceData(index, faceData) {
                    var array = [];
                    for (var i = 0, j = 0, l = index.length; i < l; i += 3, j++) {
                        vA.fromArray(faceData, j * 3);
                        array.push(vA.x, vA.y, vA.z);
                        array.push(vA.x, vA.y, vA.z);
                        array.push(vA.x, vA.y, vA.z);
                    }
                    return new THREE.Float32BufferAttribute(array, 3);
                }
                function computeAttributeFromLineData(index, lineData) {
                    var array = [];
                    for (var i = 0, j = 0, l = index.length; i < l; i += 2, j++) {
                        vA.fromArray(lineData, j * 3);
                        array.push(vA.x, vA.y, vA.z);
                        array.push(vA.x, vA.y, vA.z);
                    }
                    return new THREE.Float32BufferAttribute(array, 3);
                }
                function toNonIndexedAttribute(indices, attribute) {
                    var array = attribute.array;
                    var itemSize = attribute.itemSize;
                    var array2 = new array.constructor(indices.length * itemSize);
                    var index = 0, index2 = 0;
                    for (var i = 0, l = indices.length; i < l; i++) {
                        index = indices[i] * itemSize;
                        for (var j = 0; j < itemSize; j++) {
                            array2[index2++] = array[index++];
                        }
                    }
                    return new THREE.Float32BufferAttribute(array2, itemSize);
                }
                var ab = new THREE.Vector3();
                var cb = new THREE.Vector3();
                function computeNormalAttribute(index, coord, creaseAngle) {
                    var faces = [];
                    var vertexNormals = {};
                    for (var i = 0, l = index.length; i < l; i += 3) {
                        var a = index[i];
                        var b = index[i + 1];
                        var c = index[i + 2];
                        var face = new Face(a, b, c);
                        vA.fromArray(coord, a * 3);
                        vB.fromArray(coord, b * 3);
                        vC.fromArray(coord, c * 3);
                        cb.subVectors(vC, vB);
                        ab.subVectors(vA, vB);
                        cb.cross(ab);
                        cb.normalize();
                        face.normal.copy(cb);
                        if (vertexNormals[a] === undefined)
                            vertexNormals[a] = [];
                        if (vertexNormals[b] === undefined)
                            vertexNormals[b] = [];
                        if (vertexNormals[c] === undefined)
                            vertexNormals[c] = [];
                        vertexNormals[a].push(face.normal);
                        vertexNormals[b].push(face.normal);
                        vertexNormals[c].push(face.normal);
                        faces.push(face);
                    }
                    var normals = [];
                    for (var i = 0, l = faces.length; i < l; i++) {
                        var face = faces[i];
                        var nA = weightedNormal(vertexNormals[face.a], face.normal, creaseAngle);
                        var nB = weightedNormal(vertexNormals[face.b], face.normal, creaseAngle);
                        var nC = weightedNormal(vertexNormals[face.c], face.normal, creaseAngle);
                        vA.fromArray(coord, face.a * 3);
                        vB.fromArray(coord, face.b * 3);
                        vC.fromArray(coord, face.c * 3);
                        normals.push(nA.x, nA.y, nA.z);
                        normals.push(nB.x, nB.y, nB.z);
                        normals.push(nC.x, nC.y, nC.z);
                    }
                    return new THREE.Float32BufferAttribute(normals, 3);
                }
                function weightedNormal(normals, vector, creaseAngle) {
                    var normal = new THREE.Vector3();
                    if (creaseAngle === 0) {
                        normal.copy(vector);
                    } else {
                        for (var i = 0, l = normals.length; i < l; i++) {
                            if (normals[i].angleTo(vector) < creaseAngle) {
                                normal.add(normals[i]);
                            }
                        }
                    }
                    return normal.normalize();
                }
                function toColorArray(colors) {
                    var array = [];
                    for (var i = 0, l = colors.length; i < l; i += 3) {
                        array.push(new THREE.Color(colors[i], colors[i + 1], colors[i + 2]));
                    }
                    return array;
                }
                function paintFaces(geometry, radius, angles, colors, topDown) {
                    var thresholds = [];
                    var startAngle = topDown === true ? 0 : Math.PI;
                    for (var i = 0, l = colors.length; i < l; i++) {
                        var angle = i === 0 ? 0 : angles[i - 1];
                        angle = topDown === true ? angle : startAngle - angle;
                        var point = new THREE.Vector3();
                        point.setFromSphericalCoords(radius, angle, 0);
                        thresholds.push(point);
                    }
                    var indices = geometry.index;
                    var positionAttribute = geometry.attributes.position;
                    var colorAttribute = new THREE.BufferAttribute(new Float32Array(geometry.attributes.position.count * 3), 3);
                    var position = new THREE.Vector3();
                    var color = new THREE.Color();
                    for (var i = 0; i < indices.count; i++) {
                        var index = indices.getX(i);
                        position.fromBufferAttribute(positionAttribute, index);
                        var thresholdIndexA, thresholdIndexB;
                        var t = 1;
                        for (var j = 1; j < thresholds.length; j++) {
                            thresholdIndexA = j - 1;
                            thresholdIndexB = j;
                            var thresholdA = thresholds[thresholdIndexA];
                            var thresholdB = thresholds[thresholdIndexB];
                            if (topDown === true) {
                                if (position.y <= thresholdA.y && position.y > thresholdB.y) {
                                    t = Math.abs(thresholdA.y - position.y) / Math.abs(thresholdA.y - thresholdB.y);
                                    break;
                                }
                            } else {
                                if (position.y >= thresholdA.y && position.y < thresholdB.y) {
                                    t = Math.abs(thresholdA.y - position.y) / Math.abs(thresholdA.y - thresholdB.y);
                                    break;
                                }
                            }
                        }
                        var colorA = colors[thresholdIndexA];
                        var colorB = colors[thresholdIndexB];
                        color.copy(colorA).lerp(colorB, t);
                        colorAttribute.setXYZ(index, color.r, color.g, color.b);
                    }
                    geometry.setAttribute('color', colorAttribute);
                }
                var textureLoader = new THREE.TextureLoader(this.manager);
                textureLoader.setPath(this.resourcePath || path).setCrossOrigin(this.crossOrigin);
                var tree = generateVRMLTree(data);
                if (tree.version.indexOf('V2.0') === -1) {
                    throw Error('THREE.VRMLLexer: Version of VRML asset not supported.');
                }
                var scene = parseTree(tree);
                return scene;
            }
        });
        function VRMLLexer(tokens) {
            this.lexer = new chevrotain.Lexer(tokens);
        }
        VRMLLexer.prototype = {
            constructor: VRMLLexer,
            lex: function (inputText) {
                var lexingResult = this.lexer.tokenize(inputText);
                if (lexingResult.errors.length > 0) {
                    console.error(lexingResult.errors);
                    throw Error('THREE.VRMLLexer: Lexing errors detected.');
                }
                return lexingResult;
            }
        };
        function VRMLParser(tokenVocabulary) {
            chevrotain.Parser.call(this, tokenVocabulary);
            var $ = this;
            var Version = tokenVocabulary['Version'];
            var LCurly = tokenVocabulary['LCurly'];
            var RCurly = tokenVocabulary['RCurly'];
            var LSquare = tokenVocabulary['LSquare'];
            var RSquare = tokenVocabulary['RSquare'];
            var Identifier = tokenVocabulary['Identifier'];
            var RouteIdentifier = tokenVocabulary['RouteIdentifier'];
            var StringLiteral = tokenVocabulary['StringLiteral'];
            var HexLiteral = tokenVocabulary['HexLiteral'];
            var NumberLiteral = tokenVocabulary['NumberLiteral'];
            var TrueLiteral = tokenVocabulary['TrueLiteral'];
            var FalseLiteral = tokenVocabulary['FalseLiteral'];
            var NullLiteral = tokenVocabulary['NullLiteral'];
            var DEF = tokenVocabulary['DEF'];
            var USE = tokenVocabulary['USE'];
            var ROUTE = tokenVocabulary['ROUTE'];
            var TO = tokenVocabulary['TO'];
            var NodeName = tokenVocabulary['NodeName'];
            $.RULE('vrml', function () {
                $.SUBRULE($.version);
                $.AT_LEAST_ONE(function () {
                    $.SUBRULE($.node);
                });
                $.MANY(function () {
                    $.SUBRULE($.route);
                });
            });
            $.RULE('version', function () {
                $.CONSUME(Version);
            });
            $.RULE('node', function () {
                $.OPTION(function () {
                    $.SUBRULE($.def);
                });
                $.CONSUME(NodeName);
                $.CONSUME(LCurly);
                $.MANY(function () {
                    $.SUBRULE($.field);
                });
                $.CONSUME(RCurly);
            });
            $.RULE('field', function () {
                $.CONSUME(Identifier);
                $.OR2([
                    {
                        ALT: function () {
                            $.SUBRULE($.singleFieldValue);
                        }
                    },
                    {
                        ALT: function () {
                            $.SUBRULE($.multiFieldValue);
                        }
                    }
                ]);
            });
            $.RULE('def', function () {
                $.CONSUME(DEF);
                $.CONSUME(Identifier);
            });
            $.RULE('use', function () {
                $.CONSUME(USE);
                $.CONSUME(Identifier);
            });
            $.RULE('singleFieldValue', function () {
                $.AT_LEAST_ONE(function () {
                    $.OR([
                        {
                            ALT: function () {
                                $.SUBRULE($.node);
                            }
                        },
                        {
                            ALT: function () {
                                $.SUBRULE($.use);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(StringLiteral);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(HexLiteral);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(NumberLiteral);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(TrueLiteral);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(FalseLiteral);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(NullLiteral);
                            }
                        }
                    ]);
                });
            });
            $.RULE('multiFieldValue', function () {
                $.CONSUME(LSquare);
                $.MANY(function () {
                    $.OR([
                        {
                            ALT: function () {
                                $.SUBRULE($.node);
                            }
                        },
                        {
                            ALT: function () {
                                $.SUBRULE($.use);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(StringLiteral);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(HexLiteral);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(NumberLiteral);
                            }
                        },
                        {
                            ALT: function () {
                                $.CONSUME(NullLiteral);
                            }
                        }
                    ]);
                });
                $.CONSUME(RSquare);
            });
            $.RULE('route', function () {
                $.CONSUME(ROUTE);
                $.CONSUME(RouteIdentifier);
                $.CONSUME(TO);
                $.CONSUME2(RouteIdentifier);
            });
            this.performSelfAnalysis();
        }
        VRMLParser.prototype = Object.create(chevrotain.Parser.prototype);
        VRMLParser.prototype.constructor = VRMLParser;
        function Face(a, b, c) {
            this.a = a;
            this.b = b;
            this.c = c;
            this.normal = new THREE.Vector3();
        }
        var TEXTURE_TYPE = {
            INTENSITY: 1,
            INTENSITY_ALPHA: 2,
            RGB: 3,
            RGBA: 4
        };
        return VRMLLoader;
    }();

    return threex.loaders.VRMLLoader = VRMLLoader;
});
define('skylark-threejs-ex/loaders/VTKLoader',[
    "skylark-threejs",
    'skylark-zlib/Inflate',
    "../threex"
], function (
    THREE, 
    Inflate,
    threex
) {
    'use strict';
    var VTKLoader = function (manager) {
        THREE.Loader.call(this, manager);
    };
    VTKLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: VTKLoader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var loader = new THREE.FileLoader(scope.manager);
            loader.setPath(scope.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (text) {
                onLoad(scope.parse(text));
            }, onProgress, onError);
        },
        parse: function (data) {
            function parseASCII(data) {
                var indices = [];
                var positions = [];
                var colors = [];
                var normals = [];
                var result;
                var patWord = /^[^\d.\s-]+/;
                var pat3Floats = /(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g;
                var patConnectivity = /^(\d+)\s+([\s\d]*)/;
                var patPOINTS = /^POINTS /;
                var patPOLYGONS = /^POLYGONS /;
                var patTRIANGLE_STRIPS = /^TRIANGLE_STRIPS /;
                var patPOINT_DATA = /^POINT_DATA[ ]+(\d+)/;
                var patCELL_DATA = /^CELL_DATA[ ]+(\d+)/;
                var patCOLOR_SCALARS = /^COLOR_SCALARS[ ]+(\w+)[ ]+3/;
                var patNORMALS = /^NORMALS[ ]+(\w+)[ ]+(\w+)/;
                var inPointsSection = false;
                var inPolygonsSection = false;
                var inTriangleStripSection = false;
                var inPointDataSection = false;
                var inCellDataSection = false;
                var inColorSection = false;
                var inNormalsSection = false;
                var lines = data.split('\n');
                for (var i in lines) {
                    var line = lines[i].trim();
                    if (line.indexOf('DATASET') === 0) {
                        var dataset = line.split(' ')[1];
                        if (dataset !== 'POLYDATA')
                            throw new Error('Unsupported DATASET type: ' + dataset);
                    } else if (inPointsSection) {
                        while ((result = pat3Floats.exec(line)) !== null) {
                            if (patWord.exec(line) !== null)
                                break;
                            var x = parseFloat(result[1]);
                            var y = parseFloat(result[2]);
                            var z = parseFloat(result[3]);
                            positions.push(x, y, z);
                        }
                    } else if (inPolygonsSection) {
                        if ((result = patConnectivity.exec(line)) !== null) {
                            var numVertices = parseInt(result[1]);
                            var inds = result[2].split(/\s+/);
                            if (numVertices >= 3) {
                                var i0 = parseInt(inds[0]);
                                var i1, i2;
                                var k = 1;
                                for (var j = 0; j < numVertices - 2; ++j) {
                                    i1 = parseInt(inds[k]);
                                    i2 = parseInt(inds[k + 1]);
                                    indices.push(i0, i1, i2);
                                    k++;
                                }
                            }
                        }
                    } else if (inTriangleStripSection) {
                        if ((result = patConnectivity.exec(line)) !== null) {
                            var numVertices = parseInt(result[1]);
                            var inds = result[2].split(/\s+/);
                            if (numVertices >= 3) {
                                var i0, i1, i2;
                                for (var j = 0; j < numVertices - 2; j++) {
                                    if (j % 2 === 1) {
                                        i0 = parseInt(inds[j]);
                                        i1 = parseInt(inds[j + 2]);
                                        i2 = parseInt(inds[j + 1]);
                                        indices.push(i0, i1, i2);
                                    } else {
                                        i0 = parseInt(inds[j]);
                                        i1 = parseInt(inds[j + 1]);
                                        i2 = parseInt(inds[j + 2]);
                                        indices.push(i0, i1, i2);
                                    }
                                }
                            }
                        }
                    } else if (inPointDataSection || inCellDataSection) {
                        if (inColorSection) {
                            while ((result = pat3Floats.exec(line)) !== null) {
                                if (patWord.exec(line) !== null)
                                    break;
                                var r = parseFloat(result[1]);
                                var g = parseFloat(result[2]);
                                var b = parseFloat(result[3]);
                                colors.push(r, g, b);
                            }
                        } else if (inNormalsSection) {
                            while ((result = pat3Floats.exec(line)) !== null) {
                                if (patWord.exec(line) !== null)
                                    break;
                                var nx = parseFloat(result[1]);
                                var ny = parseFloat(result[2]);
                                var nz = parseFloat(result[3]);
                                normals.push(nx, ny, nz);
                            }
                        }
                    }
                    if (patPOLYGONS.exec(line) !== null) {
                        inPolygonsSection = true;
                        inPointsSection = false;
                        inTriangleStripSection = false;
                    } else if (patPOINTS.exec(line) !== null) {
                        inPolygonsSection = false;
                        inPointsSection = true;
                        inTriangleStripSection = false;
                    } else if (patTRIANGLE_STRIPS.exec(line) !== null) {
                        inPolygonsSection = false;
                        inPointsSection = false;
                        inTriangleStripSection = true;
                    } else if (patPOINT_DATA.exec(line) !== null) {
                        inPointDataSection = true;
                        inPointsSection = false;
                        inPolygonsSection = false;
                        inTriangleStripSection = false;
                    } else if (patCELL_DATA.exec(line) !== null) {
                        inCellDataSection = true;
                        inPointsSection = false;
                        inPolygonsSection = false;
                        inTriangleStripSection = false;
                    } else if (patCOLOR_SCALARS.exec(line) !== null) {
                        inColorSection = true;
                        inNormalsSection = false;
                        inPointsSection = false;
                        inPolygonsSection = false;
                        inTriangleStripSection = false;
                    } else if (patNORMALS.exec(line) !== null) {
                        inNormalsSection = true;
                        inColorSection = false;
                        inPointsSection = false;
                        inPolygonsSection = false;
                        inTriangleStripSection = false;
                    }
                }
                var geometry = new THREE.BufferGeometry();
                geometry.setIndex(indices);
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
                if (normals.length === positions.length) {
                    geometry.setAttribute('normal', new THREE.Float32BufferAttribute(normals, 3));
                }
                if (colors.length !== indices.length) {
                    if (colors.length === positions.length) {
                        geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
                    }
                } else {
                    geometry = geometry.toNonIndexed();
                    var numTriangles = geometry.attributes.position.count / 3;
                    if (colors.length === numTriangles * 3) {
                        var newColors = [];
                        for (var i = 0; i < numTriangles; i++) {
                            var r = colors[3 * i + 0];
                            var g = colors[3 * i + 1];
                            var b = colors[3 * i + 2];
                            newColors.push(r, g, b);
                            newColors.push(r, g, b);
                            newColors.push(r, g, b);
                        }
                        geometry.setAttribute('color', new THREE.Float32BufferAttribute(newColors, 3));
                    }
                }
                return geometry;
            }
            function parseBinary(data) {
                var count, pointIndex, i, numberOfPoints, s;
                var buffer = new Uint8Array(data);
                var dataView = new DataView(data);
                var points = [];
                var normals = [];
                var indices = [];
                var vtk = [];
                var index = 0;
                function findString(buffer, start) {
                    var index = start;
                    var c = buffer[index];
                    var s = [];
                    while (c !== 10) {
                        s.push(String.fromCharCode(c));
                        index++;
                        c = buffer[index];
                    }
                    return {
                        start: start,
                        end: index,
                        next: index + 1,
                        parsedString: s.join('')
                    };
                }
                var state, line;
                while (true) {
                    state = findString(buffer, index);
                    line = state.parsedString;
                    if (line.indexOf('DATASET') === 0) {
                        var dataset = line.split(' ')[1];
                        if (dataset !== 'POLYDATA')
                            throw new Error('Unsupported DATASET type: ' + dataset);
                    } else if (line.indexOf('POINTS') === 0) {
                        vtk.push(line);
                        numberOfPoints = parseInt(line.split(' ')[1], 10);
                        count = numberOfPoints * 4 * 3;
                        points = new Float32Array(numberOfPoints * 3);
                        pointIndex = state.next;
                        for (i = 0; i < numberOfPoints; i++) {
                            points[3 * i] = dataView.getFloat32(pointIndex, false);
                            points[3 * i + 1] = dataView.getFloat32(pointIndex + 4, false);
                            points[3 * i + 2] = dataView.getFloat32(pointIndex + 8, false);
                            pointIndex = pointIndex + 12;
                        }
                        state.next = state.next + count + 1;
                    } else if (line.indexOf('TRIANGLE_STRIPS') === 0) {
                        var numberOfStrips = parseInt(line.split(' ')[1], 10);
                        var size = parseInt(line.split(' ')[2], 10);
                        count = size * 4;
                        indices = new Uint32Array(3 * size - 9 * numberOfStrips);
                        var indicesIndex = 0;
                        pointIndex = state.next;
                        for (i = 0; i < numberOfStrips; i++) {
                            var indexCount = dataView.getInt32(pointIndex, false);
                            var strip = [];
                            pointIndex += 4;
                            for (s = 0; s < indexCount; s++) {
                                strip.push(dataView.getInt32(pointIndex, false));
                                pointIndex += 4;
                            }
                            for (var j = 0; j < indexCount - 2; j++) {
                                if (j % 2) {
                                    indices[indicesIndex++] = strip[j];
                                    indices[indicesIndex++] = strip[j + 2];
                                    indices[indicesIndex++] = strip[j + 1];
                                } else {
                                    indices[indicesIndex++] = strip[j];
                                    indices[indicesIndex++] = strip[j + 1];
                                    indices[indicesIndex++] = strip[j + 2];
                                }
                            }
                        }
                        state.next = state.next + count + 1;
                    } else if (line.indexOf('POLYGONS') === 0) {
                        var numberOfStrips = parseInt(line.split(' ')[1], 10);
                        var size = parseInt(line.split(' ')[2], 10);
                        count = size * 4;
                        indices = new Uint32Array(3 * size - 9 * numberOfStrips);
                        var indicesIndex = 0;
                        pointIndex = state.next;
                        for (i = 0; i < numberOfStrips; i++) {
                            var indexCount = dataView.getInt32(pointIndex, false);
                            var strip = [];
                            pointIndex += 4;
                            for (s = 0; s < indexCount; s++) {
                                strip.push(dataView.getInt32(pointIndex, false));
                                pointIndex += 4;
                            }
                            for (var j = 1; j < indexCount - 1; j++) {
                                indices[indicesIndex++] = strip[0];
                                indices[indicesIndex++] = strip[j];
                                indices[indicesIndex++] = strip[j + 1];
                            }
                        }
                        state.next = state.next + count + 1;
                    } else if (line.indexOf('POINT_DATA') === 0) {
                        numberOfPoints = parseInt(line.split(' ')[1], 10);
                        state = findString(buffer, state.next);
                        count = numberOfPoints * 4 * 3;
                        normals = new Float32Array(numberOfPoints * 3);
                        pointIndex = state.next;
                        for (i = 0; i < numberOfPoints; i++) {
                            normals[3 * i] = dataView.getFloat32(pointIndex, false);
                            normals[3 * i + 1] = dataView.getFloat32(pointIndex + 4, false);
                            normals[3 * i + 2] = dataView.getFloat32(pointIndex + 8, false);
                            pointIndex += 12;
                        }
                        state.next = state.next + count;
                    }
                    index = state.next;
                    if (index >= buffer.byteLength) {
                        break;
                    }
                }
                var geometry = new THREE.BufferGeometry();
                geometry.setIndex(new THREE.BufferAttribute(indices, 1));
                geometry.setAttribute('position', new THREE.BufferAttribute(points, 3));
                if (normals.length === points.length) {
                    geometry.setAttribute('normal', new THREE.BufferAttribute(normals, 3));
                }
                return geometry;
            }
            function Float32Concat(first, second) {
                var firstLength = first.length, result = new Float32Array(firstLength + second.length);
                result.set(first);
                result.set(second, firstLength);
                return result;
            }
            function Int32Concat(first, second) {
                var firstLength = first.length, result = new Int32Array(firstLength + second.length);
                result.set(first);
                result.set(second, firstLength);
                return result;
            }
            function parseXML(stringFile) {
                function xmlToJson(xml) {
                    var obj = {};
                    if (xml.nodeType === 1) {
                        if (xml.attributes) {
                            if (xml.attributes.length > 0) {
                                obj['attributes'] = {};
                                for (var j = 0; j < xml.attributes.length; j++) {
                                    var attribute = xml.attributes.item(j);
                                    obj['attributes'][attribute.nodeName] = attribute.nodeValue.trim();
                                }
                            }
                        }
                    } else if (xml.nodeType === 3) {
                        obj = xml.nodeValue.trim();
                    }
                    if (xml.hasChildNodes()) {
                        for (var i = 0; i < xml.childNodes.length; i++) {
                            var item = xml.childNodes.item(i);
                            var nodeName = item.nodeName;
                            if (typeof obj[nodeName] === 'undefined') {
                                var tmp = xmlToJson(item);
                                if (tmp !== '')
                                    obj[nodeName] = tmp;
                            } else {
                                if (typeof obj[nodeName].push === 'undefined') {
                                    var old = obj[nodeName];
                                    obj[nodeName] = [old];
                                }
                                var tmp = xmlToJson(item);
                                if (tmp !== '')
                                    obj[nodeName].push(tmp);
                            }
                        }
                    }
                    return obj;
                }
                function Base64toByteArray(b64) {
                    var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array;
                    var i;
                    var lookup = [];
                    var revLookup = [];
                    var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
                    var len = code.length;
                    for (i = 0; i < len; i++) {
                        lookup[i] = code[i];
                    }
                    for (i = 0; i < len; ++i) {
                        revLookup[code.charCodeAt(i)] = i;
                    }
                    revLookup['-'.charCodeAt(0)] = 62;
                    revLookup['_'.charCodeAt(0)] = 63;
                    var j, l, tmp, placeHolders, arr;
                    var len = b64.length;
                    if (len % 4 > 0) {
                        throw new Error('Invalid string. Length must be a multiple of 4');
                    }
                    placeHolders = b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0;
                    arr = new Arr(len * 3 / 4 - placeHolders);
                    l = placeHolders > 0 ? len - 4 : len;
                    var L = 0;
                    for (i = 0, j = 0; i < l; i += 4, j += 3) {
                        tmp = revLookup[b64.charCodeAt(i)] << 18 | revLookup[b64.charCodeAt(i + 1)] << 12 | revLookup[b64.charCodeAt(i + 2)] << 6 | revLookup[b64.charCodeAt(i + 3)];
                        arr[L++] = (tmp & 16711680) >> 16;
                        arr[L++] = (tmp & 65280) >> 8;
                        arr[L++] = tmp & 255;
                    }
                    if (placeHolders === 2) {
                        tmp = revLookup[b64.charCodeAt(i)] << 2 | revLookup[b64.charCodeAt(i + 1)] >> 4;
                        arr[L++] = tmp & 255;
                    } else if (placeHolders === 1) {
                        tmp = revLookup[b64.charCodeAt(i)] << 10 | revLookup[b64.charCodeAt(i + 1)] << 4 | revLookup[b64.charCodeAt(i + 2)] >> 2;
                        arr[L++] = tmp >> 8 & 255;
                        arr[L++] = tmp & 255;
                    }
                    return arr;
                }
                function parseDataArray(ele, compressed) {
                    var numBytes = 0;
                    if (json.attributes.header_type === 'UInt64') {
                        numBytes = 8;
                    } else if (json.attributes.header_type === 'UInt32') {
                        numBytes = 4;
                    }
                    if (ele.attributes.format === 'binary' && compressed) {
                        var rawData, content, byteData, blocks, cSizeStart, headerSize, padding, dataOffsets, currentOffset;
                        if (ele.attributes.type === 'Float32') {
                            var txt = new Float32Array();
                        } else if (ele.attributes.type === 'Int64') {
                            var txt = new Int32Array();
                        }
                        rawData = ele['#text'];
                        byteData = Base64toByteArray(rawData);
                        blocks = byteData[0];
                        for (var i = 1; i < numBytes - 1; i++) {
                            blocks = blocks | byteData[i] << i * numBytes;
                        }
                        headerSize = (blocks + 3) * numBytes;
                        padding = headerSize % 3 > 0 ? 3 - headerSize % 3 : 0;
                        headerSize = headerSize + padding;
                        dataOffsets = [];
                        currentOffset = headerSize;
                        dataOffsets.push(currentOffset);
                        cSizeStart = 3 * numBytes;
                        for (var i = 0; i < blocks; i++) {
                            var currentBlockSize = byteData[i * numBytes + cSizeStart];
                            for (var j = 1; j < numBytes - 1; j++) {
                                currentBlockSize = currentBlockSize | byteData[i * numBytes + cSizeStart + j] << j * 8;
                            }
                            currentOffset = currentOffset + currentBlockSize;
                            dataOffsets.push(currentOffset);
                        }
                        for (var i = 0; i < dataOffsets.length - 1; i++) {
                            var inflate = new Inflate(byteData.slice(dataOffsets[i], dataOffsets[i + 1]), {
                                resize: true,
                                verify: true
                            });
                            content = inflate.decompress();
                            content = content.buffer;
                            if (ele.attributes.type === 'Float32') {
                                content = new Float32Array(content);
                                txt = Float32Concat(txt, content);
                            } else if (ele.attributes.type === 'Int64') {
                                content = new Int32Array(content);
                                txt = Int32Concat(txt, content);
                            }
                        }
                        delete ele['#text'];
                        if (ele.attributes.type === 'Int64') {
                            if (ele.attributes.format === 'binary') {
                                txt = txt.filter(function (el, idx) {
                                    if (idx % 2 !== 1)
                                        return true;
                                });
                            }
                        }
                    } else {
                        if (ele.attributes.format === 'binary' && !compressed) {
                            var content = Base64toByteArray(ele['#text']);
                            content = content.slice(numBytes).buffer;
                        } else {
                            if (ele['#text']) {
                                var content = ele['#text'].split(/\s+/).filter(function (el) {
                                    if (el !== '')
                                        return el;
                                });
                            } else {
                                var content = new Int32Array(0).buffer;
                            }
                        }
                        delete ele['#text'];
                        if (ele.attributes.type === 'Float32') {
                            var txt = new Float32Array(content);
                        } else if (ele.attributes.type === 'Int32') {
                            var txt = new Int32Array(content);
                        } else if (ele.attributes.type === 'Int64') {
                            var txt = new Int32Array(content);
                            if (ele.attributes.format === 'binary') {
                                txt = txt.filter(function (el, idx) {
                                    if (idx % 2 !== 1)
                                        return true;
                                });
                            }
                        }
                    }
                    return txt;
                }
                var dom = null;
                if (window.DOMParser) {
                    try {
                        dom = new DOMParser().parseFromString(stringFile, 'text/xml');
                    } catch (e) {
                        dom = null;
                    }
                } else if (window.ActiveXObject) {
                    try {
                        dom = new ActiveXObject('Microsoft.XMLDOM');
                        dom.async = false;
                        if (!dom.loadXML()) {
                            throw new Error(dom.parseError.reason + dom.parseError.srcText);
                        }
                    } catch (e) {
                        dom = null;
                    }
                } else {
                    throw new Error('Cannot parse xml string!');
                }
                var doc = dom.documentElement;
                var json = xmlToJson(doc);
                var points = [];
                var normals = [];
                var indices = [];
                if (json.PolyData) {
                    var piece = json.PolyData.Piece;
                    var compressed = json.attributes.hasOwnProperty('compressor');
                    var sections = [
                        'PointData',
                        'Points',
                        'Strips',
                        'Polys'
                    ];
                    var sectionIndex = 0, numberOfSections = sections.length;
                    while (sectionIndex < numberOfSections) {
                        var section = piece[sections[sectionIndex]];
                        if (section && section.DataArray) {
                            if (Object.prototype.toString.call(section.DataArray) === '[object Array]') {
                                var arr = section.DataArray;
                            } else {
                                var arr = [section.DataArray];
                            }
                            var dataArrayIndex = 0, numberOfDataArrays = arr.length;
                            while (dataArrayIndex < numberOfDataArrays) {
                                if ('#text' in arr[dataArrayIndex] && arr[dataArrayIndex]['#text'].length > 0) {
                                    arr[dataArrayIndex].text = parseDataArray(arr[dataArrayIndex], compressed);
                                }
                                dataArrayIndex++;
                            }
                            switch (sections[sectionIndex]) {
                            case 'PointData':
                                var numberOfPoints = parseInt(piece.attributes.NumberOfPoints);
                                var normalsName = section.attributes.Normals;
                                if (numberOfPoints > 0) {
                                    for (var i = 0, len = arr.length; i < len; i++) {
                                        if (normalsName === arr[i].attributes.Name) {
                                            var components = arr[i].attributes.NumberOfComponents;
                                            normals = new Float32Array(numberOfPoints * components);
                                            normals.set(arr[i].text, 0);
                                        }
                                    }
                                }
                                break;
                            case 'Points':
                                var numberOfPoints = parseInt(piece.attributes.NumberOfPoints);
                                if (numberOfPoints > 0) {
                                    var components = section.DataArray.attributes.NumberOfComponents;
                                    points = new Float32Array(numberOfPoints * components);
                                    points.set(section.DataArray.text, 0);
                                }
                                break;
                            case 'Strips':
                                var numberOfStrips = parseInt(piece.attributes.NumberOfStrips);
                                if (numberOfStrips > 0) {
                                    var connectivity = new Int32Array(section.DataArray[0].text.length);
                                    var offset = new Int32Array(section.DataArray[1].text.length);
                                    connectivity.set(section.DataArray[0].text, 0);
                                    offset.set(section.DataArray[1].text, 0);
                                    var size = numberOfStrips + connectivity.length;
                                    indices = new Uint32Array(3 * size - 9 * numberOfStrips);
                                    var indicesIndex = 0;
                                    for (var i = 0, len = numberOfStrips; i < len; i++) {
                                        var strip = [];
                                        for (var s = 0, len1 = offset[i], len0 = 0; s < len1 - len0; s++) {
                                            strip.push(connectivity[s]);
                                            if (i > 0)
                                                len0 = offset[i - 1];
                                        }
                                        for (var j = 0, len1 = offset[i], len0 = 0; j < len1 - len0 - 2; j++) {
                                            if (j % 2) {
                                                indices[indicesIndex++] = strip[j];
                                                indices[indicesIndex++] = strip[j + 2];
                                                indices[indicesIndex++] = strip[j + 1];
                                            } else {
                                                indices[indicesIndex++] = strip[j];
                                                indices[indicesIndex++] = strip[j + 1];
                                                indices[indicesIndex++] = strip[j + 2];
                                            }
                                            if (i > 0)
                                                len0 = offset[i - 1];
                                        }
                                    }
                                }
                                break;
                            case 'Polys':
                                var numberOfPolys = parseInt(piece.attributes.NumberOfPolys);
                                if (numberOfPolys > 0) {
                                    var connectivity = new Int32Array(section.DataArray[0].text.length);
                                    var offset = new Int32Array(section.DataArray[1].text.length);
                                    connectivity.set(section.DataArray[0].text, 0);
                                    offset.set(section.DataArray[1].text, 0);
                                    var size = numberOfPolys + connectivity.length;
                                    indices = new Uint32Array(3 * size - 9 * numberOfPolys);
                                    var indicesIndex = 0, connectivityIndex = 0;
                                    var i = 0, len = numberOfPolys, len0 = 0;
                                    while (i < len) {
                                        var poly = [];
                                        var s = 0, len1 = offset[i];
                                        while (s < len1 - len0) {
                                            poly.push(connectivity[connectivityIndex++]);
                                            s++;
                                        }
                                        var j = 1;
                                        while (j < len1 - len0 - 1) {
                                            indices[indicesIndex++] = poly[0];
                                            indices[indicesIndex++] = poly[j];
                                            indices[indicesIndex++] = poly[j + 1];
                                            j++;
                                        }
                                        i++;
                                        len0 = offset[i - 1];
                                    }
                                }
                                break;
                            default:
                                break;
                            }
                        }
                        sectionIndex++;
                    }
                    var geometry = new THREE.BufferGeometry();
                    geometry.setIndex(new THREE.BufferAttribute(indices, 1));
                    geometry.setAttribute('position', new THREE.BufferAttribute(points, 3));
                    if (normals.length === points.length) {
                        geometry.setAttribute('normal', new THREE.BufferAttribute(normals, 3));
                    }
                    return geometry;
                } else {
                    throw new Error('Unsupported DATASET type');
                }
            }
            function getStringFile(data) {
                var stringFile = '';
                var charArray = new Uint8Array(data);
                var i = 0;
                var len = charArray.length;
                while (len--) {
                    stringFile += String.fromCharCode(charArray[i++]);
                }
                return stringFile;
            }
            var meta = THREE.LoaderUtils.decodeText(new Uint8Array(data, 0, 250)).split('\n');
            if (meta[0].indexOf('xml') !== -1) {
                return parseXML(getStringFile(data));
            } else if (meta[2].includes('ASCII')) {
                return parseASCII(getStringFile(data));
            } else {
                return parseBinary(data);
            }
        }
    });

    return threex.loaders.VTKLoader = VTKLoader;
});
define('skylark-threejs-ex/loaders/XLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var XLoader = function () {
        var classCallCheck = function (instance, Constructor) {
            if (!(instance instanceof Constructor)) {
                throw new TypeError('Cannot call a class as a function');
            }
        };
        var createClass = function () {
            function defineProperties(target, props) {
                for (var i = 0; i < props.length; i++) {
                    var descriptor = props[i];
                    descriptor.enumerable = descriptor.enumerable || false;
                    descriptor.configurable = true;
                    if ('value' in descriptor)
                        descriptor.writable = true;
                    Object.defineProperty(target, descriptor.key, descriptor);
                }
            }
            return function (Constructor, protoProps, staticProps) {
                if (protoProps)
                    defineProperties(Constructor.prototype, protoProps);
                if (staticProps)
                    defineProperties(Constructor, staticProps);
                return Constructor;
            };
        }();
        var XboneInf = function XboneInf() {
            classCallCheck(this, XboneInf);
            this.boneName = '';
            this.BoneIndex = 0;
            this.Indeces = [];
            this.Weights = [];
            this.initMatrix = null;
            this.OffsetMatrix = null;
        };
        var XAnimationInfo = function XAnimationInfo() {
            classCallCheck(this, XAnimationInfo);
            this.animeName = '';
            this.boneName = '';
            this.targetBone = null;
            this.keyType = 4;
            this.frameStartLv = 0;
            this.keyFrames = [];
            this.InverseMx = null;
        };
        var XAnimationObj = function () {
            function XAnimationObj(_flags) {
                classCallCheck(this, XAnimationObj);
                this.fps = 30;
                this.name = 'xanimation';
                this.length = 0;
                this.hierarchy = [];
                this.putFlags = _flags;
                if (this.putFlags.putPos === undefined) {
                    this.putFlags.putPos = true;
                }
                if (this.putFlags.putRot === undefined) {
                    this.putFlags.putRot = true;
                }
                if (this.putFlags.putScl === undefined) {
                    this.putFlags.putScl = true;
                }
            }
            createClass(XAnimationObj, [
                {
                    key: 'make',
                    value: function make(XAnimationInfoArray) {
                        for (var i = 0; i < XAnimationInfoArray.length; i++) {
                            this.hierarchy.push(this.makeBonekeys(XAnimationInfoArray[i]));
                        }
                        this.length = this.hierarchy[0].keys[this.hierarchy[0].keys.length - 1].time;
                    }
                },
                {
                    key: 'clone',
                    value: function clone() {
                        return Object.assign({}, this);
                    }
                },
                {
                    key: 'makeBonekeys',
                    value: function makeBonekeys(XAnimationInfo) {
                        var refObj = {};
                        refObj.name = XAnimationInfo.boneName;
                        refObj.parent = '';
                        refObj.keys = this.keyFrameRefactor(XAnimationInfo);
                        refObj.copy = function () {
                            return Object.assign({}, this);
                        };
                        return refObj;
                    }
                },
                {
                    key: 'keyFrameRefactor',
                    value: function keyFrameRefactor(XAnimationInfo) {
                        var keys = [];
                        for (var i = 0; i < XAnimationInfo.keyFrames.length; i++) {
                            var keyframe = {};
                            keyframe.time = XAnimationInfo.keyFrames[i].time * this.fps;
                            if (XAnimationInfo.keyFrames[i].pos && this.putFlags.putPos) {
                                keyframe.pos = XAnimationInfo.keyFrames[i].pos;
                            }
                            if (XAnimationInfo.keyFrames[i].rot && this.putFlags.putRot) {
                                keyframe.rot = XAnimationInfo.keyFrames[i].rot;
                            }
                            if (XAnimationInfo.keyFrames[i].scl && this.putFlags.putScl) {
                                keyframe.scl = XAnimationInfo.keyFrames[i].scl;
                            }
                            if (XAnimationInfo.keyFrames[i].matrix) {
                                keyframe.matrix = XAnimationInfo.keyFrames[i].matrix;
                                if (this.putFlags.putPos) {
                                    keyframe.pos = new THREE.Vector3().setFromMatrixPosition(keyframe.matrix);
                                }
                                if (this.putFlags.putRot) {
                                    keyframe.rot = new THREE.Quaternion().setFromRotationMatrix(keyframe.matrix);
                                }
                                if (this.putFlags.putScl) {
                                    keyframe.scl = new THREE.Vector3().setFromMatrixScale(keyframe.matrix);
                                }
                            }
                            keys.push(keyframe);
                        }
                        return keys;
                    }
                }
            ]);
            return XAnimationObj;
        }();
        var XKeyFrameInfo = function XKeyFrameInfo() {
            classCallCheck(this, XKeyFrameInfo);
            this.index = 0;
            this.Frame = 0;
            this.time = 0;
            this.matrix = null;
        };
        var XLoader = function () {
            function XLoader(manager) {
                THREE.Loader.call(this, manager);
                classCallCheck(this, XLoader);
                this.debug = false;
                this.texloader = new THREE.TextureLoader(this.manager);
                this.url = '';
                this._putMatLength = 0;
                this._nowMat = null;
                this._nowFrameName = '';
                this.frameHierarchie = [];
                this.Hierarchies = {};
                this.HieStack = [];
                this._currentObject = {};
                this._currentFrame = {};
                this._data = null;
                this.onLoad = null;
                this.IsUvYReverse = true;
                this.Meshes = [];
                this.animations = [];
                this.animTicksPerSecond = 30;
                this._currentGeo = null;
                this._currentAnime = null;
                this._currentAnimeFrames = null;
            }
            createClass(XLoader, [
                {
                    key: '_setArgOption',
                    value: function _setArgOption(_arg) {
                        var _start = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
                        if (!_arg) {
                            return;
                        }
                        for (var i = _start; i < _arg.length; i++) {
                            switch (i) {
                            case 0:
                                this.url = _arg[i];
                                break;
                            case 1:
                                this.options = _arg[i];
                                break;
                            }
                        }
                        if (this.options === undefined) {
                            this.options = {};
                        }
                    }
                },
                {
                    key: 'load',
                    value: function load(_arg, onLoad, onProgress, onError) {
                        var _this = this;
                        this._setArgOption(_arg);
                        var loader = new THREE.FileLoader(this.manager);
                        loader.setPath(this.path);
                        loader.setResponseType('arraybuffer');
                        loader.load(this.url, function (response) {
                            _this.parse(response, onLoad);
                        }, onProgress, onError);
                    }
                },
                {
                    key: '_readLine',
                    value: function _readLine(line) {
                        var readed = 0;
                        while (true) {
                            var find = -1;
                            find = line.indexOf('//', readed);
                            if (find === -1) {
                                find = line.indexOf('#', readed);
                            }
                            if (find > -1 && find < 2) {
                                var foundNewLine = -1;
                                foundNewLine = line.indexOf('\r\n', readed);
                                if (foundNewLine > 0) {
                                    readed = foundNewLine + 2;
                                } else {
                                    foundNewLine = line.indexOf('\r', readed);
                                    if (foundNewLine > 0) {
                                        readed = foundNewLine + 1;
                                    } else {
                                        readed = line.indexOf('\n', readed) + 1;
                                    }
                                }
                            } else {
                                break;
                            }
                        }
                        return line.substr(readed);
                    }
                },
                {
                    key: '_readLine',
                    value: function _readLine(line) {
                        var readed = 0;
                        while (true) {
                            var find = -1;
                            find = line.indexOf('//', readed);
                            if (find === -1) {
                                find = line.indexOf('#', readed);
                            }
                            if (find > -1 && find < 2) {
                                var foundNewLine = -1;
                                foundNewLine = line.indexOf('\r\n', readed);
                                if (foundNewLine > 0) {
                                    readed = foundNewLine + 2;
                                } else {
                                    foundNewLine = line.indexOf('\r', readed);
                                    if (foundNewLine > 0) {
                                        readed = foundNewLine + 1;
                                    } else {
                                        readed = line.indexOf('\n', readed) + 1;
                                    }
                                }
                            } else {
                                break;
                            }
                        }
                        return line.substr(readed);
                    }
                },
                {
                    key: '_isBinary',
                    value: function _isBinary(binData) {
                        var reader = new DataView(binData);
                        var face_size = 32 / 8 * 3 + 32 / 8 * 3 * 3 + 16 / 8;
                        var n_faces = reader.getUint32(80, true);
                        var expect = 80 + 32 / 8 + n_faces * face_size;
                        if (expect === reader.byteLength) {
                            return true;
                        }
                        var fileLength = reader.byteLength;
                        for (var index = 0; index < fileLength; index++) {
                            if (reader.getUint8(index, false) > 127) {
                                return true;
                            }
                        }
                        return false;
                    }
                },
                {
                    key: '_ensureBinary',
                    value: function _ensureBinary(buf) {
                        if (typeof buf === 'string') {
                            var array_buffer = new Uint8Array(buf.length);
                            for (var i = 0; i < buf.length; i++) {
                                array_buffer[i] = buf.charCodeAt(i) & 255;
                            }
                            return array_buffer.buffer || array_buffer;
                        } else {
                            return buf;
                        }
                    }
                },
                {
                    key: '_ensureString',
                    value: function _ensureString(buf) {
                        if (typeof buf !== 'string') {
                            return THREE.LoaderUtils.decodeText(new Uint8Array(buf));
                        } else {
                            return buf;
                        }
                    }
                },
                {
                    key: 'parse',
                    value: function _parse(data, onLoad) {
                        var binData = this._ensureBinary(data);
                        this._data = this._ensureString(data);
                        this.onLoad = onLoad;
                        return this._isBinary(binData) ? this._parseBinary(binData) : this._parseASCII();
                    }
                },
                {
                    key: '_parseBinary',
                    value: function _parseBinary(data) {
                        return this._parseASCII(THREE.LoaderUtils.decodeText(new Uint8Array(data)));
                    }
                },
                {
                    key: '_parseASCII',
                    value: function _parseASCII() {
                        var path;
                        if (this.resourcePath !== '') {
                            path = this.resourcePath;
                        } else if (this.path !== '') {
                            path = this.path;
                        } else {
                            path = THREE.LoaderUtils.extractUrlBase(this.url);
                        }
                        this.texloader.setPath(path).setCrossOrigin(this.crossOrigin);
                        var endRead = 16;
                        this.Hierarchies.children = [];
                        this._hierarchieParse(this.Hierarchies, endRead);
                        this._changeRoot();
                        this._currentObject = this.Hierarchies.children.shift();
                        this._mainloop();
                    }
                },
                {
                    key: '_hierarchieParse',
                    value: function _hierarchieParse(_parent, _end) {
                        var endRead = _end;
                        while (true) {
                            var find1 = this._data.indexOf('{', endRead) + 1;
                            var findEnd = this._data.indexOf('}', endRead);
                            var findNext = this._data.indexOf('{', find1) + 1;
                            if (find1 > 0 && findEnd > find1) {
                                var _currentObject = {};
                                _currentObject.children = [];
                                var nameData = this._readLine(this._data.substr(endRead, find1 - endRead - 1)).trim();
                                var word = nameData.split(/ /g);
                                if (word.length > 0) {
                                    _currentObject.type = word[0];
                                    if (word.length >= 2) {
                                        _currentObject.name = word[1];
                                    } else {
                                        _currentObject.name = word[0] + this.Hierarchies.children.length;
                                    }
                                } else {
                                    _currentObject.name = nameData;
                                    _currentObject.type = '';
                                }
                                if (_currentObject.type === 'Animation') {
                                    _currentObject.data = this._data.substr(findNext, findEnd - findNext).trim();
                                    var refs = this._hierarchieParse(_currentObject, findEnd + 1);
                                    endRead = refs.end;
                                    _currentObject.children = refs.parent.children;
                                } else {
                                    var DataEnder = this._data.lastIndexOf(';', findNext > 0 ? Math.min(findNext, findEnd) : findEnd);
                                    _currentObject.data = this._data.substr(find1, DataEnder - find1).trim();
                                    if (findNext <= 0 || findEnd < findNext) {
                                        endRead = findEnd + 1;
                                    } else {
                                        var nextStart = Math.max(DataEnder + 1, find1);
                                        var _refs = this._hierarchieParse(_currentObject, nextStart);
                                        endRead = _refs.end;
                                        _currentObject.children = _refs.parent.children;
                                    }
                                }
                                _currentObject.parent = _parent;
                                if (_currentObject.type != 'template') {
                                    _parent.children.push(_currentObject);
                                }
                            } else {
                                endRead = find1 === -1 ? this._data.length : findEnd + 1;
                                break;
                            }
                        }
                        return {
                            parent: _parent,
                            end: endRead
                        };
                    }
                },
                {
                    key: '_mainloop',
                    value: function _mainloop() {
                        var _this2 = this;
                        this._mainProc();
                        if (this._currentObject.parent || this._currentObject.children.length > 0 || !this._currentObject.worked) {
                            setTimeout(function () {
                                _this2._mainloop();
                            }, 1);
                        } else {
                            setTimeout(function () {
                                _this2.onLoad({
                                    models: _this2.Meshes,
                                    animations: _this2.animations
                                });
                            }, 1);
                        }
                    }
                },
                {
                    key: '_mainProc',
                    value: function _mainProc() {
                        var breakFlag = false;
                        while (true) {
                            if (!this._currentObject.worked) {
                                switch (this._currentObject.type) {
                                case 'template':
                                    break;
                                case 'AnimTicksPerSecond':
                                    this.animTicksPerSecond = parseInt(this._currentObject.data);
                                    break;
                                case 'Frame':
                                    this._setFrame();
                                    break;
                                case 'FrameTransformMatrix':
                                    this._setFrameTransformMatrix();
                                    break;
                                case 'Mesh':
                                    this._changeRoot();
                                    this._currentGeo = {};
                                    this._currentGeo.name = this._currentObject.name.trim();
                                    this._currentGeo.parentName = this._getParentName(this._currentObject).trim();
                                    this._currentGeo.VertexSetedBoneCount = [];
                                    this._currentGeo.GeometryData = {
                                        vertices: [],
                                        normals: [],
                                        uvs: [],
                                        skinIndices: [],
                                        skinWeights: [],
                                        indices: [],
                                        materialIndices: []
                                    };
                                    this._currentGeo.Materials = [];
                                    this._currentGeo.normalVectors = [];
                                    this._currentGeo.BoneInfs = [];
                                    this._currentGeo.baseFrame = this._currentFrame;
                                    this._makeBoneFrom_CurrentFrame();
                                    this._readVertexDatas();
                                    breakFlag = true;
                                    break;
                                case 'MeshNormals':
                                    this._readVertexDatas();
                                    break;
                                case 'MeshTextureCoords':
                                    this._setMeshTextureCoords();
                                    break;
                                case 'VertexDuplicationIndices':
                                    break;
                                case 'MeshMaterialList':
                                    this._setMeshMaterialList();
                                    break;
                                case 'Material':
                                    this._setMaterial();
                                    break;
                                case 'SkinWeights':
                                    this._setSkinWeights();
                                    break;
                                case 'AnimationSet':
                                    this._changeRoot();
                                    this._currentAnime = {};
                                    this._currentAnime.name = this._currentObject.name.trim();
                                    this._currentAnime.AnimeFrames = [];
                                    break;
                                case 'Animation':
                                    if (this._currentAnimeFrames) {
                                        this._currentAnime.AnimeFrames.push(this._currentAnimeFrames);
                                    }
                                    this._currentAnimeFrames = new XAnimationInfo();
                                    this._currentAnimeFrames.boneName = this._currentObject.data.trim();
                                    break;
                                case 'AnimationKey':
                                    this._readAnimationKey();
                                    breakFlag = true;
                                    break;
                                }
                                this._currentObject.worked = true;
                            }
                            if (this._currentObject.children.length > 0) {
                                this._currentObject = this._currentObject.children.shift();
                                if (this.debug) {
                                    console.log('processing ' + this._currentObject.name);
                                }
                                if (breakFlag)
                                    break;
                            } else {
                                if (this._currentObject.worked) {
                                    if (this._currentObject.parent && !this._currentObject.parent.parent) {
                                        this._changeRoot();
                                    }
                                }
                                if (this._currentObject.parent) {
                                    this._currentObject = this._currentObject.parent;
                                } else {
                                    breakFlag = true;
                                }
                                if (breakFlag)
                                    break;
                            }
                        }
                        return;
                    }
                },
                {
                    key: '_changeRoot',
                    value: function _changeRoot() {
                        if (this._currentGeo != null && this._currentGeo.name) {
                            this._makeOutputGeometry();
                        }
                        this._currentGeo = {};
                        if (this._currentAnime != null && this._currentAnime.name) {
                            if (this._currentAnimeFrames) {
                                this._currentAnime.AnimeFrames.push(this._currentAnimeFrames);
                                this._currentAnimeFrames = null;
                            }
                            this._makeOutputAnimation();
                        }
                        this._currentAnime = {};
                    }
                },
                {
                    key: '_getParentName',
                    value: function _getParentName(_obj) {
                        if (_obj.parent) {
                            if (_obj.parent.name) {
                                return _obj.parent.name;
                            } else {
                                return this._getParentName(_obj.parent);
                            }
                        } else {
                            return '';
                        }
                    }
                },
                {
                    key: '_setFrame',
                    value: function _setFrame() {
                        this._nowFrameName = this._currentObject.name.trim();
                        this._currentFrame = {};
                        this._currentFrame.name = this._nowFrameName;
                        this._currentFrame.children = [];
                        if (this._currentObject.parent && this._currentObject.parent.name) {
                            this._currentFrame.parentName = this._currentObject.parent.name;
                        }
                        this.frameHierarchie.push(this._nowFrameName);
                        this.HieStack[this._nowFrameName] = this._currentFrame;
                    }
                },
                {
                    key: '_setFrameTransformMatrix',
                    value: function _setFrameTransformMatrix() {
                        this._currentFrame.FrameTransformMatrix = new THREE.Matrix4();
                        var data = this._currentObject.data.split(',');
                        this._ParseMatrixData(this._currentFrame.FrameTransformMatrix, data);
                        this._makeBoneFrom_CurrentFrame();
                    }
                },
                {
                    key: '_makeBoneFrom_CurrentFrame',
                    value: function _makeBoneFrom_CurrentFrame() {
                        if (!this._currentFrame.FrameTransformMatrix) {
                            return;
                        }
                        var b = new THREE.Bone();
                        b.name = this._currentFrame.name;
                        b.applyMatrix4(this._currentFrame.FrameTransformMatrix);
                        b.matrixWorld = b.matrix;
                        b.FrameTransformMatrix = this._currentFrame.FrameTransformMatrix;
                        this._currentFrame.putBone = b;
                        if (this._currentFrame.parentName) {
                            for (var frame in this.HieStack) {
                                if (this.HieStack[frame].name === this._currentFrame.parentName) {
                                    this.HieStack[frame].putBone.add(this._currentFrame.putBone);
                                }
                            }
                        }
                    }
                },
                {
                    key: '_readVertexDatas',
                    value: function _readVertexDatas() {
                        var endRead = 0;
                        var mode = 0;
                        var mode_local = 0;
                        var maxLength = 0;
                        while (true) {
                            var changeMode = false;
                            if (mode_local === 0) {
                                var refO = this._readInt1(endRead);
                                endRead = refO.endRead;
                                mode_local = 1;
                                maxLength = this._currentObject.data.indexOf(';;', endRead) + 1;
                                if (maxLength <= 0) {
                                    maxLength = this._currentObject.data.length;
                                }
                            } else {
                                var find = 0;
                                switch (mode) {
                                case 0:
                                    find = this._currentObject.data.indexOf(',', endRead) + 1;
                                    break;
                                case 1:
                                    find = this._currentObject.data.indexOf(';,', endRead) + 1;
                                    break;
                                }
                                if (find === 0 || find > maxLength) {
                                    find = maxLength;
                                    mode_local = 0;
                                    changeMode = true;
                                }
                                switch (this._currentObject.type) {
                                case 'Mesh':
                                    switch (mode) {
                                    case 0:
                                        this._readVertex1(this._currentObject.data.substr(endRead, find - endRead));
                                        break;
                                    case 1:
                                        this._readFace1(this._currentObject.data.substr(endRead, find - endRead));
                                        break;
                                    }
                                    break;
                                case 'MeshNormals':
                                    switch (mode) {
                                    case 0:
                                        this._readNormalVector1(this._currentObject.data.substr(endRead, find - endRead));
                                        break;
                                    }
                                    break;
                                }
                                endRead = find + 1;
                                if (changeMode) {
                                    mode++;
                                }
                            }
                            if (endRead >= this._currentObject.data.length) {
                                break;
                            }
                        }
                    }
                },
                {
                    key: '_readInt1',
                    value: function _readInt1(start) {
                        var find = this._currentObject.data.indexOf(';', start);
                        return {
                            refI: parseInt(this._currentObject.data.substr(start, find - start)),
                            endRead: find + 1
                        };
                    }
                },
                {
                    key: '_readVertex1',
                    value: function _readVertex1(line) {
                        var data = this._readLine(line.trim()).substr(0, line.length - 2).split(';');
                        this._currentGeo.GeometryData.vertices.push(parseFloat(data[0]), parseFloat(data[1]), parseFloat(data[2]));
                        this._currentGeo.GeometryData.skinIndices.push(0, 0, 0, 0);
                        this._currentGeo.GeometryData.skinWeights.push(1, 0, 0, 0);
                        this._currentGeo.VertexSetedBoneCount.push(0);
                    }
                },
                {
                    key: '_readFace1',
                    value: function _readFace1(line) {
                        var data = this._readLine(line.trim()).substr(2, line.length - 4).split(',');
                        this._currentGeo.GeometryData.indices.push(parseInt(data[0], 10), parseInt(data[1], 10), parseInt(data[2], 10));
                    }
                },
                {
                    key: '_readNormalVector1',
                    value: function _readNormalVector1(line) {
                        var data = this._readLine(line.trim()).substr(0, line.length - 2).split(';');
                        this._currentGeo.GeometryData.normals.push(parseFloat(data[0]), parseFloat(data[1]), parseFloat(data[2]));
                    }
                },
                {
                    key: '_buildGeometry',
                    value: function _buildGeometry() {
                        var bufferGeometry = new THREE.BufferGeometry();
                        var position = [];
                        var normals = [];
                        var uvs = [];
                        var skinIndices = [];
                        var skinWeights = [];
                        var data = this._currentGeo.GeometryData;
                        for (var i = 0, l = data.indices.length; i < l; i++) {
                            var stride2 = data.indices[i] * 2;
                            var stride3 = data.indices[i] * 3;
                            var stride4 = data.indices[i] * 4;
                            position.push(data.vertices[stride3], data.vertices[stride3 + 1], data.vertices[stride3 + 2]);
                            normals.push(data.normals[stride3], data.normals[stride3 + 1], data.normals[stride3 + 2]);
                            skinIndices.push(data.skinIndices[stride4], data.skinIndices[stride4 + 1], data.skinIndices[stride4 + 2], data.skinIndices[stride4 + 3]);
                            skinWeights.push(data.skinWeights[stride4], data.skinWeights[stride4 + 1], data.skinWeights[stride4 + 2], data.skinWeights[stride4 + 3]);
                            uvs.push(data.uvs[stride2], data.uvs[stride2 + 1]);
                        }
                        bufferGeometry.setAttribute('position', new THREE.Float32BufferAttribute(position, 3));
                        bufferGeometry.setAttribute('normal', new THREE.Float32BufferAttribute(normals, 3));
                        bufferGeometry.setAttribute('uv', new THREE.Float32BufferAttribute(uvs, 2));
                        bufferGeometry.setAttribute('skinIndex', new THREE.Uint16BufferAttribute(skinIndices, 4));
                        bufferGeometry.setAttribute('skinWeight', new THREE.Float32BufferAttribute(skinWeights, 4));
                        this._computeGroups(bufferGeometry, data.materialIndices);
                        return bufferGeometry;
                    }
                },
                {
                    key: '_computeGroups',
                    value: function _computeGroups(bufferGeometry, materialIndices) {
                        var group;
                        var groups = [];
                        var materialIndex = undefined;
                        for (var i = 0; i < materialIndices.length; i++) {
                            var currentMaterialIndex = materialIndices[i];
                            if (currentMaterialIndex !== materialIndex) {
                                materialIndex = currentMaterialIndex;
                                if (group !== undefined) {
                                    group.count = i * 3 - group.start;
                                    groups.push(group);
                                }
                                group = {
                                    start: i * 3,
                                    materialIndex: materialIndex
                                };
                            }
                        }
                        if (group !== undefined) {
                            group.count = i * 3 - group.start;
                            groups.push(group);
                        }
                        bufferGeometry.groups = groups;
                    }
                },
                {
                    key: '_setMeshTextureCoords',
                    value: function _setMeshTextureCoords() {
                        var endRead = 0;
                        var mode = 0;
                        var mode_local = 0;
                        while (true) {
                            switch (mode) {
                            case 0:
                                if (mode_local === 0) {
                                    var refO = this._readInt1(0);
                                    endRead = refO.endRead;
                                    mode_local = 1;
                                } else {
                                    var find = this._currentObject.data.indexOf(',', endRead) + 1;
                                    if (find === 0) {
                                        find = this._currentObject.data.length;
                                        mode = 2;
                                        mode_local = 0;
                                    }
                                    var line = this._currentObject.data.substr(endRead, find - endRead);
                                    var data = this._readLine(line.trim()).split(';');
                                    if (this.IsUvYReverse) {
                                        this._currentGeo.GeometryData.uvs.push(parseFloat(data[0]), 1 - parseFloat(data[1]));
                                    } else {
                                        this._currentGeo.GeometryData.uvs.push(parseFloat(data[0]), parseFloat(data[1]));
                                    }
                                    endRead = find + 1;
                                }
                                break;
                            }
                            if (endRead >= this._currentObject.data.length) {
                                break;
                            }
                        }
                    }
                },
                {
                    key: '_setMeshMaterialList',
                    value: function _setMeshMaterialList() {
                        var endRead = 0;
                        var mode = 0;
                        var mode_local = 0;
                        while (true) {
                            if (mode_local < 2) {
                                var refO = this._readInt1(endRead);
                                endRead = refO.endRead;
                                mode_local++;
                            } else {
                                var find = this._currentObject.data.indexOf(';', endRead);
                                if (find === -1) {
                                    find = this._currentObject.data.length;
                                    mode = 3;
                                    mode_local = 0;
                                }
                                var line = this._currentObject.data.substr(endRead, find - endRead);
                                var data = this._readLine(line.trim()).split(',');
                                for (var i = 0; i < data.length; i++) {
                                    this._currentGeo.GeometryData.materialIndices[i] = parseInt(data[i]);
                                }
                                endRead = this._currentObject.data.length;
                            }
                            if (endRead >= this._currentObject.data.length || mode >= 3) {
                                break;
                            }
                        }
                    }
                },
                {
                    key: '_setMaterial',
                    value: function _setMaterial() {
                        var _nowMat = new THREE.MeshPhongMaterial({ color: Math.random() * 16777215 });
                        _nowMat.side = THREE.FrontSide;
                        _nowMat.name = this._currentObject.name;
                        var endRead = 0;
                        var find = this._currentObject.data.indexOf(';;', endRead);
                        var line = this._currentObject.data.substr(endRead, find - endRead);
                        var data = this._readLine(line.trim()).split(';');
                        _nowMat.color.r = parseFloat(data[0]);
                        _nowMat.color.g = parseFloat(data[1]);
                        _nowMat.color.b = parseFloat(data[2]);
                        endRead = find + 2;
                        find = this._currentObject.data.indexOf(';', endRead);
                        line = this._currentObject.data.substr(endRead, find - endRead);
                        _nowMat.shininess = parseFloat(this._readLine(line));
                        endRead = find + 1;
                        find = this._currentObject.data.indexOf(';;', endRead);
                        line = this._currentObject.data.substr(endRead, find - endRead);
                        var data2 = this._readLine(line.trim()).split(';');
                        _nowMat.specular.r = parseFloat(data2[0]);
                        _nowMat.specular.g = parseFloat(data2[1]);
                        _nowMat.specular.b = parseFloat(data2[2]);
                        endRead = find + 2;
                        find = this._currentObject.data.indexOf(';;', endRead);
                        if (find === -1) {
                            find = this._currentObject.data.length;
                        }
                        line = this._currentObject.data.substr(endRead, find - endRead);
                        var data3 = this._readLine(line.trim()).split(';');
                        _nowMat.emissive.r = parseFloat(data3[0]);
                        _nowMat.emissive.g = parseFloat(data3[1]);
                        _nowMat.emissive.b = parseFloat(data3[2]);
                        var localObject = null;
                        while (true) {
                            if (this._currentObject.children.length > 0) {
                                localObject = this._currentObject.children.shift();
                                if (this.debug) {
                                    console.log('processing ' + localObject.name);
                                }
                                var fileName = localObject.data.substr(1, localObject.data.length - 2);
                                switch (localObject.type) {
                                case 'TextureFilename':
                                    _nowMat.map = this.texloader.load(fileName);
                                    break;
                                case 'BumpMapFilename':
                                    _nowMat.bumpMap = this.texloader.load(fileName);
                                    _nowMat.bumpScale = 0.05;
                                    break;
                                case 'NormalMapFilename':
                                    _nowMat.normalMap = this.texloader.load(fileName);
                                    _nowMat.normalScale = new THREE.Vector2(2, 2);
                                    break;
                                case 'EmissiveMapFilename':
                                    _nowMat.emissiveMap = this.texloader.load(fileName);
                                    break;
                                case 'LightMapFilename':
                                    _nowMat.lightMap = this.texloader.load(fileName);
                                    break;
                                }
                            } else {
                                break;
                            }
                        }
                        this._currentGeo.Materials.push(_nowMat);
                    }
                },
                {
                    key: '_setSkinWeights',
                    value: function _setSkinWeights() {
                        var boneInf = new XboneInf();
                        var endRead = 0;
                        var find = this._currentObject.data.indexOf(';', endRead);
                        var line = this._currentObject.data.substr(endRead, find - endRead);
                        endRead = find + 1;
                        boneInf.boneName = line.substr(1, line.length - 2);
                        boneInf.BoneIndex = this._currentGeo.BoneInfs.length;
                        find = this._currentObject.data.indexOf(';', endRead);
                        endRead = find + 1;
                        find = this._currentObject.data.indexOf(';', endRead);
                        line = this._currentObject.data.substr(endRead, find - endRead);
                        var data = this._readLine(line.trim()).split(',');
                        for (var i = 0; i < data.length; i++) {
                            boneInf.Indeces.push(parseInt(data[i]));
                        }
                        endRead = find + 1;
                        find = this._currentObject.data.indexOf(';', endRead);
                        line = this._currentObject.data.substr(endRead, find - endRead);
                        var data2 = this._readLine(line.trim()).split(',');
                        for (var _i = 0; _i < data2.length; _i++) {
                            boneInf.Weights.push(parseFloat(data2[_i]));
                        }
                        endRead = find + 1;
                        find = this._currentObject.data.indexOf(';', endRead);
                        if (find <= 0) {
                            find = this._currentObject.data.length;
                        }
                        line = this._currentObject.data.substr(endRead, find - endRead);
                        var data3 = this._readLine(line.trim()).split(',');
                        boneInf.OffsetMatrix = new THREE.Matrix4();
                        this._ParseMatrixData(boneInf.OffsetMatrix, data3);
                        this._currentGeo.BoneInfs.push(boneInf);
                    }
                },
                {
                    key: '_makePutBoneList',
                    value: function _makePutBoneList(_RootName, _bones) {
                        var putting = false;
                        for (var frame in this.HieStack) {
                            if (this.HieStack[frame].name === _RootName || putting) {
                                putting = true;
                                var b = new THREE.Bone();
                                b.name = this.HieStack[frame].name;
                                b.applyMatrix4(this.HieStack[frame].FrameTransformMatrix);
                                b.matrixWorld = b.matrix;
                                b.FrameTransformMatrix = this.HieStack[frame].FrameTransformMatrix;
                                b.pos = new THREE.Vector3().setFromMatrixPosition(FrameTransformMatrix).toArray();
                                b.rotq = new THREE.Quaternion().setFromRotationMatrix(FrameTransformMatrix).toArray();
                                b.scl = new THREE.Vector3().setFromMatrixScale(FrameTransformMatrix).toArray();
                                if (this.HieStack[frame].parentName && this.HieStack[frame].parentName.length > 0) {
                                    for (var i = 0; i < _bones.length; i++) {
                                        if (this.HieStack[frame].parentName === _bones[i].name) {
                                            _bones[i].add(b);
                                            b.parent = i;
                                            break;
                                        }
                                    }
                                }
                                _bones.push(b);
                            }
                        }
                    }
                },
                {
                    key: '_makeOutputGeometry',
                    value: function _makeOutputGeometry() {
                        var mesh = null;
                        if (this._currentGeo.BoneInfs.length > 0) {
                            var putBones = [];
                            this._makePutBoneList(this._currentGeo.baseFrame.parentName, putBones);
                            for (var bi = 0; bi < this._currentGeo.BoneInfs.length; bi++) {
                                var boneIndex = 0;
                                for (var bb = 0; bb < putBones.length; bb++) {
                                    if (putBones[bb].name === this._currentGeo.BoneInfs[bi].boneName) {
                                        boneIndex = bb;
                                        putBones[bb].OffsetMatrix = new THREE.Matrix4();
                                        putBones[bb].OffsetMatrix.copy(this._currentGeo.BoneInfs[bi].OffsetMatrix);
                                        break;
                                    }
                                }
                                for (var vi = 0; vi < this._currentGeo.BoneInfs[bi].Indeces.length; vi++) {
                                    var nowVertexID = this._currentGeo.BoneInfs[bi].Indeces[vi];
                                    var nowVal = this._currentGeo.BoneInfs[bi].Weights[vi];
                                    var stride = nowVertexID * 4;
                                    switch (this._currentGeo.VertexSetedBoneCount[nowVertexID]) {
                                    case 0:
                                        this._currentGeo.GeometryData.skinIndices[stride] = boneIndex;
                                        this._currentGeo.GeometryData.skinWeights[stride] = nowVal;
                                        break;
                                    case 1:
                                        this._currentGeo.GeometryData.skinIndices[stride + 1] = boneIndex;
                                        this._currentGeo.GeometryData.skinWeights[stride + 1] = nowVal;
                                        break;
                                    case 2:
                                        this._currentGeo.GeometryData.skinIndices[stride + 2] = boneIndex;
                                        this._currentGeo.GeometryData.skinWeights[stride + 2] = nowVal;
                                        break;
                                    case 3:
                                        this._currentGeo.GeometryData.skinIndices[stride + 3] = boneIndex;
                                        this._currentGeo.GeometryData.skinWeights[stride + 3] = nowVal;
                                        break;
                                    }
                                    this._currentGeo.VertexSetedBoneCount[nowVertexID]++;
                                    if (this._currentGeo.VertexSetedBoneCount[nowVertexID] > 4) {
                                        console.log('warn! over 4 bone weight! :' + nowVertexID);
                                    }
                                }
                            }
                            for (var sk = 0; sk < this._currentGeo.Materials.length; sk++) {
                                this._currentGeo.Materials[sk].skinning = true;
                            }
                            var offsetList = [];
                            for (var _bi = 0; _bi < putBones.length; _bi++) {
                                if (putBones[_bi].OffsetMatrix) {
                                    offsetList.push(putBones[_bi].OffsetMatrix);
                                } else {
                                    offsetList.push(new THREE.Matrix4());
                                }
                            }
                            var bufferGeometry = this._buildGeometry();
                            mesh = new THREE.SkinnedMesh(bufferGeometry, this._currentGeo.Materials.length === 1 ? this._currentGeo.Materials[0] : this._currentGeo.Materials);
                            this._initSkeleton(mesh, putBones, offsetList);
                        } else {
                            var _bufferGeometry = this._buildGeometry();
                            mesh = new THREE.Mesh(_bufferGeometry, this._currentGeo.Materials.length === 1 ? this._currentGeo.Materials[0] : this._currentGeo.Materials);
                        }
                        mesh.name = this._currentGeo.name;
                        var worldBaseMx = new THREE.Matrix4();
                        var currentMxFrame = this._currentGeo.baseFrame.putBone;
                        if (currentMxFrame && currentMxFrame.parent) {
                            while (true) {
                                currentMxFrame = currentMxFrame.parent;
                                if (currentMxFrame) {
                                    worldBaseMx.multiply(currentMxFrame.FrameTransformMatrix);
                                } else {
                                    break;
                                }
                            }
                            mesh.applyMatrix4(worldBaseMx);
                        }
                        this.Meshes.push(mesh);
                    }
                },
                {
                    key: '_initSkeleton',
                    value: function _initSkeleton(mesh, boneList, boneInverses) {
                        var bones = [], bone, gbone;
                        var i, il;
                        for (i = 0, il = boneList.length; i < il; i++) {
                            gbone = boneList[i];
                            bone = new THREE.Bone();
                            bones.push(bone);
                            bone.name = gbone.name;
                            bone.position.fromArray(gbone.pos);
                            bone.quaternion.fromArray(gbone.rotq);
                            if (gbone.scl !== undefined)
                                bone.scale.fromArray(gbone.scl);
                        }
                        for (i = 0, il = boneList.length; i < il; i++) {
                            gbone = boneList[i];
                            if (gbone.parent !== -1 && gbone.parent !== null && bones[gbone.parent] !== undefined) {
                                bones[gbone.parent].add(bones[i]);
                            } else {
                                mesh.add(bones[i]);
                            }
                        }
                        mesh.updateMatrixWorld(true);
                        var skeleton = new THREE.Skeleton(bones, boneInverses);
                        mesh.bind(skeleton, mesh.matrixWorld);
                    }
                },
                {
                    key: '_readAnimationKey',
                    value: function _readAnimationKey() {
                        var endRead = 0;
                        var find = this._currentObject.data.indexOf(';', endRead);
                        var line = this._currentObject.data.substr(endRead, find - endRead);
                        endRead = find + 1;
                        var nowKeyType = parseInt(this._readLine(line));
                        find = this._currentObject.data.indexOf(';', endRead);
                        endRead = find + 1;
                        line = this._currentObject.data.substr(endRead);
                        var data = this._readLine(line.trim()).split(';;,');
                        for (var i = 0; i < data.length; i++) {
                            var data2 = data[i].split(';');
                            var keyInfo = new XKeyFrameInfo();
                            keyInfo.type = nowKeyType;
                            keyInfo.Frame = parseInt(data2[0]);
                            keyInfo.index = this._currentAnimeFrames.keyFrames.length;
                            keyInfo.time = keyInfo.Frame;
                            if (nowKeyType != 4) {
                                var frameFound = false;
                                for (var mm = 0; mm < this._currentAnimeFrames.keyFrames.length; mm++) {
                                    if (this._currentAnimeFrames.keyFrames[mm].Frame === keyInfo.Frame) {
                                        keyInfo = this._currentAnimeFrames.keyFrames[mm];
                                        frameFound = true;
                                        break;
                                    }
                                }
                                var frameValue = data2[2].split(',');
                                switch (nowKeyType) {
                                case 0:
                                    keyInfo.rot = new THREE.Quaternion(parseFloat(frameValue[1]), parseFloat(frameValue[2]), parseFloat(frameValue[3]), parseFloat(frameValue[0]) * -1);
                                    break;
                                case 1:
                                    keyInfo.scl = new THREE.Vector3(parseFloat(frameValue[0]), parseFloat(frameValue[1]), parseFloat(frameValue[2]));
                                    break;
                                case 2:
                                    keyInfo.pos = new THREE.Vector3(parseFloat(frameValue[0]), parseFloat(frameValue[1]), parseFloat(frameValue[2]));
                                    break;
                                }
                                if (!frameFound) {
                                    this._currentAnimeFrames.keyFrames.push(keyInfo);
                                }
                            } else {
                                keyInfo.matrix = new THREE.Matrix4();
                                this._ParseMatrixData(keyInfo.matrix, data2[2].split(','));
                                this._currentAnimeFrames.keyFrames.push(keyInfo);
                            }
                        }
                    }
                },
                {
                    key: '_makeOutputAnimation',
                    value: function _makeOutputAnimation() {
                        var animationObj = new XAnimationObj(this.options);
                        animationObj.fps = this.animTicksPerSecond;
                        animationObj.name = this._currentAnime.name;
                        animationObj.make(this._currentAnime.AnimeFrames);
                        this.animations.push(animationObj);
                    }
                },
                {
                    key: 'assignAnimation',
                    value: function assignAnimation(_model, _animation) {
                        var model = _model;
                        var animation = _animation;
                        if (!model) {
                            model = this.Meshes[0];
                        }
                        if (!animation) {
                            animation = this.animations[0];
                        }
                        if (!model || !animation) {
                            return null;
                        }
                        var put = {};
                        put.fps = animation.fps;
                        put.name = animation.name;
                        put.length = animation.length;
                        put.hierarchy = [];
                        for (var b = 0; b < model.skeleton.bones.length; b++) {
                            var findAnimation = false;
                            for (var i = 0; i < animation.hierarchy.length; i++) {
                                if (model.skeleton.bones[b].name === animation.hierarchy[i].name) {
                                    findAnimation = true;
                                    var c_key = animation.hierarchy[i].copy();
                                    c_key.parent = -1;
                                    if (model.skeleton.bones[b].parent && model.skeleton.bones[b].parent.type === 'Bone') {
                                        for (var bb = 0; bb < put.hierarchy.length; bb++) {
                                            if (put.hierarchy[bb].name === model.skeleton.bones[b].parent.name) {
                                                c_key.parent = bb;
                                                c_key.parentName = model.skeleton.bones[b].parent.name;
                                            }
                                        }
                                    }
                                    put.hierarchy.push(c_key);
                                    break;
                                }
                            }
                            if (!findAnimation) {
                                var _c_key = animation.hierarchy[0].copy();
                                _c_key.name = model.skeleton.bones[b].name;
                                _c_key.parent = -1;
                                for (var k = 0; k < _c_key.keys.length; k++) {
                                    if (_c_key.keys[k].pos) {
                                        _c_key.keys[k].pos.set(0, 0, 0);
                                    }
                                    if (_c_key.keys[k].scl) {
                                        _c_key.keys[k].scl.set(1, 1, 1);
                                    }
                                    if (_c_key.keys[k].rot) {
                                        _c_key.keys[k].rot.set(0, 0, 0, 1);
                                    }
                                }
                                put.hierarchy.push(_c_key);
                            }
                        }
                        if (!model.geometry.animations) {
                            model.geometry.animations = [];
                        }
                        model.geometry.animations.push(THREE.AnimationClip.parseAnimation(put, model.skeleton.bones));
                        if (!model.animationMixer) {
                            model.animationMixer = new THREE.AnimationMixer(model);
                        }
                        return put;
                    }
                },
                {
                    key: '_ParseMatrixData',
                    value: function _ParseMatrixData(targetMatrix, data) {
                        targetMatrix.set(parseFloat(data[0]), parseFloat(data[4]), parseFloat(data[8]), parseFloat(data[12]), parseFloat(data[1]), parseFloat(data[5]), parseFloat(data[9]), parseFloat(data[13]), parseFloat(data[2]), parseFloat(data[6]), parseFloat(data[10]), parseFloat(data[14]), parseFloat(data[3]), parseFloat(data[7]), parseFloat(data[11]), parseFloat(data[15]));
                    }
                }
            ]);
            return XLoader;
        }();
        return XLoader;
    }();

    return threex.loaders.XLoader = XLoader;
});
define('skylark-threejs-ex/loaders/DDSLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var DDSLoader = function (manager) {
        THREE.CompressedTextureLoader.call(this, manager);
    };
    DDSLoader.prototype = Object.assign(Object.create(THREE.CompressedTextureLoader.prototype), {
        constructor: DDSLoader,
        parse: function (buffer, loadMipmaps) {
            var dds = {
                mipmaps: [],
                width: 0,
                height: 0,
                format: null,
                mipmapCount: 1
            };
            var DDS_MAGIC = 542327876;
            var DDSD_CAPS = 1, DDSD_HEIGHT = 2, DDSD_WIDTH = 4, DDSD_PITCH = 8, DDSD_PIXELFORMAT = 4096, DDSD_MIPMAPCOUNT = 131072, DDSD_LINEARSIZE = 524288, DDSD_DEPTH = 8388608;
            var DDSCAPS_COMPLEX = 8, DDSCAPS_MIPMAP = 4194304, DDSCAPS_TEXTURE = 4096;
            var DDSCAPS2_CUBEMAP = 512, DDSCAPS2_CUBEMAP_POSITIVEX = 1024, DDSCAPS2_CUBEMAP_NEGATIVEX = 2048, DDSCAPS2_CUBEMAP_POSITIVEY = 4096, DDSCAPS2_CUBEMAP_NEGATIVEY = 8192, DDSCAPS2_CUBEMAP_POSITIVEZ = 16384, DDSCAPS2_CUBEMAP_NEGATIVEZ = 32768, DDSCAPS2_VOLUME = 2097152;
            var DDPF_ALPHAPIXELS = 1, DDPF_ALPHA = 2, DDPF_FOURCC = 4, DDPF_RGB = 64, DDPF_YUV = 512, DDPF_LUMINANCE = 131072;
            function fourCCToInt32(value) {
                return value.charCodeAt(0) + (value.charCodeAt(1) << 8) + (value.charCodeAt(2) << 16) + (value.charCodeAt(3) << 24);
            }
            function int32ToFourCC(value) {
                return String.fromCharCode(value & 255, value >> 8 & 255, value >> 16 & 255, value >> 24 & 255);
            }
            function loadARGBMip(buffer, dataOffset, width, height) {
                var dataLength = width * height * 4;
                var srcBuffer = new Uint8Array(buffer, dataOffset, dataLength);
                var byteArray = new Uint8Array(dataLength);
                var dst = 0;
                var src = 0;
                for (var y = 0; y < height; y++) {
                    for (var x = 0; x < width; x++) {
                        var b = srcBuffer[src];
                        src++;
                        var g = srcBuffer[src];
                        src++;
                        var r = srcBuffer[src];
                        src++;
                        var a = srcBuffer[src];
                        src++;
                        byteArray[dst] = r;
                        dst++;
                        byteArray[dst] = g;
                        dst++;
                        byteArray[dst] = b;
                        dst++;
                        byteArray[dst] = a;
                        dst++;
                    }
                }
                return byteArray;
            }
            var FOURCC_DXT1 = fourCCToInt32('DXT1');
            var FOURCC_DXT3 = fourCCToInt32('DXT3');
            var FOURCC_DXT5 = fourCCToInt32('DXT5');
            var FOURCC_ETC1 = fourCCToInt32('ETC1');
            var headerLengthInt = 31;
            var off_magic = 0;
            var off_size = 1;
            var off_flags = 2;
            var off_height = 3;
            var off_width = 4;
            var off_mipmapCount = 7;
            var off_pfFlags = 20;
            var off_pfFourCC = 21;
            var off_RGBBitCount = 22;
            var off_RBitMask = 23;
            var off_GBitMask = 24;
            var off_BBitMask = 25;
            var off_ABitMask = 26;
            var off_caps = 27;
            var off_caps2 = 28;
            var off_caps3 = 29;
            var off_caps4 = 30;
            var header = new Int32Array(buffer, 0, headerLengthInt);
            if (header[off_magic] !== DDS_MAGIC) {
                console.error('THREE.DDSLoader.parse: Invalid magic number in DDS header.');
                return dds;
            }
            if (!header[off_pfFlags] & DDPF_FOURCC) {
                console.error('THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code.');
                return dds;
            }
            var blockBytes;
            var fourCC = header[off_pfFourCC];
            var isRGBAUncompressed = false;
            switch (fourCC) {
            case FOURCC_DXT1:
                blockBytes = 8;
                dds.format = THREE.RGB_S3TC_DXT1_Format;
                break;
            case FOURCC_DXT3:
                blockBytes = 16;
                dds.format = THREE.RGBA_S3TC_DXT3_Format;
                break;
            case FOURCC_DXT5:
                blockBytes = 16;
                dds.format = THREE.RGBA_S3TC_DXT5_Format;
                break;
            case FOURCC_ETC1:
                blockBytes = 8;
                dds.format = THREE.RGB_ETC1_Format;
                break;
            default:
                if (header[off_RGBBitCount] === 32 && header[off_RBitMask] & 16711680 && header[off_GBitMask] & 65280 && header[off_BBitMask] & 255 && header[off_ABitMask] & 4278190080) {
                    isRGBAUncompressed = true;
                    blockBytes = 64;
                    dds.format = THREE.RGBAFormat;
                } else {
                    console.error('THREE.DDSLoader.parse: Unsupported FourCC code ', int32ToFourCC(fourCC));
                    return dds;
                }
            }
            dds.mipmapCount = 1;
            if (header[off_flags] & DDSD_MIPMAPCOUNT && loadMipmaps !== false) {
                dds.mipmapCount = Math.max(1, header[off_mipmapCount]);
            }
            var caps2 = header[off_caps2];
            dds.isCubemap = caps2 & DDSCAPS2_CUBEMAP ? true : false;
            if (dds.isCubemap && (!(caps2 & DDSCAPS2_CUBEMAP_POSITIVEX) || !(caps2 & DDSCAPS2_CUBEMAP_NEGATIVEX) || !(caps2 & DDSCAPS2_CUBEMAP_POSITIVEY) || !(caps2 & DDSCAPS2_CUBEMAP_NEGATIVEY) || !(caps2 & DDSCAPS2_CUBEMAP_POSITIVEZ) || !(caps2 & DDSCAPS2_CUBEMAP_NEGATIVEZ))) {
                console.error('THREE.DDSLoader.parse: Incomplete cubemap faces');
                return dds;
            }
            dds.width = header[off_width];
            dds.height = header[off_height];
            var dataOffset = header[off_size] + 4;
            var faces = dds.isCubemap ? 6 : 1;
            for (var face = 0; face < faces; face++) {
                var width = dds.width;
                var height = dds.height;
                for (var i = 0; i < dds.mipmapCount; i++) {
                    if (isRGBAUncompressed) {
                        var byteArray = loadARGBMip(buffer, dataOffset, width, height);
                        var dataLength = byteArray.length;
                    } else {
                        var dataLength = Math.max(4, width) / 4 * Math.max(4, height) / 4 * blockBytes;
                        var byteArray = new Uint8Array(buffer, dataOffset, dataLength);
                    }
                    var mipmap = {
                        'data': byteArray,
                        'width': width,
                        'height': height
                    };
                    dds.mipmaps.push(mipmap);
                    dataOffset += dataLength;
                    width = Math.max(width >> 1, 1);
                    height = Math.max(height >> 1, 1);
                }
            }
            return dds;
        }
    });
    return threex.loaders.DDSLoader = DDSLoader;
});
define('skylark-threejs-ex/loaders/PVRLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var PVRLoader = function (manager) {
        THREE.CompressedTextureLoader.call(this, manager);
    };
    PVRLoader.prototype = Object.assign(Object.create(THREE.CompressedTextureLoader.prototype), {
        constructor: PVRLoader,
        parse: function (buffer, loadMipmaps) {
            var headerLengthInt = 13;
            var header = new Uint32Array(buffer, 0, headerLengthInt);
            var pvrDatas = {
                buffer: buffer,
                header: header,
                loadMipmaps: loadMipmaps
            };
            if (header[0] === 55727696) {
                return PVRLoader._parseV3(pvrDatas);
            } else if (header[11] === 559044176) {
                return PVRLoader._parseV2(pvrDatas);
            } else {
                console.error('THREE.PVRLoader: Unknown PVR format.');
            }
        }
    });
    PVRLoader._parseV3 = function (pvrDatas) {
        var header = pvrDatas.header;
        var bpp, format;
        var metaLen = header[12], pixelFormat = header[2], height = header[6], width = header[7], numFaces = header[10], numMipmaps = header[11];
        switch (pixelFormat) {
        case 0:
            bpp = 2;
            format = THREE.RGB_PVRTC_2BPPV1_Format;
            break;
        case 1:
            bpp = 2;
            format = THREE.RGBA_PVRTC_2BPPV1_Format;
            break;
        case 2:
            bpp = 4;
            format = THREE.RGB_PVRTC_4BPPV1_Format;
            break;
        case 3:
            bpp = 4;
            format = THREE.RGBA_PVRTC_4BPPV1_Format;
            break;
        default:
            console.error('THREE.PVRLoader: Unsupported PVR format:', pixelFormat);
        }
        pvrDatas.dataPtr = 52 + metaLen;
        pvrDatas.bpp = bpp;
        pvrDatas.format = format;
        pvrDatas.width = width;
        pvrDatas.height = height;
        pvrDatas.numSurfaces = numFaces;
        pvrDatas.numMipmaps = numMipmaps;
        pvrDatas.isCubemap = numFaces === 6;
        return PVRLoader._extract(pvrDatas);
    };
    PVRLoader._parseV2 = function (pvrDatas) {
        var header = pvrDatas.header;
        var headerLength = header[0], height = header[1], width = header[2], numMipmaps = header[3], flags = header[4], bitmaskAlpha = header[10], numSurfs = header[12];
        var TYPE_MASK = 255;
        var PVRTC_2 = 24, PVRTC_4 = 25;
        var formatFlags = flags & TYPE_MASK;
        var bpp, format;
        var _hasAlpha = bitmaskAlpha > 0;
        if (formatFlags === PVRTC_4) {
            format = _hasAlpha ? THREE.RGBA_PVRTC_4BPPV1_Format : THREE.RGB_PVRTC_4BPPV1_Format;
            bpp = 4;
        } else if (formatFlags === PVRTC_2) {
            format = _hasAlpha ? THREE.RGBA_PVRTC_2BPPV1_Format : THREE.RGB_PVRTC_2BPPV1_Format;
            bpp = 2;
        } else {
            console.error('THREE.PVRLoader: Unknown PVR format:', formatFlags);
        }
        pvrDatas.dataPtr = headerLength;
        pvrDatas.bpp = bpp;
        pvrDatas.format = format;
        pvrDatas.width = width;
        pvrDatas.height = height;
        pvrDatas.numSurfaces = numSurfs;
        pvrDatas.numMipmaps = numMipmaps + 1;
        pvrDatas.isCubemap = numSurfs === 6;
        return PVRLoader._extract(pvrDatas);
    };
    PVRLoader._extract = function (pvrDatas) {
        var pvr = {
            mipmaps: [],
            width: pvrDatas.width,
            height: pvrDatas.height,
            format: pvrDatas.format,
            mipmapCount: pvrDatas.numMipmaps,
            isCubemap: pvrDatas.isCubemap
        };
        var buffer = pvrDatas.buffer;
        var dataOffset = pvrDatas.dataPtr, bpp = pvrDatas.bpp, numSurfs = pvrDatas.numSurfaces, dataSize = 0, blockSize = 0, blockWidth = 0, blockHeight = 0, widthBlocks = 0, heightBlocks = 0;
        if (bpp === 2) {
            blockWidth = 8;
            blockHeight = 4;
        } else {
            blockWidth = 4;
            blockHeight = 4;
        }
        blockSize = blockWidth * blockHeight * bpp / 8;
        pvr.mipmaps.length = pvrDatas.numMipmaps * numSurfs;
        var mipLevel = 0;
        while (mipLevel < pvrDatas.numMipmaps) {
            var sWidth = pvrDatas.width >> mipLevel, sHeight = pvrDatas.height >> mipLevel;
            widthBlocks = sWidth / blockWidth;
            heightBlocks = sHeight / blockHeight;
            if (widthBlocks < 2)
                widthBlocks = 2;
            if (heightBlocks < 2)
                heightBlocks = 2;
            dataSize = widthBlocks * heightBlocks * blockSize;
            for (var surfIndex = 0; surfIndex < numSurfs; surfIndex++) {
                var byteArray = new Uint8Array(buffer, dataOffset, dataSize);
                var mipmap = {
                    data: byteArray,
                    width: sWidth,
                    height: sHeight
                };
                pvr.mipmaps[surfIndex * pvrDatas.numMipmaps + mipLevel] = mipmap;
                dataOffset += dataSize;
            }
            mipLevel++;
        }
        return pvr;
    };
    return threex.loaders.PVRLoader = PVRLoader;
});
define('skylark-threejs-ex/loaders/KTXLoader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var KTXLoader = function (manager) {
        THREE.CompressedTextureLoader.call(this, manager);
    };
    KTXLoader.prototype = Object.assign(Object.create(THREE.CompressedTextureLoader.prototype), {
        constructor: KTXLoader,
        parse: function (buffer, loadMipmaps) {
            var ktx = new KhronosTextureContainer(buffer, 1);
            return {
                mipmaps: ktx.mipmaps(loadMipmaps),
                width: ktx.pixelWidth,
                height: ktx.pixelHeight,
                format: ktx.glInternalFormat,
                isCubemap: ktx.numberOfFaces === 6,
                mipmapCount: ktx.numberOfMipmapLevels
            };
        }
    });
    var KhronosTextureContainer = function () {
        function KhronosTextureContainer(arrayBuffer, facesExpected) {
            this.arrayBuffer = arrayBuffer;
            var identifier = new Uint8Array(this.arrayBuffer, 0, 12);
            if (identifier[0] !== 171 || identifier[1] !== 75 || identifier[2] !== 84 || identifier[3] !== 88 || identifier[4] !== 32 || identifier[5] !== 49 || identifier[6] !== 49 || identifier[7] !== 187 || identifier[8] !== 13 || identifier[9] !== 10 || identifier[10] !== 26 || identifier[11] !== 10) {
                console.error('texture missing KTX identifier');
                return;
            }
            var dataSize = Uint32Array.BYTES_PER_ELEMENT;
            var headerDataView = new DataView(this.arrayBuffer, 12, 13 * dataSize);
            var endianness = headerDataView.getUint32(0, true);
            var littleEndian = endianness === 67305985;
            this.glType = headerDataView.getUint32(1 * dataSize, littleEndian);
            this.glTypeSize = headerDataView.getUint32(2 * dataSize, littleEndian);
            this.glFormat = headerDataView.getUint32(3 * dataSize, littleEndian);
            this.glInternalFormat = headerDataView.getUint32(4 * dataSize, littleEndian);
            this.glBaseInternalFormat = headerDataView.getUint32(5 * dataSize, littleEndian);
            this.pixelWidth = headerDataView.getUint32(6 * dataSize, littleEndian);
            this.pixelHeight = headerDataView.getUint32(7 * dataSize, littleEndian);
            this.pixelDepth = headerDataView.getUint32(8 * dataSize, littleEndian);
            this.numberOfArrayElements = headerDataView.getUint32(9 * dataSize, littleEndian);
            this.numberOfFaces = headerDataView.getUint32(10 * dataSize, littleEndian);
            this.numberOfMipmapLevels = headerDataView.getUint32(11 * dataSize, littleEndian);
            this.bytesOfKeyValueData = headerDataView.getUint32(12 * dataSize, littleEndian);
            if (this.glType !== 0) {
                console.warn('only compressed formats currently supported');
                return;
            } else {
                this.numberOfMipmapLevels = Math.max(1, this.numberOfMipmapLevels);
            }
            if (this.pixelHeight === 0 || this.pixelDepth !== 0) {
                console.warn('only 2D textures currently supported');
                return;
            }
            if (this.numberOfArrayElements !== 0) {
                console.warn('texture arrays not currently supported');
                return;
            }
            if (this.numberOfFaces !== facesExpected) {
                console.warn('number of faces expected' + facesExpected + ', but found ' + this.numberOfFaces);
                return;
            }
            this.loadType = KhronosTextureContainer.COMPRESSED_2D;
        }
        KhronosTextureContainer.prototype.mipmaps = function (loadMipmaps) {
            var mipmaps = [];
            var dataOffset = KhronosTextureContainer.HEADER_LEN + this.bytesOfKeyValueData;
            var width = this.pixelWidth;
            var height = this.pixelHeight;
            var mipmapCount = loadMipmaps ? this.numberOfMipmapLevels : 1;
            for (var level = 0; level < mipmapCount; level++) {
                var imageSize = new Int32Array(this.arrayBuffer, dataOffset, 1)[0];
                dataOffset += 4;
                for (var face = 0; face < this.numberOfFaces; face++) {
                    var byteArray = new Uint8Array(this.arrayBuffer, dataOffset, imageSize);
                    mipmaps.push({
                        'data': byteArray,
                        'width': width,
                        'height': height
                    });
                    dataOffset += imageSize;
                    dataOffset += 3 - (imageSize + 3) % 4;
                }
                width = Math.max(1, width * 0.5);
                height = Math.max(1, height * 0.5);
            }
            return mipmaps;
        };
        KhronosTextureContainer.HEADER_LEN = 12 + 13 * 4;
        KhronosTextureContainer.COMPRESSED_2D = 0;
        KhronosTextureContainer.COMPRESSED_3D = 1;
        KhronosTextureContainer.TEX_2D = 2;
        KhronosTextureContainer.TEX_3D = 3;
        return KhronosTextureContainer;
    }();

    return threex.loaders.KTXLoader = KTXLoader;
});
define('skylark-threejs-ex/math/ColorConverter',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ColorConverter = {
        setHSV: function (color, h, s, v) {
            h = THREE.MathUtils.euclideanModulo(h, 1);
            s = THREE.MathUtils.clamp(s, 0, 1);
            v = THREE.MathUtils.clamp(v, 0, 1);
            return color.setHSL(h, s * v / ((h = (2 - s) * v) < 1 ? h : 2 - h), h * 0.5);
        },
        getHSV: function () {
            var hsl = {};
            return function getHSV(color, target) {
                if (target === undefined) {
                    console.warn('THREE.ColorConverter: .getHSV() target is now required');
                    target = {
                        h: 0,
                        s: 0,
                        l: 0
                    };
                }
                color.getHSL(hsl);
                hsl.s *= hsl.l < 0.5 ? hsl.l : 1 - hsl.l;
                target.h = hsl.h;
                target.s = 2 * hsl.s / (hsl.l + hsl.s);
                target.v = hsl.l + hsl.s;
                return target;
            };
        }(),
        setCMYK: function (color, c, m, y, k) {
            var r = (1 - c) * (1 - k);
            var g = (1 - m) * (1 - k);
            var b = (1 - y) * (1 - k);
            return color.setRGB(r, g, b);
        },
        getCMYK: function (color, target) {
            if (target === undefined) {
                console.warn('THREE.ColorConverter: .getCMYK() target is now required');
                target = {
                    c: 0,
                    m: 0,
                    y: 0,
                    k: 0
                };
            }
            var r = color.r;
            var g = color.g;
            var b = color.b;
            var k = 1 - Math.max(r, g, b);
            var c = (1 - r - k) / (1 - k);
            var m = (1 - g - k) / (1 - k);
            var y = (1 - b - k) / (1 - k);
            target.c = c;
            target.m = m;
            target.y = y;
            target.k = k;
            return target;
        }
    };
    return threex.math.ColorConverter = ColorConverter;
});
define('skylark-threejs-ex/math/ImprovedNoise',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ImprovedNoise = function () {
        var p = [
            151,
            160,
            137,
            91,
            90,
            15,
            131,
            13,
            201,
            95,
            96,
            53,
            194,
            233,
            7,
            225,
            140,
            36,
            103,
            30,
            69,
            142,
            8,
            99,
            37,
            240,
            21,
            10,
            23,
            190,
            6,
            148,
            247,
            120,
            234,
            75,
            0,
            26,
            197,
            62,
            94,
            252,
            219,
            203,
            117,
            35,
            11,
            32,
            57,
            177,
            33,
            88,
            237,
            149,
            56,
            87,
            174,
            20,
            125,
            136,
            171,
            168,
            68,
            175,
            74,
            165,
            71,
            134,
            139,
            48,
            27,
            166,
            77,
            146,
            158,
            231,
            83,
            111,
            229,
            122,
            60,
            211,
            133,
            230,
            220,
            105,
            92,
            41,
            55,
            46,
            245,
            40,
            244,
            102,
            143,
            54,
            65,
            25,
            63,
            161,
            1,
            216,
            80,
            73,
            209,
            76,
            132,
            187,
            208,
            89,
            18,
            169,
            200,
            196,
            135,
            130,
            116,
            188,
            159,
            86,
            164,
            100,
            109,
            198,
            173,
            186,
            3,
            64,
            52,
            217,
            226,
            250,
            124,
            123,
            5,
            202,
            38,
            147,
            118,
            126,
            255,
            82,
            85,
            212,
            207,
            206,
            59,
            227,
            47,
            16,
            58,
            17,
            182,
            189,
            28,
            42,
            223,
            183,
            170,
            213,
            119,
            248,
            152,
            2,
            44,
            154,
            163,
            70,
            221,
            153,
            101,
            155,
            167,
            43,
            172,
            9,
            129,
            22,
            39,
            253,
            19,
            98,
            108,
            110,
            79,
            113,
            224,
            232,
            178,
            185,
            112,
            104,
            218,
            246,
            97,
            228,
            251,
            34,
            242,
            193,
            238,
            210,
            144,
            12,
            191,
            179,
            162,
            241,
            81,
            51,
            145,
            235,
            249,
            14,
            239,
            107,
            49,
            192,
            214,
            31,
            181,
            199,
            106,
            157,
            184,
            84,
            204,
            176,
            115,
            121,
            50,
            45,
            127,
            4,
            150,
            254,
            138,
            236,
            205,
            93,
            222,
            114,
            67,
            29,
            24,
            72,
            243,
            141,
            128,
            195,
            78,
            66,
            215,
            61,
            156,
            180
        ];
        for (var i = 0; i < 256; i++) {
            p[256 + i] = p[i];
        }
        function fade(t) {
            return t * t * t * (t * (t * 6 - 15) + 10);
        }
        function lerp(t, a, b) {
            return a + t * (b - a);
        }
        function grad(hash, x, y, z) {
            var h = hash & 15;
            var u = h < 8 ? x : y, v = h < 4 ? y : h == 12 || h == 14 ? x : z;
            return ((h & 1) == 0 ? u : -u) + ((h & 2) == 0 ? v : -v);
        }
        return {
            noise: function (x, y, z) {
                var floorX = Math.floor(x), floorY = Math.floor(y), floorZ = Math.floor(z);
                var X = floorX & 255, Y = floorY & 255, Z = floorZ & 255;
                x -= floorX;
                y -= floorY;
                z -= floorZ;
                var xMinus1 = x - 1, yMinus1 = y - 1, zMinus1 = z - 1;
                var u = fade(x), v = fade(y), w = fade(z);
                var A = p[X] + Y, AA = p[A] + Z, AB = p[A + 1] + Z, B = p[X + 1] + Y, BA = p[B] + Z, BB = p[B + 1] + Z;
                return lerp(w, lerp(v, lerp(u, grad(p[AA], x, y, z), grad(p[BA], xMinus1, y, z)), lerp(u, grad(p[AB], x, yMinus1, z), grad(p[BB], xMinus1, yMinus1, z))), lerp(v, lerp(u, grad(p[AA + 1], x, y, zMinus1), grad(p[BA + 1], xMinus1, y, z - 1)), lerp(u, grad(p[AB + 1], x, yMinus1, zMinus1), grad(p[BB + 1], xMinus1, yMinus1, zMinus1))));
            }
        };
    };
    return threex.math.ImprovedNoise = ImprovedNoise;
});
define('skylark-threejs-ex/math/Lut',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var Lut = function (colormap, numberofcolors) {
        this.lut = [];
        this.setColorMap(colormap, numberofcolors);
        return this;
    };
    Lut.prototype = {
        constructor: Lut,
        lut: [],
        map: [],
        n: 256,
        minV: 0,
        maxV: 1,
        set: function (value) {
            if (value instanceof Lut) {
                this.copy(value);
            }
            return this;
        },
        setMin: function (min) {
            this.minV = min;
            return this;
        },
        setMax: function (max) {
            this.maxV = max;
            return this;
        },
        setColorMap: function (colormap, numberofcolors) {
            this.map = ColorMapKeywords[colormap] || ColorMapKeywords.rainbow;
            this.n = numberofcolors || 32;
            var step = 1 / this.n;
            this.lut.length = 0;
            for (var i = 0; i <= 1; i += step) {
                for (var j = 0; j < this.map.length - 1; j++) {
                    if (i >= this.map[j][0] && i < this.map[j + 1][0]) {
                        var min = this.map[j][0];
                        var max = this.map[j + 1][0];
                        var minColor = new THREE.Color(this.map[j][1]);
                        var maxColor = new THREE.Color(this.map[j + 1][1]);
                        var color = minColor.lerp(maxColor, (i - min) / (max - min));
                        this.lut.push(color);
                    }
                }
            }
            return this;
        },
        copy: function (lut) {
            this.lut = lut.lut;
            this.map = lut.map;
            this.n = lut.n;
            this.minV = lut.minV;
            this.maxV = lut.maxV;
            return this;
        },
        getColor: function (alpha) {
            if (alpha <= this.minV) {
                alpha = this.minV;
            } else if (alpha >= this.maxV) {
                alpha = this.maxV;
            }
            alpha = (alpha - this.minV) / (this.maxV - this.minV);
            var colorPosition = Math.round(alpha * this.n);
            colorPosition == this.n ? colorPosition -= 1 : colorPosition;
            return this.lut[colorPosition];
        },
        addColorMap: function (colormapName, arrayOfColors) {
            ColorMapKeywords[colormapName] = arrayOfColors;
        },
        createCanvas: function () {
            var canvas = document.createElement('canvas');
            canvas.width = 1;
            canvas.height = this.n;
            this.updateCanvas(canvas);
            return canvas;
        },
        updateCanvas: function (canvas) {
            var ctx = canvas.getContext('2d', { alpha: false });
            var imageData = ctx.getImageData(0, 0, 1, this.n);
            var data = imageData.data;
            var k = 0;
            var step = 1 / this.n;
            for (var i = 1; i >= 0; i -= step) {
                for (var j = this.map.length - 1; j >= 0; j--) {
                    if (i < this.map[j][0] && i >= this.map[j - 1][0]) {
                        var min = this.map[j - 1][0];
                        var max = this.map[j][0];
                        var minColor = new THREE.Color(this.map[j - 1][1]);
                        var maxColor = new THREE.Color(this.map[j][1]);
                        var color = minColor.lerp(maxColor, (i - min) / (max - min));
                        data[k * 4] = Math.round(color.r * 255);
                        data[k * 4 + 1] = Math.round(color.g * 255);
                        data[k * 4 + 2] = Math.round(color.b * 255);
                        data[k * 4 + 3] = 255;
                        k += 1;
                    }
                }
            }
            ctx.putImageData(imageData, 0, 0);
            return canvas;
        }
    };
    var ColorMapKeywords = {
        'rainbow': [
            [
                0,
                255
            ],
            [
                0.2,
                65535
            ],
            [
                0.5,
                65280
            ],
            [
                0.8,
                16776960
            ],
            [
                1,
                16711680
            ]
        ],
        'cooltowarm': [
            [
                0,
                3952322
            ],
            [
                0.2,
                10206463
            ],
            [
                0.5,
                14474460
            ],
            [
                0.8,
                16163717
            ],
            [
                1,
                11797542
            ]
        ],
        'blackbody': [
            [
                0,
                0
            ],
            [
                0.2,
                7864320
            ],
            [
                0.5,
                15086080
            ],
            [
                0.8,
                16776960
            ],
            [
                1,
                16777215
            ]
        ],
        'grayscale': [
            [
                0,
                0
            ],
            [
                0.2,
                4210752
            ],
            [
                0.5,
                8355712
            ],
            [
                0.8,
                12566463
            ],
            [
                1,
                16777215
            ]
        ]
    };
    
    return threex.math.Lut = Lut;
});
define('skylark-threejs-ex/math/MeshSurfaceSampler',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var MeshSurfaceSampler = function () {
        var _face = new THREE.Triangle();
        function MeshSurfaceSampler(mesh) {
            var geometry = mesh.geometry;
            if (!geometry.isBufferGeometry || geometry.attributes.position.itemSize !== 3) {
                throw new Error('THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.');
            }
            if (geometry.index) {
                console.warn('THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry.');
                geometry = geometry.toNonIndexed();
            }
            this.geometry = geometry;
            this.positionAttribute = this.geometry.getAttribute('position');
            this.weightAttribute = null;
            this.distribution = null;
        }
        MeshSurfaceSampler.prototype = {
            constructor: MeshSurfaceSampler,
            setWeightAttribute: function (name) {
                this.weightAttribute = name ? this.geometry.getAttribute(name) : null;
                return this;
            },
            build: function () {
                var positionAttribute = this.positionAttribute;
                var weightAttribute = this.weightAttribute;
                var faceWeights = new Float32Array(positionAttribute.count / 3);
                for (var i = 0; i < positionAttribute.count; i += 3) {
                    var faceWeight = 1;
                    if (weightAttribute) {
                        faceWeight = weightAttribute.getX(i) + weightAttribute.getX(i + 1) + weightAttribute.getX(i + 2);
                    }
                    _face.a.fromBufferAttribute(positionAttribute, i);
                    _face.b.fromBufferAttribute(positionAttribute, i + 1);
                    _face.c.fromBufferAttribute(positionAttribute, i + 2);
                    faceWeight *= _face.getArea();
                    faceWeights[i / 3] = faceWeight;
                }
                this.distribution = new Float32Array(positionAttribute.count / 3);
                var cumulativeTotal = 0;
                for (var i = 0; i < faceWeights.length; i++) {
                    cumulativeTotal += faceWeights[i];
                    this.distribution[i] = cumulativeTotal;
                }
                return this;
            },
            sample: function (targetPosition, targetNormal) {
                var cumulativeTotal = this.distribution[this.distribution.length - 1];
                var faceIndex = this.binarySearch(Math.random() * cumulativeTotal);
                return this.sampleFace(faceIndex, targetPosition, targetNormal);
            },
            binarySearch: function (x) {
                var dist = this.distribution;
                var start = 0;
                var end = dist.length - 1;
                var index = -1;
                while (start <= end) {
                    var mid = Math.floor((start + end) / 2);
                    if (mid === 0 || dist[mid - 1] <= x && dist[mid] > x) {
                        index = mid;
                        break;
                    } else if (x < dist[mid]) {
                        end = mid - 1;
                    } else {
                        start = mid + 1;
                    }
                }
                return index;
            },
            sampleFace: function (faceIndex, targetPosition, targetNormal) {
                var u = Math.random();
                var v = Math.random();
                if (u + v > 1) {
                    u = 1 - u;
                    v = 1 - v;
                }
                _face.a.fromBufferAttribute(this.positionAttribute, faceIndex * 3);
                _face.b.fromBufferAttribute(this.positionAttribute, faceIndex * 3 + 1);
                _face.c.fromBufferAttribute(this.positionAttribute, faceIndex * 3 + 2);
                targetPosition.set(0, 0, 0).addScaledVector(_face.a, u).addScaledVector(_face.b, v).addScaledVector(_face.c, 1 - (u + v));
                _face.getNormal(targetNormal);
                return this;
            }
        };
        return MeshSurfaceSampler;
    }();
    return  threex.math.MeshSurfaceSampler = MeshSurfaceSampler;
});
define('skylark-threejs-ex/math/OBB',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var a = {
        c: null,
        u: [
            new THREE.Vector3(),
            new THREE.Vector3(),
            new THREE.Vector3()
        ],
        e: []
    };
    var b = {
        c: null,
        u: [
            new THREE.Vector3(),
            new THREE.Vector3(),
            new THREE.Vector3()
        ],
        e: []
    };
    var R = [
        [],
        [],
        []
    ];
    var AbsR = [
        [],
        [],
        []
    ];
    var t = [];
    var xAxis = new THREE.Vector3();
    var yAxis = new THREE.Vector3();
    var zAxis = new THREE.Vector3();
    var v1 = new THREE.Vector3();
    var size = new THREE.Vector3();
    var closestPoint = new THREE.Vector3();
    var rotationMatrix = new THREE.Matrix3();
    var aabb = new THREE.Box3();
    var matrix = new THREE.Matrix4();
    var inverse = new THREE.Matrix4();
    var localRay = new THREE.Ray();
    function OBB(center = new THREE.Vector3(), halfSize = new THREE.Vector3(), rotation = new THREE.Matrix3()) {
        this.center = center;
        this.halfSize = halfSize;
        this.rotation = rotation;
    }
    Object.assign(OBB.prototype, {
        set: function (center, halfSize, rotation) {
            this.center = center;
            this.halfSize = halfSize;
            this.rotation = rotation;
            return this;
        },
        copy: function (obb) {
            this.center.copy(obb.center);
            this.halfSize.copy(obb.halfSize);
            this.rotation.copy(obb.rotation);
            return this;
        },
        clone: function () {
            return new this.constructor().copy(this);
        },
        getSize: function (result) {
            return result.copy(this.halfSize).multiplyScalar(2);
        },
        clampPoint: function (point, result) {
            var halfSize = this.halfSize;
            v1.subVectors(point, this.center);
            this.rotation.extractBasis(xAxis, yAxis, zAxis);
            result.copy(this.center);
            var x = THREE.MathUtils.clamp(v1.dot(xAxis), -halfSize.x, halfSize.x);
            result.add(xAxis.multiplyScalar(x));
            var y = THREE.MathUtils.clamp(v1.dot(yAxis), -halfSize.y, halfSize.y);
            result.add(yAxis.multiplyScalar(y));
            var z = THREE.MathUtils.clamp(v1.dot(zAxis), -halfSize.z, halfSize.z);
            result.add(zAxis.multiplyScalar(z));
            return result;
        },
        containsPoint: function (point) {
            v1.subVectors(point, this.center);
            this.rotation.extractBasis(xAxis, yAxis, zAxis);
            return Math.abs(v1.dot(xAxis)) <= this.halfSize.x && Math.abs(v1.dot(yAxis)) <= this.halfSize.y && Math.abs(v1.dot(zAxis)) <= this.halfSize.z;
        },
        intersectsBox3: function (box3) {
            return this.intersectsOBB(obb.fromBox3(box3));
        },
        intersectsSphere: function (sphere) {
            this.clampPoint(sphere.center, closestPoint);
            return closestPoint.distanceToSquared(sphere.center) <= sphere.radius * sphere.radius;
        },
        intersectsOBB: function (obb, epsilon = Number.EPSILON) {
            a.c = this.center;
            a.e[0] = this.halfSize.x;
            a.e[1] = this.halfSize.y;
            a.e[2] = this.halfSize.z;
            this.rotation.extractBasis(a.u[0], a.u[1], a.u[2]);
            b.c = obb.center;
            b.e[0] = obb.halfSize.x;
            b.e[1] = obb.halfSize.y;
            b.e[2] = obb.halfSize.z;
            obb.rotation.extractBasis(b.u[0], b.u[1], b.u[2]);
            for (var i = 0; i < 3; i++) {
                for (var j = 0; j < 3; j++) {
                    R[i][j] = a.u[i].dot(b.u[j]);
                }
            }
            v1.subVectors(b.c, a.c);
            t[0] = v1.dot(a.u[0]);
            t[1] = v1.dot(a.u[1]);
            t[2] = v1.dot(a.u[2]);
            for (var i = 0; i < 3; i++) {
                for (var j = 0; j < 3; j++) {
                    AbsR[i][j] = Math.abs(R[i][j]) + epsilon;
                }
            }
            var ra, rb;
            for (var i = 0; i < 3; i++) {
                ra = a.e[i];
                rb = b.e[0] * AbsR[i][0] + b.e[1] * AbsR[i][1] + b.e[2] * AbsR[i][2];
                if (Math.abs(t[i]) > ra + rb)
                    return false;
            }
            for (var i = 0; i < 3; i++) {
                ra = a.e[0] * AbsR[0][i] + a.e[1] * AbsR[1][i] + a.e[2] * AbsR[2][i];
                rb = b.e[i];
                if (Math.abs(t[0] * R[0][i] + t[1] * R[1][i] + t[2] * R[2][i]) > ra + rb)
                    return false;
            }
            ra = a.e[1] * AbsR[2][0] + a.e[2] * AbsR[1][0];
            rb = b.e[1] * AbsR[0][2] + b.e[2] * AbsR[0][1];
            if (Math.abs(t[2] * R[1][0] - t[1] * R[2][0]) > ra + rb)
                return false;
            ra = a.e[1] * AbsR[2][1] + a.e[2] * AbsR[1][1];
            rb = b.e[0] * AbsR[0][2] + b.e[2] * AbsR[0][0];
            if (Math.abs(t[2] * R[1][1] - t[1] * R[2][1]) > ra + rb)
                return false;
            ra = a.e[1] * AbsR[2][2] + a.e[2] * AbsR[1][2];
            rb = b.e[0] * AbsR[0][1] + b.e[1] * AbsR[0][0];
            if (Math.abs(t[2] * R[1][2] - t[1] * R[2][2]) > ra + rb)
                return false;
            ra = a.e[0] * AbsR[2][0] + a.e[2] * AbsR[0][0];
            rb = b.e[1] * AbsR[1][2] + b.e[2] * AbsR[1][1];
            if (Math.abs(t[0] * R[2][0] - t[2] * R[0][0]) > ra + rb)
                return false;
            ra = a.e[0] * AbsR[2][1] + a.e[2] * AbsR[0][1];
            rb = b.e[0] * AbsR[1][2] + b.e[2] * AbsR[1][0];
            if (Math.abs(t[0] * R[2][1] - t[2] * R[0][1]) > ra + rb)
                return false;
            ra = a.e[0] * AbsR[2][2] + a.e[2] * AbsR[0][2];
            rb = b.e[0] * AbsR[1][1] + b.e[1] * AbsR[1][0];
            if (Math.abs(t[0] * R[2][2] - t[2] * R[0][2]) > ra + rb)
                return false;
            ra = a.e[0] * AbsR[1][0] + a.e[1] * AbsR[0][0];
            rb = b.e[1] * AbsR[2][2] + b.e[2] * AbsR[2][1];
            if (Math.abs(t[1] * R[0][0] - t[0] * R[1][0]) > ra + rb)
                return false;
            ra = a.e[0] * AbsR[1][1] + a.e[1] * AbsR[0][1];
            rb = b.e[0] * AbsR[2][2] + b.e[2] * AbsR[2][0];
            if (Math.abs(t[1] * R[0][1] - t[0] * R[1][1]) > ra + rb)
                return false;
            ra = a.e[0] * AbsR[1][2] + a.e[1] * AbsR[0][2];
            rb = b.e[0] * AbsR[2][1] + b.e[1] * AbsR[2][0];
            if (Math.abs(t[1] * R[0][2] - t[0] * R[1][2]) > ra + rb)
                return false;
            return true;
        },
        intersectsPlane: function (plane) {
            this.rotation.extractBasis(xAxis, yAxis, zAxis);
            const r = this.halfSize.x * Math.abs(plane.normal.dot(xAxis)) + this.halfSize.y * Math.abs(plane.normal.dot(yAxis)) + this.halfSize.z * Math.abs(plane.normal.dot(zAxis));
            const d = plane.normal.dot(this.center) - plane.constant;
            return Math.abs(d) <= r;
        },
        intersectRay: function (ray, result) {
            this.getSize(size);
            aabb.setFromCenterAndSize(v1.set(0, 0, 0), size);
            matrix4FromRotationMatrix(matrix, this.rotation);
            matrix.setPosition(this.center);
            localRay.copy(ray).applyMatrix4(inverse.getInverse(matrix));
            if (localRay.intersectBox(aabb, result)) {
                return result.applyMatrix4(matrix);
            } else {
                return null;
            }
        },
        intersectsRay: function (ray) {
            return this.intersectRay(ray, v1) !== null;
        },
        fromBox3: function (box3) {
            box3.getCenter(this.center);
            box3.getSize(this.halfSize).multiplyScalar(0.5);
            this.rotation.identity();
            return this;
        },
        equals: function (obb) {
            return obb.center.equals(this.center) && obb.halfSize.equals(this.halfSize) && obb.rotation.equals(this.rotation);
        },
        applyMatrix4: function (matrix) {
            var e = matrix.elements;
            var sx = v1.set(e[0], e[1], e[2]).length();
            var sy = v1.set(e[4], e[5], e[6]).length();
            var sz = v1.set(e[8], e[9], e[10]).length();
            var det = matrix.determinant();
            if (det < 0)
                sx = -sx;
            rotationMatrix.setFromMatrix4(matrix);
            var invSX = 1 / sx;
            var invSY = 1 / sy;
            var invSZ = 1 / sz;
            rotationMatrix.elements[0] *= invSX;
            rotationMatrix.elements[1] *= invSX;
            rotationMatrix.elements[2] *= invSX;
            rotationMatrix.elements[3] *= invSY;
            rotationMatrix.elements[4] *= invSY;
            rotationMatrix.elements[5] *= invSY;
            rotationMatrix.elements[6] *= invSZ;
            rotationMatrix.elements[7] *= invSZ;
            rotationMatrix.elements[8] *= invSZ;
            this.rotation.multiply(rotationMatrix);
            this.halfSize.x *= sx;
            this.halfSize.y *= sy;
            this.halfSize.z *= sz;
            v1.setFromMatrixPosition(matrix);
            this.center.add(v1);
            return this;
        }
    });
    function matrix4FromRotationMatrix(matrix4, matrix3) {
        var e = matrix4.elements;
        var me = matrix3.elements;
        e[0] = me[0];
        e[1] = me[1];
        e[2] = me[2];
        e[3] = 0;
        e[4] = me[3];
        e[5] = me[4];
        e[6] = me[5];
        e[7] = 0;
        e[8] = me[6];
        e[9] = me[7];
        e[10] = me[8];
        e[11] = 0;
        e[12] = 0;
        e[13] = 0;
        e[14] = 0;
        e[15] = 1;
    }
    var obb = new OBB();

    
    return threex.math.OBB = OBB;
});
define('skylark-threejs-ex/misc/ConvexObjectBreaker',[
    "skylark-threejs",
    "../threex",
    '../geometries/ConvexGeometry'
], function (
    THREE, 
    threex,
    ConvexGeometry
) {
    'use strict';
    var ConvexObjectBreaker = function (minSizeForBreak, smallDelta) {
        this.minSizeForBreak = minSizeForBreak || 1.4;
        this.smallDelta = smallDelta || 0.0001;
        this.tempLine1 = new THREE.Line3();
        this.tempPlane1 = new THREE.Plane();
        this.tempPlane2 = new THREE.Plane();
        this.tempPlane_Cut = new THREE.Plane();
        this.tempCM1 = new THREE.Vector3();
        this.tempCM2 = new THREE.Vector3();
        this.tempVector3 = new THREE.Vector3();
        this.tempVector3_2 = new THREE.Vector3();
        this.tempVector3_3 = new THREE.Vector3();
        this.tempVector3_P0 = new THREE.Vector3();
        this.tempVector3_P1 = new THREE.Vector3();
        this.tempVector3_P2 = new THREE.Vector3();
        this.tempVector3_N0 = new THREE.Vector3();
        this.tempVector3_N1 = new THREE.Vector3();
        this.tempVector3_AB = new THREE.Vector3();
        this.tempVector3_CB = new THREE.Vector3();
        this.tempResultObjects = {
            object1: null,
            object2: null
        };
        this.segments = [];
        var n = 30 * 30;
        for (var i = 0; i < n; i++)
            this.segments[i] = false;
    };
    ConvexObjectBreaker.prototype = {
        constructor: ConvexObjectBreaker,
        prepareBreakableObject: function (object, mass, velocity, angularVelocity, breakable) {
            if (!object.geometry.isBufferGeometry) {
                console.error('THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry.');
            }
            var userData = object.userData;
            userData.mass = mass;
            userData.velocity = velocity.clone();
            userData.angularVelocity = angularVelocity.clone();
            userData.breakable = breakable;
        },
        subdivideByImpact: function (object, pointOfImpact, normal, maxRadialIterations, maxRandomIterations) {
            var debris = [];
            var tempPlane1 = this.tempPlane1;
            var tempPlane2 = this.tempPlane2;
            this.tempVector3.addVectors(pointOfImpact, normal);
            tempPlane1.setFromCoplanarPoints(pointOfImpact, object.position, this.tempVector3);
            var maxTotalIterations = maxRandomIterations + maxRadialIterations;
            var scope = this;
            function subdivideRadial(subObject, startAngle, endAngle, numIterations) {
                if (Math.random() < numIterations * 0.05 || numIterations > maxTotalIterations) {
                    debris.push(subObject);
                    return;
                }
                var angle = Math.PI;
                if (numIterations === 0) {
                    tempPlane2.normal.copy(tempPlane1.normal);
                    tempPlane2.constant = tempPlane1.constant;
                } else {
                    if (numIterations <= maxRadialIterations) {
                        angle = (endAngle - startAngle) * (0.2 + 0.6 * Math.random()) + startAngle;
                        scope.tempVector3_2.copy(object.position).sub(pointOfImpact).applyAxisAngle(normal, angle).add(pointOfImpact);
                        tempPlane2.setFromCoplanarPoints(pointOfImpact, scope.tempVector3, scope.tempVector3_2);
                    } else {
                        angle = (0.5 * (numIterations & 1) + 0.2 * (2 - Math.random())) * Math.PI;
                        scope.tempVector3_2.copy(pointOfImpact).sub(subObject.position).applyAxisAngle(normal, angle).add(subObject.position);
                        scope.tempVector3_3.copy(normal).add(subObject.position);
                        tempPlane2.setFromCoplanarPoints(subObject.position, scope.tempVector3_3, scope.tempVector3_2);
                    }
                }
                scope.cutByPlane(subObject, tempPlane2, scope.tempResultObjects);
                var obj1 = scope.tempResultObjects.object1;
                var obj2 = scope.tempResultObjects.object2;
                if (obj1) {
                    subdivideRadial(obj1, startAngle, angle, numIterations + 1);
                }
                if (obj2) {
                    subdivideRadial(obj2, angle, endAngle, numIterations + 1);
                }
            }
            subdivideRadial(object, 0, 2 * Math.PI, 0);
            return debris;
        },
        cutByPlane: function (object, plane, output) {
            var geometry = object.geometry;
            var coords = geometry.attributes.position.array;
            var normals = geometry.attributes.normal.array;
            var numPoints = coords.length / 3;
            var numFaces = numPoints / 3;
            var indices = geometry.getIndex();
            if (indices) {
                indices = indices.array;
                numFaces = indices.length / 3;
            }
            function getVertexIndex(faceIdx, vert) {
                var idx = faceIdx * 3 + vert;
                return indices ? indices[idx] : idx;
            }
            var points1 = [];
            var points2 = [];
            var delta = this.smallDelta;
            var numPointPairs = numPoints * numPoints;
            for (var i = 0; i < numPointPairs; i++)
                this.segments[i] = false;
            var p0 = this.tempVector3_P0;
            var p1 = this.tempVector3_P1;
            var n0 = this.tempVector3_N0;
            var n1 = this.tempVector3_N1;
            for (var i = 0; i < numFaces - 1; i++) {
                var a1 = getVertexIndex(i, 0);
                var b1 = getVertexIndex(i, 1);
                var c1 = getVertexIndex(i, 2);
                n0.set(normals[a1], normals[a1] + 1, normals[a1] + 2);
                for (var j = i + 1; j < numFaces; j++) {
                    var a2 = getVertexIndex(j, 0);
                    var b2 = getVertexIndex(j, 1);
                    var c2 = getVertexIndex(j, 2);
                    n1.set(normals[a2], normals[a2] + 1, normals[a2] + 2);
                    var coplanar = 1 - n0.dot(n1) < delta;
                    if (coplanar) {
                        if (a1 === a2 || a1 === b2 || a1 === c2) {
                            if (b1 === a2 || b1 === b2 || b1 === c2) {
                                this.segments[a1 * numPoints + b1] = true;
                                this.segments[b1 * numPoints + a1] = true;
                            } else {
                                this.segments[c1 * numPoints + a1] = true;
                                this.segments[a1 * numPoints + c1] = true;
                            }
                        } else if (b1 === a2 || b1 === b2 || b1 === c2) {
                            this.segments[c1 * numPoints + b1] = true;
                            this.segments[b1 * numPoints + c1] = true;
                        }
                    }
                }
            }
            var localPlane = this.tempPlane_Cut;
            object.updateMatrix();
            ConvexObjectBreaker.transformPlaneToLocalSpace(plane, object.matrix, localPlane);
            for (var i = 0; i < numFaces; i++) {
                var va = getVertexIndex(i, 0);
                var vb = getVertexIndex(i, 1);
                var vc = getVertexIndex(i, 2);
                for (var segment = 0; segment < 3; segment++) {
                    var i0 = segment === 0 ? va : segment === 1 ? vb : vc;
                    var i1 = segment === 0 ? vb : segment === 1 ? vc : va;
                    var segmentState = this.segments[i0 * numPoints + i1];
                    if (segmentState)
                        continue;
                    this.segments[i0 * numPoints + i1] = true;
                    this.segments[i1 * numPoints + i0] = true;
                    p0.set(coords[3 * i0], coords[3 * i0 + 1], coords[3 * i0 + 2]);
                    p1.set(coords[3 * i1], coords[3 * i1 + 1], coords[3 * i1 + 2]);
                    var mark0 = 0;
                    var d = localPlane.distanceToPoint(p0);
                    if (d > delta) {
                        mark0 = 2;
                        points2.push(p0.clone());
                    } else if (d < -delta) {
                        mark0 = 1;
                        points1.push(p0.clone());
                    } else {
                        mark0 = 3;
                        points1.push(p0.clone());
                        points2.push(p0.clone());
                    }
                    var mark1 = 0;
                    var d = localPlane.distanceToPoint(p1);
                    if (d > delta) {
                        mark1 = 2;
                        points2.push(p1.clone());
                    } else if (d < -delta) {
                        mark1 = 1;
                        points1.push(p1.clone());
                    } else {
                        mark1 = 3;
                        points1.push(p1.clone());
                        points2.push(p1.clone());
                    }
                    if (mark0 === 1 && mark1 === 2 || mark0 === 2 && mark1 === 1) {
                        this.tempLine1.start.copy(p0);
                        this.tempLine1.end.copy(p1);
                        var intersection = new THREE.Vector3();
                        intersection = localPlane.intersectLine(this.tempLine1, intersection);
                        if (intersection === undefined) {
                            console.error('Internal error: segment does not intersect plane.');
                            output.segmentedObject1 = null;
                            output.segmentedObject2 = null;
                            return 0;
                        }
                        points1.push(intersection);
                        points2.push(intersection.clone());
                    }
                }
            }
            var newMass = object.userData.mass * 0.5;
            this.tempCM1.set(0, 0, 0);
            var radius1 = 0;
            var numPoints1 = points1.length;
            if (numPoints1 > 0) {
                for (var i = 0; i < numPoints1; i++)
                    this.tempCM1.add(points1[i]);
                this.tempCM1.divideScalar(numPoints1);
                for (var i = 0; i < numPoints1; i++) {
                    var p = points1[i];
                    p.sub(this.tempCM1);
                    radius1 = Math.max(radius1, p.x, p.y, p.z);
                }
                this.tempCM1.add(object.position);
            }
            this.tempCM2.set(0, 0, 0);
            var radius2 = 0;
            var numPoints2 = points2.length;
            if (numPoints2 > 0) {
                for (var i = 0; i < numPoints2; i++)
                    this.tempCM2.add(points2[i]);
                this.tempCM2.divideScalar(numPoints2);
                for (var i = 0; i < numPoints2; i++) {
                    var p = points2[i];
                    p.sub(this.tempCM2);
                    radius2 = Math.max(radius2, p.x, p.y, p.z);
                }
                this.tempCM2.add(object.position);
            }
            var object1 = null;
            var object2 = null;
            var numObjects = 0;
            if (numPoints1 > 4) {
                object1 = new THREE.Mesh(new ConvexBufferGeometry(points1), object.material);
                object1.position.copy(this.tempCM1);
                object1.quaternion.copy(object.quaternion);
                this.prepareBreakableObject(object1, newMass, object.userData.velocity, object.userData.angularVelocity, 2 * radius1 > this.minSizeForBreak);
                numObjects++;
            }
            if (numPoints2 > 4) {
                object2 = new THREE.Mesh(new ConvexBufferGeometry(points2), object.material);
                object2.position.copy(this.tempCM2);
                object2.quaternion.copy(object.quaternion);
                this.prepareBreakableObject(object2, newMass, object.userData.velocity, object.userData.angularVelocity, 2 * radius2 > this.minSizeForBreak);
                numObjects++;
            }
            output.object1 = object1;
            output.object2 = object2;
            return numObjects;
        }
    };
    ConvexObjectBreaker.transformFreeVector = function (v, m) {
        var x = v.x, y = v.y, z = v.z;
        var e = m.elements;
        v.x = e[0] * x + e[4] * y + e[8] * z;
        v.y = e[1] * x + e[5] * y + e[9] * z;
        v.z = e[2] * x + e[6] * y + e[10] * z;
        return v;
    };
    ConvexObjectBreaker.transformFreeVectorInverse = function (v, m) {
        var x = v.x, y = v.y, z = v.z;
        var e = m.elements;
        v.x = e[0] * x + e[1] * y + e[2] * z;
        v.y = e[4] * x + e[5] * y + e[6] * z;
        v.z = e[8] * x + e[9] * y + e[10] * z;
        return v;
    };
    ConvexObjectBreaker.transformTiedVectorInverse = function (v, m) {
        var x = v.x, y = v.y, z = v.z;
        var e = m.elements;
        v.x = e[0] * x + e[1] * y + e[2] * z - e[12];
        v.y = e[4] * x + e[5] * y + e[6] * z - e[13];
        v.z = e[8] * x + e[9] * y + e[10] * z - e[14];
        return v;
    };
    ConvexObjectBreaker.transformPlaneToLocalSpace = function () {
        var v1 = new THREE.Vector3();
        return function transformPlaneToLocalSpace(plane, m, resultPlane) {
            resultPlane.normal.copy(plane.normal);
            resultPlane.constant = plane.constant;
            var referencePoint = ConvexObjectBreaker.transformTiedVectorInverse(plane.coplanarPoint(v1), m);
            ConvexObjectBreaker.transformFreeVectorInverse(resultPlane.normal, m);
            resultPlane.constant = -referencePoint.dot(resultPlane.normal);
        };
    }();

    return threex.misc.ConvexObjectBreaker = ConvexObjectBreaker;
});
define('skylark-threejs-ex/misc/GPUComputationRenderer',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var GPUComputationRenderer = function (sizeX, sizeY, renderer) {
        this.variables = [];
        this.currentTextureIndex = 0;
        var scene = new THREE.Scene();
        var camera = new THREE.Camera();
        camera.position.z = 1;
        var passThruUniforms = { passThruTexture: { value: null } };
        var passThruShader = createShaderMaterial(getPassThroughFragmentShader(), passThruUniforms);
        var mesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), passThruShader);
        scene.add(mesh);
        this.addVariable = function (variableName, computeFragmentShader, initialValueTexture) {
            var material = this.createShaderMaterial(computeFragmentShader);
            var variable = {
                name: variableName,
                initialValueTexture: initialValueTexture,
                material: material,
                dependencies: null,
                renderTargets: [],
                wrapS: null,
                wrapT: null,
                minFilter: THREE.NearestFilter,
                magFilter: THREE.NearestFilter
            };
            this.variables.push(variable);
            return variable;
        };
        this.setVariableDependencies = function (variable, dependencies) {
            variable.dependencies = dependencies;
        };
        this.init = function () {
            if (!renderer.capabilities.isWebGL2 && !renderer.extensions.get('OES_texture_float')) {
                return 'No OES_texture_float support for float textures.';
            }
            if (renderer.capabilities.maxVertexTextures === 0) {
                return 'No support for vertex shader textures.';
            }
            for (var i = 0; i < this.variables.length; i++) {
                var variable = this.variables[i];
                variable.renderTargets[0] = this.createRenderTarget(sizeX, sizeY, variable.wrapS, variable.wrapT, variable.minFilter, variable.magFilter);
                variable.renderTargets[1] = this.createRenderTarget(sizeX, sizeY, variable.wrapS, variable.wrapT, variable.minFilter, variable.magFilter);
                this.renderTexture(variable.initialValueTexture, variable.renderTargets[0]);
                this.renderTexture(variable.initialValueTexture, variable.renderTargets[1]);
                var material = variable.material;
                var uniforms = material.uniforms;
                if (variable.dependencies !== null) {
                    for (var d = 0; d < variable.dependencies.length; d++) {
                        var depVar = variable.dependencies[d];
                        if (depVar.name !== variable.name) {
                            var found = false;
                            for (var j = 0; j < this.variables.length; j++) {
                                if (depVar.name === this.variables[j].name) {
                                    found = true;
                                    break;
                                }
                            }
                            if (!found) {
                                return 'Variable dependency not found. Variable=' + variable.name + ', dependency=' + depVar.name;
                            }
                        }
                        uniforms[depVar.name] = { value: null };
                        material.fragmentShader = '\nuniform sampler2D ' + depVar.name + ';\n' + material.fragmentShader;
                    }
                }
            }
            this.currentTextureIndex = 0;
            return null;
        };
        this.compute = function () {
            var currentTextureIndex = this.currentTextureIndex;
            var nextTextureIndex = this.currentTextureIndex === 0 ? 1 : 0;
            for (var i = 0, il = this.variables.length; i < il; i++) {
                var variable = this.variables[i];
                if (variable.dependencies !== null) {
                    var uniforms = variable.material.uniforms;
                    for (var d = 0, dl = variable.dependencies.length; d < dl; d++) {
                        var depVar = variable.dependencies[d];
                        uniforms[depVar.name].value = depVar.renderTargets[currentTextureIndex].texture;
                    }
                }
                this.doRenderTarget(variable.material, variable.renderTargets[nextTextureIndex]);
            }
            this.currentTextureIndex = nextTextureIndex;
        };
        this.getCurrentRenderTarget = function (variable) {
            return variable.renderTargets[this.currentTextureIndex];
        };
        this.getAlternateRenderTarget = function (variable) {
            return variable.renderTargets[this.currentTextureIndex === 0 ? 1 : 0];
        };
        function addResolutionDefine(materialShader) {
            materialShader.defines.resolution = 'vec2( ' + sizeX.toFixed(1) + ', ' + sizeY.toFixed(1) + ' )';
        }
        this.addResolutionDefine = addResolutionDefine;
        function createShaderMaterial(computeFragmentShader, uniforms) {
            uniforms = uniforms || {};
            var material = new THREE.ShaderMaterial({
                uniforms: uniforms,
                vertexShader: getPassThroughVertexShader(),
                fragmentShader: computeFragmentShader
            });
            addResolutionDefine(material);
            return material;
        }
        this.createShaderMaterial = createShaderMaterial;
        this.createRenderTarget = function (sizeXTexture, sizeYTexture, wrapS, wrapT, minFilter, magFilter) {
            sizeXTexture = sizeXTexture || sizeX;
            sizeYTexture = sizeYTexture || sizeY;
            wrapS = wrapS || THREE.ClampToEdgeWrapping;
            wrapT = wrapT || THREE.ClampToEdgeWrapping;
            minFilter = minFilter || THREE.NearestFilter;
            magFilter = magFilter || THREE.NearestFilter;
            var renderTarget = new THREE.WebGLRenderTarget(sizeXTexture, sizeYTexture, {
                wrapS: wrapS,
                wrapT: wrapT,
                minFilter: minFilter,
                magFilter: magFilter,
                format: THREE.RGBAFormat,
                type: /(iPad|iPhone|iPod)/g.test(navigator.userAgent) ? THREE.HalfFloatType : THREE.FloatType,
                stencilBuffer: false,
                depthBuffer: false
            });
            return renderTarget;
        };
        this.createTexture = function () {
            var data = new Float32Array(sizeX * sizeY * 4);
            return new THREE.DataTexture(data, sizeX, sizeY, THREE.RGBAFormat, THREE.FloatType);
        };
        this.renderTexture = function (input, output) {
            passThruUniforms.passThruTexture.value = input;
            this.doRenderTarget(passThruShader, output);
            passThruUniforms.passThruTexture.value = null;
        };
        this.doRenderTarget = function (material, output) {
            var currentRenderTarget = renderer.getRenderTarget();
            mesh.material = material;
            renderer.setRenderTarget(output);
            renderer.render(scene, camera);
            mesh.material = passThruShader;
            renderer.setRenderTarget(currentRenderTarget);
        };
        function getPassThroughVertexShader() {
            return 'void main()\t{\n' + '\n' + '\tgl_Position = vec4( position, 1.0 );\n' + '\n' + '}\n';
        }
        function getPassThroughFragmentShader() {
            return 'uniform sampler2D passThruTexture;\n' + '\n' + 'void main() {\n' + '\n' + '\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n' + '\n' + '\tgl_FragColor = texture2D( passThruTexture, uv );\n' + '\n' + '}\n';
        }
    };

    return threex.misc.GPUComputationRenderer = GPUComputationRenderer;
});
define('skylark-threejs-ex/misc/Gyroscope',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var Gyroscope = function () {
        THREE.Object3D.call(this);
    };
    Gyroscope.prototype = Object.create(THREE.Object3D.prototype);
    Gyroscope.prototype.constructor = Gyroscope;
    Gyroscope.prototype.updateMatrixWorld = function () {
        var translationObject = new THREE.Vector3();
        var quaternionObject = new THREE.Quaternion();
        var scaleObject = new THREE.Vector3();
        var translationWorld = new THREE.Vector3();
        var quaternionWorld = new THREE.Quaternion();
        var scaleWorld = new THREE.Vector3();
        return function updateMatrixWorld(force) {
            this.matrixAutoUpdate && this.updateMatrix();
            if (this.matrixWorldNeedsUpdate || force) {
                if (this.parent !== null) {
                    this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);
                    this.matrixWorld.decompose(translationWorld, quaternionWorld, scaleWorld);
                    this.matrix.decompose(translationObject, quaternionObject, scaleObject);
                    this.matrixWorld.compose(translationWorld, quaternionObject, scaleWorld);
                } else {
                    this.matrixWorld.copy(this.matrix);
                }
                this.matrixWorldNeedsUpdate = false;
                force = true;
            }
            for (var i = 0, l = this.children.length; i < l; i++) {
                this.children[i].updateMatrixWorld(force);
            }
        };
    }();

    return threex.misc.Gyroscope = Gyroscope;
});
define('skylark-threejs-ex/loaders/MD2Loader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var MD2Loader = function (manager) {
        THREE.Loader.call(this, manager);
    };
    MD2Loader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {
        constructor: MD2Loader,
        load: function (url, onLoad, onProgress, onError) {
            var scope = this;
            var loader = new THREE.FileLoader(scope.manager);
            loader.setPath(scope.path);
            loader.setResponseType('arraybuffer');
            loader.load(url, function (buffer) {
                onLoad(scope.parse(buffer));
            }, onProgress, onError);
        },
        parse: function () {
            var normalData = [
                [
                    -0.525731,
                    0,
                    0.850651
                ],
                [
                    -0.442863,
                    0.238856,
                    0.864188
                ],
                [
                    -0.295242,
                    0,
                    0.955423
                ],
                [
                    -0.309017,
                    0.5,
                    0.809017
                ],
                [
                    -0.16246,
                    0.262866,
                    0.951056
                ],
                [
                    0,
                    0,
                    1
                ],
                [
                    0,
                    0.850651,
                    0.525731
                ],
                [
                    -0.147621,
                    0.716567,
                    0.681718
                ],
                [
                    0.147621,
                    0.716567,
                    0.681718
                ],
                [
                    0,
                    0.525731,
                    0.850651
                ],
                [
                    0.309017,
                    0.5,
                    0.809017
                ],
                [
                    0.525731,
                    0,
                    0.850651
                ],
                [
                    0.295242,
                    0,
                    0.955423
                ],
                [
                    0.442863,
                    0.238856,
                    0.864188
                ],
                [
                    0.16246,
                    0.262866,
                    0.951056
                ],
                [
                    -0.681718,
                    0.147621,
                    0.716567
                ],
                [
                    -0.809017,
                    0.309017,
                    0.5
                ],
                [
                    -0.587785,
                    0.425325,
                    0.688191
                ],
                [
                    -0.850651,
                    0.525731,
                    0
                ],
                [
                    -0.864188,
                    0.442863,
                    0.238856
                ],
                [
                    -0.716567,
                    0.681718,
                    0.147621
                ],
                [
                    -0.688191,
                    0.587785,
                    0.425325
                ],
                [
                    -0.5,
                    0.809017,
                    0.309017
                ],
                [
                    -0.238856,
                    0.864188,
                    0.442863
                ],
                [
                    -0.425325,
                    0.688191,
                    0.587785
                ],
                [
                    -0.716567,
                    0.681718,
                    -0.147621
                ],
                [
                    -0.5,
                    0.809017,
                    -0.309017
                ],
                [
                    -0.525731,
                    0.850651,
                    0
                ],
                [
                    0,
                    0.850651,
                    -0.525731
                ],
                [
                    -0.238856,
                    0.864188,
                    -0.442863
                ],
                [
                    0,
                    0.955423,
                    -0.295242
                ],
                [
                    -0.262866,
                    0.951056,
                    -0.16246
                ],
                [
                    0,
                    1,
                    0
                ],
                [
                    0,
                    0.955423,
                    0.295242
                ],
                [
                    -0.262866,
                    0.951056,
                    0.16246
                ],
                [
                    0.238856,
                    0.864188,
                    0.442863
                ],
                [
                    0.262866,
                    0.951056,
                    0.16246
                ],
                [
                    0.5,
                    0.809017,
                    0.309017
                ],
                [
                    0.238856,
                    0.864188,
                    -0.442863
                ],
                [
                    0.262866,
                    0.951056,
                    -0.16246
                ],
                [
                    0.5,
                    0.809017,
                    -0.309017
                ],
                [
                    0.850651,
                    0.525731,
                    0
                ],
                [
                    0.716567,
                    0.681718,
                    0.147621
                ],
                [
                    0.716567,
                    0.681718,
                    -0.147621
                ],
                [
                    0.525731,
                    0.850651,
                    0
                ],
                [
                    0.425325,
                    0.688191,
                    0.587785
                ],
                [
                    0.864188,
                    0.442863,
                    0.238856
                ],
                [
                    0.688191,
                    0.587785,
                    0.425325
                ],
                [
                    0.809017,
                    0.309017,
                    0.5
                ],
                [
                    0.681718,
                    0.147621,
                    0.716567
                ],
                [
                    0.587785,
                    0.425325,
                    0.688191
                ],
                [
                    0.955423,
                    0.295242,
                    0
                ],
                [
                    1,
                    0,
                    0
                ],
                [
                    0.951056,
                    0.16246,
                    0.262866
                ],
                [
                    0.850651,
                    -0.525731,
                    0
                ],
                [
                    0.955423,
                    -0.295242,
                    0
                ],
                [
                    0.864188,
                    -0.442863,
                    0.238856
                ],
                [
                    0.951056,
                    -0.16246,
                    0.262866
                ],
                [
                    0.809017,
                    -0.309017,
                    0.5
                ],
                [
                    0.681718,
                    -0.147621,
                    0.716567
                ],
                [
                    0.850651,
                    0,
                    0.525731
                ],
                [
                    0.864188,
                    0.442863,
                    -0.238856
                ],
                [
                    0.809017,
                    0.309017,
                    -0.5
                ],
                [
                    0.951056,
                    0.16246,
                    -0.262866
                ],
                [
                    0.525731,
                    0,
                    -0.850651
                ],
                [
                    0.681718,
                    0.147621,
                    -0.716567
                ],
                [
                    0.681718,
                    -0.147621,
                    -0.716567
                ],
                [
                    0.850651,
                    0,
                    -0.525731
                ],
                [
                    0.809017,
                    -0.309017,
                    -0.5
                ],
                [
                    0.864188,
                    -0.442863,
                    -0.238856
                ],
                [
                    0.951056,
                    -0.16246,
                    -0.262866
                ],
                [
                    0.147621,
                    0.716567,
                    -0.681718
                ],
                [
                    0.309017,
                    0.5,
                    -0.809017
                ],
                [
                    0.425325,
                    0.688191,
                    -0.587785
                ],
                [
                    0.442863,
                    0.238856,
                    -0.864188
                ],
                [
                    0.587785,
                    0.425325,
                    -0.688191
                ],
                [
                    0.688191,
                    0.587785,
                    -0.425325
                ],
                [
                    -0.147621,
                    0.716567,
                    -0.681718
                ],
                [
                    -0.309017,
                    0.5,
                    -0.809017
                ],
                [
                    0,
                    0.525731,
                    -0.850651
                ],
                [
                    -0.525731,
                    0,
                    -0.850651
                ],
                [
                    -0.442863,
                    0.238856,
                    -0.864188
                ],
                [
                    -0.295242,
                    0,
                    -0.955423
                ],
                [
                    -0.16246,
                    0.262866,
                    -0.951056
                ],
                [
                    0,
                    0,
                    -1
                ],
                [
                    0.295242,
                    0,
                    -0.955423
                ],
                [
                    0.16246,
                    0.262866,
                    -0.951056
                ],
                [
                    -0.442863,
                    -0.238856,
                    -0.864188
                ],
                [
                    -0.309017,
                    -0.5,
                    -0.809017
                ],
                [
                    -0.16246,
                    -0.262866,
                    -0.951056
                ],
                [
                    0,
                    -0.850651,
                    -0.525731
                ],
                [
                    -0.147621,
                    -0.716567,
                    -0.681718
                ],
                [
                    0.147621,
                    -0.716567,
                    -0.681718
                ],
                [
                    0,
                    -0.525731,
                    -0.850651
                ],
                [
                    0.309017,
                    -0.5,
                    -0.809017
                ],
                [
                    0.442863,
                    -0.238856,
                    -0.864188
                ],
                [
                    0.16246,
                    -0.262866,
                    -0.951056
                ],
                [
                    0.238856,
                    -0.864188,
                    -0.442863
                ],
                [
                    0.5,
                    -0.809017,
                    -0.309017
                ],
                [
                    0.425325,
                    -0.688191,
                    -0.587785
                ],
                [
                    0.716567,
                    -0.681718,
                    -0.147621
                ],
                [
                    0.688191,
                    -0.587785,
                    -0.425325
                ],
                [
                    0.587785,
                    -0.425325,
                    -0.688191
                ],
                [
                    0,
                    -0.955423,
                    -0.295242
                ],
                [
                    0,
                    -1,
                    0
                ],
                [
                    0.262866,
                    -0.951056,
                    -0.16246
                ],
                [
                    0,
                    -0.850651,
                    0.525731
                ],
                [
                    0,
                    -0.955423,
                    0.295242
                ],
                [
                    0.238856,
                    -0.864188,
                    0.442863
                ],
                [
                    0.262866,
                    -0.951056,
                    0.16246
                ],
                [
                    0.5,
                    -0.809017,
                    0.309017
                ],
                [
                    0.716567,
                    -0.681718,
                    0.147621
                ],
                [
                    0.525731,
                    -0.850651,
                    0
                ],
                [
                    -0.238856,
                    -0.864188,
                    -0.442863
                ],
                [
                    -0.5,
                    -0.809017,
                    -0.309017
                ],
                [
                    -0.262866,
                    -0.951056,
                    -0.16246
                ],
                [
                    -0.850651,
                    -0.525731,
                    0
                ],
                [
                    -0.716567,
                    -0.681718,
                    -0.147621
                ],
                [
                    -0.716567,
                    -0.681718,
                    0.147621
                ],
                [
                    -0.525731,
                    -0.850651,
                    0
                ],
                [
                    -0.5,
                    -0.809017,
                    0.309017
                ],
                [
                    -0.238856,
                    -0.864188,
                    0.442863
                ],
                [
                    -0.262866,
                    -0.951056,
                    0.16246
                ],
                [
                    -0.864188,
                    -0.442863,
                    0.238856
                ],
                [
                    -0.809017,
                    -0.309017,
                    0.5
                ],
                [
                    -0.688191,
                    -0.587785,
                    0.425325
                ],
                [
                    -0.681718,
                    -0.147621,
                    0.716567
                ],
                [
                    -0.442863,
                    -0.238856,
                    0.864188
                ],
                [
                    -0.587785,
                    -0.425325,
                    0.688191
                ],
                [
                    -0.309017,
                    -0.5,
                    0.809017
                ],
                [
                    -0.147621,
                    -0.716567,
                    0.681718
                ],
                [
                    -0.425325,
                    -0.688191,
                    0.587785
                ],
                [
                    -0.16246,
                    -0.262866,
                    0.951056
                ],
                [
                    0.442863,
                    -0.238856,
                    0.864188
                ],
                [
                    0.16246,
                    -0.262866,
                    0.951056
                ],
                [
                    0.309017,
                    -0.5,
                    0.809017
                ],
                [
                    0.147621,
                    -0.716567,
                    0.681718
                ],
                [
                    0,
                    -0.525731,
                    0.850651
                ],
                [
                    0.425325,
                    -0.688191,
                    0.587785
                ],
                [
                    0.587785,
                    -0.425325,
                    0.688191
                ],
                [
                    0.688191,
                    -0.587785,
                    0.425325
                ],
                [
                    -0.955423,
                    0.295242,
                    0
                ],
                [
                    -0.951056,
                    0.16246,
                    0.262866
                ],
                [
                    -1,
                    0,
                    0
                ],
                [
                    -0.850651,
                    0,
                    0.525731
                ],
                [
                    -0.955423,
                    -0.295242,
                    0
                ],
                [
                    -0.951056,
                    -0.16246,
                    0.262866
                ],
                [
                    -0.864188,
                    0.442863,
                    -0.238856
                ],
                [
                    -0.951056,
                    0.16246,
                    -0.262866
                ],
                [
                    -0.809017,
                    0.309017,
                    -0.5
                ],
                [
                    -0.864188,
                    -0.442863,
                    -0.238856
                ],
                [
                    -0.951056,
                    -0.16246,
                    -0.262866
                ],
                [
                    -0.809017,
                    -0.309017,
                    -0.5
                ],
                [
                    -0.681718,
                    0.147621,
                    -0.716567
                ],
                [
                    -0.681718,
                    -0.147621,
                    -0.716567
                ],
                [
                    -0.850651,
                    0,
                    -0.525731
                ],
                [
                    -0.688191,
                    0.587785,
                    -0.425325
                ],
                [
                    -0.587785,
                    0.425325,
                    -0.688191
                ],
                [
                    -0.425325,
                    0.688191,
                    -0.587785
                ],
                [
                    -0.425325,
                    -0.688191,
                    -0.587785
                ],
                [
                    -0.587785,
                    -0.425325,
                    -0.688191
                ],
                [
                    -0.688191,
                    -0.587785,
                    -0.425325
                ]
            ];
            return function (buffer) {
                var data = new DataView(buffer);
                var header = {};
                var headerNames = [
                    'ident',
                    'version',
                    'skinwidth',
                    'skinheight',
                    'framesize',
                    'num_skins',
                    'num_vertices',
                    'num_st',
                    'num_tris',
                    'num_glcmds',
                    'num_frames',
                    'offset_skins',
                    'offset_st',
                    'offset_tris',
                    'offset_frames',
                    'offset_glcmds',
                    'offset_end'
                ];
                for (var i = 0; i < headerNames.length; i++) {
                    header[headerNames[i]] = data.getInt32(i * 4, true);
                }
                if (header.ident !== 844121161 || header.version !== 8) {
                    console.error('Not a valid MD2 file');
                    return;
                }
                if (header.offset_end !== data.byteLength) {
                    console.error('Corrupted MD2 file');
                    return;
                }
                var geometry = new THREE.BufferGeometry();
                var uvsTemp = [];
                var offset = header.offset_st;
                for (var i = 0, l = header.num_st; i < l; i++) {
                    var u = data.getInt16(offset + 0, true);
                    var v = data.getInt16(offset + 2, true);
                    uvsTemp.push(u / header.skinwidth, 1 - v / header.skinheight);
                    offset += 4;
                }
                offset = header.offset_tris;
                var vertexIndices = [];
                var uvIndices = [];
                for (var i = 0, l = header.num_tris; i < l; i++) {
                    vertexIndices.push(data.getUint16(offset + 0, true), data.getUint16(offset + 2, true), data.getUint16(offset + 4, true));
                    uvIndices.push(data.getUint16(offset + 6, true), data.getUint16(offset + 8, true), data.getUint16(offset + 10, true));
                    offset += 12;
                }
                var translation = new THREE.Vector3();
                var scale = new THREE.Vector3();
                var string = [];
                var frames = [];
                offset = header.offset_frames;
                for (var i = 0, l = header.num_frames; i < l; i++) {
                    scale.set(data.getFloat32(offset + 0, true), data.getFloat32(offset + 4, true), data.getFloat32(offset + 8, true));
                    translation.set(data.getFloat32(offset + 12, true), data.getFloat32(offset + 16, true), data.getFloat32(offset + 20, true));
                    offset += 24;
                    for (var j = 0; j < 16; j++) {
                        var character = data.getUint8(offset + j, true);
                        if (character === 0)
                            break;
                        string[j] = character;
                    }
                    var frame = {
                        name: String.fromCharCode.apply(null, string),
                        vertices: [],
                        normals: []
                    };
                    offset += 16;
                    for (var j = 0; j < header.num_vertices; j++) {
                        var x = data.getUint8(offset++, true);
                        var y = data.getUint8(offset++, true);
                        var z = data.getUint8(offset++, true);
                        var n = normalData[data.getUint8(offset++, true)];
                        x = x * scale.x + translation.x;
                        y = y * scale.y + translation.y;
                        z = z * scale.z + translation.z;
                        frame.vertices.push(x, z, y);
                        frame.normals.push(n[0], n[2], n[1]);
                    }
                    frames.push(frame);
                }
                var positions = [];
                var normals = [];
                var uvs = [];
                var verticesTemp = frames[0].vertices;
                var normalsTemp = frames[0].normals;
                for (var i = 0, l = vertexIndices.length; i < l; i++) {
                    var vertexIndex = vertexIndices[i];
                    var stride = vertexIndex * 3;
                    var x = verticesTemp[stride];
                    var y = verticesTemp[stride + 1];
                    var z = verticesTemp[stride + 2];
                    positions.push(x, y, z);
                    var nx = normalsTemp[stride];
                    var ny = normalsTemp[stride + 1];
                    var nz = normalsTemp[stride + 2];
                    normals.push(nx, ny, nz);
                    var uvIndex = uvIndices[i];
                    stride = uvIndex * 2;
                    var u = uvsTemp[stride];
                    var v = uvsTemp[stride + 1];
                    uvs.push(u, v);
                }
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
                geometry.setAttribute('normal', new THREE.Float32BufferAttribute(normals, 3));
                geometry.setAttribute('uv', new THREE.Float32BufferAttribute(uvs, 2));
                var morphPositions = [];
                var morphNormals = [];
                for (var i = 0, l = frames.length; i < l; i++) {
                    var frame = frames[i];
                    var attributeName = frame.name;
                    if (frame.vertices.length > 0) {
                        var positions = [];
                        for (var j = 0, jl = vertexIndices.length; j < jl; j++) {
                            var vertexIndex = vertexIndices[j];
                            var stride = vertexIndex * 3;
                            var x = frame.vertices[stride];
                            var y = frame.vertices[stride + 1];
                            var z = frame.vertices[stride + 2];
                            positions.push(x, y, z);
                        }
                        var positionAttribute = new THREE.Float32BufferAttribute(positions, 3);
                        positionAttribute.name = attributeName;
                        morphPositions.push(positionAttribute);
                    }
                    if (frame.normals.length > 0) {
                        var normals = [];
                        for (var j = 0, jl = vertexIndices.length; j < jl; j++) {
                            var vertexIndex = vertexIndices[j];
                            var stride = vertexIndex * 3;
                            var nx = frame.normals[stride];
                            var ny = frame.normals[stride + 1];
                            var nz = frame.normals[stride + 2];
                            normals.push(nx, ny, nz);
                        }
                        var normalAttribute = new THREE.Float32BufferAttribute(normals, 3);
                        normalAttribute.name = attributeName;
                        morphNormals.push(normalAttribute);
                    }
                }
                geometry.morphAttributes.position = morphPositions;
                geometry.morphAttributes.normal = morphNormals;
                geometry.morphTargetsRelative = false;
                geometry.animations = THREE.AnimationClip.CreateClipsFromMorphTargetSequences(frames, 10);
                return geometry;
            };
        }()
    });

    return threex.loaders.MD2Loader = MD2Loader;
});
define('skylark-threejs-ex/misc/MD2Character',[
    "skylark-threejs",
    "../threex",
    '../loaders/MD2Loader'
], function (
    THREE, 
    threex,
    MD2Loader
) {
    'use strict';
    var MD2Character = function () {
        var scope = this;
        this.scale = 1;
        this.animationFPS = 6;
        this.root = new THREE.Object3D();
        this.meshBody = null;
        this.meshWeapon = null;
        this.skinsBody = [];
        this.skinsWeapon = [];
        this.weapons = [];
        this.activeAnimation = null;
        this.mixer = null;
        this.onLoadComplete = function () {
        };
        this.loadCounter = 0;
        this.loadParts = function (config) {
            this.loadCounter = config.weapons.length * 2 + config.skins.length + 1;
            var weaponsTextures = [];
            for (var i = 0; i < config.weapons.length; i++)
                weaponsTextures[i] = config.weapons[i][1];
            this.skinsBody = loadTextures(config.baseUrl + 'skins/', config.skins);
            this.skinsWeapon = loadTextures(config.baseUrl + 'skins/', weaponsTextures);
            var loader = new MD2Loader();
            loader.load(config.baseUrl + config.body, function (geo) {
                var boundingBox = new THREE.Box3();
                boundingBox.setFromBufferAttribute(geo.attributes.position);
                scope.root.position.y = -scope.scale * boundingBox.min.y;
                var mesh = createPart(geo, scope.skinsBody[0]);
                mesh.scale.set(scope.scale, scope.scale, scope.scale);
                scope.root.add(mesh);
                scope.meshBody = mesh;
                scope.meshBody.clipOffset = 0;
                scope.activeAnimationClipName = mesh.geometry.animations[0].name;
                scope.mixer = new THREE.AnimationMixer(mesh);
                checkLoadingComplete();
            });
            var generateCallback = function (index, name) {
                return function (geo) {
                    var mesh = createPart(geo, scope.skinsWeapon[index]);
                    mesh.scale.set(scope.scale, scope.scale, scope.scale);
                    mesh.visible = false;
                    mesh.name = name;
                    scope.root.add(mesh);
                    scope.weapons[index] = mesh;
                    scope.meshWeapon = mesh;
                    checkLoadingComplete();
                };
            };
            for (var i = 0; i < config.weapons.length; i++) {
                loader.load(config.baseUrl + config.weapons[i][0], generateCallback(i, config.weapons[i][0]));
            }
        };
        this.setPlaybackRate = function (rate) {
            if (rate !== 0) {
                this.mixer.timeScale = 1 / rate;
            } else {
                this.mixer.timeScale = 0;
            }
        };
        this.setWireframe = function (wireframeEnabled) {
            if (wireframeEnabled) {
                if (this.meshBody)
                    this.meshBody.material = this.meshBody.materialWireframe;
                if (this.meshWeapon)
                    this.meshWeapon.material = this.meshWeapon.materialWireframe;
            } else {
                if (this.meshBody)
                    this.meshBody.material = this.meshBody.materialTexture;
                if (this.meshWeapon)
                    this.meshWeapon.material = this.meshWeapon.materialTexture;
            }
        };
        this.setSkin = function (index) {
            if (this.meshBody && this.meshBody.material.wireframe === false) {
                this.meshBody.material.map = this.skinsBody[index];
            }
        };
        this.setWeapon = function (index) {
            for (var i = 0; i < this.weapons.length; i++)
                this.weapons[i].visible = false;
            var activeWeapon = this.weapons[index];
            if (activeWeapon) {
                activeWeapon.visible = true;
                this.meshWeapon = activeWeapon;
                scope.syncWeaponAnimation();
            }
        };
        this.setAnimation = function (clipName) {
            if (this.meshBody) {
                if (this.meshBody.activeAction) {
                    this.meshBody.activeAction.stop();
                    this.meshBody.activeAction = null;
                }
                var action = this.mixer.clipAction(clipName, this.meshBody);
                if (action) {
                    this.meshBody.activeAction = action.play();
                }
            }
            scope.activeClipName = clipName;
            scope.syncWeaponAnimation();
        };
        this.syncWeaponAnimation = function () {
            var clipName = scope.activeClipName;
            if (scope.meshWeapon) {
                if (this.meshWeapon.activeAction) {
                    this.meshWeapon.activeAction.stop();
                    this.meshWeapon.activeAction = null;
                }
                var action = this.mixer.clipAction(clipName, this.meshWeapon);
                if (action) {
                    this.meshWeapon.activeAction = action.syncWith(this.meshBody.activeAction).play();
                }
            }
        };
        this.update = function (delta) {
            if (this.mixer)
                this.mixer.update(delta);
        };
        function loadTextures(baseUrl, textureUrls) {
            var textureLoader = new THREE.TextureLoader();
            var textures = [];
            for (var i = 0; i < textureUrls.length; i++) {
                textures[i] = textureLoader.load(baseUrl + textureUrls[i], checkLoadingComplete);
                textures[i].mapping = THREE.UVMapping;
                textures[i].name = textureUrls[i];
                textures[i].encoding = THREE.sRGBEncoding;
            }
            return textures;
        }
        function createPart(geometry, skinMap) {
            var materialWireframe = new THREE.MeshLambertMaterial({
                color: 16755200,
                wireframe: true,
                morphTargets: true,
                morphNormals: true
            });
            var materialTexture = new THREE.MeshLambertMaterial({
                color: 16777215,
                wireframe: false,
                map: skinMap,
                morphTargets: true,
                morphNormals: true
            });
            var mesh = new THREE.Mesh(geometry, materialTexture);
            mesh.rotation.y = -Math.PI / 2;
            mesh.castShadow = true;
            mesh.receiveShadow = true;
            mesh.materialTexture = materialTexture;
            mesh.materialWireframe = materialWireframe;
            return mesh;
        }
        function checkLoadingComplete() {
            scope.loadCounter -= 1;
            if (scope.loadCounter === 0)
                scope.onLoadComplete();
        }
    };
    return threex.misc.MD2Character = MD2Character;
});
define('skylark-threejs-ex/misc/MorphBlendMesh',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var MorphBlendMesh = function (geometry, material) {
        THREE.Mesh.call(this, geometry, material);
        this.animationsMap = {};
        this.animationsList = [];
        var numFrames = Object.keys(this.morphTargetDictionary).length;
        var name = '__default';
        var startFrame = 0;
        var endFrame = numFrames - 1;
        var fps = numFrames / 1;
        this.createAnimation(name, startFrame, endFrame, fps);
        this.setAnimationWeight(name, 1);
    };
    MorphBlendMesh.prototype = Object.assign(Object.create(THREE.Mesh.prototype), {
        constructor: MorphBlendMesh,
        createAnimation: function (name, start, end, fps) {
            var animation = {
                start: start,
                end: end,
                length: end - start + 1,
                fps: fps,
                duration: (end - start) / fps,
                lastFrame: 0,
                currentFrame: 0,
                active: false,
                time: 0,
                direction: 1,
                weight: 1,
                directionBackwards: false,
                mirroredLoop: false
            };
            this.animationsMap[name] = animation;
            this.animationsList.push(animation);
        },
        autoCreateAnimations: function (fps) {
            var pattern = /([a-z]+)_?(\d+)/i;
            var firstAnimation, frameRanges = {};
            var i = 0;
            for (var key in this.morphTargetDictionary) {
                var chunks = key.match(pattern);
                if (chunks && chunks.length > 1) {
                    var name = chunks[1];
                    if (!frameRanges[name])
                        frameRanges[name] = {
                            start: Infinity,
                            end: -Infinity
                        };
                    var range = frameRanges[name];
                    if (i < range.start)
                        range.start = i;
                    if (i > range.end)
                        range.end = i;
                    if (!firstAnimation)
                        firstAnimation = name;
                }
                i++;
            }
            for (var name in frameRanges) {
                var range = frameRanges[name];
                this.createAnimation(name, range.start, range.end, fps);
            }
            this.firstAnimation = firstAnimation;
        },
        setAnimationDirectionForward: function (name) {
            var animation = this.animationsMap[name];
            if (animation) {
                animation.direction = 1;
                animation.directionBackwards = false;
            }
        },
        setAnimationDirectionBackward: function (name) {
            var animation = this.animationsMap[name];
            if (animation) {
                animation.direction = -1;
                animation.directionBackwards = true;
            }
        },
        setAnimationFPS: function (name, fps) {
            var animation = this.animationsMap[name];
            if (animation) {
                animation.fps = fps;
                animation.duration = (animation.end - animation.start) / animation.fps;
            }
        },
        setAnimationDuration: function (name, duration) {
            var animation = this.animationsMap[name];
            if (animation) {
                animation.duration = duration;
                animation.fps = (animation.end - animation.start) / animation.duration;
            }
        },
        setAnimationWeight: function (name, weight) {
            var animation = this.animationsMap[name];
            if (animation) {
                animation.weight = weight;
            }
        },
        setAnimationTime: function (name, time) {
            var animation = this.animationsMap[name];
            if (animation) {
                animation.time = time;
            }
        },
        getAnimationTime: function (name) {
            var time = 0;
            var animation = this.animationsMap[name];
            if (animation) {
                time = animation.time;
            }
            return time;
        },
        getAnimationDuration: function (name) {
            var duration = -1;
            var animation = this.animationsMap[name];
            if (animation) {
                duration = animation.duration;
            }
            return duration;
        },
        playAnimation: function (name) {
            var animation = this.animationsMap[name];
            if (animation) {
                animation.time = 0;
                animation.active = true;
            } else {
                console.warn('MorphBlendMesh: animation[' + name + '] undefined in .playAnimation()');
            }
        },
        stopAnimation: function (name) {
            var animation = this.animationsMap[name];
            if (animation) {
                animation.active = false;
            }
        },
        update: function (delta) {
            for (var i = 0, il = this.animationsList.length; i < il; i++) {
                var animation = this.animationsList[i];
                if (!animation.active)
                    continue;
                var frameTime = animation.duration / animation.length;
                animation.time += animation.direction * delta;
                if (animation.mirroredLoop) {
                    if (animation.time > animation.duration || animation.time < 0) {
                        animation.direction *= -1;
                        if (animation.time > animation.duration) {
                            animation.time = animation.duration;
                            animation.directionBackwards = true;
                        }
                        if (animation.time < 0) {
                            animation.time = 0;
                            animation.directionBackwards = false;
                        }
                    }
                } else {
                    animation.time = animation.time % animation.duration;
                    if (animation.time < 0)
                        animation.time += animation.duration;
                }
                var keyframe = animation.start + THREE.MathUtils.clamp(Math.floor(animation.time / frameTime), 0, animation.length - 1);
                var weight = animation.weight;
                if (keyframe !== animation.currentFrame) {
                    this.morphTargetInfluences[animation.lastFrame] = 0;
                    this.morphTargetInfluences[animation.currentFrame] = 1 * weight;
                    this.morphTargetInfluences[keyframe] = 0;
                    animation.lastFrame = animation.currentFrame;
                    animation.currentFrame = keyframe;
                }
                var mix = animation.time % frameTime / frameTime;
                if (animation.directionBackwards)
                    mix = 1 - mix;
                if (animation.currentFrame !== animation.lastFrame) {
                    this.morphTargetInfluences[animation.currentFrame] = mix * weight;
                    this.morphTargetInfluences[animation.lastFrame] = (1 - mix) * weight;
                } else {
                    this.morphTargetInfluences[animation.currentFrame] = weight;
                }
            }
        }
    });

    return threex.misc.MorphBlendMesh = MorphBlendMesh;
});
define('skylark-threejs-ex/misc/MD2CharacterComplex',[
    "skylark-threejs",
    "../threex",
    '../loaders/MD2Loader',
    './MorphBlendMesh'
], function (
    THREE, 
    threex,
    MD2Loader, 
    MorphBlendMesh
) {
    'use strict';
    var MD2CharacterComplex = function () {
        var scope = this;
        this.scale = 1;
        this.animationFPS = 6;
        this.transitionFrames = 15;
        this.maxSpeed = 275;
        this.maxReverseSpeed = -275;
        this.frontAcceleration = 600;
        this.backAcceleration = 600;
        this.frontDecceleration = 600;
        this.angularSpeed = 2.5;
        this.root = new THREE.Object3D();
        this.meshBody = null;
        this.meshWeapon = null;
        this.controls = null;
        this.skinsBody = [];
        this.skinsWeapon = [];
        this.weapons = [];
        this.currentSkin = undefined;
        this.onLoadComplete = function () {
        };
        this.meshes = [];
        this.animations = {};
        this.loadCounter = 0;
        this.speed = 0;
        this.bodyOrientation = 0;
        this.walkSpeed = this.maxSpeed;
        this.crouchSpeed = this.maxSpeed * 0.5;
        this.activeAnimation = null;
        this.oldAnimation = null;
        this.enableShadows = function (enable) {
            for (var i = 0; i < this.meshes.length; i++) {
                this.meshes[i].castShadow = enable;
                this.meshes[i].receiveShadow = enable;
            }
        };
        this.setVisible = function (enable) {
            for (var i = 0; i < this.meshes.length; i++) {
                this.meshes[i].visible = enable;
                this.meshes[i].visible = enable;
            }
        };
        this.shareParts = function (original) {
            this.animations = original.animations;
            this.walkSpeed = original.walkSpeed;
            this.crouchSpeed = original.crouchSpeed;
            this.skinsBody = original.skinsBody;
            this.skinsWeapon = original.skinsWeapon;
            var mesh = createPart(original.meshBody.geometry, this.skinsBody[0]);
            mesh.scale.set(this.scale, this.scale, this.scale);
            this.root.position.y = original.root.position.y;
            this.root.add(mesh);
            this.meshBody = mesh;
            this.meshes.push(mesh);
            for (var i = 0; i < original.weapons.length; i++) {
                var meshWeapon = createPart(original.weapons[i].geometry, this.skinsWeapon[i]);
                meshWeapon.scale.set(this.scale, this.scale, this.scale);
                meshWeapon.visible = false;
                meshWeapon.name = original.weapons[i].name;
                this.root.add(meshWeapon);
                this.weapons[i] = meshWeapon;
                this.meshWeapon = meshWeapon;
                this.meshes.push(meshWeapon);
            }
        };
        this.loadParts = function (config) {
            this.animations = config.animations;
            this.walkSpeed = config.walkSpeed;
            this.crouchSpeed = config.crouchSpeed;
            this.loadCounter = config.weapons.length * 2 + config.skins.length + 1;
            var weaponsTextures = [];
            for (var i = 0; i < config.weapons.length; i++)
                weaponsTextures[i] = config.weapons[i][1];
            this.skinsBody = loadTextures(config.baseUrl + 'skins/', config.skins);
            this.skinsWeapon = loadTextures(config.baseUrl + 'skins/', weaponsTextures);
            var loader = new MD2Loader();
            loader.load(config.baseUrl + config.body, function (geo) {
                var boundingBox = new THREE.Box3();
                boundingBox.setFromBufferAttribute(geo.attributes.position);
                scope.root.position.y = -scope.scale * boundingBox.min.y;
                var mesh = createPart(geo, scope.skinsBody[0]);
                mesh.scale.set(scope.scale, scope.scale, scope.scale);
                scope.root.add(mesh);
                scope.meshBody = mesh;
                scope.meshes.push(mesh);
                checkLoadingComplete();
            });
            var generateCallback = function (index, name) {
                return function (geo) {
                    var mesh = createPart(geo, scope.skinsWeapon[index]);
                    mesh.scale.set(scope.scale, scope.scale, scope.scale);
                    mesh.visible = false;
                    mesh.name = name;
                    scope.root.add(mesh);
                    scope.weapons[index] = mesh;
                    scope.meshWeapon = mesh;
                    scope.meshes.push(mesh);
                    checkLoadingComplete();
                };
            };
            for (var i = 0; i < config.weapons.length; i++) {
                loader.load(config.baseUrl + config.weapons[i][0], generateCallback(i, config.weapons[i][0]));
            }
        };
        this.setPlaybackRate = function (rate) {
            if (this.meshBody)
                this.meshBody.duration = this.meshBody.baseDuration / rate;
            if (this.meshWeapon)
                this.meshWeapon.duration = this.meshWeapon.baseDuration / rate;
        };
        this.setWireframe = function (wireframeEnabled) {
            if (wireframeEnabled) {
                if (this.meshBody)
                    this.meshBody.material = this.meshBody.materialWireframe;
                if (this.meshWeapon)
                    this.meshWeapon.material = this.meshWeapon.materialWireframe;
            } else {
                if (this.meshBody)
                    this.meshBody.material = this.meshBody.materialTexture;
                if (this.meshWeapon)
                    this.meshWeapon.material = this.meshWeapon.materialTexture;
            }
        };
        this.setSkin = function (index) {
            if (this.meshBody && this.meshBody.material.wireframe === false) {
                this.meshBody.material.map = this.skinsBody[index];
                this.currentSkin = index;
            }
        };
        this.setWeapon = function (index) {
            for (var i = 0; i < this.weapons.length; i++)
                this.weapons[i].visible = false;
            var activeWeapon = this.weapons[index];
            if (activeWeapon) {
                activeWeapon.visible = true;
                this.meshWeapon = activeWeapon;
                if (this.activeAnimation) {
                    activeWeapon.playAnimation(this.activeAnimation);
                    this.meshWeapon.setAnimationTime(this.activeAnimation, this.meshBody.getAnimationTime(this.activeAnimation));
                }
            }
        };
        this.setAnimation = function (animationName) {
            if (animationName === this.activeAnimation || !animationName)
                return;
            if (this.meshBody) {
                this.meshBody.setAnimationWeight(animationName, 0);
                this.meshBody.playAnimation(animationName);
                this.oldAnimation = this.activeAnimation;
                this.activeAnimation = animationName;
                this.blendCounter = this.transitionFrames;
            }
            if (this.meshWeapon) {
                this.meshWeapon.setAnimationWeight(animationName, 0);
                this.meshWeapon.playAnimation(animationName);
            }
        };
        this.update = function (delta) {
            if (this.controls)
                this.updateMovementModel(delta);
            if (this.animations) {
                this.updateBehaviors();
                this.updateAnimations(delta);
            }
        };
        this.updateAnimations = function (delta) {
            var mix = 1;
            if (this.blendCounter > 0) {
                mix = (this.transitionFrames - this.blendCounter) / this.transitionFrames;
                this.blendCounter -= 1;
            }
            if (this.meshBody) {
                this.meshBody.update(delta);
                this.meshBody.setAnimationWeight(this.activeAnimation, mix);
                this.meshBody.setAnimationWeight(this.oldAnimation, 1 - mix);
            }
            if (this.meshWeapon) {
                this.meshWeapon.update(delta);
                this.meshWeapon.setAnimationWeight(this.activeAnimation, mix);
                this.meshWeapon.setAnimationWeight(this.oldAnimation, 1 - mix);
            }
        };
        this.updateBehaviors = function () {
            var controls = this.controls;
            var animations = this.animations;
            var moveAnimation, idleAnimation;
            if (controls.crouch) {
                moveAnimation = animations['crouchMove'];
                idleAnimation = animations['crouchIdle'];
            } else {
                moveAnimation = animations['move'];
                idleAnimation = animations['idle'];
            }
            if (controls.jump) {
                moveAnimation = animations['jump'];
                idleAnimation = animations['jump'];
            }
            if (controls.attack) {
                if (controls.crouch) {
                    moveAnimation = animations['crouchAttack'];
                    idleAnimation = animations['crouchAttack'];
                } else {
                    moveAnimation = animations['attack'];
                    idleAnimation = animations['attack'];
                }
            }
            if (controls.moveForward || controls.moveBackward || controls.moveLeft || controls.moveRight) {
                if (this.activeAnimation !== moveAnimation) {
                    this.setAnimation(moveAnimation);
                }
            }
            if (Math.abs(this.speed) < 0.2 * this.maxSpeed && !(controls.moveLeft || controls.moveRight || controls.moveForward || controls.moveBackward)) {
                if (this.activeAnimation !== idleAnimation) {
                    this.setAnimation(idleAnimation);
                }
            }
            if (controls.moveForward) {
                if (this.meshBody) {
                    this.meshBody.setAnimationDirectionForward(this.activeAnimation);
                    this.meshBody.setAnimationDirectionForward(this.oldAnimation);
                }
                if (this.meshWeapon) {
                    this.meshWeapon.setAnimationDirectionForward(this.activeAnimation);
                    this.meshWeapon.setAnimationDirectionForward(this.oldAnimation);
                }
            }
            if (controls.moveBackward) {
                if (this.meshBody) {
                    this.meshBody.setAnimationDirectionBackward(this.activeAnimation);
                    this.meshBody.setAnimationDirectionBackward(this.oldAnimation);
                }
                if (this.meshWeapon) {
                    this.meshWeapon.setAnimationDirectionBackward(this.activeAnimation);
                    this.meshWeapon.setAnimationDirectionBackward(this.oldAnimation);
                }
            }
        };
        this.updateMovementModel = function (delta) {
            var controls = this.controls;
            if (controls.crouch)
                this.maxSpeed = this.crouchSpeed;
            else
                this.maxSpeed = this.walkSpeed;
            this.maxReverseSpeed = -this.maxSpeed;
            if (controls.moveForward)
                this.speed = THREE.MathUtils.clamp(this.speed + delta * this.frontAcceleration, this.maxReverseSpeed, this.maxSpeed);
            if (controls.moveBackward)
                this.speed = THREE.MathUtils.clamp(this.speed - delta * this.backAcceleration, this.maxReverseSpeed, this.maxSpeed);
            var dir = 1;
            if (controls.moveLeft) {
                this.bodyOrientation += delta * this.angularSpeed;
                this.speed = THREE.MathUtils.clamp(this.speed + dir * delta * this.frontAcceleration, this.maxReverseSpeed, this.maxSpeed);
            }
            if (controls.moveRight) {
                this.bodyOrientation -= delta * this.angularSpeed;
                this.speed = THREE.MathUtils.clamp(this.speed + dir * delta * this.frontAcceleration, this.maxReverseSpeed, this.maxSpeed);
            }
            if (!(controls.moveForward || controls.moveBackward)) {
                if (this.speed > 0) {
                    var k = exponentialEaseOut(this.speed / this.maxSpeed);
                    this.speed = THREE.MathUtils.clamp(this.speed - k * delta * this.frontDecceleration, 0, this.maxSpeed);
                } else {
                    var k = exponentialEaseOut(this.speed / this.maxReverseSpeed);
                    this.speed = THREE.MathUtils.clamp(this.speed + k * delta * this.backAcceleration, this.maxReverseSpeed, 0);
                }
            }
            var forwardDelta = this.speed * delta;
            this.root.position.x += Math.sin(this.bodyOrientation) * forwardDelta;
            this.root.position.z += Math.cos(this.bodyOrientation) * forwardDelta;
            this.root.rotation.y = this.bodyOrientation;
        };
        function loadTextures(baseUrl, textureUrls) {
            var textureLoader = new THREE.TextureLoader();
            var textures = [];
            for (var i = 0; i < textureUrls.length; i++) {
                textures[i] = textureLoader.load(baseUrl + textureUrls[i], checkLoadingComplete);
                textures[i].mapping = THREE.UVMapping;
                textures[i].name = textureUrls[i];
                textures[i].encoding = THREE.sRGBEncoding;
            }
            return textures;
        }
        function createPart(geometry, skinMap) {
            var materialWireframe = new THREE.MeshLambertMaterial({
                color: 16755200,
                wireframe: true,
                morphTargets: true,
                morphNormals: true
            });
            var materialTexture = new THREE.MeshLambertMaterial({
                color: 16777215,
                wireframe: false,
                map: skinMap,
                morphTargets: true,
                morphNormals: true
            });
            var mesh = new MorphBlendMesh(geometry, materialTexture);
            mesh.rotation.y = -Math.PI / 2;
            mesh.materialTexture = materialTexture;
            mesh.materialWireframe = materialWireframe;
            mesh.autoCreateAnimations(scope.animationFPS);
            return mesh;
        }
        function checkLoadingComplete() {
            scope.loadCounter -= 1;
            if (scope.loadCounter === 0)
                scope.onLoadComplete();
        }
        function exponentialEaseOut(k) {
            return k === 1 ? 1 : -Math.pow(2, -10 * k) + 1;
        }
    };
    return threex.misc.MD2CharacterComplex = MD2CharacterComplex;
});
define('skylark-threejs-ex/misc/MorphAnimMesh',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var MorphAnimMesh = function (geometry, material) {
        THREE.Mesh.call(this, geometry, material);
        this.type = 'MorphAnimMesh';
        this.mixer = new THREE.AnimationMixer(this);
        this.activeAction = null;
    };
    MorphAnimMesh.prototype = Object.create(THREE.Mesh.prototype);
    MorphAnimMesh.prototype.constructor = MorphAnimMesh;
    MorphAnimMesh.prototype.setDirectionForward = function () {
        this.mixer.timeScale = 1;
    };
    MorphAnimMesh.prototype.setDirectionBackward = function () {
        this.mixer.timeScale = -1;
    };
    MorphAnimMesh.prototype.playAnimation = function (label, fps) {
        if (this.activeAction) {
            this.activeAction.stop();
            this.activeAction = null;
        }
        var clip = THREE.AnimationClip.findByName(this, label);
        if (clip) {
            var action = this.mixer.clipAction(clip);
            action.timeScale = clip.tracks.length * fps / clip.duration;
            this.activeAction = action.play();
        } else {
            throw new Error('THREE.MorphAnimMesh: animations[' + label + '] undefined in .playAnimation()');
        }
    };
    MorphAnimMesh.prototype.updateAnimation = function (delta) {
        this.mixer.update(delta);
    };
    MorphAnimMesh.prototype.copy = function (source) {
        THREE.Mesh.prototype.copy.call(this, source);
        this.mixer = new THREE.AnimationMixer(this);
        return this;
    };
    return threex.misc.MorphAnimMesh = MorphAnimMesh;
});
define('skylark-threejs-ex/shaders/OceanShaders',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var OceanShaders = {};
    OceanShaders['ocean_sim_vertex'] = {
        vertexShader: [
            'varying vec2 vUV;',
            'void main (void) {',
            '\tvUV = position.xy * 0.5 + 0.5;',
            '\tgl_Position = vec4(position, 1.0 );',
            '}'
        ].join('\n')
    };
    OceanShaders['ocean_subtransform'] = {
        uniforms: {
            'u_input': { value: null },
            'u_transformSize': { value: 512 },
            'u_subtransformSize': { value: 250 }
        },
        fragmentShader: [
            'precision highp float;',
            '#include <common>',
            'uniform sampler2D u_input;',
            'uniform float u_transformSize;',
            'uniform float u_subtransformSize;',
            'varying vec2 vUV;',
            'vec2 multiplyComplex (vec2 a, vec2 b) {',
            '\treturn vec2(a[0] * b[0] - a[1] * b[1], a[1] * b[0] + a[0] * b[1]);',
            '}',
            'void main (void) {',
            '\t#ifdef HORIZONTAL',
            '\tfloat index = vUV.x * u_transformSize - 0.5;',
            '\t#else',
            '\tfloat index = vUV.y * u_transformSize - 0.5;',
            '\t#endif',
            '\tfloat evenIndex = floor(index / u_subtransformSize) * (u_subtransformSize * 0.5) + mod(index, u_subtransformSize * 0.5);',
            '\t#ifdef HORIZONTAL',
            '\tvec4 even = texture2D(u_input, vec2(evenIndex + 0.5, gl_FragCoord.y) / u_transformSize).rgba;',
            '\tvec4 odd = texture2D(u_input, vec2(evenIndex + u_transformSize * 0.5 + 0.5, gl_FragCoord.y) / u_transformSize).rgba;',
            '\t#else',
            '\tvec4 even = texture2D(u_input, vec2(gl_FragCoord.x, evenIndex + 0.5) / u_transformSize).rgba;',
            '\tvec4 odd = texture2D(u_input, vec2(gl_FragCoord.x, evenIndex + u_transformSize * 0.5 + 0.5) / u_transformSize).rgba;',
            '\t#endif',
            '\tfloat twiddleArgument = -2.0 * PI * (index / u_subtransformSize);',
            '\tvec2 twiddle = vec2(cos(twiddleArgument), sin(twiddleArgument));',
            '\tvec2 outputA = even.xy + multiplyComplex(twiddle, odd.xy);',
            '\tvec2 outputB = even.zw + multiplyComplex(twiddle, odd.zw);',
            '\tgl_FragColor = vec4(outputA, outputB);',
            '}'
        ].join('\n')
    };
    OceanShaders['ocean_initial_spectrum'] = {
        uniforms: {
            'u_wind': { value: new THREE.Vector2(10, 10) },
            'u_resolution': { value: 512 },
            'u_size': { value: 250 }
        },
        vertexShader: [
            'void main (void) {',
            '\tgl_Position = vec4(position, 1.0);',
            '}'
        ].join('\n'),
        fragmentShader: [
            'precision highp float;',
            '#include <common>',
            'const float G = 9.81;',
            'const float KM = 370.0;',
            'const float CM = 0.23;',
            'uniform vec2 u_wind;',
            'uniform float u_resolution;',
            'uniform float u_size;',
            'float omega (float k) {',
            '\treturn sqrt(G * k * (1.0 + pow2(k / KM)));',
            '}',
            '#if __VERSION__ == 100',
            'float tanh (float x) {',
            '\treturn (1.0 - exp(-2.0 * x)) / (1.0 + exp(-2.0 * x));',
            '}',
            '#endif',
            'void main (void) {',
            '\tvec2 coordinates = gl_FragCoord.xy - 0.5;',
            '\tfloat n = (coordinates.x < u_resolution * 0.5) ? coordinates.x : coordinates.x - u_resolution;',
            '\tfloat m = (coordinates.y < u_resolution * 0.5) ? coordinates.y : coordinates.y - u_resolution;',
            '\tvec2 K = (2.0 * PI * vec2(n, m)) / u_size;',
            '\tfloat k = length(K);',
            '\tfloat l_wind = length(u_wind);',
            '\tfloat Omega = 0.84;',
            '\tfloat kp = G * pow2(Omega / l_wind);',
            '\tfloat c = omega(k) / k;',
            '\tfloat cp = omega(kp) / kp;',
            '\tfloat Lpm = exp(-1.25 * pow2(kp / k));',
            '\tfloat gamma = 1.7;',
            '\tfloat sigma = 0.08 * (1.0 + 4.0 * pow(Omega, -3.0));',
            '\tfloat Gamma = exp(-pow2(sqrt(k / kp) - 1.0) / 2.0 * pow2(sigma));',
            '\tfloat Jp = pow(gamma, Gamma);',
            '\tfloat Fp = Lpm * Jp * exp(-Omega / sqrt(10.0) * (sqrt(k / kp) - 1.0));',
            '\tfloat alphap = 0.006 * sqrt(Omega);',
            '\tfloat Bl = 0.5 * alphap * cp / c * Fp;',
            '\tfloat z0 = 0.000037 * pow2(l_wind) / G * pow(l_wind / cp, 0.9);',
            '\tfloat uStar = 0.41 * l_wind / log(10.0 / z0);',
            '\tfloat alpham = 0.01 * ((uStar < CM) ? (1.0 + log(uStar / CM)) : (1.0 + 3.0 * log(uStar / CM)));',
            '\tfloat Fm = exp(-0.25 * pow2(k / KM - 1.0));',
            '\tfloat Bh = 0.5 * alpham * CM / c * Fm * Lpm;',
            '\tfloat a0 = log(2.0) / 4.0;',
            '\tfloat am = 0.13 * uStar / CM;',
            '\tfloat Delta = tanh(a0 + 4.0 * pow(c / cp, 2.5) + am * pow(CM / c, 2.5));',
            '\tfloat cosPhi = dot(normalize(u_wind), normalize(K));',
            '\tfloat S = (1.0 / (2.0 * PI)) * pow(k, -4.0) * (Bl + Bh) * (1.0 + Delta * (2.0 * cosPhi * cosPhi - 1.0));',
            '\tfloat dk = 2.0 * PI / u_size;',
            '\tfloat h = sqrt(S / 2.0) * dk;',
            '\tif (K.x == 0.0 && K.y == 0.0) {',
            '\t\th = 0.0;',
            '\t}',
            '\tgl_FragColor = vec4(h, 0.0, 0.0, 0.0);',
            '}'
        ].join('\n')
    };
    OceanShaders['ocean_phase'] = {
        uniforms: {
            'u_phases': { value: null },
            'u_deltaTime': { value: null },
            'u_resolution': { value: null },
            'u_size': { value: null }
        },
        fragmentShader: [
            'precision highp float;',
            '#include <common>',
            'const float G = 9.81;',
            'const float KM = 370.0;',
            'varying vec2 vUV;',
            'uniform sampler2D u_phases;',
            'uniform float u_deltaTime;',
            'uniform float u_resolution;',
            'uniform float u_size;',
            'float omega (float k) {',
            '\treturn sqrt(G * k * (1.0 + k * k / KM * KM));',
            '}',
            'void main (void) {',
            '\tfloat deltaTime = 1.0 / 60.0;',
            '\tvec2 coordinates = gl_FragCoord.xy - 0.5;',
            '\tfloat n = (coordinates.x < u_resolution * 0.5) ? coordinates.x : coordinates.x - u_resolution;',
            '\tfloat m = (coordinates.y < u_resolution * 0.5) ? coordinates.y : coordinates.y - u_resolution;',
            '\tvec2 waveVector = (2.0 * PI * vec2(n, m)) / u_size;',
            '\tfloat phase = texture2D(u_phases, vUV).r;',
            '\tfloat deltaPhase = omega(length(waveVector)) * u_deltaTime;',
            '\tphase = mod(phase + deltaPhase, 2.0 * PI);',
            '\tgl_FragColor = vec4(phase, 0.0, 0.0, 0.0);',
            '}'
        ].join('\n')
    };
    OceanShaders['ocean_spectrum'] = {
        uniforms: {
            'u_size': { value: null },
            'u_resolution': { value: null },
            'u_choppiness': { value: null },
            'u_phases': { value: null },
            'u_initialSpectrum': { value: null }
        },
        fragmentShader: [
            'precision highp float;',
            '#include <common>',
            'const float G = 9.81;',
            'const float KM = 370.0;',
            'varying vec2 vUV;',
            'uniform float u_size;',
            'uniform float u_resolution;',
            'uniform float u_choppiness;',
            'uniform sampler2D u_phases;',
            'uniform sampler2D u_initialSpectrum;',
            'vec2 multiplyComplex (vec2 a, vec2 b) {',
            '\treturn vec2(a[0] * b[0] - a[1] * b[1], a[1] * b[0] + a[0] * b[1]);',
            '}',
            'vec2 multiplyByI (vec2 z) {',
            '\treturn vec2(-z[1], z[0]);',
            '}',
            'float omega (float k) {',
            '\treturn sqrt(G * k * (1.0 + k * k / KM * KM));',
            '}',
            'void main (void) {',
            '\tvec2 coordinates = gl_FragCoord.xy - 0.5;',
            '\tfloat n = (coordinates.x < u_resolution * 0.5) ? coordinates.x : coordinates.x - u_resolution;',
            '\tfloat m = (coordinates.y < u_resolution * 0.5) ? coordinates.y : coordinates.y - u_resolution;',
            '\tvec2 waveVector = (2.0 * PI * vec2(n, m)) / u_size;',
            '\tfloat phase = texture2D(u_phases, vUV).r;',
            '\tvec2 phaseVector = vec2(cos(phase), sin(phase));',
            '\tvec2 h0 = texture2D(u_initialSpectrum, vUV).rg;',
            '\tvec2 h0Star = texture2D(u_initialSpectrum, vec2(1.0 - vUV + 1.0 / u_resolution)).rg;',
            '\th0Star.y *= -1.0;',
            '\tvec2 h = multiplyComplex(h0, phaseVector) + multiplyComplex(h0Star, vec2(phaseVector.x, -phaseVector.y));',
            '\tvec2 hX = -multiplyByI(h * (waveVector.x / length(waveVector))) * u_choppiness;',
            '\tvec2 hZ = -multiplyByI(h * (waveVector.y / length(waveVector))) * u_choppiness;',
            '\tif (waveVector.x == 0.0 && waveVector.y == 0.0) {',
            '\t\th = vec2(0.0);',
            '\t\thX = vec2(0.0);',
            '\t\thZ = vec2(0.0);',
            '\t}',
            '\tgl_FragColor = vec4(hX + multiplyByI(h), hZ);',
            '}'
        ].join('\n')
    };
    OceanShaders['ocean_normals'] = {
        uniforms: {
            'u_displacementMap': { value: null },
            'u_resolution': { value: null },
            'u_size': { value: null }
        },
        fragmentShader: [
            'precision highp float;',
            'varying vec2 vUV;',
            'uniform sampler2D u_displacementMap;',
            'uniform float u_resolution;',
            'uniform float u_size;',
            'void main (void) {',
            '\tfloat texel = 1.0 / u_resolution;',
            '\tfloat texelSize = u_size / u_resolution;',
            '\tvec3 center = texture2D(u_displacementMap, vUV).rgb;',
            '\tvec3 right = vec3(texelSize, 0.0, 0.0) + texture2D(u_displacementMap, vUV + vec2(texel, 0.0)).rgb - center;',
            '\tvec3 left = vec3(-texelSize, 0.0, 0.0) + texture2D(u_displacementMap, vUV + vec2(-texel, 0.0)).rgb - center;',
            '\tvec3 top = vec3(0.0, 0.0, -texelSize) + texture2D(u_displacementMap, vUV + vec2(0.0, -texel)).rgb - center;',
            '\tvec3 bottom = vec3(0.0, 0.0, texelSize) + texture2D(u_displacementMap, vUV + vec2(0.0, texel)).rgb - center;',
            '\tvec3 topRight = cross(right, top);',
            '\tvec3 topLeft = cross(top, left);',
            '\tvec3 bottomLeft = cross(left, bottom);',
            '\tvec3 bottomRight = cross(bottom, right);',
            '\tgl_FragColor = vec4(normalize(topRight + topLeft + bottomLeft + bottomRight), 1.0);',
            '}'
        ].join('\n')
    };
    OceanShaders['ocean_main'] = {
        uniforms: {
            'u_displacementMap': { value: null },
            'u_normalMap': { value: null },
            'u_geometrySize': { value: null },
            'u_size': { value: null },
            'u_projectionMatrix': { value: null },
            'u_viewMatrix': { value: null },
            'u_cameraPosition': { value: null },
            'u_skyColor': { value: null },
            'u_oceanColor': { value: null },
            'u_sunDirection': { value: null },
            'u_exposure': { value: null }
        },
        vertexShader: [
            'precision highp float;',
            'varying vec3 vPos;',
            'varying vec2 vUV;',
            'uniform mat4 u_projectionMatrix;',
            'uniform mat4 u_viewMatrix;',
            'uniform float u_size;',
            'uniform float u_geometrySize;',
            'uniform sampler2D u_displacementMap;',
            'void main (void) {',
            '\tvec3 newPos = position + texture2D(u_displacementMap, uv).rgb * (u_geometrySize / u_size);',
            '\tvPos = newPos;',
            '\tvUV = uv;',
            '\tgl_Position = u_projectionMatrix * u_viewMatrix * vec4(newPos, 1.0);',
            '}'
        ].join('\n'),
        fragmentShader: [
            'precision highp float;',
            'varying vec3 vPos;',
            'varying vec2 vUV;',
            'uniform sampler2D u_displacementMap;',
            'uniform sampler2D u_normalMap;',
            'uniform vec3 u_cameraPosition;',
            'uniform vec3 u_oceanColor;',
            'uniform vec3 u_skyColor;',
            'uniform vec3 u_sunDirection;',
            'uniform float u_exposure;',
            'vec3 hdr (vec3 color, float exposure) {',
            '\treturn 1.0 - exp(-color * exposure);',
            '}',
            'void main (void) {',
            '\tvec3 normal = texture2D(u_normalMap, vUV).rgb;',
            '\tvec3 view = normalize(u_cameraPosition - vPos);',
            '\tfloat fresnel = 0.02 + 0.98 * pow(1.0 - dot(normal, view), 5.0);',
            '\tvec3 sky = fresnel * u_skyColor;',
            '\tfloat diffuse = clamp(dot(normal, normalize(u_sunDirection)), 0.0, 1.0);',
            '\tvec3 water = (1.0 - fresnel) * u_oceanColor * u_skyColor * diffuse;',
            '\tvec3 color = sky + water;',
            '\tgl_FragColor = vec4(hdr(color, u_exposure), 1.0);',
            '}'
        ].join('\n')
    };
    return threex.shaders.OceanShaders = OceanShaders;
});
define('skylark-threejs-ex/misc/Ocean',[
    "skylark-threejs",
    "../threex",
    '../shaders/OceanShaders'
], function (
    THREE, 
    threex,
    OceanShaders
) {
    'use strict';
    var Ocean = function (renderer, camera, scene, options) {
        this.changed = true;
        this.initial = true;
        this.oceanCamera = new THREE.OrthographicCamera();
        this.oceanCamera.position.z = 1;
        this.renderer = renderer;
        this.renderer.clearColor(16777215);
        this.scene = new THREE.Scene();
        function optionalParameter(value, defaultValue) {
            return value !== undefined ? value : defaultValue;
        }
        options = options || {};
        this.clearColor = optionalParameter(options.CLEAR_COLOR, [
            1,
            1,
            1,
            0
        ]);
        this.geometryOrigin = optionalParameter(options.GEOMETRY_ORIGIN, [
            -1000,
            -1000
        ]);
        this.sunDirectionX = optionalParameter(options.SUN_DIRECTION[0], -1);
        this.sunDirectionY = optionalParameter(options.SUN_DIRECTION[1], 1);
        this.sunDirectionZ = optionalParameter(options.SUN_DIRECTION[2], 1);
        this.oceanColor = optionalParameter(options.OCEAN_COLOR, new THREE.Vector3(0.004, 0.016, 0.047));
        this.skyColor = optionalParameter(options.SKY_COLOR, new THREE.Vector3(3.2, 9.6, 12.8));
        this.exposure = optionalParameter(options.EXPOSURE, 0.35);
        this.geometryResolution = optionalParameter(options.GEOMETRY_RESOLUTION, 32);
        this.geometrySize = optionalParameter(options.GEOMETRY_SIZE, 2000);
        this.resolution = optionalParameter(options.RESOLUTION, 64);
        this.floatSize = optionalParameter(options.SIZE_OF_FLOAT, 4);
        this.windX = optionalParameter(options.INITIAL_WIND[0], 10);
        this.windY = optionalParameter(options.INITIAL_WIND[1], 10);
        this.size = optionalParameter(options.INITIAL_SIZE, 250);
        this.choppiness = optionalParameter(options.INITIAL_CHOPPINESS, 1.5);
        this.matrixNeedsUpdate = false;
        var renderTargetType = optionalParameter(options.USE_HALF_FLOAT, false) ? THREE.HalfFloatType : THREE.FloatType;
        var LinearClampParams = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            wrapS: THREE.ClampToEdgeWrapping,
            wrapT: THREE.ClampToEdgeWrapping,
            format: THREE.RGBAFormat,
            stencilBuffer: false,
            depthBuffer: false,
            premultiplyAlpha: false,
            type: renderTargetType
        };
        var NearestClampParams = {
            minFilter: THREE.NearestFilter,
            magFilter: THREE.NearestFilter,
            wrapS: THREE.ClampToEdgeWrapping,
            wrapT: THREE.ClampToEdgeWrapping,
            format: THREE.RGBAFormat,
            stencilBuffer: false,
            depthBuffer: false,
            premultiplyAlpha: false,
            type: renderTargetType
        };
        var NearestRepeatParams = {
            minFilter: THREE.NearestFilter,
            magFilter: THREE.NearestFilter,
            wrapS: THREE.RepeatWrapping,
            wrapT: THREE.RepeatWrapping,
            format: THREE.RGBAFormat,
            stencilBuffer: false,
            depthBuffer: false,
            premultiplyAlpha: false,
            type: renderTargetType
        };
        this.initialSpectrumFramebuffer = new THREE.WebGLRenderTarget(this.resolution, this.resolution, NearestRepeatParams);
        this.spectrumFramebuffer = new THREE.WebGLRenderTarget(this.resolution, this.resolution, NearestClampParams);
        this.pingPhaseFramebuffer = new THREE.WebGLRenderTarget(this.resolution, this.resolution, NearestClampParams);
        this.pongPhaseFramebuffer = new THREE.WebGLRenderTarget(this.resolution, this.resolution, NearestClampParams);
        this.pingTransformFramebuffer = new THREE.WebGLRenderTarget(this.resolution, this.resolution, NearestClampParams);
        this.pongTransformFramebuffer = new THREE.WebGLRenderTarget(this.resolution, this.resolution, NearestClampParams);
        this.displacementMapFramebuffer = new THREE.WebGLRenderTarget(this.resolution, this.resolution, LinearClampParams);
        this.normalMapFramebuffer = new THREE.WebGLRenderTarget(this.resolution, this.resolution, LinearClampParams);
        var fullscreeenVertexShader = OceanShaders['ocean_sim_vertex'];
        var oceanHorizontalShader = OceanShaders['ocean_subtransform'];
        var oceanHorizontalUniforms = THREE.UniformsUtils.clone(oceanHorizontalShader.uniforms);
        this.materialOceanHorizontal = new THREE.ShaderMaterial({
            uniforms: oceanHorizontalUniforms,
            vertexShader: fullscreeenVertexShader.vertexShader,
            fragmentShader: '#define HORIZONTAL \n' + oceanHorizontalShader.fragmentShader
        });
        this.materialOceanHorizontal.uniforms.u_transformSize = { value: this.resolution };
        this.materialOceanHorizontal.uniforms.u_subtransformSize = { value: null };
        this.materialOceanHorizontal.uniforms.u_input = { value: null };
        this.materialOceanHorizontal.depthTest = false;
        var oceanVerticalShader = OceanShaders['ocean_subtransform'];
        var oceanVerticalUniforms = THREE.UniformsUtils.clone(oceanVerticalShader.uniforms);
        this.materialOceanVertical = new THREE.ShaderMaterial({
            uniforms: oceanVerticalUniforms,
            vertexShader: fullscreeenVertexShader.vertexShader,
            fragmentShader: oceanVerticalShader.fragmentShader
        });
        this.materialOceanVertical.uniforms.u_transformSize = { value: this.resolution };
        this.materialOceanVertical.uniforms.u_subtransformSize = { value: null };
        this.materialOceanVertical.uniforms.u_input = { value: null };
        this.materialOceanVertical.depthTest = false;
        var initialSpectrumShader = OceanShaders['ocean_initial_spectrum'];
        var initialSpectrumUniforms = THREE.UniformsUtils.clone(initialSpectrumShader.uniforms);
        this.materialInitialSpectrum = new THREE.ShaderMaterial({
            uniforms: initialSpectrumUniforms,
            vertexShader: initialSpectrumShader.vertexShader,
            fragmentShader: initialSpectrumShader.fragmentShader
        });
        this.materialInitialSpectrum.uniforms.u_wind = { value: new THREE.Vector2() };
        this.materialInitialSpectrum.uniforms.u_resolution = { value: this.resolution };
        this.materialInitialSpectrum.depthTest = false;
        var phaseShader = OceanShaders['ocean_phase'];
        var phaseUniforms = THREE.UniformsUtils.clone(phaseShader.uniforms);
        this.materialPhase = new THREE.ShaderMaterial({
            uniforms: phaseUniforms,
            vertexShader: fullscreeenVertexShader.vertexShader,
            fragmentShader: phaseShader.fragmentShader
        });
        this.materialPhase.uniforms.u_resolution = { value: this.resolution };
        this.materialPhase.depthTest = false;
        var spectrumShader = OceanShaders['ocean_spectrum'];
        var spectrumUniforms = THREE.UniformsUtils.clone(spectrumShader.uniforms);
        this.materialSpectrum = new THREE.ShaderMaterial({
            uniforms: spectrumUniforms,
            vertexShader: fullscreeenVertexShader.vertexShader,
            fragmentShader: spectrumShader.fragmentShader
        });
        this.materialSpectrum.uniforms.u_initialSpectrum = { value: null };
        this.materialSpectrum.uniforms.u_resolution = { value: this.resolution };
        this.materialSpectrum.depthTest = false;
        var normalShader = OceanShaders['ocean_normals'];
        var normalUniforms = THREE.UniformsUtils.clone(normalShader.uniforms);
        this.materialNormal = new THREE.ShaderMaterial({
            uniforms: normalUniforms,
            vertexShader: fullscreeenVertexShader.vertexShader,
            fragmentShader: normalShader.fragmentShader
        });
        this.materialNormal.uniforms.u_displacementMap = { value: null };
        this.materialNormal.uniforms.u_resolution = { value: this.resolution };
        this.materialNormal.depthTest = false;
        var oceanShader = OceanShaders['ocean_main'];
        var oceanUniforms = THREE.UniformsUtils.clone(oceanShader.uniforms);
        this.materialOcean = new THREE.ShaderMaterial({
            uniforms: oceanUniforms,
            vertexShader: oceanShader.vertexShader,
            fragmentShader: oceanShader.fragmentShader
        });
        this.materialOcean.uniforms.u_geometrySize = { value: this.resolution };
        this.materialOcean.uniforms.u_displacementMap = { value: this.displacementMapFramebuffer.texture };
        this.materialOcean.uniforms.u_normalMap = { value: this.normalMapFramebuffer.texture };
        this.materialOcean.uniforms.u_oceanColor = { value: this.oceanColor };
        this.materialOcean.uniforms.u_skyColor = { value: this.skyColor };
        this.materialOcean.uniforms.u_sunDirection = { value: new THREE.Vector3(this.sunDirectionX, this.sunDirectionY, this.sunDirectionZ) };
        this.materialOcean.uniforms.u_exposure = { value: this.exposure };
        this.materialOceanHorizontal.blending = 0;
        this.materialOceanVertical.blending = 0;
        this.materialInitialSpectrum.blending = 0;
        this.materialPhase.blending = 0;
        this.materialSpectrum.blending = 0;
        this.materialNormal.blending = 0;
        this.materialOcean.blending = 0;
        this.screenQuad = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2));
        this.scene.add(this.screenQuad);
        this.generateSeedPhaseTexture();
        this.generateMesh();
    };
    Ocean.prototype.generateMesh = function () {
        var geometry = new THREE.PlaneBufferGeometry(this.geometrySize, this.geometrySize, this.geometryResolution, this.geometryResolution);
        geometry.rotateX(-Math.PI / 2);
        this.oceanMesh = new THREE.Mesh(geometry, this.materialOcean);
    };
    Ocean.prototype.render = function () {
        var currentRenderTarget = this.renderer.getRenderTarget();
        this.scene.overrideMaterial = null;
        if (this.changed)
            this.renderInitialSpectrum();
        this.renderWavePhase();
        this.renderSpectrum();
        this.renderSpectrumFFT();
        this.renderNormalMap();
        this.scene.overrideMaterial = null;
        this.renderer.setRenderTarget(currentRenderTarget);
    };
    Ocean.prototype.generateSeedPhaseTexture = function () {
        this.pingPhase = true;
        var phaseArray = new window.Float32Array(this.resolution * this.resolution * 4);
        for (var i = 0; i < this.resolution; i++) {
            for (var j = 0; j < this.resolution; j++) {
                phaseArray[i * this.resolution * 4 + j * 4] = Math.random() * 2 * Math.PI;
                phaseArray[i * this.resolution * 4 + j * 4 + 1] = 0;
                phaseArray[i * this.resolution * 4 + j * 4 + 2] = 0;
                phaseArray[i * this.resolution * 4 + j * 4 + 3] = 0;
            }
        }
        this.pingPhaseTexture = new THREE.DataTexture(phaseArray, this.resolution, this.resolution, THREE.RGBAFormat);
        this.pingPhaseTexture.wrapS = THREE.ClampToEdgeWrapping;
        this.pingPhaseTexture.wrapT = THREE.ClampToEdgeWrapping;
        this.pingPhaseTexture.type = THREE.FloatType;
    };
    Ocean.prototype.renderInitialSpectrum = function () {
        this.scene.overrideMaterial = this.materialInitialSpectrum;
        this.materialInitialSpectrum.uniforms.u_wind.value.set(this.windX, this.windY);
        this.materialInitialSpectrum.uniforms.u_size.value = this.size;
        this.renderer.setRenderTarget(this.initialSpectrumFramebuffer);
        this.renderer.clear();
        this.renderer.render(this.scene, this.oceanCamera);
    };
    Ocean.prototype.renderWavePhase = function () {
        this.scene.overrideMaterial = this.materialPhase;
        this.screenQuad.material = this.materialPhase;
        if (this.initial) {
            this.materialPhase.uniforms.u_phases.value = this.pingPhaseTexture;
            this.initial = false;
        } else {
            this.materialPhase.uniforms.u_phases.value = this.pingPhase ? this.pingPhaseFramebuffer.texture : this.pongPhaseFramebuffer.texture;
        }
        this.materialPhase.uniforms.u_deltaTime.value = this.deltaTime;
        this.materialPhase.uniforms.u_size.value = this.size;
        this.renderer.setRenderTarget(this.pingPhase ? this.pongPhaseFramebuffer : this.pingPhaseFramebuffer);
        this.renderer.render(this.scene, this.oceanCamera);
        this.pingPhase = !this.pingPhase;
    };
    Ocean.prototype.renderSpectrum = function () {
        this.scene.overrideMaterial = this.materialSpectrum;
        this.materialSpectrum.uniforms.u_initialSpectrum.value = this.initialSpectrumFramebuffer.texture;
        this.materialSpectrum.uniforms.u_phases.value = this.pingPhase ? this.pingPhaseFramebuffer.texture : this.pongPhaseFramebuffer.texture;
        this.materialSpectrum.uniforms.u_choppiness.value = this.choppiness;
        this.materialSpectrum.uniforms.u_size.value = this.size;
        this.renderer.setRenderTarget(this.spectrumFramebuffer);
        this.renderer.render(this.scene, this.oceanCamera);
    };
    Ocean.prototype.renderSpectrumFFT = function () {
        var iterations = Math.log(this.resolution) / Math.log(2);
        this.scene.overrideMaterial = this.materialOceanHorizontal;
        for (var i = 0; i < iterations; i++) {
            if (i === 0) {
                this.materialOceanHorizontal.uniforms.u_input.value = this.spectrumFramebuffer.texture;
                this.materialOceanHorizontal.uniforms.u_subtransformSize.value = Math.pow(2, i % iterations + 1);
                this.renderer.setRenderTarget(this.pingTransformFramebuffer);
                this.renderer.render(this.scene, this.oceanCamera);
            } else if (i % 2 === 1) {
                this.materialOceanHorizontal.uniforms.u_input.value = this.pingTransformFramebuffer.texture;
                this.materialOceanHorizontal.uniforms.u_subtransformSize.value = Math.pow(2, i % iterations + 1);
                this.renderer.setRenderTarget(this.pongTransformFramebuffer);
                this.renderer.render(this.scene, this.oceanCamera);
            } else {
                this.materialOceanHorizontal.uniforms.u_input.value = this.pongTransformFramebuffer.texture;
                this.materialOceanHorizontal.uniforms.u_subtransformSize.value = Math.pow(2, i % iterations + 1);
                this.renderer.setRenderTarget(this.pingTransformFramebuffer);
                this.renderer.render(this.scene, this.oceanCamera);
            }
        }
        this.scene.overrideMaterial = this.materialOceanVertical;
        for (var i = iterations; i < iterations * 2; i++) {
            if (i === iterations * 2 - 1) {
                this.materialOceanVertical.uniforms.u_input.value = iterations % 2 === 0 ? this.pingTransformFramebuffer.texture : this.pongTransformFramebuffer.texture;
                this.materialOceanVertical.uniforms.u_subtransformSize.value = Math.pow(2, i % iterations + 1);
                this.renderer.setRenderTarget(this.displacementMapFramebuffer);
                this.renderer.render(this.scene, this.oceanCamera);
            } else if (i % 2 === 1) {
                this.materialOceanVertical.uniforms.u_input.value = this.pingTransformFramebuffer.texture;
                this.materialOceanVertical.uniforms.u_subtransformSize.value = Math.pow(2, i % iterations + 1);
                this.renderer.setRenderTarget(this.pongTransformFramebuffer);
                this.renderer.render(this.scene, this.oceanCamera);
            } else {
                this.materialOceanVertical.uniforms.u_input.value = this.pongTransformFramebuffer.texture;
                this.materialOceanVertical.uniforms.u_subtransformSize.value = Math.pow(2, i % iterations + 1);
                this.renderer.setRenderTarget(this.pingTransformFramebuffer);
                this.renderer.render(this.scene, this.oceanCamera);
            }
        }
    };
    Ocean.prototype.renderNormalMap = function () {
        this.scene.overrideMaterial = this.materialNormal;
        if (this.changed)
            this.materialNormal.uniforms.u_size.value = this.size;
        this.materialNormal.uniforms.u_displacementMap.value = this.displacementMapFramebuffer.texture;
        this.renderer.setRenderTarget(this.normalMapFramebuffer);
        this.renderer.clear();
        this.renderer.render(this.scene, this.oceanCamera);
    };
    return threex.misc.Ocean = Ocean;
});
define('skylark-threejs-ex/misc/RollerCoaster',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var RollerCoasterGeometry = function (curve, divisions) {
        THREE.BufferGeometry.call(this);
        var vertices = [];
        var normals = [];
        var colors = [];
        var color1 = [
            1,
            1,
            1
        ];
        var color2 = [
            1,
            1,
            0
        ];
        var up = new THREE.Vector3(0, 1, 0);
        var forward = new THREE.Vector3();
        var right = new THREE.Vector3();
        var quaternion = new THREE.Quaternion();
        var prevQuaternion = new THREE.Quaternion();
        prevQuaternion.setFromAxisAngle(up, Math.PI / 2);
        var point = new THREE.Vector3();
        var prevPoint = new THREE.Vector3();
        prevPoint.copy(curve.getPointAt(0));
        var step = [
            new THREE.Vector3(-0.225, 0, 0),
            new THREE.Vector3(0, -0.05, 0),
            new THREE.Vector3(0, -0.175, 0),
            new THREE.Vector3(0, -0.05, 0),
            new THREE.Vector3(0.225, 0, 0),
            new THREE.Vector3(0, -0.175, 0)
        ];
        var PI2 = Math.PI * 2;
        var sides = 5;
        var tube1 = [];
        for (var i = 0; i < sides; i++) {
            var angle = i / sides * PI2;
            tube1.push(new THREE.Vector3(Math.sin(angle) * 0.06, Math.cos(angle) * 0.06, 0));
        }
        var sides = 6;
        var tube2 = [];
        for (var i = 0; i < sides; i++) {
            var angle = i / sides * PI2;
            tube2.push(new THREE.Vector3(Math.sin(angle) * 0.025, Math.cos(angle) * 0.025, 0));
        }
        var vector = new THREE.Vector3();
        var normal = new THREE.Vector3();
        function drawShape(shape, color) {
            normal.set(0, 0, -1).applyQuaternion(quaternion);
            for (var j = 0; j < shape.length; j++) {
                vector.copy(shape[j]);
                vector.applyQuaternion(quaternion);
                vector.add(point);
                vertices.push(vector.x, vector.y, vector.z);
                normals.push(normal.x, normal.y, normal.z);
                colors.push(color[0], color[1], color[2]);
            }
            normal.set(0, 0, 1).applyQuaternion(quaternion);
            for (var j = shape.length - 1; j >= 0; j--) {
                vector.copy(shape[j]);
                vector.applyQuaternion(quaternion);
                vector.add(point);
                vertices.push(vector.x, vector.y, vector.z);
                normals.push(normal.x, normal.y, normal.z);
                colors.push(color[0], color[1], color[2]);
            }
        }
        var vector1 = new THREE.Vector3();
        var vector2 = new THREE.Vector3();
        var vector3 = new THREE.Vector3();
        var vector4 = new THREE.Vector3();
        var normal1 = new THREE.Vector3();
        var normal2 = new THREE.Vector3();
        var normal3 = new THREE.Vector3();
        var normal4 = new THREE.Vector3();
        function extrudeShape(shape, offset, color) {
            for (var j = 0, jl = shape.length; j < jl; j++) {
                var point1 = shape[j];
                var point2 = shape[(j + 1) % jl];
                vector1.copy(point1).add(offset);
                vector1.applyQuaternion(quaternion);
                vector1.add(point);
                vector2.copy(point2).add(offset);
                vector2.applyQuaternion(quaternion);
                vector2.add(point);
                vector3.copy(point2).add(offset);
                vector3.applyQuaternion(prevQuaternion);
                vector3.add(prevPoint);
                vector4.copy(point1).add(offset);
                vector4.applyQuaternion(prevQuaternion);
                vector4.add(prevPoint);
                vertices.push(vector1.x, vector1.y, vector1.z);
                vertices.push(vector2.x, vector2.y, vector2.z);
                vertices.push(vector4.x, vector4.y, vector4.z);
                vertices.push(vector2.x, vector2.y, vector2.z);
                vertices.push(vector3.x, vector3.y, vector3.z);
                vertices.push(vector4.x, vector4.y, vector4.z);
                normal1.copy(point1);
                normal1.applyQuaternion(quaternion);
                normal1.normalize();
                normal2.copy(point2);
                normal2.applyQuaternion(quaternion);
                normal2.normalize();
                normal3.copy(point2);
                normal3.applyQuaternion(prevQuaternion);
                normal3.normalize();
                normal4.copy(point1);
                normal4.applyQuaternion(prevQuaternion);
                normal4.normalize();
                normals.push(normal1.x, normal1.y, normal1.z);
                normals.push(normal2.x, normal2.y, normal2.z);
                normals.push(normal4.x, normal4.y, normal4.z);
                normals.push(normal2.x, normal2.y, normal2.z);
                normals.push(normal3.x, normal3.y, normal3.z);
                normals.push(normal4.x, normal4.y, normal4.z);
                colors.push(color[0], color[1], color[2]);
                colors.push(color[0], color[1], color[2]);
                colors.push(color[0], color[1], color[2]);
                colors.push(color[0], color[1], color[2]);
                colors.push(color[0], color[1], color[2]);
                colors.push(color[0], color[1], color[2]);
            }
        }
        var offset = new THREE.Vector3();
        for (var i = 1; i <= divisions; i++) {
            point.copy(curve.getPointAt(i / divisions));
            up.set(0, 1, 0);
            forward.subVectors(point, prevPoint).normalize();
            right.crossVectors(up, forward).normalize();
            up.crossVectors(forward, right);
            var angle = Math.atan2(forward.x, forward.z);
            quaternion.setFromAxisAngle(up, angle);
            if (i % 2 === 0) {
                drawShape(step, color2);
            }
            extrudeShape(tube1, offset.set(0, -0.125, 0), color2);
            extrudeShape(tube2, offset.set(0.2, 0, 0), color1);
            extrudeShape(tube2, offset.set(-0.2, 0, 0), color1);
            prevPoint.copy(point);
            prevQuaternion.copy(quaternion);
        }
        this.setAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));
        this.setAttribute('normal', new THREE.BufferAttribute(new Float32Array(normals), 3));
        this.setAttribute('color', new THREE.BufferAttribute(new Float32Array(colors), 3));
    };
    RollerCoasterGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);
    var RollerCoasterLiftersGeometry = function (curve, divisions) {
        THREE.BufferGeometry.call(this);
        var vertices = [];
        var normals = [];
        var quaternion = new THREE.Quaternion();
        var up = new THREE.Vector3(0, 1, 0);
        var point = new THREE.Vector3();
        var tangent = new THREE.Vector3();
        var tube1 = [
            new THREE.Vector3(0, 0.05, -0.05),
            new THREE.Vector3(0, 0.05, 0.05),
            new THREE.Vector3(0, -0.05, 0)
        ];
        var tube2 = [
            new THREE.Vector3(-0.05, 0, 0.05),
            new THREE.Vector3(-0.05, 0, -0.05),
            new THREE.Vector3(0.05, 0, 0)
        ];
        var tube3 = [
            new THREE.Vector3(0.05, 0, -0.05),
            new THREE.Vector3(0.05, 0, 0.05),
            new THREE.Vector3(-0.05, 0, 0)
        ];
        var vector1 = new THREE.Vector3();
        var vector2 = new THREE.Vector3();
        var vector3 = new THREE.Vector3();
        var vector4 = new THREE.Vector3();
        var normal1 = new THREE.Vector3();
        var normal2 = new THREE.Vector3();
        var normal3 = new THREE.Vector3();
        var normal4 = new THREE.Vector3();
        function extrudeShape(shape, fromPoint, toPoint) {
            for (var j = 0, jl = shape.length; j < jl; j++) {
                var point1 = shape[j];
                var point2 = shape[(j + 1) % jl];
                vector1.copy(point1);
                vector1.applyQuaternion(quaternion);
                vector1.add(fromPoint);
                vector2.copy(point2);
                vector2.applyQuaternion(quaternion);
                vector2.add(fromPoint);
                vector3.copy(point2);
                vector3.applyQuaternion(quaternion);
                vector3.add(toPoint);
                vector4.copy(point1);
                vector4.applyQuaternion(quaternion);
                vector4.add(toPoint);
                vertices.push(vector1.x, vector1.y, vector1.z);
                vertices.push(vector2.x, vector2.y, vector2.z);
                vertices.push(vector4.x, vector4.y, vector4.z);
                vertices.push(vector2.x, vector2.y, vector2.z);
                vertices.push(vector3.x, vector3.y, vector3.z);
                vertices.push(vector4.x, vector4.y, vector4.z);
                normal1.copy(point1);
                normal1.applyQuaternion(quaternion);
                normal1.normalize();
                normal2.copy(point2);
                normal2.applyQuaternion(quaternion);
                normal2.normalize();
                normal3.copy(point2);
                normal3.applyQuaternion(quaternion);
                normal3.normalize();
                normal4.copy(point1);
                normal4.applyQuaternion(quaternion);
                normal4.normalize();
                normals.push(normal1.x, normal1.y, normal1.z);
                normals.push(normal2.x, normal2.y, normal2.z);
                normals.push(normal4.x, normal4.y, normal4.z);
                normals.push(normal2.x, normal2.y, normal2.z);
                normals.push(normal3.x, normal3.y, normal3.z);
                normals.push(normal4.x, normal4.y, normal4.z);
            }
        }
        var fromPoint = new THREE.Vector3();
        var toPoint = new THREE.Vector3();
        for (var i = 1; i <= divisions; i++) {
            point.copy(curve.getPointAt(i / divisions));
            tangent.copy(curve.getTangentAt(i / divisions));
            var angle = Math.atan2(tangent.x, tangent.z);
            quaternion.setFromAxisAngle(up, angle);
            if (point.y > 10) {
                fromPoint.set(-0.75, -0.35, 0);
                fromPoint.applyQuaternion(quaternion);
                fromPoint.add(point);
                toPoint.set(0.75, -0.35, 0);
                toPoint.applyQuaternion(quaternion);
                toPoint.add(point);
                extrudeShape(tube1, fromPoint, toPoint);
                fromPoint.set(-0.7, -0.3, 0);
                fromPoint.applyQuaternion(quaternion);
                fromPoint.add(point);
                toPoint.set(-0.7, -point.y, 0);
                toPoint.applyQuaternion(quaternion);
                toPoint.add(point);
                extrudeShape(tube2, fromPoint, toPoint);
                fromPoint.set(0.7, -0.3, 0);
                fromPoint.applyQuaternion(quaternion);
                fromPoint.add(point);
                toPoint.set(0.7, -point.y, 0);
                toPoint.applyQuaternion(quaternion);
                toPoint.add(point);
                extrudeShape(tube3, fromPoint, toPoint);
            } else {
                fromPoint.set(0, -0.2, 0);
                fromPoint.applyQuaternion(quaternion);
                fromPoint.add(point);
                toPoint.set(0, -point.y, 0);
                toPoint.applyQuaternion(quaternion);
                toPoint.add(point);
                extrudeShape(tube3, fromPoint, toPoint);
            }
        }
        this.setAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));
        this.setAttribute('normal', new THREE.BufferAttribute(new Float32Array(normals), 3));
    };
    RollerCoasterLiftersGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);
    var RollerCoasterShadowGeometry = function (curve, divisions) {
        THREE.BufferGeometry.call(this);
        var vertices = [];
        var up = new THREE.Vector3(0, 1, 0);
        var forward = new THREE.Vector3();
        var quaternion = new THREE.Quaternion();
        var prevQuaternion = new THREE.Quaternion();
        prevQuaternion.setFromAxisAngle(up, Math.PI / 2);
        var point = new THREE.Vector3();
        var prevPoint = new THREE.Vector3();
        prevPoint.copy(curve.getPointAt(0));
        prevPoint.y = 0;
        var vector1 = new THREE.Vector3();
        var vector2 = new THREE.Vector3();
        var vector3 = new THREE.Vector3();
        var vector4 = new THREE.Vector3();
        for (var i = 1; i <= divisions; i++) {
            point.copy(curve.getPointAt(i / divisions));
            point.y = 0;
            forward.subVectors(point, prevPoint);
            var angle = Math.atan2(forward.x, forward.z);
            quaternion.setFromAxisAngle(up, angle);
            vector1.set(-0.3, 0, 0);
            vector1.applyQuaternion(quaternion);
            vector1.add(point);
            vector2.set(0.3, 0, 0);
            vector2.applyQuaternion(quaternion);
            vector2.add(point);
            vector3.set(0.3, 0, 0);
            vector3.applyQuaternion(prevQuaternion);
            vector3.add(prevPoint);
            vector4.set(-0.3, 0, 0);
            vector4.applyQuaternion(prevQuaternion);
            vector4.add(prevPoint);
            vertices.push(vector1.x, vector1.y, vector1.z);
            vertices.push(vector2.x, vector2.y, vector2.z);
            vertices.push(vector4.x, vector4.y, vector4.z);
            vertices.push(vector2.x, vector2.y, vector2.z);
            vertices.push(vector3.x, vector3.y, vector3.z);
            vertices.push(vector4.x, vector4.y, vector4.z);
            prevPoint.copy(point);
            prevQuaternion.copy(quaternion);
        }
        this.setAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));
    };
    RollerCoasterShadowGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);
    var SkyGeometry = function () {
        THREE.BufferGeometry.call(this);
        var vertices = [];
        for (var i = 0; i < 100; i++) {
            var x = Math.random() * 800 - 400;
            var y = Math.random() * 50 + 50;
            var z = Math.random() * 800 - 400;
            var size = Math.random() * 40 + 20;
            vertices.push(x - size, y, z - size);
            vertices.push(x + size, y, z - size);
            vertices.push(x - size, y, z + size);
            vertices.push(x + size, y, z - size);
            vertices.push(x + size, y, z + size);
            vertices.push(x - size, y, z + size);
        }
        this.setAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));
    };
    SkyGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);
    var TreesGeometry = function (landscape) {
        THREE.BufferGeometry.call(this);
        var vertices = [];
        var colors = [];
        var raycaster = new THREE.Raycaster();
        raycaster.ray.direction.set(0, -1, 0);
        for (var i = 0; i < 2000; i++) {
            var x = Math.random() * 500 - 250;
            var z = Math.random() * 500 - 250;
            raycaster.ray.origin.set(x, 50, z);
            var intersections = raycaster.intersectObject(landscape);
            if (intersections.length === 0)
                continue;
            var y = intersections[0].point.y;
            var height = Math.random() * 5 + 0.5;
            var angle = Math.random() * Math.PI * 2;
            vertices.push(x + Math.sin(angle), y, z + Math.cos(angle));
            vertices.push(x, y + height, z);
            vertices.push(x + Math.sin(angle + Math.PI), y, z + Math.cos(angle + Math.PI));
            angle += Math.PI / 2;
            vertices.push(x + Math.sin(angle), y, z + Math.cos(angle));
            vertices.push(x, y + height, z);
            vertices.push(x + Math.sin(angle + Math.PI), y, z + Math.cos(angle + Math.PI));
            var random = Math.random() * 0.1;
            for (var j = 0; j < 6; j++) {
                colors.push(0.2 + random, 0.4 + random, 0);
            }
        }
        this.setAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));
        this.setAttribute('color', new THREE.BufferAttribute(new Float32Array(colors), 3));
    };
    TreesGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);

    return threex.misc.RollerCoaster = {
        RollerCoasterGeometry,
        RollerCoasterLiftersGeometry,
        RollerCoasterShadowGeometry,
        SkyGeometry,
        TreesGeometry
    };
});
define('skylark-threejs-ex/misc/TubePainter',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    function TubePainter() {
        const BUFFER_SIZE = 1000000 * 3;
        let positions = new THREE.BufferAttribute(new Float32Array(BUFFER_SIZE), 3);
        positions.usage = THREE.DynamicDrawUsage;
        let normals = new THREE.BufferAttribute(new Float32Array(BUFFER_SIZE), 3);
        normals.usage = THREE.DynamicDrawUsage;
        let colors = new THREE.BufferAttribute(new Float32Array(BUFFER_SIZE), 3);
        colors.usage = THREE.DynamicDrawUsage;
        let geometry = new THREE.BufferGeometry();
        geometry.setAttribute('position', positions);
        geometry.setAttribute('normal', normals);
        geometry.setAttribute('color', colors);
        geometry.drawRange.count = 0;
        let material = new THREE.MeshStandardMaterial({ vertexColors: THREE.VertexColors });
        let mesh = new THREE.Mesh(geometry, material);
        mesh.frustumCulled = false;
        function getPoints(size) {
            let PI2 = Math.PI * 2;
            let sides = 10;
            let array = [];
            let radius = 0.01 * size;
            for (let i = 0; i < sides; i++) {
                let angle = i / sides * PI2;
                array.push(new THREE.Vector3(Math.sin(angle) * radius, Math.cos(angle) * radius, 0));
            }
            return array;
        }
        let vector1 = new THREE.Vector3();
        let vector2 = new THREE.Vector3();
        let vector3 = new THREE.Vector3();
        let vector4 = new THREE.Vector3();
        let color = new THREE.Color(16777215);
        let size = 1;
        function stroke(position1, position2, matrix1, matrix2) {
            if (position1.distanceToSquared(position2) === 0)
                return;
            let count = geometry.drawRange.count;
            let points = getPoints(size);
            for (let i = 0, il = points.length; i < il; i++) {
                let vertex1 = points[i];
                let vertex2 = points[(i + 1) % il];
                vector1.copy(vertex1).applyMatrix4(matrix2).add(position2);
                vector2.copy(vertex2).applyMatrix4(matrix2).add(position2);
                vector3.copy(vertex2).applyMatrix4(matrix1).add(position1);
                vector4.copy(vertex1).applyMatrix4(matrix1).add(position1);
                vector1.toArray(positions.array, (count + 0) * 3);
                vector2.toArray(positions.array, (count + 1) * 3);
                vector4.toArray(positions.array, (count + 2) * 3);
                vector2.toArray(positions.array, (count + 3) * 3);
                vector3.toArray(positions.array, (count + 4) * 3);
                vector4.toArray(positions.array, (count + 5) * 3);
                vector1.copy(vertex1).applyMatrix4(matrix2).normalize();
                vector2.copy(vertex2).applyMatrix4(matrix2).normalize();
                vector3.copy(vertex2).applyMatrix4(matrix1).normalize();
                vector4.copy(vertex1).applyMatrix4(matrix1).normalize();
                vector1.toArray(normals.array, (count + 0) * 3);
                vector2.toArray(normals.array, (count + 1) * 3);
                vector4.toArray(normals.array, (count + 2) * 3);
                vector2.toArray(normals.array, (count + 3) * 3);
                vector3.toArray(normals.array, (count + 4) * 3);
                vector4.toArray(normals.array, (count + 5) * 3);
                color.toArray(colors.array, (count + 0) * 3);
                color.toArray(colors.array, (count + 1) * 3);
                color.toArray(colors.array, (count + 2) * 3);
                color.toArray(colors.array, (count + 3) * 3);
                color.toArray(colors.array, (count + 4) * 3);
                color.toArray(colors.array, (count + 5) * 3);
                count += 6;
            }
            geometry.drawRange.count = count;
        }
        let up = new THREE.Vector3(0, 1, 0);
        let point1 = new THREE.Vector3();
        let point2 = new THREE.Vector3();
        let matrix1 = new THREE.Matrix4();
        let matrix2 = new THREE.Matrix4();
        function moveTo(position) {
            point1.copy(position);
            matrix1.lookAt(point2, point1, up);
            point2.copy(position);
            matrix2.copy(matrix1);
        }
        function lineTo(position) {
            point1.copy(position);
            matrix1.lookAt(point2, point1, up);
            stroke(point1, point2, matrix1, matrix2);
            point2.copy(point1);
            matrix2.copy(matrix1);
        }
        function setSize(value) {
            size = value;
        }
        let count = 0;
        function update() {
            let start = count;
            let end = geometry.drawRange.count;
            if (start === end)
                return;
            positions.updateRange.offset = start * 3;
            positions.updateRange.count = (end - start) * 3;
            positions.needsUpdate = true;
            normals.updateRange.offset = start * 3;
            normals.updateRange.count = (end - start) * 3;
            normals.needsUpdate = true;
            colors.updateRange.offset = start * 3;
            colors.updateRange.count = (end - start) * 3;
            colors.needsUpdate = true;
            count = geometry.drawRange.count;
        }
        return {
            mesh: mesh,
            moveTo: moveTo,
            lineTo: lineTo,
            setSize: setSize,
            update: update
        };
    }
    return threex.misc.TubePainter = TubePainter;
});
define('skylark-threejs-ex/misc/VolumeSlice',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var VolumeSlice = function (volume, index, axis) {
        var slice = this;
        this.volume = volume;
        index = index || 0;
        Object.defineProperty(this, 'index', {
            get: function () {
                return index;
            },
            set: function (value) {
                index = value;
                slice.geometryNeedsUpdate = true;
                return index;
            }
        });
        this.axis = axis || 'z';
        this.canvas = document.createElement('canvas');
        this.canvasBuffer = document.createElement('canvas');
        this.updateGeometry();
        var canvasMap = new THREE.Texture(this.canvas);
        canvasMap.minFilter = THREE.LinearFilter;
        canvasMap.wrapS = canvasMap.wrapT = THREE.ClampToEdgeWrapping;
        var material = new THREE.MeshBasicMaterial({
            map: canvasMap,
            side: THREE.DoubleSide,
            transparent: true
        });
        this.mesh = new THREE.Mesh(this.geometry, material);
        this.mesh.matrixAutoUpdate = false;
        this.geometryNeedsUpdate = true;
        this.repaint();
    };
    VolumeSlice.prototype = {
        constructor: VolumeSlice,
        repaint: function () {
            if (this.geometryNeedsUpdate) {
                this.updateGeometry();
            }
            var iLength = this.iLength, jLength = this.jLength, sliceAccess = this.sliceAccess, volume = this.volume, canvas = this.canvasBuffer, ctx = this.ctxBuffer;
            var imgData = ctx.getImageData(0, 0, iLength, jLength);
            var data = imgData.data;
            var volumeData = volume.data;
            var upperThreshold = volume.upperThreshold;
            var lowerThreshold = volume.lowerThreshold;
            var windowLow = volume.windowLow;
            var windowHigh = volume.windowHigh;
            var pixelCount = 0;
            if (volume.dataType === 'label') {
                for (var j = 0; j < jLength; j++) {
                    for (var i = 0; i < iLength; i++) {
                        var label = volumeData[sliceAccess(i, j)];
                        label = label >= this.colorMap.length ? label % this.colorMap.length + 1 : label;
                        var color = this.colorMap[label];
                        data[4 * pixelCount] = color >> 24 & 255;
                        data[4 * pixelCount + 1] = color >> 16 & 255;
                        data[4 * pixelCount + 2] = color >> 8 & 255;
                        data[4 * pixelCount + 3] = color & 255;
                        pixelCount++;
                    }
                }
            } else {
                for (var j = 0; j < jLength; j++) {
                    for (var i = 0; i < iLength; i++) {
                        var value = volumeData[sliceAccess(i, j)];
                        var alpha = 255;
                        alpha = upperThreshold >= value ? lowerThreshold <= value ? alpha : 0 : 0;
                        value = Math.floor(255 * (value - windowLow) / (windowHigh - windowLow));
                        value = value > 255 ? 255 : value < 0 ? 0 : value | 0;
                        data[4 * pixelCount] = value;
                        data[4 * pixelCount + 1] = value;
                        data[4 * pixelCount + 2] = value;
                        data[4 * pixelCount + 3] = alpha;
                        pixelCount++;
                    }
                }
            }
            ctx.putImageData(imgData, 0, 0);
            this.ctx.drawImage(canvas, 0, 0, iLength, jLength, 0, 0, this.canvas.width, this.canvas.height);
            this.mesh.material.map.needsUpdate = true;
        },
        updateGeometry: function () {
            var extracted = this.volume.extractPerpendicularPlane(this.axis, this.index);
            this.sliceAccess = extracted.sliceAccess;
            this.jLength = extracted.jLength;
            this.iLength = extracted.iLength;
            this.matrix = extracted.matrix;
            this.canvas.width = extracted.planeWidth;
            this.canvas.height = extracted.planeHeight;
            this.canvasBuffer.width = this.iLength;
            this.canvasBuffer.height = this.jLength;
            this.ctx = this.canvas.getContext('2d');
            this.ctxBuffer = this.canvasBuffer.getContext('2d');
            if (this.geometry)
                this.geometry.dispose();
            this.geometry = new THREE.PlaneBufferGeometry(extracted.planeWidth, extracted.planeHeight);
            if (this.mesh) {
                this.mesh.geometry = this.geometry;
                this.mesh.matrix.identity();
                this.mesh.applyMatrix4(this.matrix);
            }
            this.geometryNeedsUpdate = false;
        }
    };
    return threex.misc.VolumeSlice = VolumeSlice;
});
define('skylark-threejs-ex/misc/Volume',[
    "skylark-threejs",
    "../threex",
    '../misc/VolumeSlice'
], function (
    THREE, 
    threex,
    VolumeSlice
) {
    'use strict';
    var Volume = function (xLength, yLength, zLength, type, arrayBuffer) {
        if (arguments.length > 0) {
            this.xLength = Number(xLength) || 1;
            this.yLength = Number(yLength) || 1;
            this.zLength = Number(zLength) || 1;
            switch (type) {
            case 'Uint8':
            case 'uint8':
            case 'uchar':
            case 'unsigned char':
            case 'uint8_t':
                this.data = new Uint8Array(arrayBuffer);
                break;
            case 'Int8':
            case 'int8':
            case 'signed char':
            case 'int8_t':
                this.data = new Int8Array(arrayBuffer);
                break;
            case 'Int16':
            case 'int16':
            case 'short':
            case 'short int':
            case 'signed short':
            case 'signed short int':
            case 'int16_t':
                this.data = new Int16Array(arrayBuffer);
                break;
            case 'Uint16':
            case 'uint16':
            case 'ushort':
            case 'unsigned short':
            case 'unsigned short int':
            case 'uint16_t':
                this.data = new Uint16Array(arrayBuffer);
                break;
            case 'Int32':
            case 'int32':
            case 'int':
            case 'signed int':
            case 'int32_t':
                this.data = new Int32Array(arrayBuffer);
                break;
            case 'Uint32':
            case 'uint32':
            case 'uint':
            case 'unsigned int':
            case 'uint32_t':
                this.data = new Uint32Array(arrayBuffer);
                break;
            case 'longlong':
            case 'long long':
            case 'long long int':
            case 'signed long long':
            case 'signed long long int':
            case 'int64':
            case 'int64_t':
            case 'ulonglong':
            case 'unsigned long long':
            case 'unsigned long long int':
            case 'uint64':
            case 'uint64_t':
                throw 'Error in Volume constructor : this type is not supported in JavaScript';
                break;
            case 'Float32':
            case 'float32':
            case 'float':
                this.data = new Float32Array(arrayBuffer);
                break;
            case 'Float64':
            case 'float64':
            case 'double':
                this.data = new Float64Array(arrayBuffer);
                break;
            default:
                this.data = new Uint8Array(arrayBuffer);
            }
            if (this.data.length !== this.xLength * this.yLength * this.zLength) {
                throw 'Error in Volume constructor, lengths are not matching arrayBuffer size';
            }
        }
        this.spacing = [
            1,
            1,
            1
        ];
        this.offset = [
            0,
            0,
            0
        ];
        this.matrix = new THREE.Matrix3();
        this.matrix.identity();
        var lowerThreshold = -Infinity;
        Object.defineProperty(this, 'lowerThreshold', {
            get: function () {
                return lowerThreshold;
            },
            set: function (value) {
                lowerThreshold = value;
                this.sliceList.forEach(function (slice) {
                    slice.geometryNeedsUpdate = true;
                });
            }
        });
        var upperThreshold = Infinity;
        Object.defineProperty(this, 'upperThreshold', {
            get: function () {
                return upperThreshold;
            },
            set: function (value) {
                upperThreshold = value;
                this.sliceList.forEach(function (slice) {
                    slice.geometryNeedsUpdate = true;
                });
            }
        });
        this.sliceList = [];
    };
    Volume.prototype = {
        constructor: Volume,
        getData: function (i, j, k) {
            return this.data[k * this.xLength * this.yLength + j * this.xLength + i];
        },
        access: function (i, j, k) {
            return k * this.xLength * this.yLength + j * this.xLength + i;
        },
        reverseAccess: function (index) {
            var z = Math.floor(index / (this.yLength * this.xLength));
            var y = Math.floor((index - z * this.yLength * this.xLength) / this.xLength);
            var x = index - z * this.yLength * this.xLength - y * this.xLength;
            return [
                x,
                y,
                z
            ];
        },
        map: function (functionToMap, context) {
            var length = this.data.length;
            context = context || this;
            for (var i = 0; i < length; i++) {
                this.data[i] = functionToMap.call(context, this.data[i], i, this.data);
            }
            return this;
        },
        extractPerpendicularPlane: function (axis, RASIndex) {
            var iLength, jLength, sliceAccess, planeMatrix = new THREE.Matrix4().identity(), volume = this, planeWidth, planeHeight, firstSpacing, secondSpacing, positionOffset, IJKIndex;
            var axisInIJK = new THREE.Vector3(), firstDirection = new THREE.Vector3(), secondDirection = new THREE.Vector3();
            var dimensions = new THREE.Vector3(this.xLength, this.yLength, this.zLength);
            switch (axis) {
            case 'x':
                axisInIJK.set(1, 0, 0);
                firstDirection.set(0, 0, -1);
                secondDirection.set(0, -1, 0);
                firstSpacing = this.spacing[2];
                secondSpacing = this.spacing[1];
                IJKIndex = new THREE.Vector3(RASIndex, 0, 0);
                planeMatrix.multiply(new THREE.Matrix4().makeRotationY(Math.PI / 2));
                positionOffset = (volume.RASDimensions[0] - 1) / 2;
                planeMatrix.setPosition(new THREE.Vector3(RASIndex - positionOffset, 0, 0));
                break;
            case 'y':
                axisInIJK.set(0, 1, 0);
                firstDirection.set(1, 0, 0);
                secondDirection.set(0, 0, 1);
                firstSpacing = this.spacing[0];
                secondSpacing = this.spacing[2];
                IJKIndex = new THREE.Vector3(0, RASIndex, 0);
                planeMatrix.multiply(new THREE.Matrix4().makeRotationX(-Math.PI / 2));
                positionOffset = (volume.RASDimensions[1] - 1) / 2;
                planeMatrix.setPosition(new THREE.Vector3(0, RASIndex - positionOffset, 0));
                break;
            case 'z':
            default:
                axisInIJK.set(0, 0, 1);
                firstDirection.set(1, 0, 0);
                secondDirection.set(0, -1, 0);
                firstSpacing = this.spacing[0];
                secondSpacing = this.spacing[1];
                IJKIndex = new THREE.Vector3(0, 0, RASIndex);
                positionOffset = (volume.RASDimensions[2] - 1) / 2;
                planeMatrix.setPosition(new THREE.Vector3(0, 0, RASIndex - positionOffset));
                break;
            }
            firstDirection.applyMatrix4(volume.inverseMatrix).normalize();
            firstDirection.argVar = 'i';
            secondDirection.applyMatrix4(volume.inverseMatrix).normalize();
            secondDirection.argVar = 'j';
            axisInIJK.applyMatrix4(volume.inverseMatrix).normalize();
            iLength = Math.floor(Math.abs(firstDirection.dot(dimensions)));
            jLength = Math.floor(Math.abs(secondDirection.dot(dimensions)));
            planeWidth = Math.abs(iLength * firstSpacing);
            planeHeight = Math.abs(jLength * secondSpacing);
            IJKIndex = Math.abs(Math.round(IJKIndex.applyMatrix4(volume.inverseMatrix).dot(axisInIJK)));
            var base = [
                new THREE.Vector3(1, 0, 0),
                new THREE.Vector3(0, 1, 0),
                new THREE.Vector3(0, 0, 1)
            ];
            var iDirection = [
                firstDirection,
                secondDirection,
                axisInIJK
            ].find(function (x) {
                return Math.abs(x.dot(base[0])) > 0.9;
            });
            var jDirection = [
                firstDirection,
                secondDirection,
                axisInIJK
            ].find(function (x) {
                return Math.abs(x.dot(base[1])) > 0.9;
            });
            var kDirection = [
                firstDirection,
                secondDirection,
                axisInIJK
            ].find(function (x) {
                return Math.abs(x.dot(base[2])) > 0.9;
            });
            var argumentsWithInversion = [
                'volume.xLength-1-',
                'volume.yLength-1-',
                'volume.zLength-1-'
            ];
            var argArray = [
                iDirection,
                jDirection,
                kDirection
            ].map(function (direction, n) {
                return (direction.dot(base[n]) > 0 ? '' : argumentsWithInversion[n]) + (direction === axisInIJK ? 'IJKIndex' : direction.argVar);
            });
            var argString = argArray.join(',');
            sliceAccess = eval('(function sliceAccess (i,j) {return volume.access( ' + argString + ');})');
            return {
                iLength: iLength,
                jLength: jLength,
                sliceAccess: sliceAccess,
                matrix: planeMatrix,
                planeWidth: planeWidth,
                planeHeight: planeHeight
            };
        },
        extractSlice: function (axis, index) {
            var slice = new VolumeSlice(this, index, axis);
            this.sliceList.push(slice);
            return slice;
        },
        repaintAllSlices: function () {
            this.sliceList.forEach(function (slice) {
                slice.repaint();
            });
            return this;
        },
        computeMinMax: function () {
            var min = Infinity;
            var max = -Infinity;
            var datasize = this.data.length;
            var i = 0;
            for (i = 0; i < datasize; i++) {
                if (!isNaN(this.data[i])) {
                    var value = this.data[i];
                    min = Math.min(min, value);
                    max = Math.max(max, value);
                }
            }
            this.min = min;
            this.max = max;
            return [
                min,
                max
            ];
        }
    };
    return threex.misc.Volume = Volume;
});
define('skylark-threejs-ex/modifiers/ExplodeModifier',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ExplodeModifier = function () {
    };
    ExplodeModifier.prototype.modify = function (geometry) {
        var vertices = [];
        for (var i = 0, il = geometry.faces.length; i < il; i++) {
            var n = vertices.length;
            var face = geometry.faces[i];
            var a = face.a;
            var b = face.b;
            var c = face.c;
            var va = geometry.vertices[a];
            var vb = geometry.vertices[b];
            var vc = geometry.vertices[c];
            vertices.push(va.clone());
            vertices.push(vb.clone());
            vertices.push(vc.clone());
            face.a = n;
            face.b = n + 1;
            face.c = n + 2;
        }
        geometry.vertices = vertices;
    };
    return threex.modifiers.ExplodeModifier = ExplodeModifier;
});
define('skylark-threejs-ex/modifiers/SimplifyModifier',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var SimplifyModifier = function () {
    };
    (function () {
        var cb = new THREE.Vector3(), ab = new THREE.Vector3();
        function pushIfUnique(array, object) {
            if (array.indexOf(object) === -1)
                array.push(object);
        }
        function removeFromArray(array, object) {
            var k = array.indexOf(object);
            if (k > -1)
                array.splice(k, 1);
        }
        function computeEdgeCollapseCost(u, v) {
            var edgelength = v.position.distanceTo(u.position);
            var curvature = 0;
            var sideFaces = [];
            var i, il = u.faces.length, face, sideFace;
            for (i = 0; i < il; i++) {
                face = u.faces[i];
                if (face.hasVertex(v)) {
                    sideFaces.push(face);
                }
            }
            for (i = 0; i < il; i++) {
                var minCurvature = 1;
                face = u.faces[i];
                for (var j = 0; j < sideFaces.length; j++) {
                    sideFace = sideFaces[j];
                    var dotProd = face.normal.dot(sideFace.normal);
                    minCurvature = Math.min(minCurvature, (1.001 - dotProd) / 2);
                }
                curvature = Math.max(curvature, minCurvature);
            }
            var borders = 0;
            if (sideFaces.length < 2) {
                curvature = 1;
            }
            var amt = edgelength * curvature + borders;
            return amt;
        }
        function computeEdgeCostAtVertex(v) {
            if (v.neighbors.length === 0) {
                v.collapseNeighbor = null;
                v.collapseCost = -0.01;
                return;
            }
            v.collapseCost = 100000;
            v.collapseNeighbor = null;
            for (var i = 0; i < v.neighbors.length; i++) {
                var collapseCost = computeEdgeCollapseCost(v, v.neighbors[i]);
                if (!v.collapseNeighbor) {
                    v.collapseNeighbor = v.neighbors[i];
                    v.collapseCost = collapseCost;
                    v.minCost = collapseCost;
                    v.totalCost = 0;
                    v.costCount = 0;
                }
                v.costCount++;
                v.totalCost += collapseCost;
                if (collapseCost < v.minCost) {
                    v.collapseNeighbor = v.neighbors[i];
                    v.minCost = collapseCost;
                }
            }
            v.collapseCost = v.totalCost / v.costCount;
        }
        function removeVertex(v, vertices) {
            console.assert(v.faces.length === 0);
            while (v.neighbors.length) {
                var n = v.neighbors.pop();
                removeFromArray(n.neighbors, v);
            }
            removeFromArray(vertices, v);
        }
        function removeFace(f, faces) {
            removeFromArray(faces, f);
            if (f.v1)
                removeFromArray(f.v1.faces, f);
            if (f.v2)
                removeFromArray(f.v2.faces, f);
            if (f.v3)
                removeFromArray(f.v3.faces, f);
            var vs = [
                f.v1,
                f.v2,
                f.v3
            ];
            var v1, v2;
            for (var i = 0; i < 3; i++) {
                v1 = vs[i];
                v2 = vs[(i + 1) % 3];
                if (!v1 || !v2)
                    continue;
                v1.removeIfNonNeighbor(v2);
                v2.removeIfNonNeighbor(v1);
            }
        }
        function collapse(vertices, faces, u, v) {
            if (!v) {
                removeVertex(u, vertices);
                return;
            }
            var i;
            var tmpVertices = [];
            for (i = 0; i < u.neighbors.length; i++) {
                tmpVertices.push(u.neighbors[i]);
            }
            for (i = u.faces.length - 1; i >= 0; i--) {
                if (u.faces[i].hasVertex(v)) {
                    removeFace(u.faces[i], faces);
                }
            }
            for (i = u.faces.length - 1; i >= 0; i--) {
                u.faces[i].replaceVertex(u, v);
            }
            removeVertex(u, vertices);
            for (i = 0; i < tmpVertices.length; i++) {
                computeEdgeCostAtVertex(tmpVertices[i]);
            }
        }
        function minimumCostEdge(vertices) {
            var least = vertices[0];
            for (var i = 0; i < vertices.length; i++) {
                if (vertices[i].collapseCost < least.collapseCost) {
                    least = vertices[i];
                }
            }
            return least;
        }
        function Triangle(v1, v2, v3, a, b, c) {
            this.a = a;
            this.b = b;
            this.c = c;
            this.v1 = v1;
            this.v2 = v2;
            this.v3 = v3;
            this.normal = new THREE.Vector3();
            this.computeNormal();
            v1.faces.push(this);
            v1.addUniqueNeighbor(v2);
            v1.addUniqueNeighbor(v3);
            v2.faces.push(this);
            v2.addUniqueNeighbor(v1);
            v2.addUniqueNeighbor(v3);
            v3.faces.push(this);
            v3.addUniqueNeighbor(v1);
            v3.addUniqueNeighbor(v2);
        }
        Triangle.prototype.computeNormal = function () {
            var vA = this.v1.position;
            var vB = this.v2.position;
            var vC = this.v3.position;
            cb.subVectors(vC, vB);
            ab.subVectors(vA, vB);
            cb.cross(ab).normalize();
            this.normal.copy(cb);
        };
        Triangle.prototype.hasVertex = function (v) {
            return v === this.v1 || v === this.v2 || v === this.v3;
        };
        Triangle.prototype.replaceVertex = function (oldv, newv) {
            if (oldv === this.v1)
                this.v1 = newv;
            else if (oldv === this.v2)
                this.v2 = newv;
            else if (oldv === this.v3)
                this.v3 = newv;
            removeFromArray(oldv.faces, this);
            newv.faces.push(this);
            oldv.removeIfNonNeighbor(this.v1);
            this.v1.removeIfNonNeighbor(oldv);
            oldv.removeIfNonNeighbor(this.v2);
            this.v2.removeIfNonNeighbor(oldv);
            oldv.removeIfNonNeighbor(this.v3);
            this.v3.removeIfNonNeighbor(oldv);
            this.v1.addUniqueNeighbor(this.v2);
            this.v1.addUniqueNeighbor(this.v3);
            this.v2.addUniqueNeighbor(this.v1);
            this.v2.addUniqueNeighbor(this.v3);
            this.v3.addUniqueNeighbor(this.v1);
            this.v3.addUniqueNeighbor(this.v2);
            this.computeNormal();
        };
        function Vertex(v, id) {
            this.position = v;
            this.id = id;
            this.faces = [];
            this.neighbors = [];
            this.collapseCost = 0;
            this.collapseNeighbor = null;
        }
        Vertex.prototype.addUniqueNeighbor = function (vertex) {
            pushIfUnique(this.neighbors, vertex);
        };
        Vertex.prototype.removeIfNonNeighbor = function (n) {
            var neighbors = this.neighbors;
            var faces = this.faces;
            var offset = neighbors.indexOf(n);
            if (offset === -1)
                return;
            for (var i = 0; i < faces.length; i++) {
                if (faces[i].hasVertex(n))
                    return;
            }
            neighbors.splice(offset, 1);
        };
        SimplifyModifier.prototype.modify = function (geometry, count) {
            if (geometry.isBufferGeometry) {
                geometry = new THREE.Geometry().fromBufferGeometry(geometry);
            }
            geometry.mergeVertices();
            var oldVertices = geometry.vertices;
            var oldFaces = geometry.faces;
            var vertices = [];
            var faces = [];
            var i, il;
            for (i = 0, il = oldVertices.length; i < il; i++) {
                var vertex = new Vertex(oldVertices[i], i);
                vertices.push(vertex);
            }
            for (i = 0, il = oldFaces.length; i < il; i++) {
                var face = oldFaces[i];
                var a = face.a;
                var b = face.b;
                var c = face.c;
                var triangle = new Triangle(vertices[a], vertices[b], vertices[c], a, b, c);
                faces.push(triangle);
            }
            for (i = 0, il = vertices.length; i < il; i++) {
                computeEdgeCostAtVertex(vertices[i]);
            }
            var nextVertex;
            var z = count;
            while (z--) {
                nextVertex = minimumCostEdge(vertices);
                if (!nextVertex) {
                    console.log('THREE.SimplifyModifier: No next vertex');
                    break;
                }
                collapse(vertices, faces, nextVertex, nextVertex.collapseNeighbor);
            }
            var simplifiedGeometry = new THREE.BufferGeometry();
            var position = [];
            var index = [];
            for (i = 0; i < vertices.length; i++) {
                var vertex = vertices[i].position;
                position.push(vertex.x, vertex.y, vertex.z);
            }
            for (i = 0; i < faces.length; i++) {
                var face = faces[i];
                var a = vertices.indexOf(face.v1);
                var b = vertices.indexOf(face.v2);
                var c = vertices.indexOf(face.v3);
                index.push(a, b, c);
            }
            simplifiedGeometry.setAttribute('position', new THREE.Float32BufferAttribute(position, 3));
            simplifiedGeometry.setIndex(index);
            return simplifiedGeometry;
        };
    }());

    return threex.modifiers.SimplifyModifier = SimplifyModifier;
});
define('skylark-threejs-ex/modifiers/SubdivisionModifier',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var SubdivisionModifier = function (subdivisions) {
        this.subdivisions = subdivisions === undefined ? 1 : subdivisions;
    };
    SubdivisionModifier.prototype.modify = function (geometry) {
        if (geometry.isBufferGeometry) {
            geometry = new THREE.Geometry().fromBufferGeometry(geometry);
        } else {
            geometry = geometry.clone();
        }
        geometry.mergeVertices();
        var repeats = this.subdivisions;
        while (repeats-- > 0) {
            this.smooth(geometry);
        }
        geometry.computeFaceNormals();
        geometry.computeVertexNormals();
        return geometry;
    };
    (function () {
        var ABC = [
            'a',
            'b',
            'c'
        ];
        function getEdge(a, b, map) {
            var vertexIndexA = Math.min(a, b);
            var vertexIndexB = Math.max(a, b);
            var key = vertexIndexA + '_' + vertexIndexB;
            return map[key];
        }
        function processEdge(a, b, vertices, map, face, metaVertices) {
            var vertexIndexA = Math.min(a, b);
            var vertexIndexB = Math.max(a, b);
            var key = vertexIndexA + '_' + vertexIndexB;
            var edge;
            if (key in map) {
                edge = map[key];
            } else {
                var vertexA = vertices[vertexIndexA];
                var vertexB = vertices[vertexIndexB];
                edge = {
                    a: vertexA,
                    b: vertexB,
                    newEdge: null,
                    faces: []
                };
                map[key] = edge;
            }
            edge.faces.push(face);
            metaVertices[a].edges.push(edge);
            metaVertices[b].edges.push(edge);
        }
        function generateLookups(vertices, faces, metaVertices, edges) {
            var i, il, face;
            for (i = 0, il = vertices.length; i < il; i++) {
                metaVertices[i] = { edges: [] };
            }
            for (i = 0, il = faces.length; i < il; i++) {
                face = faces[i];
                processEdge(face.a, face.b, vertices, edges, face, metaVertices);
                processEdge(face.b, face.c, vertices, edges, face, metaVertices);
                processEdge(face.c, face.a, vertices, edges, face, metaVertices);
            }
        }
        function newFace(newFaces, a, b, c, materialIndex) {
            newFaces.push(new THREE.Face3(a, b, c, undefined, undefined, materialIndex));
        }
        function midpoint(a, b) {
            return Math.abs(b - a) / 2 + Math.min(a, b);
        }
        function newUv(newUvs, a, b, c) {
            newUvs.push([
                THREE.clone(),
                b.clone(),
                c.clone()
            ]);
        }
        SubdivisionModifier.prototype.smooth = function (geometry) {
            var tmp = new THREE.Vector3();
            var oldVertices, oldFaces, oldUvs;
            var newVertices, newFaces, newUVs = [];
            var n, i, il, j, k;
            var metaVertices, sourceEdges;
            var sourceEdges, newEdgeVertices, newSourceVertices;
            oldVertices = geometry.vertices;
            oldFaces = geometry.faces;
            oldUvs = geometry.faceVertexUvs;
            var hasUvs = oldUvs[0] !== undefined && oldUvs[0].length > 0;
            if (hasUvs) {
                for (var j = 0; j < oldUvs.length; j++) {
                    newUVs.push([]);
                }
            }
            metaVertices = new Array(oldVertices.length);
            sourceEdges = {};
            generateLookups(oldVertices, oldFaces, metaVertices, sourceEdges);
            newEdgeVertices = [];
            var other, currentEdge, newEdge, face;
            var edgeVertexWeight, adjacentVertexWeight, connectedFaces;
            for (i in sourceEdges) {
                currentEdge = sourceEdges[i];
                newEdge = new THREE.Vector3();
                edgeVertexWeight = 3 / 8;
                adjacentVertexWeight = 1 / 8;
                connectedFaces = currentEdge.faces.length;
                if (connectedFaces != 2) {
                    edgeVertexWeight = 0.5;
                    adjacentVertexWeight = 0;
                    if (connectedFaces != 1) {
                    }
                }
                newEdge.addVectors(currentEdge.a, currentEdge.b).multiplyScalar(edgeVertexWeight);
                tmp.set(0, 0, 0);
                for (j = 0; j < connectedFaces; j++) {
                    face = currentEdge.faces[j];
                    for (k = 0; k < 3; k++) {
                        other = oldVertices[face[ABC[k]]];
                        if (other !== currentEdge.a && other !== currentEdge.b)
                            break;
                    }
                    tmp.add(other);
                }
                tmp.multiplyScalar(adjacentVertexWeight);
                newEdge.add(tmp);
                currentEdge.newEdge = newEdgeVertices.length;
                newEdgeVertices.push(newEdge);
            }
            var beta, sourceVertexWeight, connectingVertexWeight;
            var connectingEdge, connectingEdges, oldVertex, newSourceVertex;
            newSourceVertices = [];
            for (i = 0, il = oldVertices.length; i < il; i++) {
                oldVertex = oldVertices[i];
                connectingEdges = metaVertices[i].edges;
                n = connectingEdges.length;
                if (n == 3) {
                    beta = 3 / 16;
                } else if (n > 3) {
                    beta = 3 / (8 * n);
                }
                sourceVertexWeight = 1 - n * beta;
                connectingVertexWeight = beta;
                if (n <= 2) {
                    if (n == 2) {
                        sourceVertexWeight = 3 / 4;
                        connectingVertexWeight = 1 / 8;
                    } else if (n == 1) {
                    } else if (n == 0) {
                    }
                }
                newSourceVertex = oldVertex.clone().multiplyScalar(sourceVertexWeight);
                tmp.set(0, 0, 0);
                for (j = 0; j < n; j++) {
                    connectingEdge = connectingEdges[j];
                    other = connectingEdge.a !== oldVertex ? connectingEdge.a : connectingEdge.b;
                    tmp.add(other);
                }
                tmp.multiplyScalar(connectingVertexWeight);
                newSourceVertex.add(tmp);
                newSourceVertices.push(newSourceVertex);
            }
            newVertices = newSourceVertices.concat(newEdgeVertices);
            var sl = newSourceVertices.length, edge1, edge2, edge3;
            newFaces = [];
            var uv, x0, x1, x2;
            var x3 = new THREE.Vector2();
            var x4 = new THREE.Vector2();
            var x5 = new THREE.Vector2();
            for (i = 0, il = oldFaces.length; i < il; i++) {
                face = oldFaces[i];
                edge1 = getEdge(face.a, face.b, sourceEdges).newEdge + sl;
                edge2 = getEdge(face.b, face.c, sourceEdges).newEdge + sl;
                edge3 = getEdge(face.c, face.a, sourceEdges).newEdge + sl;
                newFace(newFaces, edge1, edge2, edge3, face.materialIndex);
                newFace(newFaces, face.a, edge1, edge3, face.materialIndex);
                newFace(newFaces, face.b, edge2, edge1, face.materialIndex);
                newFace(newFaces, face.c, edge3, edge2, face.materialIndex);
                if (hasUvs) {
                    for (var j = 0; j < oldUvs.length; j++) {
                        uv = oldUvs[j][i];
                        x0 = uv[0];
                        x1 = uv[1];
                        x2 = uv[2];
                        x3.set(midpoint(x0.x, x1.x), midpoint(x0.y, x1.y));
                        x4.set(midpoint(x1.x, x2.x), midpoint(x1.y, x2.y));
                        x5.set(midpoint(x0.x, x2.x), midpoint(x0.y, x2.y));
                        newUv(newUVs[j], x3, x4, x5);
                        newUv(newUVs[j], x0, x3, x5);
                        newUv(newUVs[j], x1, x4, x3);
                        newUv(newUVs[j], x2, x5, x4);
                    }
                }
            }
            geometry.vertices = newVertices;
            geometry.faces = newFaces;
            if (hasUvs)
                geometry.faceVertexUvs = newUVs;
        };
    }());

    return threex.modifiers.SubdivisionModifier = SubdivisionModifier;
});
define('skylark-threejs-ex/modifiers/TessellateModifier',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var TessellateModifier = function (maxEdgeLength) {
        this.maxEdgeLength = maxEdgeLength;
    };
    TessellateModifier.prototype.modify = function (geometry) {
        var edge;
        var faces = [];
        var faceVertexUvs = [];
        var maxEdgeLengthSquared = this.maxEdgeLength * this.maxEdgeLength;
        for (var i = 0, il = geometry.faceVertexUvs.length; i < il; i++) {
            faceVertexUvs[i] = [];
        }
        for (var i = 0, il = geometry.faces.length; i < il; i++) {
            var face = geometry.faces[i];
            if (face instanceof THREE.Face3) {
                var a = face.a;
                var b = face.b;
                var c = face.c;
                var va = geometry.vertices[a];
                var vb = geometry.vertices[b];
                var vc = geometry.vertices[c];
                var dab = va.distanceToSquared(vb);
                var dbc = vb.distanceToSquared(vc);
                var dac = va.distanceToSquared(vc);
                if (dab > maxEdgeLengthSquared || dbc > maxEdgeLengthSquared || dac > maxEdgeLengthSquared) {
                    var m = geometry.vertices.length;
                    var triA = face.clone();
                    var triB = face.clone();
                    if (dab >= dbc && dab >= dac) {
                        var vm = va.clone();
                        vm.lerp(vb, 0.5);
                        triA.a = a;
                        triA.b = m;
                        triA.c = c;
                        triB.a = m;
                        triB.b = b;
                        triB.c = c;
                        if (face.vertexNormals.length === 3) {
                            var vnm = face.vertexNormals[0].clone();
                            vnm.lerp(face.vertexNormals[1], 0.5);
                            triA.vertexNormals[1].copy(vnm);
                            triB.vertexNormals[0].copy(vnm);
                        }
                        if (face.vertexColors.length === 3) {
                            var vcm = face.vertexColors[0].clone();
                            vcm.lerp(face.vertexColors[1], 0.5);
                            triA.vertexColors[1].copy(vcm);
                            triB.vertexColors[0].copy(vcm);
                        }
                        edge = 0;
                    } else if (dbc >= dab && dbc >= dac) {
                        var vm = vb.clone();
                        vm.lerp(vc, 0.5);
                        triA.a = a;
                        triA.b = b;
                        triA.c = m;
                        triB.a = m;
                        triB.b = c;
                        triB.c = a;
                        if (face.vertexNormals.length === 3) {
                            var vnm = face.vertexNormals[1].clone();
                            vnm.lerp(face.vertexNormals[2], 0.5);
                            triA.vertexNormals[2].copy(vnm);
                            triB.vertexNormals[0].copy(vnm);
                            triB.vertexNormals[1].copy(face.vertexNormals[2]);
                            triB.vertexNormals[2].copy(face.vertexNormals[0]);
                        }
                        if (face.vertexColors.length === 3) {
                            var vcm = face.vertexColors[1].clone();
                            vcm.lerp(face.vertexColors[2], 0.5);
                            triA.vertexColors[2].copy(vcm);
                            triB.vertexColors[0].copy(vcm);
                            triB.vertexColors[1].copy(face.vertexColors[2]);
                            triB.vertexColors[2].copy(face.vertexColors[0]);
                        }
                        edge = 1;
                    } else {
                        var vm = va.clone();
                        vm.lerp(vc, 0.5);
                        triA.a = a;
                        triA.b = b;
                        triA.c = m;
                        triB.a = m;
                        triB.b = b;
                        triB.c = c;
                        if (face.vertexNormals.length === 3) {
                            var vnm = face.vertexNormals[0].clone();
                            vnm.lerp(face.vertexNormals[2], 0.5);
                            triA.vertexNormals[2].copy(vnm);
                            triB.vertexNormals[0].copy(vnm);
                        }
                        if (face.vertexColors.length === 3) {
                            var vcm = face.vertexColors[0].clone();
                            vcm.lerp(face.vertexColors[2], 0.5);
                            triA.vertexColors[2].copy(vcm);
                            triB.vertexColors[0].copy(vcm);
                        }
                        edge = 2;
                    }
                    faces.push(triA, triB);
                    geometry.vertices.push(vm);
                    for (var j = 0, jl = geometry.faceVertexUvs.length; j < jl; j++) {
                        if (geometry.faceVertexUvs[j].length) {
                            var uvs = geometry.faceVertexUvs[j][i];
                            var uvA = uvs[0];
                            var uvB = uvs[1];
                            var uvC = uvs[2];
                            if (edge === 0) {
                                var uvM = uvA.clone();
                                uvM.lerp(uvB, 0.5);
                                var uvsTriA = [
                                    uvA.clone(),
                                    uvM.clone(),
                                    uvC.clone()
                                ];
                                var uvsTriB = [
                                    uvM.clone(),
                                    uvB.clone(),
                                    uvC.clone()
                                ];
                            } else if (edge === 1) {
                                var uvM = uvB.clone();
                                uvM.lerp(uvC, 0.5);
                                var uvsTriA = [
                                    uvA.clone(),
                                    uvB.clone(),
                                    uvM.clone()
                                ];
                                var uvsTriB = [
                                    uvM.clone(),
                                    uvC.clone(),
                                    uvA.clone()
                                ];
                            } else {
                                var uvM = uvA.clone();
                                uvM.lerp(uvC, 0.5);
                                var uvsTriA = [
                                    uvA.clone(),
                                    uvB.clone(),
                                    uvM.clone()
                                ];
                                var uvsTriB = [
                                    uvM.clone(),
                                    uvB.clone(),
                                    uvC.clone()
                                ];
                            }
                            faceVertexUvs[j].push(uvsTriA, uvsTriB);
                        }
                    }
                } else {
                    faces.push(face);
                    for (var j = 0, jl = geometry.faceVertexUvs.length; j < jl; j++) {
                        faceVertexUvs[j].push(geometry.faceVertexUvs[j][i]);
                    }
                }
            }
        }
        geometry.faces = faces;
        geometry.faceVertexUvs = faceVertexUvs;
    };

    return threex.modifiers.TessellateModifier = TessellateModifier;
});
define('skylark-threejs-ex/objects/Fire',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var Fire = function (geometry, options) {
        THREE.Mesh.call(this, geometry);
        this.type = 'Fire';
        this.clock = new THREE.Clock();
        options = options || {};
        var textureWidth = options.textureWidth || 512;
        var textureHeight = options.textureHeight || 512;
        var oneOverWidth = 1 / textureWidth;
        var oneOverHeight = 1 / textureHeight;
        var debug = options.debug === undefined ? false : options.debug;
        this.color1 = options.color1 || new THREE.Color(16777215);
        this.color2 = options.color2 || new THREE.Color(16752640);
        this.color3 = options.color3 || new THREE.Color(0);
        this.colorBias = options.colorBias === undefined ? 0.8 : options.colorBias;
        this.diffuse = options.diffuse === undefined ? 1.33 : options.diffuse;
        this.viscosity = options.viscosity === undefined ? 0.25 : options.viscosity;
        this.expansion = options.expansion === undefined ? -0.25 : options.expansion;
        this.swirl = options.swirl === undefined ? 50 : options.swirl;
        this.burnRate = options.burnRate === undefined ? 0.3 : options.burnRate;
        this.drag = options.drag === undefined ? 0.35 : options.drag;
        this.airSpeed = options.airSpeed === undefined ? 6 : options.airSpeed;
        this.windVector = options.windVector || new THREE.Vector2(0, 0.75);
        this.speed = options.speed === undefined ? 500 : options.speed;
        this.massConservation = options.massConservation === undefined ? false : options.massConservation;
        var size = textureWidth * textureHeight;
        this.sourceData = new Uint8Array(4 * size);
        this.clearSources = function () {
            for (var y = 0; y < textureHeight; y++) {
                for (var x = 0; x < textureWidth; x++) {
                    var i = y * textureWidth + x;
                    var stride = i * 4;
                    this.sourceData[stride] = 0;
                    this.sourceData[stride + 1] = 0;
                    this.sourceData[stride + 2] = 0;
                    this.sourceData[stride + 3] = 0;
                }
            }
            this.sourceMaterial.uniforms['sourceMap'].value = this.internalSource;
            this.sourceMaterial.needsUpdate = true;
            return this.sourceData;
        };
        this.addSource = function (u, v, radius, density = null, windX = null, windY = null) {
            var startX = Math.max(Math.floor((u - radius) * textureWidth), 0);
            var startY = Math.max(Math.floor((v - radius) * textureHeight), 0);
            var endX = Math.min(Math.floor((u + radius) * textureWidth), textureWidth);
            var endY = Math.min(Math.floor((v + radius) * textureHeight), textureHeight);
            for (var y = startY; y < endY; y++) {
                for (var x = startX; x < endX; x++) {
                    var diffX = x * oneOverWidth - u;
                    var diffY = y * oneOverHeight - v;
                    if (diffX * diffX + diffY * diffY < radius * radius) {
                        var i = y * textureWidth + x;
                        var stride = i * 4;
                        if (density != null) {
                            this.sourceData[stride] = Math.min(Math.max(density, 0), 1) * 255;
                        }
                        if (windX != null) {
                            var wind = Math.min(Math.max(windX, -1), 1);
                            wind = wind < 0 ? Math.floor(wind * 127) + 255 : Math.floor(wind * 127);
                            this.sourceData[stride + 1] = wind;
                        }
                        if (windY != null) {
                            var wind = Math.min(Math.max(windY, -1), 1);
                            wind = wind < 0 ? Math.floor(wind * 127) + 255 : Math.floor(wind * 127);
                            this.sourceData[stride + 2] = wind;
                        }
                    }
                }
            }
            this.internalSource.needsUpdate = true;
            return this.sourceData;
        };
        this.setSourceMap = function (texture) {
            this.sourceMaterial.uniforms['sourceMap'].value = texture;
        };
        var parameters = {
            minFilter: THREE.NearestFilter,
            magFilter: THREE.NearestFilter,
            depthBuffer: false,
            stencilBuffer: false
        };
        this.field0 = new THREE.WebGLRenderTarget(textureWidth, textureHeight, parameters);
        this.field0.background = new THREE.Color(0);
        this.field1 = new THREE.WebGLRenderTarget(textureWidth, textureHeight, parameters);
        this.field0.background = new THREE.Color(0);
        this.fieldProj = new THREE.WebGLRenderTarget(textureWidth, textureHeight, parameters);
        this.field0.background = new THREE.Color(0);
        if (!THREE.MathUtils.isPowerOfTwo(textureWidth) || !THREE.MathUtils.isPowerOfTwo(textureHeight)) {
            this.field0.texture.generateMipmaps = false;
            this.field1.texture.generateMipmaps = false;
            this.fieldProj.texture.generateMipmaps = false;
        }
        this.fieldScene = new THREE.Scene();
        this.fieldScene.background = new THREE.Color(0);
        this.orthoCamera = new THREE.OrthographicCamera(textureWidth / -2, textureWidth / 2, textureHeight / 2, textureHeight / -2, 1, 2);
        this.orthoCamera.position.z = 1;
        this.fieldGeometry = new THREE.PlaneBufferGeometry(textureWidth, textureHeight);
        this.internalSource = new THREE.DataTexture(this.sourceData, textureWidth, textureHeight, THREE.RGBAFormat);
        var shader = Fire.SourceShader;
        this.sourceMaterial = new THREE.ShaderMaterial({
            uniforms: shader.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            transparent: false
        });
        this.clearSources();
        this.sourceMesh = new THREE.Mesh(this.fieldGeometry, this.sourceMaterial);
        this.fieldScene.add(this.sourceMesh);
        var shader = Fire.DiffuseShader;
        this.diffuseMaterial = new THREE.ShaderMaterial({
            uniforms: shader.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            transparent: false
        });
        this.diffuseMaterial.uniforms['oneOverWidth'].value = oneOverWidth;
        this.diffuseMaterial.uniforms['oneOverHeight'].value = oneOverHeight;
        this.diffuseMesh = new THREE.Mesh(this.fieldGeometry, this.diffuseMaterial);
        this.fieldScene.add(this.diffuseMesh);
        shader = Fire.DriftShader;
        this.driftMaterial = new THREE.ShaderMaterial({
            uniforms: shader.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            transparent: false
        });
        this.driftMaterial.uniforms['oneOverWidth'].value = oneOverWidth;
        this.driftMaterial.uniforms['oneOverHeight'].value = oneOverHeight;
        this.driftMesh = new THREE.Mesh(this.fieldGeometry, this.driftMaterial);
        this.fieldScene.add(this.driftMesh);
        shader = Fire.ProjectionShader1;
        this.projMaterial1 = new THREE.ShaderMaterial({
            uniforms: shader.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            transparent: false
        });
        this.projMaterial1.uniforms['oneOverWidth'].value = oneOverWidth;
        this.projMaterial1.uniforms['oneOverHeight'].value = oneOverHeight;
        this.projMesh1 = new THREE.Mesh(this.fieldGeometry, this.projMaterial1);
        this.fieldScene.add(this.projMesh1);
        shader = Fire.ProjectionShader2;
        this.projMaterial2 = new THREE.ShaderMaterial({
            uniforms: shader.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            transparent: false
        });
        this.projMaterial2.uniforms['oneOverWidth'].value = oneOverWidth;
        this.projMaterial2.uniforms['oneOverHeight'].value = oneOverHeight;
        this.projMesh2 = new THREE.Mesh(this.fieldGeometry, this.projMaterial2);
        this.fieldScene.add(this.projMesh2);
        shader = Fire.ProjectionShader3;
        this.projMaterial3 = new THREE.ShaderMaterial({
            uniforms: shader.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            transparent: false
        });
        this.projMaterial3.uniforms['oneOverWidth'].value = oneOverWidth;
        this.projMaterial3.uniforms['oneOverHeight'].value = oneOverHeight;
        this.projMesh3 = new THREE.Mesh(this.fieldGeometry, this.projMaterial3);
        this.fieldScene.add(this.projMesh3);
        if (debug) {
            shader = Fire.DebugShader;
        } else {
            shader = Fire.ColorShader;
        }
        this.material = new THREE.ShaderMaterial({
            uniforms: shader.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            transparent: true
        });
        this.material.uniforms['densityMap'].value = this.field1.texture;
        this.configShaders = function (dt) {
            this.diffuseMaterial.uniforms['diffuse'].value = dt * 0.05 * this.diffuse;
            this.diffuseMaterial.uniforms['viscosity'].value = dt * 0.05 * this.viscosity;
            this.diffuseMaterial.uniforms['expansion'].value = Math.exp(this.expansion * -1);
            this.diffuseMaterial.uniforms['swirl'].value = Math.exp(this.swirl * -0.1);
            this.diffuseMaterial.uniforms['drag'].value = Math.exp(this.drag * -0.1);
            this.diffuseMaterial.uniforms['burnRate'].value = this.burnRate * dt * 0.01;
            this.driftMaterial.uniforms['windVector'].value = this.windVector;
            this.driftMaterial.uniforms['airSpeed'].value = dt * this.airSpeed * 0.001 * textureHeight;
            this.material.uniforms['color1'].value = this.color1;
            this.material.uniforms['color2'].value = this.color2;
            this.material.uniforms['color3'].value = this.color3;
            this.material.uniforms['colorBias'].value = this.colorBias;
        };
        this.clearDiffuse = function () {
            this.diffuseMaterial.uniforms['expansion'].value = 1;
            this.diffuseMaterial.uniforms['swirl'].value = 1;
            this.diffuseMaterial.uniforms['drag'].value = 1;
            this.diffuseMaterial.uniforms['burnRate'].value = 0;
        };
        this.swapTextures = function () {
            var swap = this.field0;
            this.field0 = this.field1;
            this.field1 = swap;
        };
        this.saveRenderState = function (renderer) {
            this.savedRenderTarget = renderer.getRenderTarget();
            this.savedXrEnabled = renderer.xr.enabled;
            this.savedShadowAutoUpdate = renderer.shadowMap.autoUpdate;
            this.savedAntialias = renderer.antialias;
            this.savedToneMapping = renderer.toneMapping;
        };
        this.restoreRenderState = function (renderer) {
            renderer.xr.enabled = this.savedXrEnabled;
            renderer.shadowMap.autoUpdate = this.savedShadowAutoUpdate;
            renderer.setRenderTarget(this.savedRenderTarget);
            renderer.antialias = this.savedAntialias;
            renderer.toneMapping = this.savedToneMapping;
        };
        this.renderSource = function (renderer) {
            this.sourceMesh.visible = true;
            this.sourceMaterial.uniforms['densityMap'].value = this.field0.texture;
            renderer.setRenderTarget(this.field1);
            renderer.render(this.fieldScene, this.orthoCamera);
            this.sourceMesh.visible = false;
            this.swapTextures();
        };
        this.renderDiffuse = function (renderer) {
            this.diffuseMesh.visible = true;
            this.diffuseMaterial.uniforms['densityMap'].value = this.field0.texture;
            renderer.setRenderTarget(this.field1);
            renderer.render(this.fieldScene, this.orthoCamera);
            this.diffuseMesh.visible = false;
            this.swapTextures();
        };
        this.renderDrift = function (renderer) {
            this.driftMesh.visible = true;
            this.driftMaterial.uniforms['densityMap'].value = this.field0.texture;
            renderer.setRenderTarget(this.field1);
            renderer.render(this.fieldScene, this.orthoCamera);
            this.driftMesh.visible = false;
            this.swapTextures();
        };
        this.renderProject = function (renderer) {
            this.projMesh1.visible = true;
            this.projMaterial1.uniforms['densityMap'].value = this.field0.texture;
            renderer.setRenderTarget(this.fieldProj);
            renderer.render(this.fieldScene, this.orthoCamera);
            this.projMesh1.visible = false;
            this.projMaterial2.uniforms['densityMap'].value = this.fieldProj.texture;
            this.projMesh2.visible = true;
            for (var i = 0; i < 20; i++) {
                renderer.setRenderTarget(this.field1);
                renderer.render(this.fieldScene, this.orthoCamera);
                var temp = this.field1;
                this.field1 = this.fieldProj;
                this.fieldProj = temp;
                this.projMaterial2.uniforms['densityMap'].value = this.fieldProj.texture;
            }
            this.projMesh2.visible = false;
            this.projMaterial3.uniforms['densityMap'].value = this.field0.texture;
            this.projMaterial3.uniforms['projMap'].value = this.fieldProj.texture;
            this.projMesh3.visible = true;
            renderer.setRenderTarget(this.field1);
            renderer.render(this.fieldScene, this.orthoCamera);
            this.projMesh3.visible = false;
            this.swapTextures();
        };
        this.onBeforeRender = function (renderer) {
            var delta = this.clock.getDelta();
            if (delta > 0.1) {
                delta = 0.1;
            }
            var dt = delta * (this.speed * 0.1);
            this.configShaders(dt);
            this.saveRenderState(renderer);
            renderer.xr.enabled = false;
            renderer.shadowMap.autoUpdate = false;
            renderer.antialias = false;
            renderer.toneMapping = THREE.NoToneMapping;
            this.sourceMesh.visible = false;
            this.diffuseMesh.visible = false;
            this.driftMesh.visible = false;
            this.projMesh1.visible = false;
            this.projMesh2.visible = false;
            this.projMesh3.visible = false;
            this.renderSource(renderer);
            this.clearDiffuse();
            for (var i = 0; i < 21; i++) {
                this.renderDiffuse(renderer);
            }
            this.configShaders(dt);
            this.renderDiffuse(renderer);
            this.renderDrift(renderer);
            if (this.massConservation) {
                this.renderProject(renderer);
                this.renderProject(renderer);
            }
            this.material.map = this.field1.texture;
            this.material.transparent = true;
            this.material.minFilter = THREE.LinearFilter, this.material.magFilter = THREE.LinearFilter, this.restoreRenderState(renderer);
        };
    };
    Fire.prototype = Object.create(THREE.Mesh.prototype);
    Fire.prototype.constructor = Fire;
    Fire.SourceShader = {
        uniforms: {
            'sourceMap': { value: null },
            'densityMap': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' \t  vUv = uv;',
            '     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '     gl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D sourceMap;',
            'uniform sampler2D densityMap;',
            'varying vec2 vUv;',
            'void main() {',
            '    vec4 source = texture2D( sourceMap, vUv );',
            '    vec4 current = texture2D( densityMap, vUv );',
            '    vec2 v0 = (current.gb - step(0.5, current.gb)) * 2.0;',
            '    vec2 v1 = (source.gb - step(0.5, source.gb)) * 2.0;',
            '    vec2 newVel = v0 + v1;',
            '    newVel = clamp(newVel, -0.99, 0.99);',
            '    newVel = newVel * 0.5 + step(0.0, -newVel);',
            '    float newDensity = source.r + current.a;',
            '    float newTemp = source.r + current.r;',
            '    newDensity = clamp(newDensity, 0.0, 1.0);',
            '    newTemp = clamp(newTemp, 0.0, 1.0);',
            '    gl_FragColor = vec4(newTemp, newVel.xy, newDensity);',
            '}'
        ].join('\n')
    };
    Fire.DiffuseShader = {
        uniforms: {
            'oneOverWidth': { value: null },
            'oneOverHeight': { value: null },
            'diffuse': { value: null },
            'viscosity': { value: null },
            'expansion': { value: null },
            'swirl': { value: null },
            'drag': { value: null },
            'burnRate': { value: null },
            'densityMap': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' \t  vUv = uv;',
            '     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '     gl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float oneOverWidth;',
            'uniform float oneOverHeight;',
            'uniform float diffuse;',
            'uniform float viscosity;',
            'uniform float expansion;',
            'uniform float swirl;',
            'uniform float burnRate;',
            'uniform float drag;',
            'uniform sampler2D densityMap;',
            'varying vec2 vUv;',
            'void main() {',
            '    vec4 dC = texture2D( densityMap, vUv );',
            '    vec4 dL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y) );',
            '    vec4 dR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y) );',
            '    vec4 dU = texture2D( densityMap, vec2(vUv.x, vUv.y - oneOverHeight) );',
            '    vec4 dD = texture2D( densityMap, vec2(vUv.x, vUv.y + oneOverHeight) );',
            '    vec4 dUL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y - oneOverHeight) );',
            '    vec4 dUR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y - oneOverHeight) );',
            '    vec4 dDL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y + oneOverHeight) );',
            '    vec4 dDR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y + oneOverHeight) );',
            '    dC.yz = (dC.yz - step(0.5, dC.yz)) * 2.0;',
            '    dL.yz = (dL.yz - step(0.5, dL.yz)) * 2.0;',
            '    dR.yz = (dR.yz - step(0.5, dR.yz)) * 2.0;',
            '    dU.yz = (dU.yz - step(0.5, dU.yz)) * 2.0;',
            '    dD.yz = (dD.yz - step(0.5, dD.yz)) * 2.0;',
            '    dUL.yz = (dUL.yz - step(0.5, dUL.yz)) * 2.0;',
            '    dUR.yz = (dUR.yz - step(0.5, dUR.yz)) * 2.0;',
            '    dDL.yz = (dDL.yz - step(0.5, dDL.yz)) * 2.0;',
            '    dDR.yz = (dDR.yz - step(0.5, dDR.yz)) * 2.0;',
            '    vec4 result = (dC + vec4(diffuse, viscosity, viscosity, diffuse) * ( dL + dR + dU + dD + dUL + dUR + dDL + dDR )) / (1.0 + 8.0 * vec4(diffuse, viscosity, viscosity, diffuse)) - vec4(0.0, 0.0, 0.0, 0.001);',
            '    float temperature = result.r;',
            '    temperature = clamp(temperature - burnRate, 0.0, 1.0);',
            '    vec2 velocity = result.yz;',
            '    vec2 expansionVec = vec2(dL.w - dR.w, dU.w - dD.w);',
            '    vec2 swirlVec = vec2((dL.z - dR.z) * 0.5, (dU.y - dD.y) * 0.5);',
            '    velocity = velocity + (1.0 - expansion) * expansionVec + (1.0 - swirl) * swirlVec;',
            '    velocity = velocity - (1.0 - drag) * velocity;',
            '    gl_FragColor = vec4(temperature, velocity * 0.5 + step(0.0, -velocity), result.w);',
            '    gl_FragColor = gl_FragColor * step(oneOverWidth, vUv.x);',
            '    gl_FragColor = gl_FragColor * step(oneOverHeight, vUv.y);',
            '    gl_FragColor = gl_FragColor * step(vUv.x, 1.0 - oneOverWidth);',
            '    gl_FragColor = gl_FragColor * step(vUv.y, 1.0 - oneOverHeight);',
            '}'
        ].join('\n')
    };
    Fire.DriftShader = {
        uniforms: {
            'oneOverWidth': { value: null },
            'oneOverHeight': { value: null },
            'windVector': { value: new THREE.Vector2(0, 0) },
            'airSpeed': { value: null },
            'densityMap': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' \t  vUv = uv;',
            '     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '     gl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float oneOverWidth;',
            'uniform float oneOverHeight;',
            'uniform vec2 windVector;',
            'uniform float airSpeed;',
            'uniform sampler2D densityMap;',
            'varying vec2 vUv;',
            'void main() {',
            '    vec2 velocity = texture2D( densityMap, vUv ).gb;',
            '    velocity = (velocity - step(0.5, velocity)) * 2.0;',
            '    velocity = velocity + windVector;',
            '    vec2 sourcePos = vUv - airSpeed * vec2(oneOverWidth, oneOverHeight) * velocity;',
            '    vec2 units = sourcePos / vec2(oneOverWidth, oneOverHeight);',
            '    vec2 intPos = floor(units);',
            '    vec2 frac = units - intPos;',
            '    intPos = intPos * vec2(oneOverWidth, oneOverHeight);',
            '    vec4 dX0Y0 = texture2D( densityMap, intPos + vec2(0.0, -oneOverHeight) );',
            '    vec4 dX1Y0 = texture2D( densityMap, intPos + vec2(oneOverWidth, 0.0) );',
            '    vec4 dX0Y1 = texture2D( densityMap, intPos + vec2(0.0, oneOverHeight) );',
            '    vec4 dX1Y1 = texture2D( densityMap, intPos + vec2(oneOverWidth, oneOverHeight) );',
            '    dX0Y0.gb = (dX0Y0.gb - step(0.5, dX0Y0.gb)) * 2.0;',
            '    dX1Y0.gb = (dX1Y0.gb - step(0.5, dX1Y0.gb)) * 2.0;',
            '    dX0Y1.gb = (dX0Y1.gb - step(0.5, dX0Y1.gb)) * 2.0;',
            '    dX1Y1.gb = (dX1Y1.gb - step(0.5, dX1Y1.gb)) * 2.0;',
            '    vec4 source = mix(mix(dX0Y0, dX1Y0, frac.x), mix(dX0Y1, dX1Y1, frac.x), frac.y);',
            '    source.gb = source.gb * 0.5 + step(0.0, -source.gb);',
            '    gl_FragColor = source;',
            '}'
        ].join('\n')
    };
    Fire.ProjectionShader1 = {
        uniforms: {
            'oneOverWidth': { value: null },
            'oneOverHeight': { value: null },
            'densityMap': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' \t  vUv = uv;',
            '     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '     gl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float oneOverWidth;',
            'uniform float oneOverHeight;',
            'uniform sampler2D densityMap;',
            'varying vec2 vUv;',
            'void main() {',
            '    float dL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y) ).g;',
            '    float dR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y) ).g;',
            '    float dU = texture2D( densityMap, vec2(vUv.x, vUv.y - oneOverHeight) ).b;',
            '    float dD = texture2D( densityMap, vec2(vUv.x, vUv.y + oneOverHeight) ).b;',
            '    dL = (dL - step(0.5, dL)) * 2.0;',
            '    dR = (dR - step(0.5, dR)) * 2.0;',
            '    dU = (dU - step(0.5, dU)) * 2.0;',
            '    dD = (dD - step(0.5, dD)) * 2.0;',
            '    float h = (oneOverWidth + oneOverHeight) * 0.5;',
            '    float div = -0.5 * h * (dR - dL + dD - dU);',
            '    gl_FragColor = vec4( 0.0, 0.0, div * 0.5 + step(0.0, -div), 0.0);',
            '}'
        ].join('\n')
    };
    Fire.ProjectionShader2 = {
        uniforms: {
            'oneOverWidth': { value: null },
            'oneOverHeight': { value: null },
            'densityMap': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' \t  vUv = uv;',
            '     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '     gl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float oneOverWidth;',
            'uniform float oneOverHeight;',
            'uniform sampler2D densityMap;',
            'varying vec2 vUv;',
            'void main() {',
            '    float div = texture2D( densityMap, vUv ).b;',
            '    float pL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y) ).g;',
            '    float pR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y) ).g;',
            '    float pU = texture2D( densityMap, vec2(vUv.x, vUv.y - oneOverHeight) ).g;',
            '    float pD = texture2D( densityMap, vec2(vUv.x, vUv.y + oneOverHeight) ).g;',
            '    float divNorm = (div - step(0.5, div)) * 2.0;',
            '    pL = (pL - step(0.5, pL)) * 2.0;',
            '    pR = (pR - step(0.5, pR)) * 2.0;',
            '    pU = (pU - step(0.5, pU)) * 2.0;',
            '    pD = (pD - step(0.5, pD)) * 2.0;',
            '    float p = (divNorm + pR + pL + pD + pU) * 0.25;',
            '    gl_FragColor = vec4( 0.0, p * 0.5 + step(0.0, -p), div, 0.0);',
            '}'
        ].join('\n')
    };
    Fire.ProjectionShader3 = {
        uniforms: {
            'oneOverWidth': { value: null },
            'oneOverHeight': { value: null },
            'densityMap': { value: null },
            'projMap': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' \t  vUv = uv;',
            '     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '     gl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float oneOverWidth;',
            'uniform float oneOverHeight;',
            'uniform sampler2D densityMap;',
            'uniform sampler2D projMap;',
            'varying vec2 vUv;',
            'void main() {',
            '    vec4 orig = texture2D(densityMap, vUv);',
            '    float pL = texture2D( projMap, vec2(vUv.x - oneOverWidth, vUv.y) ).g;',
            '    float pR = texture2D( projMap, vec2(vUv.x + oneOverWidth, vUv.y) ).g;',
            '    float pU = texture2D( projMap, vec2(vUv.x, vUv.y - oneOverHeight) ).g;',
            '    float pD = texture2D( projMap, vec2(vUv.x, vUv.y + oneOverHeight) ).g;',
            '    float uNorm = (orig.g - step(0.5, orig.g)) * 2.0;',
            '    float vNorm = (orig.b - step(0.5, orig.b)) * 2.0;',
            '    pL = (pL - step(0.5, pL)) * 2.0;',
            '    pR = (pR - step(0.5, pR)) * 2.0;',
            '    pU = (pU - step(0.5, pU)) * 2.0;',
            '    pD = (pD - step(0.5, pD)) * 2.0;',
            '    float h = (oneOverWidth + oneOverHeight) * 0.5;',
            '    float u = uNorm - (0.5 * (pR - pL) / h);',
            '    float v = vNorm - (0.5 * (pD - pU) / h);',
            '    gl_FragColor = vec4( orig.r, u * 0.5 + step(0.0, -u), v * 0.5 + step(0.0, -v), orig.a);',
            '}'
        ].join('\n')
    };
    Fire.ColorShader = {
        uniforms: {
            'color1': { value: null },
            'color2': { value: null },
            'color3': { value: null },
            'colorBias': { value: null },
            'densityMap': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' \t  vUv = uv;',
            '     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '     gl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec3 color1;',
            'uniform vec3 color2;',
            'uniform vec3 color3;',
            'uniform float colorBias;',
            'uniform sampler2D densityMap;',
            'varying vec2 vUv;',
            'void main() {',
            '    float density = texture2D( densityMap, vUv ).a;',
            '    float temperature = texture2D( densityMap, vUv ).r;',
            '    float bias = clamp(colorBias, 0.0001, 0.9999);',
            '    vec3 blend1 = mix(color3, color2, temperature / bias) * (1.0 - step(bias, temperature));',
            '    vec3 blend2 = mix(color2, color1, (temperature - bias) / (1.0 - bias) ) * step(bias, temperature);',
            '    gl_FragColor = vec4(blend1 + blend2, density);',
            '}'
        ].join('\n')
    };
    Fire.DebugShader = {
        uniforms: {
            'color1': { value: null },
            'color2': { value: null },
            'color3': { value: null },
            'colorBias': { value: null },
            'densityMap': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' \t  vUv = uv;',
            '     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '     gl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D densityMap;',
            'varying vec2 vUv;',
            'void main() {',
            '    float density;',
            '    density = texture2D( densityMap, vUv ).a;',
            '    vec2 vel = texture2D( densityMap, vUv ).gb;',
            '    vel = (vel - step(0.5, vel)) * 2.0;',
            '    float r = density;',
            '    float g = max(abs(vel.x), density * 0.5);',
            '    float b = max(abs(vel.y), density * 0.5);',
            '    float a = max(density * 0.5, max(abs(vel.x), abs(vel.y)));',
            '    gl_FragColor = vec4(r, g, b, a);',
            '}'
        ].join('\n')
    };

    return threex.objects.Fire = Fire;
});
define('skylark-threejs-ex/objects/LensflareElement',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    var LensflareElement = function (texture, size, distance, color) {
        this.texture = texture;
        this.size = size || 1;
        this.distance = distance || 0;
        this.color = color || new THREE.Color(16777215);
    };
    LensflareElement.Shader = {
        uniforms: {
            'map': { value: null },
            'occlusionMap': { value: null },
            'color': { value: null },
            'scale': { value: null },
            'screenPosition': { value: null }
        },
        vertexShader: [
            'precision highp float;',
            'uniform vec3 screenPosition;',
            'uniform vec2 scale;',
            'uniform sampler2D occlusionMap;',
            'attribute vec3 position;',
            'attribute vec2 uv;',
            'varying vec2 vUV;',
            'varying float vVisibility;',
            'void main() {',
            '\tvUV = uv;',
            '\tvec2 pos = position.xy;',
            '\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );',
            '\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );',
            '\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );',
            '\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );',
            '\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );',
            '\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );',
            '\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );',
            '\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );',
            '\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );',
            '\tvVisibility =        visibility.r / 9.0;',
            '\tvVisibility *= 1.0 - visibility.g / 9.0;',
            '\tvVisibility *=       visibility.b / 9.0;',
            '\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'precision highp float;',
            'uniform sampler2D map;',
            'uniform vec3 color;',
            'varying vec2 vUV;',
            'varying float vVisibility;',
            'void main() {',
            '\tvec4 texture = texture2D( map, vUV );',
            '\ttexture.a *= vVisibility;',
            '\tgl_FragColor = texture;',
            '\tgl_FragColor.rgb *= color;',
            '}'
        ].join('\n')
    };


    return  threex.objects.LensflareElement = LensflareElement;
});
define('skylark-threejs-ex/objects/Lensflare',[
    "skylark-threejs",
    "../threex",
    "./LensflareElement"
], function (
    THREE,
    threex,
    LensflareElement
) {
    'use strict';
    var Lensflare = function () {
        THREE.Mesh.call(this, Lensflare.Geometry, new THREE.MeshBasicMaterial({
            opacity: 0,
            transparent: true
        }));
        this.type = 'Lensflare';
        this.frustumCulled = false;
        this.renderOrder = Infinity;
        var positionScreen = new THREE.Vector3();
        var positionView = new THREE.Vector3();
        var tempMap = new THREE.DataTexture(new Uint8Array(16 * 16 * 3), 16, 16, THREE.RGBFormat);
        tempMap.minFilter = THREE.NearestFilter;
        tempMap.magFilter = THREE.NearestFilter;
        tempMap.wrapS = THREE.ClampToEdgeWrapping;
        tempMap.wrapT = THREE.ClampToEdgeWrapping;
        var occlusionMap = new THREE.DataTexture(new Uint8Array(16 * 16 * 3), 16, 16, THREE.RGBFormat);
        occlusionMap.minFilter = THREE.NearestFilter;
        occlusionMap.magFilter = THREE.NearestFilter;
        occlusionMap.wrapS = THREE.ClampToEdgeWrapping;
        occlusionMap.wrapT = THREE.ClampToEdgeWrapping;
        var geometry = Lensflare.Geometry;
        var material1a = new THREE.RawShaderMaterial({
            uniforms: {
                'scale': { value: null },
                'screenPosition': { value: null }
            },
            vertexShader: [
                'precision highp float;',
                'uniform vec3 screenPosition;',
                'uniform vec2 scale;',
                'attribute vec3 position;',
                'void main() {',
                '\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );',
                '}'
            ].join('\n'),
            fragmentShader: [
                'precision highp float;',
                'void main() {',
                '\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );',
                '}'
            ].join('\n'),
            depthTest: true,
            depthWrite: false,
            transparent: false
        });
        var material1b = new THREE.RawShaderMaterial({
            uniforms: {
                'map': { value: tempMap },
                'scale': { value: null },
                'screenPosition': { value: null }
            },
            vertexShader: [
                'precision highp float;',
                'uniform vec3 screenPosition;',
                'uniform vec2 scale;',
                'attribute vec3 position;',
                'attribute vec2 uv;',
                'varying vec2 vUV;',
                'void main() {',
                '\tvUV = uv;',
                '\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );',
                '}'
            ].join('\n'),
            fragmentShader: [
                'precision highp float;',
                'uniform sampler2D map;',
                'varying vec2 vUV;',
                'void main() {',
                '\tgl_FragColor = texture2D( map, vUV );',
                '}'
            ].join('\n'),
            depthTest: false,
            depthWrite: false,
            transparent: false
        });
        var mesh1 = new THREE.Mesh(geometry, material1a);
        var elements = [];
        var shader = LensflareElement.Shader;
        var material2 = new THREE.RawShaderMaterial({
            uniforms: {
                'map': { value: null },
                'occlusionMap': { value: occlusionMap },
                'color': { value: new THREE.Color(16777215) },
                'scale': { value: new THREE.Vector2() },
                'screenPosition': { value: new THREE.Vector3() }
            },
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            blending: THREE.AdditiveBlending,
            transparent: true,
            depthWrite: false
        });
        var mesh2 = new THREE.Mesh(geometry, material2);
        this.addElement = function (element) {
            elements.push(element);
        };
        var scale = new THREE.Vector2();
        var screenPositionPixels = new THREE.Vector2();
        var validArea = new THREE.Box2();
        var viewport = new THREE.Vector4();
        this.onBeforeRender = function (renderer, scene, camera) {
            renderer.getCurrentViewport(viewport);
            var invAspect = viewport.w / viewport.z;
            var halfViewportWidth = viewport.z / 2;
            var halfViewportHeight = viewport.w / 2;
            var size = 16 / viewport.w;
            scale.set(size * invAspect, size);
            validArea.min.set(viewport.x, viewport.y);
            validArea.max.set(viewport.x + (viewport.z - 16), viewport.y + (viewport.w - 16));
            positionView.setFromMatrixPosition(this.matrixWorld);
            positionView.applyMatrix4(camera.matrixWorldInverse);
            if (positionView.z > 0)
                return;
            positionScreen.copy(positionView).applyMatrix4(camera.projectionMatrix);
            screenPositionPixels.x = viewport.x + positionScreen.x * halfViewportWidth + halfViewportWidth - 8;
            screenPositionPixels.y = viewport.y + positionScreen.y * halfViewportHeight + halfViewportHeight - 8;
            if (validArea.containsPoint(screenPositionPixels)) {
                renderer.copyFramebufferToTexture(screenPositionPixels, tempMap);
                var uniforms = material1a.uniforms;
                uniforms['scale'].value = scale;
                uniforms['screenPosition'].value = positionScreen;
                renderer.renderBufferDirect(camera, null, geometry, material1a, mesh1, null);
                renderer.copyFramebufferToTexture(screenPositionPixels, occlusionMap);
                var uniforms = material1b.uniforms;
                uniforms['scale'].value = scale;
                uniforms['screenPosition'].value = positionScreen;
                renderer.renderBufferDirect(camera, null, geometry, material1b, mesh1, null);
                var vecX = -positionScreen.x * 2;
                var vecY = -positionScreen.y * 2;
                for (var i = 0, l = elements.length; i < l; i++) {
                    var element = elements[i];
                    var uniforms = material2.uniforms;
                    uniforms['color'].value.copy(element.color);
                    uniforms['map'].value = element.texture;
                    uniforms['screenPosition'].value.x = positionScreen.x + vecX * element.distance;
                    uniforms['screenPosition'].value.y = positionScreen.y + vecY * element.distance;
                    var size = element.size / viewport.w;
                    var invAspect = viewport.w / viewport.z;
                    uniforms['scale'].value.set(size * invAspect, size);
                    material2.uniformsNeedUpdate = true;
                    renderer.renderBufferDirect(camera, null, geometry, material2, mesh2, null);
                }
            }
        };
        this.dispose = function () {
            material1a.dispose();
            material1b.dispose();
            material2.dispose();
            tempMap.dispose();
            occlusionMap.dispose();
            for (var i = 0, l = elements.length; i < l; i++) {
                elements[i].texture.dispose();
            }
        };
    };
    Lensflare.prototype = Object.create(THREE.Mesh.prototype);
    Lensflare.prototype.constructor = Lensflare;
    Lensflare.prototype.isLensflare = true;

    Lensflare.Geometry = function () {
        var geometry = new THREE.BufferGeometry();
        var float32Array = new Float32Array([
            -1,
            -1,
            0,
            0,
            0,
            1,
            -1,
            0,
            1,
            0,
            1,
            1,
            0,
            1,
            1,
            -1,
            1,
            0,
            0,
            1
        ]);
        var interleavedBuffer = new THREE.InterleavedBuffer(float32Array, 5);
        geometry.setIndex([
            0,
            1,
            2,
            0,
            2,
            3
        ]);
        geometry.setAttribute('position', new THREE.InterleavedBufferAttribute(interleavedBuffer, 3, 0, false));
        geometry.setAttribute('uv', new THREE.InterleavedBufferAttribute(interleavedBuffer, 2, 3, false));
        return geometry;
    }();
    return threex.objects.Lensflare = Lensflare;
});
define('skylark-threejs-ex/objects/LightningStorm',[
    "skylark-threejs",
    "../threex",
    '../geometries/LightningStrike'
], function (
    THREE, 
    threex,
    LightningStrike
) {
    'use strict';
    var LightningStorm = function (stormParams) {
        THREE.Object3D.call(this);
        stormParams = stormParams || {};
        this.stormParams = stormParams;
        stormParams.size = stormParams.size !== undefined ? stormParams.size : 1000;
        stormParams.minHeight = stormParams.minHeight !== undefined ? stormParams.minHeight : 80;
        stormParams.maxHeight = stormParams.maxHeight !== undefined ? stormParams.maxHeight : 100;
        stormParams.maxSlope = stormParams.maxSlope !== undefined ? stormParams.maxSlope : 1.1;
        stormParams.maxLightnings = stormParams.maxLightnings !== undefined ? stormParams.maxLightnings : 3;
        stormParams.lightningMinPeriod = stormParams.lightningMinPeriod !== undefined ? stormParams.lightningMinPeriod : 3;
        stormParams.lightningMaxPeriod = stormParams.lightningMaxPeriod !== undefined ? stormParams.lightningMaxPeriod : 7;
        stormParams.lightningMinDuration = stormParams.lightningMinDuration !== undefined ? stormParams.lightningMinDuration : 1;
        stormParams.lightningMaxDuration = stormParams.lightningMaxDuration !== undefined ? stormParams.lightningMaxDuration : 2.5;
        this.lightningParameters = LightningStrike.copyParameters(stormParams.lightningParameters, stormParams.lightningParameters);
        this.lightningParameters.isEternal = false;
        this.lightningMaterial = stormParams.lightningMaterial !== undefined ? stormParams.lightningMaterial : new THREE.MeshBasicMaterial({ color: 11599871 });
        if (stormParams.onRayPosition !== undefined) {
            this.onRayPosition = stormParams.onRayPosition;
        } else {
            this.onRayPosition = function (source, dest) {
                dest.set((Math.random() - 0.5) * stormParams.size, 0, (Math.random() - 0.5) * stormParams.size);
                var height = THREE.MathUtils.lerp(stormParams.minHeight, stormParams.maxHeight, Math.random());
                source.set(stormParams.maxSlope * (2 * Math.random() - 1), 1, stormParams.maxSlope * (2 * Math.random() - 1)).multiplyScalar(height).add(dest);
            };
        }
        this.onLightningDown = stormParams.onLightningDown;
        this.inited = false;
        this.nextLightningTime = 0;
        this.lightningsMeshes = [];
        this.deadLightningsMeshes = [];
        for (var i = 0; i < this.stormParams.maxLightnings; i++) {
            var lightning = new LightningStrike(LightningStrike.copyParameters({}, this.lightningParameters));
            var mesh = new THREE.Mesh(lightning, this.lightningMaterial);
            this.deadLightningsMeshes.push(mesh);
        }
    };
    LightningStorm.prototype = Object.create(THREE.Object3D.prototype);
    LightningStorm.prototype.constructor = LightningStorm;
    LightningStorm.prototype.isLightningStorm = true;
    LightningStorm.prototype.update = function (time) {
        if (!this.inited) {
            this.nextLightningTime = this.getNextLightningTime(time) * Math.random();
            this.inited = true;
        }
        if (time >= this.nextLightningTime) {
            var lightningMesh = this.deadLightningsMeshes.pop();
            if (lightningMesh) {
                var lightningParams1 = LightningStrike.copyParameters(lightningMesh.geometry.rayParameters, this.lightningParameters);
                lightningParams1.birthTime = time;
                lightningParams1.deathTime = time + THREE.MathUtils.lerp(this.stormParams.lightningMinDuration, this.stormParams.lightningMaxDuration, Math.random());
                this.onRayPosition(lightningParams1.sourceOffset, lightningParams1.destOffset);
                lightningParams1.noiseSeed = Math.random();
                this.add(lightningMesh);
                this.lightningsMeshes.push(lightningMesh);
            }
            this.nextLightningTime = this.getNextLightningTime(time);
        }
        var i = 0, il = this.lightningsMeshes.length;
        while (i < il) {
            var mesh = this.lightningsMeshes[i];
            var lightning = mesh.geometry;
            var prevState = lightning.state;
            lightning.update(time);
            if (prevState === LightningStrike.RAY_PROPAGATING && lightning.state > prevState) {
                if (this.onLightningDown) {
                    this.onLightningDown(lightning);
                }
            }
            if (lightning.state === LightningStrike.RAY_EXTINGUISHED) {
                this.lightningsMeshes.splice(this.lightningsMeshes.indexOf(mesh), 1);
                this.deadLightningsMeshes.push(mesh);
                this.remove(mesh);
                il--;
            } else {
                i++;
            }
        }
    };
    LightningStorm.prototype.getNextLightningTime = function (currentTime) {
        return currentTime + THREE.MathUtils.lerp(this.stormParams.lightningMinPeriod, this.stormParams.lightningMaxPeriod, Math.random()) / (this.stormParams.maxLightnings + 1);
    };
    LightningStorm.prototype.copy = function (source) {
        THREE.Object3D.prototype.copy.call(this, source);
        this.stormParams.size = source.stormParams.size;
        this.stormParams.minHeight = source.stormParams.minHeight;
        this.stormParams.maxHeight = source.stormParams.maxHeight;
        this.stormParams.maxSlope = source.stormParams.maxSlope;
        this.stormParams.maxLightnings = source.stormParams.maxLightnings;
        this.stormParams.lightningMinPeriod = source.stormParams.lightningMinPeriod;
        this.stormParams.lightningMaxPeriod = source.stormParams.lightningMaxPeriod;
        this.stormParams.lightningMinDuration = source.stormParams.lightningMinDuration;
        this.stormParams.lightningMaxDuration = source.stormParams.lightningMaxDuration;
        this.lightningParameters = LightningStrike.copyParameters({}, source.lightningParameters);
        this.lightningMaterial = source.stormParams.lightningMaterial;
        this.onLightningDown = source.onLightningDown;
        return this;
    };
    LightningStrike.prototype.clone = function () {
        return new this.constructor(this.stormParams).copy(this);
    };

    return threex.objects.LightningStorm = LightningStorm;
});
define('skylark-threejs-ex/objects/MarchingCubes',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var MarchingCubes = function (resolution, material, enableUvs, enableColors) {
        THREE.ImmediateRenderObject.call(this, material);
        var scope = this;
        var vlist = new Float32Array(12 * 3);
        var nlist = new Float32Array(12 * 3);
        var clist = new Float32Array(12 * 3);
        this.enableUvs = enableUvs !== undefined ? enableUvs : false;
        this.enableColors = enableColors !== undefined ? enableColors : false;
        this.init = function (resolution) {
            this.resolution = resolution;
            this.isolation = 80;
            this.size = resolution;
            this.size2 = this.size * this.size;
            this.size3 = this.size2 * this.size;
            this.halfsize = this.size / 2;
            this.delta = 2 / this.size;
            this.yd = this.size;
            this.zd = this.size2;
            this.field = new Float32Array(this.size3);
            this.normal_cache = new Float32Array(this.size3 * 3);
            this.palette = new Float32Array(this.size3 * 3);
            this.maxCount = 4096;
            this.count = 0;
            this.hasPositions = false;
            this.hasNormals = false;
            this.hasColors = false;
            this.hasUvs = false;
            this.positionArray = new Float32Array(this.maxCount * 3);
            this.normalArray = new Float32Array(this.maxCount * 3);
            if (this.enableUvs) {
                this.uvArray = new Float32Array(this.maxCount * 2);
            }
            if (this.enableColors) {
                this.colorArray = new Float32Array(this.maxCount * 3);
            }
        };
        function lerp(a, b, t) {
            return a + (b - a) * t;
        }
        function VIntX(q, offset, isol, x, y, z, valp1, valp2, c_offset1, c_offset2) {
            var mu = (isol - valp1) / (valp2 - valp1), nc = scope.normal_cache;
            vlist[offset + 0] = x + mu * scope.delta;
            vlist[offset + 1] = y;
            vlist[offset + 2] = z;
            nlist[offset + 0] = lerp(nc[q + 0], nc[q + 3], mu);
            nlist[offset + 1] = lerp(nc[q + 1], nc[q + 4], mu);
            nlist[offset + 2] = lerp(nc[q + 2], nc[q + 5], mu);
            clist[offset + 0] = lerp(scope.palette[c_offset1 * 3 + 0], scope.palette[c_offset2 * 3 + 0], mu);
            clist[offset + 1] = lerp(scope.palette[c_offset1 * 3 + 1], scope.palette[c_offset2 * 3 + 1], mu);
            clist[offset + 2] = lerp(scope.palette[c_offset1 * 3 + 2], scope.palette[c_offset2 * 3 + 2], mu);
        }
        function VIntY(q, offset, isol, x, y, z, valp1, valp2, c_offset1, c_offset2) {
            var mu = (isol - valp1) / (valp2 - valp1), nc = scope.normal_cache;
            vlist[offset + 0] = x;
            vlist[offset + 1] = y + mu * scope.delta;
            vlist[offset + 2] = z;
            var q2 = q + scope.yd * 3;
            nlist[offset + 0] = lerp(nc[q + 0], nc[q2 + 0], mu);
            nlist[offset + 1] = lerp(nc[q + 1], nc[q2 + 1], mu);
            nlist[offset + 2] = lerp(nc[q + 2], nc[q2 + 2], mu);
            clist[offset + 0] = lerp(scope.palette[c_offset1 * 3 + 0], scope.palette[c_offset2 * 3 + 0], mu);
            clist[offset + 1] = lerp(scope.palette[c_offset1 * 3 + 1], scope.palette[c_offset2 * 3 + 1], mu);
            clist[offset + 2] = lerp(scope.palette[c_offset1 * 3 + 2], scope.palette[c_offset2 * 3 + 2], mu);
        }
        function VIntZ(q, offset, isol, x, y, z, valp1, valp2, c_offset1, c_offset2) {
            var mu = (isol - valp1) / (valp2 - valp1), nc = scope.normal_cache;
            vlist[offset + 0] = x;
            vlist[offset + 1] = y;
            vlist[offset + 2] = z + mu * scope.delta;
            var q2 = q + scope.zd * 3;
            nlist[offset + 0] = lerp(nc[q + 0], nc[q2 + 0], mu);
            nlist[offset + 1] = lerp(nc[q + 1], nc[q2 + 1], mu);
            nlist[offset + 2] = lerp(nc[q + 2], nc[q2 + 2], mu);
            clist[offset + 0] = lerp(scope.palette[c_offset1 * 3 + 0], scope.palette[c_offset2 * 3 + 0], mu);
            clist[offset + 1] = lerp(scope.palette[c_offset1 * 3 + 1], scope.palette[c_offset2 * 3 + 1], mu);
            clist[offset + 2] = lerp(scope.palette[c_offset1 * 3 + 2], scope.palette[c_offset2 * 3 + 2], mu);
        }
        function compNorm(q) {
            var q3 = q * 3;
            if (scope.normal_cache[q3] === 0) {
                scope.normal_cache[q3 + 0] = scope.field[q - 1] - scope.field[q + 1];
                scope.normal_cache[q3 + 1] = scope.field[q - scope.yd] - scope.field[q + scope.yd];
                scope.normal_cache[q3 + 2] = scope.field[q - scope.zd] - scope.field[q + scope.zd];
            }
        }
        function polygonize(fx, fy, fz, q, isol, renderCallback) {
            var q1 = q + 1, qy = q + scope.yd, qz = q + scope.zd, q1y = q1 + scope.yd, q1z = q1 + scope.zd, qyz = q + scope.yd + scope.zd, q1yz = q1 + scope.yd + scope.zd;
            var cubeindex = 0, field0 = scope.field[q], field1 = scope.field[q1], field2 = scope.field[qy], field3 = scope.field[q1y], field4 = scope.field[qz], field5 = scope.field[q1z], field6 = scope.field[qyz], field7 = scope.field[q1yz];
            if (field0 < isol)
                cubeindex |= 1;
            if (field1 < isol)
                cubeindex |= 2;
            if (field2 < isol)
                cubeindex |= 8;
            if (field3 < isol)
                cubeindex |= 4;
            if (field4 < isol)
                cubeindex |= 16;
            if (field5 < isol)
                cubeindex |= 32;
            if (field6 < isol)
                cubeindex |= 128;
            if (field7 < isol)
                cubeindex |= 64;
            var bits = edgeTable[cubeindex];
            if (bits === 0)
                return 0;
            var d = scope.delta, fx2 = fx + d, fy2 = fy + d, fz2 = fz + d;
            if (bits & 1) {
                compNorm(q);
                compNorm(q1);
                VIntX(q * 3, 0, isol, fx, fy, fz, field0, field1, q, q1);
            }
            if (bits & 2) {
                compNorm(q1);
                compNorm(q1y);
                VIntY(q1 * 3, 3, isol, fx2, fy, fz, field1, field3, q1, q1y);
            }
            if (bits & 4) {
                compNorm(qy);
                compNorm(q1y);
                VIntX(qy * 3, 6, isol, fx, fy2, fz, field2, field3, qy, q1y);
            }
            if (bits & 8) {
                compNorm(q);
                compNorm(qy);
                VIntY(q * 3, 9, isol, fx, fy, fz, field0, field2, q, qy);
            }
            if (bits & 16) {
                compNorm(qz);
                compNorm(q1z);
                VIntX(qz * 3, 12, isol, fx, fy, fz2, field4, field5, qz, q1z);
            }
            if (bits & 32) {
                compNorm(q1z);
                compNorm(q1yz);
                VIntY(q1z * 3, 15, isol, fx2, fy, fz2, field5, field7, q1z, q1yz);
            }
            if (bits & 64) {
                compNorm(qyz);
                compNorm(q1yz);
                VIntX(qyz * 3, 18, isol, fx, fy2, fz2, field6, field7, qyz, q1yz);
            }
            if (bits & 128) {
                compNorm(qz);
                compNorm(qyz);
                VIntY(qz * 3, 21, isol, fx, fy, fz2, field4, field6, qz, qyz);
            }
            if (bits & 256) {
                compNorm(q);
                compNorm(qz);
                VIntZ(q * 3, 24, isol, fx, fy, fz, field0, field4, q, qz);
            }
            if (bits & 512) {
                compNorm(q1);
                compNorm(q1z);
                VIntZ(q1 * 3, 27, isol, fx2, fy, fz, field1, field5, q1, q1z);
            }
            if (bits & 1024) {
                compNorm(q1y);
                compNorm(q1yz);
                VIntZ(q1y * 3, 30, isol, fx2, fy2, fz, field3, field7, q1y, q1yz);
            }
            if (bits & 2048) {
                compNorm(qy);
                compNorm(qyz);
                VIntZ(qy * 3, 33, isol, fx, fy2, fz, field2, field6, qy, qyz);
            }
            cubeindex <<= 4;
            var o1, o2, o3, numtris = 0, i = 0;
            while (triTable[cubeindex + i] != -1) {
                o1 = cubeindex + i;
                o2 = o1 + 1;
                o3 = o1 + 2;
                posnormtriv(vlist, nlist, clist, 3 * triTable[o1], 3 * triTable[o2], 3 * triTable[o3], renderCallback);
                i += 3;
                numtris++;
            }
            return numtris;
        }
        function posnormtriv(pos, norm, colors, o1, o2, o3, renderCallback) {
            var c = scope.count * 3;
            scope.positionArray[c + 0] = pos[o1];
            scope.positionArray[c + 1] = pos[o1 + 1];
            scope.positionArray[c + 2] = pos[o1 + 2];
            scope.positionArray[c + 3] = pos[o2];
            scope.positionArray[c + 4] = pos[o2 + 1];
            scope.positionArray[c + 5] = pos[o2 + 2];
            scope.positionArray[c + 6] = pos[o3];
            scope.positionArray[c + 7] = pos[o3 + 1];
            scope.positionArray[c + 8] = pos[o3 + 2];
            if (scope.material.flatShading === true) {
                var nx = (norm[o1 + 0] + norm[o2 + 0] + norm[o3 + 0]) / 3;
                var ny = (norm[o1 + 1] + norm[o2 + 1] + norm[o3 + 1]) / 3;
                var nz = (norm[o1 + 2] + norm[o2 + 2] + norm[o3 + 2]) / 3;
                scope.normalArray[c + 0] = nx;
                scope.normalArray[c + 1] = ny;
                scope.normalArray[c + 2] = nz;
                scope.normalArray[c + 3] = nx;
                scope.normalArray[c + 4] = ny;
                scope.normalArray[c + 5] = nz;
                scope.normalArray[c + 6] = nx;
                scope.normalArray[c + 7] = ny;
                scope.normalArray[c + 8] = nz;
            } else {
                scope.normalArray[c + 0] = norm[o1 + 0];
                scope.normalArray[c + 1] = norm[o1 + 1];
                scope.normalArray[c + 2] = norm[o1 + 2];
                scope.normalArray[c + 3] = norm[o2 + 0];
                scope.normalArray[c + 4] = norm[o2 + 1];
                scope.normalArray[c + 5] = norm[o2 + 2];
                scope.normalArray[c + 6] = norm[o3 + 0];
                scope.normalArray[c + 7] = norm[o3 + 1];
                scope.normalArray[c + 8] = norm[o3 + 2];
            }
            if (scope.enableUvs) {
                var d = scope.count * 2;
                scope.uvArray[d + 0] = pos[o1 + 0];
                scope.uvArray[d + 1] = pos[o1 + 2];
                scope.uvArray[d + 2] = pos[o2 + 0];
                scope.uvArray[d + 3] = pos[o2 + 2];
                scope.uvArray[d + 4] = pos[o3 + 0];
                scope.uvArray[d + 5] = pos[o3 + 2];
            }
            if (scope.enableColors) {
                scope.colorArray[c + 0] = colors[o1 + 0];
                scope.colorArray[c + 1] = colors[o1 + 1];
                scope.colorArray[c + 2] = colors[o1 + 2];
                scope.colorArray[c + 3] = colors[o2 + 0];
                scope.colorArray[c + 4] = colors[o2 + 1];
                scope.colorArray[c + 5] = colors[o2 + 2];
                scope.colorArray[c + 6] = colors[o3 + 0];
                scope.colorArray[c + 7] = colors[o3 + 1];
                scope.colorArray[c + 8] = colors[o3 + 2];
            }
            scope.count += 3;
            if (scope.count >= scope.maxCount - 3) {
                scope.hasPositions = true;
                scope.hasNormals = true;
                if (scope.enableUvs) {
                    scope.hasUvs = true;
                }
                if (scope.enableColors) {
                    scope.hasColors = true;
                }
                renderCallback(scope);
            }
        }
        this.begin = function () {
            this.count = 0;
            this.hasPositions = false;
            this.hasNormals = false;
            this.hasUvs = false;
            this.hasColors = false;
        };
        this.end = function (renderCallback) {
            if (this.count === 0)
                return;
            for (var i = this.count * 3; i < this.positionArray.length; i++) {
                this.positionArray[i] = 0;
            }
            this.hasPositions = true;
            this.hasNormals = true;
            if (this.enableUvs && this.material.map) {
                this.hasUvs = true;
            }
            if (this.enableColors && this.material.vertexColors !== THREE.NoColors) {
                this.hasColors = true;
            }
            renderCallback(this);
        };
        this.addBall = function (ballx, bally, ballz, strength, subtract, colors) {
            var sign = Math.sign(strength);
            strength = Math.abs(strength);
            var userDefineColor = !(colors === undefined || colors === null);
            var ballColor = new THREE.Color(ballx, bally, ballz);
            if (userDefineColor) {
                try {
                    ballColor = colors instanceof THREE.Color ? colors : Array.isArray(colors) ? new THREE.Color(Math.min(Math.abs(colors[0]), 1), Math.min(Math.abs(colors[1]), 1), Math.min(Math.abs(colors[2]), 1)) : new THREE.Color(colors);
                } catch (err) {
                    ballColor = new THREE.Color(ballx, bally, ballz);
                }
            }
            var radius = this.size * Math.sqrt(strength / subtract), zs = ballz * this.size, ys = bally * this.size, xs = ballx * this.size;
            var min_z = Math.floor(zs - radius);
            if (min_z < 1)
                min_z = 1;
            var max_z = Math.floor(zs + radius);
            if (max_z > this.size - 1)
                max_z = this.size - 1;
            var min_y = Math.floor(ys - radius);
            if (min_y < 1)
                min_y = 1;
            var max_y = Math.floor(ys + radius);
            if (max_y > this.size - 1)
                max_y = this.size - 1;
            var min_x = Math.floor(xs - radius);
            if (min_x < 1)
                min_x = 1;
            var max_x = Math.floor(xs + radius);
            if (max_x > this.size - 1)
                max_x = this.size - 1;
            var x, y, z, y_offset, z_offset, fx, fy, fz, fz2, fy2, val;
            for (z = min_z; z < max_z; z++) {
                z_offset = this.size2 * z;
                fz = z / this.size - ballz;
                fz2 = fz * fz;
                for (y = min_y; y < max_y; y++) {
                    y_offset = z_offset + this.size * y;
                    fy = y / this.size - bally;
                    fy2 = fy * fy;
                    for (x = min_x; x < max_x; x++) {
                        fx = x / this.size - ballx;
                        val = strength / (0.000001 + fx * fx + fy2 + fz2) - subtract;
                        if (val > 0) {
                            this.field[y_offset + x] += val * sign;
                            const ratio = Math.sqrt((x - xs) * (x - xs) + (y - ys) * (y - ys) + (z - zs) * (z - zs)) / radius;
                            const contrib = 1 - ratio * ratio * ratio * (ratio * (ratio * 6 - 15) + 10);
                            this.palette[(y_offset + x) * 3 + 0] += ballColor.r * contrib;
                            this.palette[(y_offset + x) * 3 + 1] += ballColor.g * contrib;
                            this.palette[(y_offset + x) * 3 + 2] += ballColor.b * contrib;
                        }
                    }
                }
            }
        };
        this.addPlaneX = function (strength, subtract) {
            var x, y, z, xx, val, xdiv, cxy, size = this.size, yd = this.yd, zd = this.zd, field = this.field, dist = size * Math.sqrt(strength / subtract);
            if (dist > size)
                dist = size;
            for (x = 0; x < dist; x++) {
                xdiv = x / size;
                xx = xdiv * xdiv;
                val = strength / (0.0001 + xx) - subtract;
                if (val > 0) {
                    for (y = 0; y < size; y++) {
                        cxy = x + y * yd;
                        for (z = 0; z < size; z++) {
                            field[zd * z + cxy] += val;
                        }
                    }
                }
            }
        };
        this.addPlaneY = function (strength, subtract) {
            var x, y, z, yy, val, ydiv, cy, cxy, size = this.size, yd = this.yd, zd = this.zd, field = this.field, dist = size * Math.sqrt(strength / subtract);
            if (dist > size)
                dist = size;
            for (y = 0; y < dist; y++) {
                ydiv = y / size;
                yy = ydiv * ydiv;
                val = strength / (0.0001 + yy) - subtract;
                if (val > 0) {
                    cy = y * yd;
                    for (x = 0; x < size; x++) {
                        cxy = cy + x;
                        for (z = 0; z < size; z++)
                            field[zd * z + cxy] += val;
                    }
                }
            }
        };
        this.addPlaneZ = function (strength, subtract) {
            var x, y, z, zz, val, zdiv, cz, cyz, size = this.size, yd = this.yd, zd = this.zd, field = this.field, dist = size * Math.sqrt(strength / subtract);
            if (dist > size)
                dist = size;
            for (z = 0; z < dist; z++) {
                zdiv = z / size;
                zz = zdiv * zdiv;
                val = strength / (0.0001 + zz) - subtract;
                if (val > 0) {
                    cz = zd * z;
                    for (y = 0; y < size; y++) {
                        cyz = cz + y * yd;
                        for (x = 0; x < size; x++)
                            field[cyz + x] += val;
                    }
                }
            }
        };
        this.setCell = function (x, y, z, value) {
            var index = this.size2 * z + this.size * y + x;
            this.field[index] = value;
        };
        this.getCell = function (x, y, z) {
            var index = this.size2 * z + this.size * y + x;
            return this.field[index];
        };
        this.blur = function (intensity) {
            if (intensity === undefined) {
                intensity = 1;
            }
            var field = this.field;
            var fieldCopy = field.slice();
            var size = this.size;
            var size2 = this.size2;
            for (var x = 0; x < size; x++) {
                for (var y = 0; y < size; y++) {
                    for (var z = 0; z < size; z++) {
                        var index = size2 * z + size * y + x;
                        var val = fieldCopy[index];
                        var count = 1;
                        for (var x2 = -1; x2 <= 1; x2 += 2) {
                            var x3 = x2 + x;
                            if (x3 < 0 || x3 >= size)
                                continue;
                            for (var y2 = -1; y2 <= 1; y2 += 2) {
                                var y3 = y2 + y;
                                if (y3 < 0 || y3 >= size)
                                    continue;
                                for (var z2 = -1; z2 <= 1; z2 += 2) {
                                    var z3 = z2 + z;
                                    if (z3 < 0 || z3 >= size)
                                        continue;
                                    var index2 = size2 * z3 + size * y3 + x3;
                                    var val2 = fieldCopy[index2];
                                    count++;
                                    val += intensity * (val2 - val) / count;
                                }
                            }
                        }
                        field[index] = val;
                    }
                }
            }
        };
        this.reset = function () {
            var i;
            for (i = 0; i < this.size3; i++) {
                this.normal_cache[i * 3] = 0;
                this.field[i] = 0;
                this.palette[i * 3] = this.palette[i * 3 + 1] = this.palette[i * 3 + 2] = 0;
            }
        };
        this.render = function (renderCallback) {
            this.begin();
            var smin2 = this.size - 2;
            for (var z = 1; z < smin2; z++) {
                var z_offset = this.size2 * z;
                var fz = (z - this.halfsize) / this.halfsize;
                for (var y = 1; y < smin2; y++) {
                    var y_offset = z_offset + this.size * y;
                    var fy = (y - this.halfsize) / this.halfsize;
                    for (var x = 1; x < smin2; x++) {
                        var fx = (x - this.halfsize) / this.halfsize;
                        var q = y_offset + x;
                        polygonize(fx, fy, fz, q, this.isolation, renderCallback);
                    }
                }
            }
            this.end(renderCallback);
        };
        this.generateGeometry = function () {
            console.warn('MarchingCubes: generateGeometry() now returns BufferGeometry');
            return this.generateBufferGeometry();
        };
        function concatenate(a, b, length) {
            var result = new Float32Array(a.length + length);
            result.set(a, 0);
            result.set(b.slice(0, length), a.length);
            return result;
        }
        this.generateBufferGeometry = function () {
            var geo = new THREE.BufferGeometry();
            var posArray = new Float32Array();
            var normArray = new Float32Array();
            var colorArray = new Float32Array();
            var uvArray = new Float32Array();
            var scope = this;
            var geo_callback = function (object) {
                if (scope.hasPositions)
                    posArray = concatenate(posArray, object.positionArray, object.count * 3);
                if (scope.hasNormals)
                    normArray = concatenate(normArray, object.normalArray, object.count * 3);
                if (scope.hasColors)
                    colorArray = concatenate(colorArray, object.colorArray, object.count * 3);
                if (scope.hasUvs)
                    uvArray = concatenate(uvArray, object.uvArray, object.count * 2);
                object.count = 0;
            };
            this.render(geo_callback);
            if (this.hasPositions)
                geo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            if (this.hasNormals)
                geo.setAttribute('normal', new THREE.BufferAttribute(normArray, 3));
            if (this.hasColors)
                geo.setAttribute('color', new THREE.BufferAttribute(colorArray, 3));
            if (this.hasUvs)
                geo.setAttribute('uv', new THREE.BufferAttribute(uvArray, 2));
            return geo;
        };
        this.init(resolution);
    };
    MarchingCubes.prototype = Object.create(THREE.ImmediateRenderObject.prototype);
    MarchingCubes.prototype.constructor = MarchingCubes;
    var edgeTable = new Int32Array([
        0,
        265,
        515,
        778,
        1030,
        1295,
        1541,
        1804,
        2060,
        2309,
        2575,
        2822,
        3082,
        3331,
        3593,
        3840,
        400,
        153,
        915,
        666,
        1430,
        1183,
        1941,
        1692,
        2460,
        2197,
        2975,
        2710,
        3482,
        3219,
        3993,
        3728,
        560,
        825,
        51,
        314,
        1590,
        1855,
        1077,
        1340,
        2620,
        2869,
        2111,
        2358,
        3642,
        3891,
        3129,
        3376,
        928,
        681,
        419,
        170,
        1958,
        1711,
        1445,
        1196,
        2988,
        2725,
        2479,
        2214,
        4010,
        3747,
        3497,
        3232,
        1120,
        1385,
        1635,
        1898,
        102,
        367,
        613,
        876,
        3180,
        3429,
        3695,
        3942,
        2154,
        2403,
        2665,
        2912,
        1520,
        1273,
        2035,
        1786,
        502,
        255,
        1013,
        764,
        3580,
        3317,
        4095,
        3830,
        2554,
        2291,
        3065,
        2800,
        1616,
        1881,
        1107,
        1370,
        598,
        863,
        85,
        348,
        3676,
        3925,
        3167,
        3414,
        2650,
        2899,
        2137,
        2384,
        1984,
        1737,
        1475,
        1226,
        966,
        719,
        453,
        204,
        4044,
        3781,
        3535,
        3270,
        3018,
        2755,
        2505,
        2240,
        2240,
        2505,
        2755,
        3018,
        3270,
        3535,
        3781,
        4044,
        204,
        453,
        719,
        966,
        1226,
        1475,
        1737,
        1984,
        2384,
        2137,
        2899,
        2650,
        3414,
        3167,
        3925,
        3676,
        348,
        85,
        863,
        598,
        1370,
        1107,
        1881,
        1616,
        2800,
        3065,
        2291,
        2554,
        3830,
        4095,
        3317,
        3580,
        764,
        1013,
        255,
        502,
        1786,
        2035,
        1273,
        1520,
        2912,
        2665,
        2403,
        2154,
        3942,
        3695,
        3429,
        3180,
        876,
        613,
        367,
        102,
        1898,
        1635,
        1385,
        1120,
        3232,
        3497,
        3747,
        4010,
        2214,
        2479,
        2725,
        2988,
        1196,
        1445,
        1711,
        1958,
        170,
        419,
        681,
        928,
        3376,
        3129,
        3891,
        3642,
        2358,
        2111,
        2869,
        2620,
        1340,
        1077,
        1855,
        1590,
        314,
        51,
        825,
        560,
        3728,
        3993,
        3219,
        3482,
        2710,
        2975,
        2197,
        2460,
        1692,
        1941,
        1183,
        1430,
        666,
        915,
        153,
        400,
        3840,
        3593,
        3331,
        3082,
        2822,
        2575,
        2309,
        2060,
        1804,
        1541,
        1295,
        1030,
        778,
        515,
        265,
        0
    ]);
    var triTable = new Int32Array([
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        8,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        1,
        9,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        8,
        3,
        9,
        8,
        1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        2,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        8,
        3,
        1,
        2,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        2,
        10,
        0,
        2,
        9,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        8,
        3,
        2,
        10,
        8,
        10,
        9,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        11,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        11,
        2,
        8,
        11,
        0,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        9,
        0,
        2,
        3,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        11,
        2,
        1,
        9,
        11,
        9,
        8,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        10,
        1,
        11,
        10,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        10,
        1,
        0,
        8,
        10,
        8,
        11,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        9,
        0,
        3,
        11,
        9,
        11,
        10,
        9,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        8,
        10,
        10,
        8,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        7,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        3,
        0,
        7,
        3,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        1,
        9,
        8,
        4,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        1,
        9,
        4,
        7,
        1,
        7,
        3,
        1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        2,
        10,
        8,
        4,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        4,
        7,
        3,
        0,
        4,
        1,
        2,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        2,
        10,
        9,
        0,
        2,
        8,
        4,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        10,
        9,
        2,
        9,
        7,
        2,
        7,
        3,
        7,
        9,
        4,
        -1,
        -1,
        -1,
        -1,
        8,
        4,
        7,
        3,
        11,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        11,
        4,
        7,
        11,
        2,
        4,
        2,
        0,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        0,
        1,
        8,
        4,
        7,
        2,
        3,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        7,
        11,
        9,
        4,
        11,
        9,
        11,
        2,
        9,
        2,
        1,
        -1,
        -1,
        -1,
        -1,
        3,
        10,
        1,
        3,
        11,
        10,
        7,
        8,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        11,
        10,
        1,
        4,
        11,
        1,
        0,
        4,
        7,
        11,
        4,
        -1,
        -1,
        -1,
        -1,
        4,
        7,
        8,
        9,
        0,
        11,
        9,
        11,
        10,
        11,
        0,
        3,
        -1,
        -1,
        -1,
        -1,
        4,
        7,
        11,
        4,
        11,
        9,
        9,
        11,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        5,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        5,
        4,
        0,
        8,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        5,
        4,
        1,
        5,
        0,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        8,
        5,
        4,
        8,
        3,
        5,
        3,
        1,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        2,
        10,
        9,
        5,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        0,
        8,
        1,
        2,
        10,
        4,
        9,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        5,
        2,
        10,
        5,
        4,
        2,
        4,
        0,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        10,
        5,
        3,
        2,
        5,
        3,
        5,
        4,
        3,
        4,
        8,
        -1,
        -1,
        -1,
        -1,
        9,
        5,
        4,
        2,
        3,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        11,
        2,
        0,
        8,
        11,
        4,
        9,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        5,
        4,
        0,
        1,
        5,
        2,
        3,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        1,
        5,
        2,
        5,
        8,
        2,
        8,
        11,
        4,
        8,
        5,
        -1,
        -1,
        -1,
        -1,
        10,
        3,
        11,
        10,
        1,
        3,
        9,
        5,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        9,
        5,
        0,
        8,
        1,
        8,
        10,
        1,
        8,
        11,
        10,
        -1,
        -1,
        -1,
        -1,
        5,
        4,
        0,
        5,
        0,
        11,
        5,
        11,
        10,
        11,
        0,
        3,
        -1,
        -1,
        -1,
        -1,
        5,
        4,
        8,
        5,
        8,
        10,
        10,
        8,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        7,
        8,
        5,
        7,
        9,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        3,
        0,
        9,
        5,
        3,
        5,
        7,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        7,
        8,
        0,
        1,
        7,
        1,
        5,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        5,
        3,
        3,
        5,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        7,
        8,
        9,
        5,
        7,
        10,
        1,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        1,
        2,
        9,
        5,
        0,
        5,
        3,
        0,
        5,
        7,
        3,
        -1,
        -1,
        -1,
        -1,
        8,
        0,
        2,
        8,
        2,
        5,
        8,
        5,
        7,
        10,
        5,
        2,
        -1,
        -1,
        -1,
        -1,
        2,
        10,
        5,
        2,
        5,
        3,
        3,
        5,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        7,
        9,
        5,
        7,
        8,
        9,
        3,
        11,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        5,
        7,
        9,
        7,
        2,
        9,
        2,
        0,
        2,
        7,
        11,
        -1,
        -1,
        -1,
        -1,
        2,
        3,
        11,
        0,
        1,
        8,
        1,
        7,
        8,
        1,
        5,
        7,
        -1,
        -1,
        -1,
        -1,
        11,
        2,
        1,
        11,
        1,
        7,
        7,
        1,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        5,
        8,
        8,
        5,
        7,
        10,
        1,
        3,
        10,
        3,
        11,
        -1,
        -1,
        -1,
        -1,
        5,
        7,
        0,
        5,
        0,
        9,
        7,
        11,
        0,
        1,
        0,
        10,
        11,
        10,
        0,
        -1,
        11,
        10,
        0,
        11,
        0,
        3,
        10,
        5,
        0,
        8,
        0,
        7,
        5,
        7,
        0,
        -1,
        11,
        10,
        5,
        7,
        11,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        6,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        8,
        3,
        5,
        10,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        0,
        1,
        5,
        10,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        8,
        3,
        1,
        9,
        8,
        5,
        10,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        6,
        5,
        2,
        6,
        1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        6,
        5,
        1,
        2,
        6,
        3,
        0,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        6,
        5,
        9,
        0,
        6,
        0,
        2,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        5,
        9,
        8,
        5,
        8,
        2,
        5,
        2,
        6,
        3,
        2,
        8,
        -1,
        -1,
        -1,
        -1,
        2,
        3,
        11,
        10,
        6,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        11,
        0,
        8,
        11,
        2,
        0,
        10,
        6,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        1,
        9,
        2,
        3,
        11,
        5,
        10,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        5,
        10,
        6,
        1,
        9,
        2,
        9,
        11,
        2,
        9,
        8,
        11,
        -1,
        -1,
        -1,
        -1,
        6,
        3,
        11,
        6,
        5,
        3,
        5,
        1,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        8,
        11,
        0,
        11,
        5,
        0,
        5,
        1,
        5,
        11,
        6,
        -1,
        -1,
        -1,
        -1,
        3,
        11,
        6,
        0,
        3,
        6,
        0,
        6,
        5,
        0,
        5,
        9,
        -1,
        -1,
        -1,
        -1,
        6,
        5,
        9,
        6,
        9,
        11,
        11,
        9,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        5,
        10,
        6,
        4,
        7,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        3,
        0,
        4,
        7,
        3,
        6,
        5,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        9,
        0,
        5,
        10,
        6,
        8,
        4,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        6,
        5,
        1,
        9,
        7,
        1,
        7,
        3,
        7,
        9,
        4,
        -1,
        -1,
        -1,
        -1,
        6,
        1,
        2,
        6,
        5,
        1,
        4,
        7,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        2,
        5,
        5,
        2,
        6,
        3,
        0,
        4,
        3,
        4,
        7,
        -1,
        -1,
        -1,
        -1,
        8,
        4,
        7,
        9,
        0,
        5,
        0,
        6,
        5,
        0,
        2,
        6,
        -1,
        -1,
        -1,
        -1,
        7,
        3,
        9,
        7,
        9,
        4,
        3,
        2,
        9,
        5,
        9,
        6,
        2,
        6,
        9,
        -1,
        3,
        11,
        2,
        7,
        8,
        4,
        10,
        6,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        5,
        10,
        6,
        4,
        7,
        2,
        4,
        2,
        0,
        2,
        7,
        11,
        -1,
        -1,
        -1,
        -1,
        0,
        1,
        9,
        4,
        7,
        8,
        2,
        3,
        11,
        5,
        10,
        6,
        -1,
        -1,
        -1,
        -1,
        9,
        2,
        1,
        9,
        11,
        2,
        9,
        4,
        11,
        7,
        11,
        4,
        5,
        10,
        6,
        -1,
        8,
        4,
        7,
        3,
        11,
        5,
        3,
        5,
        1,
        5,
        11,
        6,
        -1,
        -1,
        -1,
        -1,
        5,
        1,
        11,
        5,
        11,
        6,
        1,
        0,
        11,
        7,
        11,
        4,
        0,
        4,
        11,
        -1,
        0,
        5,
        9,
        0,
        6,
        5,
        0,
        3,
        6,
        11,
        6,
        3,
        8,
        4,
        7,
        -1,
        6,
        5,
        9,
        6,
        9,
        11,
        4,
        7,
        9,
        7,
        11,
        9,
        -1,
        -1,
        -1,
        -1,
        10,
        4,
        9,
        6,
        4,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        10,
        6,
        4,
        9,
        10,
        0,
        8,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        0,
        1,
        10,
        6,
        0,
        6,
        4,
        0,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        8,
        3,
        1,
        8,
        1,
        6,
        8,
        6,
        4,
        6,
        1,
        10,
        -1,
        -1,
        -1,
        -1,
        1,
        4,
        9,
        1,
        2,
        4,
        2,
        6,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        0,
        8,
        1,
        2,
        9,
        2,
        4,
        9,
        2,
        6,
        4,
        -1,
        -1,
        -1,
        -1,
        0,
        2,
        4,
        4,
        2,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        8,
        3,
        2,
        8,
        2,
        4,
        4,
        2,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        4,
        9,
        10,
        6,
        4,
        11,
        2,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        8,
        2,
        2,
        8,
        11,
        4,
        9,
        10,
        4,
        10,
        6,
        -1,
        -1,
        -1,
        -1,
        3,
        11,
        2,
        0,
        1,
        6,
        0,
        6,
        4,
        6,
        1,
        10,
        -1,
        -1,
        -1,
        -1,
        6,
        4,
        1,
        6,
        1,
        10,
        4,
        8,
        1,
        2,
        1,
        11,
        8,
        11,
        1,
        -1,
        9,
        6,
        4,
        9,
        3,
        6,
        9,
        1,
        3,
        11,
        6,
        3,
        -1,
        -1,
        -1,
        -1,
        8,
        11,
        1,
        8,
        1,
        0,
        11,
        6,
        1,
        9,
        1,
        4,
        6,
        4,
        1,
        -1,
        3,
        11,
        6,
        3,
        6,
        0,
        0,
        6,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        6,
        4,
        8,
        11,
        6,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        7,
        10,
        6,
        7,
        8,
        10,
        8,
        9,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        7,
        3,
        0,
        10,
        7,
        0,
        9,
        10,
        6,
        7,
        10,
        -1,
        -1,
        -1,
        -1,
        10,
        6,
        7,
        1,
        10,
        7,
        1,
        7,
        8,
        1,
        8,
        0,
        -1,
        -1,
        -1,
        -1,
        10,
        6,
        7,
        10,
        7,
        1,
        1,
        7,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        2,
        6,
        1,
        6,
        8,
        1,
        8,
        9,
        8,
        6,
        7,
        -1,
        -1,
        -1,
        -1,
        2,
        6,
        9,
        2,
        9,
        1,
        6,
        7,
        9,
        0,
        9,
        3,
        7,
        3,
        9,
        -1,
        7,
        8,
        0,
        7,
        0,
        6,
        6,
        0,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        7,
        3,
        2,
        6,
        7,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        3,
        11,
        10,
        6,
        8,
        10,
        8,
        9,
        8,
        6,
        7,
        -1,
        -1,
        -1,
        -1,
        2,
        0,
        7,
        2,
        7,
        11,
        0,
        9,
        7,
        6,
        7,
        10,
        9,
        10,
        7,
        -1,
        1,
        8,
        0,
        1,
        7,
        8,
        1,
        10,
        7,
        6,
        7,
        10,
        2,
        3,
        11,
        -1,
        11,
        2,
        1,
        11,
        1,
        7,
        10,
        6,
        1,
        6,
        7,
        1,
        -1,
        -1,
        -1,
        -1,
        8,
        9,
        6,
        8,
        6,
        7,
        9,
        1,
        6,
        11,
        6,
        3,
        1,
        3,
        6,
        -1,
        0,
        9,
        1,
        11,
        6,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        7,
        8,
        0,
        7,
        0,
        6,
        3,
        11,
        0,
        11,
        6,
        0,
        -1,
        -1,
        -1,
        -1,
        7,
        11,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        7,
        6,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        0,
        8,
        11,
        7,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        1,
        9,
        11,
        7,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        8,
        1,
        9,
        8,
        3,
        1,
        11,
        7,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        1,
        2,
        6,
        11,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        2,
        10,
        3,
        0,
        8,
        6,
        11,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        9,
        0,
        2,
        10,
        9,
        6,
        11,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        6,
        11,
        7,
        2,
        10,
        3,
        10,
        8,
        3,
        10,
        9,
        8,
        -1,
        -1,
        -1,
        -1,
        7,
        2,
        3,
        6,
        2,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        7,
        0,
        8,
        7,
        6,
        0,
        6,
        2,
        0,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        7,
        6,
        2,
        3,
        7,
        0,
        1,
        9,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        6,
        2,
        1,
        8,
        6,
        1,
        9,
        8,
        8,
        7,
        6,
        -1,
        -1,
        -1,
        -1,
        10,
        7,
        6,
        10,
        1,
        7,
        1,
        3,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        7,
        6,
        1,
        7,
        10,
        1,
        8,
        7,
        1,
        0,
        8,
        -1,
        -1,
        -1,
        -1,
        0,
        3,
        7,
        0,
        7,
        10,
        0,
        10,
        9,
        6,
        10,
        7,
        -1,
        -1,
        -1,
        -1,
        7,
        6,
        10,
        7,
        10,
        8,
        8,
        10,
        9,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        6,
        8,
        4,
        11,
        8,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        6,
        11,
        3,
        0,
        6,
        0,
        4,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        8,
        6,
        11,
        8,
        4,
        6,
        9,
        0,
        1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        4,
        6,
        9,
        6,
        3,
        9,
        3,
        1,
        11,
        3,
        6,
        -1,
        -1,
        -1,
        -1,
        6,
        8,
        4,
        6,
        11,
        8,
        2,
        10,
        1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        2,
        10,
        3,
        0,
        11,
        0,
        6,
        11,
        0,
        4,
        6,
        -1,
        -1,
        -1,
        -1,
        4,
        11,
        8,
        4,
        6,
        11,
        0,
        2,
        9,
        2,
        10,
        9,
        -1,
        -1,
        -1,
        -1,
        10,
        9,
        3,
        10,
        3,
        2,
        9,
        4,
        3,
        11,
        3,
        6,
        4,
        6,
        3,
        -1,
        8,
        2,
        3,
        8,
        4,
        2,
        4,
        6,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        4,
        2,
        4,
        6,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        9,
        0,
        2,
        3,
        4,
        2,
        4,
        6,
        4,
        3,
        8,
        -1,
        -1,
        -1,
        -1,
        1,
        9,
        4,
        1,
        4,
        2,
        2,
        4,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        8,
        1,
        3,
        8,
        6,
        1,
        8,
        4,
        6,
        6,
        10,
        1,
        -1,
        -1,
        -1,
        -1,
        10,
        1,
        0,
        10,
        0,
        6,
        6,
        0,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        6,
        3,
        4,
        3,
        8,
        6,
        10,
        3,
        0,
        3,
        9,
        10,
        9,
        3,
        -1,
        10,
        9,
        4,
        6,
        10,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        9,
        5,
        7,
        6,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        8,
        3,
        4,
        9,
        5,
        11,
        7,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        5,
        0,
        1,
        5,
        4,
        0,
        7,
        6,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        11,
        7,
        6,
        8,
        3,
        4,
        3,
        5,
        4,
        3,
        1,
        5,
        -1,
        -1,
        -1,
        -1,
        9,
        5,
        4,
        10,
        1,
        2,
        7,
        6,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        6,
        11,
        7,
        1,
        2,
        10,
        0,
        8,
        3,
        4,
        9,
        5,
        -1,
        -1,
        -1,
        -1,
        7,
        6,
        11,
        5,
        4,
        10,
        4,
        2,
        10,
        4,
        0,
        2,
        -1,
        -1,
        -1,
        -1,
        3,
        4,
        8,
        3,
        5,
        4,
        3,
        2,
        5,
        10,
        5,
        2,
        11,
        7,
        6,
        -1,
        7,
        2,
        3,
        7,
        6,
        2,
        5,
        4,
        9,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        5,
        4,
        0,
        8,
        6,
        0,
        6,
        2,
        6,
        8,
        7,
        -1,
        -1,
        -1,
        -1,
        3,
        6,
        2,
        3,
        7,
        6,
        1,
        5,
        0,
        5,
        4,
        0,
        -1,
        -1,
        -1,
        -1,
        6,
        2,
        8,
        6,
        8,
        7,
        2,
        1,
        8,
        4,
        8,
        5,
        1,
        5,
        8,
        -1,
        9,
        5,
        4,
        10,
        1,
        6,
        1,
        7,
        6,
        1,
        3,
        7,
        -1,
        -1,
        -1,
        -1,
        1,
        6,
        10,
        1,
        7,
        6,
        1,
        0,
        7,
        8,
        7,
        0,
        9,
        5,
        4,
        -1,
        4,
        0,
        10,
        4,
        10,
        5,
        0,
        3,
        10,
        6,
        10,
        7,
        3,
        7,
        10,
        -1,
        7,
        6,
        10,
        7,
        10,
        8,
        5,
        4,
        10,
        4,
        8,
        10,
        -1,
        -1,
        -1,
        -1,
        6,
        9,
        5,
        6,
        11,
        9,
        11,
        8,
        9,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        6,
        11,
        0,
        6,
        3,
        0,
        5,
        6,
        0,
        9,
        5,
        -1,
        -1,
        -1,
        -1,
        0,
        11,
        8,
        0,
        5,
        11,
        0,
        1,
        5,
        5,
        6,
        11,
        -1,
        -1,
        -1,
        -1,
        6,
        11,
        3,
        6,
        3,
        5,
        5,
        3,
        1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        2,
        10,
        9,
        5,
        11,
        9,
        11,
        8,
        11,
        5,
        6,
        -1,
        -1,
        -1,
        -1,
        0,
        11,
        3,
        0,
        6,
        11,
        0,
        9,
        6,
        5,
        6,
        9,
        1,
        2,
        10,
        -1,
        11,
        8,
        5,
        11,
        5,
        6,
        8,
        0,
        5,
        10,
        5,
        2,
        0,
        2,
        5,
        -1,
        6,
        11,
        3,
        6,
        3,
        5,
        2,
        10,
        3,
        10,
        5,
        3,
        -1,
        -1,
        -1,
        -1,
        5,
        8,
        9,
        5,
        2,
        8,
        5,
        6,
        2,
        3,
        8,
        2,
        -1,
        -1,
        -1,
        -1,
        9,
        5,
        6,
        9,
        6,
        0,
        0,
        6,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        5,
        8,
        1,
        8,
        0,
        5,
        6,
        8,
        3,
        8,
        2,
        6,
        2,
        8,
        -1,
        1,
        5,
        6,
        2,
        1,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        3,
        6,
        1,
        6,
        10,
        3,
        8,
        6,
        5,
        6,
        9,
        8,
        9,
        6,
        -1,
        10,
        1,
        0,
        10,
        0,
        6,
        9,
        5,
        0,
        5,
        6,
        0,
        -1,
        -1,
        -1,
        -1,
        0,
        3,
        8,
        5,
        6,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        5,
        6,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        11,
        5,
        10,
        7,
        5,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        11,
        5,
        10,
        11,
        7,
        5,
        8,
        3,
        0,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        5,
        11,
        7,
        5,
        10,
        11,
        1,
        9,
        0,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        7,
        5,
        10,
        11,
        7,
        9,
        8,
        1,
        8,
        3,
        1,
        -1,
        -1,
        -1,
        -1,
        11,
        1,
        2,
        11,
        7,
        1,
        7,
        5,
        1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        8,
        3,
        1,
        2,
        7,
        1,
        7,
        5,
        7,
        2,
        11,
        -1,
        -1,
        -1,
        -1,
        9,
        7,
        5,
        9,
        2,
        7,
        9,
        0,
        2,
        2,
        11,
        7,
        -1,
        -1,
        -1,
        -1,
        7,
        5,
        2,
        7,
        2,
        11,
        5,
        9,
        2,
        3,
        2,
        8,
        9,
        8,
        2,
        -1,
        2,
        5,
        10,
        2,
        3,
        5,
        3,
        7,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        8,
        2,
        0,
        8,
        5,
        2,
        8,
        7,
        5,
        10,
        2,
        5,
        -1,
        -1,
        -1,
        -1,
        9,
        0,
        1,
        5,
        10,
        3,
        5,
        3,
        7,
        3,
        10,
        2,
        -1,
        -1,
        -1,
        -1,
        9,
        8,
        2,
        9,
        2,
        1,
        8,
        7,
        2,
        10,
        2,
        5,
        7,
        5,
        2,
        -1,
        1,
        3,
        5,
        3,
        7,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        8,
        7,
        0,
        7,
        1,
        1,
        7,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        0,
        3,
        9,
        3,
        5,
        5,
        3,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        8,
        7,
        5,
        9,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        5,
        8,
        4,
        5,
        10,
        8,
        10,
        11,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        5,
        0,
        4,
        5,
        11,
        0,
        5,
        10,
        11,
        11,
        3,
        0,
        -1,
        -1,
        -1,
        -1,
        0,
        1,
        9,
        8,
        4,
        10,
        8,
        10,
        11,
        10,
        4,
        5,
        -1,
        -1,
        -1,
        -1,
        10,
        11,
        4,
        10,
        4,
        5,
        11,
        3,
        4,
        9,
        4,
        1,
        3,
        1,
        4,
        -1,
        2,
        5,
        1,
        2,
        8,
        5,
        2,
        11,
        8,
        4,
        5,
        8,
        -1,
        -1,
        -1,
        -1,
        0,
        4,
        11,
        0,
        11,
        3,
        4,
        5,
        11,
        2,
        11,
        1,
        5,
        1,
        11,
        -1,
        0,
        2,
        5,
        0,
        5,
        9,
        2,
        11,
        5,
        4,
        5,
        8,
        11,
        8,
        5,
        -1,
        9,
        4,
        5,
        2,
        11,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        5,
        10,
        3,
        5,
        2,
        3,
        4,
        5,
        3,
        8,
        4,
        -1,
        -1,
        -1,
        -1,
        5,
        10,
        2,
        5,
        2,
        4,
        4,
        2,
        0,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        10,
        2,
        3,
        5,
        10,
        3,
        8,
        5,
        4,
        5,
        8,
        0,
        1,
        9,
        -1,
        5,
        10,
        2,
        5,
        2,
        4,
        1,
        9,
        2,
        9,
        4,
        2,
        -1,
        -1,
        -1,
        -1,
        8,
        4,
        5,
        8,
        5,
        3,
        3,
        5,
        1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        4,
        5,
        1,
        0,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        8,
        4,
        5,
        8,
        5,
        3,
        9,
        0,
        5,
        0,
        3,
        5,
        -1,
        -1,
        -1,
        -1,
        9,
        4,
        5,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        11,
        7,
        4,
        9,
        11,
        9,
        10,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        8,
        3,
        4,
        9,
        7,
        9,
        11,
        7,
        9,
        10,
        11,
        -1,
        -1,
        -1,
        -1,
        1,
        10,
        11,
        1,
        11,
        4,
        1,
        4,
        0,
        7,
        4,
        11,
        -1,
        -1,
        -1,
        -1,
        3,
        1,
        4,
        3,
        4,
        8,
        1,
        10,
        4,
        7,
        4,
        11,
        10,
        11,
        4,
        -1,
        4,
        11,
        7,
        9,
        11,
        4,
        9,
        2,
        11,
        9,
        1,
        2,
        -1,
        -1,
        -1,
        -1,
        9,
        7,
        4,
        9,
        11,
        7,
        9,
        1,
        11,
        2,
        11,
        1,
        0,
        8,
        3,
        -1,
        11,
        7,
        4,
        11,
        4,
        2,
        2,
        4,
        0,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        11,
        7,
        4,
        11,
        4,
        2,
        8,
        3,
        4,
        3,
        2,
        4,
        -1,
        -1,
        -1,
        -1,
        2,
        9,
        10,
        2,
        7,
        9,
        2,
        3,
        7,
        7,
        4,
        9,
        -1,
        -1,
        -1,
        -1,
        9,
        10,
        7,
        9,
        7,
        4,
        10,
        2,
        7,
        8,
        7,
        0,
        2,
        0,
        7,
        -1,
        3,
        7,
        10,
        3,
        10,
        2,
        7,
        4,
        10,
        1,
        10,
        0,
        4,
        0,
        10,
        -1,
        1,
        10,
        2,
        8,
        7,
        4,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        9,
        1,
        4,
        1,
        7,
        7,
        1,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        9,
        1,
        4,
        1,
        7,
        0,
        8,
        1,
        8,
        7,
        1,
        -1,
        -1,
        -1,
        -1,
        4,
        0,
        3,
        7,
        4,
        3,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        4,
        8,
        7,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        10,
        8,
        10,
        11,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        0,
        9,
        3,
        9,
        11,
        11,
        9,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        1,
        10,
        0,
        10,
        8,
        8,
        10,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        1,
        10,
        11,
        3,
        10,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        2,
        11,
        1,
        11,
        9,
        9,
        11,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        0,
        9,
        3,
        9,
        11,
        1,
        2,
        9,
        2,
        11,
        9,
        -1,
        -1,
        -1,
        -1,
        0,
        2,
        11,
        8,
        0,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        3,
        2,
        11,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        3,
        8,
        2,
        8,
        10,
        10,
        8,
        9,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        9,
        10,
        2,
        0,
        9,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        2,
        3,
        8,
        2,
        8,
        10,
        0,
        1,
        8,
        1,
        10,
        8,
        -1,
        -1,
        -1,
        -1,
        1,
        10,
        2,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        3,
        8,
        9,
        1,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        9,
        1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        0,
        3,
        8,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1
    ]);

    return threex.objects.MarchingCubes = MarchingCubes;

});
define('skylark-threejs-ex/objects/Reflector',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var Reflector = function (geometry, options) {
        THREE.Mesh.call(this, geometry);
        this.type = 'Reflector';
        var scope = this;
        options = options || {};
        var color = options.color !== undefined ? new THREE.Color(options.color) : new THREE.Color(8355711);
        var textureWidth = options.textureWidth || 512;
        var textureHeight = options.textureHeight || 512;
        var clipBias = options.clipBias || 0;
        var shader = options.shader || Reflector.ReflectorShader;
        var recursion = options.recursion !== undefined ? options.recursion : 0;
        var encoding = options.encoding !== undefined ? options.encoding : THREE.LinearEncoding;
        var reflectorPlane = new THREE.Plane();
        var normal = new THREE.Vector3();
        var reflectorWorldPosition = new THREE.Vector3();
        var cameraWorldPosition = new THREE.Vector3();
        var rotationMatrix = new THREE.Matrix4();
        var lookAtPosition = new THREE.Vector3(0, 0, -1);
        var clipPlane = new THREE.Vector4();
        var view = new THREE.Vector3();
        var target = new THREE.Vector3();
        var q = new THREE.Vector4();
        var textureMatrix = new THREE.Matrix4();
        var virtualCamera = new THREE.PerspectiveCamera();
        var parameters = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBFormat,
            stencilBuffer: false,
            encoding: encoding
        };
        var renderTarget = new THREE.WebGLRenderTarget(textureWidth, textureHeight, parameters);
        if (!THREE.MathUtils.isPowerOfTwo(textureWidth) || !THREE.MathUtils.isPowerOfTwo(textureHeight)) {
            renderTarget.texture.generateMipmaps = false;
        }
        var material = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(shader.uniforms),
            fragmentShader: shader.fragmentShader,
            vertexShader: shader.vertexShader
        });
        material.uniforms['tDiffuse'].value = renderTarget.texture;
        material.uniforms['color'].value = color;
        material.uniforms['textureMatrix'].value = textureMatrix;
        this.material = material;
        this.onBeforeRender = function (renderer, scene, camera) {
            if ('recursion' in camera.userData) {
                if (camera.userData.recursion === recursion)
                    return;
                camera.userData.recursion++;
            }
            reflectorWorldPosition.setFromMatrixPosition(scope.matrixWorld);
            cameraWorldPosition.setFromMatrixPosition(camera.matrixWorld);
            rotationMatrix.extractRotation(scope.matrixWorld);
            normal.set(0, 0, 1);
            normal.applyMatrix4(rotationMatrix);
            view.subVectors(reflectorWorldPosition, cameraWorldPosition);
            if (view.dot(normal) > 0)
                return;
            view.reflect(normal).negate();
            view.add(reflectorWorldPosition);
            rotationMatrix.extractRotation(camera.matrixWorld);
            lookAtPosition.set(0, 0, -1);
            lookAtPosition.applyMatrix4(rotationMatrix);
            lookAtPosition.add(cameraWorldPosition);
            target.subVectors(reflectorWorldPosition, lookAtPosition);
            target.reflect(normal).negate();
            target.add(reflectorWorldPosition);
            virtualCamera.position.copy(view);
            virtualCamera.up.set(0, 1, 0);
            virtualCamera.up.applyMatrix4(rotationMatrix);
            virtualCamera.up.reflect(normal);
            virtualCamera.lookAt(target);
            virtualCamera.far = camera.far;
            virtualCamera.updateMatrixWorld();
            virtualCamera.projectionMatrix.copy(camera.projectionMatrix);
            virtualCamera.userData.recursion = 0;
            textureMatrix.set(0.5, 0, 0, 0.5, 0, 0.5, 0, 0.5, 0, 0, 0.5, 0.5, 0, 0, 0, 1);
            textureMatrix.multiply(virtualCamera.projectionMatrix);
            textureMatrix.multiply(virtualCamera.matrixWorldInverse);
            textureMatrix.multiply(scope.matrixWorld);
            reflectorPlane.setFromNormalAndCoplanarPoint(normal, reflectorWorldPosition);
            reflectorPlane.applyMatrix4(virtualCamera.matrixWorldInverse);
            clipPlane.set(reflectorPlane.normal.x, reflectorPlane.normal.y, reflectorPlane.normal.z, reflectorPlane.constant);
            var projectionMatrix = virtualCamera.projectionMatrix;
            q.x = (Math.sign(clipPlane.x) + projectionMatrix.elements[8]) / projectionMatrix.elements[0];
            q.y = (Math.sign(clipPlane.y) + projectionMatrix.elements[9]) / projectionMatrix.elements[5];
            q.z = -1;
            q.w = (1 + projectionMatrix.elements[10]) / projectionMatrix.elements[14];
            clipPlane.multiplyScalar(2 / clipPlane.dot(q));
            projectionMatrix.elements[2] = clipPlane.x;
            projectionMatrix.elements[6] = clipPlane.y;
            projectionMatrix.elements[10] = clipPlane.z + 1 - clipBias;
            projectionMatrix.elements[14] = clipPlane.w;
            scope.visible = false;
            var currentRenderTarget = renderer.getRenderTarget();
            var currentXrEnabled = renderer.xr.enabled;
            var currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;
            renderer.xr.enabled = false;
            renderer.shadowMap.autoUpdate = false;
            renderer.setRenderTarget(renderTarget);
            if (renderer.autoClear === false)
                renderer.clear();
            renderer.render(scene, virtualCamera);
            renderer.xr.enabled = currentXrEnabled;
            renderer.shadowMap.autoUpdate = currentShadowAutoUpdate;
            renderer.setRenderTarget(currentRenderTarget);
            var viewport = camera.viewport;
            if (viewport !== undefined) {
                renderer.state.viewport(viewport);
            }
            scope.visible = true;
        };
        this.getRenderTarget = function () {
            return renderTarget;
        };
    };
    Reflector.prototype = Object.create(THREE.Mesh.prototype);
    Reflector.prototype.constructor = Reflector;
    Reflector.ReflectorShader = {
        uniforms: {
            'color': { value: null },
            'tDiffuse': { value: null },
            'textureMatrix': { value: null }
        },
        vertexShader: [
            'uniform mat4 textureMatrix;',
            'varying vec4 vUv;',
            'void main() {',
            '\tvUv = textureMatrix * vec4( position, 1.0 );',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec3 color;',
            'uniform sampler2D tDiffuse;',
            'varying vec4 vUv;',
            'float blendOverlay( float base, float blend ) {',
            '\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );',
            '}',
            'vec3 blendOverlay( vec3 base, vec3 blend ) {',
            '\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );',
            '}',
            'void main() {',
            '\tvec4 base = texture2DProj( tDiffuse, vUv );',
            '\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );',
            '}'
        ].join('\n')
    };

    return threex.objects.Reflector = Reflector;
});
define('skylark-threejs-ex/objects/ReflectorRTT',[
    "../threex",
	'./Reflector'
], function (
	threex,
	Reflector
) {
    'use strict';
    var ReflectorRTT = function (geometry, options) {
        Reflector.call(this, geometry, options);
        this.geometry.setDrawRange(0, 0);
    };
    ReflectorRTT.prototype = Object.create(Reflector.prototype);

    return threex.objects.ReflectorRTT = ReflectorRTT;
});
define('skylark-threejs-ex/objects/Refractor',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var Refractor = function (geometry, options) {
        THREE.Mesh.call(this, geometry);
        this.type = 'Refractor';
        var scope = this;
        options = options || {};
        var color = options.color !== undefined ? new THREE.Color(options.color) : new THREE.Color(8355711);
        var textureWidth = options.textureWidth || 512;
        var textureHeight = options.textureHeight || 512;
        var clipBias = options.clipBias || 0;
        var shader = options.shader || Refractor.RefractorShader;
        var encoding = options.encoding !== undefined ? options.encoding : THREE.LinearEncoding;
        var virtualCamera = new THREE.PerspectiveCamera();
        virtualCamera.matrixAutoUpdate = false;
        virtualCamera.userData.refractor = true;
        var refractorPlane = new THREE.Plane();
        var textureMatrix = new THREE.Matrix4();
        var parameters = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBFormat,
            stencilBuffer: false,
            encoding: encoding
        };
        var renderTarget = new THREE.WebGLRenderTarget(textureWidth, textureHeight, parameters);
        if (!THREE.MathUtils.isPowerOfTwo(textureWidth) || !THREE.MathUtils.isPowerOfTwo(textureHeight)) {
            renderTarget.texture.generateMipmaps = false;
        }
        this.material = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(shader.uniforms),
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            transparent: true
        });
        this.material.uniforms['color'].value = color;
        this.material.uniforms['tDiffuse'].value = renderTarget.texture;
        this.material.uniforms['textureMatrix'].value = textureMatrix;
        var visible = function () {
            var refractorWorldPosition = new THREE.Vector3();
            var cameraWorldPosition = new THREE.Vector3();
            var rotationMatrix = new THREE.Matrix4();
            var view = new THREE.Vector3();
            var normal = new THREE.Vector3();
            return function visible(camera) {
                refractorWorldPosition.setFromMatrixPosition(scope.matrixWorld);
                cameraWorldPosition.setFromMatrixPosition(camera.matrixWorld);
                view.subVectors(refractorWorldPosition, cameraWorldPosition);
                rotationMatrix.extractRotation(scope.matrixWorld);
                normal.set(0, 0, 1);
                normal.applyMatrix4(rotationMatrix);
                return view.dot(normal) < 0;
            };
        }();
        var updateRefractorPlane = function () {
            var normal = new THREE.Vector3();
            var position = new THREE.Vector3();
            var quaternion = new THREE.Quaternion();
            var scale = new THREE.Vector3();
            return function updateRefractorPlane() {
                scope.matrixWorld.decompose(position, quaternion, scale);
                normal.set(0, 0, 1).applyQuaternion(quaternion).normalize();
                normal.negate();
                refractorPlane.setFromNormalAndCoplanarPoint(normal, position);
            };
        }();
        var updateVirtualCamera = function () {
            var clipPlane = new THREE.Plane();
            var clipVector = new THREE.Vector4();
            var q = new THREE.Vector4();
            return function updateVirtualCamera(camera) {
                virtualCamera.matrixWorld.copy(camera.matrixWorld);
                virtualCamera.matrixWorldInverse.getInverse(virtualCamera.matrixWorld);
                virtualCamera.projectionMatrix.copy(camera.projectionMatrix);
                virtualCamera.far = camera.far;
                clipPlane.copy(refractorPlane);
                clipPlane.applyMatrix4(virtualCamera.matrixWorldInverse);
                clipVector.set(clipPlane.normal.x, clipPlane.normal.y, clipPlane.normal.z, clipPlane.constant);
                var projectionMatrix = virtualCamera.projectionMatrix;
                q.x = (Math.sign(clipVector.x) + projectionMatrix.elements[8]) / projectionMatrix.elements[0];
                q.y = (Math.sign(clipVector.y) + projectionMatrix.elements[9]) / projectionMatrix.elements[5];
                q.z = -1;
                q.w = (1 + projectionMatrix.elements[10]) / projectionMatrix.elements[14];
                clipVector.multiplyScalar(2 / clipVector.dot(q));
                projectionMatrix.elements[2] = clipVector.x;
                projectionMatrix.elements[6] = clipVector.y;
                projectionMatrix.elements[10] = clipVector.z + 1 - clipBias;
                projectionMatrix.elements[14] = clipVector.w;
            };
        }();
        function updateTextureMatrix(camera) {
            textureMatrix.set(0.5, 0, 0, 0.5, 0, 0.5, 0, 0.5, 0, 0, 0.5, 0.5, 0, 0, 0, 1);
            textureMatrix.multiply(camera.projectionMatrix);
            textureMatrix.multiply(camera.matrixWorldInverse);
            textureMatrix.multiply(scope.matrixWorld);
        }
        function render(renderer, scene, camera) {
            scope.visible = false;
            var currentRenderTarget = renderer.getRenderTarget();
            var currentXrEnabled = renderer.xr.enabled;
            var currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;
            renderer.xr.enabled = false;
            renderer.shadowMap.autoUpdate = false;
            renderer.setRenderTarget(renderTarget);
            if (renderer.autoClear === false)
                renderer.clear();
            renderer.render(scene, virtualCamera);
            renderer.xr.enabled = currentXrEnabled;
            renderer.shadowMap.autoUpdate = currentShadowAutoUpdate;
            renderer.setRenderTarget(currentRenderTarget);
            var viewport = camera.viewport;
            if (viewport !== undefined) {
                renderer.state.viewport(viewport);
            }
            scope.visible = true;
        }
        this.onBeforeRender = function (renderer, scene, camera) {
            if (camera.userData.refractor === true)
                return;
            if (!visible(camera) === true)
                return;
            updateRefractorPlane();
            updateTextureMatrix(camera);
            updateVirtualCamera(camera);
            render(renderer, scene, camera);
        };
        this.getRenderTarget = function () {
            return renderTarget;
        };
    };
    Refractor.prototype = Object.create(THREE.Mesh.prototype);
    Refractor.prototype.constructor = Refractor;
    Refractor.RefractorShader = {
        uniforms: {
            'color': { value: null },
            'tDiffuse': { value: null },
            'textureMatrix': { value: null }
        },
        vertexShader: [
            'uniform mat4 textureMatrix;',
            'varying vec4 vUv;',
            'void main() {',
            '\tvUv = textureMatrix * vec4( position, 1.0 );',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec3 color;',
            'uniform sampler2D tDiffuse;',
            'varying vec4 vUv;',
            'float blendOverlay( float base, float blend ) {',
            '\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );',
            '}',
            'vec3 blendOverlay( vec3 base, vec3 blend ) {',
            '\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );',
            '}',
            'void main() {',
            '\tvec4 base = texture2DProj( tDiffuse, vUv );',
            '\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );',
            '}'
        ].join('\n')
    };
    return threex.objects.Refractor = Refractor;
});
define('skylark-threejs-ex/objects/ShadowMesh',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ShadowMesh = function (mesh) {
        var shadowMaterial = new THREE.MeshBasicMaterial({
            color: 0,
            transparent: true,
            opacity: 0.6,
            depthWrite: false
        });
        THREE.Mesh.call(this, mesh.geometry, shadowMaterial);
        this.meshMatrix = mesh.matrixWorld;
        this.frustumCulled = false;
        this.matrixAutoUpdate = false;
    };
    ShadowMesh.prototype = Object.create(THREE.Mesh.prototype);
    ShadowMesh.prototype.constructor = ShadowMesh;
    ShadowMesh.prototype.update = function () {
        var shadowMatrix = new THREE.Matrix4();
        return function (plane, lightPosition4D) {
            var dot = plane.normal.x * lightPosition4D.x + plane.normal.y * lightPosition4D.y + plane.normal.z * lightPosition4D.z + -plane.constant * lightPosition4D.w;
            var sme = shadowMatrix.elements;
            sme[0] = dot - lightPosition4D.x * plane.normal.x;
            sme[4] = -lightPosition4D.x * plane.normal.y;
            sme[8] = -lightPosition4D.x * plane.normal.z;
            sme[12] = -lightPosition4D.x * -plane.constant;
            sme[1] = -lightPosition4D.y * plane.normal.x;
            sme[5] = dot - lightPosition4D.y * plane.normal.y;
            sme[9] = -lightPosition4D.y * plane.normal.z;
            sme[13] = -lightPosition4D.y * -plane.constant;
            sme[2] = -lightPosition4D.z * plane.normal.x;
            sme[6] = -lightPosition4D.z * plane.normal.y;
            sme[10] = dot - lightPosition4D.z * plane.normal.z;
            sme[14] = -lightPosition4D.z * -plane.constant;
            sme[3] = -lightPosition4D.w * plane.normal.x;
            sme[7] = -lightPosition4D.w * plane.normal.y;
            sme[11] = -lightPosition4D.w * plane.normal.z;
            sme[15] = dot - lightPosition4D.w * -plane.constant;
            this.matrix.multiplyMatrices(shadowMatrix, this.meshMatrix);
        };
    }();
    return threex.objects.ShadowMesh = ShadowMesh;
});
define('skylark-threejs-ex/objects/Sky',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var Sky = function () {
        var shader = Sky.SkyShader;
        var material = new THREE.ShaderMaterial({
            fragmentShader: shader.fragmentShader,
            vertexShader: shader.vertexShader,
            uniforms: THREE.UniformsUtils.clone(shader.uniforms),
            side: THREE.BackSide,
            depthWrite: false
        });
        THREE.Mesh.call(this, new THREE.BoxBufferGeometry(1, 1, 1), material);
    };
    Sky.prototype = Object.create(THREE.Mesh.prototype);
    Sky.SkyShader = {
        uniforms: {
            'luminance': { value: 1 },
            'turbidity': { value: 2 },
            'rayleigh': { value: 1 },
            'mieCoefficient': { value: 0.005 },
            'mieDirectionalG': { value: 0.8 },
            'sunPosition': { value: new THREE.Vector3() },
            'up': { value: new THREE.Vector3(0, 1, 0) }
        },
        vertexShader: [
            'uniform vec3 sunPosition;',
            'uniform float rayleigh;',
            'uniform float turbidity;',
            'uniform float mieCoefficient;',
            'uniform vec3 up;',
            'varying vec3 vWorldPosition;',
            'varying vec3 vSunDirection;',
            'varying float vSunfade;',
            'varying vec3 vBetaR;',
            'varying vec3 vBetaM;',
            'varying float vSunE;',
            'const float e = 2.71828182845904523536028747135266249775724709369995957;',
            'const float pi = 3.141592653589793238462643383279502884197169;',
            'const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );',
            'const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );',
            'const float v = 4.0;',
            'const vec3 K = vec3( 0.686, 0.678, 0.666 );',
            'const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );',
            'const float cutoffAngle = 1.6110731556870734;',
            'const float steepness = 1.5;',
            'const float EE = 1000.0;',
            'float sunIntensity( float zenithAngleCos ) {',
            '\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );',
            '\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );',
            '}',
            'vec3 totalMie( float T ) {',
            '\tfloat c = ( 0.2 * T ) * 10E-18;',
            '\treturn 0.434 * c * MieConst;',
            '}',
            'void main() {',
            '\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );',
            '\tvWorldPosition = worldPosition.xyz;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '\tgl_Position.z = gl_Position.w;',
            '\tvSunDirection = normalize( sunPosition );',
            '\tvSunE = sunIntensity( dot( vSunDirection, up ) );',
            '\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );',
            '\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );',
            '\tvBetaR = totalRayleigh * rayleighCoefficient;',
            '\tvBetaM = totalMie( turbidity ) * mieCoefficient;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'varying vec3 vWorldPosition;',
            'varying vec3 vSunDirection;',
            'varying float vSunfade;',
            'varying vec3 vBetaR;',
            'varying vec3 vBetaM;',
            'varying float vSunE;',
            'uniform float luminance;',
            'uniform float mieDirectionalG;',
            'uniform vec3 up;',
            'const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );',
            'const float pi = 3.141592653589793238462643383279502884197169;',
            'const float n = 1.0003;',
            'const float N = 2.545E25;',
            'const float rayleighZenithLength = 8.4E3;',
            'const float mieZenithLength = 1.25E3;',
            'const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;',
            'const float THREE_OVER_SIXTEENPI = 0.05968310365946075;',
            'const float ONE_OVER_FOURPI = 0.07957747154594767;',
            'float rayleighPhase( float cosTheta ) {',
            '\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );',
            '}',
            'float hgPhase( float cosTheta, float g ) {',
            '\tfloat g2 = pow( g, 2.0 );',
            '\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );',
            '\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );',
            '}',
            'const float A = 0.15;',
            'const float B = 0.50;',
            'const float C = 0.10;',
            'const float D = 0.20;',
            'const float E = 0.02;',
            'const float F = 0.30;',
            'const float whiteScale = 1.0748724675633854;',
            'vec3 Uncharted2Tonemap( vec3 x ) {',
            '\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;',
            '}',
            'void main() {',
            '\tvec3 direction = normalize( vWorldPosition - cameraPos );',
            '\tfloat zenithAngle = acos( max( 0.0, dot( up, direction ) ) );',
            '\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );',
            '\tfloat sR = rayleighZenithLength * inverse;',
            '\tfloat sM = mieZenithLength * inverse;',
            '\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );',
            '\tfloat cosTheta = dot( direction, vSunDirection );',
            '\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );',
            '\tvec3 betaRTheta = vBetaR * rPhase;',
            '\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );',
            '\tvec3 betaMTheta = vBetaM * mPhase;',
            '\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );',
            '\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );',
            '\tfloat theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]',
            '\tfloat phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]',
            '\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );',
            '\tvec3 L0 = vec3( 0.1 ) * Fex;',
            '\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );',
            '\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;',
            '\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );',
            '\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );',
            '\tvec3 color = curr * whiteScale;',
            '\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );',
            '\tgl_FragColor = vec4( retColor, 1.0 );',
            '}'
        ].join('\n')
    };
    return threex.objects.Sky = Sky;
});
define('skylark-threejs-ex/objects/Water',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var Water = function (geometry, options) {
        THREE.Mesh.call(this, geometry);
        var scope = this;
        options = options || {};
        var textureWidth = options.textureWidth !== undefined ? options.textureWidth : 512;
        var textureHeight = options.textureHeight !== undefined ? options.textureHeight : 512;
        var clipBias = options.clipBias !== undefined ? options.clipBias : 0;
        var alpha = options.alpha !== undefined ? options.alpha : 1;
        var time = options.time !== undefined ? options.time : 0;
        var normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;
        var sunDirection = options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0);
        var sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 16777215);
        var waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 8355711);
        var eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);
        var distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20;
        var side = options.side !== undefined ? options.side : THREE.FrontSide;
        var fog = options.fog !== undefined ? options.fog : false;
        var mirrorPlane = new THREE.Plane();
        var normal = new THREE.Vector3();
        var mirrorWorldPosition = new THREE.Vector3();
        var cameraWorldPosition = new THREE.Vector3();
        var rotationMatrix = new THREE.Matrix4();
        var lookAtPosition = new THREE.Vector3(0, 0, -1);
        var clipPlane = new THREE.Vector4();
        var view = new THREE.Vector3();
        var target = new THREE.Vector3();
        var q = new THREE.Vector4();
        var textureMatrix = new THREE.Matrix4();
        var mirrorCamera = new THREE.PerspectiveCamera();
        var parameters = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBFormat,
            stencilBuffer: false
        };
        var renderTarget = new THREE.WebGLRenderTarget(textureWidth, textureHeight, parameters);
        if (!THREE.MathUtils.isPowerOfTwo(textureWidth) || !THREE.MathUtils.isPowerOfTwo(textureHeight)) {
            renderTarget.texture.generateMipmaps = false;
        }
        var mirrorShader = {
            uniforms: THREE.UniformsUtils.merge([
                THREE.UniformsLib['fog'],
                THREE.UniformsLib['lights'],
                {
                    'normalSampler': { value: null },
                    'mirrorSampler': { value: null },
                    'alpha': { value: 1 },
                    'time': { value: 0 },
                    'size': { value: 1 },
                    'distortionScale': { value: 20 },
                    'textureMatrix': { value: new THREE.Matrix4() },
                    'sunColor': { value: new THREE.Color(8355711) },
                    'sunDirection': { value: new THREE.Vector3(0.70707, 0.70707, 0) },
                    'eye': { value: new THREE.Vector3() },
                    'waterColor': { value: new THREE.Color(5592405) }
                }
            ]),
            vertexShader: [
                'uniform mat4 textureMatrix;',
                'uniform float time;',
                'varying vec4 mirrorCoord;',
                'varying vec4 worldPosition;',
                '#include <common>',
                '#include <fog_pars_vertex>',
                '#include <shadowmap_pars_vertex>',
                '#include <logdepthbuf_pars_vertex>',
                'void main() {',
                '\tmirrorCoord = modelMatrix * vec4( position, 1.0 );',
                '\tworldPosition = mirrorCoord.xyzw;',
                '\tmirrorCoord = textureMatrix * mirrorCoord;',
                '\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );',
                '\tgl_Position = projectionMatrix * mvPosition;',
                '#include <logdepthbuf_vertex>',
                '#include <fog_vertex>',
                '#include <shadowmap_vertex>',
                '}'
            ].join('\n'),
            fragmentShader: [
                'uniform sampler2D mirrorSampler;',
                'uniform float alpha;',
                'uniform float time;',
                'uniform float size;',
                'uniform float distortionScale;',
                'uniform sampler2D normalSampler;',
                'uniform vec3 sunColor;',
                'uniform vec3 sunDirection;',
                'uniform vec3 eye;',
                'uniform vec3 waterColor;',
                'varying vec4 mirrorCoord;',
                'varying vec4 worldPosition;',
                'vec4 getNoise( vec2 uv ) {',
                '\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);',
                '\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );',
                '\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );',
                '\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );',
                '\tvec4 noise = texture2D( normalSampler, uv0 ) +',
                '\t\ttexture2D( normalSampler, uv1 ) +',
                '\t\ttexture2D( normalSampler, uv2 ) +',
                '\t\ttexture2D( normalSampler, uv3 );',
                '\treturn noise * 0.5 - 1.0;',
                '}',
                'void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {',
                '\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );',
                '\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );',
                '\tspecularColor += pow( direction, shiny ) * sunColor * spec;',
                '\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;',
                '}',
                '#include <common>',
                '#include <packing>',
                '#include <bsdfs>',
                '#include <fog_pars_fragment>',
                '#include <logdepthbuf_pars_fragment>',
                '#include <lights_pars_begin>',
                '#include <shadowmap_pars_fragment>',
                '#include <shadowmask_pars_fragment>',
                'void main() {',
                '#include <logdepthbuf_fragment>',
                '\tvec4 noise = getNoise( worldPosition.xz * size );',
                '\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );',
                '\tvec3 diffuseLight = vec3(0.0);',
                '\tvec3 specularLight = vec3(0.0);',
                '\tvec3 worldToEye = eye-worldPosition.xyz;',
                '\tvec3 eyeDirection = normalize( worldToEye );',
                '\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );',
                '\tfloat distance = length(worldToEye);',
                '\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;',
                '\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );',
                '\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );',
                '\tfloat rf0 = 0.3;',
                '\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );',
                '\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;',
                '\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);',
                '\tvec3 outgoingLight = albedo;',
                '\tgl_FragColor = vec4( outgoingLight, alpha );',
                '#include <tonemapping_fragment>',
                '#include <fog_fragment>',
                '}'
            ].join('\n')
        };
        var material = new THREE.ShaderMaterial({
            fragmentShader: mirrorShader.fragmentShader,
            vertexShader: mirrorShader.vertexShader,
            uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),
            lights: true,
            side: side,
            fog: fog
        });
        material.uniforms['mirrorSampler'].value = renderTarget.texture;
        material.uniforms['textureMatrix'].value = textureMatrix;
        material.uniforms['alpha'].value = alpha;
        material.uniforms['time'].value = time;
        material.uniforms['normalSampler'].value = normalSampler;
        material.uniforms['sunColor'].value = sunColor;
        material.uniforms['waterColor'].value = waterColor;
        material.uniforms['sunDirection'].value = sunDirection;
        material.uniforms['distortionScale'].value = distortionScale;
        material.uniforms['eye'].value = eye;
        scope.material = material;
        scope.onBeforeRender = function (renderer, scene, camera) {
            mirrorWorldPosition.setFromMatrixPosition(scope.matrixWorld);
            cameraWorldPosition.setFromMatrixPosition(camera.matrixWorld);
            rotationMatrix.extractRotation(scope.matrixWorld);
            normal.set(0, 0, 1);
            normal.applyMatrix4(rotationMatrix);
            view.subVectors(mirrorWorldPosition, cameraWorldPosition);
            if (view.dot(normal) > 0)
                return;
            view.reflect(normal).negate();
            view.add(mirrorWorldPosition);
            rotationMatrix.extractRotation(camera.matrixWorld);
            lookAtPosition.set(0, 0, -1);
            lookAtPosition.applyMatrix4(rotationMatrix);
            lookAtPosition.add(cameraWorldPosition);
            target.subVectors(mirrorWorldPosition, lookAtPosition);
            target.reflect(normal).negate();
            target.add(mirrorWorldPosition);
            mirrorCamera.position.copy(view);
            mirrorCamera.up.set(0, 1, 0);
            mirrorCamera.up.applyMatrix4(rotationMatrix);
            mirrorCamera.up.reflect(normal);
            mirrorCamera.lookAt(target);
            mirrorCamera.far = camera.far;
            mirrorCamera.updateMatrixWorld();
            mirrorCamera.projectionMatrix.copy(camera.projectionMatrix);
            textureMatrix.set(0.5, 0, 0, 0.5, 0, 0.5, 0, 0.5, 0, 0, 0.5, 0.5, 0, 0, 0, 1);
            textureMatrix.multiply(mirrorCamera.projectionMatrix);
            textureMatrix.multiply(mirrorCamera.matrixWorldInverse);
            mirrorPlane.setFromNormalAndCoplanarPoint(normal, mirrorWorldPosition);
            mirrorPlane.applyMatrix4(mirrorCamera.matrixWorldInverse);
            clipPlane.set(mirrorPlane.normal.x, mirrorPlane.normal.y, mirrorPlane.normal.z, mirrorPlane.constant);
            var projectionMatrix = mirrorCamera.projectionMatrix;
            q.x = (Math.sign(clipPlane.x) + projectionMatrix.elements[8]) / projectionMatrix.elements[0];
            q.y = (Math.sign(clipPlane.y) + projectionMatrix.elements[9]) / projectionMatrix.elements[5];
            q.z = -1;
            q.w = (1 + projectionMatrix.elements[10]) / projectionMatrix.elements[14];
            clipPlane.multiplyScalar(2 / clipPlane.dot(q));
            projectionMatrix.elements[2] = clipPlane.x;
            projectionMatrix.elements[6] = clipPlane.y;
            projectionMatrix.elements[10] = clipPlane.z + 1 - clipBias;
            projectionMatrix.elements[14] = clipPlane.w;
            eye.setFromMatrixPosition(camera.matrixWorld);
            var currentRenderTarget = renderer.getRenderTarget();
            var currentXrEnabled = renderer.xr.enabled;
            var currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;
            scope.visible = false;
            renderer.xr.enabled = false;
            renderer.shadowMap.autoUpdate = false;
            renderer.setRenderTarget(renderTarget);
            if (renderer.autoClear === false)
                renderer.clear();
            renderer.render(scene, mirrorCamera);
            scope.visible = true;
            renderer.xr.enabled = currentXrEnabled;
            renderer.shadowMap.autoUpdate = currentShadowAutoUpdate;
            renderer.setRenderTarget(currentRenderTarget);
            var viewport = camera.viewport;
            if (viewport !== undefined) {
                renderer.state.viewport(viewport);
            }
        };
    };
    Water.prototype = Object.create(THREE.Mesh.prototype);
    Water.prototype.constructor = Water;

    return threex.objects.Water = Water;
});
define('skylark-threejs-ex/objects/Water2',[
    "skylark-threejs",
    "../threex",
    '../objects/Reflector',
    '../objects/Refractor'
], function (
    THREE, 
    threex,
    Reflector, 
    Refractor
) {
    'use strict';
    var Water = function (geometry, options) {
        THREE.Mesh.call(this, geometry);
        this.type = 'Water';
        var scope = this;
        options = options || {};
        var color = options.color !== undefined ? new THREE.Color(options.color) : new THREE.Color(16777215);
        var textureWidth = options.textureWidth || 512;
        var textureHeight = options.textureHeight || 512;
        var clipBias = options.clipBias || 0;
        var flowDirection = options.flowDirection || new THREE.Vector2(1, 0);
        var flowSpeed = options.flowSpeed || 0.03;
        var reflectivity = options.reflectivity || 0.02;
        var scale = options.scale || 1;
        var shader = options.shader || Water.WaterShader;
        var encoding = options.encoding !== undefined ? options.encoding : THREE.LinearEncoding;
        var textureLoader = new THREE.TextureLoader();
        var flowMap = options.flowMap || undefined;
        var normalMap0 = options.normalMap0 || textureLoader.load('textures/water/Water_1_M_Normal.jpg');
        var normalMap1 = options.normalMap1 || textureLoader.load('textures/water/Water_2_M_Normal.jpg');
        var cycle = 0.15;
        var halfCycle = cycle * 0.5;
        var textureMatrix = new THREE.Matrix4();
        var clock = new THREE.Clock();
        if (Reflector === undefined) {
            console.error('THREE.Water: Required component Reflector not found.');
            return;
        }
        if (Refractor === undefined) {
            console.error('THREE.Water: Required component Refractor not found.');
            return;
        }
        var reflector = new Reflector(geometry, {
            textureWidth: textureWidth,
            textureHeight: textureHeight,
            clipBias: clipBias,
            encoding: encoding
        });
        var refractor = new Refractor(geometry, {
            textureWidth: textureWidth,
            textureHeight: textureHeight,
            clipBias: clipBias,
            encoding: encoding
        });
        reflector.matrixAutoUpdate = false;
        refractor.matrixAutoUpdate = false;
        this.material = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.merge([
                THREE.UniformsLib['fog'],
                shader.uniforms
            ]),
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            transparent: true,
            fog: true
        });
        if (flowMap !== undefined) {
            this.material.defines.USE_FLOWMAP = '';
            this.material.uniforms['tFlowMap'] = {
                type: 't',
                value: flowMap
            };
        } else {
            this.material.uniforms['flowDirection'] = {
                type: 'v2',
                value: flowDirection
            };
        }
        normalMap0.wrapS = normalMap0.wrapT = THREE.RepeatWrapping;
        normalMap1.wrapS = normalMap1.wrapT = THREE.RepeatWrapping;
        this.material.uniforms['tReflectionMap'].value = reflector.getRenderTarget().texture;
        this.material.uniforms['tRefractionMap'].value = refractor.getRenderTarget().texture;
        this.material.uniforms['tNormalMap0'].value = normalMap0;
        this.material.uniforms['tNormalMap1'].value = normalMap1;
        this.material.uniforms['color'].value = color;
        this.material.uniforms['reflectivity'].value = reflectivity;
        this.material.uniforms['textureMatrix'].value = textureMatrix;
        this.material.uniforms['config'].value.x = 0;
        this.material.uniforms['config'].value.y = halfCycle;
        this.material.uniforms['config'].value.z = halfCycle;
        this.material.uniforms['config'].value.w = scale;
        function updateTextureMatrix(camera) {
            textureMatrix.set(0.5, 0, 0, 0.5, 0, 0.5, 0, 0.5, 0, 0, 0.5, 0.5, 0, 0, 0, 1);
            textureMatrix.multiply(camera.projectionMatrix);
            textureMatrix.multiply(camera.matrixWorldInverse);
            textureMatrix.multiply(scope.matrixWorld);
        }
        function updateFlow() {
            var delta = clock.getDelta();
            var config = scope.material.uniforms['config'];
            config.value.x += flowSpeed * delta;
            config.value.y = config.value.x + halfCycle;
            if (config.value.x >= cycle) {
                config.value.x = 0;
                config.value.y = halfCycle;
            } else if (config.value.y >= cycle) {
                config.value.y = config.value.y - cycle;
            }
        }
        this.onBeforeRender = function (renderer, scene, camera) {
            updateTextureMatrix(camera);
            updateFlow();
            scope.visible = false;
            reflector.matrixWorld.copy(scope.matrixWorld);
            refractor.matrixWorld.copy(scope.matrixWorld);
            reflector.onBeforeRender(renderer, scene, camera);
            refractor.onBeforeRender(renderer, scene, camera);
            scope.visible = true;
        };
    };
    Water.prototype = Object.create(THREE.Mesh.prototype);
    Water.prototype.constructor = Water;
    Water.WaterShader = {
        uniforms: {
            'color': {
                type: 'c',
                value: null
            },
            'reflectivity': {
                type: 'f',
                value: 0
            },
            'tReflectionMap': {
                type: 't',
                value: null
            },
            'tRefractionMap': {
                type: 't',
                value: null
            },
            'tNormalMap0': {
                type: 't',
                value: null
            },
            'tNormalMap1': {
                type: 't',
                value: null
            },
            'textureMatrix': {
                type: 'm4',
                value: null
            },
            'config': {
                type: 'v4',
                value: new THREE.Vector4()
            }
        },
        vertexShader: [
            '#include <common>',
            '#include <fog_pars_vertex>',
            '#include <logdepthbuf_pars_vertex>',
            'uniform mat4 textureMatrix;',
            'varying vec4 vCoord;',
            'varying vec2 vUv;',
            'varying vec3 vToEye;',
            'void main() {',
            '\tvUv = uv;',
            '\tvCoord = textureMatrix * vec4( position, 1.0 );',
            '\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );',
            '\tvToEye = cameraPosition - worldPosition.xyz;',
            '\tvec4 mvPosition =  viewMatrix * worldPosition;',
            '\tgl_Position = projectionMatrix * mvPosition;',
            '\t#include <logdepthbuf_vertex>',
            '\t#include <fog_vertex>',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#include <common>',
            '#include <fog_pars_fragment>',
            '#include <logdepthbuf_pars_fragment>',
            'uniform sampler2D tReflectionMap;',
            'uniform sampler2D tRefractionMap;',
            'uniform sampler2D tNormalMap0;',
            'uniform sampler2D tNormalMap1;',
            '#ifdef USE_FLOWMAP',
            '\tuniform sampler2D tFlowMap;',
            '#else',
            '\tuniform vec2 flowDirection;',
            '#endif',
            'uniform vec3 color;',
            'uniform float reflectivity;',
            'uniform vec4 config;',
            'varying vec4 vCoord;',
            'varying vec2 vUv;',
            'varying vec3 vToEye;',
            'void main() {',
            '\t#include <logdepthbuf_fragment>',
            '\tfloat flowMapOffset0 = config.x;',
            '\tfloat flowMapOffset1 = config.y;',
            '\tfloat halfCycle = config.z;',
            '\tfloat scale = config.w;',
            '\tvec3 toEye = normalize( vToEye );',
            '\tvec2 flow;',
            '\t#ifdef USE_FLOWMAP',
            '\t\tflow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;',
            '\t#else',
            '\t\tflow = flowDirection;',
            '\t#endif',
            '\tflow.x *= - 1.0;',
            '\tvec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );',
            '\tvec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );',
            '\tfloat flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;',
            '\tvec4 normalColor = mix( normalColor0, normalColor1, flowLerp );',
            '\tvec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );',
            '\tfloat theta = max( dot( toEye, normal ), 0.0 );',
            '\tfloat reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );',
            '\tvec3 coord = vCoord.xyz / vCoord.w;',
            '\tvec2 uv = coord.xy + coord.z * normal.xz * 0.05;',
            '\tvec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );',
            '\tvec4 refractColor = texture2D( tRefractionMap, uv );',
            '\tgl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );',
            '\t#include <tonemapping_fragment>',
            '\t#include <encodings_fragment>',
            '\t#include <fog_fragment>',
            '}'
        ].join('\n')
    };
    return threex.objects.Water2 = Water;
});
define('skylark-threejs-ex/physics/CannonPhysics',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    function compose(position, quaternion, array, index) {
        var x = quaternion.x, y = quaternion.y, z = quaternion.z, w = quaternion.w;
        var x2 = x + x, y2 = y + y, z2 = z + z;
        var xx = x * x2, xy = x * y2, xz = x * z2;
        var yy = y * y2, yz = y * z2, zz = z * z2;
        var wx = w * x2, wy = w * y2, wz = w * z2;
        array[index + 0] = 1 - (yy + zz);
        array[index + 1] = xy + wz;
        array[index + 2] = xz - wy;
        array[index + 3] = 0;
        array[index + 4] = xy - wz;
        array[index + 5] = 1 - (xx + zz);
        array[index + 6] = yz + wx;
        array[index + 7] = 0;
        array[index + 8] = xz + wy;
        array[index + 9] = yz - wx;
        array[index + 10] = 1 - (xx + yy);
        array[index + 11] = 0;
        array[index + 12] = position.x;
        array[index + 13] = position.y;
        array[index + 14] = position.z;
        array[index + 15] = 1;
    }
    function CannonPhysics() {
        var frameRate = 60;
        var frameTime = 1 / frameRate;
        var world = new CANNON.World();
        world.gravity.set(0, -9.8, 0);
        world.broadphase = new CANNON.SAPBroadphase(world);
        function getShape(geometry) {
            var parameters = geometry.parameters;
            switch (geometry.type) {
            case 'BoxBufferGeometry':
                var halfExtents = new CANNON.Vec3();
                halfExtents.x = parameters.width !== undefined ? parameters.width / 2 : 0.5;
                halfExtents.y = parameters.height !== undefined ? parameters.height / 2 : 0.5;
                halfExtents.z = parameters.depth !== undefined ? parameters.depth / 2 : 0.5;
                return new CANNON.Box(halfExtents);
            case 'PlaneBufferGeometry':
                return new CANNON.Plane();
            case 'SphereBufferGeometry':
                var radius = parameters.radius;
                return new CANNON.Sphere(radius);
            }
            return null;
        }
        var meshes = [];
        var meshMap = new WeakMap();
        function addMesh(mesh, mass = 0) {
            var shape = getShape(mesh.geometry);
            if (shape !== null) {
                if (mesh.isInstancedMesh) {
                    handleInstancedMesh(mesh, mass, shape);
                } else if (mesh.isMesh) {
                    handleMesh(mesh, mass, shape);
                }
            }
        }
        function handleMesh(mesh, mass, shape) {
            var position = new CANNON.Vec3();
            position.copy(mesh.position);
            var quaternion = new CANNON.Quaternion();
            quaternion.copy(mesh.quaternion);
            var body = new CANNON.Body({
                position: position,
                quaternion: quaternion,
                mass: mass,
                shape: shape
            });
            world.addBody(body);
            if (mass > 0) {
                meshes.push(mesh);
                meshMap.set(mesh, body);
            }
        }
        function handleInstancedMesh(mesh, mass, shape) {
            var array = mesh.instanceMatrix.array;
            var bodies = [];
            for (var i = 0; i < mesh.count; i++) {
                var index = i * 16;
                var position = new CANNON.Vec3();
                position.set(array[index + 12], array[index + 13], array[index + 14]);
                var body = new CANNON.Body({
                    position: position,
                    mass: mass,
                    shape: shape
                });
                world.addBody(body);
                bodies.push(body);
            }
            if (mass > 0) {
                mesh.instanceMatrix.setUsage(35048);
                meshes.push(mesh);
                meshMap.set(mesh, bodies);
            }
        }
        function setMeshPosition(mesh, position, index = 0) {
            if (mesh.isInstancedMesh) {
                var bodies = meshMap.get(mesh);
                bodies[index].position.copy(position);
            } else if (mesh.isMesh) {
                var body = meshMap.get(mesh);
                body.position.copy(position);
            }
        }
        var lastTime = 0;
        function step() {
            var time = performance.now();
            if (lastTime > 0) {
                var delta = (time - lastTime) / 1000;
                world.step(frameTime, delta, frameRate);
            }
            lastTime = time;
            for (var i = 0, l = meshes.length; i < l; i++) {
                var mesh = meshes[i];
                if (mesh.isInstancedMesh) {
                    var array = mesh.instanceMatrix.array;
                    var bodies = meshMap.get(mesh);
                    for (var j = 0; j < bodies.length; j++) {
                        var body = bodies[j];
                        compose(body.position, body.quaternion, array, j * 16);
                    }
                    mesh.instanceMatrix.needsUpdate = true;
                } else if (mesh.isMesh) {
                    var body = meshMap.get(mesh);
                    mesh.position.copy(body.position);
                    mesh.quaternion.copy(body.quaternion);
                }
            }
        }
        setInterval(step, 1000 / frameRate);
        return {
            addMesh: addMesh,
            setMeshPosition: setMeshPosition
        };
    }
    return threex.physics.CannonPhysics = CannonPhysics;
});
define('skylark-threejs-ex/postprocessing/Pass',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    function Pass() {
        this.enabled = true;
        this.needsSwap = true;
        this.clear = false;
        this.renderToScreen = false;
    }
    Object.assign(Pass.prototype, {
        setSize: function () {
        },
        render: function () {
            console.error('THREE.Pass: .render() must be implemented in derived pass.');
        }
    });
    Pass.FullScreenQuad = function () {
        var camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);
        var geometry = new THREE.PlaneBufferGeometry(2, 2);
        var FullScreenQuad = function (material) {
            this._mesh = new THREE.Mesh(geometry, material);
        };
        Object.defineProperty(FullScreenQuad.prototype, 'material', {
            get: function () {
                return this._mesh.material;
            },
            set: function (value) {
                this._mesh.material = value;
            }
        });
        Object.assign(FullScreenQuad.prototype, {
            dispose: function () {
                this._mesh.geometry.dispose();
            },
            render: function (renderer) {
                renderer.render(this._mesh, camera);
            }
        });
        return FullScreenQuad;
    }();

    return threex.postprocessing.Pass = Pass;
});
define('skylark-threejs-ex/shaders/CopyShader',[
    "../threex"
],function (threex) {
    'use strict';
    var CopyShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'opacity': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float opacity;',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 texel = texture2D( tDiffuse, vUv );',
            '\tgl_FragColor = opacity * texel;',
            '}'
        ].join('\n')
    };
    return threex.shaders.CopyShader = CopyShader;
});
define('skylark-threejs-ex/shaders/LuminosityShader',[
    "../threex"
],function (threex) {
    'use strict';
    var LuminosityShader = {
        uniforms: { 'tDiffuse': { value: null } },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#include <common>',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 texel = texture2D( tDiffuse, vUv );',
            '\tfloat l = linearToRelativeLuminance( texel.rgb );',
            '\tgl_FragColor = vec4( l, l, l, texel.w );',
            '}'
        ].join('\n')
    };
    return  threex.shaders.LuminosityShader = LuminosityShader;
});
define('skylark-threejs-ex/shaders/ToneMapShader',[
    "../threex"
],function (threex) {
    'use strict';
    var ToneMapShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'averageLuminance': { value: 1 },
            'luminanceMap': { value: null },
            'maxLuminance': { value: 16 },
            'minLuminance': { value: 0.01 },
            'middleGrey': { value: 0.6 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#include <common>',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'uniform float middleGrey;',
            'uniform float minLuminance;',
            'uniform float maxLuminance;',
            '#ifdef ADAPTED_LUMINANCE',
            '\tuniform sampler2D luminanceMap;',
            '#else',
            '\tuniform float averageLuminance;',
            '#endif',
            'vec3 ToneMap( vec3 vColor ) {',
            '\t#ifdef ADAPTED_LUMINANCE',
            '\t\tfloat fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;',
            '\t#else',
            '\t\tfloat fLumAvg = averageLuminance;',
            '\t#endif',
            '\tfloat fLumPixel = linearToRelativeLuminance( vColor );',
            '\tfloat fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );',
            '\tfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);',
            '\treturn fLumCompressed * vColor;',
            '}',
            'void main() {',
            '\tvec4 texel = texture2D( tDiffuse, vUv );',
            '\tgl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );',
            '}'
        ].join('\n')
    };
    return  threex.shaders.ToneMapShader = ToneMapShader;
});
define('skylark-threejs-ex/postprocessing/AdaptiveToneMappingPass',[
    "skylark-threejs",
    "../threex",
    '../postprocessing/Pass',
    '../shaders/CopyShader',
    '../shaders/LuminosityShader',
    '../shaders/ToneMapShader'
], function (
    THREE, 
    threex,
    Pass, 
    CopyShader, 
    LuminosityShader, 
    ToneMapShader
) {
    'use strict';
    var AdaptiveToneMappingPass = function (adaptive, resolution) {
        Pass.call(this);
        this.resolution = resolution !== undefined ? resolution : 256;
        this.needsInit = true;
        this.adaptive = adaptive !== undefined ? !!adaptive : true;
        this.luminanceRT = null;
        this.previousLuminanceRT = null;
        this.currentLuminanceRT = null;
        if (CopyShader === undefined)
            console.error('AdaptiveToneMappingPass relies on CopyShader');
        var copyShader = CopyShader;
        this.copyUniforms = THREE.UniformsUtils.clone(copyShader.uniforms);
        this.materialCopy = new THREE.ShaderMaterial({
            uniforms: this.copyUniforms,
            vertexShader: copyShader.vertexShader,
            fragmentShader: copyShader.fragmentShader,
            blending: THREE.NoBlending,
            depthTest: false
        });
        if (LuminosityShader === undefined)
            console.error('AdaptiveToneMappingPass relies on LuminosityShader');
        this.materialLuminance = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(LuminosityShader.uniforms),
            vertexShader: LuminosityShader.vertexShader,
            fragmentShader: LuminosityShader.fragmentShader,
            blending: THREE.NoBlending
        });
        this.adaptLuminanceShader = {
            defines: { 'MIP_LEVEL_1X1': (Math.log(this.resolution) / Math.log(2)).toFixed(1) },
            uniforms: {
                'lastLum': { value: null },
                'currentLum': { value: null },
                'minLuminance': { value: 0.01 },
                'delta': { value: 0.016 },
                'tau': { value: 1 }
            },
            vertexShader: [
                'varying vec2 vUv;',
                'void main() {',
                '\tvUv = uv;',
                '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
                '}'
            ].join('\n'),
            fragmentShader: [
                'varying vec2 vUv;',
                'uniform sampler2D lastLum;',
                'uniform sampler2D currentLum;',
                'uniform float minLuminance;',
                'uniform float delta;',
                'uniform float tau;',
                'void main() {',
                '\tvec4 lastLum = texture2D( lastLum, vUv, MIP_LEVEL_1X1 );',
                '\tvec4 currentLum = texture2D( currentLum, vUv, MIP_LEVEL_1X1 );',
                '\tfloat fLastLum = max( minLuminance, lastLum.r );',
                '\tfloat fCurrentLum = max( minLuminance, currentLum.r );',
                '\tfCurrentLum *= fCurrentLum;',
                '\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));',
                '\tgl_FragColor.r = fAdaptedLum;',
                '}'
            ].join('\n')
        };
        this.materialAdaptiveLum = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(this.adaptLuminanceShader.uniforms),
            vertexShader: this.adaptLuminanceShader.vertexShader,
            fragmentShader: this.adaptLuminanceShader.fragmentShader,
            defines: Object.assign({}, this.adaptLuminanceShader.defines),
            blending: THREE.NoBlending
        });
        if (ToneMapShader === undefined)
            console.error('AdaptiveToneMappingPass relies on ToneMapShader');
        this.materialToneMap = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(ToneMapShader.uniforms),
            vertexShader: ToneMapShader.vertexShader,
            fragmentShader: ToneMapShader.fragmentShader,
            blending: THREE.NoBlending
        });
        this.fsQuad = new Pass.FullScreenQuad(null);
    };
    AdaptiveToneMappingPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: AdaptiveToneMappingPass,
        render: function (renderer, writeBuffer, readBuffer, deltaTime) {
            if (this.needsInit) {
                this.reset(renderer);
                this.luminanceRT.texture.type = readBuffer.texture.type;
                this.previousLuminanceRT.texture.type = readBuffer.texture.type;
                this.currentLuminanceRT.texture.type = readBuffer.texture.type;
                this.needsInit = false;
            }
            if (this.adaptive) {
                this.fsQuad.material = this.materialLuminance;
                this.materialLuminance.uniforms.tDiffuse.value = readBuffer.texture;
                renderer.setRenderTarget(this.currentLuminanceRT);
                this.fsQuad.render(renderer);
                this.fsQuad.material = this.materialAdaptiveLum;
                this.materialAdaptiveLum.uniforms.delta.value = deltaTime;
                this.materialAdaptiveLum.uniforms.lastLum.value = this.previousLuminanceRT.texture;
                this.materialAdaptiveLum.uniforms.currentLum.value = this.currentLuminanceRT.texture;
                renderer.setRenderTarget(this.luminanceRT);
                this.fsQuad.render(renderer);
                this.fsQuad.material = this.materialCopy;
                this.copyUniforms.tDiffuse.value = this.luminanceRT.texture;
                renderer.setRenderTarget(this.previousLuminanceRT);
                this.fsQuad.render(renderer);
            }
            this.fsQuad.material = this.materialToneMap;
            this.materialToneMap.uniforms.tDiffuse.value = readBuffer.texture;
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(writeBuffer);
                if (this.clear)
                    renderer.clear();
                this.fsQuad.render(renderer);
            }
        },
        reset: function () {
            if (this.luminanceRT) {
                this.luminanceRT.dispose();
            }
            if (this.currentLuminanceRT) {
                this.currentLuminanceRT.dispose();
            }
            if (this.previousLuminanceRT) {
                this.previousLuminanceRT.dispose();
            }
            var pars = {
                minFilter: THREE.LinearFilter,
                magFilter: THREE.LinearFilter,
                format: THREE.RGBAFormat
            };
            this.luminanceRT = new THREE.WebGLRenderTarget(this.resolution, this.resolution, pars);
            this.luminanceRT.texture.name = 'AdaptiveToneMappingPass.l';
            this.luminanceRT.texture.generateMipmaps = false;
            this.previousLuminanceRT = new THREE.WebGLRenderTarget(this.resolution, this.resolution, pars);
            this.previousLuminanceRT.texture.name = 'AdaptiveToneMappingPass.pl';
            this.previousLuminanceRT.texture.generateMipmaps = false;
            pars.minFilter = THREE.LinearMipmapLinearFilter;
            pars.generateMipmaps = true;
            this.currentLuminanceRT = new THREE.WebGLRenderTarget(this.resolution, this.resolution, pars);
            this.currentLuminanceRT.texture.name = 'AdaptiveToneMappingPass.cl';
            if (this.adaptive) {
                this.materialToneMap.defines['ADAPTED_LUMINANCE'] = '';
                this.materialToneMap.uniforms.luminanceMap.value = this.luminanceRT.texture;
            }
            this.fsQuad.material = new THREE.MeshBasicMaterial({ color: 7829367 });
            this.materialLuminance.needsUpdate = true;
            this.materialAdaptiveLum.needsUpdate = true;
            this.materialToneMap.needsUpdate = true;
        },
        setAdaptive: function (adaptive) {
            if (adaptive) {
                this.adaptive = true;
                this.materialToneMap.defines['ADAPTED_LUMINANCE'] = '';
                this.materialToneMap.uniforms.luminanceMap.value = this.luminanceRT.texture;
            } else {
                this.adaptive = false;
                delete this.materialToneMap.defines['ADAPTED_LUMINANCE'];
                this.materialToneMap.uniforms.luminanceMap.value = null;
            }
            this.materialToneMap.needsUpdate = true;
        },
        setAdaptionRate: function (rate) {
            if (rate) {
                this.materialAdaptiveLum.uniforms.tau.value = Math.abs(rate);
            }
        },
        setMinLuminance: function (minLum) {
            if (minLum) {
                this.materialToneMap.uniforms.minLuminance.value = minLum;
                this.materialAdaptiveLum.uniforms.minLuminance.value = minLum;
            }
        },
        setMaxLuminance: function (maxLum) {
            if (maxLum) {
                this.materialToneMap.uniforms.maxLuminance.value = maxLum;
            }
        },
        setAverageLuminance: function (avgLum) {
            if (avgLum) {
                this.materialToneMap.uniforms.averageLuminance.value = avgLum;
            }
        },
        setMiddleGrey: function (middleGrey) {
            if (middleGrey) {
                this.materialToneMap.uniforms.middleGrey.value = middleGrey;
            }
        },
        dispose: function () {
            if (this.luminanceRT) {
                this.luminanceRT.dispose();
            }
            if (this.previousLuminanceRT) {
                this.previousLuminanceRT.dispose();
            }
            if (this.currentLuminanceRT) {
                this.currentLuminanceRT.dispose();
            }
            if (this.materialLuminance) {
                this.materialLuminance.dispose();
            }
            if (this.materialAdaptiveLum) {
                this.materialAdaptiveLum.dispose();
            }
            if (this.materialCopy) {
                this.materialCopy.dispose();
            }
            if (this.materialToneMap) {
                this.materialToneMap.dispose();
            }
        }
    });
    return threex.postprocessing.AdaptiveToneMappingPass = AdaptiveToneMappingPass;
});
define('skylark-threejs-ex/shaders/AfterimageShader',[
    "../threex"
],function (threex) {
    'use strict';
    var AfterimageShader = {
        uniforms: {
            'damp': { value: 0.96 },
            'tOld': { value: null },
            'tNew': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float damp;',
            'uniform sampler2D tOld;',
            'uniform sampler2D tNew;',
            'varying vec2 vUv;',
            'vec4 when_gt( vec4 x, float y ) {',
            '\treturn max( sign( x - y ), 0.0 );',
            '}',
            'void main() {',
            '\tvec4 texelOld = texture2D( tOld, vUv );',
            '\tvec4 texelNew = texture2D( tNew, vUv );',
            '\ttexelOld *= damp * when_gt( texelOld, 0.1 );',
            '\tgl_FragColor = max(texelNew, texelOld);',
            '}'
        ].join('\n')
    };
    return threex.shaders.AfterimageShader = AfterimageShader;
});
define('skylark-threejs-ex/postprocessing/AfterimagePass',[
    "skylark-threejs",
    "../threex",
    '../postprocessing/Pass',
    '../shaders/AfterimageShader'
], function (
    THREE, 
    threex,
    Pass, 
    AfterimageShader
) {
    'use strict';
    var AfterimagePass = function (damp) {
        Pass.call(this);
        if (AfterimageShader === undefined)
            console.error('AfterimagePass relies on AfterimageShader');
        this.shader = AfterimageShader;
        this.uniforms = THREE.UniformsUtils.clone(this.shader.uniforms);
        this.uniforms['damp'].value = damp !== undefined ? damp : 0.96;
        this.textureComp = new THREE.WebGLRenderTarget(window.innerWidth, window.innerHeight, {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.NearestFilter,
            format: THREE.RGBAFormat
        });
        this.textureOld = new THREE.WebGLRenderTarget(window.innerWidth, window.innerHeight, {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.NearestFilter,
            format: THREE.RGBAFormat
        });
        this.shaderMaterial = new THREE.ShaderMaterial({
            uniforms: this.uniforms,
            vertexShader: this.shader.vertexShader,
            fragmentShader: this.shader.fragmentShader
        });
        this.compFsQuad = new Pass.FullScreenQuad(this.shaderMaterial);
        var material = new THREE.MeshBasicMaterial();
        this.copyFsQuad = new Pass.FullScreenQuad(material);
    };
    AfterimagePass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: AfterimagePass,
        render: function (renderer, writeBuffer, readBuffer) {
            this.uniforms['tOld'].value = this.textureOld.texture;
            this.uniforms['tNew'].value = readBuffer.texture;
            renderer.setRenderTarget(this.textureComp);
            this.compFsQuad.render(renderer);
            this.copyFsQuad.material.map = this.textureComp.texture;
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.copyFsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(writeBuffer);
                if (this.clear)
                    renderer.clear();
                this.copyFsQuad.render(renderer);
            }
            var temp = this.textureOld;
            this.textureOld = this.textureComp;
            this.textureComp = temp;
        },
        setSize: function (width, height) {
            this.textureComp.setSize(width, height);
            this.textureOld.setSize(width, height);
        }
    });
    return threex.postprocessing.AfterimagePass = AfterimagePass;
});
define('skylark-threejs-ex/shaders/ConvolutionShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ConvolutionShader = {
        defines: {
            'KERNEL_SIZE_FLOAT': '25.0',
            'KERNEL_SIZE_INT': '25'
        },
        uniforms: {
            'tDiffuse': { value: null },
            'uImageIncrement': { value: new THREE.Vector2(0.001953125, 0) },
            'cKernel': { value: [] }
        },
        vertexShader: [
            'uniform vec2 uImageIncrement;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float cKernel[ KERNEL_SIZE_INT ];',
            'uniform sampler2D tDiffuse;',
            'uniform vec2 uImageIncrement;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec2 imageCoord = vUv;',
            '\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );',
            '\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {',
            '\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];',
            '\t\timageCoord += uImageIncrement;',
            '\t}',
            '\tgl_FragColor = sum;',
            '}'
        ].join('\n'),
        buildKernel: function (sigma) {
            function gauss(x, sigma) {
                return Math.exp(-(x * x) / (2 * sigma * sigma));
            }
            var i, values, sum, halfWidth, kMaxKernelSize = 25, kernelSize = 2 * Math.ceil(sigma * 3) + 1;
            if (kernelSize > kMaxKernelSize)
                kernelSize = kMaxKernelSize;
            halfWidth = (kernelSize - 1) * 0.5;
            values = new Array(kernelSize);
            sum = 0;
            for (i = 0; i < kernelSize; ++i) {
                values[i] = gauss(i - halfWidth, sigma);
                sum += values[i];
            }
            for (i = 0; i < kernelSize; ++i)
                values[i] /= sum;
            return values;
        }
    };

    return threex.shaders.ConvolutionShader = ConvolutionShader;
});
define('skylark-threejs-ex/postprocessing/BloomPass',[
    "skylark-threejs",
    "../threex",
    '../postprocessing/Pass',
    '../shaders/CopyShader',
    '../shaders/ConvolutionShader'
], function (
    THREE, 
    threex,
    Pass, 
    CopyShader, 
    ConvolutionShader
) {
    'use strict';
    var BloomPass = function (strength, kernelSize, sigma, resolution) {
        Pass.call(this);
        strength = strength !== undefined ? strength : 1;
        kernelSize = kernelSize !== undefined ? kernelSize : 25;
        sigma = sigma !== undefined ? sigma : 4;
        resolution = resolution !== undefined ? resolution : 256;
        var pars = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBAFormat
        };
        this.renderTargetX = new THREE.WebGLRenderTarget(resolution, resolution, pars);
        this.renderTargetX.texture.name = 'BloomPass.x';
        this.renderTargetY = new THREE.WebGLRenderTarget(resolution, resolution, pars);
        this.renderTargetY.texture.name = 'BloomPass.y';
        if (CopyShader === undefined)
            console.error('BloomPass relies on CopyShader');
        var copyShader = CopyShader;
        this.copyUniforms = THREE.UniformsUtils.clone(copyShader.uniforms);
        this.copyUniforms['opacity'].value = strength;
        this.materialCopy = new THREE.ShaderMaterial({
            uniforms: this.copyUniforms,
            vertexShader: copyShader.vertexShader,
            fragmentShader: copyShader.fragmentShader,
            blending: THREE.AdditiveBlending,
            transparent: true
        });
        if (ConvolutionShader === undefined)
            console.error('BloomPass relies on ConvolutionShader');
        var convolutionShader = ConvolutionShader;
        this.convolutionUniforms = THREE.UniformsUtils.clone(convolutionShader.uniforms);
        this.convolutionUniforms['uImageIncrement'].value = BloomPass.blurX;
        this.convolutionUniforms['cKernel'].value = ConvolutionShader.buildKernel(sigma);
        this.materialConvolution = new THREE.ShaderMaterial({
            uniforms: this.convolutionUniforms,
            vertexShader: convolutionShader.vertexShader,
            fragmentShader: convolutionShader.fragmentShader,
            defines: {
                'KERNEL_SIZE_FLOAT': kernelSize.toFixed(1),
                'KERNEL_SIZE_INT': kernelSize.toFixed(0)
            }
        });
        this.needsSwap = false;
        this.fsQuad = new Pass.FullScreenQuad(null);
    };
    BloomPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: BloomPass,
        render: function (renderer, writeBuffer, readBuffer, deltaTime, maskActive) {
            if (maskActive)
                renderer.state.buffers.stencil.setTest(false);
            this.fsQuad.material = this.materialConvolution;
            this.convolutionUniforms['tDiffuse'].value = readBuffer.texture;
            this.convolutionUniforms['uImageIncrement'].value = BloomPass.blurX;
            renderer.setRenderTarget(this.renderTargetX);
            renderer.clear();
            this.fsQuad.render(renderer);
            this.convolutionUniforms['tDiffuse'].value = this.renderTargetX.texture;
            this.convolutionUniforms['uImageIncrement'].value = BloomPass.blurY;
            renderer.setRenderTarget(this.renderTargetY);
            renderer.clear();
            this.fsQuad.render(renderer);
            this.fsQuad.material = this.materialCopy;
            this.copyUniforms['tDiffuse'].value = this.renderTargetY.texture;
            if (maskActive)
                renderer.state.buffers.stencil.setTest(true);
            renderer.setRenderTarget(readBuffer);
            if (this.clear)
                renderer.clear();
            this.fsQuad.render(renderer);
        }
    });
    BloomPass.blurX = new THREE.Vector2(0.001953125, 0);
    BloomPass.blurY = new THREE.Vector2(0, 0.001953125);

    return threex.postprocessing.BloomPass = BloomPass;
});
define('skylark-threejs-ex/shaders/BokehShader',[
    "../threex"
],function (threex) {
    'use strict';
    var BokehShader = {
        defines: {
            'DEPTH_PACKING': 1,
            'PERSPECTIVE_CAMERA': 1
        },
        uniforms: {
            'tColor': { value: null },
            'tDepth': { value: null },
            'focus': { value: 1 },
            'aspect': { value: 1 },
            'aperture': { value: 0.025 },
            'maxblur': { value: 1 },
            'nearClip': { value: 1 },
            'farClip': { value: 1000 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#include <common>',
            'varying vec2 vUv;',
            'uniform sampler2D tColor;',
            'uniform sampler2D tDepth;',
            'uniform float maxblur;',
            'uniform float aperture;',
            'uniform float nearClip;',
            'uniform float farClip;',
            'uniform float focus;',
            'uniform float aspect;',
            '#include <packing>',
            'float getDepth( const in vec2 screenPosition ) {',
            '\t#if DEPTH_PACKING == 1',
            '\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );',
            '\t#else',
            '\treturn texture2D( tDepth, screenPosition ).x;',
            '\t#endif',
            '}',
            'float getViewZ( const in float depth ) {',
            '\t#if PERSPECTIVE_CAMERA == 1',
            '\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );',
            '\t#else',
            '\treturn orthographicDepthToViewZ( depth, nearClip, farClip );',
            '\t#endif',
            '}',
            'void main() {',
            '\tvec2 aspectcorrect = vec2( 1.0, aspect );',
            '\tfloat viewZ = getViewZ( getDepth( vUv ) );',
            '\tfloat factor = ( focus + viewZ );',
            '\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );',
            '\tvec2 dofblur9 = dofblur * 0.9;',
            '\tvec2 dofblur7 = dofblur * 0.7;',
            '\tvec2 dofblur4 = dofblur * 0.4;',
            '\tvec4 col = vec4( 0.0 );',
            '\tcol += texture2D( tColor, vUv.xy );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );',
            '\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );',
            '\tgl_FragColor = col / 41.0;',
            '\tgl_FragColor.a = 1.0;',
            '}'
        ].join('\n')
    };

    return threex.shaders.BokehShader = BokehShader;
});
define('skylark-threejs-ex/postprocessing/BokehPass',[
    "skylark-threejs",
     "../threex",
   '../postprocessing/Pass',
    '../shaders/BokehShader'
], function (
    THREE, 
    threex,
    Pass, 
    BokehShader
) {
    'use strict';
    var BokehPass = function (scene, camera, params) {
        Pass.call(this);
        this.scene = scene;
        this.camera = camera;
        var focus = params.focus !== undefined ? params.focus : 1;
        var aspect = params.aspect !== undefined ? params.aspect : camera.aspect;
        var aperture = params.aperture !== undefined ? params.aperture : 0.025;
        var maxblur = params.maxblur !== undefined ? params.maxblur : 1;
        var width = params.width || window.innerWidth || 1;
        var height = params.height || window.innerHeight || 1;
        this.renderTargetDepth = new THREE.WebGLRenderTarget(width, height, {
            minFilter: THREE.NearestFilter,
            magFilter: THREE.NearestFilter,
            stencilBuffer: false
        });
        this.renderTargetDepth.texture.name = 'BokehPass.depth';
        this.materialDepth = new THREE.MeshDepthMaterial();
        this.materialDepth.depthPacking = THREE.RGBADepthPacking;
        this.materialDepth.blending = THREE.NoBlending;
        if (BokehShader === undefined) {
            console.error('BokehPass relies on BokehShader');
        }
        var bokehShader = BokehShader;
        var bokehUniforms = THREE.UniformsUtils.clone(bokehShader.uniforms);
        bokehUniforms['tDepth'].value = this.renderTargetDepth.texture;
        bokehUniforms['focus'].value = focus;
        bokehUniforms['aspect'].value = aspect;
        bokehUniforms['aperture'].value = aperture;
        bokehUniforms['maxblur'].value = maxblur;
        bokehUniforms['nearClip'].value = camera.near;
        bokehUniforms['farClip'].value = camera.far;
        this.materialBokeh = new THREE.ShaderMaterial({
            defines: Object.assign({}, bokehShader.defines),
            uniforms: bokehUniforms,
            vertexShader: bokehShader.vertexShader,
            fragmentShader: bokehShader.fragmentShader
        });
        this.uniforms = bokehUniforms;
        this.needsSwap = false;
        this.fsQuad = new Pass.FullScreenQuad(this.materialBokeh);
        this.oldClearColor = new THREE.Color();
    };
    BokehPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: BokehPass,
        render: function (renderer, writeBuffer, readBuffer) {
            this.scene.overrideMaterial = this.materialDepth;
            this.oldClearColor.copy(renderer.getClearColor());
            var oldClearAlpha = renderer.getClearAlpha();
            var oldAutoClear = renderer.autoClear;
            renderer.autoClear = false;
            renderer.setClearColor(16777215);
            renderer.setClearAlpha(1);
            renderer.setRenderTarget(this.renderTargetDepth);
            renderer.clear();
            renderer.render(this.scene, this.camera);
            this.uniforms['tColor'].value = readBuffer.texture;
            this.uniforms['nearClip'].value = this.camera.near;
            this.uniforms['farClip'].value = this.camera.far;
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(writeBuffer);
                renderer.clear();
                this.fsQuad.render(renderer);
            }
            this.scene.overrideMaterial = null;
            renderer.setClearColor(this.oldClearColor);
            renderer.setClearAlpha(oldClearAlpha);
            renderer.autoClear = oldAutoClear;
        }
    });

    return threex.postprocessing.BokehPass = BokehPass;
});
define('skylark-threejs-ex/postprocessing/ClearMaskPass',[
    "../threex",
    '../postprocessing/Pass'
], function (
    threex,
    Pass
) {
    'use strict';
    var ClearMaskPass = function () {
        Pass.call(this);
        this.needsSwap = false;
    };
    ClearMaskPass.prototype = Object.create(Pass.prototype);
    Object.assign(ClearMaskPass.prototype, {
        render: function (renderer) {
            renderer.state.buffers.stencil.setLocked(false);
            renderer.state.buffers.stencil.setTest(false);
        }
    });

    return threex.postprocessing.ClearMaskPass = ClearMaskPass;
});
define('skylark-threejs-ex/postprocessing/ClearPass',[
    "../threex",
    '../postprocessing/Pass'
], function (
    threex,
    Pass
) {
    'use strict';
    var ClearPass = function (clearColor, clearAlpha) {
        Pass.call(this);
        this.needsSwap = false;
        this.clearColor = clearColor !== undefined ? clearColor : 0;
        this.clearAlpha = clearAlpha !== undefined ? clearAlpha : 0;
    };
    ClearPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: ClearPass,
        render: function (renderer, writeBuffer, readBuffer) {
            var oldClearColor, oldClearAlpha;
            if (this.clearColor) {
                oldClearColor = renderer.getClearColor().getHex();
                oldClearAlpha = renderer.getClearAlpha();
                renderer.setClearColor(this.clearColor, this.clearAlpha);
            }
            renderer.setRenderTarget(this.renderToScreen ? null : readBuffer);
            renderer.clear();
            if (this.clearColor) {
                renderer.setClearColor(oldClearColor, oldClearAlpha);
            }
        }
    });

    return threex.postprocessing.ClearPass = ClearPass;
});
define('skylark-threejs-ex/postprocessing/CubeTexturePass',[
    "skylark-threejs",
    "../threex",
    '../postprocessing/Pass'
], function (
    THREE, 
    threex,
    Pass
) {
    'use strict';
    var CubeTexturePass = function (camera, envMap, opacity) {
        Pass.call(this);
        this.camera = camera;
        this.needsSwap = false;
        this.cubeShader = THREE.ShaderLib['cube'];
        this.cubeMesh = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), new THREE.ShaderMaterial({
            uniforms: this.cubeShader.uniforms,
            vertexShader: this.cubeShader.vertexShader,
            fragmentShader: this.cubeShader.fragmentShader,
            depthTest: false,
            depthWrite: false,
            side: THREE.BackSide
        }));
        Object.defineProperty(this.cubeMesh.material, 'envMap', {
            get: function () {
                return this.uniforms.envMap.value;
            }
        });
        this.envMap = envMap;
        this.opacity = opacity !== undefined ? opacity : 1;
        this.cubeScene = new THREE.Scene();
        this.cubeCamera = new THREE.PerspectiveCamera();
        this.cubeScene.add(this.cubeMesh);
    };
    CubeTexturePass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: CubeTexturePass,
        render: function (renderer, writeBuffer, readBuffer) {
            var oldAutoClear = renderer.autoClear;
            renderer.autoClear = false;
            this.cubeCamera.projectionMatrix.copy(this.camera.projectionMatrix);
            this.cubeCamera.quaternion.setFromRotationMatrix(this.camera.matrixWorld);
            this.cubeMesh.material.uniforms.envMap.value = this.envMap;
            this.cubeMesh.material.uniforms.opacity.value = this.opacity;
            this.cubeMesh.material.transparent = this.opacity < 1;
            renderer.setRenderTarget(this.renderToScreen ? null : readBuffer);
            if (this.clear)
                renderer.clear();
            renderer.render(this.cubeScene, this.cubeCamera);
            renderer.autoClear = oldAutoClear;
        }
    });

    return threex.postprocessing.CubeTexturePass = CubeTexturePass;
});
define('skylark-threejs-ex/shaders/DotScreenShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var DotScreenShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'tSize': { value: new THREE.Vector2(256, 256) },
            'center': { value: new THREE.Vector2(0.5, 0.5) },
            'angle': { value: 1.57 },
            'scale': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec2 center;',
            'uniform float angle;',
            'uniform float scale;',
            'uniform vec2 tSize;',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'float pattern() {',
            '\tfloat s = sin( angle ), c = cos( angle );',
            '\tvec2 tex = vUv * tSize - center;',
            '\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;',
            '\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;',
            '}',
            'void main() {',
            '\tvec4 color = texture2D( tDiffuse, vUv );',
            '\tfloat average = ( color.r + color.g + color.b ) / 3.0;',
            '\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );',
            '}'
        ].join('\n')
    };
    return  threex.shaders.DotScreenShader = DotScreenShader;
});
define('skylark-threejs-ex/postprocessing/DotScreenPass',[
    "skylark-threejs",
    "../threex",
    '../postprocessing/Pass',
    '../shaders/DotScreenShader'
], function (
    THREE, 
    threex,
    Pass, 
    DotScreenShader
) {
    'use strict';
    var DotScreenPass = function (center, angle, scale) {
        Pass.call(this);
        if (DotScreenShader === undefined)
            console.error('DotScreenPass relies on DotScreenShader');
        var shader = DotScreenShader;
        this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);
        if (center !== undefined)
            this.uniforms['center'].value.copy(center);
        if (angle !== undefined)
            this.uniforms['angle'].value = angle;
        if (scale !== undefined)
            this.uniforms['scale'].value = scale;
        this.material = new THREE.ShaderMaterial({
            uniforms: this.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader
        });
        this.fsQuad = new Pass.FullScreenQuad(this.material);
    };
    DotScreenPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: DotScreenPass,
        render: function (renderer, writeBuffer, readBuffer) {
            this.uniforms['tDiffuse'].value = readBuffer.texture;
            this.uniforms['tSize'].value.set(readBuffer.width, readBuffer.height);
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(writeBuffer);
                if (this.clear)
                    renderer.clear();
                this.fsQuad.render(renderer);
            }
        }
    });

    return threex.postprocessing.DotScreenPass = DotScreenPass;
});
define('skylark-threejs-ex/postprocessing/ShaderPass',[
    "skylark-threejs",
    "../threex",
    './Pass'
], function (
    THREE, 
    threex,
    Pass
) {
    'use strict';
    var ShaderPass = function (shader, textureID) {
        Pass.call(this);
        this.textureID = textureID !== undefined ? textureID : 'tDiffuse';
        if (shader instanceof THREE.ShaderMaterial) {
            this.uniforms = shader.uniforms;
            this.material = shader;
        } else if (shader) {
            this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);
            this.material = new THREE.ShaderMaterial({
                defines: Object.assign({}, shader.defines),
                uniforms: this.uniforms,
                vertexShader: shader.vertexShader,
                fragmentShader: shader.fragmentShader
            });
        }
        this.fsQuad = new Pass.FullScreenQuad(this.material);
    };
    ShaderPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: ShaderPass,
        render: function (renderer, writeBuffer, readBuffer) {
            if (this.uniforms[this.textureID]) {
                this.uniforms[this.textureID].value = readBuffer.texture;
            }
            this.fsQuad.material = this.material;
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(writeBuffer);
                if (this.clear)
                    renderer.clear(renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil);
                this.fsQuad.render(renderer);
            }
        }
    });
    return threex.postprocessing.ShaderPass = ShaderPass;
});
define('skylark-threejs-ex/postprocessing/MaskPass',[
     "../threex",
    './Pass'
], function (
    threex,
    Pass
) {
    'use strict';
    var MaskPass = function (scene, camera) {
        Pass.call(this);
        this.scene = scene;
        this.camera = camera;
        this.clear = true;
        this.needsSwap = false;
        this.inverse = false;
    };
    MaskPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: MaskPass,
        render: function (renderer, writeBuffer, readBuffer) {
            var context = renderer.getContext();
            var state = renderer.state;
            state.buffers.color.setMask(false);
            state.buffers.depth.setMask(false);
            state.buffers.color.setLocked(true);
            state.buffers.depth.setLocked(true);
            var writeValue, clearValue;
            if (this.inverse) {
                writeValue = 0;
                clearValue = 1;
            } else {
                writeValue = 1;
                clearValue = 0;
            }
            state.buffers.stencil.setTest(true);
            state.buffers.stencil.setOp(context.REPLACE, context.REPLACE, context.REPLACE);
            state.buffers.stencil.setFunc(context.ALWAYS, writeValue, 4294967295);
            state.buffers.stencil.setClear(clearValue);
            state.buffers.stencil.setLocked(true);
            renderer.setRenderTarget(readBuffer);
            if (this.clear)
                renderer.clear();
            renderer.render(this.scene, this.camera);
            renderer.setRenderTarget(writeBuffer);
            if (this.clear)
                renderer.clear();
            renderer.render(this.scene, this.camera);
            state.buffers.color.setLocked(false);
            state.buffers.depth.setLocked(false);
            state.buffers.stencil.setLocked(false);
            state.buffers.stencil.setFunc(context.EQUAL, 1, 4294967295);
            state.buffers.stencil.setOp(context.KEEP, context.KEEP, context.KEEP);
            state.buffers.stencil.setLocked(true);
        }
    });
    return  threex.postprocessing.MaskPass = MaskPass;
});
define('skylark-threejs-ex/postprocessing/EffectComposer',[
    "skylark-threejs",
    "../threex",
    '../shaders/CopyShader',
    '../postprocessing/ShaderPass',
    '../postprocessing/MaskPass'
], function (
    THREE, 
    threex,
    CopyShader, 
    ShaderPass, 
    MaskPass
) {
    'use strict';
    var EffectComposer = function (renderer, renderTarget) {
        this.renderer = renderer;
        if (renderTarget === undefined) {
            var parameters = {
                minFilter: THREE.LinearFilter,
                magFilter: THREE.LinearFilter,
                format: THREE.RGBAFormat,
                stencilBuffer: false
            };
            var size = renderer.getSize(new THREE.Vector2());
            this._pixelRatio = renderer.getPixelRatio();
            this._width = size.width;
            this._height = size.height;
            renderTarget = new THREE.WebGLRenderTarget(this._width * this._pixelRatio, this._height * this._pixelRatio, parameters);
            renderTarget.texture.name = 'EffectComposer.rt1';
        } else {
            this._pixelRatio = 1;
            this._width = renderTarget.width;
            this._height = renderTarget.height;
        }
        this.renderTarget1 = renderTarget;
        this.renderTarget2 = renderTarget.clone();
        this.renderTarget2.texture.name = 'EffectComposer.rt2';
        this.writeBuffer = this.renderTarget1;
        this.readBuffer = this.renderTarget2;
        this.renderToScreen = true;
        this.passes = [];
        if (CopyShader === undefined) {
            console.error('THREE.EffectComposer relies on CopyShader');
        }
        if (ShaderPass === undefined) {
            console.error('THREE.EffectComposer relies on ShaderPass');
        }
        this.copyPass = new ShaderPass(CopyShader);
        this.clock = new THREE.Clock();
    };
    Object.assign(EffectComposer.prototype, {
        swapBuffers: function () {
            var tmp = this.readBuffer;
            this.readBuffer = this.writeBuffer;
            this.writeBuffer = tmp;
        },
        addPass: function (pass) {
            this.passes.push(pass);
            pass.setSize(this._width * this._pixelRatio, this._height * this._pixelRatio);
        },
        insertPass: function (pass, index) {
            this.passes.splice(index, 0, pass);
        },
        isLastEnabledPass: function (passIndex) {
            for (var i = passIndex + 1; i < this.passes.length; i++) {
                if (this.passes[i].enabled) {
                    return false;
                }
            }
            return true;
        },
        render: function (deltaTime) {
            if (deltaTime === undefined) {
                deltaTime = this.clock.getDelta();
            }
            var currentRenderTarget = this.renderer.getRenderTarget();
            var maskActive = false;
            var pass, i, il = this.passes.length;
            for (i = 0; i < il; i++) {
                pass = this.passes[i];
                if (pass.enabled === false)
                    continue;
                pass.renderToScreen = this.renderToScreen && this.isLastEnabledPass(i);
                pass.render(this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive);
                if (pass.needsSwap) {
                    if (maskActive) {
                        var context = this.renderer.getContext();
                        var stencil = this.renderer.state.buffers.stencil;
                        stencil.setFunc(context.NOTEQUAL, 1, 4294967295);
                        this.copyPass.render(this.renderer, this.writeBuffer, this.readBuffer, deltaTime);
                        stencil.setFunc(context.EQUAL, 1, 4294967295);
                    }
                    this.swapBuffers();
                }
                if (MaskPass !== undefined) {
                    if (pass instanceof MaskPass) {
                        maskActive = true;
                    } else if (pass instanceof ClearMaskPass) {
                        maskActive = false;
                    }
                }
            }
            this.renderer.setRenderTarget(currentRenderTarget);
        },
        reset: function (renderTarget) {
            if (renderTarget === undefined) {
                var size = this.renderer.getSize(new THREE.Vector2());
                this._pixelRatio = this.renderer.getPixelRatio();
                this._width = size.width;
                this._height = size.height;
                renderTarget = this.renderTarget1.clone();
                renderTarget.setSize(this._width * this._pixelRatio, this._height * this._pixelRatio);
            }
            this.renderTarget1.dispose();
            this.renderTarget2.dispose();
            this.renderTarget1 = renderTarget;
            this.renderTarget2 = renderTarget.clone();
            this.writeBuffer = this.renderTarget1;
            this.readBuffer = this.renderTarget2;
        },
        setSize: function (width, height) {
            this._width = width;
            this._height = height;
            var effectiveWidth = this._width * this._pixelRatio;
            var effectiveHeight = this._height * this._pixelRatio;
            this.renderTarget1.setSize(effectiveWidth, effectiveHeight);
            this.renderTarget2.setSize(effectiveWidth, effectiveHeight);
            for (var i = 0; i < this.passes.length; i++) {
                this.passes[i].setSize(effectiveWidth, effectiveHeight);
            }
        },
        setPixelRatio: function (pixelRatio) {
            this._pixelRatio = pixelRatio;
            this.setSize(this._width, this._height);
        }
    });

    return  threex.postprocessing.EffectComposer = EffectComposer;
});
define('skylark-threejs-ex/shaders/FilmShader',[
    "../threex"
],function (threex) {
    'use strict';
    var FilmShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'time': { value: 0 },
            'nIntensity': { value: 0.5 },
            'sIntensity': { value: 0.05 },
            'sCount': { value: 4096 },
            'grayscale': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#include <common>',
            'uniform float time;',
            'uniform bool grayscale;',
            'uniform float nIntensity;',
            'uniform float sIntensity;',
            'uniform float sCount;',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );',
            '\tfloat dx = rand( vUv + time );',
            '\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );',
            '\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );',
            '\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;',
            '\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );',
            '\tif( grayscale ) {',
            '\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );',
            '\t}',
            '\tgl_FragColor =  vec4( cResult, cTextureScreen.a );',
            '}'
        ].join('\n')
    };
    return  threex.shaders.FilmShader = FilmShader;
});
define('skylark-threejs-ex/postprocessing/FilmPass',[
    "skylark-threejs",
    "../threex",
    '../postprocessing/Pass',
    '../shaders/FilmShader'
], function (
    THREE, 
    threex,
    Pass, 
    FilmShader
) {
    'use strict';
    var FilmPass = function (noiseIntensity, scanlinesIntensity, scanlinesCount, grayscale) {
        Pass.call(this);
        if (FilmShader === undefined)
            console.error('FilmPass relies on FilmShader');
        var shader = FilmShader;
        this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);
        this.material = new THREE.ShaderMaterial({
            uniforms: this.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader
        });
        if (grayscale !== undefined)
            this.uniforms.grayscale.value = grayscale;
        if (noiseIntensity !== undefined)
            this.uniforms.nIntensity.value = noiseIntensity;
        if (scanlinesIntensity !== undefined)
            this.uniforms.sIntensity.value = scanlinesIntensity;
        if (scanlinesCount !== undefined)
            this.uniforms.sCount.value = scanlinesCount;
        this.fsQuad = new Pass.FullScreenQuad(this.material);
    };
    FilmPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: FilmPass,
        render: function (renderer, writeBuffer, readBuffer, deltaTime) {
            this.uniforms['tDiffuse'].value = readBuffer.texture;
            this.uniforms['time'].value += deltaTime;
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(writeBuffer);
                if (this.clear)
                    renderer.clear();
                this.fsQuad.render(renderer);
            }
        }
    });

    return threex.postprocessing.FilmPass = FilmPass;
});
define('skylark-threejs-ex/shaders/DigitalGlitch',[
    "../threex"
],function (threex) {
    'use strict';
    var DigitalGlitch = {
        uniforms: {
            'tDiffuse': { value: null },
            'tDisp': { value: null },
            'byp': { value: 0 },
            'amount': { value: 0.08 },
            'angle': { value: 0.02 },
            'seed': { value: 0.02 },
            'seed_x': { value: 0.02 },
            'seed_y': { value: 0.02 },
            'distortion_x': { value: 0.5 },
            'distortion_y': { value: 0.6 },
            'col_s': { value: 0.05 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform int byp;',
            'uniform sampler2D tDiffuse;',
            'uniform sampler2D tDisp;',
            'uniform float amount;',
            'uniform float angle;',
            'uniform float seed;',
            'uniform float seed_x;',
            'uniform float seed_y;',
            'uniform float distortion_x;',
            'uniform float distortion_y;',
            'uniform float col_s;',
            'varying vec2 vUv;',
            'float rand(vec2 co){',
            '\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);',
            '}',
            'void main() {',
            '\tif(byp<1) {',
            '\t\tvec2 p = vUv;',
            '\t\tfloat xs = floor(gl_FragCoord.x / 0.5);',
            '\t\tfloat ys = floor(gl_FragCoord.y / 0.5);',
            '\t\tvec4 normal = texture2D (tDisp, p*seed*seed);',
            '\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {',
            '\t\t\tif(seed_x>0.){',
            '\t\t\t\tp.y = 1. - (p.y + distortion_y);',
            '\t\t\t}',
            '\t\t\telse {',
            '\t\t\t\tp.y = distortion_y;',
            '\t\t\t}',
            '\t\t}',
            '\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {',
            '\t\t\tif(seed_y>0.){',
            '\t\t\t\tp.x=distortion_x;',
            '\t\t\t}',
            '\t\t\telse {',
            '\t\t\t\tp.x = 1. - (p.x + distortion_x);',
            '\t\t\t}',
            '\t\t}',
            '\t\tp.x+=normal.x*seed_x*(seed/5.);',
            '\t\tp.y+=normal.y*seed_y*(seed/5.);',
            '\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));',
            '\t\tvec4 cr = texture2D(tDiffuse, p + offset);',
            '\t\tvec4 cga = texture2D(tDiffuse, p);',
            '\t\tvec4 cb = texture2D(tDiffuse, p - offset);',
            '\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);',
            '\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);',
            '\t\tgl_FragColor = gl_FragColor+ snow;',
            '\t}',
            '\telse {',
            '\t\tgl_FragColor=texture2D (tDiffuse, vUv);',
            '\t}',
            '}'
        ].join('\n')
    };
    return  threex.shaders.DigitalGlitch = DigitalGlitch ;
});
define('skylark-threejs-ex/postprocessing/GlitchPass',[
    "skylark-threejs",
    "../threex",
    './Pass',
    '../shaders/DigitalGlitch'
], function (
    THREE, 
    threex,
    Pass, 
    DigitalGlitch
) {
    'use strict';
    var GlitchPass = function (dt_size) {
        Pass.call(this);
        if (DigitalGlitch === undefined)
            console.error('GlitchPass relies on DigitalGlitch');
        var shader = DigitalGlitch;
        this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);
        if (dt_size == undefined)
            dt_size = 64;
        this.uniforms['tDisp'].value = this.generateHeightmap(dt_size);
        this.material = new THREE.ShaderMaterial({
            uniforms: this.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader
        });
        this.fsQuad = new Pass.FullScreenQuad(this.material);
        this.goWild = false;
        this.curF = 0;
        this.generateTrigger();
    };
    GlitchPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: GlitchPass,
        render: function (renderer, writeBuffer, readBuffer) {
            this.uniforms['tDiffuse'].value = readBuffer.texture;
            this.uniforms['seed'].value = Math.random();
            this.uniforms['byp'].value = 0;
            if (this.curF % this.randX == 0 || this.goWild == true) {
                this.uniforms['amount'].value = Math.random() / 30;
                this.uniforms['angle'].value = THREE.MathUtils.randFloat(-Math.PI, Math.PI);
                this.uniforms['seed_x'].value = THREE.MathUtils.randFloat(-1, 1);
                this.uniforms['seed_y'].value = THREE.MathUtils.randFloat(-1, 1);
                this.uniforms['distortion_x'].value = THREE.MathUtils.randFloat(0, 1);
                this.uniforms['distortion_y'].value = THREE.MathUtils.randFloat(0, 1);
                this.curF = 0;
                this.generateTrigger();
            } else if (this.curF % this.randX < this.randX / 5) {
                this.uniforms['amount'].value = Math.random() / 90;
                this.uniforms['angle'].value = THREE.MathUtils.randFloat(-Math.PI, Math.PI);
                this.uniforms['distortion_x'].value = THREE.MathUtils.randFloat(0, 1);
                this.uniforms['distortion_y'].value = THREE.MathUtils.randFloat(0, 1);
                this.uniforms['seed_x'].value = THREE.MathUtils.randFloat(-0.3, 0.3);
                this.uniforms['seed_y'].value = THREE.MathUtils.randFloat(-0.3, 0.3);
            } else if (this.goWild == false) {
                this.uniforms['byp'].value = 1;
            }
            this.curF++;
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(writeBuffer);
                if (this.clear)
                    renderer.clear();
                this.fsQuad.render(renderer);
            }
        },
        generateTrigger: function () {
            this.randX = THREE.MathUtils.randInt(120, 240);
        },
        generateHeightmap: function (dt_size) {
            var data_arr = new Float32Array(dt_size * dt_size * 3);
            var length = dt_size * dt_size;
            for (var i = 0; i < length; i++) {
                var val = THREE.MathUtils.randFloat(0, 1);
                data_arr[i * 3 + 0] = val;
                data_arr[i * 3 + 1] = val;
                data_arr[i * 3 + 2] = val;
            }
            return new THREE.DataTexture(data_arr, dt_size, dt_size, THREE.RGBFormat, THREE.FloatType);
        }
    });
    return threex.postprocessing.GlitchPass = GlitchPass;
});
define('skylark-threejs-ex/shaders/HalftoneShader',[
    "../threex"
],function (threex) {
    'use strict';
    var HalftoneShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'shape': { value: 1 },
            'radius': { value: 4 },
            'rotateR': { value: Math.PI / 12 * 1 },
            'rotateG': { value: Math.PI / 12 * 2 },
            'rotateB': { value: Math.PI / 12 * 3 },
            'scatter': { value: 0 },
            'width': { value: 1 },
            'height': { value: 1 },
            'blending': { value: 1 },
            'blendingMode': { value: 1 },
            'greyscale': { value: false },
            'disable': { value: false }
        },
        vertexShader: [
            'varying vec2 vUV;',
            'void main() {',
            '\tvUV = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#define SQRT2_MINUS_ONE 0.41421356',
            '#define SQRT2_HALF_MINUS_ONE 0.20710678',
            '#define PI2 6.28318531',
            '#define SHAPE_DOT 1',
            '#define SHAPE_ELLIPSE 2',
            '#define SHAPE_LINE 3',
            '#define SHAPE_SQUARE 4',
            '#define BLENDING_LINEAR 1',
            '#define BLENDING_MULTIPLY 2',
            '#define BLENDING_ADD 3',
            '#define BLENDING_LIGHTER 4',
            '#define BLENDING_DARKER 5',
            'uniform sampler2D tDiffuse;',
            'uniform float radius;',
            'uniform float rotateR;',
            'uniform float rotateG;',
            'uniform float rotateB;',
            'uniform float scatter;',
            'uniform float width;',
            'uniform float height;',
            'uniform int shape;',
            'uniform bool disable;',
            'uniform float blending;',
            'uniform int blendingMode;',
            'varying vec2 vUV;',
            'uniform bool greyscale;',
            'const int samples = 8;',
            'float blend( float a, float b, float t ) {',
            '\treturn a * ( 1.0 - t ) + b * t;',
            '}',
            'float hypot( float x, float y ) {',
            '\treturn sqrt( x * x + y * y );',
            '}',
            'float rand( vec2 seed ){',
            'return fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );',
            '}',
            'float distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {',
            '\tfloat dist = hypot( coord.x - p.x, coord.y - p.y );',
            '\tfloat rad = channel;',
            '\tif ( shape == SHAPE_DOT ) {',
            '\t\trad = pow( abs( rad ), 1.125 ) * rad_max;',
            '\t} else if ( shape == SHAPE_ELLIPSE ) {',
            '\t\trad = pow( abs( rad ), 1.125 ) * rad_max;',
            '\t\tif ( dist != 0.0 ) {',
            '\t\t\tfloat dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );',
            '\t\t\tdist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;',
            '\t\t}',
            '\t} else if ( shape == SHAPE_LINE ) {',
            '\t\trad = pow( abs( rad ), 1.5) * rad_max;',
            '\t\tfloat dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;',
            '\t\tdist = hypot( normal.x * dot_p, normal.y * dot_p );',
            '\t} else if ( shape == SHAPE_SQUARE ) {',
            '\t\tfloat theta = atan( p.y - coord.y, p.x - coord.x ) - angle;',
            '\t\tfloat sin_t = abs( sin( theta ) );',
            '\t\tfloat cos_t = abs( cos( theta ) );',
            '\t\trad = pow( abs( rad ), 1.4 );',
            '\t\trad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );',
            '\t}',
            '\treturn rad - dist;',
            '}',
            'struct Cell {',
            '\tvec2 normal;',
            '\tvec2 p1;',
            '\tvec2 p2;',
            '\tvec2 p3;',
            '\tvec2 p4;',
            '\tfloat samp2;',
            '\tfloat samp1;',
            '\tfloat samp3;',
            '\tfloat samp4;',
            '};',
            'vec4 getSample( vec2 point ) {',
            '\tvec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );',
            '\tfloat base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;',
            '\tfloat step = PI2 / float( samples );',
            '\tfloat dist = radius * 0.66;',
            '\tfor ( int i = 0; i < samples; ++i ) {',
            '\t\tfloat r = base + step * float( i );',
            '\t\tvec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );',
            '\t\ttex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );',
            '\t}',
            '\ttex /= float( samples ) + 1.0;',
            '\treturn tex;',
            '}',
            'float getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {',
            '\tfloat dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;',
            '\tif ( channel == 0 ) {',
            '\t\tc.samp1 = getSample( c.p1 ).r;',
            '\t\tc.samp2 = getSample( c.p2 ).r;',
            '\t\tc.samp3 = getSample( c.p3 ).r;',
            '\t\tc.samp4 = getSample( c.p4 ).r;',
            '\t} else if (channel == 1) {',
            '\t\tc.samp1 = getSample( c.p1 ).g;',
            '\t\tc.samp2 = getSample( c.p2 ).g;',
            '\t\tc.samp3 = getSample( c.p3 ).g;',
            '\t\tc.samp4 = getSample( c.p4 ).g;',
            '\t} else {',
            '\t\tc.samp1 = getSample( c.p1 ).b;',
            '\t\tc.samp3 = getSample( c.p3 ).b;',
            '\t\tc.samp2 = getSample( c.p2 ).b;',
            '\t\tc.samp4 = getSample( c.p4 ).b;',
            '\t}',
            '\tdist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );',
            '\tdist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );',
            '\tdist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );',
            '\tdist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );',
            '\tres = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;',
            '\tres += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;',
            '\tres += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;',
            '\tres += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;',
            '\tres = clamp( res, 0.0, 1.0 );',
            '\treturn res;',
            '}',
            'Cell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {',
            '\tCell c;',
            '\tvec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );',
            '\tfloat threshold = step * 0.5;',
            '\tfloat dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );',
            '\tfloat dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );',
            '\tvec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );',
            '\tfloat offset_normal = mod( hypot( offset.x, offset.y ), step );',
            '\tfloat normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;',
            '\tfloat normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;',
            '\tfloat offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );',
            '\tfloat line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;',
            '\tfloat line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;',
            '\tc.normal = n;',
            '\tc.p1.x = p.x - n.x * normal_scale + n.y * line_scale;',
            '\tc.p1.y = p.y - n.y * normal_scale - n.x * line_scale;',
            '\tif ( scatter != 0.0 ) {',
            '\t\tfloat off_mag = scatter * threshold * 0.5;',
            '\t\tfloat off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;',
            '\t\tc.p1.x += cos( off_angle ) * off_mag;',
            '\t\tc.p1.y += sin( off_angle ) * off_mag;',
            '\t}',
            '\tfloat normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );',
            '\tfloat line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );',
            '\tc.p2.x = c.p1.x - n.x * normal_step;',
            '\tc.p2.y = c.p1.y - n.y * normal_step;',
            '\tc.p3.x = c.p1.x + n.y * line_step;',
            '\tc.p3.y = c.p1.y - n.x * line_step;',
            '\tc.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;',
            '\tc.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;',
            '\treturn c;',
            '}',
            'float blendColour( float a, float b, float t ) {',
            '\tif ( blendingMode == BLENDING_LINEAR ) {',
            '\t\treturn blend( a, b, 1.0 - t );',
            '\t} else if ( blendingMode == BLENDING_ADD ) {',
            '\t\treturn blend( a, min( 1.0, a + b ), t );',
            '\t} else if ( blendingMode == BLENDING_MULTIPLY ) {',
            '\t\treturn blend( a, max( 0.0, a * b ), t );',
            '\t} else if ( blendingMode == BLENDING_LIGHTER ) {',
            '\t\treturn blend( a, max( a, b ), t );',
            '\t} else if ( blendingMode == BLENDING_DARKER ) {',
            '\t\treturn blend( a, min( a, b ), t );',
            '\t} else {',
            '\t\treturn blend( a, b, 1.0 - t );',
            '\t}',
            '}',
            'void main() {',
            '\tif ( ! disable ) {',
            '\t\tvec2 p = vec2( vUV.x * width, vUV.y * height );',
            '\t\tvec2 origin = vec2( 0, 0 );',
            '\t\tfloat aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;',
            '\t\tCell cell_r = getReferenceCell( p, origin, rotateR, radius );',
            '\t\tCell cell_g = getReferenceCell( p, origin, rotateG, radius );',
            '\t\tCell cell_b = getReferenceCell( p, origin, rotateB, radius );',
            '\t\tfloat r = getDotColour( cell_r, p, 0, rotateR, aa );',
            '\t\tfloat g = getDotColour( cell_g, p, 1, rotateG, aa );',
            '\t\tfloat b = getDotColour( cell_b, p, 2, rotateB, aa );',
            '\t\tvec4 colour = texture2D( tDiffuse, vUV );',
            '\t\tr = blendColour( r, colour.r, blending );',
            '\t\tg = blendColour( g, colour.g, blending );',
            '\t\tb = blendColour( b, colour.b, blending );',
            '\t\tif ( greyscale ) {',
            '\t\t\tr = g = b = (r + b + g) / 3.0;',
            '\t\t}',
            '\t\tgl_FragColor = vec4( r, g, b, 1.0 );',
            '\t} else {',
            '\t\tgl_FragColor = texture2D( tDiffuse, vUV );',
            '\t}',
            '}'
        ].join('\n')
    };
    return threex.shaders.HalftoneShader = HalftoneShader;
});
define('skylark-threejs-ex/postprocessing/HalftonePass',[
    "skylark-threejs",
    "../threex",
    './Pass',
    '../shaders/HalftoneShader'
], function (
    THREE, 
    threex,
    Pass, 
    HalftoneShader
) {
    'use strict';
    var HalftonePass = function (width, height, params) {
        Pass.call(this);
        if (HalftoneShader === undefined) {
            console.error('THREE.HalftonePass requires HalftoneShader');
        }
        this.uniforms = THREE.UniformsUtils.clone(HalftoneShader.uniforms);
        this.material = new THREE.ShaderMaterial({
            uniforms: this.uniforms,
            fragmentShader: HalftoneShader.fragmentShader,
            vertexShader: HalftoneShader.vertexShader
        });
        this.uniforms.width.value = width;
        this.uniforms.height.value = height;
        for (var key in params) {
            if (params.hasOwnProperty(key) && this.uniforms.hasOwnProperty(key)) {
                this.uniforms[key].value = params[key];
            }
        }
        this.fsQuad = new Pass.FullScreenQuad(this.material);
    };
    HalftonePass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: HalftonePass,
        render: function (renderer, writeBuffer, readBuffer) {
            this.material.uniforms['tDiffuse'].value = readBuffer.texture;
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(writeBuffer);
                if (this.clear)
                    renderer.clear();
                this.fsQuad.render(renderer);
            }
        },
        setSize: function (width, height) {
            this.uniforms.width.value = width;
            this.uniforms.height.value = height;
        }
    });
    return threex.postprocessing.HalftonePass = HalftonePass;
});
define('skylark-threejs-ex/postprocessing/OutlinePass',[
    "skylark-threejs",
    "../threex",
    './Pass',
    '../shaders/CopyShader'
], function (
    THREE,
    threex, 
    Pass, 
    CopyShader
) {
    'use strict';
    var OutlinePass = function (resolution, scene, camera, selectedObjects) {
        this.renderScene = scene;
        this.renderCamera = camera;
        this.selectedObjects = selectedObjects !== undefined ? selectedObjects : [];
        this.visibleEdgeColor = new THREE.Color(1, 1, 1);
        this.hiddenEdgeColor = new THREE.Color(0.1, 0.04, 0.02);
        this.edgeGlow = 0;
        this.usePatternTexture = false;
        this.edgeThickness = 1;
        this.edgeStrength = 3;
        this.downSampleRatio = 2;
        this.pulsePeriod = 0;
        Pass.call(this);
        this.resolution = resolution !== undefined ? new THREE.Vector2(resolution.x, resolution.y) : new THREE.Vector2(256, 256);
        var pars = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBAFormat
        };
        var resx = Math.round(this.resolution.x / this.downSampleRatio);
        var resy = Math.round(this.resolution.y / this.downSampleRatio);
        this.maskBufferMaterial = new THREE.MeshBasicMaterial({ color: 16777215 });
        this.maskBufferMaterial.side = THREE.DoubleSide;
        this.renderTargetMaskBuffer = new THREE.WebGLRenderTarget(this.resolution.x, this.resolution.y, pars);
        this.renderTargetMaskBuffer.texture.name = 'OutlinePass.mask';
        this.renderTargetMaskBuffer.texture.generateMipmaps = false;
        this.depthMaterial = new THREE.MeshDepthMaterial();
        this.depthMaterial.side = THREE.DoubleSide;
        this.depthMaterial.depthPacking = THREE.RGBADepthPacking;
        this.depthMaterial.blending = THREE.NoBlending;
        this.prepareMaskMaterial = this.getPrepareMaskMaterial();
        this.prepareMaskMaterial.side = THREE.DoubleSide;
        this.prepareMaskMaterial.fragmentShader = replaceDepthToViewZ(this.prepareMaskMaterial.fragmentShader, this.renderCamera);
        this.renderTargetDepthBuffer = new THREE.WebGLRenderTarget(this.resolution.x, this.resolution.y, pars);
        this.renderTargetDepthBuffer.texture.name = 'OutlinePass.depth';
        this.renderTargetDepthBuffer.texture.generateMipmaps = false;
        this.renderTargetMaskDownSampleBuffer = new THREE.WebGLRenderTarget(resx, resy, pars);
        this.renderTargetMaskDownSampleBuffer.texture.name = 'OutlinePass.depthDownSample';
        this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps = false;
        this.renderTargetBlurBuffer1 = new THREE.WebGLRenderTarget(resx, resy, pars);
        this.renderTargetBlurBuffer1.texture.name = 'OutlinePass.blur1';
        this.renderTargetBlurBuffer1.texture.generateMipmaps = false;
        this.renderTargetBlurBuffer2 = new THREE.WebGLRenderTarget(Math.round(resx / 2), Math.round(resy / 2), pars);
        this.renderTargetBlurBuffer2.texture.name = 'OutlinePass.blur2';
        this.renderTargetBlurBuffer2.texture.generateMipmaps = false;
        this.edgeDetectionMaterial = this.getEdgeDetectionMaterial();
        this.renderTargetEdgeBuffer1 = new THREE.WebGLRenderTarget(resx, resy, pars);
        this.renderTargetEdgeBuffer1.texture.name = 'OutlinePass.edge1';
        this.renderTargetEdgeBuffer1.texture.generateMipmaps = false;
        this.renderTargetEdgeBuffer2 = new THREE.WebGLRenderTarget(Math.round(resx / 2), Math.round(resy / 2), pars);
        this.renderTargetEdgeBuffer2.texture.name = 'OutlinePass.edge2';
        this.renderTargetEdgeBuffer2.texture.generateMipmaps = false;
        var MAX_EDGE_THICKNESS = 4;
        var MAX_EDGE_GLOW = 4;
        this.separableBlurMaterial1 = this.getSeperableBlurMaterial(MAX_EDGE_THICKNESS);
        this.separableBlurMaterial1.uniforms['texSize'].value.set(resx, resy);
        this.separableBlurMaterial1.uniforms['kernelRadius'].value = 1;
        this.separableBlurMaterial2 = this.getSeperableBlurMaterial(MAX_EDGE_GLOW);
        this.separableBlurMaterial2.uniforms['texSize'].value.set(Math.round(resx / 2), Math.round(resy / 2));
        this.separableBlurMaterial2.uniforms['kernelRadius'].value = MAX_EDGE_GLOW;
        this.overlayMaterial = this.getOverlayMaterial();
        if (CopyShader === undefined)
            console.error('OutlinePass relies on CopyShader');
        var copyShader = CopyShader;
        this.copyUniforms = THREE.UniformsUtils.clone(copyShader.uniforms);
        this.copyUniforms['opacity'].value = 1;
        this.materialCopy = new THREE.ShaderMaterial({
            uniforms: this.copyUniforms,
            vertexShader: copyShader.vertexShader,
            fragmentShader: copyShader.fragmentShader,
            blending: THREE.NoBlending,
            depthTest: false,
            depthWrite: false,
            transparent: true
        });
        this.enabled = true;
        this.needsSwap = false;
        this.oldClearColor = new THREE.Color();
        this.oldClearAlpha = 1;
        this.fsQuad = new Pass.FullScreenQuad(null);
        this.tempPulseColor1 = new THREE.Color();
        this.tempPulseColor2 = new THREE.Color();
        this.textureMatrix = new THREE.Matrix4();
        function replaceDepthToViewZ(string, camera) {
            var type = camera.isPerspectiveCamera ? 'perspective' : 'orthographic';
            return string.replace(/DEPTH_TO_VIEW_Z/g, type + 'DepthToViewZ');
        }
    };
    OutlinePass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: OutlinePass,
        dispose: function () {
            this.renderTargetMaskBuffer.dispose();
            this.renderTargetDepthBuffer.dispose();
            this.renderTargetMaskDownSampleBuffer.dispose();
            this.renderTargetBlurBuffer1.dispose();
            this.renderTargetBlurBuffer2.dispose();
            this.renderTargetEdgeBuffer1.dispose();
            this.renderTargetEdgeBuffer2.dispose();
        },
        setSize: function (width, height) {
            this.renderTargetMaskBuffer.setSize(width, height);
            var resx = Math.round(width / this.downSampleRatio);
            var resy = Math.round(height / this.downSampleRatio);
            this.renderTargetMaskDownSampleBuffer.setSize(resx, resy);
            this.renderTargetBlurBuffer1.setSize(resx, resy);
            this.renderTargetEdgeBuffer1.setSize(resx, resy);
            this.separableBlurMaterial1.uniforms['texSize'].value.set(resx, resy);
            resx = Math.round(resx / 2);
            resy = Math.round(resy / 2);
            this.renderTargetBlurBuffer2.setSize(resx, resy);
            this.renderTargetEdgeBuffer2.setSize(resx, resy);
            this.separableBlurMaterial2.uniforms['texSize'].value.set(resx, resy);
        },
        changeVisibilityOfSelectedObjects: function (bVisible) {
            function gatherSelectedMeshesCallBack(object) {
                if (object.isMesh) {
                    if (bVisible) {
                        object.visible = object.userData.oldVisible;
                        delete object.userData.oldVisible;
                    } else {
                        object.userData.oldVisible = object.visible;
                        object.visible = bVisible;
                    }
                }
            }
            for (var i = 0; i < this.selectedObjects.length; i++) {
                var selectedObject = this.selectedObjects[i];
                selectedObject.traverse(gatherSelectedMeshesCallBack);
            }
        },
        changeVisibilityOfNonSelectedObjects: function (bVisible) {
            var selectedMeshes = [];
            function gatherSelectedMeshesCallBack(object) {
                if (object.isMesh)
                    selectedMeshes.push(object);
            }
            for (var i = 0; i < this.selectedObjects.length; i++) {
                var selectedObject = this.selectedObjects[i];
                selectedObject.traverse(gatherSelectedMeshesCallBack);
            }
            function VisibilityChangeCallBack(object) {
                if (object.isMesh || object.isLine || object.isSprite) {
                    var bFound = false;
                    for (var i = 0; i < selectedMeshes.length; i++) {
                        var selectedObjectId = selectedMeshes[i].id;
                        if (selectedObjectId === object.id) {
                            bFound = true;
                            break;
                        }
                    }
                    if (!bFound) {
                        var visibility = object.visible;
                        if (!bVisible || object.bVisible)
                            object.visible = bVisible;
                        object.bVisible = visibility;
                    }
                }
            }
            this.renderScene.traverse(VisibilityChangeCallBack);
        },
        updateTextureMatrix: function () {
            this.textureMatrix.set(0.5, 0, 0, 0.5, 0, 0.5, 0, 0.5, 0, 0, 0.5, 0.5, 0, 0, 0, 1);
            this.textureMatrix.multiply(this.renderCamera.projectionMatrix);
            this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse);
        },
        render: function (renderer, writeBuffer, readBuffer, deltaTime, maskActive) {
            if (this.selectedObjects.length > 0) {
                this.oldClearColor.copy(renderer.getClearColor());
                this.oldClearAlpha = renderer.getClearAlpha();
                var oldAutoClear = renderer.autoClear;
                renderer.autoClear = false;
                if (maskActive)
                    renderer.state.buffers.stencil.setTest(false);
                renderer.setClearColor(16777215, 1);
                this.changeVisibilityOfSelectedObjects(false);
                var currentBackground = this.renderScene.background;
                this.renderScene.background = null;
                this.renderScene.overrideMaterial = this.depthMaterial;
                renderer.setRenderTarget(this.renderTargetDepthBuffer);
                renderer.clear();
                renderer.render(this.renderScene, this.renderCamera);
                this.changeVisibilityOfSelectedObjects(true);
                this.updateTextureMatrix();
                this.changeVisibilityOfNonSelectedObjects(false);
                this.renderScene.overrideMaterial = this.prepareMaskMaterial;
                this.prepareMaskMaterial.uniforms['cameraNearFar'].value.set(this.renderCamera.near, this.renderCamera.far);
                this.prepareMaskMaterial.uniforms['depthTexture'].value = this.renderTargetDepthBuffer.texture;
                this.prepareMaskMaterial.uniforms['textureMatrix'].value = this.textureMatrix;
                renderer.setRenderTarget(this.renderTargetMaskBuffer);
                renderer.clear();
                renderer.render(this.renderScene, this.renderCamera);
                this.renderScene.overrideMaterial = null;
                this.changeVisibilityOfNonSelectedObjects(true);
                this.renderScene.background = currentBackground;
                this.fsQuad.material = this.materialCopy;
                this.copyUniforms['tDiffuse'].value = this.renderTargetMaskBuffer.texture;
                renderer.setRenderTarget(this.renderTargetMaskDownSampleBuffer);
                renderer.clear();
                this.fsQuad.render(renderer);
                this.tempPulseColor1.copy(this.visibleEdgeColor);
                this.tempPulseColor2.copy(this.hiddenEdgeColor);
                if (this.pulsePeriod > 0) {
                    var scalar = (1 + 0.25) / 2 + Math.cos(performance.now() * 0.01 / this.pulsePeriod) * (1 - 0.25) / 2;
                    this.tempPulseColor1.multiplyScalar(scalar);
                    this.tempPulseColor2.multiplyScalar(scalar);
                }
                this.fsQuad.material = this.edgeDetectionMaterial;
                this.edgeDetectionMaterial.uniforms['maskTexture'].value = this.renderTargetMaskDownSampleBuffer.texture;
                this.edgeDetectionMaterial.uniforms['texSize'].value.set(this.renderTargetMaskDownSampleBuffer.width, this.renderTargetMaskDownSampleBuffer.height);
                this.edgeDetectionMaterial.uniforms['visibleEdgeColor'].value = this.tempPulseColor1;
                this.edgeDetectionMaterial.uniforms['hiddenEdgeColor'].value = this.tempPulseColor2;
                renderer.setRenderTarget(this.renderTargetEdgeBuffer1);
                renderer.clear();
                this.fsQuad.render(renderer);
                this.fsQuad.material = this.separableBlurMaterial1;
                this.separableBlurMaterial1.uniforms['colorTexture'].value = this.renderTargetEdgeBuffer1.texture;
                this.separableBlurMaterial1.uniforms['direction'].value = OutlinePass.BlurDirectionX;
                this.separableBlurMaterial1.uniforms['kernelRadius'].value = this.edgeThickness;
                renderer.setRenderTarget(this.renderTargetBlurBuffer1);
                renderer.clear();
                this.fsQuad.render(renderer);
                this.separableBlurMaterial1.uniforms['colorTexture'].value = this.renderTargetBlurBuffer1.texture;
                this.separableBlurMaterial1.uniforms['direction'].value = OutlinePass.BlurDirectionY;
                renderer.setRenderTarget(this.renderTargetEdgeBuffer1);
                renderer.clear();
                this.fsQuad.render(renderer);
                this.fsQuad.material = this.separableBlurMaterial2;
                this.separableBlurMaterial2.uniforms['colorTexture'].value = this.renderTargetEdgeBuffer1.texture;
                this.separableBlurMaterial2.uniforms['direction'].value = OutlinePass.BlurDirectionX;
                renderer.setRenderTarget(this.renderTargetBlurBuffer2);
                renderer.clear();
                this.fsQuad.render(renderer);
                this.separableBlurMaterial2.uniforms['colorTexture'].value = this.renderTargetBlurBuffer2.texture;
                this.separableBlurMaterial2.uniforms['direction'].value = OutlinePass.BlurDirectionY;
                renderer.setRenderTarget(this.renderTargetEdgeBuffer2);
                renderer.clear();
                this.fsQuad.render(renderer);
                this.fsQuad.material = this.overlayMaterial;
                this.overlayMaterial.uniforms['maskTexture'].value = this.renderTargetMaskBuffer.texture;
                this.overlayMaterial.uniforms['edgeTexture1'].value = this.renderTargetEdgeBuffer1.texture;
                this.overlayMaterial.uniforms['edgeTexture2'].value = this.renderTargetEdgeBuffer2.texture;
                this.overlayMaterial.uniforms['patternTexture'].value = this.patternTexture;
                this.overlayMaterial.uniforms['edgeStrength'].value = this.edgeStrength;
                this.overlayMaterial.uniforms['edgeGlow'].value = this.edgeGlow;
                this.overlayMaterial.uniforms['usePatternTexture'].value = this.usePatternTexture;
                if (maskActive)
                    renderer.state.buffers.stencil.setTest(true);
                renderer.setRenderTarget(readBuffer);
                this.fsQuad.render(renderer);
                renderer.setClearColor(this.oldClearColor, this.oldClearAlpha);
                renderer.autoClear = oldAutoClear;
            }
            if (this.renderToScreen) {
                this.fsQuad.material = this.materialCopy;
                this.copyUniforms['tDiffuse'].value = readBuffer.texture;
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            }
        },
        getPrepareMaskMaterial: function () {
            return new THREE.ShaderMaterial({
                uniforms: {
                    'depthTexture': { value: null },
                    'cameraNearFar': { value: new THREE.Vector2(0.5, 0.5) },
                    'textureMatrix': { value: null }
                },
                vertexShader: [
                    '#include <morphtarget_pars_vertex>',
                    '#include <skinning_pars_vertex>',
                    'varying vec4 projTexCoord;',
                    'varying vec4 vPosition;',
                    'uniform mat4 textureMatrix;',
                    'void main() {',
                    '\t#include <skinbase_vertex>',
                    '\t#include <begin_vertex>',
                    '\t#include <morphtarget_vertex>',
                    '\t#include <skinning_vertex>',
                    '\t#include <project_vertex>',
                    '\tvPosition = mvPosition;',
                    '\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );',
                    '\tprojTexCoord = textureMatrix * worldPosition;',
                    '}'
                ].join('\n'),
                fragmentShader: [
                    '#include <packing>',
                    'varying vec4 vPosition;',
                    'varying vec4 projTexCoord;',
                    'uniform sampler2D depthTexture;',
                    'uniform vec2 cameraNearFar;',
                    'void main() {',
                    '\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));',
                    '\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );',
                    '\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;',
                    '\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);',
                    '}'
                ].join('\n')
            });
        },
        getEdgeDetectionMaterial: function () {
            return new THREE.ShaderMaterial({
                uniforms: {
                    'maskTexture': { value: null },
                    'texSize': { value: new THREE.Vector2(0.5, 0.5) },
                    'visibleEdgeColor': { value: new THREE.Vector3(1, 1, 1) },
                    'hiddenEdgeColor': { value: new THREE.Vector3(1, 1, 1) }
                },
                vertexShader: 'varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}',
                fragmentShader: 'varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}'
            });
        },
        getSeperableBlurMaterial: function (maxRadius) {
            return new THREE.ShaderMaterial({
                defines: { 'MAX_RADIUS': maxRadius },
                uniforms: {
                    'colorTexture': { value: null },
                    'texSize': { value: new THREE.Vector2(0.5, 0.5) },
                    'direction': { value: new THREE.Vector2(0.5, 0.5) },
                    'kernelRadius': { value: 1 }
                },
                vertexShader: 'varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}',
                fragmentShader: '#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\t\t\t\t}'
            });
        },
        getOverlayMaterial: function () {
            return new THREE.ShaderMaterial({
                uniforms: {
                    'maskTexture': { value: null },
                    'edgeTexture1': { value: null },
                    'edgeTexture2': { value: null },
                    'patternTexture': { value: null },
                    'edgeStrength': { value: 1 },
                    'edgeGlow': { value: 1 },
                    'usePatternTexture': { value: 0 }
                },
                vertexShader: 'varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}',
                fragmentShader: 'varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}',
                blending: THREE.AdditiveBlending,
                depthTest: false,
                depthWrite: false,
                transparent: true
            });
        }
    });
    OutlinePass.BlurDirectionX = new THREE.Vector2(1, 0);
    OutlinePass.BlurDirectionY = new THREE.Vector2(0, 1);

    return threex.postprocessing.OutlinePass = OutlinePass;
});
define('skylark-threejs-ex/postprocessing/RenderPass',[
     "../threex",
    './Pass'
], function (
    threex,
    Pass
) {
    'use strict';
    var RenderPass = function (scene, camera, overrideMaterial, clearColor, clearAlpha) {
        Pass.call(this);
        this.scene = scene;
        this.camera = camera;
        this.overrideMaterial = overrideMaterial;
        this.clearColor = clearColor;
        this.clearAlpha = clearAlpha !== undefined ? clearAlpha : 0;
        this.clear = true;
        this.clearDepth = false;
        this.needsSwap = false;
    };
    RenderPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: RenderPass,
        render: function (renderer, writeBuffer, readBuffer) {
            var oldAutoClear = renderer.autoClear;
            renderer.autoClear = false;
            var oldClearColor, oldClearAlpha, oldOverrideMaterial;
            if (this.overrideMaterial !== undefined) {
                oldOverrideMaterial = this.scene.overrideMaterial;
                this.scene.overrideMaterial = this.overrideMaterial;
            }
            if (this.clearColor) {
                oldClearColor = renderer.getClearColor().getHex();
                oldClearAlpha = renderer.getClearAlpha();
                renderer.setClearColor(this.clearColor, this.clearAlpha);
            }
            if (this.clearDepth) {
                renderer.clearDepth();
            }
            renderer.setRenderTarget(this.renderToScreen ? null : readBuffer);
            if (this.clear)
                renderer.clear(renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil);
            renderer.render(this.scene, this.camera);
            if (this.clearColor) {
                renderer.setClearColor(oldClearColor, oldClearAlpha);
            }
            if (this.overrideMaterial !== undefined) {
                this.scene.overrideMaterial = oldOverrideMaterial;
            }
            renderer.autoClear = oldAutoClear;
        }
    });

    return threex.postprocessing.RenderPass = RenderPass;
});
define('skylark-threejs-ex/shaders/SAOShader',[
      "skylark-threejs",
      "../threex"   
], function (
      THREE,
      threex
) {
    'use strict';
    var SAOShader = {
        defines: {
            'NUM_SAMPLES': 7,
            'NUM_RINGS': 4,
            'NORMAL_TEXTURE': 0,
            'DIFFUSE_TEXTURE': 0,
            'DEPTH_PACKING': 1,
            'PERSPECTIVE_CAMERA': 1
        },
        uniforms: {
            'tDepth': { value: null },
            'tDiffuse': { value: null },
            'tNormal': { value: null },
            'size': { value: new THREE.Vector2(512, 512) },
            'cameraNear': { value: 1 },
            'cameraFar': { value: 100 },
            'cameraProjectionMatrix': { value: new THREE.Matrix4() },
            'cameraInverseProjectionMatrix': { value: new THREE.Matrix4() },
            'scale': { value: 1 },
            'intensity': { value: 0.1 },
            'bias': { value: 0.5 },
            'minResolution': { value: 0 },
            'kernelRadius': { value: 100 },
            'randomSeed': { value: 0 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#include <common>',
            'varying vec2 vUv;',
            '#if DIFFUSE_TEXTURE == 1',
            'uniform sampler2D tDiffuse;',
            '#endif',
            'uniform sampler2D tDepth;',
            '#if NORMAL_TEXTURE == 1',
            'uniform sampler2D tNormal;',
            '#endif',
            'uniform float cameraNear;',
            'uniform float cameraFar;',
            'uniform mat4 cameraProjectionMatrix;',
            'uniform mat4 cameraInverseProjectionMatrix;',
            'uniform float scale;',
            'uniform float intensity;',
            'uniform float bias;',
            'uniform float kernelRadius;',
            'uniform float minResolution;',
            'uniform vec2 size;',
            'uniform float randomSeed;',
            '// RGBA depth',
            '#include <packing>',
            'vec4 getDefaultColor( const in vec2 screenPosition ) {',
            '\t#if DIFFUSE_TEXTURE == 1',
            '\treturn texture2D( tDiffuse, vUv );',
            '\t#else',
            '\treturn vec4( 1.0 );',
            '\t#endif',
            '}',
            'float getDepth( const in vec2 screenPosition ) {',
            '\t#if DEPTH_PACKING == 1',
            '\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );',
            '\t#else',
            '\treturn texture2D( tDepth, screenPosition ).x;',
            '\t#endif',
            '}',
            'float getViewZ( const in float depth ) {',
            '\t#if PERSPECTIVE_CAMERA == 1',
            '\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );',
            '\t#else',
            '\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );',
            '\t#endif',
            '}',
            'vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {',
            '\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];',
            '\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );',
            '\tclipPosition *= clipW; // unprojection.',
            '\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;',
            '}',
            'vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {',
            '\t#if NORMAL_TEXTURE == 1',
            '\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );',
            '\t#else',
            '\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );',
            '\t#endif',
            '}',
            'float scaleDividedByCameraFar;',
            'float minResolutionMultipliedByCameraFar;',
            'float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {',
            '\tvec3 viewDelta = sampleViewPosition - centerViewPosition;',
            '\tfloat viewDistance = length( viewDelta );',
            '\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;',
            '\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );',
            '}',
            '// moving costly divides into consts',
            'const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );',
            'const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );',
            'float getAmbientOcclusion( const in vec3 centerViewPosition ) {',
            '\t// precompute some variables require in getOcclusion.',
            '\tscaleDividedByCameraFar = scale / cameraFar;',
            '\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;',
            '\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );',
            '\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/',
            '\tfloat angle = rand( vUv + randomSeed ) * PI2;',
            '\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;',
            '\tvec2 radiusStep = radius;',
            '\tfloat occlusionSum = 0.0;',
            '\tfloat weightSum = 0.0;',
            '\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {',
            '\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;',
            '\t\tradius += radiusStep;',
            '\t\tangle += ANGLE_STEP;',
            '\t\tfloat sampleDepth = getDepth( sampleUv );',
            '\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {',
            '\t\t\tcontinue;',
            '\t\t}',
            '\t\tfloat sampleViewZ = getViewZ( sampleDepth );',
            '\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );',
            '\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );',
            '\t\tweightSum += 1.0;',
            '\t}',
            '\tif( weightSum == 0.0 ) discard;',
            '\treturn occlusionSum * ( intensity / weightSum );',
            '}',
            'void main() {',
            '\tfloat centerDepth = getDepth( vUv );',
            '\tif( centerDepth >= ( 1.0 - EPSILON ) ) {',
            '\t\tdiscard;',
            '\t}',
            '\tfloat centerViewZ = getViewZ( centerDepth );',
            '\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );',
            '\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );',
            '\tgl_FragColor = getDefaultColor( vUv );',
            '\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;',
            '}'
        ].join('\n')
    };
    return threex.shaders.SAOShader = SAOShader;
});
define('skylark-threejs-ex/shaders/DepthLimitedBlurShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var DepthLimitedBlurShader = {
        defines: {
            'KERNEL_RADIUS': 4,
            'DEPTH_PACKING': 1,
            'PERSPECTIVE_CAMERA': 1
        },
        uniforms: {
            'tDiffuse': { value: null },
            'size': { value: new THREE.Vector2(512, 512) },
            'sampleUvOffsets': { value: [new THREE.Vector2(0, 0)] },
            'sampleWeights': { value: [1] },
            'tDepth': { value: null },
            'cameraNear': { value: 10 },
            'cameraFar': { value: 1000 },
            'depthCutoff': { value: 10 }
        },
        vertexShader: [
            '#include <common>',
            'uniform vec2 size;',
            'varying vec2 vUv;',
            'varying vec2 vInvSize;',
            'void main() {',
            '\tvUv = uv;',
            '\tvInvSize = 1.0 / size;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#include <common>',
            '#include <packing>',
            'uniform sampler2D tDiffuse;',
            'uniform sampler2D tDepth;',
            'uniform float cameraNear;',
            'uniform float cameraFar;',
            'uniform float depthCutoff;',
            'uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];',
            'uniform float sampleWeights[ KERNEL_RADIUS + 1 ];',
            'varying vec2 vUv;',
            'varying vec2 vInvSize;',
            'float getDepth( const in vec2 screenPosition ) {',
            '\t#if DEPTH_PACKING == 1',
            '\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );',
            '\t#else',
            '\treturn texture2D( tDepth, screenPosition ).x;',
            '\t#endif',
            '}',
            'float getViewZ( const in float depth ) {',
            '\t#if PERSPECTIVE_CAMERA == 1',
            '\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );',
            '\t#else',
            '\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );',
            '\t#endif',
            '}',
            'void main() {',
            '\tfloat depth = getDepth( vUv );',
            '\tif( depth >= ( 1.0 - EPSILON ) ) {',
            '\t\tdiscard;',
            '\t}',
            '\tfloat centerViewZ = -getViewZ( depth );',
            '\tbool rBreak = false, lBreak = false;',
            '\tfloat weightSum = sampleWeights[0];',
            '\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;',
            '\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {',
            '\t\tfloat sampleWeight = sampleWeights[i];',
            '\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;',
            '\t\tvec2 sampleUv = vUv + sampleUvOffset;',
            '\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );',
            '\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;',
            '\t\tif( ! rBreak ) {',
            '\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;',
            '\t\t\tweightSum += sampleWeight;',
            '\t\t}',
            '\t\tsampleUv = vUv - sampleUvOffset;',
            '\t\tviewZ = -getViewZ( getDepth( sampleUv ) );',
            '\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;',
            '\t\tif( ! lBreak ) {',
            '\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;',
            '\t\t\tweightSum += sampleWeight;',
            '\t\t}',
            '\t}',
            '\tgl_FragColor = diffuseSum / weightSum;',
            '}'
        ].join('\n')
    };
    var BlurShaderUtils = DepthLimitedBlurShader.BlurShaderUtils = {
        createSampleWeights: function (kernelRadius, stdDev) {
            var gaussian = function (x, stdDev) {
                return Math.exp(-(x * x) / (2 * (stdDev * stdDev))) / (Math.sqrt(2 * Math.PI) * stdDev);
            };
            var weights = [];
            for (var i = 0; i <= kernelRadius; i++) {
                weights.push(gaussian(i, stdDev));
            }
            return weights;
        },
        createSampleOffsets: function (kernelRadius, uvIncrement) {
            var offsets = [];
            for (var i = 0; i <= kernelRadius; i++) {
                offsets.push(uvIncrement.clone().multiplyScalar(i));
            }
            return offsets;
        },
        configure: function (material, kernelRadius, stdDev, uvIncrement) {
            material.defines['KERNEL_RADIUS'] = kernelRadius;
            material.uniforms['sampleUvOffsets'].value = BlurShaderUtils.createSampleOffsets(kernelRadius, uvIncrement);
            material.uniforms['sampleWeights'].value = BlurShaderUtils.createSampleWeights(kernelRadius, stdDev);
            material.needsUpdate = true;
        }
    };

    return threex.shaders.DepthLimitedBlurShader = DepthLimitedBlurShader;
    
});
define('skylark-threejs-ex/shaders/UnpackDepthRGBAShader',[
    "../threex"
],function (threex) {
    'use strict';
    var UnpackDepthRGBAShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'opacity': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float opacity;',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            '#include <packing>',
            'void main() {',
            '\tfloat depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );',
            '\tgl_FragColor = vec4( vec3( depth ), opacity );',
            '}'
        ].join('\n')
    };
    return  threex.shaders.UnpackDepthRGBAShader = UnpackDepthRGBAShader;
});
define('skylark-threejs-ex/postprocessing/SAOPass',[
    "skylark-threejs",
    "../threex",
    './Pass',
    '../shaders/SAOShader',
    '../shaders/DepthLimitedBlurShader',
    '../shaders/CopyShader',
    '../shaders/UnpackDepthRGBAShader'
], function (
    THREE, 
    threex,
    Pass, 
    SAOShader, 
    DepthLimitedBlurShader, 
    CopyShader, 
    UnpackDepthRGBAShader
) {
    'use strict';
    var SAOPass = function (scene, camera, depthTexture, useNormals, resolution) {
        Pass.call(this);
        this.scene = scene;
        this.camera = camera;
        this.clear = true;
        this.needsSwap = false;
        this.supportsDepthTextureExtension = depthTexture !== undefined ? depthTexture : false;
        this.supportsNormalTexture = useNormals !== undefined ? useNormals : false;
        this.originalClearColor = new THREE.Color();
        this.oldClearColor = new THREE.Color();
        this.oldClearAlpha = 1;
        this.params = {
            output: 0,
            saoBias: 0.5,
            saoIntensity: 0.18,
            saoScale: 1,
            saoKernelRadius: 100,
            saoMinResolution: 0,
            saoBlur: true,
            saoBlurRadius: 8,
            saoBlurStdDev: 4,
            saoBlurDepthCutoff: 0.01
        };
        this.resolution = resolution !== undefined ? new THREE.Vector2(resolution.x, resolution.y) : new THREE.Vector2(256, 256);
        this.saoRenderTarget = new THREE.WebGLRenderTarget(this.resolution.x, this.resolution.y, {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBAFormat
        });
        this.blurIntermediateRenderTarget = this.saoRenderTarget.clone();
        this.beautyRenderTarget = this.saoRenderTarget.clone();
        this.normalRenderTarget = new THREE.WebGLRenderTarget(this.resolution.x, this.resolution.y, {
            minFilter: THREE.NearestFilter,
            magFilter: THREE.NearestFilter,
            format: THREE.RGBAFormat
        });
        this.depthRenderTarget = this.normalRenderTarget.clone();
        if (this.supportsDepthTextureExtension) {
            var depthTexture = new THREE.DepthTexture();
            depthTexture.type = THREE.UnsignedShortType;
            depthTexture.minFilter = THREE.NearestFilter;
            depthTexture.maxFilter = THREE.NearestFilter;
            this.beautyRenderTarget.depthTexture = depthTexture;
            this.beautyRenderTarget.depthBuffer = true;
        }
        this.depthMaterial = new THREE.MeshDepthMaterial();
        this.depthMaterial.depthPacking = THREE.RGBADepthPacking;
        this.depthMaterial.blending = THREE.NoBlending;
        this.normalMaterial = new THREE.MeshNormalMaterial();
        this.normalMaterial.blending = THREE.NoBlending;
        if (SAOShader === undefined) {
            console.error('THREE.SAOPass relies on SAOShader');
        }
        this.saoMaterial = new THREE.ShaderMaterial({
            defines: Object.assign({}, SAOShader.defines),
            fragmentShader: SAOShader.fragmentShader,
            vertexShader: SAOShader.vertexShader,
            uniforms: THREE.UniformsUtils.clone(SAOShader.uniforms)
        });
        this.saoMaterial.extensions.derivatives = true;
        this.saoMaterial.defines['DEPTH_PACKING'] = this.supportsDepthTextureExtension ? 0 : 1;
        this.saoMaterial.defines['NORMAL_TEXTURE'] = this.supportsNormalTexture ? 1 : 0;
        this.saoMaterial.defines['PERSPECTIVE_CAMERA'] = this.camera.isPerspectiveCamera ? 1 : 0;
        this.saoMaterial.uniforms['tDepth'].value = this.supportsDepthTextureExtension ? depthTexture : this.depthRenderTarget.texture;
        this.saoMaterial.uniforms['tNormal'].value = this.normalRenderTarget.texture;
        this.saoMaterial.uniforms['size'].value.set(this.resolution.x, this.resolution.y);
        this.saoMaterial.uniforms['cameraInverseProjectionMatrix'].value.getInverse(this.camera.projectionMatrix);
        this.saoMaterial.uniforms['cameraProjectionMatrix'].value = this.camera.projectionMatrix;
        this.saoMaterial.blending = THREE.NoBlending;
        if (DepthLimitedBlurShader === undefined) {
            console.error('THREE.SAOPass relies on DepthLimitedBlurShader');
        }
        this.vBlurMaterial = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(DepthLimitedBlurShader.uniforms),
            defines: Object.assign({}, DepthLimitedBlurShader.defines),
            vertexShader: DepthLimitedBlurShader.vertexShader,
            fragmentShader: DepthLimitedBlurShader.fragmentShader
        });
        this.vBlurMaterial.defines['DEPTH_PACKING'] = this.supportsDepthTextureExtension ? 0 : 1;
        this.vBlurMaterial.defines['PERSPECTIVE_CAMERA'] = this.camera.isPerspectiveCamera ? 1 : 0;
        this.vBlurMaterial.uniforms['tDiffuse'].value = this.saoRenderTarget.texture;
        this.vBlurMaterial.uniforms['tDepth'].value = this.supportsDepthTextureExtension ? depthTexture : this.depthRenderTarget.texture;
        this.vBlurMaterial.uniforms['size'].value.set(this.resolution.x, this.resolution.y);
        this.vBlurMaterial.blending = THREE.NoBlending;
        this.hBlurMaterial = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(DepthLimitedBlurShader.uniforms),
            defines: Object.assign({}, DepthLimitedBlurShader.defines),
            vertexShader: DepthLimitedBlurShader.vertexShader,
            fragmentShader: DepthLimitedBlurShader.fragmentShader
        });
        this.hBlurMaterial.defines['DEPTH_PACKING'] = this.supportsDepthTextureExtension ? 0 : 1;
        this.hBlurMaterial.defines['PERSPECTIVE_CAMERA'] = this.camera.isPerspectiveCamera ? 1 : 0;
        this.hBlurMaterial.uniforms['tDiffuse'].value = this.blurIntermediateRenderTarget.texture;
        this.hBlurMaterial.uniforms['tDepth'].value = this.supportsDepthTextureExtension ? depthTexture : this.depthRenderTarget.texture;
        this.hBlurMaterial.uniforms['size'].value.set(this.resolution.x, this.resolution.y);
        this.hBlurMaterial.blending = THREE.NoBlending;
        if (CopyShader === undefined) {
            console.error('THREE.SAOPass relies on CopyShader');
        }
        this.materialCopy = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(CopyShader.uniforms),
            vertexShader: CopyShader.vertexShader,
            fragmentShader: CopyShader.fragmentShader,
            blending: THREE.NoBlending
        });
        this.materialCopy.transparent = true;
        this.materialCopy.depthTest = false;
        this.materialCopy.depthWrite = false;
        this.materialCopy.blending = THREE.CustomBlending;
        this.materialCopy.blendSrc = THREE.DstColorFactor;
        this.materialCopy.blendDst = THREE.ZeroFactor;
        this.materialCopy.blendEquation = THREE.AddEquation;
        this.materialCopy.blendSrcAlpha = THREE.DstAlphaFactor;
        this.materialCopy.blendDstAlpha = THREE.ZeroFactor;
        this.materialCopy.blendEquationAlpha = THREE.AddEquation;
        if (UnpackDepthRGBAShader === undefined) {
            console.error('THREE.SAOPass relies on UnpackDepthRGBAShader');
        }
        this.depthCopy = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(UnpackDepthRGBAShader.uniforms),
            vertexShader: UnpackDepthRGBAShader.vertexShader,
            fragmentShader: UnpackDepthRGBAShader.fragmentShader,
            blending: THREE.NoBlending
        });
        this.fsQuad = new Pass.FullScreenQuad(null);
    };
    SAOPass.OUTPUT = {
        'Beauty': 1,
        'Default': 0,
        'SAO': 2,
        'Depth': 3,
        'Normal': 4
    };
    SAOPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: SAOPass,
        render: function (renderer, writeBuffer, readBuffer) {
            if (this.renderToScreen) {
                this.materialCopy.blending = THREE.NoBlending;
                this.materialCopy.uniforms['tDiffuse'].value = readBuffer.texture;
                this.materialCopy.needsUpdate = true;
                this.renderPass(renderer, this.materialCopy, null);
            }
            if (this.params.output === 1) {
                return;
            }
            this.oldClearColor.copy(renderer.getClearColor());
            this.oldClearAlpha = renderer.getClearAlpha();
            var oldAutoClear = renderer.autoClear;
            renderer.autoClear = false;
            renderer.setRenderTarget(this.depthRenderTarget);
            renderer.clear();
            this.saoMaterial.uniforms['bias'].value = this.params.saoBias;
            this.saoMaterial.uniforms['intensity'].value = this.params.saoIntensity;
            this.saoMaterial.uniforms['scale'].value = this.params.saoScale;
            this.saoMaterial.uniforms['kernelRadius'].value = this.params.saoKernelRadius;
            this.saoMaterial.uniforms['minResolution'].value = this.params.saoMinResolution;
            this.saoMaterial.uniforms['cameraNear'].value = this.camera.near;
            this.saoMaterial.uniforms['cameraFar'].value = this.camera.far;
            var depthCutoff = this.params.saoBlurDepthCutoff * (this.camera.far - this.camera.near);
            this.vBlurMaterial.uniforms['depthCutoff'].value = depthCutoff;
            this.hBlurMaterial.uniforms['depthCutoff'].value = depthCutoff;
            this.vBlurMaterial.uniforms['cameraNear'].value = this.camera.near;
            this.vBlurMaterial.uniforms['cameraFar'].value = this.camera.far;
            this.hBlurMaterial.uniforms['cameraNear'].value = this.camera.near;
            this.hBlurMaterial.uniforms['cameraFar'].value = this.camera.far;
            this.params.saoBlurRadius = Math.floor(this.params.saoBlurRadius);
            if (this.prevStdDev !== this.params.saoBlurStdDev || this.prevNumSamples !== this.params.saoBlurRadius) {
                BlurShaderUtils.configure(this.vBlurMaterial, this.params.saoBlurRadius, this.params.saoBlurStdDev, new THREE.Vector2(0, 1));
                BlurShaderUtils.configure(this.hBlurMaterial, this.params.saoBlurRadius, this.params.saoBlurStdDev, new THREE.Vector2(1, 0));
                this.prevStdDev = this.params.saoBlurStdDev;
                this.prevNumSamples = this.params.saoBlurRadius;
            }
            renderer.setClearColor(0);
            renderer.setRenderTarget(this.beautyRenderTarget);
            renderer.clear();
            renderer.render(this.scene, this.camera);
            if (!this.supportsDepthTextureExtension) {
                this.renderOverride(renderer, this.depthMaterial, this.depthRenderTarget, 0, 1);
            }
            if (this.supportsNormalTexture) {
                this.renderOverride(renderer, this.normalMaterial, this.normalRenderTarget, 7829503, 1);
            }
            this.renderPass(renderer, this.saoMaterial, this.saoRenderTarget, 16777215, 1);
            if (this.params.saoBlur) {
                this.renderPass(renderer, this.vBlurMaterial, this.blurIntermediateRenderTarget, 16777215, 1);
                this.renderPass(renderer, this.hBlurMaterial, this.saoRenderTarget, 16777215, 1);
            }
            var outputMaterial = this.materialCopy;
            if (this.params.output === 3) {
                if (this.supportsDepthTextureExtension) {
                    this.materialCopy.uniforms['tDiffuse'].value = this.beautyRenderTarget.depthTexture;
                    this.materialCopy.needsUpdate = true;
                } else {
                    this.depthCopy.uniforms['tDiffuse'].value = this.depthRenderTarget.texture;
                    this.depthCopy.needsUpdate = true;
                    outputMaterial = this.depthCopy;
                }
            } else if (this.params.output === 4) {
                this.materialCopy.uniforms['tDiffuse'].value = this.normalRenderTarget.texture;
                this.materialCopy.needsUpdate = true;
            } else {
                this.materialCopy.uniforms['tDiffuse'].value = this.saoRenderTarget.texture;
                this.materialCopy.needsUpdate = true;
            }
            if (this.params.output === 0) {
                outputMaterial.blending = THREE.CustomBlending;
            } else {
                outputMaterial.blending = THREE.NoBlending;
            }
            this.renderPass(renderer, outputMaterial, this.renderToScreen ? null : readBuffer);
            renderer.setClearColor(this.oldClearColor, this.oldClearAlpha);
            renderer.autoClear = oldAutoClear;
        },
        renderPass: function (renderer, passMaterial, renderTarget, clearColor, clearAlpha) {
            this.originalClearColor.copy(renderer.getClearColor());
            var originalClearAlpha = renderer.getClearAlpha();
            var originalAutoClear = renderer.autoClear;
            renderer.setRenderTarget(renderTarget);
            renderer.autoClear = false;
            if (clearColor !== undefined && clearColor !== null) {
                renderer.setClearColor(clearColor);
                renderer.setClearAlpha(clearAlpha || 0);
                renderer.clear();
            }
            this.fsQuad.material = passMaterial;
            this.fsQuad.render(renderer);
            renderer.autoClear = originalAutoClear;
            renderer.setClearColor(this.originalClearColor);
            renderer.setClearAlpha(originalClearAlpha);
        },
        renderOverride: function (renderer, overrideMaterial, renderTarget, clearColor, clearAlpha) {
            this.originalClearColor.copy(renderer.getClearColor());
            var originalClearAlpha = renderer.getClearAlpha();
            var originalAutoClear = renderer.autoClear;
            renderer.setRenderTarget(renderTarget);
            renderer.autoClear = false;
            clearColor = overrideMaterial.clearColor || clearColor;
            clearAlpha = overrideMaterial.clearAlpha || clearAlpha;
            if (clearColor !== undefined && clearColor !== null) {
                renderer.setClearColor(clearColor);
                renderer.setClearAlpha(clearAlpha || 0);
                renderer.clear();
            }
            this.scene.overrideMaterial = overrideMaterial;
            renderer.render(this.scene, this.camera);
            this.scene.overrideMaterial = null;
            renderer.autoClear = originalAutoClear;
            renderer.setClearColor(this.originalClearColor);
            renderer.setClearAlpha(originalClearAlpha);
        },
        setSize: function (width, height) {
            this.beautyRenderTarget.setSize(width, height);
            this.saoRenderTarget.setSize(width, height);
            this.blurIntermediateRenderTarget.setSize(width, height);
            this.normalRenderTarget.setSize(width, height);
            this.depthRenderTarget.setSize(width, height);
            this.saoMaterial.uniforms['size'].value.set(width, height);
            this.saoMaterial.uniforms['cameraInverseProjectionMatrix'].value.getInverse(this.camera.projectionMatrix);
            this.saoMaterial.uniforms['cameraProjectionMatrix'].value = this.camera.projectionMatrix;
            this.saoMaterial.needsUpdate = true;
            this.vBlurMaterial.uniforms['size'].value.set(width, height);
            this.vBlurMaterial.needsUpdate = true;
            this.hBlurMaterial.uniforms['size'].value.set(width, height);
            this.hBlurMaterial.needsUpdate = true;
        }
    });

    return threex.postprocessing.SAOPass = SAOPass;
});
define('skylark-threejs-ex/postprocessing/SavePass',[
    "skylark-threejs",
    "../threex",
    './Pass',
    '../shaders/CopyShader'
], function (
    THREE,
    threex, 
    Pass, 
    CopyShader
) {
    'use strict';
    var SavePass = function (renderTarget) {
        Pass.call(this);
        if (CopyShader === undefined)
            console.error('SavePass relies on CopyShader');
        var shader = CopyShader;
        this.textureID = 'tDiffuse';
        this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);
        this.material = new THREE.ShaderMaterial({
            uniforms: this.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader
        });
        this.renderTarget = renderTarget;
        if (this.renderTarget === undefined) {
            this.renderTarget = new THREE.WebGLRenderTarget(window.innerWidth, window.innerHeight, {
                minFilter: THREE.LinearFilter,
                magFilter: THREE.LinearFilter,
                format: THREE.RGBFormat,
                stencilBuffer: false
            });
            this.renderTarget.texture.name = 'SavePass.rt';
        }
        this.needsSwap = false;
        this.fsQuad = new Pass.FullScreenQuad(this.material);
    };
    SavePass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: SavePass,
        render: function (renderer, writeBuffer, readBuffer) {
            if (this.uniforms[this.textureID]) {
                this.uniforms[this.textureID].value = readBuffer.texture;
            }
            renderer.setRenderTarget(this.renderTarget);
            if (this.clear)
                renderer.clear();
            this.fsQuad.render(renderer);
        }
    });

    return threex.postprocessing.SavePass = SavePass;
});
define('skylark-threejs-ex/shaders/SMAAShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var SMAAEdgesShader = {
        defines: { 'SMAA_THRESHOLD': '0.1' },
        uniforms: {
            'tDiffuse': { value: null },
            'resolution': { value: new THREE.Vector2(1 / 1024, 1 / 512) }
        },
        vertexShader: [
            'uniform vec2 resolution;',
            'varying vec2 vUv;',
            'varying vec4 vOffset[ 3 ];',
            'void SMAAEdgeDetectionVS( vec2 texcoord ) {',
            '\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );',
            '\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );',
            '\tvOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );',
            '}',
            'void main() {',
            '\tvUv = uv;',
            '\tSMAAEdgeDetectionVS( vUv );',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'varying vec4 vOffset[ 3 ];',
            'vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {',
            '\tvec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );',
            '\tvec4 delta;',
            '\tvec3 C = texture2D( colorTex, texcoord ).rgb;',
            '\tvec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;',
            '\tvec3 t = abs( C - Cleft );',
            '\tdelta.x = max( max( t.r, t.g ), t.b );',
            '\tvec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;',
            '\tt = abs( C - Ctop );',
            '\tdelta.y = max( max( t.r, t.g ), t.b );',
            '\tvec2 edges = step( threshold, delta.xy );',
            '\tif ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )',
            '\t\tdiscard;',
            '\tvec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;',
            '\tt = abs( C - Cright );',
            '\tdelta.z = max( max( t.r, t.g ), t.b );',
            '\tvec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;',
            '\tt = abs( C - Cbottom );',
            '\tdelta.w = max( max( t.r, t.g ), t.b );',
            '\tfloat maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );',
            '\tvec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;',
            '\tt = abs( C - Cleftleft );',
            '\tdelta.z = max( max( t.r, t.g ), t.b );',
            '\tvec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;',
            '\tt = abs( C - Ctoptop );',
            '\tdelta.w = max( max( t.r, t.g ), t.b );',
            '\tmaxDelta = max( max( maxDelta, delta.z ), delta.w );',
            '\tedges.xy *= step( 0.5 * maxDelta, delta.xy );',
            '\treturn vec4( edges, 0.0, 0.0 );',
            '}',
            'void main() {',
            '\tgl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );',
            '}'
        ].join('\n')
    };
    var SMAAWeightsShader = {
        defines: {
            'SMAA_MAX_SEARCH_STEPS': '8',
            'SMAA_AREATEX_MAX_DISTANCE': '16',
            'SMAA_AREATEX_PIXEL_SIZE': '( 1.0 / vec2( 160.0, 560.0 ) )',
            'SMAA_AREATEX_SUBTEX_SIZE': '( 1.0 / 7.0 )'
        },
        uniforms: {
            'tDiffuse': { value: null },
            'tArea': { value: null },
            'tSearch': { value: null },
            'resolution': { value: new THREE.Vector2(1 / 1024, 1 / 512) }
        },
        vertexShader: [
            'uniform vec2 resolution;',
            'varying vec2 vUv;',
            'varying vec4 vOffset[ 3 ];',
            'varying vec2 vPixcoord;',
            'void SMAABlendingWeightCalculationVS( vec2 texcoord ) {',
            '\tvPixcoord = texcoord / resolution;',
            '\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );',
            '\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );',
            '\tvOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );',
            '}',
            'void main() {',
            '\tvUv = uv;',
            '\tSMAABlendingWeightCalculationVS( vUv );',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )',
            'uniform sampler2D tDiffuse;',
            'uniform sampler2D tArea;',
            'uniform sampler2D tSearch;',
            'uniform vec2 resolution;',
            'varying vec2 vUv;',
            'varying vec4 vOffset[3];',
            'varying vec2 vPixcoord;',
            '#if __VERSION__ == 100',
            'vec2 round( vec2 x ) {',
            '\treturn sign( x ) * floor( abs( x ) + 0.5 );',
            '}',
            '#endif',
            'float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {',
            '\te.r = bias + e.r * scale;',
            '\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;',
            '}',
            'float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {',
            '\tvec2 e = vec2( 0.0, 1.0 );',
            '\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {',
            '\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;',
            '\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;',
            '\t\tif ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;',
            '\t}',
            '\ttexcoord.x += 0.25 * resolution.x;',
            '\ttexcoord.x += resolution.x;',
            '\ttexcoord.x += 2.0 * resolution.x;',
            '\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);',
            '\treturn texcoord.x;',
            '}',
            'float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {',
            '\tvec2 e = vec2( 0.0, 1.0 );',
            '\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {',
            '\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;',
            '\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;',
            '\t\tif ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;',
            '\t}',
            '\ttexcoord.x -= 0.25 * resolution.x;',
            '\ttexcoord.x -= resolution.x;',
            '\ttexcoord.x -= 2.0 * resolution.x;',
            '\ttexcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );',
            '\treturn texcoord.x;',
            '}',
            'float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {',
            '\tvec2 e = vec2( 1.0, 0.0 );',
            '\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {',
            '\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;',
            '\t\ttexcoord += vec2( 0.0, 2.0 ) * resolution;',
            '\t\tif ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;',
            '\t}',
            '\ttexcoord.y -= 0.25 * resolution.y;',
            '\ttexcoord.y -= resolution.y;',
            '\ttexcoord.y -= 2.0 * resolution.y;',
            '\ttexcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );',
            '\treturn texcoord.y;',
            '}',
            'float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {',
            '\tvec2 e = vec2( 1.0, 0.0 );',
            '\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {',
            '\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;',
            '\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution;',
            '\t\tif ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;',
            '\t}',
            '\ttexcoord.y += 0.25 * resolution.y;',
            '\ttexcoord.y += resolution.y;',
            '\ttexcoord.y += 2.0 * resolution.y;',
            '\ttexcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );',
            '\treturn texcoord.y;',
            '}',
            'vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {',
            '\tvec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;',
            '\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );',
            '\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;',
            '\treturn texture2D( areaTex, texcoord, 0.0 ).rg;',
            '}',
            'vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {',
            '\tvec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );',
            '\tvec2 e = texture2D( edgesTex, texcoord ).rg;',
            '\tif ( e.g > 0.0 ) {',
            '\t\tvec2 d;',
            '\t\tvec2 coords;',
            '\t\tcoords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );',
            '\t\tcoords.y = offset[ 1 ].y;',
            '\t\td.x = coords.x;',
            '\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).r;',
            '\t\tcoords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );',
            '\t\td.y = coords.x;',
            '\t\td = d / resolution.x - pixcoord.x;',
            '\t\tvec2 sqrt_d = sqrt( abs( d ) );',
            '\t\tcoords.y -= 1.0 * resolution.y;',
            '\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;',
            '\t\tweights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );',
            '\t}',
            '\tif ( e.r > 0.0 ) {',
            '\t\tvec2 d;',
            '\t\tvec2 coords;',
            '\t\tcoords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );',
            '\t\tcoords.x = offset[ 0 ].x;',
            '\t\td.x = coords.y;',
            '\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).g;',
            '\t\tcoords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );',
            '\t\td.y = coords.y;',
            '\t\td = d / resolution.y - pixcoord.y;',
            '\t\tvec2 sqrt_d = sqrt( abs( d ) );',
            '\t\tcoords.y -= 1.0 * resolution.y;',
            '\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;',
            '\t\tweights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );',
            '\t}',
            '\treturn weights;',
            '}',
            'void main() {',
            '\tgl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );',
            '}'
        ].join('\n')
    };
    var SMAABlendShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'tColor': { value: null },
            'resolution': { value: new THREE.Vector2(1 / 1024, 1 / 512) }
        },
        vertexShader: [
            'uniform vec2 resolution;',
            'varying vec2 vUv;',
            'varying vec4 vOffset[ 2 ];',
            'void SMAANeighborhoodBlendingVS( vec2 texcoord ) {',
            '\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );',
            '\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );',
            '}',
            'void main() {',
            '\tvUv = uv;',
            '\tSMAANeighborhoodBlendingVS( vUv );',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform sampler2D tColor;',
            'uniform vec2 resolution;',
            'varying vec2 vUv;',
            'varying vec4 vOffset[ 2 ];',
            'vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {',
            '\tvec4 a;',
            '\ta.xz = texture2D( blendTex, texcoord ).xz;',
            '\ta.y = texture2D( blendTex, offset[ 1 ].zw ).g;',
            '\ta.w = texture2D( blendTex, offset[ 1 ].xy ).a;',
            '\tif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {',
            '\t\treturn texture2D( colorTex, texcoord, 0.0 );',
            '\t} else {',
            '\t\tvec2 offset;',
            '\t\toffset.x = a.a > a.b ? a.a : -a.b;',
            '\t\toffset.y = a.g > a.r ? -a.g : a.r;',
            '\t\tif ( abs( offset.x ) > abs( offset.y )) {',
            '\t\t\toffset.y = 0.0;',
            '\t\t} else {',
            '\t\t\toffset.x = 0.0;',
            '\t\t}',
            '\t\tvec4 C = texture2D( colorTex, texcoord, 0.0 );',
            '\t\ttexcoord += sign( offset ) * resolution;',
            '\t\tvec4 Cop = texture2D( colorTex, texcoord, 0.0 );',
            '\t\tfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );',
            '\t\tC.xyz = pow(C.xyz, vec3(2.2));',
            '\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));',
            '\t\tvec4 mixed = mix(C, Cop, s);',
            '\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));',
            '\t\treturn mixed;',
            '\t}',
            '}',
            'void main() {',
            '\tgl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );',
            '}'
        ].join('\n')
    };
    return threex.shaders.SMAAShader = {
        SMAAEdgesShader,
        SMAAWeightsShader,
        SMAABlendShader
    };
});
define('skylark-threejs-ex/postprocessing/SMAAPass',[
    "skylark-threejs",
    "../threex",
    './Pass',
    '../shaders/SMAAShader'
], function (
    THREE, 
    threex,
    Pass, 
    SMAAShader
) {
    'use strict';
    var SMAAPass = function (width, height) {
        Pass.call(this);
        this.edgesRT = new THREE.WebGLRenderTarget(width, height, {
            depthBuffer: false,
            stencilBuffer: false,
            generateMipmaps: false,
            minFilter: THREE.LinearFilter,
            format: THREE.RGBFormat
        });
        this.edgesRT.texture.name = 'SMAAPass.edges';
        this.weightsRT = new THREE.WebGLRenderTarget(width, height, {
            depthBuffer: false,
            stencilBuffer: false,
            generateMipmaps: false,
            minFilter: THREE.LinearFilter,
            format: THREE.RGBAFormat
        });
        this.weightsRT.texture.name = 'SMAAPass.weights';
        var scope = this;
        var areaTextureImage = new Image();
        areaTextureImage.src = this.getAreaTexture();
        areaTextureImage.onload = function () {
            scope.areaTexture.needsUpdate = true;
        };
        this.areaTexture = new THREE.Texture();
        this.areaTexture.name = 'SMAAPass.area';
        this.areaTexture.image = areaTextureImage;
        this.areaTexture.format = THREE.RGBFormat;
        this.areaTexture.minFilter = THREE.LinearFilter;
        this.areaTexture.generateMipmaps = false;
        this.areaTexture.flipY = false;
        var searchTextureImage = new Image();
        searchTextureImage.src = this.getSearchTexture();
        searchTextureImage.onload = function () {
            scope.searchTexture.needsUpdate = true;
        };
        this.searchTexture = new THREE.Texture();
        this.searchTexture.name = 'SMAAPass.search';
        this.searchTexture.image = searchTextureImage;
        this.searchTexture.magFilter = THREE.NearestFilter;
        this.searchTexture.minFilter = THREE.NearestFilter;
        this.searchTexture.generateMipmaps = false;
        this.searchTexture.flipY = false;
        if (SMAAEdgesShader === undefined) {
            console.error('SMAAPass relies on SMAAShader');
        }
        this.uniformsEdges = THREE.UniformsUtils.clone(SMAAEdgesShader.uniforms);
        this.uniformsEdges['resolution'].value.set(1 / width, 1 / height);
        this.materialEdges = new THREE.ShaderMaterial({
            defines: Object.assign({}, SMAAEdgesShader.defines),
            uniforms: this.uniformsEdges,
            vertexShader: SMAAEdgesShader.vertexShader,
            fragmentShader: SMAAEdgesShader.fragmentShader
        });
        this.uniformsWeights = THREE.UniformsUtils.clone(SMAAWeightsShader.uniforms);
        this.uniformsWeights['resolution'].value.set(1 / width, 1 / height);
        this.uniformsWeights['tDiffuse'].value = this.edgesRT.texture;
        this.uniformsWeights['tArea'].value = this.areaTexture;
        this.uniformsWeights['tSearch'].value = this.searchTexture;
        this.materialWeights = new THREE.ShaderMaterial({
            defines: Object.assign({}, SMAAWeightsShader.defines),
            uniforms: this.uniformsWeights,
            vertexShader: SMAAWeightsShader.vertexShader,
            fragmentShader: SMAAWeightsShader.fragmentShader
        });
        this.uniformsBlend = THREE.UniformsUtils.clone(SMAABlendShader.uniforms);
        this.uniformsBlend['resolution'].value.set(1 / width, 1 / height);
        this.uniformsBlend['tDiffuse'].value = this.weightsRT.texture;
        this.materialBlend = new THREE.ShaderMaterial({
            uniforms: this.uniformsBlend,
            vertexShader: SMAABlendShader.vertexShader,
            fragmentShader: SMAABlendShader.fragmentShader
        });
        this.needsSwap = false;
        this.fsQuad = new Pass.FullScreenQuad(null);
    };
    SMAAPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: SMAAPass,
        render: function (renderer, writeBuffer, readBuffer) {
            this.uniformsEdges['tDiffuse'].value = readBuffer.texture;
            this.fsQuad.material = this.materialEdges;
            renderer.setRenderTarget(this.edgesRT);
            if (this.clear)
                renderer.clear();
            this.fsQuad.render(renderer);
            this.fsQuad.material = this.materialWeights;
            renderer.setRenderTarget(this.weightsRT);
            if (this.clear)
                renderer.clear();
            this.fsQuad.render(renderer);
            this.uniformsBlend['tColor'].value = readBuffer.texture;
            this.fsQuad.material = this.materialBlend;
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(writeBuffer);
                if (this.clear)
                    renderer.clear();
                this.fsQuad.render(renderer);
            }
        },
        setSize: function (width, height) {
            this.edgesRT.setSize(width, height);
            this.weightsRT.setSize(width, height);
            this.materialEdges.uniforms['resolution'].value.set(1 / width, 1 / height);
            this.materialWeights.uniforms['resolution'].value.set(1 / width, 1 / height);
            this.materialBlend.uniforms['resolution'].value.set(1 / width, 1 / height);
        },
        getAreaTexture: function () {
            return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII=';
        },
        getSearchTexture: function () {
            return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII=';
        }
    });
    return threex.postprocessing.SMAAPass = SMAAPass;
});
define('skylark-threejs-ex/postprocessing/SSAARenderPass',[
    "skylark-threejs",
    "../threex",
    './Pass',
    '../shaders/CopyShader'
], function (
    THREE, 
    threex,
    Pass, 
    CopyShader
) {
    'use strict';
    var SSAARenderPass = function (scene, camera, clearColor, clearAlpha) {
        Pass.call(this);
        this.scene = scene;
        this.camera = camera;
        this.sampleLevel = 4;
        this.unbiased = true;
        this.clearColor = clearColor !== undefined ? clearColor : 0;
        this.clearAlpha = clearAlpha !== undefined ? clearAlpha : 0;
        if (CopyShader === undefined)
            console.error('SSAARenderPass relies on CopyShader');
        var copyShader = CopyShader;
        this.copyUniforms = THREE.UniformsUtils.clone(copyShader.uniforms);
        this.copyMaterial = new THREE.ShaderMaterial({
            uniforms: this.copyUniforms,
            vertexShader: copyShader.vertexShader,
            fragmentShader: copyShader.fragmentShader,
            premultipliedAlpha: true,
            transparent: true,
            blending: THREE.AdditiveBlending,
            depthTest: false,
            depthWrite: false
        });
        this.fsQuad = new Pass.FullScreenQuad(this.copyMaterial);
    };
    SSAARenderPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: SSAARenderPass,
        dispose: function () {
            if (this.sampleRenderTarget) {
                this.sampleRenderTarget.dispose();
                this.sampleRenderTarget = null;
            }
        },
        setSize: function (width, height) {
            if (this.sampleRenderTarget)
                this.sampleRenderTarget.setSize(width, height);
        },
        render: function (renderer, writeBuffer, readBuffer) {
            if (!this.sampleRenderTarget) {
                this.sampleRenderTarget = new THREE.WebGLRenderTarget(readBuffer.width, readBuffer.height, {
                    minFilter: THREE.LinearFilter,
                    magFilter: THREE.LinearFilter,
                    format: THREE.RGBAFormat
                });
                this.sampleRenderTarget.texture.name = 'SSAARenderPass.sample';
            }
            var jitterOffsets = SSAARenderPass.JitterVectors[Math.max(0, Math.min(this.sampleLevel, 5))];
            var autoClear = renderer.autoClear;
            renderer.autoClear = false;
            var oldClearColor = renderer.getClearColor().getHex();
            var oldClearAlpha = renderer.getClearAlpha();
            var baseSampleWeight = 1 / jitterOffsets.length;
            var roundingRange = 1 / 32;
            this.copyUniforms['tDiffuse'].value = this.sampleRenderTarget.texture;
            var width = readBuffer.width, height = readBuffer.height;
            for (var i = 0; i < jitterOffsets.length; i++) {
                var jitterOffset = jitterOffsets[i];
                if (this.camera.setViewOffset) {
                    this.camera.setViewOffset(width, height, jitterOffset[0] * 0.0625, jitterOffset[1] * 0.0625, width, height);
                }
                var sampleWeight = baseSampleWeight;
                if (this.unbiased) {
                    var uniformCenteredDistribution = -0.5 + (i + 0.5) / jitterOffsets.length;
                    sampleWeight += roundingRange * uniformCenteredDistribution;
                }
                this.copyUniforms['opacity'].value = sampleWeight;
                renderer.setClearColor(this.clearColor, this.clearAlpha);
                renderer.setRenderTarget(this.sampleRenderTarget);
                renderer.clear();
                renderer.render(this.scene, this.camera);
                renderer.setRenderTarget(this.renderToScreen ? null : writeBuffer);
                if (i === 0) {
                    renderer.setClearColor(0, 0);
                    renderer.clear();
                }
                this.fsQuad.render(renderer);
            }
            if (this.camera.clearViewOffset)
                this.camera.clearViewOffset();
            renderer.autoClear = autoClear;
            renderer.setClearColor(oldClearColor, oldClearAlpha);
        }
    });
    SSAARenderPass.JitterVectors = [
        [[
                0,
                0
            ]],
        [
            [
                4,
                4
            ],
            [
                -4,
                -4
            ]
        ],
        [
            [
                -2,
                -6
            ],
            [
                6,
                -2
            ],
            [
                -6,
                2
            ],
            [
                2,
                6
            ]
        ],
        [
            [
                1,
                -3
            ],
            [
                -1,
                3
            ],
            [
                5,
                1
            ],
            [
                -3,
                -5
            ],
            [
                -5,
                5
            ],
            [
                -7,
                -1
            ],
            [
                3,
                7
            ],
            [
                7,
                -7
            ]
        ],
        [
            [
                1,
                1
            ],
            [
                -1,
                -3
            ],
            [
                -3,
                2
            ],
            [
                4,
                -1
            ],
            [
                -5,
                -2
            ],
            [
                2,
                5
            ],
            [
                5,
                3
            ],
            [
                3,
                -5
            ],
            [
                -2,
                6
            ],
            [
                0,
                -7
            ],
            [
                -4,
                -6
            ],
            [
                -6,
                4
            ],
            [
                -8,
                0
            ],
            [
                7,
                -4
            ],
            [
                6,
                7
            ],
            [
                -7,
                -8
            ]
        ],
        [
            [
                -4,
                -7
            ],
            [
                -7,
                -5
            ],
            [
                -3,
                -5
            ],
            [
                -5,
                -4
            ],
            [
                -1,
                -4
            ],
            [
                -2,
                -2
            ],
            [
                -6,
                -1
            ],
            [
                -4,
                0
            ],
            [
                -7,
                1
            ],
            [
                -1,
                2
            ],
            [
                -6,
                3
            ],
            [
                -3,
                3
            ],
            [
                -7,
                6
            ],
            [
                -3,
                6
            ],
            [
                -5,
                7
            ],
            [
                -1,
                7
            ],
            [
                5,
                -7
            ],
            [
                1,
                -6
            ],
            [
                6,
                -5
            ],
            [
                4,
                -4
            ],
            [
                2,
                -3
            ],
            [
                7,
                -2
            ],
            [
                1,
                -1
            ],
            [
                4,
                -1
            ],
            [
                2,
                1
            ],
            [
                6,
                2
            ],
            [
                0,
                4
            ],
            [
                4,
                4
            ],
            [
                2,
                5
            ],
            [
                7,
                5
            ],
            [
                5,
                6
            ],
            [
                3,
                7
            ]
        ]
    ];
    return threex.postprocessing.SSAARenderPass = SSAARenderPass;
});
define('skylark-threejs-ex/shaders/SSAOShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var SSAOShader = {
        defines: {
            'PERSPECTIVE_CAMERA': 1,
            'KERNEL_SIZE': 32
        },
        uniforms: {
            'tDiffuse': { value: null },
            'tNormal': { value: null },
            'tDepth': { value: null },
            'tNoise': { value: null },
            'kernel': { value: null },
            'cameraNear': { value: null },
            'cameraFar': { value: null },
            'resolution': { value: new THREE.Vector2() },
            'cameraProjectionMatrix': { value: new THREE.Matrix4() },
            'cameraInverseProjectionMatrix': { value: new THREE.Matrix4() },
            'kernelRadius': { value: 8 },
            'minDistance': { value: 0.005 },
            'maxDistance': { value: 0.05 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform sampler2D tNormal;',
            'uniform sampler2D tDepth;',
            'uniform sampler2D tNoise;',
            'uniform vec3 kernel[ KERNEL_SIZE ];',
            'uniform vec2 resolution;',
            'uniform float cameraNear;',
            'uniform float cameraFar;',
            'uniform mat4 cameraProjectionMatrix;',
            'uniform mat4 cameraInverseProjectionMatrix;',
            'uniform float kernelRadius;',
            'uniform float minDistance;',
            'uniform float maxDistance;',
            'varying vec2 vUv;',
            '#include <packing>',
            'float getDepth( const in vec2 screenPosition ) {',
            '\treturn texture2D( tDepth, screenPosition ).x;',
            '}',
            'float getLinearDepth( const in vec2 screenPosition ) {',
            '\t#if PERSPECTIVE_CAMERA == 1',
            '\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;',
            '\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );',
            '\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );',
            '\t#else',
            '\t\treturn texture2D( depthSampler, coord ).x;',
            '\t#endif',
            '}',
            'float getViewZ( const in float depth ) {',
            '\t#if PERSPECTIVE_CAMERA == 1',
            '\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );',
            '\t#else',
            '\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );',
            '\t#endif',
            '}',
            'vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {',
            '\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];',
            '\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );',
            '\tclipPosition *= clipW; // unprojection.',
            '\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;',
            '}',
            'vec3 getViewNormal( const in vec2 screenPosition ) {',
            '\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );',
            '}',
            'void main() {',
            '\tfloat depth = getDepth( vUv );',
            '\tfloat viewZ = getViewZ( depth );',
            '\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );',
            '\tvec3 viewNormal = getViewNormal( vUv );',
            ' vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );',
            '\tvec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;',
            '\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );',
            '\tvec3 bitangent = cross( viewNormal, tangent );',
            '\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );',
            ' float occlusion = 0.0;',
            ' for ( int i = 0; i < KERNEL_SIZE; i ++ ) {',
            '\t\tvec3 sampleVector = kernelMatrix * kernel[ i ];',
            '\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );',
            '\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );',
            '\t\tsamplePointNDC /= samplePointNDC.w;',
            '\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;',
            '\t\tfloat realDepth = getLinearDepth( samplePointUv );',
            '\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );',
            '\t\tfloat delta = sampleDepth - realDepth;',
            '\t\tif ( delta > minDistance && delta < maxDistance ) {',
            '\t\t\tocclusion += 1.0;',
            '\t\t}',
            '\t}',
            '\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );',
            '\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );',
            '}'
        ].join('\n')
    };

    return threex.shaders.SSAOShader = SSAOShader;
});
define('skylark-threejs-ex/postprocessing/SSAOPass',[
    "skylark-threejs",
    "../threex",
    './Pass',
    '../math/SimplexNoise',
    '../shaders/SSAOShader',
    '../shaders/CopyShader'
], function (
    THREE, 
    threex,
    Pass, 
    SimplexNoise, 
    SSAOShader, 
    CopyShader
) {
    'use strict';
    var SSAOPass = function (scene, camera, width, height) {
        Pass.call(this);
        this.width = width !== undefined ? width : 512;
        this.height = height !== undefined ? height : 512;
        this.clear = true;
        this.camera = camera;
        this.scene = scene;
        this.kernelRadius = 8;
        this.kernelSize = 32;
        this.kernel = [];
        this.noiseTexture = null;
        this.output = 0;
        this.minDistance = 0.005;
        this.maxDistance = 0.1;
        this.generateSampleKernel();
        this.generateRandomKernelRotations();
        var depthTexture = new THREE.DepthTexture();
        depthTexture.type = THREE.UnsignedShortType;
        depthTexture.minFilter = THREE.NearestFilter;
        depthTexture.maxFilter = THREE.NearestFilter;
        this.beautyRenderTarget = new THREE.WebGLRenderTarget(this.width, this.height, {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBAFormat,
            depthTexture: depthTexture,
            depthBuffer: true
        });
        this.normalRenderTarget = new THREE.WebGLRenderTarget(this.width, this.height, {
            minFilter: THREE.NearestFilter,
            magFilter: THREE.NearestFilter,
            format: THREE.RGBAFormat
        });
        this.ssaoRenderTarget = new THREE.WebGLRenderTarget(this.width, this.height, {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBAFormat
        });
        this.blurRenderTarget = this.ssaoRenderTarget.clone();
        if (SSAOShader === undefined) {
            console.error('THREE.SSAOPass: The pass relies on SSAOShader.');
        }
        this.ssaoMaterial = new THREE.ShaderMaterial({
            defines: Object.assign({}, SSAOShader.defines),
            uniforms: THREE.UniformsUtils.clone(SSAOShader.uniforms),
            vertexShader: SSAOShader.vertexShader,
            fragmentShader: SSAOShader.fragmentShader,
            blending: THREE.NoBlending
        });
        this.ssaoMaterial.uniforms['tDiffuse'].value = this.beautyRenderTarget.texture;
        this.ssaoMaterial.uniforms['tNormal'].value = this.normalRenderTarget.texture;
        this.ssaoMaterial.uniforms['tDepth'].value = this.beautyRenderTarget.depthTexture;
        this.ssaoMaterial.uniforms['tNoise'].value = this.noiseTexture;
        this.ssaoMaterial.uniforms['kernel'].value = this.kernel;
        this.ssaoMaterial.uniforms['cameraNear'].value = this.camera.near;
        this.ssaoMaterial.uniforms['cameraFar'].value = this.camera.far;
        this.ssaoMaterial.uniforms['resolution'].value.set(this.width, this.height);
        this.ssaoMaterial.uniforms['cameraProjectionMatrix'].value.copy(this.camera.projectionMatrix);
        this.ssaoMaterial.uniforms['cameraInverseProjectionMatrix'].value.getInverse(this.camera.projectionMatrix);
        this.normalMaterial = new THREE.MeshNormalMaterial();
        this.normalMaterial.blending = THREE.NoBlending;
        this.blurMaterial = new THREE.ShaderMaterial({
            defines: Object.assign({}, SSAOBlurShader.defines),
            uniforms: THREE.UniformsUtils.clone(SSAOBlurShader.uniforms),
            vertexShader: SSAOBlurShader.vertexShader,
            fragmentShader: SSAOBlurShader.fragmentShader
        });
        this.blurMaterial.uniforms['tDiffuse'].value = this.ssaoRenderTarget.texture;
        this.blurMaterial.uniforms['resolution'].value.set(this.width, this.height);
        this.depthRenderMaterial = new THREE.ShaderMaterial({
            defines: Object.assign({}, SSAODepthShader.defines),
            uniforms: THREE.UniformsUtils.clone(SSAODepthShader.uniforms),
            vertexShader: SSAODepthShader.vertexShader,
            fragmentShader: SSAODepthShader.fragmentShader,
            blending: THREE.NoBlending
        });
        this.depthRenderMaterial.uniforms['tDepth'].value = this.beautyRenderTarget.depthTexture;
        this.depthRenderMaterial.uniforms['cameraNear'].value = this.camera.near;
        this.depthRenderMaterial.uniforms['cameraFar'].value = this.camera.far;
        this.copyMaterial = new THREE.ShaderMaterial({
            uniforms: THREE.UniformsUtils.clone(CopyShader.uniforms),
            vertexShader: CopyShader.vertexShader,
            fragmentShader: CopyShader.fragmentShader,
            transparent: true,
            depthTest: false,
            depthWrite: false,
            blendSrc: THREE.DstColorFactor,
            blendDst: THREE.ZeroFactor,
            blendEquation: THREE.AddEquation,
            blendSrcAlpha: THREE.DstAlphaFactor,
            blendDstAlpha: THREE.ZeroFactor,
            blendEquationAlpha: THREE.AddEquation
        });
        this.fsQuad = new Pass.FullScreenQuad(null);
        this.originalClearColor = new THREE.Color();
    };
    SSAOPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: SSAOPass,
        dispose: function () {
            this.beautyRenderTarget.dispose();
            this.normalRenderTarget.dispose();
            this.ssaoRenderTarget.dispose();
            this.blurRenderTarget.dispose();
            this.normalMaterial.dispose();
            this.blurMaterial.dispose();
            this.copyMaterial.dispose();
            this.depthRenderMaterial.dispose();
            this.fsQuad.dispose();
        },
        render: function (renderer, writeBuffer) {
            renderer.setRenderTarget(this.beautyRenderTarget);
            renderer.clear();
            renderer.render(this.scene, this.camera);
            this.renderOverride(renderer, this.normalMaterial, this.normalRenderTarget, 7829503, 1);
            this.ssaoMaterial.uniforms['kernelRadius'].value = this.kernelRadius;
            this.ssaoMaterial.uniforms['minDistance'].value = this.minDistance;
            this.ssaoMaterial.uniforms['maxDistance'].value = this.maxDistance;
            this.renderPass(renderer, this.ssaoMaterial, this.ssaoRenderTarget);
            this.renderPass(renderer, this.blurMaterial, this.blurRenderTarget);
            switch (this.output) {
            case SSAOPass.OUTPUT.SSAO:
                this.copyMaterial.uniforms['tDiffuse'].value = this.ssaoRenderTarget.texture;
                this.copyMaterial.blending = THREE.NoBlending;
                this.renderPass(renderer, this.copyMaterial, this.renderToScreen ? null : writeBuffer);
                break;
            case SSAOPass.OUTPUT.Blur:
                this.copyMaterial.uniforms['tDiffuse'].value = this.blurRenderTarget.texture;
                this.copyMaterial.blending = THREE.NoBlending;
                this.renderPass(renderer, this.copyMaterial, this.renderToScreen ? null : writeBuffer);
                break;
            case SSAOPass.OUTPUT.Beauty:
                this.copyMaterial.uniforms['tDiffuse'].value = this.beautyRenderTarget.texture;
                this.copyMaterial.blending = THREE.NoBlending;
                this.renderPass(renderer, this.copyMaterial, this.renderToScreen ? null : writeBuffer);
                break;
            case SSAOPass.OUTPUT.Depth:
                this.renderPass(renderer, this.depthRenderMaterial, this.renderToScreen ? null : writeBuffer);
                break;
            case SSAOPass.OUTPUT.Normal:
                this.copyMaterial.uniforms['tDiffuse'].value = this.normalRenderTarget.texture;
                this.copyMaterial.blending = THREE.NoBlending;
                this.renderPass(renderer, this.copyMaterial, this.renderToScreen ? null : writeBuffer);
                break;
            case SSAOPass.OUTPUT.Default:
                this.copyMaterial.uniforms['tDiffuse'].value = this.beautyRenderTarget.texture;
                this.copyMaterial.blending = THREE.NoBlending;
                this.renderPass(renderer, this.copyMaterial, this.renderToScreen ? null : writeBuffer);
                this.copyMaterial.uniforms['tDiffuse'].value = this.blurRenderTarget.texture;
                this.copyMaterial.blending = THREE.CustomBlending;
                this.renderPass(renderer, this.copyMaterial, this.renderToScreen ? null : writeBuffer);
                break;
            default:
                console.warn('THREE.SSAOPass: Unknown output type.');
            }
        },
        renderPass: function (renderer, passMaterial, renderTarget, clearColor, clearAlpha) {
            this.originalClearColor.copy(renderer.getClearColor());
            var originalClearAlpha = renderer.getClearAlpha();
            var originalAutoClear = renderer.autoClear;
            renderer.setRenderTarget(renderTarget);
            renderer.autoClear = false;
            if (clearColor !== undefined && clearColor !== null) {
                renderer.setClearColor(clearColor);
                renderer.setClearAlpha(clearAlpha || 0);
                renderer.clear();
            }
            this.fsQuad.material = passMaterial;
            this.fsQuad.render(renderer);
            renderer.autoClear = originalAutoClear;
            renderer.setClearColor(this.originalClearColor);
            renderer.setClearAlpha(originalClearAlpha);
        },
        renderOverride: function (renderer, overrideMaterial, renderTarget, clearColor, clearAlpha) {
            this.originalClearColor.copy(renderer.getClearColor());
            var originalClearAlpha = renderer.getClearAlpha();
            var originalAutoClear = renderer.autoClear;
            renderer.setRenderTarget(renderTarget);
            renderer.autoClear = false;
            clearColor = overrideMaterial.clearColor || clearColor;
            clearAlpha = overrideMaterial.clearAlpha || clearAlpha;
            if (clearColor !== undefined && clearColor !== null) {
                renderer.setClearColor(clearColor);
                renderer.setClearAlpha(clearAlpha || 0);
                renderer.clear();
            }
            this.scene.overrideMaterial = overrideMaterial;
            renderer.render(this.scene, this.camera);
            this.scene.overrideMaterial = null;
            renderer.autoClear = originalAutoClear;
            renderer.setClearColor(this.originalClearColor);
            renderer.setClearAlpha(originalClearAlpha);
        },
        setSize: function (width, height) {
            this.width = width;
            this.height = height;
            this.beautyRenderTarget.setSize(width, height);
            this.ssaoRenderTarget.setSize(width, height);
            this.normalRenderTarget.setSize(width, height);
            this.blurRenderTarget.setSize(width, height);
            this.ssaoMaterial.uniforms['resolution'].value.set(width, height);
            this.ssaoMaterial.uniforms['cameraProjectionMatrix'].value.copy(this.camera.projectionMatrix);
            this.ssaoMaterial.uniforms['cameraInverseProjectionMatrix'].value.getInverse(this.camera.projectionMatrix);
            this.blurMaterial.uniforms['resolution'].value.set(width, height);
        },
        generateSampleKernel: function () {
            var kernelSize = this.kernelSize;
            var kernel = this.kernel;
            for (var i = 0; i < kernelSize; i++) {
                var sample = new THREE.Vector3();
                sample.x = Math.random() * 2 - 1;
                sample.y = Math.random() * 2 - 1;
                sample.z = Math.random();
                sample.normalize();
                var scale = i / kernelSize;
                scale = THREE.MathUtils.lerp(0.1, 1, scale * scale);
                sample.multiplyScalar(scale);
                kernel.push(sample);
            }
        },
        generateRandomKernelRotations: function () {
            var width = 4, height = 4;
            if (SimplexNoise === undefined) {
                console.error('THREE.SSAOPass: The pass relies on SimplexNoise.');
            }
            var simplex = new SimplexNoise();
            var size = width * height;
            var data = new Float32Array(size * 4);
            for (var i = 0; i < size; i++) {
                var stride = i * 4;
                var x = Math.random() * 2 - 1;
                var y = Math.random() * 2 - 1;
                var z = 0;
                var noise = simplex.noise3d(x, y, z);
                data[stride] = noise;
                data[stride + 1] = noise;
                data[stride + 2] = noise;
                data[stride + 3] = 1;
            }
            this.noiseTexture = new THREE.DataTexture(data, width, height, THREE.RGBAFormat, THREE.FloatType);
            this.noiseTexture.wrapS = THREE.RepeatWrapping;
            this.noiseTexture.wrapT = THREE.RepeatWrapping;
        }
    });
    SSAOPass.OUTPUT = {
        'Default': 0,
        'SSAO': 1,
        'Blur': 2,
        'Beauty': 3,
        'Depth': 4,
        'Normal': 5
    };
    return threex.postprocessing.SSAOPass = SSAOPass;
});
define('skylark-threejs-ex/postprocessing/TAARenderPass',[
    "skylark-threejs",
    "../threex",
    './SSAARenderPass'
], function (
    THREE, 
    threex,
    SSAARenderPass
) {
    'use strict';
    var TAARenderPass = function (scene, camera, clearColor, clearAlpha) {
        if (SSAARenderPass === undefined) {
            console.error('TAARenderPass relies on SSAARenderPass');
        }
        SSAARenderPass.call(this, scene, camera, clearColor, clearAlpha);
        this.sampleLevel = 0;
        this.accumulate = false;
    };
    TAARenderPass.JitterVectors = SSAARenderPass.JitterVectors;
    TAARenderPass.prototype = Object.assign(Object.create(SSAARenderPass.prototype), {
        constructor: TAARenderPass,
        render: function (renderer, writeBuffer, readBuffer, deltaTime) {
            if (!this.accumulate) {
                SSAARenderPass.prototype.render.call(this, renderer, writeBuffer, readBuffer, deltaTime);
                this.accumulateIndex = -1;
                return;
            }
            var jitterOffsets = TAARenderPass.JitterVectors[5];
            if (!this.sampleRenderTarget) {
                this.sampleRenderTarget = new THREE.WebGLRenderTarget(readBuffer.width, readBuffer.height, this.params);
                this.sampleRenderTarget.texture.name = 'TAARenderPass.sample';
            }
            if (!this.holdRenderTarget) {
                this.holdRenderTarget = new THREE.WebGLRenderTarget(readBuffer.width, readBuffer.height, this.params);
                this.holdRenderTarget.texture.name = 'TAARenderPass.hold';
            }
            if (this.accumulate && this.accumulateIndex === -1) {
                SSAARenderPass.prototype.render.call(this, renderer, this.holdRenderTarget, readBuffer, deltaTime);
                this.accumulateIndex = 0;
            }
            var autoClear = renderer.autoClear;
            renderer.autoClear = false;
            var sampleWeight = 1 / jitterOffsets.length;
            if (this.accumulateIndex >= 0 && this.accumulateIndex < jitterOffsets.length) {
                this.copyUniforms['opacity'].value = sampleWeight;
                this.copyUniforms['tDiffuse'].value = writeBuffer.texture;
                var numSamplesPerFrame = Math.pow(2, this.sampleLevel);
                for (var i = 0; i < numSamplesPerFrame; i++) {
                    var j = this.accumulateIndex;
                    var jitterOffset = jitterOffsets[j];
                    if (this.camera.setViewOffset) {
                        this.camera.setViewOffset(readBuffer.width, readBuffer.height, jitterOffset[0] * 0.0625, jitterOffset[1] * 0.0625, readBuffer.width, readBuffer.height);
                    }
                    renderer.setRenderTarget(writeBuffer);
                    renderer.clear();
                    renderer.render(this.scene, this.camera);
                    renderer.setRenderTarget(this.sampleRenderTarget);
                    if (this.accumulateIndex === 0)
                        renderer.clear();
                    this.fsQuad.render(renderer);
                    this.accumulateIndex++;
                    if (this.accumulateIndex >= jitterOffsets.length)
                        break;
                }
                if (this.camera.clearViewOffset)
                    this.camera.clearViewOffset();
            }
            var accumulationWeight = this.accumulateIndex * sampleWeight;
            if (accumulationWeight > 0) {
                this.copyUniforms['opacity'].value = 1;
                this.copyUniforms['tDiffuse'].value = this.sampleRenderTarget.texture;
                renderer.setRenderTarget(writeBuffer);
                renderer.clear();
                this.fsQuad.render(renderer);
            }
            if (accumulationWeight < 1) {
                this.copyUniforms['opacity'].value = 1 - accumulationWeight;
                this.copyUniforms['tDiffuse'].value = this.holdRenderTarget.texture;
                renderer.setRenderTarget(writeBuffer);
                if (accumulationWeight === 0)
                    renderer.clear();
                this.fsQuad.render(renderer);
            }
            renderer.autoClear = autoClear;
        }
    });
    return threex.postprocessing.TAARenderPass = TAARenderPass;
});
define('skylark-threejs-ex/postprocessing/TexturePass',[
    "skylark-threejs",
    "../threex",
    '../postprocessing/Pass',
    '../shaders/CopyShader'
], function (
    THREE, 
    threex,
    Pass, 
    CopyShader
) {
    'use strict';
    var TexturePass = function (map, opacity) {
        Pass.call(this);
        if (CopyShader === undefined)
            console.error('TexturePass relies on CopyShader');
        var shader = CopyShader;
        this.map = map;
        this.opacity = opacity !== undefined ? opacity : 1;
        this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);
        this.material = new THREE.ShaderMaterial({
            uniforms: this.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader,
            depthTest: false,
            depthWrite: false
        });
        this.needsSwap = false;
        this.fsQuad = new Pass.FullScreenQuad(null);
    };
    TexturePass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: TexturePass,
        render: function (renderer, writeBuffer, readBuffer) {
            var oldAutoClear = renderer.autoClear;
            renderer.autoClear = false;
            this.fsQuad.material = this.material;
            this.uniforms['opacity'].value = this.opacity;
            this.uniforms['tDiffuse'].value = this.map;
            this.material.transparent = this.opacity < 1;
            renderer.setRenderTarget(this.renderToScreen ? null : readBuffer);
            if (this.clear)
                renderer.clear();
            this.fsQuad.render(renderer);
            renderer.autoClear = oldAutoClear;
        }
    });
    return threex.postprocessing.TexturePass = TexturePass;
});
define('skylark-threejs-ex/shaders/LuminosityHighPassShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var LuminosityHighPassShader = {
        shaderID: 'luminosityHighPass',
        uniforms: {
            'tDiffuse': { value: null },
            'luminosityThreshold': { value: 1 },
            'smoothWidth': { value: 1 },
            'defaultColor': { value: new THREE.Color(0) },
            'defaultOpacity': { value: 0 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform vec3 defaultColor;',
            'uniform float defaultOpacity;',
            'uniform float luminosityThreshold;',
            'uniform float smoothWidth;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 texel = texture2D( tDiffuse, vUv );',
            '\tvec3 luma = vec3( 0.299, 0.587, 0.114 );',
            '\tfloat v = dot( texel.xyz, luma );',
            '\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );',
            '\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );',
            '\tgl_FragColor = mix( outputColor, texel, alpha );',
            '}'
        ].join('\n')
    };
    return threex.shaders.LuminosityHighPassShader = LuminosityHighPassShader;
});
define('skylark-threejs-ex/postprocessing/UnrealBloomPass',[
    "skylark-threejs",
    "../threex",
    './Pass',
    '../shaders/CopyShader',
    '../shaders/LuminosityHighPassShader'
], function (
    THREE, 
    threex,
    Pass, 
    CopyShader, 
    LuminosityHighPassShader
) {
    'use strict';
    var UnrealBloomPass = function (resolution, strength, radius, threshold) {
        Pass.call(this);
        this.strength = strength !== undefined ? strength : 1;
        this.radius = radius;
        this.threshold = threshold;
        this.resolution = resolution !== undefined ? new THREE.Vector2(resolution.x, resolution.y) : new THREE.Vector2(256, 256);
        this.clearColor = new THREE.Color(0, 0, 0);
        var pars = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBAFormat
        };
        this.renderTargetsHorizontal = [];
        this.renderTargetsVertical = [];
        this.nMips = 5;
        var resx = Math.round(this.resolution.x / 2);
        var resy = Math.round(this.resolution.y / 2);
        this.renderTargetBright = new THREE.WebGLRenderTarget(resx, resy, pars);
        this.renderTargetBright.texture.name = 'UnrealBloomPass.bright';
        this.renderTargetBright.texture.generateMipmaps = false;
        for (var i = 0; i < this.nMips; i++) {
            var renderTargetHorizonal = new THREE.WebGLRenderTarget(resx, resy, pars);
            renderTargetHorizonal.texture.name = 'UnrealBloomPass.h' + i;
            renderTargetHorizonal.texture.generateMipmaps = false;
            this.renderTargetsHorizontal.push(renderTargetHorizonal);
            var renderTargetVertical = new THREE.WebGLRenderTarget(resx, resy, pars);
            renderTargetVertical.texture.name = 'UnrealBloomPass.v' + i;
            renderTargetVertical.texture.generateMipmaps = false;
            this.renderTargetsVertical.push(renderTargetVertical);
            resx = Math.round(resx / 2);
            resy = Math.round(resy / 2);
        }
        if (LuminosityHighPassShader === undefined)
            console.error('UnrealBloomPass relies on LuminosityHighPassShader');
        var highPassShader = LuminosityHighPassShader;
        this.highPassUniforms = THREE.UniformsUtils.clone(highPassShader.uniforms);
        this.highPassUniforms['luminosityThreshold'].value = threshold;
        this.highPassUniforms['smoothWidth'].value = 0.01;
        this.materialHighPassFilter = new THREE.ShaderMaterial({
            uniforms: this.highPassUniforms,
            vertexShader: highPassShader.vertexShader,
            fragmentShader: highPassShader.fragmentShader,
            defines: {}
        });
        this.separableBlurMaterials = [];
        var kernelSizeArray = [
            3,
            5,
            7,
            9,
            11
        ];
        var resx = Math.round(this.resolution.x / 2);
        var resy = Math.round(this.resolution.y / 2);
        for (var i = 0; i < this.nMips; i++) {
            this.separableBlurMaterials.push(this.getSeperableBlurMaterial(kernelSizeArray[i]));
            this.separableBlurMaterials[i].uniforms['texSize'].value = new THREE.Vector2(resx, resy);
            resx = Math.round(resx / 2);
            resy = Math.round(resy / 2);
        }
        this.compositeMaterial = this.getCompositeMaterial(this.nMips);
        this.compositeMaterial.uniforms['blurTexture1'].value = this.renderTargetsVertical[0].texture;
        this.compositeMaterial.uniforms['blurTexture2'].value = this.renderTargetsVertical[1].texture;
        this.compositeMaterial.uniforms['blurTexture3'].value = this.renderTargetsVertical[2].texture;
        this.compositeMaterial.uniforms['blurTexture4'].value = this.renderTargetsVertical[3].texture;
        this.compositeMaterial.uniforms['blurTexture5'].value = this.renderTargetsVertical[4].texture;
        this.compositeMaterial.uniforms['bloomStrength'].value = strength;
        this.compositeMaterial.uniforms['bloomRadius'].value = 0.1;
        this.compositeMaterial.needsUpdate = true;
        var bloomFactors = [
            1,
            0.8,
            0.6,
            0.4,
            0.2
        ];
        this.compositeMaterial.uniforms['bloomFactors'].value = bloomFactors;
        this.bloomTintColors = [
            new THREE.Vector3(1, 1, 1),
            new THREE.Vector3(1, 1, 1),
            new THREE.Vector3(1, 1, 1),
            new THREE.Vector3(1, 1, 1),
            new THREE.Vector3(1, 1, 1)
        ];
        this.compositeMaterial.uniforms['bloomTintColors'].value = this.bloomTintColors;
        if (CopyShader === undefined) {
            console.error('UnrealBloomPass relies on CopyShader');
        }
        var copyShader = CopyShader;
        this.copyUniforms = THREE.UniformsUtils.clone(copyShader.uniforms);
        this.copyUniforms['opacity'].value = 1;
        this.materialCopy = new THREE.ShaderMaterial({
            uniforms: this.copyUniforms,
            vertexShader: copyShader.vertexShader,
            fragmentShader: copyShader.fragmentShader,
            blending: THREE.AdditiveBlending,
            depthTest: false,
            depthWrite: false,
            transparent: true
        });
        this.enabled = true;
        this.needsSwap = false;
        this.oldClearColor = new THREE.Color();
        this.oldClearAlpha = 1;
        this.basic = new THREE.MeshBasicMaterial();
        this.fsQuad = new Pass.FullScreenQuad(null);
    };
    UnrealBloomPass.prototype = Object.assign(Object.create(Pass.prototype), {
        constructor: UnrealBloomPass,
        dispose: function () {
            for (var i = 0; i < this.renderTargetsHorizontal.length; i++) {
                this.renderTargetsHorizontal[i].dispose();
            }
            for (var i = 0; i < this.renderTargetsVertical.length; i++) {
                this.renderTargetsVertical[i].dispose();
            }
            this.renderTargetBright.dispose();
        },
        setSize: function (width, height) {
            var resx = Math.round(width / 2);
            var resy = Math.round(height / 2);
            this.renderTargetBright.setSize(resx, resy);
            for (var i = 0; i < this.nMips; i++) {
                this.renderTargetsHorizontal[i].setSize(resx, resy);
                this.renderTargetsVertical[i].setSize(resx, resy);
                this.separableBlurMaterials[i].uniforms['texSize'].value = new THREE.Vector2(resx, resy);
                resx = Math.round(resx / 2);
                resy = Math.round(resy / 2);
            }
        },
        render: function (renderer, writeBuffer, readBuffer, deltaTime, maskActive) {
            this.oldClearColor.copy(renderer.getClearColor());
            this.oldClearAlpha = renderer.getClearAlpha();
            var oldAutoClear = renderer.autoClear;
            renderer.autoClear = false;
            renderer.setClearColor(this.clearColor, 0);
            if (maskActive)
                renderer.state.buffers.stencil.setTest(false);
            if (this.renderToScreen) {
                this.fsQuad.material = this.basic;
                this.basic.map = readBuffer.texture;
                renderer.setRenderTarget(null);
                renderer.clear();
                this.fsQuad.render(renderer);
            }
            this.highPassUniforms['tDiffuse'].value = readBuffer.texture;
            this.highPassUniforms['luminosityThreshold'].value = this.threshold;
            this.fsQuad.material = this.materialHighPassFilter;
            renderer.setRenderTarget(this.renderTargetBright);
            renderer.clear();
            this.fsQuad.render(renderer);
            var inputRenderTarget = this.renderTargetBright;
            for (var i = 0; i < this.nMips; i++) {
                this.fsQuad.material = this.separableBlurMaterials[i];
                this.separableBlurMaterials[i].uniforms['colorTexture'].value = inputRenderTarget.texture;
                this.separableBlurMaterials[i].uniforms['direction'].value = UnrealBloomPass.BlurDirectionX;
                renderer.setRenderTarget(this.renderTargetsHorizontal[i]);
                renderer.clear();
                this.fsQuad.render(renderer);
                this.separableBlurMaterials[i].uniforms['colorTexture'].value = this.renderTargetsHorizontal[i].texture;
                this.separableBlurMaterials[i].uniforms['direction'].value = UnrealBloomPass.BlurDirectionY;
                renderer.setRenderTarget(this.renderTargetsVertical[i]);
                renderer.clear();
                this.fsQuad.render(renderer);
                inputRenderTarget = this.renderTargetsVertical[i];
            }
            this.fsQuad.material = this.compositeMaterial;
            this.compositeMaterial.uniforms['bloomStrength'].value = this.strength;
            this.compositeMaterial.uniforms['bloomRadius'].value = this.radius;
            this.compositeMaterial.uniforms['bloomTintColors'].value = this.bloomTintColors;
            renderer.setRenderTarget(this.renderTargetsHorizontal[0]);
            renderer.clear();
            this.fsQuad.render(renderer);
            this.fsQuad.material = this.materialCopy;
            this.copyUniforms['tDiffuse'].value = this.renderTargetsHorizontal[0].texture;
            if (maskActive)
                renderer.state.buffers.stencil.setTest(true);
            if (this.renderToScreen) {
                renderer.setRenderTarget(null);
                this.fsQuad.render(renderer);
            } else {
                renderer.setRenderTarget(readBuffer);
                this.fsQuad.render(renderer);
            }
            renderer.setClearColor(this.oldClearColor, this.oldClearAlpha);
            renderer.autoClear = oldAutoClear;
        },
        getSeperableBlurMaterial: function (kernelRadius) {
            return new THREE.ShaderMaterial({
                defines: {
                    'KERNEL_RADIUS': kernelRadius,
                    'SIGMA': kernelRadius
                },
                uniforms: {
                    'colorTexture': { value: null },
                    'texSize': { value: new THREE.Vector2(0.5, 0.5) },
                    'direction': { value: new THREE.Vector2(0.5, 0.5) }
                },
                vertexShader: 'varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}',
                fragmentShader: '#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}'
            });
        },
        getCompositeMaterial: function (nMips) {
            return new THREE.ShaderMaterial({
                defines: { 'NUM_MIPS': nMips },
                uniforms: {
                    'blurTexture1': { value: null },
                    'blurTexture2': { value: null },
                    'blurTexture3': { value: null },
                    'blurTexture4': { value: null },
                    'blurTexture5': { value: null },
                    'dirtTexture': { value: null },
                    'bloomStrength': { value: 1 },
                    'bloomFactors': { value: null },
                    'bloomTintColors': { value: null },
                    'bloomRadius': { value: 0 }
                },
                vertexShader: 'varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}',
                fragmentShader: 'varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}'
            });
        }
    });
    UnrealBloomPass.BlurDirectionX = new THREE.Vector2(1, 0);
    UnrealBloomPass.BlurDirectionY = new THREE.Vector2(0, 1);

    return threex.postprocessing.UnrealBloomPass = UnrealBloomPass;
});
define('skylark-threejs-ex/renderers/CSS2DRenderer',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';

    var CSS2DObject = function (element) {
        THREE.Object3D.call(this);
        this.element = element;
        this.element.style.position = 'absolute';
        this.addEventListener('removed', function () {
            this.traverse(function (object) {
                if (object.element instanceof Element && object.element.parentNode !== null) {
                    object.element.parentNode.removeChild(object.element);
                }
            });
        });
    };
    CSS2DObject.prototype = Object.create(THREE.Object3D.prototype);
    CSS2DObject.prototype.constructor = CSS2DObject;


    var CSS2DRenderer = function () {
        var _this = this;
        var _width, _height;
        var _widthHalf, _heightHalf;
        var vector = new THREE.Vector3();
        var viewMatrix = new THREE.Matrix4();
        var viewProjectionMatrix = new THREE.Matrix4();
        var cache = { objects: new WeakMap() };
        var domElement = document.createElement('div');
        domElement.style.overflow = 'hidden';
        this.domElement = domElement;
        this.getSize = function () {
            return {
                width: _width,
                height: _height
            };
        };
        this.setSize = function (width, height) {
            _width = width;
            _height = height;
            _widthHalf = _width / 2;
            _heightHalf = _height / 2;
            domElement.style.width = width + 'px';
            domElement.style.height = height + 'px';
        };
        var renderObject = function (object, scene, camera) {
            if (object instanceof CSS2DObject) {
                object.onBeforeRender(_this, scene, camera);
                vector.setFromMatrixPosition(object.matrixWorld);
                vector.applyMatrix4(viewProjectionMatrix);
                var element = object.element;
                var style = 'translate(-50%,-50%) translate(' + (vector.x * _widthHalf + _widthHalf) + 'px,' + (-vector.y * _heightHalf + _heightHalf) + 'px)';
                element.style.WebkitTransform = style;
                element.style.MozTransform = style;
                element.style.oTransform = style;
                element.style.transform = style;
                element.style.display = object.visible && vector.z >= -1 && vector.z <= 1 ? '' : 'none';
                var objectData = { distanceToCameraSquared: getDistanceToSquared(camera, object) };
                cache.objects.set(object, objectData);
                if (element.parentNode !== domElement) {
                    domElement.appendChild(element);
                }
                object.onAfterRender(_this, scene, camera);
            }
            for (var i = 0, l = object.children.length; i < l; i++) {
                renderObject(object.children[i], scene, camera);
            }
        };
        var getDistanceToSquared = function () {
            var a = new THREE.Vector3();
            var b = new THREE.Vector3();
            return function (object1, object2) {
                a.setFromMatrixPosition(object1.matrixWorld);
                b.setFromMatrixPosition(object2.matrixWorld);
                return a.distanceToSquared(b);
            };
        }();
        var filterAndFlatten = function (scene) {
            var result = [];
            scene.traverse(function (object) {
                if (object instanceof CSS2DObject)
                    result.push(object);
            });
            return result;
        };
        var zOrder = function (scene) {
            var sorted = filterAndFlatten(scene).sort(function (a, b) {
                var distanceA = cache.objects.get(a).distanceToCameraSquared;
                var distanceB = cache.objects.get(b).distanceToCameraSquared;
                return distanceA - distanceB;
            });
            var zMax = sorted.length;
            for (var i = 0, l = sorted.length; i < l; i++) {
                sorted[i].element.style.zIndex = zMax - i;
            }
        };
        this.render = function (scene, camera) {
            if (scene.autoUpdate === true)
                scene.updateMatrixWorld();
            if (camera.parent === null)
                camera.updateMatrixWorld();
            viewMatrix.copy(camera.matrixWorldInverse);
            viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, viewMatrix);
            renderObject(scene, scene, camera);
            zOrder(scene);
        };
    };

    CSS2DRenderer.CSS2DObject = CSS2DObject;
    
    return   threex.renderers.CSS2DRenderer = CSS2DRenderer;
});
define('skylark-threejs-ex/renderers/CSS3DRenderer',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var CSS3DObject = function (element) {
        THREE.Object3D.call(this);
        this.element = element;
        this.element.style.position = 'absolute';
        this.element.style.pointerEvents = 'auto';
        this.addEventListener('removed', function () {
            this.traverse(function (object) {
                if (object.element instanceof Element && object.element.parentNode !== null) {
                    object.element.parentNode.removeChild(object.element);
                }
            });
        });
    };
    CSS3DObject.prototype = Object.create(THREE.Object3D.prototype);
    CSS3DObject.prototype.constructor = CSS3DObject;
    var CSS3DSprite = function (element) {
        CSS3DObject.call(this, element);
    };
    CSS3DSprite.prototype = Object.create(CSS3DObject.prototype);
    CSS3DSprite.prototype.constructor = CSS3DSprite;
    var CSS3DRenderer = function () {
        var _this = this;
        var _width, _height;
        var _widthHalf, _heightHalf;
        var matrix = new THREE.Matrix4();
        var cache = {
            camera: {
                fov: 0,
                style: ''
            },
            objects: new WeakMap()
        };
        var domElement = document.createElement('div');
        domElement.style.overflow = 'hidden';
        this.domElement = domElement;
        var cameraElement = document.createElement('div');
        cameraElement.style.WebkitTransformStyle = 'preserve-3d';
        cameraElement.style.transformStyle = 'preserve-3d';
        cameraElement.style.pointerEvents = 'none';
        domElement.appendChild(cameraElement);
        var isIE = /Trident/i.test(navigator.userAgent);
        this.getSize = function () {
            return {
                width: _width,
                height: _height
            };
        };
        this.setSize = function (width, height) {
            _width = width;
            _height = height;
            _widthHalf = _width / 2;
            _heightHalf = _height / 2;
            domElement.style.width = width + 'px';
            domElement.style.height = height + 'px';
            cameraElement.style.width = width + 'px';
            cameraElement.style.height = height + 'px';
        };
        function epsilon(value) {
            return Math.abs(value) < 1e-10 ? 0 : value;
        }
        function getCameraCSSMatrix(matrix) {
            var elements = matrix.elements;
            return 'matrix3d(' + epsilon(elements[0]) + ',' + epsilon(-elements[1]) + ',' + epsilon(elements[2]) + ',' + epsilon(elements[3]) + ',' + epsilon(elements[4]) + ',' + epsilon(-elements[5]) + ',' + epsilon(elements[6]) + ',' + epsilon(elements[7]) + ',' + epsilon(elements[8]) + ',' + epsilon(-elements[9]) + ',' + epsilon(elements[10]) + ',' + epsilon(elements[11]) + ',' + epsilon(elements[12]) + ',' + epsilon(-elements[13]) + ',' + epsilon(elements[14]) + ',' + epsilon(elements[15]) + ')';
        }
        function getObjectCSSMatrix(matrix, cameraCSSMatrix) {
            var elements = matrix.elements;
            var matrix3d = 'matrix3d(' + epsilon(elements[0]) + ',' + epsilon(elements[1]) + ',' + epsilon(elements[2]) + ',' + epsilon(elements[3]) + ',' + epsilon(-elements[4]) + ',' + epsilon(-elements[5]) + ',' + epsilon(-elements[6]) + ',' + epsilon(-elements[7]) + ',' + epsilon(elements[8]) + ',' + epsilon(elements[9]) + ',' + epsilon(elements[10]) + ',' + epsilon(elements[11]) + ',' + epsilon(elements[12]) + ',' + epsilon(elements[13]) + ',' + epsilon(elements[14]) + ',' + epsilon(elements[15]) + ')';
            if (isIE) {
                return 'translate(-50%,-50%)' + 'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)' + cameraCSSMatrix + matrix3d;
            }
            return 'translate(-50%,-50%)' + matrix3d;
        }
        function renderObject(object, scene, camera, cameraCSSMatrix) {
            if (object instanceof CSS3DObject) {
                object.onBeforeRender(_this, scene, camera);
                var style;
                if (object instanceof CSS3DSprite) {
                    matrix.copy(camera.matrixWorldInverse);
                    matrix.transpose();
                    matrix.copyPosition(object.matrixWorld);
                    matrix.scale(object.scale);
                    matrix.elements[3] = 0;
                    matrix.elements[7] = 0;
                    matrix.elements[11] = 0;
                    matrix.elements[15] = 1;
                    style = getObjectCSSMatrix(matrix, cameraCSSMatrix);
                } else {
                    style = getObjectCSSMatrix(object.matrixWorld, cameraCSSMatrix);
                }
                var element = object.element;
                var cachedObject = cache.objects.get(object);
                if (cachedObject === undefined || cachedObject.style !== style) {
                    element.style.WebkitTransform = style;
                    element.style.transform = style;
                    var objectData = { style: style };
                    if (isIE) {
                        objectData.distanceToCameraSquared = getDistanceToSquared(camera, object);
                    }
                    cache.objects.set(object, objectData);
                }
                if (element.parentNode !== cameraElement) {
                    cameraElement.appendChild(element);
                }
                object.onAfterRender(_this, scene, camera);
            }
            for (var i = 0, l = object.children.length; i < l; i++) {
                renderObject(object.children[i], scene, camera, cameraCSSMatrix);
            }
        }
        var getDistanceToSquared = function () {
            var a = new THREE.Vector3();
            var b = new THREE.Vector3();
            return function (object1, object2) {
                a.setFromMatrixPosition(object1.matrixWorld);
                b.setFromMatrixPosition(object2.matrixWorld);
                return a.distanceToSquared(b);
            };
        }();
        function filterAndFlatten(scene) {
            var result = [];
            scene.traverse(function (object) {
                if (object instanceof CSS3DObject)
                    result.push(object);
            });
            return result;
        }
        function zOrder(scene) {
            var sorted = filterAndFlatten(scene).sort(function (a, b) {
                var distanceA = cache.objects.get(a).distanceToCameraSquared;
                var distanceB = cache.objects.get(b).distanceToCameraSquared;
                return distanceA - distanceB;
            });
            var zMax = sorted.length;
            for (var i = 0, l = sorted.length; i < l; i++) {
                sorted[i].element.style.zIndex = zMax - i;
            }
        }
        this.render = function (scene, camera) {
            var fov = camera.projectionMatrix.elements[5] * _heightHalf;
            if (cache.camera.fov !== fov) {
                if (camera.isPerspectiveCamera) {
                    domElement.style.WebkitPerspective = fov + 'px';
                    domElement.style.perspective = fov + 'px';
                } else {
                    domElement.style.WebkitPerspective = '';
                    domElement.style.perspective = '';
                }
                cache.camera.fov = fov;
            }
            if (scene.autoUpdate === true)
                scene.updateMatrixWorld();
            if (camera.parent === null)
                camera.updateMatrixWorld();
            if (camera.isOrthographicCamera) {
                var tx = -(camera.right + camera.left) / 2;
                var ty = (camera.top + camera.bottom) / 2;
            }
            var cameraCSSMatrix = camera.isOrthographicCamera ? 'scale(' + fov + ')' + 'translate(' + epsilon(tx) + 'px,' + epsilon(ty) + 'px)' + getCameraCSSMatrix(camera.matrixWorldInverse) : 'translateZ(' + fov + 'px)' + getCameraCSSMatrix(camera.matrixWorldInverse);
            var style = cameraCSSMatrix + 'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)';
            if (cache.camera.style !== style && !isIE) {
                cameraElement.style.WebkitTransform = style;
                cameraElement.style.transform = style;
                cache.camera.style = style;
            }
            renderObject(scene, scene, camera, cameraCSSMatrix);
            if (isIE) {
                zOrder(scene);
            }
        };
    };

    CSS3DRenderer.CSS3DObject = CSS3DObject;
    CSS3DRenderer.CSS3DSprite = CSS3DSprite;

    return threex.renderers.CSS3DRenderer = CSS3DRenderer;
});
define('skylark-threejs-ex/renderers/Projector',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var RenderableObject = function () {
        this.id = 0;
        this.object = null;
        this.z = 0;
        this.renderOrder = 0;
    };
    var RenderableFace = function () {
        this.id = 0;
        this.v1 = new RenderableVertex();
        this.v2 = new RenderableVertex();
        this.v3 = new RenderableVertex();
        this.normalModel = new THREE.Vector3();
        this.vertexNormalsModel = [
            new THREE.Vector3(),
            new THREE.Vector3(),
            new THREE.Vector3()
        ];
        this.vertexNormalsLength = 0;
        this.color = new THREE.Color();
        this.material = null;
        this.uvs = [
            new THREE.Vector2(),
            new THREE.Vector2(),
            new THREE.Vector2()
        ];
        this.z = 0;
        this.renderOrder = 0;
    };
    var RenderableVertex = function () {
        this.position = new THREE.Vector3();
        this.positionWorld = new THREE.Vector3();
        this.positionScreen = new THREE.Vector4();
        this.visible = true;
    };
    RenderableVertex.prototype.copy = function (vertex) {
        this.positionWorld.copy(vertex.positionWorld);
        this.positionScreen.copy(vertex.positionScreen);
    };
    var RenderableLine = function () {
        this.id = 0;
        this.v1 = new RenderableVertex();
        this.v2 = new RenderableVertex();
        this.vertexColors = [
            new THREE.Color(),
            new THREE.Color()
        ];
        this.material = null;
        this.z = 0;
        this.renderOrder = 0;
    };
    var RenderableSprite = function () {
        this.id = 0;
        this.object = null;
        this.x = 0;
        this.y = 0;
        this.z = 0;
        this.rotation = 0;
        this.scale = new THREE.Vector2();
        this.material = null;
        this.renderOrder = 0;
    };
    var Projector = function () {
        var _object, _objectCount, _objectPool = [], _objectPoolLength = 0, _vertex, _vertexCount, _vertexPool = [], _vertexPoolLength = 0, _face, _faceCount, _facePool = [], _facePoolLength = 0, _line, _lineCount, _linePool = [], _linePoolLength = 0, _sprite, _spriteCount, _spritePool = [], _spritePoolLength = 0, _renderData = {
                objects: [],
                lights: [],
                elements: []
            }, _vector3 = new THREE.Vector3(), _vector4 = new THREE.Vector4(), _clipBox = new THREE.Box3(new THREE.Vector3(-1, -1, -1), new THREE.Vector3(1, 1, 1)), _boundingBox = new THREE.Box3(), _points3 = new Array(3), _viewMatrix = new THREE.Matrix4(), _viewProjectionMatrix = new THREE.Matrix4(), _modelMatrix, _modelViewProjectionMatrix = new THREE.Matrix4(), _normalMatrix = new THREE.Matrix3(), _frustum = new THREE.Frustum(), _clippedVertex1PositionScreen = new THREE.Vector4(), _clippedVertex2PositionScreen = new THREE.Vector4();
        this.projectVector = function (vector, camera) {
            console.warn('THREE.Projector: .projectVector() is now vector.project().');
            vector.project(camera);
        };
        this.unprojectVector = function (vector, camera) {
            console.warn('THREE.Projector: .unprojectVector() is now vector.unproject().');
            vector.unproject(camera);
        };
        this.pickingRay = function () {
            console.error('THREE.Projector: .pickingRay() is now raycaster.setFromCamera().');
        };
        var RenderList = function () {
            var normals = [];
            var colors = [];
            var uvs = [];
            var object = null;
            var normalMatrix = new THREE.Matrix3();
            function setObject(value) {
                object = value;
                normalMatrix.getNormalMatrix(object.matrixWorld);
                normals.length = 0;
                colors.length = 0;
                uvs.length = 0;
            }
            function projectVertex(vertex) {
                var position = vertex.position;
                var positionWorld = vertex.positionWorld;
                var positionScreen = vertex.positionScreen;
                positionWorld.copy(position).applyMatrix4(_modelMatrix);
                positionScreen.copy(positionWorld).applyMatrix4(_viewProjectionMatrix);
                var invW = 1 / positionScreen.w;
                positionScreen.x *= invW;
                positionScreen.y *= invW;
                positionScreen.z *= invW;
                vertex.visible = positionScreen.x >= -1 && positionScreen.x <= 1 && positionScreen.y >= -1 && positionScreen.y <= 1 && positionScreen.z >= -1 && positionScreen.z <= 1;
            }
            function pushVertex(x, y, z) {
                _vertex = getNextVertexInPool();
                _vertex.position.set(x, y, z);
                projectVertex(_vertex);
            }
            function pushNormal(x, y, z) {
                normals.push(x, y, z);
            }
            function pushColor(r, g, b) {
                colors.push(r, g, b);
            }
            function pushUv(x, y) {
                uvs.push(x, y);
            }
            function checkTriangleVisibility(v1, v2, v3) {
                if (v1.visible === true || v2.visible === true || v3.visible === true)
                    return true;
                _points3[0] = v1.positionScreen;
                _points3[1] = v2.positionScreen;
                _points3[2] = v3.positionScreen;
                return _clipBox.intersectsBox(_boundingBox.setFromPoints(_points3));
            }
            function checkBackfaceCulling(v1, v2, v3) {
                return (v3.positionScreen.x - v1.positionScreen.x) * (v2.positionScreen.y - v1.positionScreen.y) - (v3.positionScreen.y - v1.positionScreen.y) * (v2.positionScreen.x - v1.positionScreen.x) < 0;
            }
            function pushLine(a, b) {
                var v1 = _vertexPool[a];
                var v2 = _vertexPool[b];
                v1.positionScreen.copy(v1.position).applyMatrix4(_modelViewProjectionMatrix);
                v2.positionScreen.copy(v2.position).applyMatrix4(_modelViewProjectionMatrix);
                if (clipLine(v1.positionScreen, v2.positionScreen) === true) {
                    v1.positionScreen.multiplyScalar(1 / v1.positionScreen.w);
                    v2.positionScreen.multiplyScalar(1 / v2.positionScreen.w);
                    _line = getNextLineInPool();
                    _line.id = object.id;
                    _line.v1.copy(v1);
                    _line.v2.copy(v2);
                    _line.z = Math.max(v1.positionScreen.z, v2.positionScreen.z);
                    _line.renderOrder = object.renderOrder;
                    _line.material = object.material;
                    if (object.material.vertexColors) {
                        _line.vertexColors[0].fromArray(colors, a * 3);
                        _line.vertexColors[1].fromArray(colors, b * 3);
                    }
                    _renderData.elements.push(_line);
                }
            }
            function pushTriangle(a, b, c, material) {
                var v1 = _vertexPool[a];
                var v2 = _vertexPool[b];
                var v3 = _vertexPool[c];
                if (checkTriangleVisibility(v1, v2, v3) === false)
                    return;
                if (material.side === THREE.DoubleSide || checkBackfaceCulling(v1, v2, v3) === true) {
                    _face = getNextFaceInPool();
                    _face.id = object.id;
                    _face.v1.copy(v1);
                    _face.v2.copy(v2);
                    _face.v3.copy(v3);
                    _face.z = (v1.positionScreen.z + v2.positionScreen.z + v3.positionScreen.z) / 3;
                    _face.renderOrder = object.renderOrder;
                    _vector3.subVectors(v3.position, v2.position);
                    _vector4.subVectors(v1.position, v2.position);
                    _vector3.cross(_vector4);
                    _face.normalModel.copy(_vector3);
                    _face.normalModel.applyMatrix3(normalMatrix).normalize();
                    for (var i = 0; i < 3; i++) {
                        var normal = _face.vertexNormalsModel[i];
                        normal.fromArray(normals, arguments[i] * 3);
                        normal.applyMatrix3(normalMatrix).normalize();
                        var uv = _face.uvs[i];
                        uv.fromArray(uvs, arguments[i] * 2);
                    }
                    _face.vertexNormalsLength = 3;
                    _face.material = material;
                    if (material.vertexColors) {
                        _face.color.fromArray(colors, a * 3);
                    }
                    _renderData.elements.push(_face);
                }
            }
            return {
                setObject: setObject,
                projectVertex: projectVertex,
                checkTriangleVisibility: checkTriangleVisibility,
                checkBackfaceCulling: checkBackfaceCulling,
                pushVertex: pushVertex,
                pushNormal: pushNormal,
                pushColor: pushColor,
                pushUv: pushUv,
                pushLine: pushLine,
                pushTriangle: pushTriangle
            };
        };
        var renderList = new RenderList();
        function projectObject(object) {
            if (object.visible === false)
                return;
            if (object instanceof THREE.Light) {
                _renderData.lights.push(object);
            } else if (object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points) {
                if (object.material.visible === false)
                    return;
                if (object.frustumCulled === true && _frustum.intersectsObject(object) === false)
                    return;
                addObject(object);
            } else if (object instanceof THREE.Sprite) {
                if (object.material.visible === false)
                    return;
                if (object.frustumCulled === true && _frustum.intersectsSprite(object) === false)
                    return;
                addObject(object);
            }
            var children = object.children;
            for (var i = 0, l = children.length; i < l; i++) {
                projectObject(children[i]);
            }
        }
        function addObject(object) {
            _object = getNextObjectInPool();
            _object.id = object.id;
            _object.object = object;
            _vector3.setFromMatrixPosition(object.matrixWorld);
            _vector3.applyMatrix4(_viewProjectionMatrix);
            _object.z = _vector3.z;
            _object.renderOrder = object.renderOrder;
            _renderData.objects.push(_object);
        }
        this.projectScene = function (scene, camera, sortObjects, sortElements) {
            _faceCount = 0;
            _lineCount = 0;
            _spriteCount = 0;
            _renderData.elements.length = 0;
            if (scene.autoUpdate === true)
                scene.updateMatrixWorld();
            if (camera.parent === null)
                camera.updateMatrixWorld();
            _viewMatrix.copy(camera.matrixWorldInverse);
            _viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, _viewMatrix);
            _frustum.setFromProjectionMatrix(_viewProjectionMatrix);
            _objectCount = 0;
            _renderData.objects.length = 0;
            _renderData.lights.length = 0;
            projectObject(scene);
            if (sortObjects === true) {
                _renderData.objects.sort(painterSort);
            }
            var objects = _renderData.objects;
            for (var o = 0, ol = objects.length; o < ol; o++) {
                var object = objects[o].object;
                var geometry = object.geometry;
                renderList.setObject(object);
                _modelMatrix = object.matrixWorld;
                _vertexCount = 0;
                if (object instanceof THREE.Mesh) {
                    if (geometry instanceof THREE.BufferGeometry) {
                        var material = object.material;
                        var isMultiMaterial = Array.isArray(material);
                        var attributes = geometry.attributes;
                        var groups = geometry.groups;
                        if (attributes.position === undefined)
                            continue;
                        var positions = attributes.position.array;
                        for (var i = 0, l = positions.length; i < l; i += 3) {
                            var x = positions[i];
                            var y = positions[i + 1];
                            var z = positions[i + 2];
                            if (material.morphTargets === true) {
                                var morphTargets = geometry.morphAttributes.position;
                                var morphTargetsRelative = geometry.morphTargetsRelative;
                                var morphInfluences = object.morphTargetInfluences;
                                for (var t = 0, tl = morphTargets.length; t < tl; t++) {
                                    var influence = morphInfluences[t];
                                    if (influence === 0)
                                        continue;
                                    var target = morphTargets[t];
                                    if (morphTargetsRelative) {
                                        x += target.getX(i / 3) * influence;
                                        y += target.getY(i / 3) * influence;
                                        z += target.getZ(i / 3) * influence;
                                    } else {
                                        x += (target.getX(i / 3) - positions[i]) * influence;
                                        y += (target.getY(i / 3) - positions[i + 1]) * influence;
                                        z += (target.getZ(i / 3) - positions[i + 2]) * influence;
                                    }
                                }
                            }
                            renderList.pushVertex(x, y, z);
                        }
                        if (attributes.normal !== undefined) {
                            var normals = attributes.normal.array;
                            for (var i = 0, l = normals.length; i < l; i += 3) {
                                renderList.pushNormal(normals[i], normals[i + 1], normals[i + 2]);
                            }
                        }
                        if (attributes.color !== undefined) {
                            var colors = attributes.color.array;
                            for (var i = 0, l = colors.length; i < l; i += 3) {
                                renderList.pushColor(colors[i], colors[i + 1], colors[i + 2]);
                            }
                        }
                        if (attributes.uv !== undefined) {
                            var uvs = attributes.uv.array;
                            for (var i = 0, l = uvs.length; i < l; i += 2) {
                                renderList.pushUv(uvs[i], uvs[i + 1]);
                            }
                        }
                        if (geometry.index !== null) {
                            var indices = geometry.index.array;
                            if (groups.length > 0) {
                                for (var g = 0; g < groups.length; g++) {
                                    var group = groups[g];
                                    material = isMultiMaterial === true ? object.material[group.materialIndex] : object.material;
                                    if (material === undefined)
                                        continue;
                                    for (var i = group.start, l = group.start + group.count; i < l; i += 3) {
                                        renderList.pushTriangle(indices[i], indices[i + 1], indices[i + 2], material);
                                    }
                                }
                            } else {
                                for (var i = 0, l = indices.length; i < l; i += 3) {
                                    renderList.pushTriangle(indices[i], indices[i + 1], indices[i + 2], material);
                                }
                            }
                        } else {
                            if (groups.length > 0) {
                                for (var g = 0; g < groups.length; g++) {
                                    var group = groups[g];
                                    material = isMultiMaterial === true ? object.material[group.materialIndex] : object.material;
                                    if (material === undefined)
                                        continue;
                                    for (var i = group.start, l = group.start + group.count; i < l; i += 3) {
                                        renderList.pushTriangle(i, i + 1, i + 2, material);
                                    }
                                }
                            } else {
                                for (var i = 0, l = positions.length / 3; i < l; i += 3) {
                                    renderList.pushTriangle(i, i + 1, i + 2, material);
                                }
                            }
                        }
                    } else if (geometry instanceof THREE.Geometry) {
                        var vertices = geometry.vertices;
                        var faces = geometry.faces;
                        var faceVertexUvs = geometry.faceVertexUvs[0];
                        _normalMatrix.getNormalMatrix(_modelMatrix);
                        var material = object.material;
                        var isMultiMaterial = Array.isArray(material);
                        for (var v = 0, vl = vertices.length; v < vl; v++) {
                            var vertex = vertices[v];
                            _vector3.copy(vertex);
                            if (material.morphTargets === true) {
                                var morphTargets = geometry.morphTargets;
                                var morphInfluences = object.morphTargetInfluences;
                                for (var t = 0, tl = morphTargets.length; t < tl; t++) {
                                    var influence = morphInfluences[t];
                                    if (influence === 0)
                                        continue;
                                    var target = morphTargets[t];
                                    var targetVertex = target.vertices[v];
                                    _vector3.x += (targetVertex.x - vertex.x) * influence;
                                    _vector3.y += (targetVertex.y - vertex.y) * influence;
                                    _vector3.z += (targetVertex.z - vertex.z) * influence;
                                }
                            }
                            renderList.pushVertex(_vector3.x, _vector3.y, _vector3.z);
                        }
                        for (var f = 0, fl = faces.length; f < fl; f++) {
                            var face = faces[f];
                            material = isMultiMaterial === true ? object.material[face.materialIndex] : object.material;
                            if (material === undefined)
                                continue;
                            var side = material.side;
                            var v1 = _vertexPool[face.a];
                            var v2 = _vertexPool[face.b];
                            var v3 = _vertexPool[face.c];
                            if (renderList.checkTriangleVisibility(v1, v2, v3) === false)
                                continue;
                            var visible = renderList.checkBackfaceCulling(v1, v2, v3);
                            if (side !== THREE.DoubleSide) {
                                if (side === THREE.FrontSide && visible === false)
                                    continue;
                                if (side === THREE.BackSide && visible === true)
                                    continue;
                            }
                            _face = getNextFaceInPool();
                            _face.id = object.id;
                            _face.v1.copy(v1);
                            _face.v2.copy(v2);
                            _face.v3.copy(v3);
                            _face.normalModel.copy(face.normal);
                            if (visible === false && (side === THREE.BackSide || side === THREE.DoubleSide)) {
                                _face.normalModel.negate();
                            }
                            _face.normalModel.applyMatrix3(_normalMatrix).normalize();
                            var faceVertexNormals = face.vertexNormals;
                            for (var n = 0, nl = Math.min(faceVertexNormals.length, 3); n < nl; n++) {
                                var normalModel = _face.vertexNormalsModel[n];
                                normalModel.copy(faceVertexNormals[n]);
                                if (visible === false && (side === THREE.BackSide || side === THREE.DoubleSide)) {
                                    normalModel.negate();
                                }
                                normalModel.applyMatrix3(_normalMatrix).normalize();
                            }
                            _face.vertexNormalsLength = faceVertexNormals.length;
                            var vertexUvs = faceVertexUvs[f];
                            if (vertexUvs !== undefined) {
                                for (var u = 0; u < 3; u++) {
                                    _face.uvs[u].copy(vertexUvs[u]);
                                }
                            }
                            _face.color = face.color;
                            _face.material = material;
                            _face.z = (v1.positionScreen.z + v2.positionScreen.z + v3.positionScreen.z) / 3;
                            _face.renderOrder = object.renderOrder;
                            _renderData.elements.push(_face);
                        }
                    }
                } else if (object instanceof THREE.Line) {
                    _modelViewProjectionMatrix.multiplyMatrices(_viewProjectionMatrix, _modelMatrix);
                    if (geometry instanceof THREE.BufferGeometry) {
                        var attributes = geometry.attributes;
                        if (attributes.position !== undefined) {
                            var positions = attributes.position.array;
                            for (var i = 0, l = positions.length; i < l; i += 3) {
                                renderList.pushVertex(positions[i], positions[i + 1], positions[i + 2]);
                            }
                            if (attributes.color !== undefined) {
                                var colors = attributes.color.array;
                                for (var i = 0, l = colors.length; i < l; i += 3) {
                                    renderList.pushColor(colors[i], colors[i + 1], colors[i + 2]);
                                }
                            }
                            if (geometry.index !== null) {
                                var indices = geometry.index.array;
                                for (var i = 0, l = indices.length; i < l; i += 2) {
                                    renderList.pushLine(indices[i], indices[i + 1]);
                                }
                            } else {
                                var step = object instanceof THREE.LineSegments ? 2 : 1;
                                for (var i = 0, l = positions.length / 3 - 1; i < l; i += step) {
                                    renderList.pushLine(i, i + 1);
                                }
                            }
                        }
                    } else if (geometry instanceof THREE.Geometry) {
                        var vertices = object.geometry.vertices;
                        if (vertices.length === 0)
                            continue;
                        v1 = getNextVertexInPool();
                        v1.positionScreen.copy(vertices[0]).applyMatrix4(_modelViewProjectionMatrix);
                        var step = object instanceof THREE.LineSegments ? 2 : 1;
                        for (var v = 1, vl = vertices.length; v < vl; v++) {
                            v1 = getNextVertexInPool();
                            v1.positionScreen.copy(vertices[v]).applyMatrix4(_modelViewProjectionMatrix);
                            if ((v + 1) % step > 0)
                                continue;
                            v2 = _vertexPool[_vertexCount - 2];
                            _clippedVertex1PositionScreen.copy(v1.positionScreen);
                            _clippedVertex2PositionScreen.copy(v2.positionScreen);
                            if (clipLine(_clippedVertex1PositionScreen, _clippedVertex2PositionScreen) === true) {
                                _clippedVertex1PositionScreen.multiplyScalar(1 / _clippedVertex1PositionScreen.w);
                                _clippedVertex2PositionScreen.multiplyScalar(1 / _clippedVertex2PositionScreen.w);
                                _line = getNextLineInPool();
                                _line.id = object.id;
                                _line.v1.positionScreen.copy(_clippedVertex1PositionScreen);
                                _line.v2.positionScreen.copy(_clippedVertex2PositionScreen);
                                _line.z = Math.max(_clippedVertex1PositionScreen.z, _clippedVertex2PositionScreen.z);
                                _line.renderOrder = object.renderOrder;
                                _line.material = object.material;
                                if (object.material.vertexColors) {
                                    _line.vertexColors[0].copy(object.geometry.colors[v]);
                                    _line.vertexColors[1].copy(object.geometry.colors[v - 1]);
                                }
                                _renderData.elements.push(_line);
                            }
                        }
                    }
                } else if (object instanceof THREE.Points) {
                    _modelViewProjectionMatrix.multiplyMatrices(_viewProjectionMatrix, _modelMatrix);
                    if (geometry instanceof THREE.Geometry) {
                        var vertices = object.geometry.vertices;
                        for (var v = 0, vl = vertices.length; v < vl; v++) {
                            var vertex = vertices[v];
                            _vector4.set(vertex.x, vertex.y, vertex.z, 1);
                            _vector4.applyMatrix4(_modelViewProjectionMatrix);
                            pushPoint(_vector4, object, camera);
                        }
                    } else if (geometry instanceof THREE.BufferGeometry) {
                        var attributes = geometry.attributes;
                        if (attributes.position !== undefined) {
                            var positions = attributes.position.array;
                            for (var i = 0, l = positions.length; i < l; i += 3) {
                                _vector4.set(positions[i], positions[i + 1], positions[i + 2], 1);
                                _vector4.applyMatrix4(_modelViewProjectionMatrix);
                                pushPoint(_vector4, object, camera);
                            }
                        }
                    }
                } else if (object instanceof THREE.Sprite) {
                    object.modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse, object.matrixWorld);
                    _vector4.set(_modelMatrix.elements[12], _modelMatrix.elements[13], _modelMatrix.elements[14], 1);
                    _vector4.applyMatrix4(_viewProjectionMatrix);
                    pushPoint(_vector4, object, camera);
                }
            }
            if (sortElements === true) {
                _renderData.elements.sort(painterSort);
            }
            return _renderData;
        };
        function pushPoint(_vector4, object, camera) {
            var invW = 1 / _vector4.w;
            _vector4.z *= invW;
            if (_vector4.z >= -1 && _vector4.z <= 1) {
                _sprite = getNextSpriteInPool();
                _sprite.id = object.id;
                _sprite.x = _vector4.x * invW;
                _sprite.y = _vector4.y * invW;
                _sprite.z = _vector4.z;
                _sprite.renderOrder = object.renderOrder;
                _sprite.object = object;
                _sprite.rotation = object.rotation;
                _sprite.scale.x = object.scale.x * Math.abs(_sprite.x - (_vector4.x + camera.projectionMatrix.elements[0]) / (_vector4.w + camera.projectionMatrix.elements[12]));
                _sprite.scale.y = object.scale.y * Math.abs(_sprite.y - (_vector4.y + camera.projectionMatrix.elements[5]) / (_vector4.w + camera.projectionMatrix.elements[13]));
                _sprite.material = object.material;
                _renderData.elements.push(_sprite);
            }
        }
        function getNextObjectInPool() {
            if (_objectCount === _objectPoolLength) {
                var object = new RenderableObject();
                _objectPool.push(object);
                _objectPoolLength++;
                _objectCount++;
                return object;
            }
            return _objectPool[_objectCount++];
        }
        function getNextVertexInPool() {
            if (_vertexCount === _vertexPoolLength) {
                var vertex = new RenderableVertex();
                _vertexPool.push(vertex);
                _vertexPoolLength++;
                _vertexCount++;
                return vertex;
            }
            return _vertexPool[_vertexCount++];
        }
        function getNextFaceInPool() {
            if (_faceCount === _facePoolLength) {
                var face = new RenderableFace();
                _facePool.push(face);
                _facePoolLength++;
                _faceCount++;
                return face;
            }
            return _facePool[_faceCount++];
        }
        function getNextLineInPool() {
            if (_lineCount === _linePoolLength) {
                var line = new RenderableLine();
                _linePool.push(line);
                _linePoolLength++;
                _lineCount++;
                return line;
            }
            return _linePool[_lineCount++];
        }
        function getNextSpriteInPool() {
            if (_spriteCount === _spritePoolLength) {
                var sprite = new RenderableSprite();
                _spritePool.push(sprite);
                _spritePoolLength++;
                _spriteCount++;
                return sprite;
            }
            return _spritePool[_spriteCount++];
        }
        function painterSort(a, b) {
            if (a.renderOrder !== b.renderOrder) {
                return a.renderOrder - b.renderOrder;
            } else if (a.z !== b.z) {
                return b.z - a.z;
            } else if (a.id !== b.id) {
                return a.id - b.id;
            } else {
                return 0;
            }
        }
        function clipLine(s1, s2) {
            var alpha1 = 0, alpha2 = 1, bc1near = s1.z + s1.w, bc2near = s2.z + s2.w, bc1far = -s1.z + s1.w, bc2far = -s2.z + s2.w;
            if (bc1near >= 0 && bc2near >= 0 && bc1far >= 0 && bc2far >= 0) {
                return true;
            } else if (bc1near < 0 && bc2near < 0 || bc1far < 0 && bc2far < 0) {
                return false;
            } else {
                if (bc1near < 0) {
                    alpha1 = Math.max(alpha1, bc1near / (bc1near - bc2near));
                } else if (bc2near < 0) {
                    alpha2 = Math.min(alpha2, bc1near / (bc1near - bc2near));
                }
                if (bc1far < 0) {
                    alpha1 = Math.max(alpha1, bc1far / (bc1far - bc2far));
                } else if (bc2far < 0) {
                    alpha2 = Math.min(alpha2, bc1far / (bc1far - bc2far));
                }
                if (alpha2 < alpha1) {
                    return false;
                } else {
                    s1.lerp(s2, alpha1);
                    s2.lerp(s1, 1 - alpha2);
                    return true;
                }
            }
        }
    };

    Projector.RenderableObject = RenderableObject;
    Projector.RenderableFace = RenderableFace;
    Projector.RenderableVertex = RenderableVertex;
    Projector.RenderableLine = RenderableLine;
    Projector.RenderableSprite = RenderableSprite;
    
    return threex.renderers.Projector = Projector;
});

define('skylark-threejs-ex/renderers/SVGRenderer',[
    "skylark-threejs",
    "../threex",
    '../renderers/Projector'
], function (
    THREE, 
    threex,
    Projector
) {
    'use strict';
    var SVGObject = function (node) {
        THREE.Object3D.call(this);
        this.node = node;
    };
    SVGObject.prototype = Object.create(THREE.Object3D.prototype);
    SVGObject.prototype.constructor = SVGObject;
    var SVGRenderer = function () {
        var _this = this, _renderData, _elements, _lights, _projector = new Projector(), _svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg'), _svgWidth, _svgHeight, _svgWidthHalf, _svgHeightHalf, _v1, _v2, _v3, _clipBox = new THREE.Box2(), _elemBox = new THREE.Box2(), _color = new THREE.Color(), _diffuseColor = new THREE.Color(), _ambientLight = new THREE.Color(), _directionalLights = new THREE.Color(), _pointLights = new THREE.Color(), _clearColor = new THREE.Color(), _vector3 = new THREE.Vector3(), _centroid = new THREE.Vector3(), _normal = new THREE.Vector3(), _normalViewMatrix = new THREE.Matrix3(), _viewMatrix = new THREE.Matrix4(), _viewProjectionMatrix = new THREE.Matrix4(), _svgPathPool = [], _svgNode, _pathCount = 0, _currentPath, _currentStyle, _quality = 1, _precision = null;
        this.domElement = _svg;
        this.autoClear = true;
        this.sortObjects = true;
        this.sortElements = true;
        this.overdraw = 0.5;
        this.info = {
            render: {
                vertices: 0,
                faces: 0
            }
        };
        this.setQuality = function (quality) {
            switch (quality) {
            case 'high':
                _quality = 1;
                break;
            case 'low':
                _quality = 0;
                break;
            }
        };
        this.setClearColor = function (color) {
            _clearColor.set(color);
        };
        this.setPixelRatio = function () {
        };
        this.setSize = function (width, height) {
            _svgWidth = width;
            _svgHeight = height;
            _svgWidthHalf = _svgWidth / 2;
            _svgHeightHalf = _svgHeight / 2;
            _svg.setAttribute('viewBox', -_svgWidthHalf + ' ' + -_svgHeightHalf + ' ' + _svgWidth + ' ' + _svgHeight);
            _svg.setAttribute('width', _svgWidth);
            _svg.setAttribute('height', _svgHeight);
            _clipBox.min.set(-_svgWidthHalf, -_svgHeightHalf);
            _clipBox.max.set(_svgWidthHalf, _svgHeightHalf);
        };
        this.setPrecision = function (precision) {
            _precision = precision;
        };
        function removeChildNodes() {
            _pathCount = 0;
            while (_svg.childNodes.length > 0) {
                _svg.removeChild(_svg.childNodes[0]);
            }
        }
        function convert(c) {
            return _precision !== null ? c.toFixed(_precision) : c;
        }
        this.clear = function () {
            removeChildNodes();
            _svg.style.backgroundColor = _clearColor.getStyle();
        };
        this.render = function (scene, camera) {
            if (camera instanceof THREE.Camera === false) {
                console.error('THREE.SVGRenderer.render: camera is not an instance of Camera.');
                return;
            }
            var background = scene.background;
            if (background && background.isColor) {
                removeChildNodes();
                _svg.style.backgroundColor = background.getStyle();
            } else if (this.autoClear === true) {
                this.clear();
            }
            _this.info.render.vertices = 0;
            _this.info.render.faces = 0;
            _viewMatrix.copy(camera.matrixWorldInverse);
            _viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, _viewMatrix);
            _renderData = _projector.projectScene(scene, camera, this.sortObjects, this.sortElements);
            _elements = _renderData.elements;
            _lights = _renderData.lights;
            _normalViewMatrix.getNormalMatrix(camera.matrixWorldInverse);
            calculateLights(_lights);
            _currentPath = '';
            _currentStyle = '';
            for (var e = 0, el = _elements.length; e < el; e++) {
                var element = _elements[e];
                var material = element.material;
                if (material === undefined || material.opacity === 0)
                    continue;
                _elemBox.makeEmpty();
                if (element instanceof Projector.RenderableSprite) {
                    _v1 = element;
                    _v1.x *= _svgWidthHalf;
                    _v1.y *= -_svgHeightHalf;
                    renderSprite(_v1, element, material);
                } else if (element instanceof Projector.RenderableLine) {
                    _v1 = element.v1;
                    _v2 = element.v2;
                    _v1.positionScreen.x *= _svgWidthHalf;
                    _v1.positionScreen.y *= -_svgHeightHalf;
                    _v2.positionScreen.x *= _svgWidthHalf;
                    _v2.positionScreen.y *= -_svgHeightHalf;
                    _elemBox.setFromPoints([
                        _v1.positionScreen,
                        _v2.positionScreen
                    ]);
                    if (_clipBox.intersectsBox(_elemBox) === true) {
                        renderLine(_v1, _v2, element, material);
                    }
                } else if (element instanceof Projector.RenderableFace) {
                    _v1 = element.v1;
                    _v2 = element.v2;
                    _v3 = element.v3;
                    if (_v1.positionScreen.z < -1 || _v1.positionScreen.z > 1)
                        continue;
                    if (_v2.positionScreen.z < -1 || _v2.positionScreen.z > 1)
                        continue;
                    if (_v3.positionScreen.z < -1 || _v3.positionScreen.z > 1)
                        continue;
                    _v1.positionScreen.x *= _svgWidthHalf;
                    _v1.positionScreen.y *= -_svgHeightHalf;
                    _v2.positionScreen.x *= _svgWidthHalf;
                    _v2.positionScreen.y *= -_svgHeightHalf;
                    _v3.positionScreen.x *= _svgWidthHalf;
                    _v3.positionScreen.y *= -_svgHeightHalf;
                    if (this.overdraw > 0) {
                        expand(_v1.positionScreen, _v2.positionScreen, this.overdraw);
                        expand(_v2.positionScreen, _v3.positionScreen, this.overdraw);
                        expand(_v3.positionScreen, _v1.positionScreen, this.overdraw);
                    }
                    _elemBox.setFromPoints([
                        _v1.positionScreen,
                        _v2.positionScreen,
                        _v3.positionScreen
                    ]);
                    if (_clipBox.intersectsBox(_elemBox) === true) {
                        renderFace3(_v1, _v2, _v3, element, material);
                    }
                }
            }
            flushPath();
            scene.traverseVisible(function (object) {
                if (object instanceof SVGObject) {
                    _vector3.setFromMatrixPosition(object.matrixWorld);
                    _vector3.applyMatrix4(_viewProjectionMatrix);
                    if (_vector3.z < -1 || _vector3.z > 1)
                        return;
                    var x = _vector3.x * _svgWidthHalf;
                    var y = -_vector3.y * _svgHeightHalf;
                    var node = object.node;
                    node.setAttribute('transform', 'translate(' + x + ',' + y + ')');
                    _svg.appendChild(node);
                }
            });
        };
        function calculateLights(lights) {
            _ambientLight.setRGB(0, 0, 0);
            _directionalLights.setRGB(0, 0, 0);
            _pointLights.setRGB(0, 0, 0);
            for (var l = 0, ll = lights.length; l < ll; l++) {
                var light = lights[l];
                var lightColor = light.color;
                if (light.isAmbientLight) {
                    _ambientLight.r += lightColor.r;
                    _ambientLight.g += lightColor.g;
                    _ambientLight.b += lightColor.b;
                } else if (light.isDirectionalLight) {
                    _directionalLights.r += lightColor.r;
                    _directionalLights.g += lightColor.g;
                    _directionalLights.b += lightColor.b;
                } else if (light.isPointLight) {
                    _pointLights.r += lightColor.r;
                    _pointLights.g += lightColor.g;
                    _pointLights.b += lightColor.b;
                }
            }
        }
        function calculateLight(lights, position, normal, color) {
            for (var l = 0, ll = lights.length; l < ll; l++) {
                var light = lights[l];
                var lightColor = light.color;
                if (light.isDirectionalLight) {
                    var lightPosition = _vector3.setFromMatrixPosition(light.matrixWorld).normalize();
                    var amount = normal.dot(lightPosition);
                    if (amount <= 0)
                        continue;
                    amount *= light.intensity;
                    color.r += lightColor.r * amount;
                    color.g += lightColor.g * amount;
                    color.b += lightColor.b * amount;
                } else if (light.isPointLight) {
                    var lightPosition = _vector3.setFromMatrixPosition(light.matrixWorld);
                    var amount = normal.dot(_vector3.subVectors(lightPosition, position).normalize());
                    if (amount <= 0)
                        continue;
                    amount *= light.distance == 0 ? 1 : 1 - Math.min(position.distanceTo(lightPosition) / light.distance, 1);
                    if (amount == 0)
                        continue;
                    amount *= light.intensity;
                    color.r += lightColor.r * amount;
                    color.g += lightColor.g * amount;
                    color.b += lightColor.b * amount;
                }
            }
        }
        function renderSprite(v1, element, material) {
            var scaleX = element.scale.x * _svgWidthHalf;
            var scaleY = element.scale.y * _svgHeightHalf;
            if (material.isPointsMaterial) {
                scaleX *= material.size;
                scaleY *= material.size;
            }
            var path = 'M' + convert(v1.x - scaleX * 0.5) + ',' + convert(v1.y - scaleY * 0.5) + 'h' + convert(scaleX) + 'v' + convert(scaleY) + 'h' + convert(-scaleX) + 'z';
            var style = '';
            if (material.isSpriteMaterial || material.isPointsMaterial) {
                style = 'fill:' + material.color.getStyle() + ';fill-opacity:' + material.opacity;
            }
            addPath(style, path);
        }
        function renderLine(v1, v2, element, material) {
            var path = 'M' + convert(v1.positionScreen.x) + ',' + convert(v1.positionScreen.y) + 'L' + convert(v2.positionScreen.x) + ',' + convert(v2.positionScreen.y);
            if (material.isLineBasicMaterial) {
                var style = 'fill:none;stroke:' + material.color.getStyle() + ';stroke-opacity:' + material.opacity + ';stroke-width:' + material.linewidth + ';stroke-linecap:' + material.linecap;
                if (material.isLineDashedMaterial) {
                    style = style + ';stroke-dasharray:' + material.dashSize + ',' + material.gapSize;
                }
                addPath(style, path);
            }
        }
        function renderFace3(v1, v2, v3, element, material) {
            _this.info.render.vertices += 3;
            _this.info.render.faces++;
            var path = 'M' + convert(v1.positionScreen.x) + ',' + convert(v1.positionScreen.y) + 'L' + convert(v2.positionScreen.x) + ',' + convert(v2.positionScreen.y) + 'L' + convert(v3.positionScreen.x) + ',' + convert(v3.positionScreen.y) + 'z';
            var style = '';
            if (material.isMeshBasicMaterial) {
                _color.copy(material.color);
                if (material.vertexColors) {
                    _color.multiply(element.color);
                }
            } else if (material.isMeshLambertMaterial || material.isMeshPhongMaterial || material.isMeshStandardMaterial) {
                _diffuseColor.copy(material.color);
                if (material.vertexColors) {
                    _diffuseColor.multiply(element.color);
                }
                _color.copy(_ambientLight);
                _centroid.copy(v1.positionWorld).add(v2.positionWorld).add(v3.positionWorld).divideScalar(3);
                calculateLight(_lights, _centroid, element.normalModel, _color);
                _color.multiply(_diffuseColor).add(material.emissive);
            } else if (material.isMeshNormalMaterial) {
                _normal.copy(element.normalModel).applyMatrix3(_normalViewMatrix).normalize();
                _color.setRGB(_normal.x, _normal.y, _normal.z).multiplyScalar(0.5).addScalar(0.5);
            }
            if (material.wireframe) {
                style = 'fill:none;stroke:' + _color.getStyle() + ';stroke-opacity:' + material.opacity + ';stroke-width:' + material.wireframeLinewidth + ';stroke-linecap:' + material.wireframeLinecap + ';stroke-linejoin:' + material.wireframeLinejoin;
            } else {
                style = 'fill:' + _color.getStyle() + ';fill-opacity:' + material.opacity;
            }
            addPath(style, path);
        }
        function expand(v1, v2, pixels) {
            var x = v2.x - v1.x, y = v2.y - v1.y, det = x * x + y * y, idet;
            if (det === 0)
                return;
            idet = pixels / Math.sqrt(det);
            x *= idet;
            y *= idet;
            v2.x += x;
            v2.y += y;
            v1.x -= x;
            v1.y -= y;
        }
        function addPath(style, path) {
            if (_currentStyle === style) {
                _currentPath += path;
            } else {
                flushPath();
                _currentStyle = style;
                _currentPath = path;
            }
        }
        function flushPath() {
            if (_currentPath) {
                _svgNode = getPathNode(_pathCount++);
                _svgNode.setAttribute('d', _currentPath);
                _svgNode.setAttribute('style', _currentStyle);
                _svg.appendChild(_svgNode);
            }
            _currentPath = '';
            _currentStyle = '';
        }
        function getPathNode(id) {
            if (_svgPathPool[id] == null) {
                _svgPathPool[id] = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                if (_quality == 0) {
                    _svgPathPool[id].setAttribute('shape-rendering', 'crispEdges');
                }
                return _svgPathPool[id];
            }
            return _svgPathPool[id];
        }
    };

    SVGRenderer.SVGObject = SVGObject;
    
    return  threex.renderers.SVGRenderer = SVGRenderer;
});
define('skylark-threejs-ex/shaders/BasicShader',[
    "../threex"
],function (threex) {
    'use strict';
    var BasicShader = {
        uniforms: {},
        vertexShader: [
            'void main() {',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'void main() {',
            '\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );',
            '}'
        ].join('\n')
    };
    return  threex.shaders.BasicShader = BasicShader;
});
define('skylark-threejs-ex/shaders/BleachBypassShader',[
    "../threex"
],function (threex) {
    'use strict';
    var BleachBypassShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'opacity': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float opacity;',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 base = texture2D( tDiffuse, vUv );',
            '\tvec3 lumCoeff = vec3( 0.25, 0.65, 0.1 );',
            '\tfloat lum = dot( lumCoeff, base.rgb );',
            '\tvec3 blend = vec3( lum );',
            '\tfloat L = min( 1.0, max( 0.0, 10.0 * ( lum - 0.45 ) ) );',
            '\tvec3 result1 = 2.0 * base.rgb * blend;',
            '\tvec3 result2 = 1.0 - 2.0 * ( 1.0 - blend ) * ( 1.0 - base.rgb );',
            '\tvec3 newColor = mix( result1, result2, L );',
            '\tfloat A2 = opacity * base.a;',
            '\tvec3 mixRGB = A2 * newColor.rgb;',
            '\tmixRGB += ( ( 1.0 - A2 ) * base.rgb );',
            '\tgl_FragColor = vec4( mixRGB, base.a );',
            '}'
        ].join('\n')
    };
    return threex.shaders.BleachBypassShader = BleachBypassShader;
});
define('skylark-threejs-ex/shaders/BlendShader',[
    "../threex"
],function (threex) {
    'use strict';
    var BlendShader = {
        uniforms: {
            'tDiffuse1': { value: null },
            'tDiffuse2': { value: null },
            'mixRatio': { value: 0.5 },
            'opacity': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float opacity;',
            'uniform float mixRatio;',
            'uniform sampler2D tDiffuse1;',
            'uniform sampler2D tDiffuse2;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 texel1 = texture2D( tDiffuse1, vUv );',
            '\tvec4 texel2 = texture2D( tDiffuse2, vUv );',
            '\tgl_FragColor = opacity * mix( texel1, texel2, mixRatio );',
            '}'
        ].join('\n')
    };
    return threex.shaders.BlendShader = BlendShader;
});
define('skylark-threejs-ex/shaders/BrightnessContrastShader',[
    "../threex"
],function (threex) {
    'use strict';
    var BrightnessContrastShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'brightness': { value: 0 },
            'contrast': { value: 0 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform float brightness;',
            'uniform float contrast;',
            'varying vec2 vUv;',
            'void main() {',
            '\tgl_FragColor = texture2D( tDiffuse, vUv );',
            '\tgl_FragColor.rgb += brightness;',
            '\tif (contrast > 0.0) {',
            '\t\tgl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - contrast) + 0.5;',
            '\t} else {',
            '\t\tgl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + contrast) + 0.5;',
            '\t}',
            '}'
        ].join('\n')
    };
    return threex.shaders.BrightnessContrastShader = BrightnessContrastShader;
});
define('skylark-threejs-ex/shaders/ColorCorrectionShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ColorCorrectionShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'powRGB': { value: new THREE.Vector3(2, 2, 2) },
            'mulRGB': { value: new THREE.Vector3(1, 1, 1) },
            'addRGB': { value: new THREE.Vector3(0, 0, 0) }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform vec3 powRGB;',
            'uniform vec3 mulRGB;',
            'uniform vec3 addRGB;',
            'varying vec2 vUv;',
            'void main() {',
            '\tgl_FragColor = texture2D( tDiffuse, vUv );',
            '\tgl_FragColor.rgb = mulRGB * pow( ( gl_FragColor.rgb + addRGB ), powRGB );',
            '}'
        ].join('\n')
    };
    return threex.shaders.ColorCorrectionShader = ColorCorrectionShader;
});
define('skylark-threejs-ex/shaders/ColorifyShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ColorifyShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'color': { value: new THREE.Color(16777215) }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec3 color;',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 texel = texture2D( tDiffuse, vUv );',
            '\tvec3 luma = vec3( 0.299, 0.587, 0.114 );',
            '\tfloat v = dot( texel.xyz, luma );',
            '\tgl_FragColor = vec4( v * color, texel.w );',
            '}'
        ].join('\n')
    };
    return threex.shaders.ColorifyShader = ColorifyShader;
});
define('skylark-threejs-ex/shaders/DOFMipMapShader',[
    "../threex"
],function (threex) {
    'use strict';
    var DOFMipMapShader = {
        uniforms: {
            'tColor': { value: null },
            'tDepth': { value: null },
            'focus': { value: 1 },
            'maxblur': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float focus;',
            'uniform float maxblur;',
            'uniform sampler2D tColor;',
            'uniform sampler2D tDepth;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 depth = texture2D( tDepth, vUv );',
            '\tfloat factor = depth.x - focus;',
            '\tvec4 col = texture2D( tColor, vUv, 2.0 * maxblur * abs( focus - depth.x ) );',
            '\tgl_FragColor = col;',
            '\tgl_FragColor.a = 1.0;',
            '}'
        ].join('\n')
    };
    return  threex.shaders.DOFMipMapShader = DOFMipMapShader;
});
define('skylark-threejs-ex/shaders/FocusShader',[
    "../threex"
],function (threex) {
    'use strict';
    var FocusShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'screenWidth': { value: 1024 },
            'screenHeight': { value: 1024 },
            'sampleDistance': { value: 0.94 },
            'waveFactor': { value: 0.00125 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float screenWidth;',
            'uniform float screenHeight;',
            'uniform float sampleDistance;',
            'uniform float waveFactor;',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 color, org, tmp, add;',
            '\tfloat sample_dist, f;',
            '\tvec2 vin;',
            '\tvec2 uv = vUv;',
            '\tadd = color = org = texture2D( tDiffuse, uv );',
            '\tvin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );',
            '\tsample_dist = dot( vin, vin ) * 2.0;',
            '\tf = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;',
            '\tvec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );',
            '\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );',
            '\tif( tmp.b < color.b ) color = tmp;',
            '\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );',
            '\tif( tmp.b < color.b ) color = tmp;',
            '\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );',
            '\tif( tmp.b < color.b ) color = tmp;',
            '\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );',
            '\tif( tmp.b < color.b ) color = tmp;',
            '\tadd += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );',
            '\tif( tmp.b < color.b ) color = tmp;',
            '\tadd += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );',
            '\tif( tmp.b < color.b ) color = tmp;',
            '\tadd += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );',
            '\tif( tmp.b < color.b ) color = tmp;',
            '\tcolor = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );',
            '\tcolor = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );',
            '\tgl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );',
            '}'
        ].join('\n')
    };
    return threex.shaders.FocusShader = FocusShader;
});
define('skylark-threejs-ex/shaders/FreiChenShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var FreiChenShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'aspect': { value: new THREE.Vector2(512, 512) }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'uniform vec2 aspect;',
            'vec2 texel = vec2(1.0 / aspect.x, 1.0 / aspect.y);',
            'mat3 G[9];',
            'const mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );',
            'const mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );',
            'const mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );',
            'const mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );',
            'const mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );',
            'const mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );',
            'const mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );',
            'const mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );',
            'const mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );',
            'void main(void)',
            '{',
            '\tG[0] = g0,',
            '\tG[1] = g1,',
            '\tG[2] = g2,',
            '\tG[3] = g3,',
            '\tG[4] = g4,',
            '\tG[5] = g5,',
            '\tG[6] = g6,',
            '\tG[7] = g7,',
            '\tG[8] = g8;',
            '\tmat3 I;',
            '\tfloat cnv[9];',
            '\tvec3 sample;',
            '\tfor (float i=0.0; i<3.0; i++) {',
            '\t\tfor (float j=0.0; j<3.0; j++) {',
            '\t\t\tsample = texture2D(tDiffuse, vUv + texel * vec2(i-1.0,j-1.0) ).rgb;',
            '\t\t\tI[int(i)][int(j)] = length(sample);',
            '\t\t}',
            '\t}',
            '\tfor (int i=0; i<9; i++) {',
            '\t\tfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);',
            '\t\tcnv[i] = dp3 * dp3;',
            '\t}',
            '\tfloat M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);',
            '\tfloat S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);',
            '\tgl_FragColor = vec4(vec3(sqrt(M/S)), 1.0);',
            '}'
        ].join('\n')
    };
    return threex.shaders.FreiChenShader = FreiChenShader;
});
define('skylark-threejs-ex/shaders/FresnelShader',[
    "../threex"
],function (threex) {
    'use strict';
    var FresnelShader = {
        uniforms: {
            'mRefractionRatio': { value: 1.02 },
            'mFresnelBias': { value: 0.1 },
            'mFresnelPower': { value: 2 },
            'mFresnelScale': { value: 1 },
            'tCube': { value: null }
        },
        vertexShader: [
            'uniform float mRefractionRatio;',
            'uniform float mFresnelBias;',
            'uniform float mFresnelScale;',
            'uniform float mFresnelPower;',
            'varying vec3 vReflect;',
            'varying vec3 vRefract[3];',
            'varying float vReflectionFactor;',
            'void main() {',
            '\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );',
            '\tvec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );',
            '\tvec3 I = worldPosition.xyz - cameraPosition;',
            '\tvReflect = reflect( I, worldNormal );',
            '\tvRefract[0] = refract( normalize( I ), worldNormal, mRefractionRatio );',
            '\tvRefract[1] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.99 );',
            '\tvRefract[2] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.98 );',
            '\tvReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), worldNormal ), mFresnelPower );',
            '\tgl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform samplerCube tCube;',
            'varying vec3 vReflect;',
            'varying vec3 vRefract[3];',
            'varying float vReflectionFactor;',
            'void main() {',
            '\tvec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );',
            '\tvec4 refractedColor = vec4( 1.0 );',
            '\trefractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;',
            '\trefractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;',
            '\trefractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;',
            '\tgl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );',
            '}'
        ].join('\n')
    };
    return threex.shaders.FresnelShader = FresnelShader;
});
define('skylark-threejs-ex/shaders/FXAAShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var FXAAShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'resolution': { value: new  THREE.Vector2(1 / 1024, 1 / 512) }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'precision highp float;',
            '',
            'uniform sampler2D tDiffuse;',
            '',
            'uniform vec2 resolution;',
            '',
            'varying vec2 vUv;',
            '',
            '// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)',
            '',
            '//----------------------------------------------------------------------------------',
            '// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag',
            '// SDK Version: v3.00',
            '// Email:       gameworks@nvidia.com',
            '// Site:        http://developer.nvidia.com/',
            '//',
            '// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.',
            '//',
            '// Redistribution and use in source and binary forms, with or without',
            '// modification, are permitted provided that the following conditions',
            '// are met:',
            '//  * Redistributions of source code must retain the above copyright',
            '//    notice, this list of conditions and the following disclaimer.',
            '//  * Redistributions in binary form must reproduce the above copyright',
            '//    notice, this list of conditions and the following disclaimer in the',
            '//    documentation and/or other materials provided with the distribution.',
            '//  * Neither the name of NVIDIA CORPORATION nor the names of its',
            '//    contributors may be used to endorse or promote products derived',
            '//    from this software without specific prior written permission.',
            '//',
            "// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY",
            '// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE',
            '// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR',
            '// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR',
            '// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,',
            '// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,',
            '// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR',
            '// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY',
            '// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT',
            '// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE',
            '// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.',
            '//',
            '//----------------------------------------------------------------------------------',
            '',
            '#define FXAA_PC 1',
            '#define FXAA_GLSL_100 1',
            '#define FXAA_QUALITY_PRESET 12',
            '',
            '#define FXAA_GREEN_AS_LUMA 1',
            '',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_PC_CONSOLE',
            '    //',
            '    // The console algorithm for PC is included',
            '    // for developers targeting really low spec machines.',
            '    // Likely better to just run FXAA_PC, and use a really low preset.',
            '    //',
            '    #define FXAA_PC_CONSOLE 0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_GLSL_120',
            '    #define FXAA_GLSL_120 0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_GLSL_130',
            '    #define FXAA_GLSL_130 0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_HLSL_3',
            '    #define FXAA_HLSL_3 0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_HLSL_4',
            '    #define FXAA_HLSL_4 0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_HLSL_5',
            '    #define FXAA_HLSL_5 0',
            '#endif',
            '/*==========================================================================*/',
            '#ifndef FXAA_GREEN_AS_LUMA',
            '    //',
            '    // For those using non-linear color,',
            '    // and either not able to get luma in alpha, or not wanting to,',
            '    // this enables FXAA to run using green as a proxy for luma.',
            '    // So with this enabled, no need to pack luma in alpha.',
            '    //',
            '    // This will turn off AA on anything which lacks some amount of green.',
            '    // Pure red and blue or combination of only R and B, will get no AA.',
            '    //',
            '    // Might want to lower the settings for both,',
            '    //    fxaaConsoleEdgeThresholdMin',
            '    //    fxaaQualityEdgeThresholdMin',
            '    // In order to insure AA does not get turned off on colors',
            '    // which contain a minor amount of green.',
            '    //',
            '    // 1 = On.',
            '    // 0 = Off.',
            '    //',
            '    #define FXAA_GREEN_AS_LUMA 0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_EARLY_EXIT',
            '    //',
            "    // Controls algorithm's early exit path.",
            '    // On PS3 turning this ON adds 2 cycles to the shader.',
            '    // On 360 turning this OFF adds 10ths of a millisecond to the shader.',
            '    // Turning this off on console will result in a more blurry image.',
            '    // So this defaults to on.',
            '    //',
            '    // 1 = On.',
            '    // 0 = Off.',
            '    //',
            '    #define FXAA_EARLY_EXIT 1',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_DISCARD',
            '    //',
            '    // Only valid for PC OpenGL currently.',
            '    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.',
            '    //',
            "    // 1 = Use discard on pixels which don't need AA.",
            '    //     For APIs which enable concurrent TEX+ROP from same surface.',
            "    // 0 = Return unchanged color on pixels which don't need AA.",
            '    //',
            '    #define FXAA_DISCARD 0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_FAST_PIXEL_OFFSET',
            '    //',
            '    // Used for GLSL 120 only.',
            '    //',
            '    // 1 = GL API supports fast pixel offsets',
            '    // 0 = do not use fast pixel offsets',
            '    //',
            '    #ifdef GL_EXT_gpu_shader4',
            '        #define FXAA_FAST_PIXEL_OFFSET 1',
            '    #endif',
            '    #ifdef GL_NV_gpu_shader5',
            '        #define FXAA_FAST_PIXEL_OFFSET 1',
            '    #endif',
            '    #ifdef GL_ARB_gpu_shader5',
            '        #define FXAA_FAST_PIXEL_OFFSET 1',
            '    #endif',
            '    #ifndef FXAA_FAST_PIXEL_OFFSET',
            '        #define FXAA_FAST_PIXEL_OFFSET 0',
            '    #endif',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#ifndef FXAA_GATHER4_ALPHA',
            '    //',
            '    // 1 = API supports gather4 on alpha channel.',
            '    // 0 = API does not support gather4 on alpha channel.',
            '    //',
            '    #if (FXAA_HLSL_5 == 1)',
            '        #define FXAA_GATHER4_ALPHA 1',
            '    #endif',
            '    #ifdef GL_ARB_gpu_shader5',
            '        #define FXAA_GATHER4_ALPHA 1',
            '    #endif',
            '    #ifdef GL_NV_gpu_shader5',
            '        #define FXAA_GATHER4_ALPHA 1',
            '    #endif',
            '    #ifndef FXAA_GATHER4_ALPHA',
            '        #define FXAA_GATHER4_ALPHA 0',
            '    #endif',
            '#endif',
            '',
            '',
            '/*============================================================================',
            '                        FXAA QUALITY - TUNING KNOBS',
            '------------------------------------------------------------------------------',
            'NOTE the other tuning knobs are now in the shader function inputs!',
            '============================================================================*/',
            '#ifndef FXAA_QUALITY_PRESET',
            '    //',
            '    // Choose the quality preset.',
            '    // This needs to be compiled into the shader as it effects code.',
            '    // Best option to include multiple presets is to',
            '    // in each shader define the preset, then include this file.',
            '    //',
            '    // OPTIONS',
            '    // -----------------------------------------------------------------------',
            '    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)',
            '    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)',
            '    // 39       - no dither, very expensive',
            '    //',
            '    // NOTES',
            '    // -----------------------------------------------------------------------',
            '    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)',
            '    // 13 = about same speed as FXAA 3.9 and better than 12',
            '    // 23 = closest to FXAA 3.9 visually and performance wise',
            '    //  _ = the lowest digit is directly related to performance',
            '    // _  = the highest digit is directly related to style',
            '    //',
            '    #define FXAA_QUALITY_PRESET 12',
            '#endif',
            '',
            '',
            '/*============================================================================',
            '',
            '                           FXAA QUALITY - PRESETS',
            '',
            '============================================================================*/',
            '',
            '/*============================================================================',
            '                     FXAA QUALITY - MEDIUM DITHER PRESETS',
            '============================================================================*/',
            '#if (FXAA_QUALITY_PRESET == 10)',
            '    #define FXAA_QUALITY_PS 3',
            '    #define FXAA_QUALITY_P0 1.5',
            '    #define FXAA_QUALITY_P1 3.0',
            '    #define FXAA_QUALITY_P2 12.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 11)',
            '    #define FXAA_QUALITY_PS 4',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 3.0',
            '    #define FXAA_QUALITY_P3 12.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 12)',
            '    #define FXAA_QUALITY_PS 5',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 4.0',
            '    #define FXAA_QUALITY_P4 12.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 13)',
            '    #define FXAA_QUALITY_PS 6',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 4.0',
            '    #define FXAA_QUALITY_P5 12.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 14)',
            '    #define FXAA_QUALITY_PS 7',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 2.0',
            '    #define FXAA_QUALITY_P5 4.0',
            '    #define FXAA_QUALITY_P6 12.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 15)',
            '    #define FXAA_QUALITY_PS 8',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 2.0',
            '    #define FXAA_QUALITY_P5 2.0',
            '    #define FXAA_QUALITY_P6 4.0',
            '    #define FXAA_QUALITY_P7 12.0',
            '#endif',
            '',
            '/*============================================================================',
            '                     FXAA QUALITY - LOW DITHER PRESETS',
            '============================================================================*/',
            '#if (FXAA_QUALITY_PRESET == 20)',
            '    #define FXAA_QUALITY_PS 3',
            '    #define FXAA_QUALITY_P0 1.5',
            '    #define FXAA_QUALITY_P1 2.0',
            '    #define FXAA_QUALITY_P2 8.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 21)',
            '    #define FXAA_QUALITY_PS 4',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 8.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 22)',
            '    #define FXAA_QUALITY_PS 5',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 8.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 23)',
            '    #define FXAA_QUALITY_PS 6',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 2.0',
            '    #define FXAA_QUALITY_P5 8.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 24)',
            '    #define FXAA_QUALITY_PS 7',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 2.0',
            '    #define FXAA_QUALITY_P5 3.0',
            '    #define FXAA_QUALITY_P6 8.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 25)',
            '    #define FXAA_QUALITY_PS 8',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 2.0',
            '    #define FXAA_QUALITY_P5 2.0',
            '    #define FXAA_QUALITY_P6 4.0',
            '    #define FXAA_QUALITY_P7 8.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 26)',
            '    #define FXAA_QUALITY_PS 9',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 2.0',
            '    #define FXAA_QUALITY_P5 2.0',
            '    #define FXAA_QUALITY_P6 2.0',
            '    #define FXAA_QUALITY_P7 4.0',
            '    #define FXAA_QUALITY_P8 8.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 27)',
            '    #define FXAA_QUALITY_PS 10',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 2.0',
            '    #define FXAA_QUALITY_P5 2.0',
            '    #define FXAA_QUALITY_P6 2.0',
            '    #define FXAA_QUALITY_P7 2.0',
            '    #define FXAA_QUALITY_P8 4.0',
            '    #define FXAA_QUALITY_P9 8.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 28)',
            '    #define FXAA_QUALITY_PS 11',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 2.0',
            '    #define FXAA_QUALITY_P5 2.0',
            '    #define FXAA_QUALITY_P6 2.0',
            '    #define FXAA_QUALITY_P7 2.0',
            '    #define FXAA_QUALITY_P8 2.0',
            '    #define FXAA_QUALITY_P9 4.0',
            '    #define FXAA_QUALITY_P10 8.0',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_QUALITY_PRESET == 29)',
            '    #define FXAA_QUALITY_PS 12',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.5',
            '    #define FXAA_QUALITY_P2 2.0',
            '    #define FXAA_QUALITY_P3 2.0',
            '    #define FXAA_QUALITY_P4 2.0',
            '    #define FXAA_QUALITY_P5 2.0',
            '    #define FXAA_QUALITY_P6 2.0',
            '    #define FXAA_QUALITY_P7 2.0',
            '    #define FXAA_QUALITY_P8 2.0',
            '    #define FXAA_QUALITY_P9 2.0',
            '    #define FXAA_QUALITY_P10 4.0',
            '    #define FXAA_QUALITY_P11 8.0',
            '#endif',
            '',
            '/*============================================================================',
            '                     FXAA QUALITY - EXTREME QUALITY',
            '============================================================================*/',
            '#if (FXAA_QUALITY_PRESET == 39)',
            '    #define FXAA_QUALITY_PS 12',
            '    #define FXAA_QUALITY_P0 1.0',
            '    #define FXAA_QUALITY_P1 1.0',
            '    #define FXAA_QUALITY_P2 1.0',
            '    #define FXAA_QUALITY_P3 1.0',
            '    #define FXAA_QUALITY_P4 1.0',
            '    #define FXAA_QUALITY_P5 1.5',
            '    #define FXAA_QUALITY_P6 2.0',
            '    #define FXAA_QUALITY_P7 2.0',
            '    #define FXAA_QUALITY_P8 2.0',
            '    #define FXAA_QUALITY_P9 2.0',
            '    #define FXAA_QUALITY_P10 4.0',
            '    #define FXAA_QUALITY_P11 8.0',
            '#endif',
            '',
            '',
            '',
            '/*============================================================================',
            '',
            '                                API PORTING',
            '',
            '============================================================================*/',
            '#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)',
            '    #define FxaaBool bool',
            '    #define FxaaDiscard discard',
            '    #define FxaaFloat float',
            '    #define FxaaFloat2 vec2',
            '    #define FxaaFloat3 vec3',
            '    #define FxaaFloat4 vec4',
            '    #define FxaaHalf float',
            '    #define FxaaHalf2 vec2',
            '    #define FxaaHalf3 vec3',
            '    #define FxaaHalf4 vec4',
            '    #define FxaaInt2 ivec2',
            '    #define FxaaSat(x) clamp(x, 0.0, 1.0)',
            '    #define FxaaTex sampler2D',
            '#else',
            '    #define FxaaBool bool',
            '    #define FxaaDiscard clip(-1)',
            '    #define FxaaFloat float',
            '    #define FxaaFloat2 float2',
            '    #define FxaaFloat3 float3',
            '    #define FxaaFloat4 float4',
            '    #define FxaaHalf half',
            '    #define FxaaHalf2 half2',
            '    #define FxaaHalf3 half3',
            '    #define FxaaHalf4 half4',
            '    #define FxaaSat(x) saturate(x)',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_GLSL_100 == 1)',
            '  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)',
            '  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_GLSL_120 == 1)',
            '    // Requires,',
            '    //  #version 120',
            '    // And at least,',
            '    //  #extension GL_EXT_gpu_shader4 : enable',
            '    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)',
            '    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)',
            '    #if (FXAA_FAST_PIXEL_OFFSET == 1)',
            '        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)',
            '    #else',
            '        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)',
            '    #endif',
            '    #if (FXAA_GATHER4_ALPHA == 1)',
            '        // use #extension GL_ARB_gpu_shader5 : enable',
            '        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)',
            '        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)',
            '        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)',
            '        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)',
            '    #endif',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_GLSL_130 == 1)',
            '    // Requires "#version 130" or better',
            '    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)',
            '    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)',
            '    #if (FXAA_GATHER4_ALPHA == 1)',
            '        // use #extension GL_ARB_gpu_shader5 : enable',
            '        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)',
            '        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)',
            '        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)',
            '        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)',
            '    #endif',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_HLSL_3 == 1)',
            '    #define FxaaInt2 float2',
            '    #define FxaaTex sampler2D',
            '    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))',
            '    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_HLSL_4 == 1)',
            '    #define FxaaInt2 int2',
            '    struct FxaaTex { SamplerState smpl; Texture2D tex; };',
            '    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)',
            '    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)',
            '#endif',
            '/*--------------------------------------------------------------------------*/',
            '#if (FXAA_HLSL_5 == 1)',
            '    #define FxaaInt2 int2',
            '    struct FxaaTex { SamplerState smpl; Texture2D tex; };',
            '    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)',
            '    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)',
            '    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)',
            '    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)',
            '    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)',
            '    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)',
            '#endif',
            '',
            '',
            '/*============================================================================',
            '                   GREEN AS LUMA OPTION SUPPORT FUNCTION',
            '============================================================================*/',
            '#if (FXAA_GREEN_AS_LUMA == 0)',
            '    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }',
            '#else',
            '    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }',
            '#endif',
            '',
            '',
            '',
            '',
            '/*============================================================================',
            '',
            '                             FXAA3 QUALITY - PC',
            '',
            '============================================================================*/',
            '#if (FXAA_PC == 1)',
            '/*--------------------------------------------------------------------------*/',
            'FxaaFloat4 FxaaPixelShader(',
            '    //',
            '    // Use noperspective interpolation here (turn off perspective interpolation).',
            '    // {xy} = center of pixel',
            '    FxaaFloat2 pos,',
            '    //',
            '    // Used only for FXAA Console, and not used on the 360 version.',
            '    // Use noperspective interpolation here (turn off perspective interpolation).',
            '    // {xy_} = upper left of pixel',
            '    // {_zw} = lower right of pixel',
            '    FxaaFloat4 fxaaConsolePosPos,',
            '    //',
            '    // Input color texture.',
            '    // {rgb_} = color in linear or perceptual color space',
            '    // if (FXAA_GREEN_AS_LUMA == 0)',
            '    //     {__a} = luma in perceptual color space (not linear)',
            '    FxaaTex tex,',
            '    //',
            '    // Only used on the optimized 360 version of FXAA Console.',
            '    // For everything but 360, just use the same input here as for "tex".',
            '    // For 360, same texture, just alias with a 2nd sampler.',
            '    // This sampler needs to have an exponent bias of -1.',
            '    FxaaTex fxaaConsole360TexExpBiasNegOne,',
            '    //',
            '    // Only used on the optimized 360 version of FXAA Console.',
            '    // For everything but 360, just use the same input here as for "tex".',
            '    // For 360, same texture, just alias with a 3nd sampler.',
            '    // This sampler needs to have an exponent bias of -2.',
            '    FxaaTex fxaaConsole360TexExpBiasNegTwo,',
            '    //',
            '    // Only used on FXAA Quality.',
            '    // This must be from a constant/uniform.',
            '    // {x_} = 1.0/screenWidthInPixels',
            '    // {_y} = 1.0/screenHeightInPixels',
            '    FxaaFloat2 fxaaQualityRcpFrame,',
            '    //',
            '    // Only used on FXAA Console.',
            '    // This must be from a constant/uniform.',
            '    // This effects sub-pixel AA quality and inversely sharpness.',
            '    //   Where N ranges between,',
            '    //     N = 0.50 (default)',
            '    //     N = 0.33 (sharper)',
            '    // {x__} = -N/screenWidthInPixels',
            '    // {_y_} = -N/screenHeightInPixels',
            '    // {_z_} =  N/screenWidthInPixels',
            '    // {__w} =  N/screenHeightInPixels',
            '    FxaaFloat4 fxaaConsoleRcpFrameOpt,',
            '    //',
            '    // Only used on FXAA Console.',
            '    // Not used on 360, but used on PS3 and PC.',
            '    // This must be from a constant/uniform.',
            '    // {x__} = -2.0/screenWidthInPixels',
            '    // {_y_} = -2.0/screenHeightInPixels',
            '    // {_z_} =  2.0/screenWidthInPixels',
            '    // {__w} =  2.0/screenHeightInPixels',
            '    FxaaFloat4 fxaaConsoleRcpFrameOpt2,',
            '    //',
            '    // Only used on FXAA Console.',
            '    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.',
            '    // This must be from a constant/uniform.',
            '    // {x__} =  8.0/screenWidthInPixels',
            '    // {_y_} =  8.0/screenHeightInPixels',
            '    // {_z_} = -4.0/screenWidthInPixels',
            '    // {__w} = -4.0/screenHeightInPixels',
            '    FxaaFloat4 fxaaConsole360RcpFrameOpt2,',
            '    //',
            '    // Only used on FXAA Quality.',
            '    // This used to be the FXAA_QUALITY_SUBPIX define.',
            '    // It is here now to allow easier tuning.',
            '    // Choose the amount of sub-pixel aliasing removal.',
            '    // This can effect sharpness.',
            '    //   1.00 - upper limit (softer)',
            '    //   0.75 - default amount of filtering',
            '    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)',
            '    //   0.25 - almost off',
            '    //   0.00 - completely off',
            '    FxaaFloat fxaaQualitySubpix,',
            '    //',
            '    // Only used on FXAA Quality.',
            '    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.',
            '    // It is here now to allow easier tuning.',
            '    // The minimum amount of local contrast required to apply algorithm.',
            '    //   0.333 - too little (faster)',
            '    //   0.250 - low quality',
            '    //   0.166 - default',
            '    //   0.125 - high quality',
            '    //   0.063 - overkill (slower)',
            '    FxaaFloat fxaaQualityEdgeThreshold,',
            '    //',
            '    // Only used on FXAA Quality.',
            '    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.',
            '    // It is here now to allow easier tuning.',
            '    // Trims the algorithm from processing darks.',
            '    //   0.0833 - upper limit (default, the start of visible unfiltered edges)',
            '    //   0.0625 - high quality (faster)',
            '    //   0.0312 - visible limit (slower)',
            '    // Special notes when using FXAA_GREEN_AS_LUMA,',
            '    //   Likely want to set this to zero.',
            '    //   As colors that are mostly not-green',
            '    //   will appear very dark in the green channel!',
            '    //   Tune by looking at mostly non-green content,',
            '    //   then start at zero and increase until aliasing is a problem.',
            '    FxaaFloat fxaaQualityEdgeThresholdMin,',
            '    //',
            '    // Only used on FXAA Console.',
            '    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.',
            '    // It is here now to allow easier tuning.',
            '    // This does not effect PS3, as this needs to be compiled in.',
            '    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.',
            '    //   Due to the PS3 being ALU bound,',
            '    //   there are only three safe values here: 2 and 4 and 8.',
            '    //   These options use the shaders ability to a free *|/ by 2|4|8.',
            '    // For all other platforms can be a non-power of two.',
            '    //   8.0 is sharper (default!!!)',
            '    //   4.0 is softer',
            '    //   2.0 is really soft (good only for vector graphics inputs)',
            '    FxaaFloat fxaaConsoleEdgeSharpness,',
            '    //',
            '    // Only used on FXAA Console.',
            '    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.',
            '    // It is here now to allow easier tuning.',
            '    // This does not effect PS3, as this needs to be compiled in.',
            '    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.',
            '    //   Due to the PS3 being ALU bound,',
            '    //   there are only two safe values here: 1/4 and 1/8.',
            '    //   These options use the shaders ability to a free *|/ by 2|4|8.',
            '    // The console setting has a different mapping than the quality setting.',
            '    // Other platforms can use other values.',
            '    //   0.125 leaves less aliasing, but is softer (default!!!)',
            '    //   0.25 leaves more aliasing, and is sharper',
            '    FxaaFloat fxaaConsoleEdgeThreshold,',
            '    //',
            '    // Only used on FXAA Console.',
            '    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.',
            '    // It is here now to allow easier tuning.',
            '    // Trims the algorithm from processing darks.',
            '    // The console setting has a different mapping than the quality setting.',
            '    // This only applies when FXAA_EARLY_EXIT is 1.',
            '    // This does not apply to PS3,',
            '    // PS3 was simplified to avoid more shader instructions.',
            '    //   0.06 - faster but more aliasing in darks',
            '    //   0.05 - default',
            '    //   0.04 - slower and less aliasing in darks',
            '    // Special notes when using FXAA_GREEN_AS_LUMA,',
            '    //   Likely want to set this to zero.',
            '    //   As colors that are mostly not-green',
            '    //   will appear very dark in the green channel!',
            '    //   Tune by looking at mostly non-green content,',
            '    //   then start at zero and increase until aliasing is a problem.',
            '    FxaaFloat fxaaConsoleEdgeThresholdMin,',
            '    //',
            '    // Extra constants for 360 FXAA Console only.',
            '    // Use zeros or anything else for other platforms.',
            '    // These must be in physical constant registers and NOT immediates.',
            '    // Immediates will result in compiler un-optimizing.',
            '    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)',
            '    FxaaFloat4 fxaaConsole360ConstDir',
            ') {',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat2 posM;',
            '    posM.x = pos.x;',
            '    posM.y = pos.y;',
            '    #if (FXAA_GATHER4_ALPHA == 1)',
            '        #if (FXAA_DISCARD == 0)',
            '            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);',
            '            #if (FXAA_GREEN_AS_LUMA == 0)',
            '                #define lumaM rgbyM.w',
            '            #else',
            '                #define lumaM rgbyM.y',
            '            #endif',
            '        #endif',
            '        #if (FXAA_GREEN_AS_LUMA == 0)',
            '            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);',
            '            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));',
            '        #else',
            '            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);',
            '            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));',
            '        #endif',
            '        #if (FXAA_DISCARD == 1)',
            '            #define lumaM luma4A.w',
            '        #endif',
            '        #define lumaE luma4A.z',
            '        #define lumaS luma4A.x',
            '        #define lumaSE luma4A.y',
            '        #define lumaNW luma4B.w',
            '        #define lumaN luma4B.z',
            '        #define lumaW luma4B.x',
            '    #else',
            '        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);',
            '        #if (FXAA_GREEN_AS_LUMA == 0)',
            '            #define lumaM rgbyM.w',
            '        #else',
            '            #define lumaM rgbyM.y',
            '        #endif',
            '        #if (FXAA_GLSL_100 == 1)',
            '          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));',
            '        #else',
            '          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));',
            '        #endif',
            '    #endif',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat maxSM = max(lumaS, lumaM);',
            '    FxaaFloat minSM = min(lumaS, lumaM);',
            '    FxaaFloat maxESM = max(lumaE, maxSM);',
            '    FxaaFloat minESM = min(lumaE, minSM);',
            '    FxaaFloat maxWN = max(lumaN, lumaW);',
            '    FxaaFloat minWN = min(lumaN, lumaW);',
            '    FxaaFloat rangeMax = max(maxWN, maxESM);',
            '    FxaaFloat rangeMin = min(minWN, minESM);',
            '    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;',
            '    FxaaFloat range = rangeMax - rangeMin;',
            '    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);',
            '    FxaaBool earlyExit = range < rangeMaxClamped;',
            '/*--------------------------------------------------------------------------*/',
            '    if(earlyExit)',
            '        #if (FXAA_DISCARD == 1)',
            '            FxaaDiscard;',
            '        #else',
            '            return rgbyM;',
            '        #endif',
            '/*--------------------------------------------------------------------------*/',
            '    #if (FXAA_GATHER4_ALPHA == 0)',
            '        #if (FXAA_GLSL_100 == 1)',
            '          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));',
            '        #else',
            '          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));',
            '          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));',
            '        #endif',
            '    #else',
            '        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));',
            '        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));',
            '    #endif',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat lumaNS = lumaN + lumaS;',
            '    FxaaFloat lumaWE = lumaW + lumaE;',
            '    FxaaFloat subpixRcpRange = 1.0/range;',
            '    FxaaFloat subpixNSWE = lumaNS + lumaWE;',
            '    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;',
            '    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat lumaNESE = lumaNE + lumaSE;',
            '    FxaaFloat lumaNWNE = lumaNW + lumaNE;',
            '    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;',
            '    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat lumaNWSW = lumaNW + lumaSW;',
            '    FxaaFloat lumaSWSE = lumaSW + lumaSE;',
            '    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);',
            '    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);',
            '    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;',
            '    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;',
            '    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;',
            '    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;',
            '    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;',
            '    FxaaBool horzSpan = edgeHorz >= edgeVert;',
            '    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;',
            '/*--------------------------------------------------------------------------*/',
            '    if(!horzSpan) lumaN = lumaW;',
            '    if(!horzSpan) lumaS = lumaE;',
            '    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;',
            '    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat gradientN = lumaN - lumaM;',
            '    FxaaFloat gradientS = lumaS - lumaM;',
            '    FxaaFloat lumaNN = lumaN + lumaM;',
            '    FxaaFloat lumaSS = lumaS + lumaM;',
            '    FxaaBool pairN = abs(gradientN) >= abs(gradientS);',
            '    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));',
            '    if(pairN) lengthSign = -lengthSign;',
            '    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat2 posB;',
            '    posB.x = posM.x;',
            '    posB.y = posM.y;',
            '    FxaaFloat2 offNP;',
            '    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;',
            '    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;',
            '    if(!horzSpan) posB.x += lengthSign * 0.5;',
            '    if( horzSpan) posB.y += lengthSign * 0.5;',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat2 posN;',
            '    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;',
            '    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;',
            '    FxaaFloat2 posP;',
            '    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;',
            '    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;',
            '    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;',
            '    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));',
            '    FxaaFloat subpixE = subpixC * subpixC;',
            '    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));',
            '/*--------------------------------------------------------------------------*/',
            '    if(!pairN) lumaNN = lumaSS;',
            '    FxaaFloat gradientScaled = gradient * 1.0/4.0;',
            '    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;',
            '    FxaaFloat subpixF = subpixD * subpixE;',
            '    FxaaBool lumaMLTZero = lumaMM < 0.0;',
            '/*--------------------------------------------------------------------------*/',
            '    lumaEndN -= lumaNN * 0.5;',
            '    lumaEndP -= lumaNN * 0.5;',
            '    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;',
            '    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;',
            '    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;',
            '    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;',
            '    FxaaBool doneNP = (!doneN) || (!doneP);',
            '    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;',
            '    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;',
            '/*--------------------------------------------------------------------------*/',
            '    if(doneNP) {',
            '        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '        doneN = abs(lumaEndN) >= gradientScaled;',
            '        doneP = abs(lumaEndP) >= gradientScaled;',
            '        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;',
            '        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;',
            '        doneNP = (!doneN) || (!doneP);',
            '        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;',
            '        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;',
            '/*--------------------------------------------------------------------------*/',
            '        #if (FXAA_QUALITY_PS > 3)',
            '        if(doneNP) {',
            '            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '            doneN = abs(lumaEndN) >= gradientScaled;',
            '            doneP = abs(lumaEndP) >= gradientScaled;',
            '            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;',
            '            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;',
            '            doneNP = (!doneN) || (!doneP);',
            '            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;',
            '            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;',
            '/*--------------------------------------------------------------------------*/',
            '            #if (FXAA_QUALITY_PS > 4)',
            '            if(doneNP) {',
            '                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '                doneN = abs(lumaEndN) >= gradientScaled;',
            '                doneP = abs(lumaEndP) >= gradientScaled;',
            '                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;',
            '                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;',
            '                doneNP = (!doneN) || (!doneP);',
            '                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;',
            '                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;',
            '/*--------------------------------------------------------------------------*/',
            '                #if (FXAA_QUALITY_PS > 5)',
            '                if(doneNP) {',
            '                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '                    doneN = abs(lumaEndN) >= gradientScaled;',
            '                    doneP = abs(lumaEndP) >= gradientScaled;',
            '                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;',
            '                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;',
            '                    doneNP = (!doneN) || (!doneP);',
            '                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;',
            '                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;',
            '/*--------------------------------------------------------------------------*/',
            '                    #if (FXAA_QUALITY_PS > 6)',
            '                    if(doneNP) {',
            '                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '                        doneN = abs(lumaEndN) >= gradientScaled;',
            '                        doneP = abs(lumaEndP) >= gradientScaled;',
            '                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;',
            '                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;',
            '                        doneNP = (!doneN) || (!doneP);',
            '                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;',
            '                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;',
            '/*--------------------------------------------------------------------------*/',
            '                        #if (FXAA_QUALITY_PS > 7)',
            '                        if(doneNP) {',
            '                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '                            doneN = abs(lumaEndN) >= gradientScaled;',
            '                            doneP = abs(lumaEndP) >= gradientScaled;',
            '                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;',
            '                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;',
            '                            doneNP = (!doneN) || (!doneP);',
            '                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;',
            '                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;',
            '/*--------------------------------------------------------------------------*/',
            '    #if (FXAA_QUALITY_PS > 8)',
            '    if(doneNP) {',
            '        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '        doneN = abs(lumaEndN) >= gradientScaled;',
            '        doneP = abs(lumaEndP) >= gradientScaled;',
            '        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;',
            '        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;',
            '        doneNP = (!doneN) || (!doneP);',
            '        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;',
            '        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;',
            '/*--------------------------------------------------------------------------*/',
            '        #if (FXAA_QUALITY_PS > 9)',
            '        if(doneNP) {',
            '            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '            doneN = abs(lumaEndN) >= gradientScaled;',
            '            doneP = abs(lumaEndP) >= gradientScaled;',
            '            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;',
            '            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;',
            '            doneNP = (!doneN) || (!doneP);',
            '            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;',
            '            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;',
            '/*--------------------------------------------------------------------------*/',
            '            #if (FXAA_QUALITY_PS > 10)',
            '            if(doneNP) {',
            '                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '                doneN = abs(lumaEndN) >= gradientScaled;',
            '                doneP = abs(lumaEndP) >= gradientScaled;',
            '                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;',
            '                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;',
            '                doneNP = (!doneN) || (!doneP);',
            '                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;',
            '                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;',
            '/*--------------------------------------------------------------------------*/',
            '                #if (FXAA_QUALITY_PS > 11)',
            '                if(doneNP) {',
            '                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '                    doneN = abs(lumaEndN) >= gradientScaled;',
            '                    doneP = abs(lumaEndP) >= gradientScaled;',
            '                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;',
            '                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;',
            '                    doneNP = (!doneN) || (!doneP);',
            '                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;',
            '                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;',
            '/*--------------------------------------------------------------------------*/',
            '                    #if (FXAA_QUALITY_PS > 12)',
            '                    if(doneNP) {',
            '                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));',
            '                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));',
            '                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;',
            '                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;',
            '                        doneN = abs(lumaEndN) >= gradientScaled;',
            '                        doneP = abs(lumaEndP) >= gradientScaled;',
            '                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;',
            '                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;',
            '                        doneNP = (!doneN) || (!doneP);',
            '                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;',
            '                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;',
            '/*--------------------------------------------------------------------------*/',
            '                    }',
            '                    #endif',
            '/*--------------------------------------------------------------------------*/',
            '                }',
            '                #endif',
            '/*--------------------------------------------------------------------------*/',
            '            }',
            '            #endif',
            '/*--------------------------------------------------------------------------*/',
            '        }',
            '        #endif',
            '/*--------------------------------------------------------------------------*/',
            '    }',
            '    #endif',
            '/*--------------------------------------------------------------------------*/',
            '                        }',
            '                        #endif',
            '/*--------------------------------------------------------------------------*/',
            '                    }',
            '                    #endif',
            '/*--------------------------------------------------------------------------*/',
            '                }',
            '                #endif',
            '/*--------------------------------------------------------------------------*/',
            '            }',
            '            #endif',
            '/*--------------------------------------------------------------------------*/',
            '        }',
            '        #endif',
            '/*--------------------------------------------------------------------------*/',
            '    }',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat dstN = posM.x - posN.x;',
            '    FxaaFloat dstP = posP.x - posM.x;',
            '    if(!horzSpan) dstN = posM.y - posN.y;',
            '    if(!horzSpan) dstP = posP.y - posM.y;',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;',
            '    FxaaFloat spanLength = (dstP + dstN);',
            '    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;',
            '    FxaaFloat spanLengthRcp = 1.0/spanLength;',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaBool directionN = dstN < dstP;',
            '    FxaaFloat dst = min(dstN, dstP);',
            '    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;',
            '    FxaaFloat subpixG = subpixF * subpixF;',
            '    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;',
            '    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;',
            '/*--------------------------------------------------------------------------*/',
            '    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;',
            '    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);',
            '    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;',
            '    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;',
            '    #if (FXAA_DISCARD == 1)',
            '        return FxaaTexTop(tex, posM);',
            '    #else',
            '        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);',
            '    #endif',
            '}',
            '/*==========================================================================*/',
            '#endif',
            '',
            'void main() {',
            '  gl_FragColor = FxaaPixelShader(',
            '    vUv,',
            '    vec4(0.0),',
            '    tDiffuse,',
            '    tDiffuse,',
            '    tDiffuse,',
            '    resolution,',
            '    vec4(0.0),',
            '    vec4(0.0),',
            '    vec4(0.0),',
            '    0.75,',
            '    0.166,',
            '    0.0833,',
            '    0.0,',
            '    0.0,',
            '    0.0,',
            '    vec4(0.0)',
            '  );',
            '',
            '  // TODO avoid querying texture twice for same texel',
            '  gl_FragColor.a = texture2D(tDiffuse, vUv).a;',
            '}'
        ].join('\n')
    };
    return threex.shaders.FXAAShader = FXAAShader;
});
define('skylark-threejs-ex/shaders/GammaCorrectionShader',[
    "../threex"
],function (threex) {
    'use strict';
    var GammaCorrectionShader = {
        uniforms: { 'tDiffuse': { value: null } },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 tex = texture2D( tDiffuse, vUv );',
            '\tgl_FragColor = LinearTosRGB( tex );',
            '}'
        ].join('\n')
    };
    return threex.shaders.GammaCorrectionShader = GammaCorrectionShader;
});
define('skylark-threejs-ex/shaders/GodRaysShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var GodRaysDepthMaskShader = {
        uniforms: { tInput: { value: null } },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' vUv = uv;',
            ' gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'varying vec2 vUv;',
            'uniform sampler2D tInput;',
            'void main() {',
            '\tgl_FragColor = vec4( 1.0 ) - texture2D( tInput, vUv );',
            '}'
        ].join('\n')
    };
    var GodRaysGenerateShader = {
        uniforms: {
            tInput: { value: null },
            fStepSize: { value: 1 },
            vSunPositionScreenSpace: { value: new THREE.Vector2(0.5, 0.5) }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            ' vUv = uv;',
            ' gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#define TAPS_PER_PASS 6.0',
            'varying vec2 vUv;',
            'uniform sampler2D tInput;',
            'uniform vec2 vSunPositionScreenSpace;',
            'uniform float fStepSize;',
            'void main() {',
            '\tvec2 delta = vSunPositionScreenSpace - vUv;',
            '\tfloat dist = length( delta );',
            '\tvec2 stepv = fStepSize * delta / dist;',
            '\tfloat iters = dist/fStepSize;',
            '\tvec2 uv = vUv.xy;',
            '\tfloat col = 0.0;',
            '\tif ( 0.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;',
            '\tuv += stepv;',
            '\tif ( 1.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;',
            '\tuv += stepv;',
            '\tif ( 2.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;',
            '\tuv += stepv;',
            '\tif ( 3.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;',
            '\tuv += stepv;',
            '\tif ( 4.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;',
            '\tuv += stepv;',
            '\tif ( 5.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;',
            '\tuv += stepv;',
            '\tgl_FragColor = vec4( col/TAPS_PER_PASS );',
            '\tgl_FragColor.a = 1.0;',
            '}'
        ].join('\n')
    };
    var GodRaysCombineShader = {
        uniforms: {
            tColors: { value: null },
            tGodRays: { value: null },
            fGodRayIntensity: { value: 0.69 },
            vSunPositionScreenSpace: { value: new THREE.Vector2(0.5, 0.5) }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'varying vec2 vUv;',
            'uniform sampler2D tColors;',
            'uniform sampler2D tGodRays;',
            'uniform vec2 vSunPositionScreenSpace;',
            'uniform float fGodRayIntensity;',
            'void main() {',
            '\tgl_FragColor = texture2D( tColors, vUv ) + fGodRayIntensity * vec4( 1.0 - texture2D( tGodRays, vUv ).r );',
            '\tgl_FragColor.a = 1.0;',
            '}'
        ].join('\n')
    };
    var GodRaysFakeSunShader = {
        uniforms: {
            vSunPositionScreenSpace: { value: new THREE.Vector2(0.5, 0.5) },
            fAspect: { value: 1 },
            sunColor: { value: new THREE.Color(16772608) },
            bgColor: { value: new THREE.Color(0) }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'varying vec2 vUv;',
            'uniform vec2 vSunPositionScreenSpace;',
            'uniform float fAspect;',
            'uniform vec3 sunColor;',
            'uniform vec3 bgColor;',
            'void main() {',
            '\tvec2 diff = vUv - vSunPositionScreenSpace;',
            '\tdiff.x *= fAspect;',
            '\tfloat prop = clamp( length( diff ) / 0.5, 0.0, 1.0 );',
            '\tprop = 0.35 * pow( 1.0 - prop, 3.0 );',
            '\tgl_FragColor.xyz = mix( sunColor, bgColor, 1.0 - prop );',
            '\tgl_FragColor.w = 1.0;',
            '}'
        ].join('\n')
    };
    return threex.shaders.GodRayShader = {
        GodRaysDepthMaskShader,
        GodRaysGenerateShader,
        GodRaysCombineShader,
        GodRaysFakeSunShader
    };
});
define('skylark-threejs-ex/shaders/HorizontalBlurShader',[
    "../threex"
],function (threex) {
    'use strict';
    var HorizontalBlurShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'h': { value: 1 / 512 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform float h;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 sum = vec4( 0.0 );',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;',
            '\tgl_FragColor = sum;',
            '}'
        ].join('\n')
    };
    return  threex.shaders.HorizontalBlurShader = HorizontalBlurShader;
});
define('skylark-threejs-ex/shaders/HorizontalTiltShiftShader',[
    "../threex"
],function (threex) {
    'use strict';
    var HorizontalTiltShiftShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'h': { value: 1 / 512 },
            'r': { value: 0.35 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform float h;',
            'uniform float r;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 sum = vec4( 0.0 );',
            '\tfloat hh = h * abs( r - vUv.y );',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;',
            '\tgl_FragColor = sum;',
            '}'
        ].join('\n')
    };
    return  threex.shaders.HorizontalTiltShiftShader = HorizontalTiltShiftShader;
});
define('skylark-threejs-ex/shaders/KaleidoShader',[
    "../threex"
],function (threex) {
    'use strict';
    var KaleidoShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'sides': { value: 6 },
            'angle': { value: 0 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform float sides;',
            'uniform float angle;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec2 p = vUv - 0.5;',
            '\tfloat r = length(p);',
            '\tfloat a = atan(p.y, p.x) + angle;',
            '\tfloat tau = 2. * 3.1416 ;',
            '\ta = mod(a, tau/sides);',
            '\ta = abs(a - tau/sides/2.) ;',
            '\tp = r * vec2(cos(a), sin(a));',
            '\tvec4 color = texture2D(tDiffuse, p + 0.5);',
            '\tgl_FragColor = color;',
            '}'
        ].join('\n')
    };
    return  threex.shaders.KaleidoShader = KaleidoShader;
});
define('skylark-threejs-ex/shaders/MirrorShader',[
    "../threex"
],function (threex) {
    'use strict';
    var MirrorShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'side': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform int side;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec2 p = vUv;',
            '\tif (side == 0){',
            '\t\tif (p.x > 0.5) p.x = 1.0 - p.x;',
            '\t}else if (side == 1){',
            '\t\tif (p.x < 0.5) p.x = 1.0 - p.x;',
            '\t}else if (side == 2){',
            '\t\tif (p.y < 0.5) p.y = 1.0 - p.y;',
            '\t}else if (side == 3){',
            '\t\tif (p.y > 0.5) p.y = 1.0 - p.y;',
            '\t} ',
            '\tvec4 color = texture2D(tDiffuse, p);',
            '\tgl_FragColor = color;',
            '}'
        ].join('\n')
    };
    return  threex.shaders.MirrorShader = MirrorShader;
});
define('skylark-threejs-ex/shaders/NormalMapShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var NormalMapShader = {
        uniforms: {
            'heightMap': { value: null },
            'resolution': { value: new THREE.Vector2(512, 512) },
            'scale': { value: new THREE.Vector2(1, 1) },
            'height': { value: 0.05 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float height;',
            'uniform vec2 resolution;',
            'uniform sampler2D heightMap;',
            'varying vec2 vUv;',
            'void main() {',
            '\tfloat val = texture2D( heightMap, vUv ).x;',
            '\tfloat valU = texture2D( heightMap, vUv + vec2( 1.0 / resolution.x, 0.0 ) ).x;',
            '\tfloat valV = texture2D( heightMap, vUv + vec2( 0.0, 1.0 / resolution.y ) ).x;',
            '\tgl_FragColor = vec4( ( 0.5 * normalize( vec3( val - valU, val - valV, height  ) ) + 0.5 ), 1.0 );',
            '}'
        ].join('\n')
    };
    return  threex.shaders.NormalMapShader = NormalMapShader;
});
define('skylark-threejs-ex/shaders/ParallaxShader',[
    "../threex"
],function (threex) {
    'use strict';
    var ParallaxShader = {
        modes: {
            none: 'NO_PARALLAX',
            basic: 'USE_BASIC_PARALLAX',
            steep: 'USE_STEEP_PARALLAX',
            occlusion: 'USE_OCLUSION_PARALLAX',
            relief: 'USE_RELIEF_PARALLAX'
        },
        uniforms: {
            'bumpMap': { value: null },
            'map': { value: null },
            'parallaxScale': { value: null },
            'parallaxMinLayers': { value: null },
            'parallaxMaxLayers': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'varying vec3 vViewPosition;',
            'varying vec3 vNormal;',
            'void main() {',
            '\tvUv = uv;',
            '\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '\tvViewPosition = -mvPosition.xyz;',
            '\tvNormal = normalize( normalMatrix * normal );',
            '\tgl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D bumpMap;',
            'uniform sampler2D map;',
            'uniform float parallaxScale;',
            'uniform float parallaxMinLayers;',
            'uniform float parallaxMaxLayers;',
            'varying vec2 vUv;',
            'varying vec3 vViewPosition;',
            'varying vec3 vNormal;',
            '#ifdef USE_BASIC_PARALLAX',
            '\tvec2 parallaxMap( in vec3 V ) {',
            '\t\tfloat initialHeight = texture2D( bumpMap, vUv ).r;',
            '\t\tvec2 texCoordOffset = parallaxScale * V.xy * initialHeight;',
            '\t\treturn vUv - texCoordOffset;',
            '\t}',
            '#else',
            '\tvec2 parallaxMap( in vec3 V ) {',
            '\t\tfloat numLayers = mix( parallaxMaxLayers, parallaxMinLayers, abs( dot( vec3( 0.0, 0.0, 1.0 ), V ) ) );',
            '\t\tfloat layerHeight = 1.0 / numLayers;',
            '\t\tfloat currentLayerHeight = 0.0;',
            '\t\tvec2 dtex = parallaxScale * V.xy / V.z / numLayers;',
            '\t\tvec2 currentTextureCoords = vUv;',
            '\t\tfloat heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;',
            '\t\tfor ( int i = 0; i < 30; i += 1 ) {',
            '\t\t\tif ( heightFromTexture <= currentLayerHeight ) {',
            '\t\t\t\tbreak;',
            '\t\t\t}',
            '\t\t\tcurrentLayerHeight += layerHeight;',
            '\t\t\tcurrentTextureCoords -= dtex;',
            '\t\t\theightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;',
            '\t\t}',
            '\t\t#ifdef USE_STEEP_PARALLAX',
            '\t\t\treturn currentTextureCoords;',
            '\t\t#elif defined( USE_RELIEF_PARALLAX )',
            '\t\t\tvec2 deltaTexCoord = dtex / 2.0;',
            '\t\t\tfloat deltaHeight = layerHeight / 2.0;',
            '\t\t\tcurrentTextureCoords += deltaTexCoord;',
            '\t\t\tcurrentLayerHeight -= deltaHeight;',
            '\t\t\tconst int numSearches = 5;',
            '\t\t\tfor ( int i = 0; i < numSearches; i += 1 ) {',
            '\t\t\t\tdeltaTexCoord /= 2.0;',
            '\t\t\t\tdeltaHeight /= 2.0;',
            '\t\t\t\theightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;',
            '\t\t\t\tif( heightFromTexture > currentLayerHeight ) {',
            '\t\t\t\t\tcurrentTextureCoords -= deltaTexCoord;',
            '\t\t\t\t\tcurrentLayerHeight += deltaHeight;',
            '\t\t\t\t} else {',
            '\t\t\t\t\tcurrentTextureCoords += deltaTexCoord;',
            '\t\t\t\t\tcurrentLayerHeight -= deltaHeight;',
            '\t\t\t\t}',
            '\t\t\t}',
            '\t\t\treturn currentTextureCoords;',
            '\t\t#elif defined( USE_OCLUSION_PARALLAX )',
            '\t\t\tvec2 prevTCoords = currentTextureCoords + dtex;',
            '\t\t\tfloat nextH = heightFromTexture - currentLayerHeight;',
            '\t\t\tfloat prevH = texture2D( bumpMap, prevTCoords ).r - currentLayerHeight + layerHeight;',
            '\t\t\tfloat weight = nextH / ( nextH - prevH );',
            '\t\t\treturn prevTCoords * weight + currentTextureCoords * ( 1.0 - weight );',
            '\t\t#else',
            '\t\t\treturn vUv;',
            '\t\t#endif',
            '\t}',
            '#endif',
            'vec2 perturbUv( vec3 surfPosition, vec3 surfNormal, vec3 viewPosition ) {',
            '\tvec2 texDx = dFdx( vUv );',
            '\tvec2 texDy = dFdy( vUv );',
            '\tvec3 vSigmaX = dFdx( surfPosition );',
            '\tvec3 vSigmaY = dFdy( surfPosition );',
            '\tvec3 vR1 = cross( vSigmaY, surfNormal );',
            '\tvec3 vR2 = cross( surfNormal, vSigmaX );',
            '\tfloat fDet = dot( vSigmaX, vR1 );',
            '\tvec2 vProjVscr = ( 1.0 / fDet ) * vec2( dot( vR1, viewPosition ), dot( vR2, viewPosition ) );',
            '\tvec3 vProjVtex;',
            '\tvProjVtex.xy = texDx * vProjVscr.x + texDy * vProjVscr.y;',
            '\tvProjVtex.z = dot( surfNormal, viewPosition );',
            '\treturn parallaxMap( vProjVtex );',
            '}',
            'void main() {',
            '\tvec2 mapUv = perturbUv( -vViewPosition, normalize( vNormal ), normalize( vViewPosition ) );',
            '\tgl_FragColor = texture2D( map, mapUv );',
            '}'
        ].join('\n')
    };
    return threex.shaders.ParallaxShader = ParallaxShader;
});
define('skylark-threejs-ex/shaders/PixelShader',[
    "../threex"
],function (threex) {
    'use strict';
    var PixelShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'resolution': { value: null },
            'pixelSize': { value: 1 }
        },
        vertexShader: [
            'varying highp vec2 vUv;',
            'void main() {',
            'vUv = uv;',
            'gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform float pixelSize;',
            'uniform vec2 resolution;',
            'varying highp vec2 vUv;',
            'void main(){',
            'vec2 dxy = pixelSize / resolution;',
            'vec2 coord = dxy * floor( vUv / dxy );',
            'gl_FragColor = texture2D(tDiffuse, coord);',
            '}'
        ].join('\n')
    };
    return threex.shaders.PixelShader = PixelShader;
});
define('skylark-threejs-ex/shaders/RGBShiftShader',[
    "../threex"
],function (threex) {
    'use strict';
    var RGBShiftShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'amount': { value: 0.005 },
            'angle': { value: 0 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform float amount;',
            'uniform float angle;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec2 offset = amount * vec2( cos(angle), sin(angle));',
            '\tvec4 cr = texture2D(tDiffuse, vUv + offset);',
            '\tvec4 cga = texture2D(tDiffuse, vUv);',
            '\tvec4 cb = texture2D(tDiffuse, vUv - offset);',
            '\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);',
            '}'
        ].join('\n')
    };
    return threex.shaders.RGBShiftShader = RGBShiftShader;
});
define('skylark-threejs-ex/shaders/SepiaShader',[
    "../threex"
],function (threex) {
    'use strict';
    var SepiaShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'amount': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float amount;',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 color = texture2D( tDiffuse, vUv );',
            '\tvec3 c = color.rgb;',
            '\tcolor.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );',
            '\tcolor.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );',
            '\tcolor.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );',
            '\tgl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );',
            '}'
        ].join('\n')
    };
    return threex.shaders.SepiaShader = SepiaShader;
});
define('skylark-threejs-ex/shaders/SobelOperatorShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var SobelOperatorShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'resolution': { value: new THREE.Vector2() }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform vec2 resolution;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );',
            '\tconst mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );',
            '\tconst mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );',
            '\tfloat tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;',
            '\tfloat tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;',
            '\tfloat tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;',
            '\tfloat tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;',
            '\tfloat tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;',
            '\tfloat tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;',
            '\tfloat tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;',
            '\tfloat tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;',
            '\tfloat tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;',
            '\tfloat valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ',
            '\t\tGx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ',
            '\t\tGx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ',
            '\tfloat valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ',
            '\t\tGy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ',
            '\t\tGy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ',
            '\tfloat G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );',
            '\tgl_FragColor = vec4( vec3( G ), 1 );',
            '}'
        ].join('\n')
    };
    return  threex.shaders.SobelOperatorShader = SobelOperatorShader;
});
define('skylark-threejs-ex/shaders/SSAOBlurShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';

    var SSAOBlurShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'resolution': { value: new THREE.Vector2() }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform vec2 resolution;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec2 texelSize = ( 1.0 / resolution );',
            '\tfloat result = 0.0;',
            '\tfor ( int i = - 2; i <= 2; i ++ ) {',
            '\t\tfor ( int j = - 2; j <= 2; j ++ ) {',
            '\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;',
            '\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;',
            '\t\t}',
            '\t}',
            '\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );',
            '}'
        ].join('\n')
    };
    return threex.shaders.SSAOBlurShader = SSAOBlurShader;
});
define('skylark-threejs-ex/shaders/SSAODepthShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';

    var SSAODepthShader = {
        defines: { 'PERSPECTIVE_CAMERA': 1 },
        uniforms: {
            'tDepth': { value: null },
            'cameraNear': { value: null },
            'cameraFar': { value: null }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDepth;',
            'uniform float cameraNear;',
            'uniform float cameraFar;',
            'varying vec2 vUv;',
            '#include <packing>',
            'float getLinearDepth( const in vec2 screenPosition ) {',
            '\t#if PERSPECTIVE_CAMERA == 1',
            '\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;',
            '\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );',
            '\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );',
            '\t#else',
            '\t\treturn texture2D( depthSampler, coord ).x;',
            '\t#endif',
            '}',
            'void main() {',
            '\tfloat depth = getLinearDepth( vUv );',
            '\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );',
            '}'
        ].join('\n')
    };
    return threex.shaders.SSAODepthShader = SSAODepthShader;
});
define('skylark-threejs-ex/shaders/TechnicolorShader',[
    "../threex"
],function (threex) {
    'use strict';
    var TechnicolorShader = {
        uniforms: { 'tDiffuse': { value: null } },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );',
            '\tvec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);',
            '\tgl_FragColor = newTex;',
            '}'
        ].join('\n')
    };
    return  threex.shaders.TechnicolorShader = TechnicolorShader;
});
define('skylark-threejs-ex/shaders/ToonShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var ToonShader1 = {
        uniforms: {
            'uDirLightPos': { value: new THREE.Vector3() },
            'uDirLightColor': { value: new THREE.Color(15658734) },
            'uAmbientLightColor': { value: new THREE.Color(328965) },
            'uBaseColor': { value: new THREE.Color(16777215) }
        },
        vertexShader: [
            'varying vec3 vNormal;',
            'varying vec3 vRefract;',
            'void main() {',
            '\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );',
            '\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '\tvec3 worldNormal = normalize ( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );',
            '\tvNormal = normalize( normalMatrix * normal );',
            '\tvec3 I = worldPosition.xyz - cameraPosition;',
            '\tvRefract = refract( normalize( I ), worldNormal, 1.02 );',
            '\tgl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec3 uBaseColor;',
            'uniform vec3 uDirLightPos;',
            'uniform vec3 uDirLightColor;',
            'uniform vec3 uAmbientLightColor;',
            'varying vec3 vNormal;',
            'varying vec3 vRefract;',
            'void main() {',
            '\tfloat directionalLightWeighting = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);',
            '\tvec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;',
            '\tfloat intensity = smoothstep( - 0.5, 1.0, pow( length(lightWeighting), 20.0 ) );',
            '\tintensity += length(lightWeighting) * 0.2;',
            '\tfloat cameraWeighting = dot( normalize( vNormal ), vRefract );',
            '\tintensity += pow( 1.0 - length( cameraWeighting ), 6.0 );',
            '\tintensity = intensity * 0.2 + 0.3;',
            '\tif ( intensity < 0.50 ) {',
            '\t\tgl_FragColor = vec4( 2.0 * intensity * uBaseColor, 1.0 );',
            '\t} else {',
            '\t\tgl_FragColor = vec4( 1.0 - 2.0 * ( 1.0 - intensity ) * ( 1.0 - uBaseColor ), 1.0 );',
            '}',
            '}'
        ].join('\n')
    };
    var ToonShader2 = {
        uniforms: {
            'uDirLightPos': { value: new THREE.Vector3() },
            'uDirLightColor': { value: new THREE.Color(15658734) },
            'uAmbientLightColor': { value: new THREE.Color(328965) },
            'uBaseColor': { value: new THREE.Color(15658734) },
            'uLineColor1': { value: new THREE.Color(8421504) },
            'uLineColor2': { value: new THREE.Color(0) },
            'uLineColor3': { value: new THREE.Color(0) },
            'uLineColor4': { value: new THREE.Color(0) }
        },
        vertexShader: [
            'varying vec3 vNormal;',
            'void main() {',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '\tvNormal = normalize( normalMatrix * normal );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec3 uBaseColor;',
            'uniform vec3 uLineColor1;',
            'uniform vec3 uLineColor2;',
            'uniform vec3 uLineColor3;',
            'uniform vec3 uLineColor4;',
            'uniform vec3 uDirLightPos;',
            'uniform vec3 uDirLightColor;',
            'uniform vec3 uAmbientLightColor;',
            'varying vec3 vNormal;',
            'void main() {',
            '\tfloat camera = max( dot( normalize( vNormal ), vec3( 0.0, 0.0, 1.0 ) ), 0.4);',
            '\tfloat light = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);',
            '\tgl_FragColor = vec4( uBaseColor, 1.0 );',
            '\tif ( length(uAmbientLightColor + uDirLightColor * light) < 1.00 ) {',
            '\t\tgl_FragColor *= vec4( uLineColor1, 1.0 );',
            '\t}',
            '\tif ( length(uAmbientLightColor + uDirLightColor * camera) < 0.50 ) {',
            '\t\tgl_FragColor *= vec4( uLineColor2, 1.0 );',
            '\t}',
            '}'
        ].join('\n')
    };
    var ToonShaderHatching = {
        uniforms: {
            'uDirLightPos': { value: new THREE.Vector3() },
            'uDirLightColor': { value: new THREE.Color(15658734) },
            'uAmbientLightColor': { value: new THREE.Color(328965) },
            'uBaseColor': { value: new THREE.Color(16777215) },
            'uLineColor1': { value: new THREE.Color(0) },
            'uLineColor2': { value: new THREE.Color(0) },
            'uLineColor3': { value: new THREE.Color(0) },
            'uLineColor4': { value: new THREE.Color(0) }
        },
        vertexShader: [
            'varying vec3 vNormal;',
            'void main() {',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '\tvNormal = normalize( normalMatrix * normal );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec3 uBaseColor;',
            'uniform vec3 uLineColor1;',
            'uniform vec3 uLineColor2;',
            'uniform vec3 uLineColor3;',
            'uniform vec3 uLineColor4;',
            'uniform vec3 uDirLightPos;',
            'uniform vec3 uDirLightColor;',
            'uniform vec3 uAmbientLightColor;',
            'varying vec3 vNormal;',
            'void main() {',
            '\tfloat directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);',
            '\tvec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;',
            '\tgl_FragColor = vec4( uBaseColor, 1.0 );',
            '\tif ( length(lightWeighting) < 1.00 ) {',
            '\t\tif ( mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {',
            '\t\t\tgl_FragColor = vec4( uLineColor1, 1.0 );',
            '\t\t}',
            '\t}',
            '\tif ( length(lightWeighting) < 0.75 ) {',
            '\t\tif (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {',
            '\t\t\tgl_FragColor = vec4( uLineColor2, 1.0 );',
            '\t\t}',
            '\t}',
            '\tif ( length(lightWeighting) < 0.50 ) {',
            '\t\tif (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {',
            '\t\t\tgl_FragColor = vec4( uLineColor3, 1.0 );',
            '\t\t}',
            '\t}',
            '\tif ( length(lightWeighting) < 0.3465 ) {',
            '\t\tif (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {',
            '\t\t\tgl_FragColor = vec4( uLineColor4, 1.0 );',
            '\t}',
            '\t}',
            '}'
        ].join('\n')
    };
    var ToonShaderDotted = {
        uniforms: {
            'uDirLightPos': { value: new THREE.Vector3() },
            'uDirLightColor': { value: new THREE.Color(15658734) },
            'uAmbientLightColor': { value: new THREE.Color(328965) },
            'uBaseColor': { value: new THREE.Color(16777215) },
            'uLineColor1': { value: new THREE.Color(0) }
        },
        vertexShader: [
            'varying vec3 vNormal;',
            'void main() {',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '\tvNormal = normalize( normalMatrix * normal );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec3 uBaseColor;',
            'uniform vec3 uLineColor1;',
            'uniform vec3 uLineColor2;',
            'uniform vec3 uLineColor3;',
            'uniform vec3 uLineColor4;',
            'uniform vec3 uDirLightPos;',
            'uniform vec3 uDirLightColor;',
            'uniform vec3 uAmbientLightColor;',
            'varying vec3 vNormal;',
            'void main() {',
            'float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);',
            'vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;',
            'gl_FragColor = vec4( uBaseColor, 1.0 );',
            'if ( length(lightWeighting) < 1.00 ) {',
            '\t\tif ( ( mod(gl_FragCoord.x, 4.001) + mod(gl_FragCoord.y, 4.0) ) > 6.00 ) {',
            '\t\t\tgl_FragColor = vec4( uLineColor1, 1.0 );',
            '\t\t}',
            '\t}',
            '\tif ( length(lightWeighting) < 0.50 ) {',
            '\t\tif ( ( mod(gl_FragCoord.x + 2.0, 4.001) + mod(gl_FragCoord.y + 2.0, 4.0) ) > 6.00 ) {',
            '\t\t\tgl_FragColor = vec4( uLineColor1, 1.0 );',
            '\t\t}',
            '\t}',
            '}'
        ].join('\n')
    };
    return threex.shaders.ToonShader = {
        ToonShader1,
        ToonShader2,
        ToonShaderHatching,
        ToonShaderDotted
    };
});
define('skylark-threejs-ex/shaders/TranslucentShader',[
    "skylark-threejs",
    "../threex"
], function (
    THREE,
    threex
) {
    'use strict';
    var TranslucentShader = {
        uniforms: THREE.UniformsUtils.merge([
            THREE.UniformsLib['common'],
            THREE.UniformsLib['lights'],
            {
                'color': { value: new THREE.Color(16777215) },
                'diffuse': { value: new THREE.Color(16777215) },
                'specular': { value: new THREE.Color(16777215) },
                'emissive': { value: new THREE.Color(0) },
                'opacity': { value: 1 },
                'shininess': { value: 1 },
                'thicknessMap': { value: null },
                'thicknessColor': { value: new THREE.Color(16777215) },
                'thicknessDistortion': { value: 0.1 },
                'thicknessAmbient': { value: 0 },
                'thicknessAttenuation': { value: 0.1 },
                'thicknessPower': { value: 2 },
                'thicknessScale': { value: 10 }
            }
        ]),
        vertexShader: [
            'varying vec3 vNormal;',
            'varying vec2 vUv;',
            'varying vec3 vViewPosition;',
            THREE.ShaderChunk['common'],
            'void main() {',
            '\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );',
            '\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
            '\tvViewPosition = -mvPosition.xyz;',
            '\tvNormal = normalize( normalMatrix * normal );',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * mvPosition;',
            '}'
        ].join('\n'),
        fragmentShader: [
            '#define USE_UV',
            '#define USE_MAP',
            '#define PHONG',
            '#define TRANSLUCENT',
            '#include <common>',
            '#include <bsdfs>',
            '#include <uv_pars_fragment>',
            '#include <map_pars_fragment>',
            '#include <lights_phong_pars_fragment>',
            'varying vec3 vColor;',
            'uniform vec3 diffuse;',
            'uniform vec3 specular;',
            'uniform vec3 emissive;',
            'uniform float opacity;',
            'uniform float shininess;',
            'uniform sampler2D thicknessMap;',
            'uniform float thicknessPower;',
            'uniform float thicknessScale;',
            'uniform float thicknessDistortion;',
            'uniform float thicknessAmbient;',
            'uniform float thicknessAttenuation;',
            'uniform vec3 thicknessColor;',
            THREE.ShaderChunk['lights_pars_begin'],
            'void RE_Direct_Scattering(const in IncidentLight directLight, const in vec2 uv, const in GeometricContext geometry, inout ReflectedLight reflectedLight) {',
            '\tvec3 thickness = thicknessColor * texture2D(thicknessMap, uv).r;',
            '\tvec3 scatteringHalf = normalize(directLight.direction + (geometry.normal * thicknessDistortion));',
            '\tfloat scatteringDot = pow(saturate(dot(geometry.viewDir, -scatteringHalf)), thicknessPower) * thicknessScale;',
            '\tvec3 scatteringIllu = (scatteringDot + thicknessAmbient) * thickness;',
            '\treflectedLight.directDiffuse += scatteringIllu * thicknessAttenuation * directLight.color;',
            '}',
            'void main() {',
            '\tvec3 normal = normalize( vNormal );',
            '\tvec3 viewerDirection = normalize( vViewPosition );',
            '\tvec4 diffuseColor = vec4( diffuse, opacity );',
            '\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );',
            THREE.ShaderChunk['map_fragment'],
            THREE.ShaderChunk['color_fragment'],
            THREE.ShaderChunk['specularmap_fragment'],
            '\tvec3 totalEmissiveRadiance = emissive;',
            THREE.ShaderChunk['lights_phong_fragment'],
            '\tGeometricContext geometry;',
            '\tgeometry.position = - vViewPosition;',
            '\tgeometry.normal = normal;',
            '\tgeometry.viewDir = normalize( vViewPosition );',
            '\tIncidentLight directLight;',
            '\t#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )',
            '\t\tPointLight pointLight;',
            '\t\t#pragma unroll_loop_start',
            '\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {',
            '\t\t \tpointLight = pointLights[ i ];',
            '\t\t \tgetPointDirectLightIrradiance( pointLight, geometry, directLight );',
            '\t\t\t#ifdef USE_SHADOWMAP',
            '\t\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;',
            '\t\t\t#endif',
            '\t\t\tRE_Direct( directLight, geometry, material, reflectedLight );',
            '\t\t\t#if defined( TRANSLUCENT ) && defined( USE_UV )',
            '\t\t\tRE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);',
            '\t\t\t#endif',
            '\t\t}',
            '\t\t#pragma unroll_loop_end',
            '\t\t#endif',
            '\t#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )',
            '\t\tDirectionalLight directionalLight;',
            '\t\t#pragma unroll_loop_start',
            '\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {',
            '\t\t\tdirectionalLight = directionalLights[ i ];',
            '\t\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );',
            '\t\t\t#ifdef USE_SHADOWMAP',
            '\t\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;',
            '\t\t\t#endif',
            '\t\t\tRE_Direct( directLight, geometry, material, reflectedLight );',
            '\t\t\t#if defined( TRANSLUCENT ) && defined( USE_UV )',
            '\t\t\tRE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);',
            '\t\t\t#endif',
            '\t\t}',
            '\t\t#pragma unroll_loop_end',
            '\t#endif',
            '\t#if defined( RE_IndirectDiffuse )',
            '\t\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );',
            '\t\t#if ( NUM_HEMI_LIGHTS > 0 )',
            '\t\t\t#pragma unroll_loop_start',
            '\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {',
            '\t\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );',
            '\t\t\t}',
            '\t\t\t#pragma unroll_loop_end',
            '\t\t#endif',
            '\t#endif',
            '\t#if defined( RE_IndirectSpecular )',
            '\t\tvec3 radiance = vec3( 0.0 );',
            '\t\tvec3 clearcoatRadiance = vec3( 0.0 );',
            '\t#endif',
            THREE.ShaderChunk['lights_fragment_end'],
            '\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;',
            '\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );',
            THREE.ShaderChunk['encodings_fragment'],
            '}'
        ].join('\n')
    };
    return threex.shaders.TranslucentShader = TranslucentShader;
});
define('skylark-threejs-ex/shaders/VerticalBlurShader',[
    "../threex"
],function (threex) {
    'use strict';
    var VerticalBlurShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'v': { value: 1 / 512 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform float v;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 sum = vec4( 0.0 );',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;',
            '\tgl_FragColor = sum;',
            '}'
        ].join('\n')
    };
    return threex.shaders.VerticalBlurShader = VerticalBlurShader;
});
define('skylark-threejs-ex/shaders/VerticalTiltShiftShader',[
    "../threex"
],function (threex) {
    'use strict';
    var VerticalTiltShiftShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'v': { value: 1 / 512 },
            'r': { value: 0.35 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform sampler2D tDiffuse;',
            'uniform float v;',
            'uniform float r;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 sum = vec4( 0.0 );',
            '\tfloat vv = v * abs( r - vUv.y );',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;',
            '\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;',
            '\tgl_FragColor = sum;',
            '}'
        ].join('\n')
    };
    return threex.shaders.VerticalTiltShiftShader = VerticalTiltShiftShader;
});
define('skylark-threejs-ex/shaders/VignetteShader',[
    "../threex"
],function (threex) {
    'use strict';
    var VignetteShader = {
        uniforms: {
            'tDiffuse': { value: null },
            'offset': { value: 1 },
            'darkness': { value: 1 }
        },
        vertexShader: [
            'varying vec2 vUv;',
            'void main() {',
            '\tvUv = uv;',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform float offset;',
            'uniform float darkness;',
            'uniform sampler2D tDiffuse;',
            'varying vec2 vUv;',
            'void main() {',
            '\tvec4 texel = texture2D( tDiffuse, vUv );',
            '\tvec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );',
            '\tgl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );',
            '}'
        ].join('\n')
    };
    return threex.shaders.VignetteShader = VignetteShader;
});
define('skylark-threejs-ex/shaders/VolumeShader',[
      "skylark-threejs",
      "../threex"   
], function (
      THREE,
      threex
) {
    'use strict';
    var VolumeRenderShader1 = {
        uniforms: {
            'u_size': { value: new THREE.Vector3(1, 1, 1) },
            'u_renderstyle': { value: 0 },
            'u_renderthreshold': { value: 0.5 },
            'u_clim': { value: new THREE.Vector2(1, 1) },
            'u_data': { value: null },
            'u_cmdata': { value: null }
        },
        vertexShader: [
            '\t\tvarying vec4 v_nearpos;',
            '\t\tvarying vec4 v_farpos;',
            '\t\tvarying vec3 v_position;',
            '\t\tmat4 inversemat(mat4 m) {',
            '\t\t\t\tfloat',
            '\t\t\t\ta00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],',
            '\t\t\t\ta10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],',
            '\t\t\t\ta20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],',
            '\t\t\t\ta30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],',
            '\t\t\t\tb00 = a00 * a11 - a01 * a10,',
            '\t\t\t\tb01 = a00 * a12 - a02 * a10,',
            '\t\t\t\tb02 = a00 * a13 - a03 * a10,',
            '\t\t\t\tb03 = a01 * a12 - a02 * a11,',
            '\t\t\t\tb04 = a01 * a13 - a03 * a11,',
            '\t\t\t\tb05 = a02 * a13 - a03 * a12,',
            '\t\t\t\tb06 = a20 * a31 - a21 * a30,',
            '\t\t\t\tb07 = a20 * a32 - a22 * a30,',
            '\t\t\t\tb08 = a20 * a33 - a23 * a30,',
            '\t\t\t\tb09 = a21 * a32 - a22 * a31,',
            '\t\t\t\tb10 = a21 * a33 - a23 * a31,',
            '\t\t\t\tb11 = a22 * a33 - a23 * a32,',
            '\t\t\t\tdet = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;',
            '\t\treturn mat4(',
            '\t\t\t\ta11 * b11 - a12 * b10 + a13 * b09,',
            '\t\t\t\ta02 * b10 - a01 * b11 - a03 * b09,',
            '\t\t\t\ta31 * b05 - a32 * b04 + a33 * b03,',
            '\t\t\t\ta22 * b04 - a21 * b05 - a23 * b03,',
            '\t\t\t\ta12 * b08 - a10 * b11 - a13 * b07,',
            '\t\t\t\ta00 * b11 - a02 * b08 + a03 * b07,',
            '\t\t\t\ta32 * b02 - a30 * b05 - a33 * b01,',
            '\t\t\t\ta20 * b05 - a22 * b02 + a23 * b01,',
            '\t\t\t\ta10 * b10 - a11 * b08 + a13 * b06,',
            '\t\t\t\ta01 * b08 - a00 * b10 - a03 * b06,',
            '\t\t\t\ta30 * b04 - a31 * b02 + a33 * b00,',
            '\t\t\t\ta21 * b02 - a20 * b04 - a23 * b00,',
            '\t\t\t\ta11 * b07 - a10 * b09 - a12 * b06,',
            '\t\t\t\ta00 * b09 - a01 * b07 + a02 * b06,',
            '\t\t\t\ta31 * b01 - a30 * b03 - a32 * b00,',
            '\t\t\t\ta20 * b03 - a21 * b01 + a22 * b00) / det;',
            '\t\t}',
            '\t\tvoid main() {',
            '\t\t\t\tmat4 viewtransformf = modelViewMatrix;',
            '\t\t\t\tmat4 viewtransformi = inversemat(modelViewMatrix);',
            '\t\t\t\tvec4 position4 = vec4(position, 1.0);',
            '\t\t\t\tvec4 pos_in_cam = viewtransformf * position4;',
            '\t\t\t\tpos_in_cam.z = -pos_in_cam.w;',
            '\t\t\t\tv_nearpos = viewtransformi * pos_in_cam;',
            '\t\t\t\tpos_in_cam.z = pos_in_cam.w;',
            '\t\t\t\tv_farpos = viewtransformi * pos_in_cam;',
            '\t\t\t\tv_position = position;',
            '\t\t\t\tgl_Position = projectionMatrix * viewMatrix * modelMatrix * position4;',
            '\t\t}'
        ].join('\n'),
        fragmentShader: [
            '\t\tprecision highp float;',
            '\t\tprecision mediump sampler3D;',
            '\t\tuniform vec3 u_size;',
            '\t\tuniform int u_renderstyle;',
            '\t\tuniform float u_renderthreshold;',
            '\t\tuniform vec2 u_clim;',
            '\t\tuniform sampler3D u_data;',
            '\t\tuniform sampler2D u_cmdata;',
            '\t\tvarying vec3 v_position;',
            '\t\tvarying vec4 v_nearpos;',
            '\t\tvarying vec4 v_farpos;',
            '\t\tconst int MAX_STEPS = 887;\t// 887 for 512^3, 1774 for 1024^3',
            '\t\tconst int REFINEMENT_STEPS = 4;',
            '\t\tconst float relative_step_size = 1.0;',
            '\t\tconst vec4 ambient_color = vec4(0.2, 0.4, 0.2, 1.0);',
            '\t\tconst vec4 diffuse_color = vec4(0.8, 0.2, 0.2, 1.0);',
            '\t\tconst vec4 specular_color = vec4(1.0, 1.0, 1.0, 1.0);',
            '\t\tconst float shininess = 40.0;',
            '\t\tvoid cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);',
            '\t\tvoid cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);',
            '\t\tfloat sample1(vec3 texcoords);',
            '\t\tvec4 apply_colormap(float val);',
            '\t\tvec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray);',
            '\t\tvoid main() {',
            '\t\t\t\tvec3 farpos = v_farpos.xyz / v_farpos.w;',
            '\t\t\t\tvec3 nearpos = v_nearpos.xyz / v_nearpos.w;',
            '\t\t\t\tvec3 view_ray = normalize(nearpos.xyz - farpos.xyz);',
            '\t\t\t\tfloat distance = dot(nearpos - v_position, view_ray);',
            '\t\t\t\tdistance = max(distance, min((-0.5 - v_position.x) / view_ray.x,',
            '\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.x - 0.5 - v_position.x) / view_ray.x));',
            '\t\t\t\tdistance = max(distance, min((-0.5 - v_position.y) / view_ray.y,',
            '\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.y - 0.5 - v_position.y) / view_ray.y));',
            '\t\t\t\tdistance = max(distance, min((-0.5 - v_position.z) / view_ray.z,',
            '\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.z - 0.5 - v_position.z) / view_ray.z));',
            '\t\t\t\tvec3 front = v_position + view_ray * distance;',
            '\t\t\t\tint nsteps = int(-distance / relative_step_size + 0.5);',
            '\t\t\t\tif ( nsteps < 1 )',
            '\t\t\t\t\t\tdiscard;',
            '\t\t\t\tvec3 step = ((v_position - front) / u_size) / float(nsteps);',
            '\t\t\t\tvec3 start_loc = front / u_size;',
            '\t\t\t\tif (u_renderstyle == 0)',
            '\t\t\t\t\t\tcast_mip(start_loc, step, nsteps, view_ray);',
            '\t\t\t\telse if (u_renderstyle == 1)',
            '\t\t\t\t\t\tcast_iso(start_loc, step, nsteps, view_ray);',
            '\t\t\t\tif (gl_FragColor.a < 0.05)',
            '\t\t\t\t\t\tdiscard;',
            '\t\t}',
            '\t\tfloat sample1(vec3 texcoords) {',
            '\t\t\t\t/* Sample float value from a 3D texture. Assumes intensity data. */',
            '\t\t\t\treturn texture(u_data, texcoords.xyz).r;',
            '\t\t}',
            '\t\tvec4 apply_colormap(float val) {',
            '\t\t\t\tval = (val - u_clim[0]) / (u_clim[1] - u_clim[0]);',
            '\t\t\t\treturn texture2D(u_cmdata, vec2(val, 0.5));',
            '\t\t}',
            '\t\tvoid cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {',
            '\t\t\t\tfloat max_val = -1e6;',
            '\t\t\t\tint max_i = 100;',
            '\t\t\t\tvec3 loc = start_loc;',
            '\t\t\t\tfor (int iter=0; iter<MAX_STEPS; iter++) {',
            '\t\t\t\t\t\tif (iter >= nsteps)',
            '\t\t\t\t\t\t\t\tbreak;',
            '\t\t\t\t\t\tfloat val = sample1(loc);',
            '\t\t\t\t\t\tif (val > max_val) {',
            '\t\t\t\t\t\t\t\tmax_val = val;',
            '\t\t\t\t\t\t\t\tmax_i = iter;',
            '\t\t\t\t\t\t}',
            '\t\t\t\t\t\tloc += step;',
            '\t\t\t\t}',
            '\t\t\t\tvec3 iloc = start_loc + step * (float(max_i) - 0.5);',
            '\t\t\t\tvec3 istep = step / float(REFINEMENT_STEPS);',
            '\t\t\t\tfor (int i=0; i<REFINEMENT_STEPS; i++) {',
            '\t\t\t\t\t\tmax_val = max(max_val, sample1(iloc));',
            '\t\t\t\t\t\tiloc += istep;',
            '\t\t\t\t}',
            '\t\t\t\tgl_FragColor = apply_colormap(max_val);',
            '\t\t}',
            '\t\tvoid cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {',
            '\t\t\t\tgl_FragColor = vec4(0.0);\t// init transparent',
            '\t\t\t\tvec4 color3 = vec4(0.0);\t// final color',
            '\t\t\t\tvec3 dstep = 1.5 / u_size;\t// step to sample derivative',
            '\t\t\t\tvec3 loc = start_loc;',
            '\t\t\t\tfloat low_threshold = u_renderthreshold - 0.02 * (u_clim[1] - u_clim[0]);',
            '\t\t\t\tfor (int iter=0; iter<MAX_STEPS; iter++) {',
            '\t\t\t\t\t\tif (iter >= nsteps)',
            '\t\t\t\t\t\t\t\tbreak;',
            '\t\t\t\t\t\tfloat val = sample1(loc);',
            '\t\t\t\t\t\tif (val > low_threshold) {',
            '\t\t\t\t\t\t\t\tvec3 iloc = loc - 0.5 * step;',
            '\t\t\t\t\t\t\t\tvec3 istep = step / float(REFINEMENT_STEPS);',
            '\t\t\t\t\t\t\t\tfor (int i=0; i<REFINEMENT_STEPS; i++) {',
            '\t\t\t\t\t\t\t\t\t\tval = sample1(iloc);',
            '\t\t\t\t\t\t\t\t\t\tif (val > u_renderthreshold) {',
            '\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = add_lighting(val, iloc, dstep, view_ray);',
            '\t\t\t\t\t\t\t\t\t\t\t\treturn;',
            '\t\t\t\t\t\t\t\t\t\t}',
            '\t\t\t\t\t\t\t\t\t\tiloc += istep;',
            '\t\t\t\t\t\t\t\t}',
            '\t\t\t\t\t\t}',
            '\t\t\t\t\t\tloc += step;',
            '\t\t\t\t}',
            '\t\t}',
            '\t\tvec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray)',
            '\t\t{',
            '\t\t\t\tvec3 V = normalize(view_ray);',
            '\t\t\t\tvec3 N;',
            '\t\t\t\tfloat val1, val2;',
            '\t\t\t\tval1 = sample1(loc + vec3(-step[0], 0.0, 0.0));',
            '\t\t\t\tval2 = sample1(loc + vec3(+step[0], 0.0, 0.0));',
            '\t\t\t\tN[0] = val1 - val2;',
            '\t\t\t\tval = max(max(val1, val2), val);',
            '\t\t\t\tval1 = sample1(loc + vec3(0.0, -step[1], 0.0));',
            '\t\t\t\tval2 = sample1(loc + vec3(0.0, +step[1], 0.0));',
            '\t\t\t\tN[1] = val1 - val2;',
            '\t\t\t\tval = max(max(val1, val2), val);',
            '\t\t\t\tval1 = sample1(loc + vec3(0.0, 0.0, -step[2]));',
            '\t\t\t\tval2 = sample1(loc + vec3(0.0, 0.0, +step[2]));',
            '\t\t\t\tN[2] = val1 - val2;',
            '\t\t\t\tval = max(max(val1, val2), val);',
            '\t\t\t\tfloat gm = length(N); // gradient magnitude',
            '\t\t\t\tN = normalize(N);',
            '\t\t\t\tfloat Nselect = float(dot(N, V) > 0.0);',
            '\t\t\t\tN = (2.0 * Nselect - 1.0) * N;\t// ==\tNselect * N - (1.0-Nselect)*N;',
            '\t\t\t\tvec4 ambient_color = vec4(0.0, 0.0, 0.0, 0.0);',
            '\t\t\t\tvec4 diffuse_color = vec4(0.0, 0.0, 0.0, 0.0);',
            '\t\t\t\tvec4 specular_color = vec4(0.0, 0.0, 0.0, 0.0);',
            '\t\t\t\tfor (int i=0; i<1; i++)',
            '\t\t\t\t{',
            '\t\t\t\t\t\tvec3 L = normalize(view_ray);\t//lightDirs[i];',
            '\t\t\t\t\t\tfloat lightEnabled = float( length(L) > 0.0 );',
            '\t\t\t\t\t\tL = normalize(L + (1.0 - lightEnabled));',
            '\t\t\t\t\t\tfloat lambertTerm = clamp(dot(N, L), 0.0, 1.0);',
            '\t\t\t\t\t\tvec3 H = normalize(L+V); // Halfway vector',
            '\t\t\t\t\t\tfloat specularTerm = pow(max(dot(H, N), 0.0), shininess);',
            '\t\t\t\t\t\tfloat mask1 = lightEnabled;',
            '\t\t\t\t\t\tambient_color +=\tmask1 * ambient_color;\t// * gl_LightSource[i].ambient;',
            '\t\t\t\t\t\tdiffuse_color +=\tmask1 * lambertTerm;',
            '\t\t\t\t\t\tspecular_color += mask1 * specularTerm * specular_color;',
            '\t\t\t\t}',
            '\t\t\t\tvec4 final_color;',
            '\t\t\t\tvec4 color = apply_colormap(val);',
            '\t\t\t\tfinal_color = color * (ambient_color + diffuse_color) + specular_color;',
            '\t\t\t\tfinal_color.a = color.a;',
            '\t\t\t\treturn final_color;',
            '\t\t}'
        ].join('\n')
    };
    return threex.shaders.VolumeShader = VolumeRenderShader1;
});
define('skylark-threejs-ex/shaders/WaterRefractionShader',[
    "../threex"
],function (threex) {
    'use strict';
    var WaterRefractionShader = {
        uniforms: {
            'color': { value: null },
            'time': { value: 0 },
            'tDiffuse': { value: null },
            'tDudv': { value: null },
            'textureMatrix': { value: null }
        },
        vertexShader: [
            'uniform mat4 textureMatrix;',
            'varying vec2 vUv;',
            'varying vec4 vUvRefraction;',
            'void main() {',
            '\tvUv = uv;',
            '\tvUvRefraction = textureMatrix * vec4( position, 1.0 );',
            '\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',
            '}'
        ].join('\n'),
        fragmentShader: [
            'uniform vec3 color;',
            'uniform float time;',
            'uniform sampler2D tDiffuse;',
            'uniform sampler2D tDudv;',
            'varying vec2 vUv;',
            'varying vec4 vUvRefraction;',
            'float blendOverlay( float base, float blend ) {',
            '\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );',
            '}',
            'vec3 blendOverlay( vec3 base, vec3 blend ) {',
            '\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ),blendOverlay( base.b, blend.b ) );',
            '}',
            'void main() {',
            ' float waveStrength = 0.1;',
            ' float waveSpeed = 0.03;',
            '\tvec2 distortedUv = texture2D( tDudv, vec2( vUv.x + time * waveSpeed, vUv.y ) ).rg * waveStrength;',
            '\tdistortedUv = vUv.xy + vec2( distortedUv.x, distortedUv.y + time * waveSpeed );',
            '\tvec2 distortion = ( texture2D( tDudv, distortedUv ).rg * 2.0 - 1.0 ) * waveStrength;',
            ' vec4 uv = vec4( vUvRefraction );',
            ' uv.xy += distortion;',
            '\tvec4 base = texture2DProj( tDiffuse, uv );',
            '\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );',
            '}'
        ].join('\n')
    };
    return  threex.shaders.WaterRefractionShader = WaterRefractionShader;
});
define('skylark-threejs-ex/textures/FlakesTexture',[
    "../threex"
],function (threex) {
    'use strict';
    class FlakesTexture {
        constructor(width = 512, height = 512) {
            var canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            var context = canvas.getContext('2d');
            context.fillStyle = 'rgb(127,127,255)';
            context.fillRect(0, 0, width, height);
            for (var i = 0; i < 4000; i++) {
                var x = Math.random() * width;
                var y = Math.random() * height;
                var r = Math.random() * 3 + 3;
                var nx = Math.random() * 2 - 1;
                var ny = Math.random() * 2 - 1;
                var nz = 1.5;
                var l = Math.sqrt(nx * nx + ny * ny + nz * nz);
                nx /= l;
                ny /= l;
                nz /= l;
                context.fillStyle = 'rgb(' + (nx * 127 + 127) + ',' + (ny * 127 + 127) + ',' + nz * 255 + ')';
                context.beginPath();
                context.arc(x, y, r, 0, Math.PI * 2);
                context.fill();
            }
            return canvas;
        }
    }
    return threex.textures.FlakesTexture = FlakesTexture;
});
define('skylark-threejs-ex/main',[
	"./threex",

	"./animation/AnimationClipCreator",
	"./animation/CCDIKSolver",
	"./animation/MMDAnimationHelper",
	"./animation/MMDPhysics",
	"./animation/TimelinerController",

	"./cameras/CinematicCamera",

	"./controls/DeviceOrientationControls",
	"./controls/DragControls",
	"./controls/FirstPersonControls",
	"./controls/FlyControls",
	"./controls/MapControls",
	"./controls/OrbitControls",
	"./controls/PointerLockControls",
	"./controls/TrackballControls",
	"./controls/TransformControls",
	"./controls/TransformControlsGizmo",
	"./controls/TransformControlsPlane",

	"./csm/CSM",
	"./csm/CSMHelper",
	"./csm/Frustum",
	"./csm/Shader",

	"./curves/CurveExtras",
	"./curves/NURBSCurve",
	"./curves/NURBSSurface",
	"./curves/NURBSUtils",

	"./effects/AnaglyphEffect",
	"./effects/AsciiEffect",
	"./effects/OutlineEffect",
	"./effects/ParallaxBarrierEffect",
	"./effects/PeppersGhostEffect",
	"./effects/StereoEffect",

	"./exporters/ColladaExporter",
	"./exporters/DRACOExporter",
	"./exporters/GLTFExporter",
	"./exporters/MMDExporter",
	"./exporters/OBJExporter",
	"./exporters/PLYExporter",
	"./exporters/STLExporter",
	"./exporters/TypedGeometryExporter",

	"./geometries/BoxLineGeometry",
	"./geometries/ConvexBufferGeometry",
	"./geometries/ConvexGeometry",
	"./geometries/DecalGeometry",
	"./geometries/DecalVertex",
	"./geometries/LightningStrike",
	"./geometries/ParametricGeometries",
	"./geometries/TeapotBufferGeometry",

	"./helpers/FaceNormalsHelper",
	"./helpers/LightProbeHelper",
	"./helpers/PositionalAudioHelper",
	"./helpers/RectAreaLightHelper",
	"./helpers/VertexNormalsHelper",
	"./helpers/VertexTangentsHelper",

	"./interactive/SelectionBox",
	"./interactive/SelectionHelper",

	"./lights/LightProbeGenerator",
	"./lights/RectAreaLightUniformsLib",

	"./lines/Line2",
	"./lines/LineGeometry",
	"./lines/LineMaterial",
	"./lines/LineSegments2",
	"./lines/LineSegmentsGeometry",
	"./lines/Wireframe",
	"./lines/WireframeGeometry2",

	"./loaders/TTFLoader",
//	"./loaders/LoaderSupport",
	"./loaders/3MFLoader",
	"./loaders/AMFLoader",
	"./loaders/AssimpJSONLoader",
	"./loaders/AssimpLoader",
	"./loaders/AWDLoader",
	"./loaders/BabylonLoader",
	"./loaders/ColladaLoader",
	"./loaders/DRACOLoader",
	"./loaders/FBXLoader",
	"./loaders/GCodeLoader",
	"./loaders/GLTFLoader",
	"./loaders/MTLLoader",
	"./loaders/OBJLoader",
	"./loaders/OBJLoader2",
	"./loaders/PCDLoader",
	"./loaders/PLYLoader",
	"./loaders/PRWMLoader",
	"./loaders/STLLoader",
	"./loaders/SVGLoader",
	"./loaders/TDSLoader",
	"./loaders/VRMLLoader",
	"./loaders/VTKLoader",
	"./loaders/XLoader",
	"./loaders/DDSLoader",
	"./loaders/PVRLoader",
	"./loaders/TGALoader",
	"./loaders/KTXLoader",

	"./math/ColorConverter",
	"./math/ConvexHull",
	"./math/ImprovedNoise",
	"./math/Lut",
	"./math/MeshSurfaceSampler",
	"./math/OBB",
	"./math/SimplexNoise",

	"./misc/ConvexObjectBreaker",
	"./misc/GPUComputationRenderer",
	"./misc/Gyroscope",
	"./misc/MD2Character",
	"./misc/MD2CharacterComplex",
	"./misc/MorphAnimMesh",
	"./misc/MorphBlendMesh",
	"./misc/Ocean",
	"./misc/RollerCoaster",
	"./misc/TubePainter",
	"./misc/Volume",
	"./misc/VolumeSlice",

	"./modifiers/ExplodeModifier",
	"./modifiers/SimplifyModifier",
	"./modifiers/SubdivisionModifier",
	"./modifiers/TessellateModifier",

	"./objects/Fire",
	"./objects/Lensflare",
	"./objects/LensflareElement",
	"./objects/LightningStorm",
	"./objects/MarchingCubes",
	"./objects/Reflector",
	"./objects/ReflectorRTT",
	"./objects/Refractor",
	"./objects/ShadowMesh",
	"./objects/Sky",
	"./objects/Water",
	"./objects/Water2",

	"./physics/CannonPhysics",

	"./postprocessing/AdaptiveToneMappingPass",
	"./postprocessing/AfterimagePass",
	"./postprocessing/BloomPass",
	"./postprocessing/BokehPass",
	"./postprocessing/ClearMaskPass",
	"./postprocessing/ClearPass",
	"./postprocessing/CubeTexturePass",
	"./postprocessing/DotScreenPass",
	"./postprocessing/EffectComposer",
	"./postprocessing/FilmPass",
	"./postprocessing/GlitchPass",
	"./postprocessing/HalftonePass",
	"./postprocessing/MaskPass",
	"./postprocessing/OutlinePass",
	"./postprocessing/Pass",
	"./postprocessing/RenderPass",
	"./postprocessing/SAOPass",
	"./postprocessing/SavePass",
	"./postprocessing/ShaderPass",
	"./postprocessing/SMAAPass",
	"./postprocessing/SSAARenderPass",
	"./postprocessing/SSAOPass",
	"./postprocessing/TAARenderPass",
	"./postprocessing/TexturePass",
	"./postprocessing/UnrealBloomPass",

	"./renderers/CSS2DRenderer",
	"./renderers/CSS3DRenderer",
	"./renderers/Projector",
	"./renderers/SVGRenderer",

	"./shaders/AfterimageShader",
	"./shaders/BasicShader",
	"./shaders/BleachBypassShader",
	"./shaders/BlendShader",
	"./shaders/BokehShader",
	"./shaders/BokehShader2",
	"./shaders/BrightnessContrastShader",
	"./shaders/ColorCorrectionShader",
	"./shaders/ColorifyShader",
	"./shaders/ConvolutionShader",
	"./shaders/CopyShader",
	"./shaders/DepthLimitedBlurShader",
	"./shaders/DigitalGlitch",
	"./shaders/DOFMipMapShader",
	"./shaders/DotScreenShader",
	"./shaders/FilmShader",
	"./shaders/FocusShader",
	"./shaders/FreiChenShader",
	"./shaders/FresnelShader",
	"./shaders/FXAAShader",
	"./shaders/GammaCorrectionShader",
	"./shaders/GodRaysShader",
	"./shaders/HalftoneShader",
	"./shaders/HorizontalBlurShader",
	"./shaders/HorizontalTiltShiftShader",
	"./shaders/KaleidoShader",
	"./shaders/LuminosityHighPassShader",
	"./shaders/LuminosityShader",
	"./shaders/MirrorShader",
	"./shaders/NormalMapShader",
	"./shaders/OceanShaders",
	"./shaders/ParallaxShader",
	"./shaders/PixelShader",
	"./shaders/RGBShiftShader",
	"./shaders/SAOShader",
	"./shaders/SepiaShader",
	"./shaders/SMAAShader",


	"./shaders/SobelOperatorShader",
	"./shaders/SSAOBlurShader",
	"./shaders/SSAODepthShader",
	"./shaders/SSAOShader",
	"./shaders/TechnicolorShader",
	"./shaders/ToneMapShader",
	"./shaders/ToonShader",
	"./shaders/TranslucentShader",
	"./shaders/UnpackDepthRGBAShader",
	"./shaders/VerticalBlurShader",
	"./shaders/VerticalTiltShiftShader",
	"./shaders/VignetteShader",
	"./shaders/VolumeShader",
	"./shaders/WaterRefractionShader",

	"./textures/FlakesTexture"



],function(threex){
	return threex;
});
define('skylark-threejs-ex', ['skylark-threejs-ex/main'], function (main) { return main; });


},this);
//# sourceMappingURL=sourcemaps/skylark-threejs-ex.js.map
